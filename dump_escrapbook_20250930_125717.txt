C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook (root)
├── eScrapBook_-_Entwicklungsgeschichte/
│   ├── css/
│   │   ├── combined.css  (19236 B, 18.79 KB)
│   │   ├── styles.css  (47135 B, 46.03 KB)
│   │   └── viewer.css  (1315 B, 1.28 KB)
│   ├── js/
│   │   ├── libs-viewer.js  (371464 B, 362.76 KB)
│   │   └── mykkro-viewer.js  (203085 B, 198.33 KB)
│   ├── book.json  (7865 B, 7.68 KB)
│   ├── files  (1583 B, 1.55 KB)
│   ├── index.html  (8685 B, 8.48 KB)
│   ├── README  (44 B, 44.00 B)
│   ├── RUNeScrapBook  (49 B, 49.00 B)
│   └── RUNeScrapBook.bat  (53 B, 53.00 B)
├── eScrapBook_Takova_normalni_rodinka/
│   ├── css/
│   │   ├── combined.css  (31886 B, 31.14 KB)
│   │   ├── styles.css  (50381 B, 49.20 KB)
│   │   └── viewer.css  (1315 B, 1.28 KB)
│   ├── js/
│   │   ├── libs-viewer.js  (433967 B, 423.80 KB)
│   │   ├── mykkro-viewer.js  (207477 B, 202.61 KB)
│   │   └── mykkro-viewerOld.js  (207473 B, 202.61 KB)
│   ├── voices/
│   │   └── 30/
│   ├── book.json  (8210 B, 8.02 KB)
│   ├── connector.js  (26 B, 26.00 B)
│   ├── files  (1663 B, 1.62 KB)
│   ├── index.html  (957 B, 957.00 B)
│   ├── index2.html  (9206 B, 8.99 KB)
│   ├── logging.js  (750 B, 750.00 B)
│   ├── README  (44 B, 44.00 B)
│   ├── RUNeScrapBook  (49 B, 49.00 B)
│   ├── RUNeScrapBook.bat  (53 B, 53.00 B)
│   └── wow.json  (206 B, 206.00 B)
├── slovensko/
│   ├── css/
│   │   ├── combined.css  (31886 B, 31.14 KB)
│   │   ├── styles.css  (50381 B, 49.20 KB)
│   │   └── viewer.css  (1315 B, 1.28 KB)
│   ├── js/
│   │   ├── libs-viewer.js  (433967 B, 423.80 KB)
│   │   ├── mykkro-viewer.js  (207477 B, 202.61 KB)
│   │   └── mykkro-viewerOld.js  (207473 B, 202.61 KB)
│   ├── videos/
│   ├── book.json  (8210 B, 8.02 KB)
│   ├── connector.js  (26 B, 26.00 B)
│   ├── files  (1663 B, 1.62 KB)
│   ├── index2.html  (9206 B, 8.99 KB)
│   ├── logging.js  (750 B, 750.00 B)
│   ├── README  (44 B, 44.00 B)
│   ├── RUNeScrapBook  (49 B, 49.00 B)
│   └── RUNeScrapBook.bat  (53 B, 53.00 B)
├── TZ-DON-Buch_Iran/
│   ├── css/
│   │   ├── combined.css  (24469 B, 23.90 KB)
│   │   ├── styles.css  (42319 B, 41.33 KB)
│   │   └── viewer.css  (1315 B, 1.28 KB)
│   ├── js/
│   │   ├── libs-viewer.js  (379490 B, 370.60 KB)
│   │   └── mykkro-viewer.js  (197015 B, 192.40 KB)
│   ├── book.json  (11126 B, 10.87 KB)
│   ├── files  (3639 B, 3.55 KB)
│   ├── index.html  (12026 B, 11.74 KB)
│   ├── README  (44 B, 44.00 B)
│   ├── RUNeScrapBook  (49 B, 49.00 B)
│   ├── RUNeScrapBook.bat  (53 B, 53.00 B)
│   └── wow.json  (206 B, 206.00 B)
├── vzorky/
│   └── book1.txt  (8210 B, 8.02 KB)
├── book.JSON  (334 B, 334.00 B)
├── book2.json  (334 B, 334.00 B)
└── index.html  (985 B, 985.00 B)
================================================================================
OBSAH SOUBORŮ (po aplikaci výjimek)
================================================================================

--------------------------------------------------------------------------------
SOUČÁST: book.JSON
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\book.JSON
VELIKOST: 334 B (334.00 B)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
{
  "type": "book",
  "options": "",
  "slots": [
    {
      "type": "text-thing",
      "options": {
        "html": "Slovensko - Vysok\u00e9 Tatry 2020",
        "css": "",
        "h-align": "center",
        "v-align": "center",
        "font-size": "20px",
        "font-family": "Georgia, serif"
      }
    }]
}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: book2.json
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\book2.json
VELIKOST: 334 B (334.00 B)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
{
  "type": "book",
  "options": "",
  "slots": [
    {
      "type": "text-thing",
      "options": {
        "html": "Slovensko - Vysok\u00e9 Tatry 2020",
        "css": "",
        "h-align": "center",
        "v-align": "center",
        "font-size": "20px",
        "font-family": "Georgia, serif"
      }
    }]
}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: index.html
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\index.html
VELIKOST: 985 B (985.00 B)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>eScrapBook</title>
<link href="images/favicon.ico" type="image/x-icon" rel="icon">
<link href="images/favicon.ico" type="image/x-icon" rel="shortcut icon">
<link rel="stylesheet" type="text/css" href="css/viewer.css">
<link rel="stylesheet" type="text/css" href="css/styles.css">
<script>
    var LocaleStrings = {};
</script>
<script type="text/javascript" src="js/libs-viewer.js"></script>
<script type="text/javascript" src="js/mykkro-viewer.js"></script></head>
<body>
<script>
// TODO dat do pluginu/widgetu/etc. a pridat ovladaci prvky
// udelat z toho neco jako BookViewerThing 
$(document).ready(function() {	
	fetch("book.json")
  	.then(response => response.json())
  	.then(json => {
		//console.log(json);
		var bookView = new ExportBookViewer(json);
		bookView.init();
	});
});
</script>
<div id="fullscreen" style="width: 100%; height: 100%;">
</div>
</body>
</html>
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_-_Entwicklungsgeschichte\book.json
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_-_Entwicklungsgeschichte\book.json
VELIKOST: 7865 B (7.68 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
{"type":"book","options":{"background_image_url":"images\/111\/bg_wood_texture_v02_original.jpg","frontpage_image_url":"images\/94\/bookJacket_eScrapBook_F_original.JPG","backpage_image_url":"images\/95\/bookJacket_eScrapBook_B_original.JPG","oddpage_image_url":"images\/131\/page_L_original.JPG","evenpage_image_url":"images\/132\/page_R_original.JPG","turnleft_image_url":"images\/113\/icon_turn_left_256_v01_original.png","turnright_image_url":"images\/114\/icon_turn_right_256_v01_original.png"},"slots":[{"type":"background-decorator","options":{"image":"images\/94\/bookJacket_eScrapBook_F_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":60,"left":26,"right":16,"bottom":60},"slots":{"content":{"type":"text-thing","options":{"html":"Entwicklungsgeschichte","css":"","h-align":"center","v-align":"center","font-size":"120%","font-family":"Verdana,Geneva,sans-serif"}}}}}},{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"imager","options":{"url":"images\/98\/Myrousz_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}},{"type":"split-layout","options":{"ratio":10,"gap":2,"horizontal":false},"slots":{"first":{"type":"text-thing","options":{"html":"Myrousz \u2013 Bei der Zusammenarbeit mit den Kolleginnen des \n\nFSW","css":"","h-align":"center","v-align":"center","font-size":"50%","font-family":"Verdana,Geneva,sans-serif"}},"second":{"type":"text-thing","options":{"html":"<p><span style=\"color:#4B0082\"><span style=\"font-size:18px\"><span style=\"font-family:verdana,geneva,sans-serif\"><span style=\"background-color:#DAA520\">So wurde eScrapBook geboren...<\/span><\/span><\/span><\/span><\/p>\r\n\r\n<p><span style=\"font-size:18px\"><span style=\"font-family:verdana,geneva,sans-serif\"><span style=\"background-color:#FFD700\">Es war September 2012.<\/span><br \/>\r\n<span style=\"background-color:#FFD700\">Miroslav Uller (Myrousz) von CVUT aus Prag<\/span><br \/>\r\n<span style=\"background-color:#FFD700\">hat FSW Tageszentrum Donaufeld besucht<\/span><br \/>\r\n<span style=\"background-color:#FFD700\">und ersten Prototyp von eScrapBook Web Applikation pr&auml;sentiert.<\/span><\/span><\/span><\/p>\r\n","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}}]}}},{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"grid-layout","options":{"rows":3,"columns":1,"gap":2},"slots":[{"type":"text-thing","options":{"html":"Am Anfang stand die Idee von Christine Petioky, eine \n\nApplikation\nzur Gehirnstimulation zu entwickeln. Sie hat Frau Professor \n\nOlga Stepankova\nvon der CVUT in Prag eine Zusmmanarbeit mit der UNI Wien \n\nund dem FSW vorgeschlagen. ","css":"","h-align":"center","v-align":"center","font-size":"85%","font-family":"Verdana,Geneva,sans-serif"}},{"type":"text-thing","options":{"html":"Es war ein langer Weg, mit vielen Upgrades und weiteren \n\nVerbesserungen\ndes Designs der Benutzeroberfl\u00e4che.","css":"","h-align":"center","v-align":"center","font-size":"85%","font-family":"Verdana,Geneva,sans-serif"}},{"type":"text-thing","options":{"html":"Aber die eScrapBook Web Applikation ist schon da und es steht \n\nuns allen zur Verf\u00fcgung :).","css":"","h-align":"center","v-align":"center","font-size":"120%","font-family":"Verdana,Geneva,sans-serif"}}]}}},{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"imager","options":{"url":"images\/100\/eScrapBook_prototype02_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"contain"}},{"type":"text-thing","options":{"html":"So hat erstes eScrapBook Prototyp  ausgesehen.","css":"","h-align":"center","v-align":"center","font-size":"100%","font-family":"Verdana,Geneva,sans-serif"}}]}}},{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"imager","options":{"url":"images\/99\/eScrapBook_prototype01_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}},{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"imager","options":{"url":"images\/101\/img01_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}},{"type":"split-layout","options":{"ratio":10,"gap":2,"horizontal":false},"slots":{"first":{"type":"audio-decorator","options":{"ogg":"voices\/4\/Entspannungsmusik_Meeresrauschen_original.ogg","mp3":"","uri":"voices\/4\/Entspannungsmusik_Meeresrauschen_original.ogg","autoplay":true,"loop":true,"volume":50},"slots":{"content":{"type":"empty","options":{"css":""}}}},"second":{"type":"text-thing","options":{"html":"UNI Wien hat das erstes eScrapBook-eBuch \"Schiffahrt\" f\u00fcr die \n\ninternenTests vorbereitet.\nDer Titel \"Schiffahrt\" ist absichtlich f\u00fcr die SeniorInnen nach \n\nder alten Rechtschreibregel geschrieben.","css":"","h-align":"center","v-align":"center","font-size":"85%","font-family":"Verdana,Geneva,sans-serif"}}}}]}}},{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"imager","options":{"url":"images\/102\/eScrapBookWebApp_eBookSchiffahrt_View01_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"contain"}},{"type":"imager","options":{"url":"images\/139\/eScrapBookWebApp_eBookSchiffahrt_View02_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"contain"}}]}}},{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"imager","options":{"url":"images\/140\/img02_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}},{"type":"split-layout","options":{"ratio":10,"gap":2,"horizontal":false},"slots":{"first":{"type":"text-thing","options":{"html":"Pr\u00e4sentation f\u00fcr das 4. SCM in Ferrara, IT (19.4.2013)","css":"","h-align":"center","v-align":"center","font-size":"50%","font-family":"Verdana,Geneva,sans-serif"}},"second":{"type":"text-thing","options":{"html":"\"Iranische Kultur\" war das erstes eScrapBook-eBuch, das f\u00fcr \n\neine SPES Testperson im Dezember 2012\nproduziert und real eingesetzt wurde. \nDieses eScrapBook-eBuch entwickelt\/aktualisiert sich weiter.","css":"","h-align":"center","v-align":"center","font-size":"85%","font-family":"Verdana,Geneva,sans-serif"}}}}]}}},{"type":"inset-decorator","options":{"top":30,"left":5,"right":5,"bottom":30},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"split-layout","options":{"ratio":80,"gap":2,"horizontal":false},"slots":{"first":{"type":"video-thing","options":{"uri":"videos\/11\/eScrapBook_Praesentation_IranischeKultur_original.webm","ogg":"","mp4":"","webm":"videos\/11\/eScrapBook_Praesentation_IranischeKultur_original.webm","autoplay":true,"loop":false,"volume":50}},"second":{"type":"text-thing","options":{"html":"Pr\u00e4sentationsvideo des eScrapBook-eBuch \"Iranische Kultur\"","css":"","h-align":"center","v-align":"center","font-size":"50%","font-family":"Verdana,Geneva,sans-serif"}}}}}}}},{"type":"opacity-decorator","options":{"opacity":0},"slots":{"content":{"type":"empty","options":{"css":""}}}}]}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_-_Entwicklungsgeschichte\files
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_-_Entwicklungsgeschichte\files
VELIKOST: 1583 B (1.55 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
{"images\/94\/bookJacket_eScrapBook_F_original.JPG":"images\/94\/bookJacket_eScrapBook_F_original.JPG","images\/98\/Myrousz_original.JPG":"images\/98\/Myrousz_original.JPG","images\/100\/eScrapBook_prototype02_original.JPG":"images\/100\/eScrapBook_prototype02_original.JPG","images\/99\/eScrapBook_prototype01_original.JPG":"images\/99\/eScrapBook_prototype01_original.JPG","images\/101\/img01_original.JPG":"images\/101\/img01_original.JPG","voices\/4\/Entspannungsmusik_Meeresrauschen_original.ogg":"voices\/4\/Entspannungsmusik_Meeresrauschen_original.ogg","images\/102\/eScrapBookWebApp_eBookSchiffahrt_View01_original.JPG":"images\/102\/eScrapBookWebApp_eBookSchiffahrt_View01_original.JPG","images\/139\/eScrapBookWebApp_eBookSchiffahrt_View02_original.JPG":"images\/139\/eScrapBookWebApp_eBookSchiffahrt_View02_original.JPG","images\/140\/img02_original.JPG":"images\/140\/img02_original.JPG","videos\/11\/eScrapBook_Praesentation_IranischeKultur_original.webm":"videos\/11\/eScrapBook_Praesentation_IranischeKultur_original.webm","images\/111\/bg_wood_texture_v02_original.jpg":"images\/111\/bg_wood_texture_v02_original.jpg","images\/95\/bookJacket_eScrapBook_B_original.JPG":"images\/95\/bookJacket_eScrapBook_B_original.JPG","images\/131\/page_L_original.JPG":"images\/131\/page_L_original.JPG","images\/132\/page_R_original.JPG":"images\/132\/page_R_original.JPG","images\/113\/icon_turn_left_256_v01_original.png":"images\/113\/icon_turn_left_256_v01_original.png","images\/114\/icon_turn_right_256_v01_original.png":"images\/114\/icon_turn_right_256_v01_original.png"}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_-_Entwicklungsgeschichte\index.html
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_-_Entwicklungsgeschichte\index.html
VELIKOST: 8685 B (8.48 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>eScrapBook</title>
<link href="images/favicon.ico" type="image/x-icon" rel="icon">
<link href="images/favicon.ico" type="image/x-icon" rel="shortcut icon">
<link rel="stylesheet" type="text/css" href="css/viewer.css">
<link rel="stylesheet" type="text/css" href="css/styles.css">
<script>
    var LocaleStrings = {};
</script>
<script type="text/javascript" src="js/libs-viewer.js"></script>
<script type="text/javascript" src="js/mykkro-viewer.js"></script></head>
<body>
<script>
$(document).ready(function() {
    var book = {"type":"book","options":{"background_image_url":"images\/111\/bg_wood_texture_v02_original.jpg","frontpage_image_url":"images\/94\/bookJacket_eScrapBook_F_original.JPG","backpage_image_url":"images\/95\/bookJacket_eScrapBook_B_original.JPG","oddpage_image_url":"images\/131\/page_L_original.JPG","evenpage_image_url":"images\/132\/page_R_original.JPG","turnleft_image_url":"images\/113\/icon_turn_left_256_v01_original.png","turnright_image_url":"images\/114\/icon_turn_right_256_v01_original.png"},"slots":[{"type":"background-decorator","options":{"image":"images\/94\/bookJacket_eScrapBook_F_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":60,"left":26,"right":16,"bottom":60},"slots":{"content":{"type":"text-thing","options":{"html":"Entwicklungsgeschichte","css":"","h-align":"center","v-align":"center","font-size":"120%","font-family":"Verdana,Geneva,sans-serif"}}}}}},{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"imager","options":{"url":"images\/98\/Myrousz_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}},{"type":"split-layout","options":{"ratio":10,"gap":2,"horizontal":false},"slots":{"first":{"type":"text-thing","options":{"html":"Myrousz \u2013 Bei der Zusammenarbeit mit den Kolleginnen des \n\nFSW","css":"","h-align":"center","v-align":"center","font-size":"50%","font-family":"Verdana,Geneva,sans-serif"}},"second":{"type":"text-thing","options":{"html":"<p><span style=\"color:#4B0082\"><span style=\"font-size:18px\"><span style=\"font-family:verdana,geneva,sans-serif\"><span style=\"background-color:#DAA520\">So wurde eScrapBook geboren...<\/span><\/span><\/span><\/span><\/p>\r\n\r\n<p><span style=\"font-size:18px\"><span style=\"font-family:verdana,geneva,sans-serif\"><span style=\"background-color:#FFD700\">Es war September 2012.<\/span><br \/>\r\n<span style=\"background-color:#FFD700\">Miroslav Uller (Myrousz) von CVUT aus Prag<\/span><br \/>\r\n<span style=\"background-color:#FFD700\">hat FSW Tageszentrum Donaufeld besucht<\/span><br \/>\r\n<span style=\"background-color:#FFD700\">und ersten Prototyp von eScrapBook Web Applikation pr&auml;sentiert.<\/span><\/span><\/span><\/p>\r\n","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}}]}}},{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"grid-layout","options":{"rows":3,"columns":1,"gap":2},"slots":[{"type":"text-thing","options":{"html":"Am Anfang stand die Idee von Christine Petioky, eine \n\nApplikation\nzur Gehirnstimulation zu entwickeln. Sie hat Frau Professor \n\nOlga Stepankova\nvon der CVUT in Prag eine Zusmmanarbeit mit der UNI Wien \n\nund dem FSW vorgeschlagen. ","css":"","h-align":"center","v-align":"center","font-size":"85%","font-family":"Verdana,Geneva,sans-serif"}},{"type":"text-thing","options":{"html":"Es war ein langer Weg, mit vielen Upgrades und weiteren \n\nVerbesserungen\ndes Designs der Benutzeroberfl\u00e4che.","css":"","h-align":"center","v-align":"center","font-size":"85%","font-family":"Verdana,Geneva,sans-serif"}},{"type":"text-thing","options":{"html":"Aber die eScrapBook Web Applikation ist schon da und es steht \n\nuns allen zur Verf\u00fcgung :).","css":"","h-align":"center","v-align":"center","font-size":"120%","font-family":"Verdana,Geneva,sans-serif"}}]}}},{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"imager","options":{"url":"images\/100\/eScrapBook_prototype02_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"contain"}},{"type":"text-thing","options":{"html":"So hat erstes eScrapBook Prototyp  ausgesehen.","css":"","h-align":"center","v-align":"center","font-size":"100%","font-family":"Verdana,Geneva,sans-serif"}}]}}},{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"imager","options":{"url":"images\/99\/eScrapBook_prototype01_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}},{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"imager","options":{"url":"images\/101\/img01_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}},{"type":"split-layout","options":{"ratio":10,"gap":2,"horizontal":false},"slots":{"first":{"type":"audio-decorator","options":{"ogg":"voices\/4\/Entspannungsmusik_Meeresrauschen_original.ogg","mp3":"","uri":"voices\/4\/Entspannungsmusik_Meeresrauschen_original.ogg","autoplay":true,"loop":true,"volume":50},"slots":{"content":{"type":"empty","options":{"css":""}}}},"second":{"type":"text-thing","options":{"html":"UNI Wien hat das erstes eScrapBook-eBuch \"Schiffahrt\" f\u00fcr die \n\ninternenTests vorbereitet.\nDer Titel \"Schiffahrt\" ist absichtlich f\u00fcr die SeniorInnen nach \n\nder alten Rechtschreibregel geschrieben.","css":"","h-align":"center","v-align":"center","font-size":"85%","font-family":"Verdana,Geneva,sans-serif"}}}}]}}},{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"imager","options":{"url":"images\/102\/eScrapBookWebApp_eBookSchiffahrt_View01_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"contain"}},{"type":"imager","options":{"url":"images\/139\/eScrapBookWebApp_eBookSchiffahrt_View02_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"contain"}}]}}},{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"imager","options":{"url":"images\/140\/img02_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}},{"type":"split-layout","options":{"ratio":10,"gap":2,"horizontal":false},"slots":{"first":{"type":"text-thing","options":{"html":"Pr\u00e4sentation f\u00fcr das 4. SCM in Ferrara, IT (19.4.2013)","css":"","h-align":"center","v-align":"center","font-size":"50%","font-family":"Verdana,Geneva,sans-serif"}},"second":{"type":"text-thing","options":{"html":"\"Iranische Kultur\" war das erstes eScrapBook-eBuch, das f\u00fcr \n\neine SPES Testperson im Dezember 2012\nproduziert und real eingesetzt wurde. \nDieses eScrapBook-eBuch entwickelt\/aktualisiert sich weiter.","css":"","h-align":"center","v-align":"center","font-size":"85%","font-family":"Verdana,Geneva,sans-serif"}}}}]}}},{"type":"inset-decorator","options":{"top":30,"left":5,"right":5,"bottom":30},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"split-layout","options":{"ratio":80,"gap":2,"horizontal":false},"slots":{"first":{"type":"video-thing","options":{"uri":"videos\/11\/eScrapBook_Praesentation_IranischeKultur_original.webm","ogg":"","mp4":"","webm":"videos\/11\/eScrapBook_Praesentation_IranischeKultur_original.webm","autoplay":true,"loop":false,"volume":50}},"second":{"type":"text-thing","options":{"html":"Pr\u00e4sentationsvideo des eScrapBook-eBuch \"Iranische Kultur\"","css":"","h-align":"center","v-align":"center","font-size":"50%","font-family":"Verdana,Geneva,sans-serif"}}}}}}}},{"type":"opacity-decorator","options":{"opacity":0},"slots":{"content":{"type":"empty","options":{"css":""}}}}]};
    var bookView = new ExportBookViewer({data:book, fullscreen:true});
    bookView.init();
});
</script>
<div id="fullscreen" style="width: 100%; height: 100%;">
</div>
</body>
</html>
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_-_Entwicklungsgeschichte\README
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_-_Entwicklungsgeschichte\README
VELIKOST: 44 B (44.00 B)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
This is automatically generated README file.
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_-_Entwicklungsgeschichte\RUNeScrapBook
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_-_Entwicklungsgeschichte\RUNeScrapBook
VELIKOST: 49 B (49.00 B)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
#!/bin/bash
chromium-browser --kiosk "index.html"
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_-_Entwicklungsgeschichte\RUNeScrapBook.bat
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_-_Entwicklungsgeschichte\RUNeScrapBook.bat
VELIKOST: 53 B (53.00 B)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
@echo off
start chrome.exe --kiosk "%~dp0index.html"
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_-_Entwicklungsgeschichte\css\combined.css
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_-_Entwicklungsgeschichte\css\combined.css
VELIKOST: 19236 B (18.79 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
/* http://meyerweb.com/eric/tools/css/reset/ 
   v2.0b1 | 201101 
   NOTE: WORK IN PROGRESS
   USE WITH CAUTION AND TEST WITH ABANDON */

html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section, summary,
time, mark, audio, video {
	margin: 0;
	padding: 0;
	border: 0;
	outline: 0;
	font-size: 100%;
	font: inherit;
	vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section {
	display: block;
}
body {
	line-height: 1;
}
ol, ul {
	list-style: none;
}
blockquote, q {
	quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
	content: '';
	content: none;
}

/* remember to define visible focus styles! 
:focus {
	outline: ?????;
} */

/* remember to highlight inserts somehow! */
ins {
	text-decoration: none;
}
del {
	text-decoration: line-through;
}

table {
	border-collapse: collapse;
	border-spacing: 0;
}

.jsoneditor-field, .jsoneditor-value, .jsoneditor-field-readonly, .jsoneditor-readonly {
    border: 1px solid transparent;
    min-height: 16px;
    min-width: 24px;
    padding: 2px;
    margin: 1px;
    outline: none;
    word-wrap: break-word;
    float: left;
}

/* adjust margin of p elements inside editable divs, needed for Opera, IE */
.jsoneditor-field p, .jsoneditor-value p {
    margin: 0;
}

.jsoneditor-value {
    word-break: break-word;
}

.jsoneditor-empty {
    background-color: #E5E5E5;
    border-radius: 2px;
}

.jsoneditor-separator {
    padding: 3px 0;
    vertical-align: top;
}

.jsoneditor-value:focus, .jsoneditor-field:focus,
        .jsoneditor-value:hover, .jsoneditor-field:hover,
        .jsoneditor-search-highlight {
    background-color: #FFFFAB;
    border: 1px solid yellow;
    border-radius: 2px;
}

.jsoneditor-search-highlight-active,
        .jsoneditor-search-highlight-active:focus,
        .jsoneditor-search-highlight-active:hover {
    background-color: #ffee00;
    border: 1px solid #ffc700;
    border-radius: 2px;
}

.jsoneditor-field-readonly:hover {
    border: 1px solid white;
}

.jsoneditor-readonly {
    color: gray;
}

button.jsoneditor-remove, button.jsoneditor-append, button.jsoneditor-duplicate,
button.jsoneditor-collapsed, button.jsoneditor-expanded,
button.jsoneditor-invisible, button.jsoneditor-dragarea,
button.jsoneditor-type-auto, button.jsoneditor-type-string,
button.jsoneditor-type-array, button.jsoneditor-type-object {
    width: 24px;
    height: 24px;
    padding: 0;
    margin: 0;
    border: none;
    cursor: pointer;
    background: url('../img/jsoneditor-icons.png');
}

button:disabled {
    color: #808080;
}

button.jsoneditor-collapsed {
    background-position: -168px 0;
}

button.jsoneditor-expanded {
    background-position: -168px -24px;
}

button.jsoneditor-invisible {
    visibility: hidden;
    background: none;
}

button.jsoneditor-collapsed, button.jsoneditor-expanded,
button.jsoneditor-invisible {
    float: left;
}

button.jsoneditor-remove {
    background-position: -24px -24px;
}
button.jsoneditor-remove:hover {
    background-position: -24px 0;
}

button.jsoneditor-append {
    background-position: 0 -24px;
}
button.jsoneditor-append:hover {
    background-position: 0 0;
}

button.jsoneditor-duplicate {
    background-position: -48px -24px;
}
button.jsoneditor-duplicate:hover {
    background-position: -48px 0;
}

button.jsoneditor-type-string {
    background-position: -144px -24px;
}
button.jsoneditor-type-string:hover {
    background-position: -144px 0;
}

button.jsoneditor-type-auto {
    background-position: -120px -24px;
}
button.jsoneditor-type-auto:hover {
    background-position: -120px 0;
}

button.jsoneditor-type-object {
    background-position: -72px -24px;
}
button.jsoneditor-type-object:hover {
    background-position: -72px 0;
}

button.jsoneditor-type-array {
    background-position: -96px -24px;
}
button.jsoneditor-type-array:hover {
    background-position: -96px 0;
}

div.jsoneditor-select {
    border: 1px solid gray;
    background-color: white;
    box-shadow: 4px 4px 10px rgba(128, 128, 128, 0.5);
}

div.jsoneditor-option {
    color: #4D4D4D;
    background-color: white;

    border: none;
    margin: 0;
    display: block;
    text-align: left;
    cursor: pointer;
}
div.jsoneditor-option:hover {
    background-color: #FFFFAB;
    color: #1A1A1A;
}
div.jsoneditor-option-selected {
    background-color: #D5DDF6;
}
div.jsoneditor-option-text {
    height: 24px;
    line-height: 24px;
    padding: 0 12px 0 0;
    display: inline-block;
}

div.jsoneditor-option-string, div.jsoneditor-option-auto,
div.jsoneditor-option-object, div.jsoneditor-option-array {
    float: left;
    width: 24px;
    height: 24px;
    display: inline-block;
    background: url('../img/jsoneditor-icons.png');
}
div.jsoneditor-option-string {
    background-position: -144px 0;
}
div.jsoneditor-option-auto {
    background-position: -120px 0;
}
div.jsoneditor-option-object {
    background-position: -72px 0;
}
div.jsoneditor-option-array {
    background-position: -96px 0;
}


div.jsoneditor-frame {
    color: #1A1A1A;
    border: 1px solid #97B0F8;
    box-sizing: border-box;
    width: 100%;
    height: 100%;
    overflow: auto;
    position: relative;
    padding: 0;
}

table.jsoneditor-table {
    border-collapse: collapse;
    border-spacing: 0;
    width: 100%;
    margin: 0;
}

div.jsoneditor-content-outer, div.jsonformatter-content {
    width: 100%;
    height: 100%;
    margin: -35px 0 0 0;
    padding: 35px 0 0 0;

    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;

    overflow: hidden;
}

div.jsoneditor-content {
    width: 100%;
    height: 100%;
    position: relative;
    overflow: auto;
}

textarea.jsonformatter-textarea {
    width: 100%;
    height: 100%;
    margin: 0;

    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;

    border: none;
    background-color: white;
    resize: none;
}

tr.jsoneditor-tr-highlight {
    background-color: #FFFFAB;
}

button.jsoneditor-dragarea {
    width: 16px;
    height: 24px;
    /*
    margin: 3px 0;
    background: url('img/dots_gray.gif') top center;
    background-repeat: repeat-y;
    */
    background: url('../img/jsoneditor-icons.png') -220px 0;

    display: block;
    cursor: move;
}

div.jsoneditor-menu {
    width: 100%;
    height: 35px;
    padding: 2px;
    margin: 0;
    overflow: hidden;
    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;

    color: #1A1A1A;
    background-color: #D5DDF6;
    border-bottom: 1px solid #97B0F8;
}

table.jsoneditor-search {
    position: absolute;
    right: 2px;
    top: 2px;
}

table.jsoneditor-search-input {
    border-collapse: collapse;
}

div.jsoneditor-search {
    border: 1px solid #97B0F8;
    background-color: white;
    padding: 0 2px;
    margin: 0;
}

input.jsoneditor-search {
    width: 120px;
    border: none;
    outline: none;
    margin: 1px;
}

div.jsoneditor-search-results {
    color: #4d4d4d;
    padding-right: 5px;
}

button.jsoneditor-search-refresh, button.jsoneditor-search-next,
        button.jsoneditor-search-previous {
    width: 16px;
    height: 24px;
    padding: 0;
    margin: 0;
    border: none;
    background: url('../img/jsoneditor-icons.png');
    vertical-align: top;
}

button.jsoneditor-search-refresh {
    width: 18px;
    background-position: -243px -25px;
}

button.jsoneditor-search-next {
    cursor: pointer;
    background-position: -268px -25px;
}
button.jsoneditor-search-next:hover {
    background-position: -268px -1px;
}

button.jsoneditor-search-previous {
    cursor: pointer;
    background-position: -292px -25px;
    margin-right: 2px;
}
button.jsoneditor-search-previous:hover {
    background-position: -292px -1px;
}


button.jsoneditor-menu {
    width: 26px;
    height: 26px;
    margin: 2px;
    padding: 2px;
    border-radius: 2px;
    border: 1px solid #aec0f8;
    background: #e3eaf6 url('../img/jsoneditor-icons.png');
}

button.jsoneditor-menu:hover {
    background-color: #f0f2f5;
}
button.jsoneditor-menu:active {
    background-color: #ffffff;
}
button.jsoneditor-menu:disabled {
    background-color: #e3eaf6;
}

button.jsoneditor-collapse-all {
    background-position: -312px 0;
}
button.jsoneditor-expand-all {
    background-position: -312px -24px;
}
button.jsoneditor-undo {
    background-position: -336px 0;
}
button.jsoneditor-redo {
    background-position: -360px 0;
}
button.jsoneditor-undo:disabled {
    background-position: -336px -24px;
}
button.jsoneditor-redo:disabled {
    background-position: -360px -24px;
}
/* TODO: css for button:disabled is not supported by IE8 */
button.jsoneditor-compact {
    background-position: -384px 0;
}
button.jsoneditor-format {
    background-position: -384px -24px;
}


tr, th, td {
    padding: 0;
    margin: 0;
}

td.jsoneditor-td {
    vertical-align: top;
}

td.jsoneditor-td {
    padding: 0 3px;
}

td.jsoneditor-td-edit {
    background-color: #F5F5F5;
    padding: 0;
}

td.jsoneditor-td-tree {
    vertical-align: top;
}

td.jsoneditor-droparea {
    height: 24px;

    border-top: 1px dashed gray;
    border-bottom: 1px dashed gray;
    background-color: #FFFF80;
}

.jsoneditor-field, .jsoneditor-value, .jsoneditor-td, .jsoneditor-th,
.jsoneditor-type,
.jsonformatter-textarea {
    font-family: droid sans mono, monospace, courier new, courier, sans-serif;
    font-size: 10pt;
    color: #1A1A1A;
}

.jsoneditor-hidden-focus {
    position: absolute;
    left: -1000px;
    top: -1000px;
    border: none;
    outline: none;
}
.toolbar-wrapper {
    display: block;
    position: relative;
}

.toolbar {
    position: absolute;
    bottom: 0;
    right: 0;
    border-radius: 5px; 
    -moz-border-radius: 5px; 
    -webkit-border-radius: 5px; 
    border: 1px solid gray;
    background-color: lightgray;
}


.my-tooltip {
	display: inline;
	position: relative;
}

.my-tooltip:hover:after{
	background: #333;
	background: rgba(0,0,0,.8);
	border-radius: 5px;
	bottom: 26px;
	color: #fff;
	content: attr(data-title);
	left: 20%;
	padding: 5px 15px;
	position: absolute;
	z-index: 98;
    width: 180px;
}

.my-tooltip:hover:before{
	border: solid;
	border-color: #333 transparent;
	border-width: 6px 6px 0 6px;
	bottom: 20px;
	content: "";
	left: 50%;
	position: absolute;
	z-index: 99;
}


/*
.icon-default.icon-hover {
    background-image: url(../images/icons/32/Redo.png);
}
*/


.syntaxhighlighter a,
.syntaxhighlighter div,
.syntaxhighlighter code,
.syntaxhighlighter table,
.syntaxhighlighter table td,
.syntaxhighlighter table tr,
.syntaxhighlighter table tbody,
.syntaxhighlighter table thead,
.syntaxhighlighter table caption,
.syntaxhighlighter textarea {
  -moz-border-radius: 0 0 0 0 !important;
  -webkit-border-radius: 0 0 0 0 !important;
  background: none !important;
  border: 0 !important;
  bottom: auto !important;
  float: none !important;
  height: auto !important;
  left: auto !important;
  line-height: 1.1em !important;
  margin: 0 !important;
  outline: 0 !important;
  overflow: visible !important;
  padding: 0 !important;
  position: static !important;
  right: auto !important;
  text-align: left !important;
  top: auto !important;
  vertical-align: baseline !important;
  width: auto !important;
  box-sizing: content-box !important;
  font-family: "Consolas", "Bitstream Vera Sans Mono", "Courier New", Courier, monospace !important;
  font-weight: normal !important;
  font-style: normal !important;
  font-size: 1em !important;
  min-height: inherit !important;
  min-height: auto !important;
}

.syntaxhighlighter {
  width: 100% !important;
  margin: 1em 0 1em 0 !important;
  position: relative !important;
  overflow-x: auto !important;
  overflow-y: hidden !important;
  font-size: 1em !important;
}
.syntaxhighlighter.source {
  overflow: hidden !important;
}
.syntaxhighlighter .bold {
  font-weight: bold !important;
}
.syntaxhighlighter .italic {
  font-style: italic !important;
}
.syntaxhighlighter .line {
  white-space: pre !important;
}
.syntaxhighlighter table {
  width: 100% !important;
}
.syntaxhighlighter table caption {
  text-align: left !important;
  padding: .5em 0 0.5em 1em !important;
}
.syntaxhighlighter table td.code {
  width: 100% !important;
}
.syntaxhighlighter table td.code .container {
  position: relative !important;
}
.syntaxhighlighter table td.code .container textarea {
  box-sizing: border-box !important;
  position: absolute !important;
  left: 0 !important;
  top: 0 !important;
  width: 100% !important;
  height: 100% !important;
  border: none !important;
  background: white !important;
  padding-left: 1em !important;
  overflow: hidden !important;
  white-space: pre !important;
}
.syntaxhighlighter table td.gutter .line {
  text-align: right !important;
  padding: 0 0.5em 0 1em !important;
}
.syntaxhighlighter table td.code .line {
  padding: 0 1em !important;
}
.syntaxhighlighter.nogutter td.code .container textarea, .syntaxhighlighter.nogutter td.code .line {
  padding-left: 0em !important;
}
.syntaxhighlighter.show {
  display: block !important;
}
.syntaxhighlighter.collapsed table {
  display: none !important;
}
.syntaxhighlighter.collapsed .toolbar {
  padding: 0.1em 0.8em 0em 0.8em !important;
  font-size: 1em !important;
  position: static !important;
  width: auto !important;
  height: auto !important;
}
.syntaxhighlighter.collapsed .toolbar span {
  display: inline !important;
  margin-right: 1em !important;
}
.syntaxhighlighter.collapsed .toolbar span a {
  padding: 0 !important;
  display: none !important;
}
.syntaxhighlighter.collapsed .toolbar span a.expandSource {
  display: inline !important;
}
.syntaxhighlighter .toolbar {
  position: absolute !important;
  right: 1px !important;
  top: 1px !important;
  width: 11px !important;
  height: 11px !important;
  font-size: 10px !important;
  z-index: 10 !important;
}
.syntaxhighlighter .toolbar span.title {
  display: inline !important;
}
.syntaxhighlighter .toolbar a {
  display: block !important;
  text-align: center !important;
  text-decoration: none !important;
  padding-top: 1px !important;
}
.syntaxhighlighter .toolbar a.expandSource {
  display: none !important;
}
.syntaxhighlighter.ie {
  font-size: .9em !important;
  padding: 1px 0 1px 0 !important;
}
.syntaxhighlighter.ie .toolbar {
  line-height: 8px !important;
}
.syntaxhighlighter.ie .toolbar a {
  padding-top: 0px !important;
}
.syntaxhighlighter.printing .line.alt1 .content,
.syntaxhighlighter.printing .line.alt2 .content,
.syntaxhighlighter.printing .line.highlighted .number,
.syntaxhighlighter.printing .line.highlighted.alt1 .content,
.syntaxhighlighter.printing .line.highlighted.alt2 .content {
  background: none !important;
}
.syntaxhighlighter.printing .line .number {
  color: #bbbbbb !important;
}
.syntaxhighlighter.printing .line .content {
  color: black !important;
}
.syntaxhighlighter.printing .toolbar {
  display: none !important;
}
.syntaxhighlighter.printing a {
  text-decoration: none !important;
}
.syntaxhighlighter.printing .plain, .syntaxhighlighter.printing .plain a {
  color: black !important;
}
.syntaxhighlighter.printing .comments, .syntaxhighlighter.printing .comments a {
  color: #008200 !important;
}
.syntaxhighlighter.printing .string, .syntaxhighlighter.printing .string a {
  color: blue !important;
}
.syntaxhighlighter.printing .keyword {
  color: #006699 !important;
  font-weight: bold !important;
}
.syntaxhighlighter.printing .preprocessor {
  color: gray !important;
}
.syntaxhighlighter.printing .variable {
  color: #aa7700 !important;
}
.syntaxhighlighter.printing .value {
  color: #009900 !important;
}
.syntaxhighlighter.printing .functions {
  color: #ff1493 !important;
}
.syntaxhighlighter.printing .constants {
  color: #0066cc !important;
}
.syntaxhighlighter.printing .script {
  font-weight: bold !important;
}
.syntaxhighlighter.printing .color1, .syntaxhighlighter.printing .color1 a {
  color: gray !important;
}
.syntaxhighlighter.printing .color2, .syntaxhighlighter.printing .color2 a {
  color: #ff1493 !important;
}
.syntaxhighlighter.printing .color3, .syntaxhighlighter.printing .color3 a {
  color: red !important;
}
.syntaxhighlighter.printing .break, .syntaxhighlighter.printing .break a {
  color: black !important;
}
.syntaxhighlighter {
  background-color: white !important;
}
.syntaxhighlighter .line.alt1 {
  background-color: white !important;
}
.syntaxhighlighter .line.alt2 {
  background-color: white !important;
}
.syntaxhighlighter .line.highlighted.alt1, .syntaxhighlighter .line.highlighted.alt2 {
  background-color: #e0e0e0 !important;
}
.syntaxhighlighter .line.highlighted.number {
  color: black !important;
}
.syntaxhighlighter table caption {
  color: black !important;
}
.syntaxhighlighter .gutter {
  color: #afafaf !important;
}
.syntaxhighlighter .gutter .line {
  border-right: 3px solid #6ce26c !important;
}
.syntaxhighlighter .gutter .line.highlighted {
  background-color: #6ce26c !important;
  color: white !important;
}
.syntaxhighlighter.printing .line .content {
  border: none !important;
}
.syntaxhighlighter.collapsed {
  overflow: visible !important;
}
.syntaxhighlighter.collapsed .toolbar {
  color: blue !important;
  background: white !important;
  border: 1px solid #6ce26c !important;
}
.syntaxhighlighter.collapsed .toolbar a {
  color: blue !important;
}
.syntaxhighlighter.collapsed .toolbar a:hover {
  color: red !important;
}
.syntaxhighlighter .toolbar {
  color: white !important;
  background: #6ce26c !important;
  border: none !important;
}
.syntaxhighlighter .toolbar a {
  color: white !important;
}
.syntaxhighlighter .toolbar a:hover {
  color: black !important;
}
.syntaxhighlighter .plain, .syntaxhighlighter .plain a {
  color: black !important;
}
.syntaxhighlighter .comments, .syntaxhighlighter .comments a {
  color: #008200 !important;
}
.syntaxhighlighter .string, .syntaxhighlighter .string a {
  color: blue !important;
}
.syntaxhighlighter .keyword {
  color: #006699 !important;
}
.syntaxhighlighter .preprocessor {
  color: gray !important;
}
.syntaxhighlighter .variable {
  color: #aa7700 !important;
}
.syntaxhighlighter .value {
  color: #009900 !important;
}
.syntaxhighlighter .functions {
  color: #ff1493 !important;
}
.syntaxhighlighter .constants {
  color: #0066cc !important;
}
.syntaxhighlighter .script {
  font-weight: bold !important;
  color: #006699 !important;
  background-color: none !important;
}
.syntaxhighlighter .color1, .syntaxhighlighter .color1 a {
  color: gray !important;
}
.syntaxhighlighter .color2, .syntaxhighlighter .color2 a {
  color: #ff1493 !important;
}
.syntaxhighlighter .color3, .syntaxhighlighter .color3 a {
  color: red !important;
}

.syntaxhighlighter .keyword {
  font-weight: bold !important;
}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_-_Entwicklungsgeschichte\css\styles.css
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_-_Entwicklungsgeschichte\css\styles.css
VELIKOST: 47135 B (46.03 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
.hello-widget .area{width:200px;height:200px;background-color:#abc;display:block;position:relative;cursor:crosshair;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.hello-widget .pointer{position:absolute;left:0px;top:0px;width:10px;height:10px;background-color:blue;cursor:crosshair;-webkit-border-radius:5px;-moz-border-radius:5px;border-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:5px;padding:10px}.hello-widget .coords{height:10%;padding-top:45%;text-align:center;width:100%;cursor:crosshair;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.my-paddy{width:100px;height:100px;background-color:orange;position:relative}.my-paddy > .my-paddy-picker{width:10px;height:10px;background-color:blue;position:absolute}.jsoneditor-widget{background-color:white}.fiddles.form .textarea textarea{width:400px;height:200px;font-family:monospace;font-size:12px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.fiddles.form .jsoneditor-widget{width:400px}.editable-editor .fieldset fieldset{border:none;padding:0px}.ui-mykkro-fieldset,.ui-mykkro-titled,.ui-mykkro-optional{margin-bottom:5px}.ui-mykkro-fieldset > .ui-widget-header,.ui-mykkro-titled > .ui-widget-header,.ui-mykkro-optional > .ui-widget-header{padding:3px;position:relative;background:#ccc;color:black;border-color:#aaa}.ui-mykkro-fieldset > .ui-widget-content,.ui-mykkro-titled > .ui-widget-content,.ui-mykkro-optional > .ui-widget-content{padding:3px 20px;position:relative;background:#ddd;border-color:#aaa}.ui-mykkro-fieldset legend{display:block;width:100%;margin:0;padding:0;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.slider input{text-align:center;width:50px}.mykkro-thing{display:block;width:100%;height:100%}.mykkro-html{overflow:hidden;position:relative}.mykkro-html > div{overflow:hidden;position:absolute;width:100%}.mykkro-ajax{width:auto;height:auto}.mykkro-empty{background-color:#aaa;border:1px solid #666;display:-moz-box;-moz-box-orient:horizontal;-moz-box-pack:center;-moz-box-align:center;display:-webkit-box;-webkit-box-orient:horizontal;-webkit-box-pack:center;-webkit-box-align:center;display:box;box-orient:horizontal;box-pack:center;box-align:center;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;font-size:12px;opacity:0.7}.mykkro-editable > .editable-pane{width:385px;height:530px;display:inline-block;padding:10px;border:1px gray solid}.mykkro-editable > .editable-editor{width:392px;height:540px;display:inline-block;vertical-align:top;margin-left:12px;overflow:auto}.mykkro-clickable > div{width:100%;height:100%}.mykkro-clickable > .clickable-pane{position:absolute;background-color:#666;left:0px;top:0px;opacity:0}.mykkro-clickable > .clickable-pane:hover{opacity:0.3}.mykkro-clickable{position:relative}.mykkro-soft-text-editor{width:500px;height:200px}.mykkro-soft-text-editor > .textfield{padding:5px;vertical-align:top;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;display:inline-block;width:80%;height:30%}.mykkro-soft-text-editor > .textfield > textarea{width:100%;height:100%;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:10px;padding:10px;padding:4px;border:1px solid black;font-size:20px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.mykkro-soft-text-editor > .btn{display:inline-block;width:20%;height:30%;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;padding:5px}.mykkro-soft-text-editor > .btn > button{-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:10px;padding:10px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;height:100%;text-align:center}.mykkro-soft-text-editor > .mykkro-soft-keyboard{height:70%}.mykkro-soft-keyboard > div{position:relative;height:100%}.mykkro-soft-keyboard > div .key{position:absolute;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;padding:5px}.mykkro-soft-keyboard > div .key > div{-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;text-align:center;width:100%;height:100%;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:10px;padding:10px}.mykkro-soft-keyboard > div .key.active > div{background-color:#cfc}.mykkro-soft-keyboard > div .key:hover > div{background-color:#aaa}.mykkro-soft-keyboard > div .key.active:hover > div{background-color:#afa}.mykkro-modal .mykkro-soft-text-editor{width:100%;height:550px}.mykkro-modal .mykkro-soft-text-editor .key{font-size:36px}.mykkro-modal .mykkro-soft-text-editor .key > div{padding-top:20px}.mykkro-modal .mykkro-soft-text-editor .key.key-caps,.mykkro-modal .mykkro-soft-text-editor .key.key-del,.mykkro-modal .mykkro-soft-text-editor .key.key-space,.mykkro-modal .mykkro-soft-text-editor .key.key-enter,.mykkro-modal .mykkro-soft-text-editor .key.key-nums{background:#ddd;background:-webkit-gradient(linear,left bottom,left top,color-stop(0,#bbb),color-stop(1,#ddd));background:-ms-linear-gradient(bottom,#bbb,#ddd);background:-moz-linear-gradient(center bottom,#bbb 0%,#ddd 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#dddddd', endColorstr='#bbbbbb', GradientType=0)}.mykkro-modal .mykkro-soft-text-editor .done{font-size:30px;background:#afa;background:-webkit-gradient(linear,left bottom,left top,color-stop(0,#4f4),color-stop(1,#afa));background:-ms-linear-gradient(bottom,#4f4,#afa);background:-moz-linear-gradient(center bottom,#4f4 0%,#afa 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#aaffaa', endColorstr='#44ff44', GradientType=0)}.mykkro-calendar > div{width:100%;height:100%}.mykkro-text-thing{display:table;overflow:hidden}.mykkro-html.mykkro-text-thing > div{position:relative;display:table-cell;vertical-align:middle;text-align:center;width:100%;margin:0 auto}.mykkro-html.mykkro-text-thing > div.top{vertical-align:top}.mykkro-html.mykkro-text-thing > div.bottom{vertical-align:bottom}.mykkro-html.mykkro-text-thing > div.left{text-align:left}.mykkro-html.mykkro-text-thing > div.right{text-align:right}.mykkro-html.mykkro-text-thing{font-size:20px;line-height:130%;font-family:Georgia, serif}.mykkro-preview{-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.mykkro-preview > *{border:1px solid #333;background-color:white}.mykkro-preview .mykkro-empty > div{display:none}.mykkro-dummy{position:relative}.mykkro-dummy > div{overflow:hidden;position:absolute;width:100%}.mykkro-imager > div{width:100%;height:100%}.mykkro-centering-decorator{width:100%;height:100%;text-align:center;display:table}.mykkro-centering-decorator .center2{display:table-cell;vertical-align:middle}.mykkro-centering-decorator .center2 .center3{margin:0 auto;display:block}.mykkro-centering-decorator .center2 .center3 .content-inner{margin:0 auto;display:inline-block;text-align:left}.mykkro-page{border:1px solid black}#fullscreen{display:block;height:100%;overflow:hidden}#fullscreen #book-wrapper >.icon-turn-left{background-image:url("../images/icon-turn-left-256.png")}#fullscreen #book-wrapper >.icon-turn-right{background-image:url("../images/icon-turn-right-256.png")}#book-wrapper{margin:0 auto;background-repeat:repeat;padding:19px 59px;width:920px;height:600px;-webkit-border-top-right-radius:10px;-webkit-border-bottom-right-radius:10px;-webkit-border-bottom-left-radius:10px;-webkit-border-top-left-radius:10px;-moz-border-radius-topright:10px;-moz-border-radius-bottomright:10px;-moz-border-radius-bottomleft:10px;-moz-border-radius-topleft:10px;border-top-right-radius:10px;border-bottom-right-radius:10px;border-bottom-left-radius:10px;border-top-left-radius:10px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}#book-wrapper > .mykkro-book{margin:0 auto}.mykkro-book.turnable > div > div > .mykkro-slot{background-color:white;width:400px;height:560px}.mykkro-book.basic{width:auto;height:auto}.mykkro-book.basic > .mykkro-slot{background-color:white;width:500px;height:700px}.mykkro-flow-layout > div{display:inline-block;vertical-align:bottom;padding:5px}.mykkro-stack-layout{position:relative;width:100%;height:100%}.mykkro-stack-layout > div{position:absolute;overflow:hidden}.mykkro-split-layout{position:relative}.mykkro-split-layout > div{position:absolute;overflow:hidden}.mykkro-grid-layout{position:relative}.mykkro-grid-layout > div{position:absolute;overflow:hidden}.sudoku-board{display:table;table-layout:fixed;width:100%;height:100%;border:#aaa solid 2px;color:#777;border-spacing:0px;border-collapse:separate}.sudoku-row{display:table-row}.sudoku-square{display:table-cell}.sudoku-square-in{display:table;table-layout:fixed;width:100%;height:100%;border:#aaa solid 1px;color:#777;border-spacing:0px;border-collapse:separate}.sudoku-smallrow{display:table-row}.sudoku-cell{display:table-cell}.sudoku-cell-in{display:table;table-layout:fixed;width:100%;height:100%;border:#aaa dashed 1px;color:#777;border-spacing:0px;border-collapse:separate;text-align:center}.sudoku-cell-cell{display:table-cell;vertical-align:middle}.mykkro-player-controls > .controls{opacity:1}.mykkro-player-controls > .controls.playing{opacity:0.5}.mykkro-player-controls > .controls > button{width:128px;height:128px;background-size:100%;background-color:transparent;background-repeat:no-repeat;border:none;margin-right:10px}.mykkro-player-controls > .controls > button.play{background-image:url('../images/icons/128/media_playback_start.png')}.mykkro-player-controls > .controls > button.pause{background-image:url('../images/icons/128/media_playback_pause.png');width:80px;height:80px}.mykkro-player-controls > .controls > button.stop{background-image:url('../images/icons/128/media_playback_stop.png');width:80px;height:80px}.mykkro-player-controls > .controls > button > span{display:none}.mykkro-preview .mykkro-player-controls > .controls > button{width:32px;height:32px;margin-right:4px}.mykkro-preview .mykkro-player-controls > .controls > button.pause,.mykkro-preview .mykkro-player-controls > .controls > button.stop{width:24px;height:24px}.mykkro-audio-decorator{position:relative}.mykkro-audio-decorator > .player{position:absolute;left:0px;top:0px}.mykkro-audio-decorator > .player .controls{opacity:0.5}.mykkro-audio-decorator > .player .controls.playing{opacity:0.3}.mykkro-audio-decorator > .player:hover .controls{opacity:1}.mykkro-audio-decorator > .player:hover .controls.playing{opacity:0.5}.mykkro-audio-decorator > .slot{width:100%;height:100%}.mykkro-video-thing{position:relative}.mykkro-video-thing > .player{position:absolute;left:0px;top:0px}.mykkro-video-thing > .player .controls{opacity:0.5}.mykkro-video-thing > .player .controls.playing{opacity:0}.mykkro-video-thing > .player:hover .controls{opacity:1}.mykkro-video-thing > .player:hover .controls.playing{opacity:0.5}.mykkro-video-thing > video{width:100%;height:100%}.mykkro-toolbar-decorator-content{width:100%;height:100%}.mykkro-modal .mykkro-page-decorator{height:auto}.mykkro-modal .mykkro-ajax-pager .mykkro-ajax{height:530px}.panel-body .pager{padding:10px 0px}.panel-body .pager span,.panel-body .pager a{display:inline-block;margin:3px;width:30px;height:20px;line-height:20px;background-color:#def;border:1px solid #aaa;text-align:center}.panel-body .pager span{background-color:#abc;font-weight:bold}.mykkro-preview .mykkro-html.mykkro-text-thing{font-size:8px}.mykkro-ajax-pager > .pager-controls{text-align:center;padding:4px}.mykkro-ajax-pager > .pager-controls > *{padding:0px 4px}.mykkro-inset-decorator,.mykkro-border-decorator{-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.mykkro-rounded-decorator{-webkit-mask-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAA5JREFUeNpiYGBgAAgwAAAEAAGbA+oJAAAAAElFTkSuQmCC);overflow:hidden;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.pageditor-widget{position:relative}.pageditor-widget .mykkro-page{background-color:white}form #tree-view-container{background-color:azure}#tree-view-container{position:absolute;left:516px;top:0px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:#eeecdd;border:1px solid #aaa;padding:10px;width:390px;height:700px;overflow:auto}#tree-view{display:block;color:black}#tree-view h2{font-size:12px;padding:3px;height:12px;margin-bottom:2px}#tree-view h3{display:inline-block;float:left;font-size:12px;padding:3px;height:12px;display:inline-block;width:50px;margin-right:10px;margin-bottom:2px;text-align:center;-webkit-border-top-right-radius:10px;-webkit-border-bottom-right-radius:10px;-webkit-border-bottom-left-radius:10px;-webkit-border-top-left-radius:10px;-moz-border-radius-topright:10px;-moz-border-radius-bottomright:10px;-moz-border-radius-bottomleft:10px;-moz-border-radius-topleft:10px;border-top-right-radius:10px;border-bottom-right-radius:10px;border-bottom-left-radius:10px;border-top-left-radius:10px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;background-color:lightblue}#tree-view h3.collapsed{background-color:#ccc}#tree-view .node{display:block;margin-left:20px}#tree-view > .node{margin-left:0px}#tree-view .slots.collapsed{display:none}#tree-view .tools{display:inline-block}#tree-view .tools > .toolbar{position:relative;border:none;background:none}#tree-view h2{display:inline-block}body{width:100%;*zoom:1}body:before,body:after{content:"";display:table}body:after{clear:both}.icon-link-bg{display:inline-block}.panel .icon-link-bg,.dashboard-items .icon-link-bg,input[type='submit']{background-image:-moz-linear-gradient(top,#ddd,#c4c4c4);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#ddd),color-stop(1,#c4c4c4));border-radius:16px;border:1px solid #aaaaaa;-webkit-border-radius:16px;-moz-border-radius:16px;text-decoration:none;text-shadow:#ddd 0 1px 0;padding:3px 8px;margin:2px;display:inline-block}input[type='submit']{background-image:-moz-linear-gradient(top,#ccf,#9999ff);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#ccf),color-stop(1,#9999ff));color:#000;text-shadow:#ccf 0 1px 0;font-weight:normal;padding:5px 15px}input[type='submit']:hover{background-image:-moz-linear-gradient(top,#8f8fff,#5c5cff);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#8f8fff),color-stop(1,#5c5cff))}.panel .icon-link-bg.danger{background-image:-moz-linear-gradient(top,#fbb,#ff8888);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#fbb),color-stop(1,#ff8888));color:#000000;text-shadow:#fbb 0 1px 0;font-weight:normal}.panel .icon-link-bg.danger:hover{background-image:-moz-linear-gradient(top,#ff8383,#ff5050);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#ff8383),color-stop(1,#ff5050))}.panel .icon-link-bg.download{background-image:-moz-linear-gradient(top,#afa,#77ff77);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#afa),color-stop(1,#77ff77));color:#000000;text-shadow:#afa 0 1px 0;font-weight:normal}.panel .icon-link-bg.download:hover{background-image:-moz-linear-gradient(top,#77d977,#4fce4f);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#77d977),color-stop(1,#4fce4f))}.panel .icon-link-bg:hover,.dashboard-items .icon-link-bg:hover{background-image:-moz-linear-gradient(top,#c7c7c7,#adadad);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#c7c7c7),color-stop(1,#adadad))}.icon-link{display:inline-block;height:16px;line-height:16px;padding-left:20px;font-size:13px}a.icon-link,a.icon-link:link,a.icon-link:hover,a.icon-link:visited,a.icon-link:active{font-weight:300;color:#000}.icon-button{display:inline-block;background-size:cover;background-repeat:no-repeat no-repeat}.icon{display:block;background-size:cover;background-repeat:no-repeat no-repeat}.icon-12,.icon-tiny{width:12px;height:12px}.icon-16,.icon-small{width:16px;height:16px}.icon-24,.icon-medium{width:24px;height:24px}.icon-32,.icon-big{width:32px;height:32px}.icon-48,.icon-huge{width:48px;height:48px}.icon-snippet{background-color:transparent;background-image:url('../images/icons/48/snippet.png');background-repeat:no-repeat;background-position:left top}.icon-book{background-color:transparent;background-image:url('../images/icons/48/book.png');background-repeat:no-repeat;background-position:left top}.icon-image{background-color:transparent;background-image:url('../images/icons/48/image.png');background-repeat:no-repeat;background-position:left top}.icon-image.icon-32{background-color:transparent;background-image:url('../images/icons/32/Picture.png');background-repeat:no-repeat;background-position:left top}.icon-drawing{background-color:transparent;background-image:url('../images/icons/48/drawing.png');background-repeat:no-repeat;background-position:left top}.icon-drawing.icon-32{background-color:transparent;background-image:url('../images/icons/32/Picture.png');background-repeat:no-repeat;background-position:left top}.icon-note{background-color:transparent;background-image:url('../images/icons/48/note.png');background-repeat:no-repeat;background-position:left top}.icon-fiddle{background-color:transparent;background-image:url('../images/icons/48/fiddle.png');background-repeat:no-repeat;background-position:left top}.icon-todo{background-color:transparent;background-image:url('../images/icons/48/todo.png');background-repeat:no-repeat;background-position:left top}.icon-profile{background-color:transparent;background-image:url('../images/icons/48/profile.png');background-repeat:no-repeat;background-position:left top}.icon-logger{background-color:transparent;background-image:url('../images/icons/48/logger.png');background-repeat:no-repeat;background-position:left top}.icon-nodetype{background-color:transparent;background-image:url('../images/icons/48/nodetype.png');background-repeat:no-repeat;background-position:left top}.icon-plot{background-color:transparent;background-image:url('../images/icons/48/plot.png');background-repeat:no-repeat;background-position:left top}.icon-expression{background-color:transparent;background-image:url('../images/icons/48/expression.png');background-repeat:no-repeat;background-position:left top}.icon-video{background-color:transparent;background-image:url('../images/icons/48/video.png');background-repeat:no-repeat;background-position:left top}.icon-video.icon-32{background-color:transparent;background-image:url('../images/icons/32/Movie.png');background-repeat:no-repeat;background-position:left top}.icon-voice.icon-32{background-color:transparent;background-image:url('../images/icons/32/speaker-icon.png');background-repeat:no-repeat;background-position:left top}.icon-voice{background-color:transparent;background-image:url('../images/icons/48/voice.png');background-repeat:no-repeat;background-position:left top}.icon-article{background-color:transparent;background-image:url('../images/icons/48/article.png');background-repeat:no-repeat;background-position:left top}.icon-article.icon-32{background-color:transparent;background-image:url('../images/icons/32/article.png');background-repeat:no-repeat;background-position:left top}.icon-text{background-color:transparent;background-image:url('../images/icons/32/Edit text.png');background-repeat:no-repeat;background-position:left top}.icon-design{background-color:transparent;background-image:url('../images/icons/48/design.png');background-repeat:no-repeat;background-position:left top}.icon-design.icon-32{background-color:transparent;background-image:url('../images/icons/32/layout.png');background-repeat:no-repeat;background-position:left top}.icon-settings{background-color:transparent;background-image:url('../images/icons/48/settings.png');background-repeat:no-repeat;background-position:left top}.icon-settings.icon-32{background-color:transparent;background-image:url('../images/icons/32/Settings.png');background-repeat:no-repeat;background-position:left top}.icon-show-all{background-color:transparent;background-image:url('../images/icons/16/show-all.png');background-repeat:no-repeat;background-position:left top}.icon-view{background-color:transparent;background-image:url('../images/icons/16/view.png');background-repeat:no-repeat;background-position:left top}.icon-edit{background-color:transparent;background-image:url('../images/icons/16/edit.png');background-repeat:no-repeat;background-position:left top}.icon-add-page{background-color:transparent;background-image:url('../images/icons/16/db_add.png');background-repeat:no-repeat;background-position:left top}.icon-remove-page{background-color:transparent;background-image:url('../images/icons/16/db_remove.png');background-repeat:no-repeat;background-position:left top}.icon-add{background-color:transparent;background-image:url('../images/icons/16/add.png');background-repeat:no-repeat;background-position:left top}.icon-remove-16{background-color:transparent;background-image:url('../images/icons/16/delete.png');background-repeat:no-repeat;background-position:left top}.icon-remove{background-color:transparent;background-image:url('../images/icons/32/Erase.png');background-repeat:no-repeat;background-position:left top}.icon-remove.icon-16{background-color:transparent;background-image:url('../images/icons/16/delete.png');background-repeat:no-repeat;background-position:left top}.icon-bomb{background-color:transparent;background-image:url('../images/icons/32/bomb.png');background-repeat:no-repeat;background-position:left top}.icon-favorites{background-color:transparent;background-image:url('../images/icons/32/Favourites.png');background-repeat:no-repeat;background-position:left top}.icon-export-16{background-color:transparent;background-image:url('../images/icons/16/Export.png');background-repeat:no-repeat;background-position:left top}.icon-export{background-color:transparent;background-image:url('../images/icons/32/Export.png');background-repeat:no-repeat;background-position:left top}.icon-export.icon-16{background-color:transparent;background-image:url('../images/icons/16/Export.png');background-repeat:no-repeat;background-position:left top}.icon-info{background-color:transparent;background-image:url('../images/icons/32/Info.png');background-repeat:no-repeat;background-position:left top}.icon-no{background-color:transparent;background-image:url('../images/icons/32/No.png');background-repeat:no-repeat;background-position:left top}.icon-ok{background-color:transparent;background-image:url('../images/icons/32/Ok.png');background-repeat:no-repeat;background-position:left top}.icon-tools{background-color:transparent;background-image:url('../images/icons/32/Tools.png');background-repeat:no-repeat;background-position:left top}.icon-play{background-color:transparent;background-image:url('../images/icons/32/Play.png');background-repeat:no-repeat;background-position:left top}.icon-preview{background-color:transparent;background-image:url('../images/icons/32/Preview.png');background-repeat:no-repeat;background-position:left top}.icon-refresh{background-color:transparent;background-image:url('../images/icons/32/Refresh.png');background-repeat:no-repeat;background-position:left top}.icon-undo{background-color:transparent;background-image:url('../images/icons/32/Undo.png');background-repeat:no-repeat;background-position:left top}.icon-yes{background-color:transparent;background-image:url('../images/icons/32/Yes.png');background-repeat:no-repeat;background-position:left top}.icon-warning{background-color:transparent;background-image:url('../images/icons/32/Warning.png');background-repeat:no-repeat;background-position:left top}.icon-default{background-color:transparent;background-image:url('../images/icons/32/Refresh.png');background-repeat:no-repeat;background-position:left top}.icon-home{background-color:transparent;background-image:url('../images/icons/48/kfm_home.png');background-repeat:no-repeat;background-position:left top}.icon-turn-left{background-color:transparent;background-image:url('../images/icons/48/left_turn.png');background-repeat:no-repeat;background-position:left top}.icon-turn-right{background-color:transparent;background-image:url('../images/icons/48/right_turn.png');background-repeat:no-repeat;background-position:left top}.icon-fullscreen-on{background-color:transparent;background-image:url('../images/icons/48/window_fullscreen.png');background-repeat:no-repeat;background-position:left top}.icon-fullscreen-off{background-color:transparent;background-image:url('../images/icons/48/window_nofullscreen.png');background-repeat:no-repeat;background-position:left top}.icon-closebook{background-color:transparent;background-image:url('../images/icons/48/fileclose-red.png');background-repeat:no-repeat;background-position:left top}.icon-hover{opacity:0.5}.icon-regex{background-color:transparent;background-image:url('../images/icons/48/regex.png');background-repeat:no-repeat;background-position:left top}.icon-formula{background-color:transparent;background-image:url('../images/icons/48/formula.png');background-repeat:no-repeat;background-position:left top}.icon-search{background-color:transparent;background-image:url('../images/icons/48/search.png');background-repeat:no-repeat;background-position:left top}.icon-help{background-color:transparent;background-image:url('../images/icons/48/help.png');background-repeat:no-repeat;background-position:left top}.previews > ul > li{position:relative;background-color:#a6c4e1;padding-top:5px;padding-bottom:5px}.previews > ul > li:nth-child(odd){background-color:#cde}.preview{-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;display:block;position:relative;float:left;padding-left:70px;width:100%;min-height:68px}.preview.icon-only{width:68px;height:68px;padding:10px}.preview.image-preview.icon-only{width:100px;height:100px;padding:10px}.preview.video-preview.icon-only{width:200px;height:140px;padding:10px}.preview.drawing-preview.icon-only{width:120px;height:120px;padding:10px}.preview.design-preview.icon-only{width:104px;height:134px;padding:0px}.design-preview{min-height:134px;padding:10px 10px 10px 110px}.image-preview{padding:10px 10px 10px 100px;min-height:100px}.video-preview{padding-left:200px;min-height:140px}.video-preview img{width:180px;height:120px}.drawing-preview{padding-left:120px;min-height:120px}.drawing-preview .drawing-wrapper{width:100px;height:100px}.preview .media-icon{width:48px;height:48px}.preview .media-icon-small{width:24px;height:24px}.preview .media-icon,.image-preview img,.video-preview img,.design-preview .mykkro-preview,.drawing-preview .drawing-wrapper{position:absolute;top:10px;left:10px}.preview .media-icon > svg,.image-preview img > svg,.video-preview img > svg,.design-preview .mykkro-preview > svg,.drawing-preview .drawing-wrapper > svg{position:absolute}.preview h3{font-family:'Quattrocento Sans', sans-serif;font-weight:bold;font-size:20px}.preview .description{font-style:italic;color:#333;margin-bottom:6px}.preview .times{font-size:80%;color:#666}.previews{margin-top:16px;margin-bottom:16px}.previews.single{margin:0}.media-icon{width:48px;height:48px}.touchpad-widget{width:200px;height:200px;background-color:#abc;display:block;position:relative}.touchpad-widget > .pointer{position:absolute;left:0px;top:0px;width:10px;height:10px;background-color:blue}ul.dashboard-menu{list-style:none;margin:0;padding:0;display:block}ul.dashboard-menu li{margin:2px 0px;display:inline-block;vertical-align:top;width:90px;height:90px;background:#eef;background:-moz-linear-gradient(-45deg,#eef 0%,#ccf 100%);background:-webkit-gradient(linear,left top,right bottom,color-stop(0%,#eef),color-stop(100%,#ccf));background:-webkit-linear-gradient(-45deg,#eef 0%,#ccf 100%);background:-o-linear-gradient(-45deg,#eef 0%,#ccf 100%);background:-ms-linear-gradient(-45deg,#eef 0%,#ccf 100%);background:linear-gradient(135deg,#eef 0%,#ccf 100%);text-align:center;font-size:12px;overflow:hidden}ul.dashboard-menu li .dashboard-icon{margin:4px auto}ul.dashboard-menu li a{width:100%;height:100%;display:block;color:black;font-weight:300}ul.dashboard-menu li:hover{background:#eee;background:-moz-linear-gradient(-45deg,#eee 0%,#ccc 100%);background:-webkit-gradient(linear,left top,right bottom,color-stop(0%,#eee),color-stop(100%,#ccc));background:-webkit-linear-gradient(-45deg,#eee 0%,#ccc 100%);background:-o-linear-gradient(-45deg,#eee 0%,#ccc 100%);background:-ms-linear-gradient(-45deg,#eee 0%,#ccc 100%);background:linear-gradient(135deg,#eee 0%,#ccc 100%)}ul.dashboard-menu li.active{background:#fff;background:-moz-linear-gradient(-45deg,#fff 0%,#ddd 100%);background:-webkit-gradient(linear,left top,right bottom,color-stop(0%,#fff),color-stop(100%,#ddd));background:-webkit-linear-gradient(-45deg,#fff 0%,#ddd 100%);background:-o-linear-gradient(-45deg,#fff 0%,#ddd 100%);background:-ms-linear-gradient(-45deg,#fff 0%,#ddd 100%);background:linear-gradient(135deg,#fff 0%,#ddd 100%)}ul.dashboard-menu li.active:hover{background:#eee;background:-moz-linear-gradient(-45deg,#eee 0%,#bbb 100%);background:-webkit-gradient(linear,left top,right bottom,color-stop(0%,#eee),color-stop(100%,#bbb));background:-webkit-linear-gradient(-45deg,#eee 0%,#bbb 100%);background:-o-linear-gradient(-45deg,#eee 0%,#bbb 100%);background:-ms-linear-gradient(-45deg,#eee 0%,#bbb 100%);background:linear-gradient(135deg,#eee 0%,#bbb 100%)}.dashboard-items{margin:10px 0px}.dashboard-icon{width:48px;height:48px}.datagrid-info{margin-bottom:10px;font-weight:bolder}.datagrid table{border-collapse:collapse;text-align:left;width:100%}.datagrid{font:normal 12px/150% Arial, Helvetica, sans-serif;background:#fff;overflow:hidden;border:1px solid #8C8C8C;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px}.datagrid table td,.datagrid table th{padding:3px 10px}.datagrid table thead th{background:-webkit-gradient(linear,left top,left bottom,color-stop(0.05,#8C8C8C),color-stop(1,#7D7D7D));background:-moz-linear-gradient(center top,#8C8C8C 5%,#7D7D7D 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#8C8C8C',endColorstr='#7D7D7D');background-color:#8C8C8C;color:#FFFFFF;font-size:15px;font-weight:bold;border-left:1px solid #A3A3A3}.datagrid table thead th:first-child{border:none}.datagrid table tbody td{color:#7D7D7D;border-left:1px solid #DBDBDB;font-size:12px;font-weight:normal}.datagrid table tbody .alt td{background:#EBEBEB;color:#7D7D7D}.datagrid table tbody td:first-child{border-left:none}.datagrid table tbody tr:last-child td{border-bottom:none}.datagrid table tfoot td div{border-top:1px solid #8C8C8C;background:#EBEBEB}.datagrid table tfoot td{padding:0;font-size:12px}.datagrid table tfoot td div{padding:2px}.datagrid table tfoot td ul{margin:0;padding:0;list-style:none;text-align:right}.datagrid table tfoot li{display:inline}.datagrid table tfoot li a{text-decoration:none;display:inline-block;padding:2px 8px;margin:1px;color:#F5F5F5;border:1px solid #8C8C8C;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;background:-webkit-gradient(linear,left top,left bottom,color-stop(0.05,#8C8C8C),color-stop(1,#7D7D7D));background:-moz-linear-gradient(center top,#8C8C8C 5%,#7D7D7D 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#8C8C8C',endColorstr='#7D7D7D');background-color:#8C8C8C}.datagrid table tfoot ul a.active,.datagrid table tfoot ul a:hover{text-decoration:none;border-color:#7D7D7D;color:#F5F5F5;background:none;background-color:#8C8C8C}input.search{padding:6px 15px 6px 30px;margin:3px;background:url('../images/search.png') no-repeat 8px 6px}input.rounded{border-radius:15px;-moz-border-radius:15px;-webkit-border-radius:15px}input.search[type=text]{color:#bcbcbc;width:400px}form.lighter{padding:5px;border:1px solid #aaa;background-color:#cdcdcd;margin-bottom:10px}form.lighter input[type=text]{border:1px solid #d0d0d0;background-color:#fcfcfc;margin-right:10px}form.lighter fieldset{margin:0px;border:none}form.lighter .sf-nodes li{display:inline-block;margin-right:10px;width:150px}a.search-type-switcher{margin-left:20px;font-size:85%;color:#666}a.search-nodes-all,a.search-nodes-none{margin-right:10px;font-size:85%;color:#666}.sf-nodes ul{margin:12px 0px 6px 0px}.search-result > p{margin-bottom:10px}.search-result .pagination-links a{margin-right:10px;font-size:85%;color:#666}.search-result .previews ol{counter-reset:item;list-style:none}.search-result .previews ol > li{padding:10px 4px;display:list-item;position:relative;font-size:28px;background-color:#a6c4e1}.search-result .previews ol > li:nth-child(odd){background-color:#cde}.search-result .previews ol > li >h3,.search-result .previews ol > li >div,.search-result .previews ol > li >a{font-size:12px}.search-result .previews ol > li:before{content:counter(item) ". ";counter-increment:item;float:left;text-align:right;width:50px}.search-result .previews ol .sf-node{position:relative}.search-result .previews ol .sf-node .title{font-size:16px;font-weight:bold}.search-result .previews ol .sf-node .title a:link{color:#044}.search-result .previews ol .sf-node .title a:hover{color:#033}.search-result .previews ol .sf-node .title.untitled a:link{color:#666}.search-result .previews ol .sf-node .title.untitled a:hover{color:#333}.search-result .previews ol .sf-node .type-title{font-size:12px;font-weight:normal}.search-result .previews ol .sf-node .type-title a:link{color:#aaa}.search-result .previews ol .sf-node .type-title a:hover{color:#666}.search-result .previews ol .sf-node .description{font-size:12px;color:#333;margin-bottom:6px}.search-result .previews ol .sf-node .modified{font-size:10px;color:#666}.search-result .previews.preview-test ol > li > .sf-node-overlay{position:absolute;width:100%;height:100%;z-index:100;top:0;left:0}.search-result .previews.preview-test ol > li > .sf-node-overlay:hover{background-color:cyan;opacity:0.3}.search-result .previews.preview-test ol > li > .sf-node-overlay.preview-loading,.search-result .previews.preview-test ol > li > .sf-node-overlay.preview-loading:hover{background-color:red;opacity:0.1}.search-result .previews.preview-test ol > li .sf-node-preview{position:relative;display:inline-block;vertical-align:top;margin:0px 8px}.search-result .previews.preview-test ol > li .sf-node-info{display:inline-block;vertical-align:top}.search-result .previews.preview-test ol .sf-avatar{width:24px;height:24px;position:absolute;right:-5px;bottom:-5px;display:none}html{font-size:14px;font-family:'Ubuntu', sans-serif;font-weight:300;background-color:#cdcdcd}body{height:100%}#container{width:960px;margin:0 auto;overflow:hidden}#container{background-color:none}#breadcrumb{font-size:13px;padding:6px;float:left}#header{width:100%;padding:10px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.logo{background:#eef url(../images/logo-scrapbook.png) no-repeat left top;width:268px;height:74px;display:inline-block;float:left}.user-controls{font-size:13px;padding:6px;float:right}#content{-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;margin:0px;width:100%}#content #accordion{background-color:#bbb}#content #accordion .ui-accordion-content{border-left:1px solid #aaa;border-right:1px solid #aaa;border-bottom:1px solid #aaa}#footer{width:100%;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;color:#666;padding:16px;text-align:center}h1,h2,h3,h4,h5,h6{font-weight:bolder}h1{font-size:40px;margin-bottom:10px}h2{font-size:34px;margin-bottom:10px}h3{font-size:28px;margin-bottom:8px}h4{font-size:24px;margin-bottom:6px}h5{font-size:20px;margin-bottom:5px}h6{font-size:16px;margin-bottom:4px}strong,b{font-weight:bolder}a:link{text-decoration:none;font-weight:normal;color:#008}a:visited{text-decoration:none;font-weight:normal;color:#008}a:hover{text-decoration:none;font-weight:normal;color:brown}a:active{text-decoration:none;font-weight:normal;color:#008}.clear{clear:both}.ui-accordion-header > a{margin-left:20px}.ui-dialog .ui-dialog-titlebar{background-color:#acf}.ui-dialog .ui-dialog-titlebar .ui-dialog-titlebar-close{margin-top:-10px !important;margin-right:10px !important;padding-top:0px !important}.logged-user .info{margin-right:10px}.autoform form{margin-bottom:1em;background:#eed;border:1px solid #ddd;-webkit-border-radius:2px;-moz-border-radius:2px;border-radius:2px;-moz-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);-webkit-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);-o-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);box-shadow:0 0 8px 2px rgba(0,0,0,0.1);padding:15px;background:#E8e3b1}.autoform form legend{font-weight:bolder;font-size:18px}.autoform form fieldset{padding:10px;background:#e2dc9d;border:1px solid #dcd58a}.autoform form label{padding-bottom:4px}.message{margin:1em;-webkit-border-radius:salmon;-moz-border-radius:salmon;border-radius:salmon;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:salmon;padding:10px;color:black;font-weight:bolder;font-size:16px}#authMessage{background-color:orange}.autoform fieldset{margin-bottom:16px}.autoform label{display:block;font-size:90%;margin-top:6px}.autoform .input input:not([type=submit]):not([type=file]),.autoform .input textarea{width:400px}.richtextfield textarea{width:250px;height:160px}#UserLoginForm fieldset input{width:150px}.input .error-message{color:red;font-size:90%;padding:6px}.panel{margin-bottom:1em;background:#eed;border:1px solid #ddd;-webkit-border-radius:2px;-moz-border-radius:2px;border-radius:2px;-moz-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);-webkit-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);-o-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);box-shadow:0 0 8px 2px rgba(0,0,0,0.1);padding:15px}.panel.main{background:#eed;border:1px solid #ddd;-webkit-border-radius:2px;-moz-border-radius:2px;border-radius:2px;-moz-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);-webkit-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);-o-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);box-shadow:0 0 8px 2px rgba(0,0,0,0.1);padding:15px;background:#fea}.panel.headless .panel-body{margin:0}.avatar{width:90px;height:90px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:#ffe;padding:4px}.user-info .avatar{display:inline-block;vertical-align:top;margin-right:20px}.user-info .other{display:inline-block;vertical-align:top}.panel-body{margin-top:20px}.panel-actions{margin-top:20px}.image-detail > .panel-body > img{max-width:100%}.splash{margin:1em;-webkit-border-radius:maroon;-moz-border-radius:maroon;border-radius:maroon;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:maroon;padding:10px}.splash > ul{margin:20px}.splash > ul > li{font-weight:bolder}.splash > p{margin-bottom:10px}.actions{margin-top:8px}.node >.node-field{padding:5px;-webkit-border-radius:azure;-moz-border-radius:azure;border-radius:azure;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:azure;padding:10px;margin-bottom:5px}.node >.node-field > h3{font-size:14px}.node >.node-field > h4{font-size:12px;font-weight:lighter;color:gray}.mykkro-page-editor-links{margin:6px 0px}.mykkro-page-editor-links > span{display:inline-block;margin-right:2px;padding:4px}.mykkro-page-editor-links > span.number-link{-webkit-border-radius:#eec;-moz-border-radius:#eec;border-radius:#eec;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:#eec;padding:10px;padding:4px;text-align:center}.mykkro-page-editor-links > span.number-link.current{border:2px solid #a00}.mykkro-page-editor-links > span.disabled{display:none}.Web_OnlineTools_Logo{float:left;padding:8px}.Web_OnlineTools_Logo h1{border:0px;margin:0px;padding:0px;text-align:center;text-indent:0px;font-size:40x;line-height:46px;font-family:Trebuchet MS;color:#284460;font-weight:bold;text-shadow:0px 0px 9px #000000}.Web_OnlineTools_Logo h2{border:0px;margin:0px;padding:0px;text-align:center;text-indent:24px;font-size:15px;line-height:20px;font-style:italic;font-family:Trebuchet MS;color:#74777a;text-shadow:-1px 1px 17px #000000}.imagesearch-widget{display:inline-block}.imagesearch-widget .imagesearch-preview{width:50px;height:68px;display:inline-block;margin:8px;vertical-align:top;background-color:#ddf}.imagesearch-widget > button{display:inline-block;vertical-align:top;margin-top:8px}.form .pageditor-widget .mykkro-empty:hover{background-color:#bbb;border:2px dotted #666}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_-_Entwicklungsgeschichte\css\viewer.css
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_-_Entwicklungsgeschichte\css\viewer.css
VELIKOST: 1315 B (1.28 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
/* http://meyerweb.com/eric/tools/css/reset/ 
   v2.0b1 | 201101 
   NOTE: WORK IN PROGRESS
   USE WITH CAUTION AND TEST WITH ABANDON */

html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section, summary,
time, mark, audio, video {
	margin: 0;
	padding: 0;
	border: 0;
	outline: 0;
	font-size: 100%;
	font: inherit;
	vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section {
	display: block;
}
body {
	line-height: 1;
}
ol, ul {
	list-style: none;
}
blockquote, q {
	quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
	content: '';
	content: none;
}

/* remember to define visible focus styles! 
:focus {
	outline: ?????;
} */

/* remember to highlight inserts somehow! */
ins {
	text-decoration: none;
}
del {
	text-decoration: line-through;
}

table {
	border-collapse: collapse;
	border-spacing: 0;
}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_-_Entwicklungsgeschichte\js\libs-viewer.js
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_-_Entwicklungsgeschichte\js\libs-viewer.js
VELIKOST: 371464 B (362.76 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
/*! jQuery v2.0.3 | (c) 2005, 2013 jQuery Foundation, Inc. | jquery.org/license
//@ sourceMappingURL=jquery-2.0.3.min.map
*/
(function(e,undefined){var t,n,r=typeof undefined,i=e.location,o=e.document,s=o.documentElement,a=e.jQuery,u=e.$,l={},c=[],p="2.0.3",f=c.concat,h=c.push,d=c.slice,g=c.indexOf,m=l.toString,y=l.hasOwnProperty,v=p.trim,x=function(e,n){return new x.fn.init(e,n,t)},b=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,w=/\S+/g,T=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,C=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,k=/^-ms-/,N=/-([\da-z])/gi,E=function(e,t){return t.toUpperCase()},S=function(){o.removeEventListener("DOMContentLoaded",S,!1),e.removeEventListener("load",S,!1),x.ready()};x.fn=x.prototype={jquery:p,constructor:x,init:function(e,t,n){var r,i;if(!e)return this;if("string"==typeof e){if(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:T.exec(e),!r||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof x?t[0]:t,x.merge(this,x.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:o,!0)),C.test(r[1])&&x.isPlainObject(t))for(r in t)x.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return i=o.getElementById(r[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):x.isFunction(e)?n.ready(e):(e.selector!==undefined&&(this.selector=e.selector,this.context=e.context),x.makeArray(e,this))},selector:"",length:0,toArray:function(){return d.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=x.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return x.each(this,e,t)},ready:function(e){return x.ready.promise().done(e),this},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(x.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:h,sort:[].sort,splice:[].splice},x.fn.init.prototype=x.fn,x.extend=x.fn.extend=function(){var e,t,n,r,i,o,s=arguments[0]||{},a=1,u=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[1]||{},a=2),"object"==typeof s||x.isFunction(s)||(s={}),u===a&&(s=this,--a);u>a;a++)if(null!=(e=arguments[a]))for(t in e)n=s[t],r=e[t],s!==r&&(l&&r&&(x.isPlainObject(r)||(i=x.isArray(r)))?(i?(i=!1,o=n&&x.isArray(n)?n:[]):o=n&&x.isPlainObject(n)?n:{},s[t]=x.extend(l,o,r)):r!==undefined&&(s[t]=r));return s},x.extend({expando:"jQuery"+(p+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===x&&(e.$=u),t&&e.jQuery===x&&(e.jQuery=a),x},isReady:!1,readyWait:1,holdReady:function(e){e?x.readyWait++:x.ready(!0)},ready:function(e){(e===!0?--x.readyWait:x.isReady)||(x.isReady=!0,e!==!0&&--x.readyWait>0||(n.resolveWith(o,[x]),x.fn.trigger&&x(o).trigger("ready").off("ready")))},isFunction:function(e){return"function"===x.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[m.call(e)]||"object":typeof e},isPlainObject:function(e){if("object"!==x.type(e)||e.nodeType||x.isWindow(e))return!1;try{if(e.constructor&&!y.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||o;var r=C.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=x.buildFragment([e],t,i),i&&x(i).remove(),x.merge([],r.childNodes))},parseJSON:JSON.parse,parseXML:function(e){var t,n;if(!e||"string"!=typeof e)return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(r){t=undefined}return(!t||t.getElementsByTagName("parsererror").length)&&x.error("Invalid XML: "+e),t},noop:function(){},globalEval:function(e){var t,n=eval;e=x.trim(e),e&&(1===e.indexOf("use strict")?(t=o.createElement("script"),t.text=e,o.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(k,"ms-").replace(N,E)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,o=e.length,s=j(e);if(n){if(s){for(;o>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(s){for(;o>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:function(e){return null==e?"":v.call(e)},makeArray:function(e,t){var n=t||[];return null!=e&&(j(Object(e))?x.merge(n,"string"==typeof e?[e]:e):h.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:g.call(t,e,n)},merge:function(e,t){var n=t.length,r=e.length,i=0;if("number"==typeof n)for(;n>i;i++)e[r++]=t[i];else while(t[i]!==undefined)e[r++]=t[i++];return e.length=r,e},grep:function(e,t,n){var r,i=[],o=0,s=e.length;for(n=!!n;s>o;o++)r=!!t(e[o],o),n!==r&&i.push(e[o]);return i},map:function(e,t,n){var r,i=0,o=e.length,s=j(e),a=[];if(s)for(;o>i;i++)r=t(e[i],i,n),null!=r&&(a[a.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(a[a.length]=r);return f.apply([],a)},guid:1,proxy:function(e,t){var n,r,i;return"string"==typeof t&&(n=e[t],t=e,e=n),x.isFunction(e)?(r=d.call(arguments,2),i=function(){return e.apply(t||this,r.concat(d.call(arguments)))},i.guid=e.guid=e.guid||x.guid++,i):undefined},access:function(e,t,n,r,i,o,s){var a=0,u=e.length,l=null==n;if("object"===x.type(n)){i=!0;for(a in n)x.access(e,t,a,n[a],!0,o,s)}else if(r!==undefined&&(i=!0,x.isFunction(r)||(s=!0),l&&(s?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(x(e),n)})),t))for(;u>a;a++)t(e[a],n,s?r:r.call(e[a],a,t(e[a],n)));return i?e:l?t.call(e):u?t(e[0],n):o},now:Date.now,swap:function(e,t,n,r){var i,o,s={};for(o in t)s[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=s[o];return i}}),x.ready.promise=function(t){return n||(n=x.Deferred(),"complete"===o.readyState?setTimeout(x.ready):(o.addEventListener("DOMContentLoaded",S,!1),e.addEventListener("load",S,!1))),n.promise(t)},x.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()});function j(e){var t=e.length,n=x.type(e);return x.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}t=x(o),function(e,undefined){var t,n,r,i,o,s,a,u,l,c,p,f,h,d,g,m,y,v="sizzle"+-new Date,b=e.document,w=0,T=0,C=st(),k=st(),N=st(),E=!1,S=function(e,t){return e===t?(E=!0,0):0},j=typeof undefined,D=1<<31,A={}.hasOwnProperty,L=[],q=L.pop,H=L.push,O=L.push,F=L.slice,P=L.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",W="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",$=W.replace("w","w#"),B="\\["+M+"*("+W+")"+M+"*(?:([*^$|!~]?=)"+M+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+$+")|)|)"+M+"*\\]",I=":("+W+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+B.replace(3,8)+")*)|.*)\\)|)",z=RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),_=RegExp("^"+M+"*,"+M+"*"),X=RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=RegExp(M+"*[+~]"),Y=RegExp("="+M+"*([^\\]'\"]*)"+M+"*\\]","g"),V=RegExp(I),G=RegExp("^"+$+"$"),J={ID:RegExp("^#("+W+")"),CLASS:RegExp("^\\.("+W+")"),TAG:RegExp("^("+W.replace("w","w*")+")"),ATTR:RegExp("^"+B),PSEUDO:RegExp("^"+I),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:RegExp("^(?:"+R+")$","i"),needsContext:RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Q=/^[^{]+\{\s*\[native \w/,K=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Z=/^(?:input|select|textarea|button)$/i,et=/^h\d$/i,tt=/'|\\/g,nt=RegExp("\\\\([\\da-f]{1,6}"+M+"?|("+M+")|.)","ig"),rt=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(55296|r>>10,56320|1023&r)};try{O.apply(L=F.call(b.childNodes),b.childNodes),L[b.childNodes.length].nodeType}catch(it){O={apply:L.length?function(e,t){H.apply(e,F.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}function ot(e,t,r,i){var o,s,a,u,l,f,g,m,x,w;if((t?t.ownerDocument||t:b)!==p&&c(t),t=t||p,r=r||[],!e||"string"!=typeof e)return r;if(1!==(u=t.nodeType)&&9!==u)return[];if(h&&!i){if(o=K.exec(e))if(a=o[1]){if(9===u){if(s=t.getElementById(a),!s||!s.parentNode)return r;if(s.id===a)return r.push(s),r}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(a))&&y(t,s)&&s.id===a)return r.push(s),r}else{if(o[2])return O.apply(r,t.getElementsByTagName(e)),r;if((a=o[3])&&n.getElementsByClassName&&t.getElementsByClassName)return O.apply(r,t.getElementsByClassName(a)),r}if(n.qsa&&(!d||!d.test(e))){if(m=g=v,x=t,w=9===u&&e,1===u&&"object"!==t.nodeName.toLowerCase()){f=gt(e),(g=t.getAttribute("id"))?m=g.replace(tt,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",l=f.length;while(l--)f[l]=m+mt(f[l]);x=U.test(e)&&t.parentNode||t,w=f.join(",")}if(w)try{return O.apply(r,x.querySelectorAll(w)),r}catch(T){}finally{g||t.removeAttribute("id")}}}return kt(e.replace(z,"$1"),t,r,i)}function st(){var e=[];function t(n,r){return e.push(n+=" ")>i.cacheLength&&delete t[e.shift()],t[n]=r}return t}function at(e){return e[v]=!0,e}function ut(e){var t=p.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function lt(e,t){var n=e.split("|"),r=e.length;while(r--)i.attrHandle[n[r]]=t}function ct(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||D)-(~e.sourceIndex||D);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function pt(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function ft(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ht(e){return at(function(t){return t=+t,at(function(n,r){var i,o=e([],n.length,t),s=o.length;while(s--)n[i=o[s]]&&(n[i]=!(r[i]=n[i]))})})}s=ot.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},n=ot.support={},c=ot.setDocument=function(e){var t=e?e.ownerDocument||e:b,r=t.defaultView;return t!==p&&9===t.nodeType&&t.documentElement?(p=t,f=t.documentElement,h=!s(t),r&&r.attachEvent&&r!==r.top&&r.attachEvent("onbeforeunload",function(){c()}),n.attributes=ut(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=ut(function(e){return e.appendChild(t.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=ut(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),n.getById=ut(function(e){return f.appendChild(e).id=v,!t.getElementsByName||!t.getElementsByName(v).length}),n.getById?(i.find.ID=function(e,t){if(typeof t.getElementById!==j&&h){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},i.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){return e.getAttribute("id")===t}}):(delete i.find.ID,i.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){var n=typeof e.getAttributeNode!==j&&e.getAttributeNode("id");return n&&n.value===t}}),i.find.TAG=n.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==j?t.getElementsByTagName(e):undefined}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},i.find.CLASS=n.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==j&&h?t.getElementsByClassName(e):undefined},g=[],d=[],(n.qsa=Q.test(t.querySelectorAll))&&(ut(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||d.push("\\["+M+"*(?:value|"+R+")"),e.querySelectorAll(":checked").length||d.push(":checked")}),ut(function(e){var n=t.createElement("input");n.setAttribute("type","hidden"),e.appendChild(n).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&d.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||d.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),d.push(",.*:")})),(n.matchesSelector=Q.test(m=f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&ut(function(e){n.disconnectedMatch=m.call(e,"div"),m.call(e,"[s!='']:x"),g.push("!=",I)}),d=d.length&&RegExp(d.join("|")),g=g.length&&RegExp(g.join("|")),y=Q.test(f.contains)||f.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},S=f.compareDocumentPosition?function(e,r){if(e===r)return E=!0,0;var i=r.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(r);return i?1&i||!n.sortDetached&&r.compareDocumentPosition(e)===i?e===t||y(b,e)?-1:r===t||y(b,r)?1:l?P.call(l,e)-P.call(l,r):0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,n){var r,i=0,o=e.parentNode,s=n.parentNode,a=[e],u=[n];if(e===n)return E=!0,0;if(!o||!s)return e===t?-1:n===t?1:o?-1:s?1:l?P.call(l,e)-P.call(l,n):0;if(o===s)return ct(e,n);r=e;while(r=r.parentNode)a.unshift(r);r=n;while(r=r.parentNode)u.unshift(r);while(a[i]===u[i])i++;return i?ct(a[i],u[i]):a[i]===b?-1:u[i]===b?1:0},t):p},ot.matches=function(e,t){return ot(e,null,null,t)},ot.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&c(e),t=t.replace(Y,"='$1']"),!(!n.matchesSelector||!h||g&&g.test(t)||d&&d.test(t)))try{var r=m.call(e,t);if(r||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(i){}return ot(t,p,null,[e]).length>0},ot.contains=function(e,t){return(e.ownerDocument||e)!==p&&c(e),y(e,t)},ot.attr=function(e,t){(e.ownerDocument||e)!==p&&c(e);var r=i.attrHandle[t.toLowerCase()],o=r&&A.call(i.attrHandle,t.toLowerCase())?r(e,t,!h):undefined;return o===undefined?n.attributes||!h?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null:o},ot.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},ot.uniqueSort=function(e){var t,r=[],i=0,o=0;if(E=!n.detectDuplicates,l=!n.sortStable&&e.slice(0),e.sort(S),E){while(t=e[o++])t===e[o]&&(i=r.push(o));while(i--)e.splice(r[i],1)}return e},o=ot.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=o(t);return n},i=ot.selectors={cacheLength:50,createPseudo:at,match:J,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(nt,rt),e[3]=(e[4]||e[5]||"").replace(nt,rt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ot.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ot.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return J.CHILD.test(e[0])?null:(e[3]&&e[4]!==undefined?e[2]=e[4]:n&&V.test(n)&&(t=gt(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(nt,rt).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=C[e+" "];return t||(t=RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&C(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==j&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=ot.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var l,c,p,f,h,d,g=o!==s?"nextSibling":"previousSibling",m=t.parentNode,y=a&&t.nodeName.toLowerCase(),x=!u&&!a;if(m){if(o){while(g){p=t;while(p=p[g])if(a?p.nodeName.toLowerCase()===y:1===p.nodeType)return!1;d=g="only"===e&&!d&&"nextSibling"}return!0}if(d=[s?m.firstChild:m.lastChild],s&&x){c=m[v]||(m[v]={}),l=c[e]||[],h=l[0]===w&&l[1],f=l[0]===w&&l[2],p=h&&m.childNodes[h];while(p=++h&&p&&p[g]||(f=h=0)||d.pop())if(1===p.nodeType&&++f&&p===t){c[e]=[w,h,f];break}}else if(x&&(l=(t[v]||(t[v]={}))[e])&&l[0]===w)f=l[1];else while(p=++h&&p&&p[g]||(f=h=0)||d.pop())if((a?p.nodeName.toLowerCase()===y:1===p.nodeType)&&++f&&(x&&((p[v]||(p[v]={}))[e]=[w,f]),p===t))break;return f-=i,f===r||0===f%r&&f/r>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||ot.error("unsupported pseudo: "+e);return r[v]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?at(function(e,n){var i,o=r(e,t),s=o.length;while(s--)i=P.call(e,o[s]),e[i]=!(n[i]=o[s])}):function(e){return r(e,0,n)}):r}},pseudos:{not:at(function(e){var t=[],n=[],r=a(e.replace(z,"$1"));return r[v]?at(function(e,t,n,i){var o,s=r(e,null,i,[]),a=e.length;while(a--)(o=s[a])&&(e[a]=!(t[a]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),!n.pop()}}),has:at(function(e){return function(t){return ot(e,t).length>0}}),contains:at(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:at(function(e){return G.test(e||"")||ot.error("unsupported lang: "+e),e=e.replace(nt,rt).toLowerCase(),function(t){var n;do if(n=h?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===f},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return et.test(e.nodeName)},input:function(e){return Z.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:ht(function(){return[0]}),last:ht(function(e,t){return[t-1]}),eq:ht(function(e,t,n){return[0>n?n+t:n]}),even:ht(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:ht(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:ht(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:ht(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}},i.pseudos.nth=i.pseudos.eq;for(t in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[t]=pt(t);for(t in{submit:!0,reset:!0})i.pseudos[t]=ft(t);function dt(){}dt.prototype=i.filters=i.pseudos,i.setFilters=new dt;function gt(e,t){var n,r,o,s,a,u,l,c=k[e+" "];if(c)return t?0:c.slice(0);a=e,u=[],l=i.preFilter;while(a){(!n||(r=_.exec(a)))&&(r&&(a=a.slice(r[0].length)||a),u.push(o=[])),n=!1,(r=X.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace(z," ")}),a=a.slice(n.length));for(s in i.filter)!(r=J[s].exec(a))||l[s]&&!(r=l[s](r))||(n=r.shift(),o.push({value:n,type:s,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?ot.error(e):k(e,u).slice(0)}function mt(e){var t=0,n=e.length,r="";for(;n>t;t++)r+=e[t].value;return r}function yt(e,t,n){var i=t.dir,o=n&&"parentNode"===i,s=T++;return t.first?function(t,n,r){while(t=t[i])if(1===t.nodeType||o)return e(t,n,r)}:function(t,n,a){var u,l,c,p=w+" "+s;if(a){while(t=t[i])if((1===t.nodeType||o)&&e(t,n,a))return!0}else while(t=t[i])if(1===t.nodeType||o)if(c=t[v]||(t[v]={}),(l=c[i])&&l[0]===p){if((u=l[1])===!0||u===r)return u===!0}else if(l=c[i]=[p],l[1]=e(t,n,a)||r,l[1]===!0)return!0}}function vt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function xt(e,t,n,r,i){var o,s=[],a=0,u=e.length,l=null!=t;for(;u>a;a++)(o=e[a])&&(!n||n(o,r,i))&&(s.push(o),l&&t.push(a));return s}function bt(e,t,n,r,i,o){return r&&!r[v]&&(r=bt(r)),i&&!i[v]&&(i=bt(i,o)),at(function(o,s,a,u){var l,c,p,f=[],h=[],d=s.length,g=o||Ct(t||"*",a.nodeType?[a]:a,[]),m=!e||!o&&t?g:xt(g,f,e,a,u),y=n?i||(o?e:d||r)?[]:s:m;if(n&&n(m,y,a,u),r){l=xt(y,h),r(l,[],a,u),c=l.length;while(c--)(p=l[c])&&(y[h[c]]=!(m[h[c]]=p))}if(o){if(i||e){if(i){l=[],c=y.length;while(c--)(p=y[c])&&l.push(m[c]=p);i(null,y=[],l,u)}c=y.length;while(c--)(p=y[c])&&(l=i?P.call(o,p):f[c])>-1&&(o[l]=!(s[l]=p))}}else y=xt(y===s?y.splice(d,y.length):y),i?i(null,s,y,u):O.apply(s,y)})}function wt(e){var t,n,r,o=e.length,s=i.relative[e[0].type],a=s||i.relative[" "],l=s?1:0,c=yt(function(e){return e===t},a,!0),p=yt(function(e){return P.call(t,e)>-1},a,!0),f=[function(e,n,r){return!s&&(r||n!==u)||((t=n).nodeType?c(e,n,r):p(e,n,r))}];for(;o>l;l++)if(n=i.relative[e[l].type])f=[yt(vt(f),n)];else{if(n=i.filter[e[l].type].apply(null,e[l].matches),n[v]){for(r=++l;o>r;r++)if(i.relative[e[r].type])break;return bt(l>1&&vt(f),l>1&&mt(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(z,"$1"),n,r>l&&wt(e.slice(l,r)),o>r&&wt(e=e.slice(r)),o>r&&mt(e))}f.push(n)}return vt(f)}function Tt(e,t){var n=0,o=t.length>0,s=e.length>0,a=function(a,l,c,f,h){var d,g,m,y=[],v=0,x="0",b=a&&[],T=null!=h,C=u,k=a||s&&i.find.TAG("*",h&&l.parentNode||l),N=w+=null==C?1:Math.random()||.1;for(T&&(u=l!==p&&l,r=n);null!=(d=k[x]);x++){if(s&&d){g=0;while(m=e[g++])if(m(d,l,c)){f.push(d);break}T&&(w=N,r=++n)}o&&((d=!m&&d)&&v--,a&&b.push(d))}if(v+=x,o&&x!==v){g=0;while(m=t[g++])m(b,y,l,c);if(a){if(v>0)while(x--)b[x]||y[x]||(y[x]=q.call(f));y=xt(y)}O.apply(f,y),T&&!a&&y.length>0&&v+t.length>1&&ot.uniqueSort(f)}return T&&(w=N,u=C),b};return o?at(a):a}a=ot.compile=function(e,t){var n,r=[],i=[],o=N[e+" "];if(!o){t||(t=gt(e)),n=t.length;while(n--)o=wt(t[n]),o[v]?r.push(o):i.push(o);o=N(e,Tt(i,r))}return o};function Ct(e,t,n){var r=0,i=t.length;for(;i>r;r++)ot(e,t[r],n);return n}function kt(e,t,r,o){var s,u,l,c,p,f=gt(e);if(!o&&1===f.length){if(u=f[0]=f[0].slice(0),u.length>2&&"ID"===(l=u[0]).type&&n.getById&&9===t.nodeType&&h&&i.relative[u[1].type]){if(t=(i.find.ID(l.matches[0].replace(nt,rt),t)||[])[0],!t)return r;e=e.slice(u.shift().value.length)}s=J.needsContext.test(e)?0:u.length;while(s--){if(l=u[s],i.relative[c=l.type])break;if((p=i.find[c])&&(o=p(l.matches[0].replace(nt,rt),U.test(u[0].type)&&t.parentNode||t))){if(u.splice(s,1),e=o.length&&mt(u),!e)return O.apply(r,o),r;break}}}return a(e,f)(o,t,!h,r,U.test(e)),r}n.sortStable=v.split("").sort(S).join("")===v,n.detectDuplicates=E,c(),n.sortDetached=ut(function(e){return 1&e.compareDocumentPosition(p.createElement("div"))}),ut(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||lt("type|href|height|width",function(e,t,n){return n?undefined:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),n.attributes&&ut(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||lt("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?undefined:e.defaultValue}),ut(function(e){return null==e.getAttribute("disabled")})||lt(R,function(e,t,n){var r;return n?undefined:(r=e.getAttributeNode(t))&&r.specified?r.value:e[t]===!0?t.toLowerCase():null}),x.find=ot,x.expr=ot.selectors,x.expr[":"]=x.expr.pseudos,x.unique=ot.uniqueSort,x.text=ot.getText,x.isXMLDoc=ot.isXML,x.contains=ot.contains}(e);var D={};function A(e){var t=D[e]={};return x.each(e.match(w)||[],function(e,n){t[n]=!0}),t}x.Callbacks=function(e){e="string"==typeof e?D[e]||A(e):x.extend({},e);var t,n,r,i,o,s,a=[],u=!e.once&&[],l=function(p){for(t=e.memory&&p,n=!0,s=i||0,i=0,o=a.length,r=!0;a&&o>s;s++)if(a[s].apply(p[0],p[1])===!1&&e.stopOnFalse){t=!1;break}r=!1,a&&(u?u.length&&l(u.shift()):t?a=[]:c.disable())},c={add:function(){if(a){var n=a.length;(function s(t){x.each(t,function(t,n){var r=x.type(n);"function"===r?e.unique&&c.has(n)||a.push(n):n&&n.length&&"string"!==r&&s(n)})})(arguments),r?o=a.length:t&&(i=n,l(t))}return this},remove:function(){return a&&x.each(arguments,function(e,t){var n;while((n=x.inArray(t,a,n))>-1)a.splice(n,1),r&&(o>=n&&o--,s>=n&&s--)}),this},has:function(e){return e?x.inArray(e,a)>-1:!(!a||!a.length)},empty:function(){return a=[],o=0,this},disable:function(){return a=u=t=undefined,this},disabled:function(){return!a},lock:function(){return u=undefined,t||c.disable(),this},locked:function(){return!u},fireWith:function(e,t){return!a||n&&!u||(t=t||[],t=[e,t.slice?t.slice():t],r?u.push(t):l(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!n}};return c},x.extend({Deferred:function(e){var t=[["resolve","done",x.Callbacks("once memory"),"resolved"],["reject","fail",x.Callbacks("once memory"),"rejected"],["notify","progress",x.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return x.Deferred(function(n){x.each(t,function(t,o){var s=o[0],a=x.isFunction(e[t])&&e[t];i[o[1]](function(){var e=a&&a.apply(this,arguments);e&&x.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s+"With"](this===r?n.promise():this,a?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?x.extend(e,r):r}},i={};return r.pipe=r.then,x.each(t,function(e,o){var s=o[2],a=o[3];r[o[1]]=s.add,a&&s.add(function(){n=a},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=s.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=d.call(arguments),r=n.length,i=1!==r||e&&x.isFunction(e.promise)?r:0,o=1===i?e:x.Deferred(),s=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?d.call(arguments):r,n===a?o.notifyWith(t,n):--i||o.resolveWith(t,n)}},a,u,l;if(r>1)for(a=Array(r),u=Array(r),l=Array(r);r>t;t++)n[t]&&x.isFunction(n[t].promise)?n[t].promise().done(s(t,l,n)).fail(o.reject).progress(s(t,u,a)):--i;return i||o.resolveWith(l,n),o.promise()}}),x.support=function(t){var n=o.createElement("input"),r=o.createDocumentFragment(),i=o.createElement("div"),s=o.createElement("select"),a=s.appendChild(o.createElement("option"));return n.type?(n.type="checkbox",t.checkOn=""!==n.value,t.optSelected=a.selected,t.reliableMarginRight=!0,t.boxSizingReliable=!0,t.pixelPosition=!1,n.checked=!0,t.noCloneChecked=n.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!a.disabled,n=o.createElement("input"),n.value="t",n.type="radio",t.radioValue="t"===n.value,n.setAttribute("checked","t"),n.setAttribute("name","t"),r.appendChild(n),t.checkClone=r.cloneNode(!0).cloneNode(!0).lastChild.checked,t.focusinBubbles="onfocusin"in e,i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===i.style.backgroundClip,x(function(){var n,r,s="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",a=o.getElementsByTagName("body")[0];a&&(n=o.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(n).appendChild(i),i.innerHTML="",i.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",x.swap(a,null!=a.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===i.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(i,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(i,null)||{width:"4px"}).width,r=i.appendChild(o.createElement("div")),r.style.cssText=i.style.cssText=s,r.style.marginRight=r.style.width="0",i.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),a.removeChild(n))}),t):t}({});var L,q,H=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,O=/([A-Z])/g;function F(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=x.expando+Math.random()}F.uid=1,F.accepts=function(e){return e.nodeType?1===e.nodeType||9===e.nodeType:!0},F.prototype={key:function(e){if(!F.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=F.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(r){t[this.expando]=n,x.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var r,i=this.key(e),o=this.cache[i];if("string"==typeof t)o[t]=n;else if(x.isEmptyObject(o))x.extend(this.cache[i],t);else for(r in t)o[r]=t[r];return o},get:function(e,t){var n=this.cache[this.key(e)];return t===undefined?n:n[t]},access:function(e,t,n){var r;return t===undefined||t&&"string"==typeof t&&n===undefined?(r=this.get(e,t),r!==undefined?r:this.get(e,x.camelCase(t))):(this.set(e,t,n),n!==undefined?n:t)},remove:function(e,t){var n,r,i,o=this.key(e),s=this.cache[o];if(t===undefined)this.cache[o]={};else{x.isArray(t)?r=t.concat(t.map(x.camelCase)):(i=x.camelCase(t),t in s?r=[t,i]:(r=i,r=r in s?[r]:r.match(w)||[])),n=r.length;while(n--)delete s[r[n]]}},hasData:function(e){return!x.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}},L=new F,q=new F,x.extend({acceptData:F.accepts,hasData:function(e){return L.hasData(e)||q.hasData(e)},data:function(e,t,n){return L.access(e,t,n)},removeData:function(e,t){L.remove(e,t)},_data:function(e,t,n){return q.access(e,t,n)},_removeData:function(e,t){q.remove(e,t)}}),x.fn.extend({data:function(e,t){var n,r,i=this[0],o=0,s=null;if(e===undefined){if(this.length&&(s=L.get(i),1===i.nodeType&&!q.get(i,"hasDataAttrs"))){for(n=i.attributes;n.length>o;o++)r=n[o].name,0===r.indexOf("data-")&&(r=x.camelCase(r.slice(5)),P(i,r,s[r]));q.set(i,"hasDataAttrs",!0)}return s}return"object"==typeof e?this.each(function(){L.set(this,e)}):x.access(this,function(t){var n,r=x.camelCase(e);if(i&&t===undefined){if(n=L.get(i,e),n!==undefined)return n;if(n=L.get(i,r),n!==undefined)return n;if(n=P(i,r,undefined),n!==undefined)return n}else this.each(function(){var n=L.get(this,r);L.set(this,r,t),-1!==e.indexOf("-")&&n!==undefined&&L.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){L.remove(this,e)})}});function P(e,t,n){var r;if(n===undefined&&1===e.nodeType)if(r="data-"+t.replace(O,"-$1").toLowerCase(),n=e.getAttribute(r),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:H.test(n)?JSON.parse(n):n}catch(i){}L.set(e,t,n)}else n=undefined;return n}x.extend({queue:function(e,t,n){var r;return e?(t=(t||"fx")+"queue",r=q.get(e,t),n&&(!r||x.isArray(n)?r=q.access(e,t,x.makeArray(n)):r.push(n)),r||[]):undefined},dequeue:function(e,t){t=t||"fx";var n=x.queue(e,t),r=n.length,i=n.shift(),o=x._queueHooks(e,t),s=function(){x.dequeue(e,t)
};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,s,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return q.get(e,n)||q.access(e,n,{empty:x.Callbacks("once memory").add(function(){q.remove(e,[t+"queue",n])})})}}),x.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),n>arguments.length?x.queue(this[0],e):t===undefined?this:this.each(function(){var n=x.queue(this,e,t);x._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&x.dequeue(this,e)})},dequeue:function(e){return this.each(function(){x.dequeue(this,e)})},delay:function(e,t){return e=x.fx?x.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=x.Deferred(),o=this,s=this.length,a=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=undefined),e=e||"fx";while(s--)n=q.get(o[s],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(a));return a(),i.promise(t)}});var R,M,W=/[\t\r\n\f]/g,$=/\r/g,B=/^(?:input|select|textarea|button)$/i;x.fn.extend({attr:function(e,t){return x.access(this,x.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){x.removeAttr(this,e)})},prop:function(e,t){return x.access(this,x.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[x.propFix[e]||e]})},addClass:function(e){var t,n,r,i,o,s=0,a=this.length,u="string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).addClass(e.call(this,t,this.className))});if(u)for(t=(e||"").match(w)||[];a>s;s++)if(n=this[s],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):" ")){o=0;while(i=t[o++])0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=x.trim(r)}return this},removeClass:function(e){var t,n,r,i,o,s=0,a=this.length,u=0===arguments.length||"string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).removeClass(e.call(this,t,this.className))});if(u)for(t=(e||"").match(w)||[];a>s;s++)if(n=this[s],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):"")){o=0;while(i=t[o++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?x.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):x.isFunction(e)?this.each(function(n){x(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var t,i=0,o=x(this),s=e.match(w)||[];while(t=s[i++])o.hasClass(t)?o.removeClass(t):o.addClass(t)}else(n===r||"boolean"===n)&&(this.className&&q.set(this,"__className__",this.className),this.className=this.className||e===!1?"":q.get(this,"__className__")||"")})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(W," ").indexOf(t)>=0)return!0;return!1},val:function(e){var t,n,r,i=this[0];{if(arguments.length)return r=x.isFunction(e),this.each(function(n){var i;1===this.nodeType&&(i=r?e.call(this,n,x(this).val()):e,null==i?i="":"number"==typeof i?i+="":x.isArray(i)&&(i=x.map(i,function(e){return null==e?"":e+""})),t=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&t.set(this,i,"value")!==undefined||(this.value=i))});if(i)return t=x.valHooks[i.type]||x.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&(n=t.get(i,"value"))!==undefined?n:(n=i.value,"string"==typeof n?n.replace($,""):null==n?"":n)}}}),x.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||0>i,s=o?null:[],a=o?i+1:r.length,u=0>i?a:o?i:0;for(;a>u;u++)if(n=r[u],!(!n.selected&&u!==i||(x.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&x.nodeName(n.parentNode,"optgroup"))){if(t=x(n).val(),o)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=x.makeArray(t),s=i.length;while(s--)r=i[s],(r.selected=x.inArray(x(r).val(),o)>=0)&&(n=!0);return n||(e.selectedIndex=-1),o}}},attr:function(e,t,n){var i,o,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return typeof e.getAttribute===r?x.prop(e,t,n):(1===s&&x.isXMLDoc(e)||(t=t.toLowerCase(),i=x.attrHooks[t]||(x.expr.match.bool.test(t)?M:R)),n===undefined?i&&"get"in i&&null!==(o=i.get(e,t))?o:(o=x.find.attr(e,t),null==o?undefined:o):null!==n?i&&"set"in i&&(o=i.set(e,n,t))!==undefined?o:(e.setAttribute(t,n+""),n):(x.removeAttr(e,t),undefined))},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(w);if(o&&1===e.nodeType)while(n=o[i++])r=x.propFix[n]||n,x.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!x.support.radioValue&&"radio"===t&&x.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,o,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return o=1!==s||!x.isXMLDoc(e),o&&(t=x.propFix[t]||t,i=x.propHooks[t]),n!==undefined?i&&"set"in i&&(r=i.set(e,n,t))!==undefined?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||B.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),M={set:function(e,t,n){return t===!1?x.removeAttr(e,n):e.setAttribute(n,n),n}},x.each(x.expr.match.bool.source.match(/\w+/g),function(e,t){var n=x.expr.attrHandle[t]||x.find.attr;x.expr.attrHandle[t]=function(e,t,r){var i=x.expr.attrHandle[t],o=r?undefined:(x.expr.attrHandle[t]=undefined)!=n(e,t,r)?t.toLowerCase():null;return x.expr.attrHandle[t]=i,o}}),x.support.optSelected||(x.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){x.propFix[this.toLowerCase()]=this}),x.each(["radio","checkbox"],function(){x.valHooks[this]={set:function(e,t){return x.isArray(t)?e.checked=x.inArray(x(e).val(),t)>=0:undefined}},x.support.checkOn||(x.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var I=/^key/,z=/^(?:mouse|contextmenu)|click/,_=/^(?:focusinfocus|focusoutblur)$/,X=/^([^.]*)(?:\.(.+)|)$/;function U(){return!0}function Y(){return!1}function V(){try{return o.activeElement}catch(e){}}x.event={global:{},add:function(e,t,n,i,o){var s,a,u,l,c,p,f,h,d,g,m,y=q.get(e);if(y){n.handler&&(s=n,n=s.handler,o=s.selector),n.guid||(n.guid=x.guid++),(l=y.events)||(l=y.events={}),(a=y.handle)||(a=y.handle=function(e){return typeof x===r||e&&x.event.triggered===e.type?undefined:x.event.dispatch.apply(a.elem,arguments)},a.elem=e),t=(t||"").match(w)||[""],c=t.length;while(c--)u=X.exec(t[c])||[],d=m=u[1],g=(u[2]||"").split(".").sort(),d&&(f=x.event.special[d]||{},d=(o?f.delegateType:f.bindType)||d,f=x.event.special[d]||{},p=x.extend({type:d,origType:m,data:i,handler:n,guid:n.guid,selector:o,needsContext:o&&x.expr.match.needsContext.test(o),namespace:g.join(".")},s),(h=l[d])||(h=l[d]=[],h.delegateCount=0,f.setup&&f.setup.call(e,i,g,a)!==!1||e.addEventListener&&e.addEventListener(d,a,!1)),f.add&&(f.add.call(e,p),p.handler.guid||(p.handler.guid=n.guid)),o?h.splice(h.delegateCount++,0,p):h.push(p),x.event.global[d]=!0);e=null}},remove:function(e,t,n,r,i){var o,s,a,u,l,c,p,f,h,d,g,m=q.hasData(e)&&q.get(e);if(m&&(u=m.events)){t=(t||"").match(w)||[""],l=t.length;while(l--)if(a=X.exec(t[l])||[],h=g=a[1],d=(a[2]||"").split(".").sort(),h){p=x.event.special[h]||{},h=(r?p.delegateType:p.bindType)||h,f=u[h]||[],a=a[2]&&RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=f.length;while(o--)c=f[o],!i&&g!==c.origType||n&&n.guid!==c.guid||a&&!a.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(f.splice(o,1),c.selector&&f.delegateCount--,p.remove&&p.remove.call(e,c));s&&!f.length&&(p.teardown&&p.teardown.call(e,d,m.handle)!==!1||x.removeEvent(e,h,m.handle),delete u[h])}else for(h in u)x.event.remove(e,h+t[l],n,r,!0);x.isEmptyObject(u)&&(delete m.handle,q.remove(e,"events"))}},trigger:function(t,n,r,i){var s,a,u,l,c,p,f,h=[r||o],d=y.call(t,"type")?t.type:t,g=y.call(t,"namespace")?t.namespace.split("."):[];if(a=u=r=r||o,3!==r.nodeType&&8!==r.nodeType&&!_.test(d+x.event.triggered)&&(d.indexOf(".")>=0&&(g=d.split("."),d=g.shift(),g.sort()),c=0>d.indexOf(":")&&"on"+d,t=t[x.expando]?t:new x.Event(d,"object"==typeof t&&t),t.isTrigger=i?2:3,t.namespace=g.join("."),t.namespace_re=t.namespace?RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=undefined,t.target||(t.target=r),n=null==n?[t]:x.makeArray(n,[t]),f=x.event.special[d]||{},i||!f.trigger||f.trigger.apply(r,n)!==!1)){if(!i&&!f.noBubble&&!x.isWindow(r)){for(l=f.delegateType||d,_.test(l+d)||(a=a.parentNode);a;a=a.parentNode)h.push(a),u=a;u===(r.ownerDocument||o)&&h.push(u.defaultView||u.parentWindow||e)}s=0;while((a=h[s++])&&!t.isPropagationStopped())t.type=s>1?l:f.bindType||d,p=(q.get(a,"events")||{})[t.type]&&q.get(a,"handle"),p&&p.apply(a,n),p=c&&a[c],p&&x.acceptData(a)&&p.apply&&p.apply(a,n)===!1&&t.preventDefault();return t.type=d,i||t.isDefaultPrevented()||f._default&&f._default.apply(h.pop(),n)!==!1||!x.acceptData(r)||c&&x.isFunction(r[d])&&!x.isWindow(r)&&(u=r[c],u&&(r[c]=null),x.event.triggered=d,r[d](),x.event.triggered=undefined,u&&(r[c]=u)),t.result}},dispatch:function(e){e=x.event.fix(e);var t,n,r,i,o,s=[],a=d.call(arguments),u=(q.get(this,"events")||{})[e.type]||[],l=x.event.special[e.type]||{};if(a[0]=e,e.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,e)!==!1){s=x.event.handlers.call(this,e,u),t=0;while((i=s[t++])&&!e.isPropagationStopped()){e.currentTarget=i.elem,n=0;while((o=i.handlers[n++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(o.namespace))&&(e.handleObj=o,e.data=o.data,r=((x.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,a),r!==undefined&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,i,o,s=[],a=t.delegateCount,u=e.target;if(a&&u.nodeType&&(!e.button||"click"!==e.type))for(;u!==this;u=u.parentNode||this)if(u.disabled!==!0||"click"!==e.type){for(r=[],n=0;a>n;n++)o=t[n],i=o.selector+" ",r[i]===undefined&&(r[i]=o.needsContext?x(i,this).index(u)>=0:x.find(i,this,null,[u]).length),r[i]&&r.push(o);r.length&&s.push({elem:u,handlers:r})}return t.length>a&&s.push({elem:this,handlers:t.slice(a)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,s=t.button;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||o,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),e.which||s===undefined||(e.which=1&s?1:2&s?3:4&s?2:0),e}},fix:function(e){if(e[x.expando])return e;var t,n,r,i=e.type,s=e,a=this.fixHooks[i];a||(this.fixHooks[i]=a=z.test(i)?this.mouseHooks:I.test(i)?this.keyHooks:{}),r=a.props?this.props.concat(a.props):this.props,e=new x.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target||(e.target=o),3===e.target.nodeType&&(e.target=e.target.parentNode),a.filter?a.filter(e,s):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==V()&&this.focus?(this.focus(),!1):undefined},delegateType:"focusin"},blur:{trigger:function(){return this===V()&&this.blur?(this.blur(),!1):undefined},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&x.nodeName(this,"input")?(this.click(),!1):undefined},_default:function(e){return x.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=x.extend(new x.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?x.event.trigger(i,null,t):x.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},x.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},x.Event=function(e,t){return this instanceof x.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.getPreventDefault&&e.getPreventDefault()?U:Y):this.type=e,t&&x.extend(this,t),this.timeStamp=e&&e.timeStamp||x.now(),this[x.expando]=!0,undefined):new x.Event(e,t)},x.Event.prototype={isDefaultPrevented:Y,isPropagationStopped:Y,isImmediatePropagationStopped:Y,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=U,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=U,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=U,this.stopPropagation()}},x.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){x.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return(!i||i!==r&&!x.contains(r,i))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),x.support.focusinBubbles||x.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){x.event.simulate(t,e.target,x.event.fix(e),!0)};x.event.special[t]={setup:function(){0===n++&&o.addEventListener(e,r,!0)},teardown:function(){0===--n&&o.removeEventListener(e,r,!0)}}}),x.fn.extend({on:function(e,t,n,r,i){var o,s;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=undefined);for(s in e)this.on(s,t,n,e[s],i);return this}if(null==n&&null==r?(r=t,n=t=undefined):null==r&&("string"==typeof t?(r=n,n=undefined):(r=n,n=t,t=undefined)),r===!1)r=Y;else if(!r)return this;return 1===i&&(o=r,r=function(e){return x().off(e),o.apply(this,arguments)},r.guid=o.guid||(o.guid=x.guid++)),this.each(function(){x.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,x(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=undefined),n===!1&&(n=Y),this.each(function(){x.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){x.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?x.event.trigger(e,t,n,!0):undefined}});var G=/^.[^:#\[\.,]*$/,J=/^(?:parents|prev(?:Until|All))/,Q=x.expr.match.needsContext,K={children:!0,contents:!0,next:!0,prev:!0};x.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(x(e).filter(function(){for(t=0;i>t;t++)if(x.contains(r[t],this))return!0}));for(t=0;i>t;t++)x.find(e,r[t],n);return n=this.pushStack(i>1?x.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t=x(e,this),n=t.length;return this.filter(function(){var e=0;for(;n>e;e++)if(x.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(et(this,e||[],!0))},filter:function(e){return this.pushStack(et(this,e||[],!1))},is:function(e){return!!et(this,"string"==typeof e&&Q.test(e)?x(e):e||[],!1).length},closest:function(e,t){var n,r=0,i=this.length,o=[],s=Q.test(e)||"string"!=typeof e?x(e,t||this.context):0;for(;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(11>n.nodeType&&(s?s.index(n)>-1:1===n.nodeType&&x.find.matchesSelector(n,e))){n=o.push(n);break}return this.pushStack(o.length>1?x.unique(o):o)},index:function(e){return e?"string"==typeof e?g.call(x(e),this[0]):g.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?x(e,t):x.makeArray(e&&e.nodeType?[e]:e),r=x.merge(this.get(),n);return this.pushStack(x.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}});function Z(e,t){while((e=e[t])&&1!==e.nodeType);return e}x.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return x.dir(e,"parentNode")},parentsUntil:function(e,t,n){return x.dir(e,"parentNode",n)},next:function(e){return Z(e,"nextSibling")},prev:function(e){return Z(e,"previousSibling")},nextAll:function(e){return x.dir(e,"nextSibling")},prevAll:function(e){return x.dir(e,"previousSibling")},nextUntil:function(e,t,n){return x.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return x.dir(e,"previousSibling",n)},siblings:function(e){return x.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return x.sibling(e.firstChild)},contents:function(e){return e.contentDocument||x.merge([],e.childNodes)}},function(e,t){x.fn[e]=function(n,r){var i=x.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=x.filter(r,i)),this.length>1&&(K[e]||x.unique(i),J.test(e)&&i.reverse()),this.pushStack(i)}}),x.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?x.find.matchesSelector(r,e)?[r]:[]:x.find.matches(e,x.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,t,n){var r=[],i=n!==undefined;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&x(e).is(n))break;r.push(e)}return r},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});function et(e,t,n){if(x.isFunction(t))return x.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return x.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(G.test(t))return x.filter(t,e,n);t=x.filter(t,e)}return x.grep(e,function(e){return g.call(t,e)>=0!==n})}var tt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,nt=/<([\w:]+)/,rt=/<|&#?\w+;/,it=/<(?:script|style|link)/i,ot=/^(?:checkbox|radio)$/i,st=/checked\s*(?:[^=]|=\s*.checked.)/i,at=/^$|\/(?:java|ecma)script/i,ut=/^true\/(.*)/,lt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ct={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ct.optgroup=ct.option,ct.tbody=ct.tfoot=ct.colgroup=ct.caption=ct.thead,ct.th=ct.td,x.fn.extend({text:function(e){return x.access(this,function(e){return e===undefined?x.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=pt(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=pt(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?x.filter(e,this):this,i=0;for(;null!=(n=r[i]);i++)t||1!==n.nodeType||x.cleanData(mt(n)),n.parentNode&&(t&&x.contains(n.ownerDocument,n)&&dt(mt(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++)1===e.nodeType&&(x.cleanData(mt(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return x.clone(this,e,t)})},html:function(e){return x.access(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===undefined&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!it.test(e)&&!ct[(nt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(tt,"<$1></$2>");try{for(;r>n;n++)t=this[n]||{},1===t.nodeType&&(x.cleanData(mt(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=x.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(r&&r.parentNode!==i&&(r=this.nextSibling),x(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=f.apply([],e);var r,i,o,s,a,u,l=0,c=this.length,p=this,h=c-1,d=e[0],g=x.isFunction(d);if(g||!(1>=c||"string"!=typeof d||x.support.checkClone)&&st.test(d))return this.each(function(r){var i=p.eq(r);g&&(e[0]=d.call(this,r,i.html())),i.domManip(e,t,n)});if(c&&(r=x.buildFragment(e,this[0].ownerDocument,!1,!n&&this),i=r.firstChild,1===r.childNodes.length&&(r=i),i)){for(o=x.map(mt(r,"script"),ft),s=o.length;c>l;l++)a=r,l!==h&&(a=x.clone(a,!0,!0),s&&x.merge(o,mt(a,"script"))),t.call(this[l],a,l);if(s)for(u=o[o.length-1].ownerDocument,x.map(o,ht),l=0;s>l;l++)a=o[l],at.test(a.type||"")&&!q.access(a,"globalEval")&&x.contains(u,a)&&(a.src?x._evalUrl(a.src):x.globalEval(a.textContent.replace(lt,"")))}return this}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){x.fn[e]=function(e){var n,r=[],i=x(e),o=i.length-1,s=0;for(;o>=s;s++)n=s===o?this:this.clone(!0),x(i[s])[t](n),h.apply(r,n.get());return this.pushStack(r)}}),x.extend({clone:function(e,t,n){var r,i,o,s,a=e.cloneNode(!0),u=x.contains(e.ownerDocument,e);if(!(x.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||x.isXMLDoc(e)))for(s=mt(a),o=mt(e),r=0,i=o.length;i>r;r++)yt(o[r],s[r]);if(t)if(n)for(o=o||mt(e),s=s||mt(a),r=0,i=o.length;i>r;r++)gt(o[r],s[r]);else gt(e,a);return s=mt(a,"script"),s.length>0&&dt(s,!u&&mt(e,"script")),a},buildFragment:function(e,t,n,r){var i,o,s,a,u,l,c=0,p=e.length,f=t.createDocumentFragment(),h=[];for(;p>c;c++)if(i=e[c],i||0===i)if("object"===x.type(i))x.merge(h,i.nodeType?[i]:i);else if(rt.test(i)){o=o||f.appendChild(t.createElement("div")),s=(nt.exec(i)||["",""])[1].toLowerCase(),a=ct[s]||ct._default,o.innerHTML=a[1]+i.replace(tt,"<$1></$2>")+a[2],l=a[0];while(l--)o=o.lastChild;x.merge(h,o.childNodes),o=f.firstChild,o.textContent=""}else h.push(t.createTextNode(i));f.textContent="",c=0;while(i=h[c++])if((!r||-1===x.inArray(i,r))&&(u=x.contains(i.ownerDocument,i),o=mt(f.appendChild(i),"script"),u&&dt(o),n)){l=0;while(i=o[l++])at.test(i.type||"")&&n.push(i)}return f},cleanData:function(e){var t,n,r,i,o,s,a=x.event.special,u=0;for(;(n=e[u])!==undefined;u++){if(F.accepts(n)&&(o=n[q.expando],o&&(t=q.cache[o]))){if(r=Object.keys(t.events||{}),r.length)for(s=0;(i=r[s])!==undefined;s++)a[i]?x.event.remove(n,i):x.removeEvent(n,i,t.handle);q.cache[o]&&delete q.cache[o]}delete L.cache[n[L.expando]]}},_evalUrl:function(e){return x.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}});function pt(e,t){return x.nodeName(e,"table")&&x.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function ft(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function ht(e){var t=ut.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function dt(e,t){var n=e.length,r=0;for(;n>r;r++)q.set(e[r],"globalEval",!t||q.get(t[r],"globalEval"))}function gt(e,t){var n,r,i,o,s,a,u,l;if(1===t.nodeType){if(q.hasData(e)&&(o=q.access(e),s=q.set(t,o),l=o.events)){delete s.handle,s.events={};for(i in l)for(n=0,r=l[i].length;r>n;n++)x.event.add(t,i,l[i][n])}L.hasData(e)&&(a=L.access(e),u=x.extend({},a),L.set(t,u))}}function mt(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return t===undefined||t&&x.nodeName(e,t)?x.merge([e],n):n}function yt(e,t){var n=t.nodeName.toLowerCase();"input"===n&&ot.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}x.fn.extend({wrapAll:function(e){var t;return x.isFunction(e)?this.each(function(t){x(this).wrapAll(e.call(this,t))}):(this[0]&&(t=x(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return x.isFunction(e)?this.each(function(t){x(this).wrapInner(e.call(this,t))}):this.each(function(){var t=x(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=x.isFunction(e);return this.each(function(n){x(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){x.nodeName(this,"body")||x(this).replaceWith(this.childNodes)}).end()}});var vt,xt,bt=/^(none|table(?!-c[ea]).+)/,wt=/^margin/,Tt=RegExp("^("+b+")(.*)$","i"),Ct=RegExp("^("+b+")(?!px)[a-z%]+$","i"),kt=RegExp("^([+-])=("+b+")","i"),Nt={BODY:"block"},Et={position:"absolute",visibility:"hidden",display:"block"},St={letterSpacing:0,fontWeight:400},jt=["Top","Right","Bottom","Left"],Dt=["Webkit","O","Moz","ms"];function At(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Dt.length;while(i--)if(t=Dt[i]+n,t in e)return t;return r}function Lt(e,t){return e=t||e,"none"===x.css(e,"display")||!x.contains(e.ownerDocument,e)}function qt(t){return e.getComputedStyle(t,null)}function Ht(e,t){var n,r,i,o=[],s=0,a=e.length;for(;a>s;s++)r=e[s],r.style&&(o[s]=q.get(r,"olddisplay"),n=r.style.display,t?(o[s]||"none"!==n||(r.style.display=""),""===r.style.display&&Lt(r)&&(o[s]=q.access(r,"olddisplay",Rt(r.nodeName)))):o[s]||(i=Lt(r),(n&&"none"!==n||!i)&&q.set(r,"olddisplay",i?n:x.css(r,"display"))));for(s=0;a>s;s++)r=e[s],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[s]||"":"none"));return e}x.fn.extend({css:function(e,t){return x.access(this,function(e,t,n){var r,i,o={},s=0;if(x.isArray(t)){for(r=qt(e),i=t.length;i>s;s++)o[t[s]]=x.css(e,t[s],!1,r);return o}return n!==undefined?x.style(e,t,n):x.css(e,t)},e,t,arguments.length>1)},show:function(){return Ht(this,!0)},hide:function(){return Ht(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Lt(this)?x(this).show():x(this).hide()})}}),x.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=vt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,s,a=x.camelCase(t),u=e.style;return t=x.cssProps[a]||(x.cssProps[a]=At(u,a)),s=x.cssHooks[t]||x.cssHooks[a],n===undefined?s&&"get"in s&&(i=s.get(e,!1,r))!==undefined?i:u[t]:(o=typeof n,"string"===o&&(i=kt.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(x.css(e,t)),o="number"),null==n||"number"===o&&isNaN(n)||("number"!==o||x.cssNumber[a]||(n+="px"),x.support.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),s&&"set"in s&&(n=s.set(e,n,r))===undefined||(u[t]=n)),undefined)}},css:function(e,t,n,r){var i,o,s,a=x.camelCase(t);return t=x.cssProps[a]||(x.cssProps[a]=At(e.style,a)),s=x.cssHooks[t]||x.cssHooks[a],s&&"get"in s&&(i=s.get(e,!0,n)),i===undefined&&(i=vt(e,t,r)),"normal"===i&&t in St&&(i=St[t]),""===n||n?(o=parseFloat(i),n===!0||x.isNumeric(o)?o||0:i):i}}),vt=function(e,t,n){var r,i,o,s=n||qt(e),a=s?s.getPropertyValue(t)||s[t]:undefined,u=e.style;return s&&(""!==a||x.contains(e.ownerDocument,e)||(a=x.style(e,t)),Ct.test(a)&&wt.test(t)&&(r=u.width,i=u.minWidth,o=u.maxWidth,u.minWidth=u.maxWidth=u.width=a,a=s.width,u.width=r,u.minWidth=i,u.maxWidth=o)),a};function Ot(e,t,n){var r=Tt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function Ft(e,t,n,r,i){var o=n===(r?"border":"content")?4:"width"===t?1:0,s=0;for(;4>o;o+=2)"margin"===n&&(s+=x.css(e,n+jt[o],!0,i)),r?("content"===n&&(s-=x.css(e,"padding"+jt[o],!0,i)),"margin"!==n&&(s-=x.css(e,"border"+jt[o]+"Width",!0,i))):(s+=x.css(e,"padding"+jt[o],!0,i),"padding"!==n&&(s+=x.css(e,"border"+jt[o]+"Width",!0,i)));return s}function Pt(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=qt(e),s=x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,o);if(0>=i||null==i){if(i=vt(e,t,o),(0>i||null==i)&&(i=e.style[t]),Ct.test(i))return i;r=s&&(x.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+Ft(e,t,n||(s?"border":"content"),r,o)+"px"}function Rt(e){var t=o,n=Nt[e];return n||(n=Mt(e,t),"none"!==n&&n||(xt=(xt||x("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(xt[0].contentWindow||xt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=Mt(e,t),xt.detach()),Nt[e]=n),n}function Mt(e,t){var n=x(t.createElement(e)).appendTo(t.body),r=x.css(n[0],"display");return n.remove(),r}x.each(["height","width"],function(e,t){x.cssHooks[t]={get:function(e,n,r){return n?0===e.offsetWidth&&bt.test(x.css(e,"display"))?x.swap(e,Et,function(){return Pt(e,t,r)}):Pt(e,t,r):undefined},set:function(e,n,r){var i=r&&qt(e);return Ot(e,n,r?Ft(e,t,r,x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,i),i):0)}}}),x(function(){x.support.reliableMarginRight||(x.cssHooks.marginRight={get:function(e,t){return t?x.swap(e,{display:"inline-block"},vt,[e,"marginRight"]):undefined}}),!x.support.pixelPosition&&x.fn.position&&x.each(["top","left"],function(e,t){x.cssHooks[t]={get:function(e,n){return n?(n=vt(e,t),Ct.test(n)?x(e).position()[t]+"px":n):undefined}}})}),x.expr&&x.expr.filters&&(x.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight},x.expr.filters.visible=function(e){return!x.expr.filters.hidden(e)}),x.each({margin:"",padding:"",border:"Width"},function(e,t){x.cssHooks[e+t]={expand:function(n){var r=0,i={},o="string"==typeof n?n.split(" "):[n];for(;4>r;r++)i[e+jt[r]+t]=o[r]||o[r-2]||o[0];return i}},wt.test(e)||(x.cssHooks[e+t].set=Ot)});var Wt=/%20/g,$t=/\[\]$/,Bt=/\r?\n/g,It=/^(?:submit|button|image|reset|file)$/i,zt=/^(?:input|select|textarea|keygen)/i;x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=x.prop(this,"elements");return e?x.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!x(this).is(":disabled")&&zt.test(this.nodeName)&&!It.test(e)&&(this.checked||!ot.test(e))}).map(function(e,t){var n=x(this).val();return null==n?null:x.isArray(n)?x.map(n,function(e){return{name:t.name,value:e.replace(Bt,"\r\n")}}):{name:t.name,value:n.replace(Bt,"\r\n")}}).get()}}),x.param=function(e,t){var n,r=[],i=function(e,t){t=x.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(t===undefined&&(t=x.ajaxSettings&&x.ajaxSettings.traditional),x.isArray(e)||e.jquery&&!x.isPlainObject(e))x.each(e,function(){i(this.name,this.value)});else for(n in e)_t(n,e[n],t,i);return r.join("&").replace(Wt,"+")};function _t(e,t,n,r){var i;if(x.isArray(t))x.each(t,function(t,i){n||$t.test(e)?r(e,i):_t(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==x.type(t))r(e,t);else for(i in t)_t(e+"["+i+"]",t[i],n,r)}x.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){x.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),x.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)
},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var Xt,Ut,Yt=x.now(),Vt=/\?/,Gt=/#.*$/,Jt=/([?&])_=[^&]*/,Qt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Kt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Zt=/^(?:GET|HEAD)$/,en=/^\/\//,tn=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,nn=x.fn.load,rn={},on={},sn="*/".concat("*");try{Ut=i.href}catch(an){Ut=o.createElement("a"),Ut.href="",Ut=Ut.href}Xt=tn.exec(Ut.toLowerCase())||[];function un(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(w)||[];if(x.isFunction(n))while(r=o[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function ln(e,t,n,r){var i={},o=e===on;function s(a){var u;return i[a]=!0,x.each(e[a]||[],function(e,a){var l=a(t,n,r);return"string"!=typeof l||o||i[l]?o?!(u=l):undefined:(t.dataTypes.unshift(l),s(l),!1)}),u}return s(t.dataTypes[0])||!i["*"]&&s("*")}function cn(e,t){var n,r,i=x.ajaxSettings.flatOptions||{};for(n in t)t[n]!==undefined&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&x.extend(!0,e,r),e}x.fn.load=function(e,t,n){if("string"!=typeof e&&nn)return nn.apply(this,arguments);var r,i,o,s=this,a=e.indexOf(" ");return a>=0&&(r=e.slice(a),e=e.slice(0,a)),x.isFunction(t)?(n=t,t=undefined):t&&"object"==typeof t&&(i="POST"),s.length>0&&x.ajax({url:e,type:i,dataType:"html",data:t}).done(function(e){o=arguments,s.html(r?x("<div>").append(x.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){s.each(n,o||[e.responseText,t,e])}),this},x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){x.fn[t]=function(e){return this.on(t,e)}}),x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ut,type:"GET",isLocal:Kt.test(Xt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":sn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":x.parseJSON,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?cn(cn(e,x.ajaxSettings),t):cn(x.ajaxSettings,e)},ajaxPrefilter:un(rn),ajaxTransport:un(on),ajax:function(e,t){"object"==typeof e&&(t=e,e=undefined),t=t||{};var n,r,i,o,s,a,u,l,c=x.ajaxSetup({},t),p=c.context||c,f=c.context&&(p.nodeType||p.jquery)?x(p):x.event,h=x.Deferred(),d=x.Callbacks("once memory"),g=c.statusCode||{},m={},y={},v=0,b="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(2===v){if(!o){o={};while(t=Qt.exec(i))o[t[1].toLowerCase()]=t[2]}t=o[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===v?i:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return v||(e=y[n]=y[n]||e,m[e]=t),this},overrideMimeType:function(e){return v||(c.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>v)for(t in e)g[t]=[g[t],e[t]];else T.always(e[T.status]);return this},abort:function(e){var t=e||b;return n&&n.abort(t),k(0,t),this}};if(h.promise(T).complete=d.add,T.success=T.done,T.error=T.fail,c.url=((e||c.url||Ut)+"").replace(Gt,"").replace(en,Xt[1]+"//"),c.type=t.method||t.type||c.method||c.type,c.dataTypes=x.trim(c.dataType||"*").toLowerCase().match(w)||[""],null==c.crossDomain&&(a=tn.exec(c.url.toLowerCase()),c.crossDomain=!(!a||a[1]===Xt[1]&&a[2]===Xt[2]&&(a[3]||("http:"===a[1]?"80":"443"))===(Xt[3]||("http:"===Xt[1]?"80":"443")))),c.data&&c.processData&&"string"!=typeof c.data&&(c.data=x.param(c.data,c.traditional)),ln(rn,c,t,T),2===v)return T;u=c.global,u&&0===x.active++&&x.event.trigger("ajaxStart"),c.type=c.type.toUpperCase(),c.hasContent=!Zt.test(c.type),r=c.url,c.hasContent||(c.data&&(r=c.url+=(Vt.test(r)?"&":"?")+c.data,delete c.data),c.cache===!1&&(c.url=Jt.test(r)?r.replace(Jt,"$1_="+Yt++):r+(Vt.test(r)?"&":"?")+"_="+Yt++)),c.ifModified&&(x.lastModified[r]&&T.setRequestHeader("If-Modified-Since",x.lastModified[r]),x.etag[r]&&T.setRequestHeader("If-None-Match",x.etag[r])),(c.data&&c.hasContent&&c.contentType!==!1||t.contentType)&&T.setRequestHeader("Content-Type",c.contentType),T.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+("*"!==c.dataTypes[0]?", "+sn+"; q=0.01":""):c.accepts["*"]);for(l in c.headers)T.setRequestHeader(l,c.headers[l]);if(c.beforeSend&&(c.beforeSend.call(p,T,c)===!1||2===v))return T.abort();b="abort";for(l in{success:1,error:1,complete:1})T[l](c[l]);if(n=ln(on,c,t,T)){T.readyState=1,u&&f.trigger("ajaxSend",[T,c]),c.async&&c.timeout>0&&(s=setTimeout(function(){T.abort("timeout")},c.timeout));try{v=1,n.send(m,k)}catch(C){if(!(2>v))throw C;k(-1,C)}}else k(-1,"No Transport");function k(e,t,o,a){var l,m,y,b,w,C=t;2!==v&&(v=2,s&&clearTimeout(s),n=undefined,i=a||"",T.readyState=e>0?4:0,l=e>=200&&300>e||304===e,o&&(b=pn(c,T,o)),b=fn(c,b,T,l),l?(c.ifModified&&(w=T.getResponseHeader("Last-Modified"),w&&(x.lastModified[r]=w),w=T.getResponseHeader("etag"),w&&(x.etag[r]=w)),204===e||"HEAD"===c.type?C="nocontent":304===e?C="notmodified":(C=b.state,m=b.data,y=b.error,l=!y)):(y=C,(e||!C)&&(C="error",0>e&&(e=0))),T.status=e,T.statusText=(t||C)+"",l?h.resolveWith(p,[m,C,T]):h.rejectWith(p,[T,C,y]),T.statusCode(g),g=undefined,u&&f.trigger(l?"ajaxSuccess":"ajaxError",[T,c,l?m:y]),d.fireWith(p,[T,C]),u&&(f.trigger("ajaxComplete",[T,c]),--x.active||x.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,n){return x.get(e,t,n,"json")},getScript:function(e,t){return x.get(e,undefined,t,"script")}}),x.each(["get","post"],function(e,t){x[t]=function(e,n,r,i){return x.isFunction(n)&&(i=i||r,r=n,n=undefined),x.ajax({url:e,type:t,dataType:i,data:n,success:r})}});function pn(e,t,n){var r,i,o,s,a=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),r===undefined&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in a)if(a[i]&&a[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}s||(s=i)}o=o||s}return o?(o!==u[0]&&u.unshift(o),n[o]):undefined}function fn(e,t,n,r){var i,o,s,a,u,l={},c=e.dataTypes.slice();if(c[1])for(s in e.converters)l[s.toLowerCase()]=e.converters[s];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(s=l[u+" "+o]||l["* "+o],!s)for(i in l)if(a=i.split(" "),a[1]===o&&(s=l[u+" "+a[0]]||l["* "+a[0]])){s===!0?s=l[i]:l[i]!==!0&&(o=a[0],c.unshift(a[1]));break}if(s!==!0)if(s&&e["throws"])t=s(t);else try{t=s(t)}catch(p){return{state:"parsererror",error:s?p:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return x.globalEval(e),e}}}),x.ajaxPrefilter("script",function(e){e.cache===undefined&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),x.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=x("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),o.head.appendChild(t[0])},abort:function(){n&&n()}}}});var hn=[],dn=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=hn.pop()||x.expando+"_"+Yt++;return this[e]=!0,e}}),x.ajaxPrefilter("json jsonp",function(t,n,r){var i,o,s,a=t.jsonp!==!1&&(dn.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&dn.test(t.data)&&"data");return a||"jsonp"===t.dataTypes[0]?(i=t.jsonpCallback=x.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(dn,"$1"+i):t.jsonp!==!1&&(t.url+=(Vt.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return s||x.error(i+" was not called"),s[0]},t.dataTypes[0]="json",o=e[i],e[i]=function(){s=arguments},r.always(function(){e[i]=o,t[i]&&(t.jsonpCallback=n.jsonpCallback,hn.push(i)),s&&x.isFunction(o)&&o(s[0]),s=o=undefined}),"script"):undefined}),x.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var gn=x.ajaxSettings.xhr(),mn={0:200,1223:204},yn=0,vn={};e.ActiveXObject&&x(e).on("unload",function(){for(var e in vn)vn[e]();vn=undefined}),x.support.cors=!!gn&&"withCredentials"in gn,x.support.ajax=gn=!!gn,x.ajaxTransport(function(e){var t;return x.support.cors||gn&&!e.crossDomain?{send:function(n,r){var i,o,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(i in e.xhrFields)s[i]=e.xhrFields[i];e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(i in n)s.setRequestHeader(i,n[i]);t=function(e){return function(){t&&(delete vn[o],t=s.onload=s.onerror=null,"abort"===e?s.abort():"error"===e?r(s.status||404,s.statusText):r(mn[s.status]||s.status,s.statusText,"string"==typeof s.responseText?{text:s.responseText}:undefined,s.getAllResponseHeaders()))}},s.onload=t(),s.onerror=t("error"),t=vn[o=yn++]=t("abort"),s.send(e.hasContent&&e.data||null)},abort:function(){t&&t()}}:undefined});var xn,bn,wn=/^(?:toggle|show|hide)$/,Tn=RegExp("^(?:([+-])=|)("+b+")([a-z%]*)$","i"),Cn=/queueHooks$/,kn=[An],Nn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=Tn.exec(t),o=i&&i[3]||(x.cssNumber[e]?"":"px"),s=(x.cssNumber[e]||"px"!==o&&+r)&&Tn.exec(x.css(n.elem,e)),a=1,u=20;if(s&&s[3]!==o){o=o||s[3],i=i||[],s=+r||1;do a=a||".5",s/=a,x.style(n.elem,e,s+o);while(a!==(a=n.cur()/r)&&1!==a&&--u)}return i&&(s=n.start=+s||+r||0,n.unit=o,n.end=i[1]?s+(i[1]+1)*i[2]:+i[2]),n}]};function En(){return setTimeout(function(){xn=undefined}),xn=x.now()}function Sn(e,t,n){var r,i=(Nn[t]||[]).concat(Nn["*"]),o=0,s=i.length;for(;s>o;o++)if(r=i[o].call(n,t,e))return r}function jn(e,t,n){var r,i,o=0,s=kn.length,a=x.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;var t=xn||En(),n=Math.max(0,l.startTime+l.duration-t),r=n/l.duration||0,o=1-r,s=0,u=l.tweens.length;for(;u>s;s++)l.tweens[s].run(o);return a.notifyWith(e,[l,o,n]),1>o&&u?n:(a.resolveWith(e,[l]),!1)},l=a.promise({elem:e,props:x.extend({},t),opts:x.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:xn||En(),duration:n.duration,tweens:[],createTween:function(t,n){var r=x.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)l.tweens[n].run(1);return t?a.resolveWith(e,[l,t]):a.rejectWith(e,[l,t]),this}}),c=l.props;for(Dn(c,l.opts.specialEasing);s>o;o++)if(r=kn[o].call(l,e,c,l.opts))return r;return x.map(c,Sn,l),x.isFunction(l.opts.start)&&l.opts.start.call(e,l),x.fx.timer(x.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function Dn(e,t){var n,r,i,o,s;for(n in e)if(r=x.camelCase(n),i=t[r],o=e[n],x.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),s=x.cssHooks[r],s&&"expand"in s){o=s.expand(o),delete e[r];for(n in o)n in e||(e[n]=o[n],t[n]=i)}else t[r]=i}x.Animation=x.extend(jn,{tweener:function(e,t){x.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Nn[n]=Nn[n]||[],Nn[n].unshift(t)},prefilter:function(e,t){t?kn.unshift(e):kn.push(e)}});function An(e,t,n){var r,i,o,s,a,u,l=this,c={},p=e.style,f=e.nodeType&&Lt(e),h=q.get(e,"fxshow");n.queue||(a=x._queueHooks(e,"fx"),null==a.unqueued&&(a.unqueued=0,u=a.empty.fire,a.empty.fire=function(){a.unqueued||u()}),a.unqueued++,l.always(function(){l.always(function(){a.unqueued--,x.queue(e,"fx").length||a.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===x.css(e,"display")&&"none"===x.css(e,"float")&&(p.display="inline-block")),n.overflow&&(p.overflow="hidden",l.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],wn.exec(i)){if(delete t[r],o=o||"toggle"===i,i===(f?"hide":"show")){if("show"!==i||!h||h[r]===undefined)continue;f=!0}c[r]=h&&h[r]||x.style(e,r)}if(!x.isEmptyObject(c)){h?"hidden"in h&&(f=h.hidden):h=q.access(e,"fxshow",{}),o&&(h.hidden=!f),f?x(e).show():l.done(function(){x(e).hide()}),l.done(function(){var t;q.remove(e,"fxshow");for(t in c)x.style(e,t,c[t])});for(r in c)s=Sn(f?h[r]:0,r,l),r in h||(h[r]=s.start,f&&(s.end=s.start,s.start="width"===r||"height"===r?1:0))}}function Ln(e,t,n,r,i){return new Ln.prototype.init(e,t,n,r,i)}x.Tween=Ln,Ln.prototype={constructor:Ln,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(x.cssNumber[n]?"":"px")},cur:function(){var e=Ln.propHooks[this.prop];return e&&e.get?e.get(this):Ln.propHooks._default.get(this)},run:function(e){var t,n=Ln.propHooks[this.prop];return this.pos=t=this.options.duration?x.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Ln.propHooks._default.set(this),this}},Ln.prototype.init.prototype=Ln.prototype,Ln.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=x.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){x.fx.step[e.prop]?x.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[x.cssProps[e.prop]]||x.cssHooks[e.prop])?x.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Ln.propHooks.scrollTop=Ln.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},x.each(["toggle","show","hide"],function(e,t){var n=x.fn[t];x.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(qn(t,!0),e,r,i)}}),x.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Lt).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=x.isEmptyObject(e),o=x.speed(t,n,r),s=function(){var t=jn(this,x.extend({},e),o);(i||q.get(this,"finish"))&&t.stop(!0)};return s.finish=s,i||o.queue===!1?this.each(s):this.queue(o.queue,s)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=undefined),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=x.timers,s=q.get(this);if(i)s[i]&&s[i].stop&&r(s[i]);else for(i in s)s[i]&&s[i].stop&&Cn.test(i)&&r(s[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));(t||!n)&&x.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=q.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=x.timers,s=r?r.length:0;for(n.finish=!0,x.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;s>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}});function qn(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=jt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}x.each({slideDown:qn("show"),slideUp:qn("hide"),slideToggle:qn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){x.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),x.speed=function(e,t,n){var r=e&&"object"==typeof e?x.extend({},e):{complete:n||!n&&t||x.isFunction(e)&&e,duration:e,easing:n&&t||t&&!x.isFunction(t)&&t};return r.duration=x.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in x.fx.speeds?x.fx.speeds[r.duration]:x.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){x.isFunction(r.old)&&r.old.call(this),r.queue&&x.dequeue(this,r.queue)},r},x.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},x.timers=[],x.fx=Ln.prototype.init,x.fx.tick=function(){var e,t=x.timers,n=0;for(xn=x.now();t.length>n;n++)e=t[n],e()||t[n]!==e||t.splice(n--,1);t.length||x.fx.stop(),xn=undefined},x.fx.timer=function(e){e()&&x.timers.push(e)&&x.fx.start()},x.fx.interval=13,x.fx.start=function(){bn||(bn=setInterval(x.fx.tick,x.fx.interval))},x.fx.stop=function(){clearInterval(bn),bn=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fx.step={},x.expr&&x.expr.filters&&(x.expr.filters.animated=function(e){return x.grep(x.timers,function(t){return e===t.elem}).length}),x.fn.offset=function(e){if(arguments.length)return e===undefined?this:this.each(function(t){x.offset.setOffset(this,e,t)});var t,n,i=this[0],o={top:0,left:0},s=i&&i.ownerDocument;if(s)return t=s.documentElement,x.contains(t,i)?(typeof i.getBoundingClientRect!==r&&(o=i.getBoundingClientRect()),n=Hn(s),{top:o.top+n.pageYOffset-t.clientTop,left:o.left+n.pageXOffset-t.clientLeft}):o},x.offset={setOffset:function(e,t,n){var r,i,o,s,a,u,l,c=x.css(e,"position"),p=x(e),f={};"static"===c&&(e.style.position="relative"),a=p.offset(),o=x.css(e,"top"),u=x.css(e,"left"),l=("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1,l?(r=p.position(),s=r.top,i=r.left):(s=parseFloat(o)||0,i=parseFloat(u)||0),x.isFunction(t)&&(t=t.call(e,n,a)),null!=t.top&&(f.top=t.top-a.top+s),null!=t.left&&(f.left=t.left-a.left+i),"using"in t?t.using.call(e,f):p.css(f)}},x.fn.extend({position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===x.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),x.nodeName(e[0],"html")||(r=e.offset()),r.top+=x.css(e[0],"borderTopWidth",!0),r.left+=x.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-x.css(n,"marginTop",!0),left:t.left-r.left-x.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||s;while(e&&!x.nodeName(e,"html")&&"static"===x.css(e,"position"))e=e.offsetParent;return e||s})}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,n){var r="pageYOffset"===n;x.fn[t]=function(i){return x.access(this,function(t,i,o){var s=Hn(t);return o===undefined?s?s[n]:t[i]:(s?s.scrollTo(r?e.pageXOffset:o,r?o:e.pageYOffset):t[i]=o,undefined)},t,i,arguments.length,null)}});function Hn(e){return x.isWindow(e)?e:9===e.nodeType&&e.defaultView}x.each({Height:"height",Width:"width"},function(e,t){x.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){x.fn[r]=function(r,i){var o=arguments.length&&(n||"boolean"!=typeof r),s=n||(r===!0||i===!0?"margin":"border");return x.access(this,function(t,n,r){var i;return x.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):r===undefined?x.css(t,n,s):x.style(t,n,r,s)},t,o?r:undefined,o,null)}})}),x.fn.size=function(){return this.length},x.fn.andSelf=x.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=x:"function"==typeof define&&define.amd&&define("jquery",[],function(){return x}),"object"==typeof e&&"object"==typeof e.document&&(e.jQuery=e.$=x)})(window);
(function(i){var b=jQuery.fn.jquery>="1.8";var l={xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",html:"http://www.w3.org/1999/xhtml/"};rbackslash=/\\(?!\\)/g;var q={};for(var f in l){q[l[f]]=f}i.extend({xmlns:i.extend({},l,{"":"*"})});var m=[];i.fn.extend({xmlns:function(t,u){if(typeof t=="string"){t={"":t}}if(t){m.push(i.xmlns);i.xmlns=i.extend({},i.xmlns,t);if(u!==undefined){if(typeof u=="string"){return this.find(u).xmlns(undefined)}else{var s=this;try{s=u.call(this);if(!s){s=this}}finally{s.xmlns(undefined)}return s}}else{return this}}else{i.xmlns=(m?m.pop():{});return this}}});var o=function(t){if(!t){return i.xmlns[""]}t=t.substr(0,t.length-1);if(t==""||t=="*"){return t}var s=i.xmlns[t];if(typeof(s)=="undefined"){throw"Syntax error, undefined namespace prefix '"+t+"'"}return s};var g=(b)?function(s,t){i.expr.match[s]=t}:function(s,t){i.expr.match[s]=new RegExp(t.source+/(?![^\[]*\])(?![^\(]*\))/.source);if(i.expr.leftMatch){i.expr.leftMatch[s]=new RegExp(/(^(?:.|\r|\n)*?)/.source+i.expr.match[s].source.replace(/\\(\d+)/g,function(v,u){return"\\"+(u-0+1)}))}};if(b){g("TAG",/^((?:((?:\\.|[-\w*]|[^\x00-\xa0])+\|)?((?:\\.|[-\w*]|[^\x00-\xa0])+)))/)}else{g("TAG",/^((?:((?:[\w\u00c0-\uFFFF\*_-]*\|)?)((?:[\w\u00c0-\uFFFF\*_-]|\\.)+)))/)}var a=document.createElement("div");var e=false;a.appendChild(document.createComment(""));if(a.getElementsByTagName("*").length>0){e=true}var r=true;if(a.localName&&a.localName=="div"){r=false}a=null;i.expr.find.TAG=function(v,s,A){if(!jQuery.isArray(v)){if(typeof s.getElementsByTagName!=="undefined"){return s.getElementsByTagName(v)}}var y=o(v[2]);var w=v[3];var x;if(typeof s.getElementsByTagNameNS!="undefined"){x=s.getElementsByTagNameNS(y,w)}else{if(typeof s.selectNodes!="undefined"){if(s.ownerDocument){s.ownerDocument.setProperty("SelectionLanguage","XPath")}else{s.setProperty("SelectionLanguage","XPath")}var z="";if(y!="*"){if(w!="*"){z="namespace-uri()='"+y+"' and local-name()='"+w+"'"}else{z="namespace-uri()='"+y+"'"}}else{if(w!="*"){z="local-name()='"+w+"'"}}if(z){x=s.selectNodes("descendant-or-self::*["+z+"]")}else{x=s.selectNodes("descendant-or-self::*")}}else{x=s.getElementsByTagName(w);if(e&&w=="*"){var u=[];for(var t=0;x[t];t++){if(x[t].nodeType==1){u.push(x[t])}}x=u}if(x&&y!="*"){var u=[];for(var t=0;x[t];t++){if(x[t].namespaceURI==y||x[t].tagUrn==y){u.push(x[t])}}x=u}}}return x};var p=function(s){return s.nodeType===9&&s.documentElement.nodeName!=="HTML"||!!s.ownerDocument&&s.ownerDocument.documentElement.nodeName!=="HTML"};i.expr.preFilter.TAG=function(v,t,u,s,x,y){var w=v[3];if(!y){if(r){w=w.toUpperCase()}else{w=w.toLowerCase()}}return[v[0],o(v[2]),w]};function c(s,t){return function(w){var u=w.namespaceURI?w.namespaceURI:w.tagUrn;var v=w.localName?w.localName:w.tagName;if(s=="*"||u==s||(s==""&&!u)){return((t=="*"&&w.nodeType==1)||v==t)}return false}}i.expr.filter.TAG=(b)?c:function(v,s){var t=s[1];var u=s[2];return c(t,u).call(this,v,null)};if(b){g("ATTR",/^\[[\x20\t\r\n\f]*(((?:\\.|[-\w]|[^\x00-\xa0])+\|)?((?:\\.|[-\w]|[^\x00-\xa0])+))[\x20\t\r\n\f]*(?:([*^$|!~]?=)[\x20\t\r\n\f]*(?:(['"])((?:\\.|[^\\])*?)\5|((?:\\.|[-\w]|[^\x00-\xa0])+\|)?((?:\\.|[-\w#]|[^\x00-\xa0])+)|)|)[\x20\t\r\n\f]*\]/)}else{g("ATTR",/\[\s*((?:((?:[\w\u00c0-\uFFFF\*_-]*\|)?)((?:[\w\u00c0-\uFFFF_-]|\\.)+)))\s*(?:(\S?=)\s*(['"]*)(.*?)\5|)\s*\]/)}i.expr.preFilter.ATTR=(b)?function(t,u,v){var s=t[1].replace(rbackslash,"");if(t[4]=="~="){t[6]=" "+t[6]+" "}t[5]=(t[6]||t[7]||"").replace(rbackslash,"");if(!t[2]||t[2]=="|"){t[2]=""}else{t[2]=o(t[2])}return t.slice(0,6)}:function(w,t,u,s,x,y){var v=w[3].replace(/\\/g,"");if(!y&&i.expr.attrMap[v]){w[3]=i.expr.attrMap[v]}if(w[4]=="~="){w[6]=" "+w[6]+" "}if(!w[2]||w[2]=="|"){w[2]=""}else{w[2]=o(w[2])}return w};var n=function(s,u,t){if(s==null){return u==="!="}if(!u){return true}s+="";return u==="="?s===t:u==="!="?s!==t:u==="^="?t&&s.indexOf(t)===0:u==="*="?t&&s.indexOf(t)>-1:u==="$="?t&&s.substr(s.length-t.length)===t:u==="~="?(" "+s+" ").indexOf(t)>-1:u==="|="?s===t||s.substr(0,t.length+1)===t+"-":false};function h(u,v,t,w,s){return function(D,B){if(v==""){var y=i(D).attr(t);return n(y,w,s)}else{if(v!="*"&&typeof D.getAttributeNS!="undefined"){return n(D.getAttributeNS(v,t),w,s)}var z=D.attributes;for(var A=0;z[A];A++){var C=z[A].localName;if(!C){C=z[A].nodeName;var x=C.indexOf(":");if(x>=0){C=C.substr(x+1)}}if(C==t){y=z[A].nodeValue;if(v=="*"||z[A].namespaceURI==v){if(n(y,w,s)){return true}}if(z[A].namespaceURI===""&&z[A].prefix){if(z[A].prefix==q[v]){if(n(y,w,s)){return true}}}}}return false}}}i.expr.filter.ATTR=(b)?h:function(x,u){var w=u[2];var t=u[3];var v=u[4];var s=u[6];return h(null,w,t,v,s).call(this,x,null)}})(jQuery);(function($){var escape=/["\\\x00-\x1f\x7f-\x9f]/g,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},hasOwn=Object.prototype.hasOwnProperty;$.toJSON=typeof JSON==="object"&&JSON.stringify?JSON.stringify:function(o){if(o===null){return"null"}var pairs,k,name,val,type=$.type(o);if(type==="undefined"){return undefined}if(type==="number"||type==="boolean"){return String(o)}if(type==="string"){return $.quoteString(o)}if(typeof o.toJSON==="function"){return $.toJSON(o.toJSON())}if(type==="date"){var month=o.getUTCMonth()+1,day=o.getUTCDate(),year=o.getUTCFullYear(),hours=o.getUTCHours(),minutes=o.getUTCMinutes(),seconds=o.getUTCSeconds(),milli=o.getUTCMilliseconds();if(month<10){month="0"+month}if(day<10){day="0"+day}if(hours<10){hours="0"+hours}if(minutes<10){minutes="0"+minutes}if(seconds<10){seconds="0"+seconds}if(milli<100){milli="0"+milli}if(milli<10){milli="0"+milli}return'"'+year+"-"+month+"-"+day+"T"+hours+":"+minutes+":"+seconds+"."+milli+'Z"'}pairs=[];if($.isArray(o)){for(k=0;k<o.length;k++){pairs.push($.toJSON(o[k])||"null")}return"["+pairs.join(",")+"]"}if(typeof o==="object"){for(k in o){if(hasOwn.call(o,k)){type=typeof k;if(type==="number"){name='"'+k+'"'}else{if(type==="string"){name=$.quoteString(k)}else{continue}}type=typeof o[k];if(type!=="function"&&type!=="undefined"){val=$.toJSON(o[k]);pairs.push(name+":"+val)}}}return"{"+pairs.join(",")+"}"}};$.evalJSON=typeof JSON==="object"&&JSON.parse?JSON.parse:function(str){return eval("("+str+")")};$.secureEvalJSON=typeof JSON==="object"&&JSON.parse?JSON.parse:function(str){var filtered=str.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"");if(/^[\],:{}\s]*$/.test(filtered)){return eval("("+str+")")}throw new SyntaxError("Error parsing JSON, source is not valid.")};$.quoteString=function(str){if(str.match(escape)){return'"'+str.replace(escape,function(a){var c=meta[a];if(typeof c==="string"){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"'}return'"'+str+'"'}}(jQuery));(function(m,p,v,r,n){var t=v.createElement("div"),h=t.style,c="Transform",C=["O"+c,"ms"+c,"Webkit"+c,"Moz"+c],z=C.length,a,l,G="Float32Array" in p,J,w,F=/Matrix([^)]*)/,q=/^\s*matrix\(\s*1\s*,\s*0\s*,\s*0\s*,\s*1\s*(?:,\s*0(?:px)?\s*){2}\)\s*$/,I="transform",K="transformOrigin",H="translate",f="rotate",s="scale",B="skew",b="matrix";while(z--){if(C[z] in h){m.support[I]=a=C[z];m.support[K]=a+"Origin";continue}}if(!a){m.support.matrixFilter=l=h.filter===""}m.cssNumber[I]=m.cssNumber[K]=true;if(a&&a!=I){m.cssProps[I]=a;m.cssProps[K]=a+"Origin";if(a=="Moz"+c){J={get:function(L,i){return(i?m.css(L,a).split("px").join(""):L.style[a])},set:function(i,L){i.style[a]=/matrix\([^)p]*\)/.test(L)?L.replace(/matrix((?:[^,]*,){4})([^,]*),([^)]*)/,b+"$1$2px,$3px"):L}}}else{if(/^1\.[0-5](?:\.|$)/.test(m.fn.jquery)){J={get:function(L,i){return(i?m.css(L,a.replace(/^ms/,"Ms")):L.style[a])}}}}}else{if(l){J={get:function(O,N,i){var M=(N&&O.currentStyle?O.currentStyle:O.style),L,P;if(M&&F.test(M.filter)){L=RegExp.$1.split(",");L=[L[0].split("=")[1],L[2].split("=")[1],L[1].split("=")[1],L[3].split("=")[1]]}else{L=[1,0,0,1]}if(!m.cssHooks[K]){L[4]=M?parseInt(M.left,10)||0:0;L[5]=M?parseInt(M.top,10)||0:0}else{P=m._data(O,"transformTranslate",n);L[4]=P?P[0]:0;L[5]=P?P[1]:0}return i?L:b+"("+L+")"},set:function(Q,R,M){var L=Q.style,N,i,P,O;if(!M){L.zoom=1}R=y(R);i=["Matrix(M11="+R[0],"M12="+R[2],"M21="+R[1],"M22="+R[3],"SizingMethod='auto expand'"].join();P=(N=Q.currentStyle)&&N.filter||L.filter||"";L.filter=F.test(P)?P.replace(F,i):P+" progid:DXImageTransform.Microsoft."+i+")";if(!m.cssHooks[K]){if((O=m.transform.centerOrigin)){L[O=="margin"?"marginLeft":"left"]=-(Q.offsetWidth/2)+(Q.clientWidth/2)+"px";L[O=="margin"?"marginTop":"top"]=-(Q.offsetHeight/2)+(Q.clientHeight/2)+"px"}L.left=R[4]+"px";L.top=R[5]+"px"}else{m.cssHooks[K].set(Q,R)}}}}}if(J){m.cssHooks[I]=J}w=J&&J.get||m.css;m.fx.step.transform=function(P){var O=P.elem,M=P.start,Q=P.end,U=P.pos,N="",S=100000,R,L,T,V;if(!M||typeof M==="string"){if(!M){M=w(O,a)}if(l){O.style.zoom=1}Q=Q.split("+=").join(M);m.extend(P,e(M,Q));M=P.start;Q=P.end}R=M.length;while(R--){L=M[R];T=Q[R];V=+false;switch(L[0]){case H:V="px";case s:V||(V="");N=L[0]+"("+r.round((L[1][0]+(T[1][0]-L[1][0])*U)*S)/S+V+","+r.round((L[1][1]+(T[1][1]-L[1][1])*U)*S)/S+V+")"+N;break;case B+"X":case B+"Y":case f:N=L[0]+"("+r.round((L[1]+(T[1]-L[1])*U)*S)/S+"rad)"+N;break}}P.origin&&(N=P.origin+N);J&&J.set?J.set(O,N,+true):O.style[a]=N};function y(N){N=N.split(")");var O=m.trim,R=-1,Q=N.length-1,T,L,M,P=G?new Float32Array(6):[],U=G?new Float32Array(6):[],S=G?new Float32Array(6):[1,0,0,1,0,0];P[0]=P[3]=S[0]=S[3]=1;P[1]=P[2]=P[4]=P[5]=0;while(++R<Q){T=N[R].split("(");L=O(T[0]);M=T[1];U[0]=U[3]=1;U[1]=U[2]=U[4]=U[5]=0;switch(L){case H+"X":U[4]=parseInt(M,10);break;case H+"Y":U[5]=parseInt(M,10);break;case H:M=M.split(",");U[4]=parseInt(M[0],10);U[5]=parseInt(M[1]||0,10);break;case f:M=g(M);U[0]=r.cos(M);U[1]=r.sin(M);U[2]=-r.sin(M);U[3]=r.cos(M);break;case s+"X":U[0]=+M;break;case s+"Y":U[3]=M;break;case s:M=M.split(",");U[0]=M[0];U[3]=M.length>1?M[1]:M[0];break;case B+"X":U[2]=r.tan(g(M));break;case B+"Y":U[1]=r.tan(g(M));break;case b:M=M.split(",");U[0]=M[0];U[1]=M[1];U[2]=M[2];U[3]=M[3];U[4]=parseInt(M[4],10);U[5]=parseInt(M[5],10);break}S[0]=P[0]*U[0]+P[2]*U[1];S[1]=P[1]*U[0]+P[3]*U[1];S[2]=P[0]*U[2]+P[2]*U[3];S[3]=P[1]*U[2]+P[3]*U[3];S[4]=P[0]*U[4]+P[2]*U[5]+P[4];S[5]=P[1]*U[4]+P[3]*U[5]+P[5];P=[S[0],S[1],S[2],S[3],S[4],S[5]]}return S}function u(N){var O,M,L,i=N[0],R=N[1],Q=N[2],P=N[3];if(i*P-R*Q){O=r.sqrt(i*i+R*R);i/=O;R/=O;L=i*Q+R*P;Q-=i*L;P-=R*L;M=r.sqrt(Q*Q+P*P);Q/=M;P/=M;L/=M;if(i*P<R*Q){i=-i;R=-R;L=-L;O=-O}}else{O=M=L=0}return[[H,[+N[4],+N[5]]],[f,r.atan2(R,i)],[B+"X",r.atan(L)],[s,[O,M]]]}function e(S,M){var P={start:[],end:[]},N=-1,L,O,Q,R;(S=="none"||E(S))&&(S="");(M=="none"||E(M))&&(M="");if(S&&M&&!M.indexOf("matrix")&&x(S).join()==x(M.split(")")[0]).join()){P.origin=S;S="";M=M.slice(M.indexOf(")")+1)}if(!S&&!M){return}if(!S||!M||A(S)==A(M)){S&&(S=S.split(")"))&&(L=S.length);M&&(M=M.split(")"))&&(L=M.length);while(++N<L-1){S[N]&&(O=S[N].split("("));M[N]&&(Q=M[N].split("("));R=m.trim((O||Q)[0]);D(P.start,o(R,O?O[1]:0));D(P.end,o(R,Q?Q[1]:0))}}else{P.start=u(y(S));P.end=u(y(M))}return P}function o(N,O){var L=+(!N.indexOf(s)),M,i=N.replace(/e[XY]/,"e");switch(N){case H+"Y":case s+"Y":O=[L,O?parseFloat(O):L];break;case H+"X":case H:case s+"X":M=1;case s:O=O?(O=O.split(","))&&[parseFloat(O[0]),parseFloat(O.length>1?O[1]:N==s?M||O[0]:L+"")]:[L,L];break;case B+"X":case B+"Y":case f:O=O?g(O):0;break;case b:return u(O?x(O):[1,0,0,1,0,0]);break}return[[i,O]]}function E(i){return q.test(i)}function A(i){return i.replace(/(?:\([^)]*\))|\s/g,"")}function D(L,i,M){while(M=i.shift()){L.push(M)}}function g(i){return ~i.indexOf("deg")?parseInt(i,10)*(r.PI*2/360):~i.indexOf("grad")?parseInt(i,10)*(r.PI/200):parseFloat(i)}function x(i){i=/([^,]*),([^,]*),([^,]*),([^,]*),([^,p]*)(?:px)?,([^)p]*)(?:px)?/.exec(i);return[i[1],i[2],i[3],i[4],i[5],i[6]]}m.transform={centerOrigin:"margin"}})(jQuery,window,document,Math);(function(e){var r=e.extend,m="mousedown",s="mousemove",n="mouseup",q="touchstart",i="touchmove",t="touchend",g="touchcancel";function f(z,x,y){if(x.substr(0,5)!=="touch"){return e(z).unbind(x,y)}var A,w;for(w=0;w<v._binds.length;w++){if(v._binds[w].elem===z&&v._binds[w].type===x&&v._binds[w].func===y){if(document.addEventListener){z.removeEventListener(x,v._binds[w].fnc,false)}else{z.detachEvent("on"+x,v._binds[w].fnc)}v._binds.splice(w--,1)}}}function v(A,x,z,y){if(x.substr(0,5)!=="touch"){return e(A).bind(x,y,z)}var B,w;if(v[x]){return v[x].bind(A,x,z,y)}B=function(C){if(!C){C=window.event}if(!C.stopPropagation){C.stopPropagation=function(){this.cancelBubble=true}}C.data=y;z.call(A,C)};if(document.addEventListener){A.addEventListener(x,B,false)}else{A.attachEvent("on"+x,B)}v._binds.push({elem:A,type:x,func:z,fnc:B})}function h(x,w){var y={move:{x:0,y:0},offset:{x:0,y:0},position:{x:0,y:0},start:{x:0,y:0},affects:document.documentElement,stopPropagation:false,preventDefault:true,touch:true};r(y,w);y.element=x;v(x,m,u,y);if(y.touch){v(x,q,a,y)}}function l(w){f(w,m,m)}function u(w){w.data.position.x=w.pageX;w.data.position.y=w.pageY;w.data.start.x=w.pageX;w.data.start.y=w.pageY;w.data.event=w;if(w.data.onstart&&w.data.onstart.call(w.data.element,w.data)){return}if(w.preventDefault&&w.data.preventDefault){w.preventDefault()}if(w.stopPropagation&&w.data.stopPropagation){w.stopPropagation()}v(w.data.affects,s,b,w.data);v(w.data.affects,n,p,w.data)}function b(w){if(w.preventDefault&&w.data.preventDefault){w.preventDefault()}if(w.stopPropagation&&w.data.preventDefault){w.stopPropagation()}w.data.move.x=w.pageX-w.data.position.x;w.data.move.y=w.pageY-w.data.position.y;w.data.position.x=w.pageX;w.data.position.y=w.pageY;w.data.offset.x=w.pageX-w.data.start.x;w.data.offset.y=w.pageY-w.data.start.y;w.data.event=w;if(w.data.onmove){w.data.onmove.call(w.data.element,w.data)}}function p(w){if(w.preventDefault&&w.data.preventDefault){w.preventDefault()}if(w.stopPropagation&&w.data.stopPropagation){w.stopPropagation()}f(w.data.affects,s,b);f(w.data.affects,n,p);w.data.event=w;if(w.data.onfinish){w.data.onfinish.call(w.data.element,w.data)}}function a(w){w.data.position.x=w.touches[0].pageX;w.data.position.y=w.touches[0].pageY;w.data.start.x=w.touches[0].pageX;w.data.start.y=w.touches[0].pageY;w.data.event=w;if(w.data.onstart&&w.data.onstart.call(w.data.element,w.data)){return}if(w.preventDefault&&w.data.preventDefault){w.preventDefault()}if(w.stopPropagation&&w.data.stopPropagation){w.stopPropagation()}v(w.data.affects,i,o,w.data);v(w.data.affects,t,c,w.data)}function o(w){if(w.preventDefault&&w.data.preventDefault){w.preventDefault()}if(w.stopPropagation&&w.data.stopPropagation){w.stopPropagation()}w.data.move.x=w.touches[0].pageX-w.data.position.x;w.data.move.y=w.touches[0].pageY-w.data.position.y;w.data.position.x=w.touches[0].pageX;w.data.position.y=w.touches[0].pageY;w.data.offset.x=w.touches[0].pageX-w.data.start.x;w.data.offset.y=w.touches[0].pageY-w.data.start.y;w.data.event=w;if(w.data.onmove){w.data.onmove.call(w.data.elem,w.data)}}function c(w){if(w.preventDefault&&w.data.preventDefault){w.preventDefault()}if(w.stopPropagation&&w.data.stopPropagation){w.stopPropagation()}f(w.data.affects,i,o);f(w.data.affects,t,c);w.data.event=w;if(w.data.onfinish){w.data.onfinish.call(w.data.element,w.data)}}v._binds=[];e.fn.grab=function(x,w){return this.each(function(){return h(this,x,w)})};e.fn.ungrab=function(w){return this.each(function(){return l(this,w)})}})(jQuery);PureCSSMatrix=(function(){var b=/deg$/;var f=/([0-9.\-e]+)/g;var g=/([a-zA-Z]+)\(([^\)]+)\)/g;function c(i){if(i&&i!==null&&i!="none"){if(i instanceof Matrix){this.setMatrix(i)}else{this.setMatrixValue(i)}}else{this.m=Matrix.I(3)}}c.prototype.setMatrix=function(i){this.m=i};function e(l){var i=parseFloat(h(l));if(l.match(b)){i=(2*Math.PI)*i/360}return i}c.prototype.setMatrixValue=function(n){var i=Matrix.I(3);var l;while((l=g.exec(n))!==null){var o=l[1].toLowerCase();var q=l[2].split(",");var m;if(o=="matrix"){m=Matrix.create([[parseFloat(q[0]),parseFloat(q[2]),parseFloat(h(q[4]))],[parseFloat(q[1]),parseFloat(q[3]),parseFloat(h(q[5]))],[0,0,1]])}else{if(o=="translate"){m=Matrix.I(3);m.elements[0][2]=parseFloat(h(q[0]));m.elements[1][2]=parseFloat(h(q[1]))}else{if(o=="scale"){var r=parseFloat(q[0]);var p;if(q.length>1){p=parseFloat(q[1])}else{p=r}m=Matrix.create([[r,0,0],[0,p,0],[0,0,1]])}else{if(o=="rotate"){m=Matrix.RotationZ(e(q[0]))}else{if(o=="skew"||o=="skewx"){m=Matrix.I(3);m.elements[0][1]=Math.tan(e(q[0]))}else{if(o=="skewy"){m=Matrix.I(3);m.elements[1][0]=Math.tan(e(q[0]))}else{console.log("Problem with setMatrixValue",o,q)}}}}}}i=i.multiply(m)}this.m=i};c.prototype.multiply=function(i){return new c(this.m.multiply(i.m))};c.prototype.inverse=function(){if(Math.abs(this.m.elements[0][0])<0.000001){this.m.elements[0][0]=0}return new c(this.m.inverse())};c.prototype.translate=function(i,m){var l=Matrix.I(3);l.elements[0][2]=i;l.elements[1][2]=m;return new c(this.m.multiply(l))};c.prototype.scale=function(m,l){var i=Matrix.create([[m,0,0],[0,l,0],[0,0,1]]);return new c(this.m.multiply(i))};c.prototype.rotate=function(i){var l=Matrix.RotationZ(i);return new c(this.m.multiply(l))};c.prototype.toString=function(){var l=this.m.elements;var i="";if($.browser.mozilla||$.browser.opera){i="px"}return"matrix("+a(l[0][0])+", "+a(l[1][0])+", "+a(l[0][1])+", "+a(l[1][1])+", "+a(l[0][2])+i+", "+a(l[1][2])+i+")"};c.prototype.elements=function(){var i=this.m.elements;return{a:i[0][0],b:i[1][0],c:i[0][1],d:i[1][1],e:i[0][2],f:i[1][2]}};function h(i){return i.match(f)}function a(i){return Number(i).toFixed(6)}return c})();if(!$.zoomooz){$.zoomooz={}}$.zoomooz.helpers=(function(c,b){var a=["-moz-","-webkit-","-o-","-ms-"];b.forEachPrefix=function(f,g){for(var e=0;e<a.length;e++){f(a[e])}if(g){f("")}};b.getElementTransform=function(e){var f;b.forEachPrefix(function(g){f=f||c(e).css(g+"transform")},true);return f};return b})(jQuery,{});(function(e){var p;var y;var h=/([0-9.\-e]+)/g;var b=/([a-z]+)\(([^\)]+)\)/g;var t=/deg$/;var r=e.zoomooz.helpers;var q={duration:450,easing:"ease",nativeanimation:false};var n;jQuery.cssHooks.MsTransform={set:function(B,C){B.style.msTransform=C}};jQuery.cssHooks.MsTransformOrigin={set:function(B,C){B.style.msTransformOrigin=C}};e.fn.animateTransformation=function(C,B,F,D){B=jQuery.extend({},q,B);var E=(e.browser.webkit&&B.nativeanimation);if(n){clearTimeout(n);n=null}if(E&&F){n=setTimeout(F,B.duration)}this.each(function(){var G=e(this);if(!C){C=new PureCSSMatrix()}var H=x(G);var I=i(H,z(C));if(E){G.css(l(A(I),B.duration,B.easing));if(D){D()}}else{a(G,H,I,B,F,D)}})};e.fn.setTransformation=function(B){this.each(function(){var C=e(this);var D=x(C);var E=i(D,z(B));C.css(l(A(E)))})};function l(B,D,G){var F={};r.forEachPrefix(function(H){F[H+"transform"]=B},true);if(D){var C=m(D/1000,6)+"s";F["-webkit-transition-duration"]=C;F["-o-transition-duration"]=C;F["-moz-transition-duration"]=C}if(G){var E=w(G);F["-webkit-transition-timing-function"]=E;F["-o-transition-timing-function"]=E;F["-moz-transition-timing-function"]=C}return F}function a(B,C,F,D,G,E){if(!C){C=z(new PureCSSMatrix())}p=(new Date()).getTime();if(y){clearInterval(y);y=null}if(D.easing){D.easingfunction=u(D.easing,D.duration)}s(B,C,F,D,G);if(E){E()}y=setInterval(function(){s(B,C,F,D,G)},1)}function s(B,H,E,D,G){var F=(new Date()).getTime()-p;var C;if(D.easingfunction){C=D.easingfunction(F/D.duration)}else{C=F/D.duration}B.css(l(A(f(H,E,C))));if(F>D.duration){clearInterval(y);y=null;C=1;if(G){G()}}}function z(N){var C=N.elements();var O=C.a,L=C.b,J=C.c,I=C.d,H=C.e,G=C.f;if(Math.abs(O*I-L*J)<0.01){console.log("fail!");return}var F=H,E=G;var M=Math.sqrt(O*O+L*L);O=O/M;L=L/M;var D=O*J+L*I;J-=O*D;I-=L*D;var K=Math.sqrt(J*J+I*I);J=J/K;I=I/K;D=D/K;if((O*I-L*J)<0){O=-O;L=-L;J=-J;I=-I;M=-M;K=-K}var B=Math.atan2(L,O);return{tx:F,ty:E,r:B,k:Math.atan(D),sx:M,sy:K}}function A(B){var C="";C+="translate("+m(B.tx,6)+"px,"+m(B.ty,6)+"px) ";C+="rotate("+m(B.r,6)+"rad) skewX("+m(B.k,6)+"rad) ";C+="scale("+m(B.sx,6)+","+m(B.sy,6)+")";return C}function w(B){if((B instanceof Array)){return"cubic-bezier("+m(B[0],6)+","+m(B[1],6)+","+m(B[2],6)+","+m(B[3],6)+")"}else{return B}}function u(C,D){var E=[];if((C instanceof Array)){E=C}else{switch(C){case"linear":E=[0,0,1,1];break;case"ease":E=[0.25,0.1,0.25,1];break;case"ease-in":E=[0.42,0,1,1];break;case"ease-out":E=[0,0,0.58,1];break;case"ease-in-out":E=[0.42,0,0.58,1];break}}var B=function(F){return c(F,E[0],E[1],E[2],E[3],D)};return B}function g(E,G,F,C,I){var B,H,D=((1-E)*(1-E)*(1-E));B=G*(3*E*E*(1-E))+C*(3*E*(1-E)*(1-E))+D;H=F*(3*E*E*(1-E))+I*(3*E*(1-E)*(1-E))+D;return{x:Math.abs(B),y:Math.abs(H)}}function c(P,D,C,L,K,B){var O=0,S=0,F=0,M=0,Q=0,E=0;function J(T){return((O*T+S)*T+F)*T}function I(T){return((M*T+Q)*T+E)*T}function R(T){return(3*O*T+2*S)*T+F}function N(T){return 1/(200*T)}function H(T,U){return I(G(T,U))}function G(aa,ab){var Z,Y,X,U,T,W;function V(ac){if(ac>=0){return ac}else{return 0-ac}}for(X=aa,W=0;W<8;W++){U=J(X)-aa;if(V(U)<ab){return X}T=R(X);if(V(T)<0.000001){break}X=X-U/T}Z=0;Y=1;X=aa;if(X<Z){return Z}if(X>Y){return Y}while(Z<Y){U=J(X);if(V(U-aa)<ab){return X}if(aa>U){Z=X}else{Y=X}X=(Y-Z)*0.5+Z}return X}F=3*D;S=3*(L-D)-F;O=1-F-S;E=3*C;Q=3*(K-C)-E;M=1-E-Q;return H(P,N(B))}function x(D){var C=r.getElementTransform(D);var E;if(!C){E=new PureCSSMatrix()}else{E=new PureCSSMatrix(C)}var B=z(E);B.r=o(C);return B}function o(F){var E=0;var C;while((C=b.exec(F))!==null){var G=C[1].toLowerCase();var H=C[2].split(",");if(G=="matrix"){var I=G+"("+C[2]+")";E+=z(new PureCSSMatrix(I)).r}else{if(G=="rotate"){var D=H[0];var B=parseFloat(v(D));if(D.match(t)){B=(2*Math.PI)*B/360}E+=B}}}return E}function i(B,C){if(Math.abs(B.r-C.r)>Math.PI){if(C.r<B.r){while(Math.abs(B.r-C.r)>Math.PI){C.r+=(2*Math.PI)}}else{while(Math.abs(B.r-C.r)>Math.PI){C.r-=(2*Math.PI)}}}return C}function f(B,E,F){var D={};for(var C in B){if(B.hasOwnProperty(C)){D[C]=B[C]+(E[C]-B[C])*F}}return D}function m(D,B){B=Math.abs(parseInt(B,10))||0;var C=Math.pow(10,B);return Math.round(D*C)/C}function v(B){return B.match(h)}})(jQuery);(function(i){var g=i.zoomooz.helpers;var n=["duration","easing","nativeanimation"];l();if(!i.zoomooz){i.zoomooz={}}i.zoomooz.setup=function(t){i.zoomooz.defaultSettings=jQuery.extend(o(),t)};i.fn.zoomSettings=function(t){var u;this.each(function(){var v=i(this);u=r(v,t)});return u};i.fn.zoomTo=function(u,t){this.each(function(){var v=i(this);if(!t){u=v.zoomSettings(u)}h(v,u);if(u.debug){if(i("#debug").length===0){i(u.root).append('<div id="debug"><div>')}else{i("#debug").html("")}q(v,u)}else{if(i("#debug").length!==0){i("#debug").html("")}}});return this};function r(u,z){var y=jQuery.extend({},z);if(!i.zoomooz.defaultSettings){i.zoomooz.setup()}var x=i.zoomooz.defaultSettings;var t=jQuery.extend({},y);for(var w in x){if(x.hasOwnProperty(w)&&!t[w]){t[w]=u.data(w)}}for(var v=0;v<n.length;v++){var w=n[v];if(!t[w]){t[w]=u.data(w)}}return jQuery.extend({},x,t)}function l(){var u=document.createElement("style");u.type="text/css";var t="";g.forEachPrefix(function(v){t+=v+"transform-origin: 0 0;"},true);u.innerHTML="html {height:100%;}.noScroll{overflow:hidden !important;}body.noScroll,html.noScroll body{margin-right:15px;}* {"+t+"}";document.getElementsByTagName("head")[0].appendChild(u)}function o(){return{targetsize:0.9,scalemode:"both",root:i(document.body),debug:false,animationendcallback:null,closeclick:false}}function h(x,v){var z=b(x,v);var w;var y=null;f(v.root);if(x[0]!==v.root[0]){var t=e(x,v.root).inverse();w=c(x,t,v);if(v.animationendcallback){y=function(){v.animationendcallback.call(x[0])}}}else{w=(new PureCSSMatrix()).translate(-z.x,-z.y);y=function(){var B=i(v.root);var A=z.elem;A.removeClass("noScroll");B.setTransformation(new PureCSSMatrix());B.data("original-scroll",null);i(document).off("touchmove");if(A[0]==document.body||A[0]==window){window.scrollTo(z.x,z.y)}else{A.scrollLeft(z.x);A.scrollTop(z.y)}if(v.animationendcallback){v.animationendcallback.call(x[0])}}}var u=null;if(z&&z.animationstartedcallback){u=z.animationstartedcallback}i(v.root).animateTransformation(w,v,y,u)}function b(v,u){var z=u.root;var t=z.parent();if(v[0]===z[0]){var y=z.data("original-scroll");if(y){return y}else{return{elem:t,x:0,"y:":0}}}else{if(!z.data("original-scroll")){var x=z.scrollTop();var A=z.scrollLeft();var v=z;if(!x){x=t.scrollTop();A=t.scrollLeft();v=t}var y={elem:v,x:A,y:x};z.data("original-scroll",y);i(document).on("touchmove",function(B){B.preventDefault()});var w="translate(-"+A+"px,-"+x+"px)";g.forEachPrefix(function(B){z.css(B+"transform",w)});v.addClass("noScroll");y.animationstartedcallback=function(){if(v[0]==document.body||v[0]==document){window.scrollTo(0,0)}else{v.scrollLeft(0);v.scrollTop(0)}};return y}}}function f(y){var z=i(y).parent();var v=z.width();var x=z.height();var t=v/2;var u=x/2;var w=p(t)+"px "+p(u)+"px";g.forEachPrefix(function(A){y.css(A+"transform-origin",w)})}function c(G,C,F){var K=F.targetsize;var J=F.scalemode;var t=F.root;var H=i(t).parent();var B=H.width();var D=H.height();var u=B/G.outerWidth();var w=D/G.outerHeight();var L;if(J=="width"){L=K*u}else{if(J=="height"){L=K*w}else{if(J=="both"){L=K*Math.min(u,w)}else{if(J=="scale"){L=K}else{console.log("wrong zoommode");return}}}}var A=(B-G.outerWidth()*L)/2;var x=(D-G.outerHeight()*L)/2;var E=B/2;var v=D/2;var y=-parseFloat(t.css("margin-left"))||0;var I=-parseFloat(t.css("margin-top"))||0;var z=(new PureCSSMatrix()).translate(y,I).translate(-E,-v).translate(A,x).scale(L,L).multiply(C).translate(E,v);return z}function s(u,t,v){return[u.a*t+u.c*v+u.e,u.b*t+u.d*v+u.f]}function q(u,t){var v=e(u,t.root).elements();m(s(v,0,0));m(s(v,0,u.outerHeight()));m(s(v,u.outerWidth(),u.outerHeight()));m(s(v,u.outerWidth(),0))}function m(v){var t="width:4px;height:4px;background-color:red;position:absolute;margin-left:-2px;margin-top:-2px;";t+="left:"+v[0]+"px;top:"+v[1]+"px;";var u='<div class="debuglabel" style="'+t+'"></div>';i("#debug").append(u)}function e(B,F){var I=B[0];if(!I||!I.ownerDocument){return null}var H=new PureCSSMatrix();var u;if(I===I.ownerDocument.body){var K=jQuery.offset.bodyOffset(I);u=new PureCSSMatrix();u=u.translate(K.left,K.top);H=H.multiply(u);return H}var z;if(jQuery.offset.initialize){jQuery.offset.initialize();z={fixedPosition:jQuery.offset.supportsFixedPosition,doesNotAddBorder:jQuery.offset.doesNotAddBorder,doesAddBorderForTableAndCells:jQuery.support.doesAddBorderForTableAndCells,subtractsBorderForOverflowNotVisible:jQuery.offset.subtractsBorderForOverflowNotVisible}}else{z=jQuery.support}var t=I.offsetParent;var L=I.ownerDocument;var x;var J=L.documentElement;var A=L.body;var G=F[0];var E=L.defaultView;var w;if(E){w=E.getComputedStyle(I,null)}else{w=I.currentStyle}var C=I.offsetTop;var v=I.offsetLeft;var y=a().translate(v,C);y=y.multiply(a(I));H=y.multiply((H));while((I=I.parentNode)&&I!==G){C=0;v=0;if(z.fixedPosition&&w.position==="fixed"){break}x=E?E.getComputedStyle(I,null):I.currentStyle;C-=I.scrollTop;v-=I.scrollLeft;if(I===t){C+=I.offsetTop;v+=I.offsetLeft;if(z.doesNotAddBorder&&!(z.doesAddBorderForTableAndCells&&/^t(able|d|h)$/i.test(I.nodeName))){C+=parseFloat(x.borderTopWidth)||0;v+=parseFloat(x.borderLeftWidth)||0}t=I.offsetParent}if(z.subtractsBorderForOverflowNotVisible&&x.overflow!=="visible"){C+=parseFloat(x.borderTopWidth)||0;v+=parseFloat(x.borderLeftWidth)||0}w=x;if(I.offsetParent==G){C-=parseFloat(i(I.offsetParent).css("margin-top"))||0;v-=parseFloat(i(I.offsetParent).css("margin-left"))||0}y=a().translate(v,C);y=y.multiply(a(I));H=y.multiply(H)}C=0;v=0;if(w.position==="relative"||w.position==="static"){C+=A.offsetTop;v+=A.offsetLeft}if(z.fixedPosition&&w.position==="fixed"){C+=Math.max(J.scrollTop,A.scrollTop);v+=Math.max(J.scrollLeft,A.scrollLeft)}var D=(new PureCSSMatrix()).translate(v,C);H=H.multiply(D);return H}function p(t){return Number(t).toFixed(6)}function a(u){var t=g.getElementTransform(u);if(!t){return new PureCSSMatrix()}else{return new PureCSSMatrix(t)}}})(jQuery);(function(b){if(!b.zoomooz){b.zoomooz={}}var a=b.zoomooz.helpers;b.fn.zoomTarget=function(f){this.each(function(){var g=b(this).zoomSettings(f);c(b(this),b(this),g)})};function c(f,m,g){f.addClass("zoomTarget");if(!g.animationendcallback){if(!g.closeclick){g.animationendcallback=function(){b(".selectedZoomTarget").removeClass("selectedZoomTarget zoomNotClickable");f.addClass("selectedZoomTarget zoomNotClickable")}}else{g.animationendcallback=function(){b(".selectedZoomTarget").removeClass("selectedZoomTarget zoomNotClickable");f.addClass("selectedZoomTarget")}}}var l=m.closest(".zoomContainer");if(l.length!=0){g.root=l}var h=g.root;if(!h.hasClass("zoomTarget")){var i=h.zoomSettings({});i.animationendcallback=function(){var n=b(this);b(".selectedZoomTarget").removeClass("selectedZoomTarget zoomNotClickable");n.addClass("selectedZoomTarget zoomNotClickable");n.parent().addClass("selectedZoomTarget zoomNotClickable")};c(h,h,i);c(h.parent(),h,i);h.click()}f.on("click",function(n){if(g.closeclick&&m.hasClass("selectedZoomTarget")){g.root.click()}else{m.zoomTo(g)}n.stopPropagation()})}function e(){var f=document.createElement("style");f.type="text/css";function g(h){var i="-webkit-touch-callout: "+(h?"default":"none")+";";a.forEachPrefix(function(l){i+=l+"user-select:"+(h?"text":"none")+";"},true);return i}f.innerHTML=".zoomTarget{"+g(false)+"}.zoomTarget:hover{cursor:pointer!important;}.zoomNotClickable{"+g(true)+"}.zoomNotClickable:hover{cursor:auto!important;}.zoomContainer{position:relative;padding:1px;margin:-1px;}";document.getElementsByTagName("head")[0].appendChild(f)}e();b(document).ready(function(){b(".zoomTarget").zoomTarget()})})(jQuery);(function(a){if(!a.zoomooz){a.zoomooz={}}a.fn.zoomContainer=function(b){};a(document).ready(function(){a(".zoomContainer").zoomContainer()})})(jQuery);var Sylvester={version:"0.1.3",precision:0.000001};function Matrix(){}Matrix.prototype={dup:function(){return Matrix.create(this.elements)},canMultiplyFromLeft:function(a){var b=a.elements||a;if(typeof(b[0][0])=="undefined"){b=Matrix.create(b).elements}return(this.elements[0].length==b.length)},multiply:function(s){var l=s.modulus?true:false;var p=s.elements||s;if(typeof(p[0][0])=="undefined"){p=Matrix.create(p).elements}if(!this.canMultiplyFromLeft(p)){return null}var f=this.elements.length,g=f,n,b,e=p[0].length,h;var r=this.elements[0].length,a=[],o,m,q;do{n=g-f;a[n]=[];b=e;do{h=e-b;o=0;m=r;do{q=r-m;o+=this.elements[n][q]*p[q][h]}while(--m);a[n][h]=o}while(--b)}while(--f);var p=Matrix.create(a);return l?p.col(1):p},isSquare:function(){return(this.elements.length==this.elements[0].length)},toRightTriangular:function(){var g=this.dup(),e;var b=this.elements.length,c=b,f,h,l=this.elements[0].length,a;do{f=c-b;if(g.elements[f][f]==0){for(j=f+1;j<c;j++){if(g.elements[j][f]!=0){e=[];h=l;do{a=l-h;e.push(g.elements[f][a]+g.elements[j][a])}while(--h);g.elements[f]=e;break}}}if(g.elements[f][f]!=0){for(j=f+1;j<c;j++){var m=g.elements[j][f]/g.elements[f][f];e=[];h=l;do{a=l-h;e.push(a<=f?0:g.elements[j][a]-g.elements[f][a]*m)}while(--h);g.elements[j]=e}}}while(--b);return g},determinant:function(){if(!this.isSquare()){return null}var f=this.toRightTriangular();var c=f.elements[0][0],e=f.elements.length-1,a=e,b;do{b=a-e+1;c=c*f.elements[b][b]}while(--e);return c},isSingular:function(){return(this.isSquare()&&this.determinant()===0)},augment:function(n){var l=n.elements||n;if(typeof(l[0][0])=="undefined"){l=Matrix.create(l).elements}var f=this.dup(),m=f.elements[0].length;var c=f.elements.length,e=c,h,a,b=l[0].length,g;if(c!=l.length){return null}do{h=e-c;a=b;do{g=b-a;f.elements[h][m+g]=l[h][g]}while(--a)}while(--c);return f},inverse:function(){if(!this.isSquare()||this.isSingular()){return null}var c=this.elements.length,e=c,l,h;var m=this.augment(Matrix.I(c)).toRightTriangular();var n,o=m.elements[0].length,a,g,b;var q=[],f;do{l=c-1;g=[];n=o;q[l]=[];b=m.elements[l][l];do{a=o-n;f=m.elements[l][a]/b;g.push(f);if(a>=e){q[l].push(f)}}while(--n);m.elements[l]=g;for(h=0;h<l;h++){g=[];n=o;do{a=o-n;g.push(m.elements[h][a]-m.elements[l][a]*m.elements[h][l])}while(--n);m.elements[h]=g}}while(--c);return Matrix.create(q)},setElements:function(l){var o,a=l.elements||l;if(typeof(a[0][0])!="undefined"){var e=a.length,g=e,b,c,m;this.elements=[];do{o=g-e;b=a[o].length;c=b;this.elements[o]=[];do{m=c-b;this.elements[o][m]=a[o][m]}while(--b)}while(--e);return this}var f=a.length,h=f;this.elements=[];do{o=h-f;this.elements.push([a[o]])}while(--f);return this}};Matrix.create=function(a){var b=new Matrix();return b.setElements(a)};Matrix.I=function(g){var f=[],a=g,e,c,b;do{e=a-g;f[e]=[];c=a;do{b=a-c;f[e][b]=(e==b)?1:0}while(--c)}while(--g);return Matrix.create(f)};(function(f,h,l,m,b){var i={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(r){for(var o=0;o<r.length;o++){var p=r[o].string;var q=r[o].prop;this.versionSearchString=r[o].versionSearch||r[o].identity;if(p){if(p.indexOf(r[o].subString)!=-1){return r[o].identity}}else{if(q){return r[o].identity}}}},searchVersion:function(p){var o=p.indexOf(this.versionSearchString);if(o==-1){return}return parseFloat(p.substring(o+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:h.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};i.init();var n={MSIE:{Windows:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"}},Firefox:{Windows:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Linux:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Mac:{ctrlKey:false,altKey:false,metaKey:true,shiftKey:true,which:70,string:"&#x21E7;&#x2318;F",alt:"Shift+Command+F"}},Chrome:{Windows:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Linux:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Mac:{ctrlKey:false,altKey:false,metaKey:true,shiftKey:true,which:70,string:"&#x21E7;&#x2318;F",alt:"Shift+Command+F"}},Safari:{Mac:{ctrlKey:true,altKey:false,metaKey:false,shiftKey:true,which:70,string:"^&#x2318;F",alt:"Control+Command+F"}},Opera:{Windows:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Linux:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Mac:{ctrlKey:false,altKey:false,metaKey:true,shiftKey:true,which:70,string:"&#x21E7;&#x2318;F",alt:"Shift+Command+F"}},};var g=function(){return(l.clientHeight==m&&l.clientWidth==b)||h.fullScreen||(h.outerHeight==m&&h.outerWidth==b)||(i.browser=="Safari"&&h.outerHeight==(m-40)&&h.outerWidth==b)},c=f(h);var a=n[i.browser][i.OS];var e={shortcut:a.string,longform:a.alt};c.data("fullscreen-state",g()).data("fullscreen-key",e).resize(function(){var o=g();if(c.data("fullscreen-state")&&!o){c.data("fullscreen-state",o).trigger("fullscreen-toggle",[false]).trigger("fullscreen-off")}else{if(!c.data("fullscreen-state")&&o){c.data("fullscreen-state",o).trigger("fullscreen-toggle",[true]).trigger("fullscreen-on")}}}).keydown(function(o){if(a&&o.ctrlKey==a.ctrlKey&&o.altKey==a.altKey&&o.metaKey==a.metaKey&&o.shiftKey==a.shiftKey&&o.which==a.which){c.trigger("fullscreen-key",[a.string,a.alt])}})})(jQuery,this,document.documentElement,screen.height,screen.width);(function(l){var f="0.4.2",m="hasOwnProperty",b=/[\.\/]/,a="*",h=function(){},g=function(p,o){return p-o},e,i,n={n:{}},c=function(o,E){o=String(o);var x=n,u=i,y=Array.prototype.slice.call(arguments,2),B=c.listeners(o),A=0,w=false,r,q=[],v={},s=[],p=e,C=[];e=o;i=0;for(var t=0,D=B.length;t<D;t++){if("zIndex" in B[t]){q.push(B[t].zIndex);if(B[t].zIndex<0){v[B[t].zIndex]=B[t]}}}q.sort(g);while(q[A]<0){r=v[q[A++]];s.push(r.apply(E,y));if(i){i=u;return s}}for(t=0;t<D;t++){r=B[t];if("zIndex" in r){if(r.zIndex==q[A]){s.push(r.apply(E,y));if(i){break}do{A++;r=v[q[A]];r&&s.push(r.apply(E,y));if(i){break}}while(r)}else{v[r.zIndex]=r}}else{s.push(r.apply(E,y));if(i){break}}}i=u;e=p;return s.length?s:null};c._events=n;c.listeners=function(o){var w=o.split(b),u=n,A,v,p,s,z,r,t,x,y=[u],q=[];for(s=0,z=w.length;s<z;s++){x=[];for(r=0,t=y.length;r<t;r++){u=y[r].n;v=[u[w[s]],u[a]];p=2;while(p--){A=v[p];if(A){x.push(A);q=q.concat(A.f||[])}}}y=x}return q};c.on=function(o,r){o=String(o);if(typeof r!="function"){return function(){}}var t=o.split(b),s=n;for(var p=0,q=t.length;p<q;p++){s=s.n;s=s.hasOwnProperty(t[p])&&s[t[p]]||(s[t[p]]={n:{}})}s.f=s.f||[];for(p=0,q=s.f.length;p<q;p++){if(s.f[p]==r){return h}}s.f.push(r);return function(u){if(+u==+u){r.zIndex=+u}}};c.f=function(p){var o=[].slice.call(arguments,1);return function(){c.apply(null,[p,null].concat(o).concat([].slice.call(arguments,0)))}};c.stop=function(){i=1};c.nt=function(o){if(o){return new RegExp("(?:\\.|\\/|^)"+o+"(?:\\.|\\/|$)").test(e)}return e};c.nts=function(){return e.split(b)};c.off=c.unbind=function(p,u){if(!p){c._events=n={n:{}};return}var w=p.split(b),v,y,q,s,z,r,t,x=[n];for(s=0,z=w.length;s<z;s++){for(r=0;r<x.length;r+=q.length-2){q=[r,1];v=x[r].n;if(w[s]!=a){if(v[w[s]]){q.push(v[w[s]])}}else{for(y in v){if(v[m](y)){q.push(v[y])}}}x.splice.apply(x,q)}}for(s=0,z=x.length;s<z;s++){v=x[s];while(v.n){if(u){if(v.f){for(r=0,t=v.f.length;r<t;r++){if(v.f[r]==u){v.f.splice(r,1);break}}!v.f.length&&delete v.f}for(y in v.n){if(v.n[m](y)&&v.n[y].f){var o=v.n[y].f;for(r=0,t=o.length;r<t;r++){if(o[r]==u){o.splice(r,1);break}}!o.length&&delete v.n[y].f}}}else{delete v.f;for(y in v.n){if(v.n[m](y)&&v.n[y].f){delete v.n[y].f}}}v=v.n}}};c.once=function(o,p){var q=function(){c.unbind(o,q);return p.apply(this,arguments)};return c.on(o,q)};c.version=f;c.toString=function(){return"You are running Eve "+f};(typeof module!="undefined"&&module.exports)?(module.exports=c):(typeof define!="undefined"?(define("eve",[],function(){return c})):(l.eve=c))})(this);(function(){function aT(i){if(aT.is(i,"function")){return aq?i():eve.on("raphael.DOMload",i)}else{if(aT.is(i,bf)){return aT._engine.create[bI](aT,i.splice(0,3+aT.is(i[0],aN))).add(i)}else{var b=Array.prototype.slice.call(arguments,0);if(aT.is(b[b.length-1],"function")){var g=b.pop();return aq?g.call(aT._engine.create[bI](aT,b)):eve.on("raphael.DOMload",function(){g.call(aT._engine.create[bI](aT,b))})}else{return aT._engine.create[bI](aT,arguments)}}}}aT.version="2.1.0";aT.eve=eve;var aq,a=/[, ]+/,by={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},bt=/\{(\d+)\}/g,bL="prototype",am="hasOwnProperty",aC={doc:document,win:window},u={was:Object.prototype[am].call(aC.win,"Raphael"),is:aC.win.Raphael},bH=function(){this.ca=this.customAttributes={}},a6,bq="appendChild",bI="apply",bG="concat",ab="createTouch" in aC.doc,aZ="",aS=" ",bJ=String,H="split",U="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[H](aS),bz={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},bM=bJ.prototype.toLowerCase,aw=Math,o=aw.max,bo=aw.min,ay=aw.abs,br=aw.pow,aX=aw.PI,aN="number",al="string",bf="array",a7="toString",bb="fill",a3=Object.prototype.toString,bB={},l="push",f=aT._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,C=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,ax={"NaN":1,"Infinity":1,"-Infinity":1},c=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,aj=aw.round,B="setAttribute",ap=parseFloat,W=parseInt,bv=bJ.prototype.toUpperCase,t=aT._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},au=aT._availableAnimAttrs={blur:aN,"clip-rect":"csv",cx:aN,cy:aN,fill:"colour","fill-opacity":aN,"font-size":aN,height:aN,opacity:aN,path:"path",r:aN,rx:aN,ry:aN,stroke:"colour","stroke-opacity":aN,"stroke-width":aN,transform:"transform",width:aN,x:aN,y:aN},ae=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]/g,bk=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,p={hs:1,rg:1},bi=/,?([achlmqrstvxz]),?/gi,a2=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,ak=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,aR=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/ig,aY=aT._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,aW={},bs=function(i,g){return i.key-g.key},w=function(i,g){return ap(i)-ap(g)},K=function(){},bD=function(b){return b},aB=aT._rectPath=function(b,R,g,i,E){if(E){return[["M",b+E,R],["l",g-E*2,0],["a",E,E,0,0,1,E,E],["l",0,i-E*2],["a",E,E,0,0,1,-E,E],["l",E*2-g,0],["a",E,E,0,0,1,-E,-E],["l",0,E*2-i],["a",E,E,0,0,1,E,-E],["z"]]}return[["M",b,R],["l",g,0],["l",0,i],["l",-g,0],["z"]]},M=function(b,E,i,g){if(g==null){g=i}return[["M",b,E],["m",0,-g],["a",i,g,0,1,1,0,2*g],["a",i,g,0,1,1,0,-2*g],["z"]]},P=aT._getPath={path:function(b){return b.attr("path")},circle:function(g){var b=g.attrs;return M(b.cx,b.cy,b.r)},ellipse:function(g){var b=g.attrs;return M(b.cx,b.cy,b.rx,b.ry)},rect:function(g){var b=g.attrs;return aB(b.x,b.y,b.width,b.height,b.r)},image:function(g){var b=g.attrs;return aB(b.x,b.y,b.width,b.height)},text:function(b){var g=b._getBBox();return aB(g.x,g.y,g.width,g.height)},set:function(b){var g=b._getBBox();return aB(g.x,g.y,g.width,g.height)}},N=aT.mapPath=function(bQ,bN){if(!bN){return bQ}var bO,S,E,b,bP,R,g;bQ=Y(bQ);for(E=0,bP=bQ.length;E<bP;E++){g=bQ[E];for(b=1,R=g.length;b<R;b+=2){bO=bN.x(g[b],g[b+1]);S=bN.y(g[b],g[b+1]);g[b]=bO;g[b+1]=S}}return bQ};aT._g=aC;aT.type=(aC.win.SVGAngle||aC.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML");if(aT.type=="VML"){var aG=aC.doc.createElement("div"),aJ;aG.innerHTML='<v:shape adj="1"/>';aJ=aG.firstChild;aJ.style.behavior="url(#default#VML)";if(!(aJ&&typeof aJ.adj=="object")){return(aT.type=aZ)}aG=null}aT.svg=!(aT.vml=aT.type=="VML");aT._Paper=bH;aT.fn=a6=bH.prototype=aT.prototype;aT._id=0;aT._oid=0;aT.is=function(g,b){b=bM.call(b);if(b=="finite"){return !ax[am](+g)}if(b=="array"){return g instanceof Array}return(b=="null"&&g===null)||(b==typeof g&&g!==null)||(b=="object"&&g===Object(g))||(b=="array"&&Array.isArray&&Array.isArray(g))||a3.call(g).slice(8,-1).toLowerCase()==b};function Z(i){if(Object(i)!==i){return i}var g=new i.constructor;for(var b in i){if(i[am](b)){g[b]=Z(i[b])}}return g}aT.angle=function(R,bN,i,S,g,E){if(g==null){var b=R-i,bO=bN-S;if(!b&&!bO){return 0}return(180+aw.atan2(-bO,-b)*180/aX+360)%360}else{return aT.angle(R,bN,g,E)-aT.angle(i,S,g,E)}};aT.rad=function(b){return b%360*aX/180};aT.deg=function(b){return b*180/aX%360};aT.snapTo=function(g,R,b){b=aT.is(b,"finite")?b:10;if(aT.is(g,bf)){var E=g.length;while(E--){if(ay(g[E]-R)<=b){return g[E]}}}else{g=+g;var S=R%g;if(S<b){return R-S}if(S>g-b){return R-S+g}}return R};var h=aT.createUUID=(function(b,g){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(b,g).toUpperCase()}})(/[xy]/g,function(i){var g=aw.random()*16|0,b=i=="x"?g:(g&3|8);return b.toString(16)});aT.setWindow=function(b){eve("raphael.setWindow",aT,aC.win,b);aC.win=b;aC.doc=aC.win.document;if(aT._engine.initWin){aT._engine.initWin(aC.win)}};var bh=function(E){if(aT.vml){var b=/^\s+|\s+$/g;var S;try{var bN=new ActiveXObject("htmlfile");bN.write("<body>");bN.close();S=bN.body}catch(bO){S=createPopup().document.body}var g=S.createTextRange();bh=aI(function(i){try{S.style.color=bJ(i).replace(b,aZ);var bP=g.queryCommandValue("ForeColor");bP=((bP&255)<<16)|(bP&65280)|((bP&16711680)>>>16);return"#"+("000000"+bP.toString(16)).slice(-6)}catch(bQ){return"none"}})}else{var R=aC.doc.createElement("i");R.title="Rapha\xebl Colour Picker";R.style.display="none";aC.doc.body.appendChild(R);bh=aI(function(i){R.style.color=i;return aC.doc.defaultView.getComputedStyle(R,aZ).getPropertyValue("color")})}return bh(E)},aK=function(){return"hsb("+[this.h,this.s,this.b]+")"},O=function(){return"hsl("+[this.h,this.s,this.l]+")"},z=function(){return this.hex},a0=function(S,R,i){if(R==null&&aT.is(S,"object")&&"r" in S&&"g" in S&&"b" in S){i=S.b;R=S.g;S=S.r}if(R==null&&aT.is(S,al)){var E=aT.getRGB(S);S=E.r;R=E.g;i=E.b}if(S>1||R>1||i>1){S/=255;R/=255;i/=255}return[S,R,i]},a4=function(S,R,i,bN){S*=255;R*=255;i*=255;var E={r:S,g:R,b:i,hex:aT.rgb(S,R,i),toString:z};aT.is(bN,"finite")&&(E.opacity=bN);return E};aT.color=function(b){var g;if(aT.is(b,"object")&&"h" in b&&"s" in b&&"b" in b){g=aT.hsb2rgb(b);b.r=g.r;b.g=g.g;b.b=g.b;b.hex=g.hex}else{if(aT.is(b,"object")&&"h" in b&&"s" in b&&"l" in b){g=aT.hsl2rgb(b);b.r=g.r;b.g=g.g;b.b=g.b;b.hex=g.hex}else{if(aT.is(b,"string")){b=aT.getRGB(b)}if(aT.is(b,"object")&&"r" in b&&"g" in b&&"b" in b){g=aT.rgb2hsl(b);b.h=g.h;b.s=g.s;b.l=g.l;g=aT.rgb2hsb(b);b.v=g.b}else{b={hex:"none"};b.r=b.g=b.b=b.h=b.s=b.v=b.l=-1}}}b.toString=z;return b};aT.hsb2rgb=function(bN,bQ,bO,E){if(this.is(bN,"object")&&"h" in bN&&"s" in bN&&"b" in bN){bO=bN.b;bQ=bN.s;bN=bN.h;E=bN.o}bN*=360;var S,bP,g,i,b;bN=(bN%360)/60;b=bO*bQ;i=b*(1-ay(bN%2-1));S=bP=g=bO-b;bN=~~bN;S+=[b,i,0,0,i,b][bN];bP+=[i,b,b,i,0,0][bN];g+=[0,0,i,b,b,i][bN];return a4(S,bP,g,E)};aT.hsl2rgb=function(bO,bQ,S,E){if(this.is(bO,"object")&&"h" in bO&&"s" in bO&&"l" in bO){S=bO.l;bQ=bO.s;bO=bO.h}if(bO>1||bQ>1||S>1){bO/=360;bQ/=100;S/=100}bO*=360;var bN,bP,g,i,b;bO=(bO%360)/60;b=2*bQ*(S<0.5?S:1-S);i=b*(1-ay(bO%2-1));bN=bP=g=S-b/2;bO=~~bO;bN+=[b,i,0,0,i,b][bO];bP+=[i,b,b,i,0,0][bO];g+=[0,0,i,b,b,i][bO];return a4(bN,bP,g,E)};aT.rgb2hsb=function(bP,bO,i){i=a0(bP,bO,i);bP=i[0];bO=i[1];i=i[2];var bN,R,E,bQ;E=o(bP,bO,i);bQ=E-bo(bP,bO,i);bN=(bQ==0?null:E==bP?(bO-i)/bQ:E==bO?(i-bP)/bQ+2:(bP-bO)/bQ+4);bN=((bN+360)%6)*60/360;R=bQ==0?0:bQ/E;return{h:bN,s:R,b:E,toString:aK}};aT.rgb2hsl=function(i,bO,bR){bR=a0(i,bO,bR);i=bR[0];bO=bR[1];bR=bR[2];var bS,bN,bQ,bP,R,E;bP=o(i,bO,bR);R=bo(i,bO,bR);E=bP-R;bS=(E==0?null:bP==i?(bO-bR)/E:bP==bO?(bR-i)/E+2:(i-bO)/E+4);bS=((bS+360)%6)*60/360;bQ=(bP+R)/2;bN=(E==0?0:bQ<0.5?E/(2*bQ):E/(2-2*bQ));return{h:bS,s:bN,l:bQ,toString:O}};aT._path2string=function(){return this.join(",").replace(bi,"$1")};function bm(R,E){for(var b=0,g=R.length;b<g;b++){if(R[b]===E){return R.push(R.splice(b,1)[0])}}}function aI(E,g,b){function i(){var R=Array.prototype.slice.call(arguments,0),bN=R.join("\u2400"),S=i.cache=i.cache||{},bO=i.count=i.count||[];if(S[am](bN)){bm(bO,bN);return b?b(S[bN]):S[bN]}bO.length>=1000&&delete S[bO.shift()];bO.push(bN);S[bN]=E[bI](g,R);return b?b(S[bN]):S[bN]}return i}var bx=aT._preload=function(i,g){var b=aC.doc.createElement("img");b.style.cssText="position:absolute;left:-9999em;top:-9999em";b.onload=function(){g.call(this);this.onload=null;aC.doc.body.removeChild(this)};b.onerror=function(){aC.doc.body.removeChild(this)};aC.doc.body.appendChild(b);b.src=i};function at(){return this.hex}aT.getRGB=aI(function(b){if(!b||!!((b=bJ(b)).indexOf("-")+1)){return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:at}}if(b=="none"){return{r:-1,g:-1,b:-1,hex:"none",toString:at}}!(p[am](b.toLowerCase().substring(0,2))||b.charAt()=="#")&&(b=bh(b));var R,g,i,bN,E,bP,bO,S=b.match(C);if(S){if(S[2]){bN=W(S[2].substring(5),16);i=W(S[2].substring(3,5),16);g=W(S[2].substring(1,3),16)}if(S[3]){bN=W((bP=S[3].charAt(3))+bP,16);i=W((bP=S[3].charAt(2))+bP,16);g=W((bP=S[3].charAt(1))+bP,16)}if(S[4]){bO=S[4][H](bk);g=ap(bO[0]);bO[0].slice(-1)=="%"&&(g*=2.55);i=ap(bO[1]);bO[1].slice(-1)=="%"&&(i*=2.55);bN=ap(bO[2]);bO[2].slice(-1)=="%"&&(bN*=2.55);S[1].toLowerCase().slice(0,4)=="rgba"&&(E=ap(bO[3]));bO[3]&&bO[3].slice(-1)=="%"&&(E/=100)}if(S[5]){bO=S[5][H](bk);g=ap(bO[0]);bO[0].slice(-1)=="%"&&(g*=2.55);i=ap(bO[1]);bO[1].slice(-1)=="%"&&(i*=2.55);bN=ap(bO[2]);bO[2].slice(-1)=="%"&&(bN*=2.55);(bO[0].slice(-3)=="deg"||bO[0].slice(-1)=="\xb0")&&(g/=360);S[1].toLowerCase().slice(0,4)=="hsba"&&(E=ap(bO[3]));bO[3]&&bO[3].slice(-1)=="%"&&(E/=100);return aT.hsb2rgb(g,i,bN,E)}if(S[6]){bO=S[6][H](bk);g=ap(bO[0]);bO[0].slice(-1)=="%"&&(g*=2.55);i=ap(bO[1]);bO[1].slice(-1)=="%"&&(i*=2.55);bN=ap(bO[2]);bO[2].slice(-1)=="%"&&(bN*=2.55);(bO[0].slice(-3)=="deg"||bO[0].slice(-1)=="\xb0")&&(g/=360);S[1].toLowerCase().slice(0,4)=="hsla"&&(E=ap(bO[3]));bO[3]&&bO[3].slice(-1)=="%"&&(E/=100);return aT.hsl2rgb(g,i,bN,E)}S={r:g,g:i,b:bN,toString:at};S.hex="#"+(16777216|bN|(i<<8)|(g<<16)).toString(16).slice(1);aT.is(E,"finite")&&(S.opacity=E);return S}return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:at}},aT);aT.hsb=aI(function(E,i,g){return aT.hsb2rgb(E,i,g).hex});aT.hsl=aI(function(i,g,b){return aT.hsl2rgb(i,g,b).hex});aT.rgb=aI(function(R,E,i){return"#"+(16777216|i|(E<<8)|(R<<16)).toString(16).slice(1)});aT.getColor=function(g){var i=this.getColor.start=this.getColor.start||{h:0,s:1,b:g||0.75},b=this.hsb2rgb(i.h,i.s,i.b);i.h+=0.075;if(i.h>1){i.h=0;i.s-=0.2;i.s<=0&&(this.getColor.start={h:0,s:1,b:i.b})}return b.hex};aT.getColor.reset=function(){delete this.start};function bd(E,bN){var S=[];for(var g=0,b=E.length;b-2*!bN>g;g+=2){var R=[{x:+E[g-2],y:+E[g-1]},{x:+E[g],y:+E[g+1]},{x:+E[g+2],y:+E[g+3]},{x:+E[g+4],y:+E[g+5]}];if(bN){if(!g){R[0]={x:+E[b-2],y:+E[b-1]}}else{if(b-4==g){R[3]={x:+E[0],y:+E[1]}}else{if(b-2==g){R[2]={x:+E[0],y:+E[1]};R[3]={x:+E[2],y:+E[3]}}}}}else{if(b-4==g){R[3]=R[2]}else{if(!g){R[0]={x:+E[g],y:+E[g+1]}}}}S.push(["C",(-R[0].x+6*R[1].x+R[2].x)/6,(-R[0].y+6*R[1].y+R[2].y)/6,(R[1].x+6*R[2].x-R[3].x)/6,(R[1].y+6*R[2].y-R[3].y)/6,R[2].x,R[2].y])}return S}aT.parsePathString=function(b){if(!b){return null}var i=aa(b);if(i.arr){return a1(i.arr)}var E={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},g=[];if(aT.is(b,bf)&&aT.is(b[0],bf)){g=a1(b)}if(!g.length){bJ(b).replace(a2,function(S,R,bP){var bO=[],bN=R.toLowerCase();bP.replace(aR,function(bR,bQ){bQ&&bO.push(+bQ)});if(bN=="m"&&bO.length>2){g.push([R][bG](bO.splice(0,2)));bN="l";R=R=="m"?"l":"L"}if(bN=="r"){g.push([R][bG](bO))}else{while(bO.length>=E[bN]){g.push([R][bG](bO.splice(0,E[bN])));if(!E[bN]){break}}}})}g.toString=aT._path2string;i.arr=a1(g);return g};aT.parseTransformString=aI(function(g){if(!g){return null}var i={r:3,s:4,t:2,m:6},b=[];if(aT.is(g,bf)&&aT.is(g[0],bf)){b=a1(g)}if(!b.length){bJ(g).replace(ak,function(R,E,bO){var bN=[],S=bM.call(E);bO.replace(aR,function(bQ,bP){bP&&bN.push(+bP)});b.push([E][bG](bN))})}b.toString=aT._path2string;return b});var aa=function(g){var b=aa.ps=aa.ps||{};if(b[g]){b[g].sleep=100}else{b[g]={sleep:100}}setTimeout(function(){for(var i in b){if(b[am](i)&&i!=g){b[i].sleep--;!b[i].sleep&&delete b[i]}}});return b[g]};aT.findDotsAtSegment=function(g,b,b5,b3,bN,R,bQ,bO,bY){var bV=1-bY,b0=br(bV,3),b1=br(bV,2),bS=bY*bY,bP=bS*bY,bU=b0*g+b1*3*bY*b5+bV*3*bY*bY*bN+bP*bQ,bR=b0*b+b1*3*bY*b3+bV*3*bY*bY*R+bP*bO,bZ=g+2*bY*(b5-g)+bS*(bN-2*b5+g),bX=b+2*bY*(b3-b)+bS*(R-2*b3+b),b4=b5+2*bY*(bN-b5)+bS*(bQ-2*bN+b5),b2=b3+2*bY*(R-b3)+bS*(bO-2*R+b3),bW=bV*g+bY*b5,bT=bV*b+bY*b3,E=bV*bN+bY*bQ,i=bV*R+bY*bO,S=(90-aw.atan2(bZ-b4,bX-b2)*180/aX);(bZ>b4||bX<b2)&&(S+=180);return{x:bU,y:bR,m:{x:bZ,y:bX},n:{x:b4,y:b2},start:{x:bW,y:bT},end:{x:E,y:i},alpha:S}};aT.bezierBBox=function(g,b,E,i,bP,bN,S,R){if(!aT.is(g,"array")){g=[g,b,E,i,bP,bN,S,R]}var bO=bc.apply(null,g);return{x:bO.min.x,y:bO.min.y,x2:bO.max.x,y2:bO.max.y,width:bO.max.x-bO.min.x,height:bO.max.y-bO.min.y}};aT.isPointInsideBBox=function(g,b,i){return b>=g.x&&b<=g.x2&&i>=g.y&&i<=g.y2};aT.isBBoxIntersect=function(E,g){var b=aT.isPointInsideBBox;return b(g,E.x,E.y)||b(g,E.x2,E.y)||b(g,E.x,E.y2)||b(g,E.x2,E.y2)||b(E,g.x,g.y)||b(E,g.x2,g.y)||b(E,g.x,g.y2)||b(E,g.x2,g.y2)||(E.x<g.x2&&E.x>g.x||g.x<E.x2&&g.x>E.x)&&(E.y<g.y2&&E.y>g.y||g.y<E.y2&&g.y>E.y)};function bl(b,bN,S,R,E){var i=-3*bN+9*S-9*R+3*E,g=b*i+6*bN-12*S+6*R;return b*g-3*bN+3*S}function s(bZ,S,bY,E,bX,g,bU,b,bR){if(bR==null){bR=1}bR=bR>1?1:bR<0?0:bR;var bS=bR/2,bT=12,bO=[-0.1252,0.1252,-0.3678,0.3678,-0.5873,0.5873,-0.7699,0.7699,-0.9041,0.9041,-0.9816,0.9816],bW=[0.2491,0.2491,0.2335,0.2335,0.2032,0.2032,0.1601,0.1601,0.1069,0.1069,0.0472,0.0472],R=0;for(var bV=0;bV<bT;bV++){var bP=bS*bO[bV]+bS,bQ=bl(bP,bZ,bY,bX,bU),b0=bl(bP,S,E,g,b),bN=bQ*bQ+b0*b0;R+=bW[bV]*aw.sqrt(bN)}return bS*R}function F(i,bS,g,bR,b,bP,bU,bO,bQ){if(bQ<0||s(i,bS,g,bR,b,bP,bU,bO)<bQ){return}var bT=1,E=bT/2,S=bT-E,R,bN=0.01;R=s(i,bS,g,bR,b,bP,bU,bO,S);while(ay(R-bQ)>bN){E/=2;S+=(R<bQ?1:-1)*E;R=s(i,bS,g,bR,b,bP,bU,bO,S)}return S}function Q(E,bT,i,bR,b,bQ,bV,bP){if(o(E,i)<bo(b,bV)||bo(E,i)>o(b,bV)||o(bT,bR)<bo(bQ,bP)||bo(bT,bR)>o(bQ,bP)){return}var bO=(E*bR-bT*i)*(b-bV)-(E-i)*(b*bP-bQ*bV),bN=(E*bR-bT*i)*(bQ-bP)-(bT-bR)*(b*bP-bQ*bV),R=(E-i)*(bQ-bP)-(bT-bR)*(b-bV);if(!R){return}var bU=bO/R,bS=bN/R,S=+bU.toFixed(2),g=+bS.toFixed(2);if(S<+bo(E,i).toFixed(2)||S>+o(E,i).toFixed(2)||S<+bo(b,bV).toFixed(2)||S>+o(b,bV).toFixed(2)||g<+bo(bT,bR).toFixed(2)||g>+o(bT,bR).toFixed(2)||g<+bo(bQ,bP).toFixed(2)||g>+o(bQ,bP).toFixed(2)){return}return{x:bU,y:bS}}function aA(g,b){return ah(g,b)}function v(g,b){return ah(g,b,1)}function ah(b5,b4,b3){var R=aT.bezierBBox(b5),g=aT.bezierBBox(b4);if(!aT.isBBoxIntersect(R,g)){return b3?0:[]}var bY=s.apply(0,b5),bX=s.apply(0,b4),bP=~~(bY/5),bO=~~(bX/5),bV=[],bU=[],E={},b6=b3?0:[];for(var b0=0;b0<bP+1;b0++){var bW=aT.findDotsAtSegment.apply(aT,b5.concat(b0/bP));bV.push({x:bW.x,y:bW.y,t:b0/bP})}for(b0=0;b0<bO+1;b0++){bW=aT.findDotsAtSegment.apply(aT,b4.concat(b0/bO));bU.push({x:bW.x,y:bW.y,t:b0/bO})}for(b0=0;b0<bP;b0++){for(var bZ=0;bZ<bO;bZ++){var b2=bV[b0],b=bV[b0+1],b1=bU[bZ],bN=bU[bZ+1],bT=ay(b.x-b2.x)<0.001?"y":"x",bS=ay(bN.x-b1.x)<0.001?"y":"x",S=Q(b2.x,b2.y,b.x,b.y,b1.x,b1.y,bN.x,bN.y);if(S){if(E[S.x.toFixed(4)]==S.y.toFixed(4)){continue}E[S.x.toFixed(4)]=S.y.toFixed(4);var bR=b2.t+ay((S[bT]-b2[bT])/(b[bT]-b2[bT]))*(b.t-b2.t),bQ=b1.t+ay((S[bS]-b1[bS])/(bN[bS]-b1[bS]))*(bN.t-b1.t);if(bR>=0&&bR<=1&&bQ>=0&&bQ<=1){if(b3){b6++}else{b6.push({x:S.x,y:S.y,t1:bR,t2:bQ})}}}}}return b6}aT.pathIntersection=function(g,b){return G(g,b)};aT.pathIntersectionNumber=function(g,b){return G(g,b,1)};function G(E,b,bZ){E=aT._path2curve(E);b=aT._path2curve(b);var bX,bN,bW,R,bU,bO,g,bR,b3,b2,b4=bZ?0:[];for(var bV=0,bP=E.length;bV<bP;bV++){var b1=E[bV];if(b1[0]=="M"){bX=bU=b1[1];bN=bO=b1[2]}else{if(b1[0]=="C"){b3=[bX,bN].concat(b1.slice(1));bX=b3[6];bN=b3[7]}else{b3=[bX,bN,bX,bN,bU,bO,bU,bO];bX=bU;bN=bO}for(var bT=0,bY=b.length;bT<bY;bT++){var b0=b[bT];if(b0[0]=="M"){bW=g=b0[1];R=bR=b0[2]}else{if(b0[0]=="C"){b2=[bW,R].concat(b0.slice(1));bW=b2[6];R=b2[7]}else{b2=[bW,R,bW,R,g,bR,g,bR];bW=g;R=bR}var bQ=ah(b3,b2,bZ);if(bZ){b4+=bQ}else{for(var bS=0,S=bQ.length;bS<S;bS++){bQ[bS].segment1=bV;bQ[bS].segment2=bT;bQ[bS].bez1=b3;bQ[bS].bez2=b2}b4=b4.concat(bQ)}}}}}return b4}aT.isPointInsidePath=function(g,b,E){var i=aT.pathBBox(g);return aT.isPointInsideBBox(i,b,E)&&G(g,[["M",b,E],["H",i.x2+10]],1)%2==1};aT._removedFactory=function(b){return function(){eve("raphael.log",null,"Rapha\xebl: you are calling to method \u201c"+b+"\u201d of removed object",b)}};var ao=aT.pathBBox=function(bW){var bQ=aa(bW);if(bQ.bbox){return Z(bQ.bbox)}if(!bW){return{x:0,y:0,width:0,height:0,x2:0,y2:0}}bW=Y(bW);var bT=0,bS=0,S=[],g=[],E;for(var bO=0,bV=bW.length;bO<bV;bO++){E=bW[bO];if(E[0]=="M"){bT=E[1];bS=E[2];S.push(bT);g.push(bS)}else{var bP=bc(bT,bS,E[1],E[2],E[3],E[4],E[5],E[6]);S=S[bG](bP.min.x,bP.max.x);g=g[bG](bP.min.y,bP.max.y);bT=E[5];bS=E[6]}}var b=bo[bI](0,S),bU=bo[bI](0,g),bN=o[bI](0,S),R=o[bI](0,g),bR={x:b,y:bU,x2:bN,y2:R,width:bN-b,height:R-bU};bQ.bbox=Z(bR);return bR},a1=function(g){var b=Z(g);b.toString=aT._path2string;return b},aE=aT._pathToRelative=function(R){var bP=aa(R);if(bP.rel){return a1(bP.rel)}if(!aT.is(R,bf)||!aT.is(R&&R[0],bf)){R=aT.parsePathString(R)}var bS=[],bU=0,bT=0,bX=0,bW=0,E=0;if(R[0][0]=="M"){bU=R[0][1];bT=R[0][2];bX=bU;bW=bT;E++;bS.push(["M",bU,bT])}for(var bO=E,bY=R.length;bO<bY;bO++){var b=bS[bO]=[],bV=R[bO];if(bV[0]!=bM.call(bV[0])){b[0]=bM.call(bV[0]);switch(b[0]){case"a":b[1]=bV[1];b[2]=bV[2];b[3]=bV[3];b[4]=bV[4];b[5]=bV[5];b[6]=+(bV[6]-bU).toFixed(3);b[7]=+(bV[7]-bT).toFixed(3);break;case"v":b[1]=+(bV[1]-bT).toFixed(3);break;case"m":bX=bV[1];bW=bV[2];default:for(var bN=1,bQ=bV.length;bN<bQ;bN++){b[bN]=+(bV[bN]-((bN%2)?bU:bT)).toFixed(3)}}}else{b=bS[bO]=[];if(bV[0]=="m"){bX=bV[1]+bU;bW=bV[2]+bT}for(var S=0,g=bV.length;S<g;S++){bS[bO][S]=bV[S]}}var bR=bS[bO].length;switch(bS[bO][0]){case"z":bU=bX;bT=bW;break;case"h":bU+=+bS[bO][bR-1];break;case"v":bT+=+bS[bO][bR-1];break;default:bU+=+bS[bO][bR-2];bT+=+bS[bO][bR-1]}}bS.toString=aT._path2string;bP.rel=a1(bS);return bS},y=aT._pathToAbsolute=function(bT){var E=aa(bT);if(E.abs){return a1(E.abs)}if(!aT.is(bT,bf)||!aT.is(bT&&bT[0],bf)){bT=aT.parsePathString(bT)}if(!bT||!bT.length){return[["M",0,0]]}var bZ=[],bO=0,bN=0,bR=0,bQ=0,R=0;if(bT[0][0]=="M"){bO=+bT[0][1];bN=+bT[0][2];bR=bO;bQ=bN;R++;bZ[0]=["M",bO,bN]}var bY=bT.length==3&&bT[0][0]=="M"&&bT[1][0].toUpperCase()=="R"&&bT[2][0].toUpperCase()=="Z";for(var bS,b,bW=R,bP=bT.length;bW<bP;bW++){bZ.push(bS=[]);b=bT[bW];if(b[0]!=bv.call(b[0])){bS[0]=bv.call(b[0]);switch(bS[0]){case"A":bS[1]=b[1];bS[2]=b[2];bS[3]=b[3];bS[4]=b[4];bS[5]=b[5];bS[6]=+(b[6]+bO);bS[7]=+(b[7]+bN);break;case"V":bS[1]=+b[1]+bN;break;case"H":bS[1]=+b[1]+bO;break;case"R":var S=[bO,bN][bG](b.slice(1));for(var bV=2,bX=S.length;bV<bX;bV++){S[bV]=+S[bV]+bO;S[++bV]=+S[bV]+bN}bZ.pop();bZ=bZ[bG](bd(S,bY));break;case"M":bR=+b[1]+bO;bQ=+b[2]+bN;default:for(bV=1,bX=b.length;bV<bX;bV++){bS[bV]=+b[bV]+((bV%2)?bO:bN)}}}else{if(b[0]=="R"){S=[bO,bN][bG](b.slice(1));bZ.pop();bZ=bZ[bG](bd(S,bY));bS=["R"][bG](b.slice(-2))}else{for(var bU=0,g=b.length;bU<g;bU++){bS[bU]=b[bU]}}}switch(bS[0]){case"Z":bO=bR;bN=bQ;break;case"H":bO=bS[1];break;case"V":bN=bS[1];break;case"M":bR=bS[bS.length-2];bQ=bS[bS.length-1];default:bO=bS[bS.length-2];bN=bS[bS.length-1]}}bZ.toString=aT._path2string;E.abs=a1(bZ);return bZ},bK=function(g,E,b,i){return[g,E,b,i,b,i]},bp=function(g,E,bN,R,b,i){var S=1/3,bO=2/3;return[S*g+bO*bN,S*E+bO*R,S*b+bO*bN,S*i+bO*R,b,i]},ag=function(bV,cq,b4,b2,bW,bQ,R,bU,cp,bX){var b1=aX*120/180,b=aX/180*(+bW||0),b8=[],b5,cm=aI(function(cr,cu,i){var ct=cr*aw.cos(i)-cu*aw.sin(i),cs=cr*aw.sin(i)+cu*aw.cos(i);return{x:ct,y:cs}});if(!bX){b5=cm(bV,cq,-b);bV=b5.x;cq=b5.y;b5=cm(bU,cp,-b);bU=b5.x;cp=b5.y;var g=aw.cos(aX/180*bW),bS=aw.sin(aX/180*bW),ca=(bV-bU)/2,b9=(cq-cp)/2;var ck=(ca*ca)/(b4*b4)+(b9*b9)/(b2*b2);if(ck>1){ck=aw.sqrt(ck);b4=ck*b4;b2=ck*b2}var E=b4*b4,cd=b2*b2,cf=(bQ==R?-1:1)*aw.sqrt(ay((E*cd-E*b9*b9-cd*ca*ca)/(E*b9*b9+cd*ca*ca))),bZ=cf*b4*b9/b2+(bV+bU)/2,bY=cf*-b2*ca/b4+(cq+cp)/2,bP=aw.asin(((cq-bY)/b2).toFixed(9)),bO=aw.asin(((cp-bY)/b2).toFixed(9));bP=bV<bZ?aX-bP:bP;bO=bU<bZ?aX-bO:bO;bP<0&&(bP=aX*2+bP);bO<0&&(bO=aX*2+bO);if(R&&bP>bO){bP=bP-aX*2}if(!R&&bO>bP){bO=bO-aX*2}}else{bP=bX[0];bO=bX[1];bZ=bX[2];bY=bX[3]}var bT=bO-bP;if(ay(bT)>b1){var b0=bO,b3=bU,bR=cp;bO=bP+b1*(R&&bO>bP?1:-1);bU=bZ+b4*aw.cos(bO);cp=bY+b2*aw.sin(bO);b8=ag(bU,cp,b4,b2,bW,0,R,b3,bR,[bO,b0,bZ,bY])}bT=bO-bP;var bN=aw.cos(bP),co=aw.sin(bP),S=aw.cos(bO),cn=aw.sin(bO),cb=aw.tan(bT/4),ce=4/3*b4*cb,cc=4/3*b2*cb,cl=[bV,cq],cj=[bV+ce*co,cq-cc*bN],ci=[bU+ce*cn,cp-cc*S],cg=[bU,cp];cj[0]=2*cl[0]-cj[0];cj[1]=2*cl[1]-cj[1];if(bX){return[cj,ci,cg][bG](b8)}else{b8=[cj,ci,cg][bG](b8).join()[H](",");var b6=[];for(var ch=0,b7=b8.length;ch<b7;ch++){b6[ch]=ch%2?cm(b8[ch-1],b8[ch],b).y:cm(b8[ch],b8[ch+1],b).x}return b6}},ai=function(g,b,E,i,bP,bO,bN,S,bQ){var R=1-bQ;return{x:br(R,3)*g+br(R,2)*3*bQ*E+R*3*bQ*bQ*bP+br(bQ,3)*bN,y:br(R,3)*b+br(R,2)*3*bQ*i+R*3*bQ*bQ*bO+br(bQ,3)*S}},bc=aI(function(E,g,S,R,bX,bW,bT,bQ){var bV=(bX-2*S+E)-(bT-2*bX+S),bS=2*(S-E)-2*(bX-S),bP=E-S,bO=(-bS+aw.sqrt(bS*bS-4*bV*bP))/2/bV,bN=(-bS-aw.sqrt(bS*bS-4*bV*bP))/2/bV,bR=[g,bQ],bU=[E,bT],i;ay(bO)>"1e12"&&(bO=0.5);ay(bN)>"1e12"&&(bN=0.5);if(bO>0&&bO<1){i=ai(E,g,S,R,bX,bW,bT,bQ,bO);bU.push(i.x);bR.push(i.y)}if(bN>0&&bN<1){i=ai(E,g,S,R,bX,bW,bT,bQ,bN);bU.push(i.x);bR.push(i.y)}bV=(bW-2*R+g)-(bQ-2*bW+R);bS=2*(R-g)-2*(bW-R);bP=g-R;bO=(-bS+aw.sqrt(bS*bS-4*bV*bP))/2/bV;bN=(-bS-aw.sqrt(bS*bS-4*bV*bP))/2/bV;ay(bO)>"1e12"&&(bO=0.5);ay(bN)>"1e12"&&(bN=0.5);if(bO>0&&bO<1){i=ai(E,g,S,R,bX,bW,bT,bQ,bO);bU.push(i.x);bR.push(i.y)}if(bN>0&&bN<1){i=ai(E,g,S,R,bX,bW,bT,bQ,bN);bU.push(i.x);bR.push(i.y)}return{min:{x:bo[bI](0,bU),y:bo[bI](0,bR)},max:{x:o[bI](0,bU),y:o[bI](0,bR)}}}),Y=aT._path2curve=aI(function(bX,bS){var bQ=!bS&&aa(bX);if(!bS&&bQ.curve){return a1(bQ.curve)}var R=y(bX),bT=bS&&y(bS),bU={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},g={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},bN=function(bY,bZ){var i,b0;if(!bY){return["C",bZ.x,bZ.y,bZ.x,bZ.y,bZ.x,bZ.y]}!(bY[0] in {T:1,Q:1})&&(bZ.qx=bZ.qy=null);switch(bY[0]){case"M":bZ.X=bY[1];bZ.Y=bY[2];break;case"A":bY=["C"][bG](ag[bI](0,[bZ.x,bZ.y][bG](bY.slice(1))));break;case"S":i=bZ.x+(bZ.x-(bZ.bx||bZ.x));b0=bZ.y+(bZ.y-(bZ.by||bZ.y));bY=["C",i,b0][bG](bY.slice(1));break;case"T":bZ.qx=bZ.x+(bZ.x-(bZ.qx||bZ.x));bZ.qy=bZ.y+(bZ.y-(bZ.qy||bZ.y));bY=["C"][bG](bp(bZ.x,bZ.y,bZ.qx,bZ.qy,bY[1],bY[2]));break;case"Q":bZ.qx=bY[1];bZ.qy=bY[2];bY=["C"][bG](bp(bZ.x,bZ.y,bY[1],bY[2],bY[3],bY[4]));break;case"L":bY=["C"][bG](bK(bZ.x,bZ.y,bY[1],bY[2]));break;case"H":bY=["C"][bG](bK(bZ.x,bZ.y,bY[1],bZ.y));break;case"V":bY=["C"][bG](bK(bZ.x,bZ.y,bZ.x,bY[1]));break;case"Z":bY=["C"][bG](bK(bZ.x,bZ.y,bZ.X,bZ.Y));break}return bY},b=function(bY,bZ){if(bY[bZ].length>7){bY[bZ].shift();var b0=bY[bZ];while(b0.length){bY.splice(bZ++,0,["C"][bG](b0.splice(0,6)))}bY.splice(bZ,1);bV=o(R.length,bT&&bT.length||0)}},E=function(b2,b1,bZ,bY,b0){if(b2&&b1&&b2[b0][0]=="M"&&b1[b0][0]!="M"){b1.splice(b0,0,["M",bY.x,bY.y]);bZ.bx=0;bZ.by=0;bZ.x=b2[b0][1];bZ.y=b2[b0][2];bV=o(R.length,bT&&bT.length||0)}};for(var bP=0,bV=o(R.length,bT&&bT.length||0);bP<bV;bP++){R[bP]=bN(R[bP],bU);b(R,bP);bT&&(bT[bP]=bN(bT[bP],g));bT&&b(bT,bP);E(R,bT,bU,g,bP);E(bT,R,g,bU,bP);var bO=R[bP],bW=bT&&bT[bP],S=bO.length,bR=bT&&bW.length;bU.x=bO[S-2];bU.y=bO[S-1];bU.bx=ap(bO[S-4])||bU.x;bU.by=ap(bO[S-3])||bU.y;g.bx=bT&&(ap(bW[bR-4])||g.x);g.by=bT&&(ap(bW[bR-3])||g.y);g.x=bT&&bW[bR-2];g.y=bT&&bW[bR-1]}if(!bT){bQ.curve=a1(R)}return bT?[R,bT]:R},null,a1),x=aT._parseDots=aI(function(bQ){var bP=[];for(var S=0,bR=bQ.length;S<bR;S++){var b={},bO=bQ[S].match(/^([^:]*):?([\d\.]*)/);b.color=aT.getRGB(bO[1]);if(b.color.error){return null}b.color=b.color.hex;bO[2]&&(b.offset=bO[2]+"%");bP.push(b)}for(S=1,bR=bP.length-1;S<bR;S++){if(!bP[S].offset){var g=ap(bP[S-1].offset||0),E=0;for(var R=S+1;R<bR;R++){if(bP[R].offset){E=bP[R].offset;break}}if(!E){E=100;R=bR}E=ap(E);var bN=(E-g)/(R-S+1);for(;S<R;S++){g+=bN;bP[S].offset=g+"%"}}}return bP}),aM=aT._tear=function(b,g){b==g.top&&(g.top=b.prev);b==g.bottom&&(g.bottom=b.next);b.next&&(b.next.prev=b.prev);b.prev&&(b.prev.next=b.next)},ar=aT._tofront=function(b,g){if(g.top===b){return}aM(b,g);b.next=null;b.prev=g.top;g.top.next=b;g.top=b},r=aT._toback=function(b,g){if(g.bottom===b){return}aM(b,g);b.next=g.bottom;b.prev=null;g.bottom.prev=b;g.bottom=b},I=aT._insertafter=function(g,b,i){aM(g,i);b==i.top&&(i.top=g);b.next&&(b.next.prev=g);g.next=b.next;g.prev=b;b.next=g},aV=aT._insertbefore=function(g,b,i){aM(g,i);b==i.bottom&&(i.bottom=g);b.prev&&(b.prev.next=g);g.prev=b.prev;b.prev=g;g.next=b},bn=aT.toMatrix=function(i,b){var E=ao(i),g={_:{transform:aZ},getBBox:function(){return E}};aQ(g,b);return g.matrix},V=aT.transformPath=function(g,b){return N(g,bn(g,b))},aQ=aT._extractTransform=function(g,b2){if(b2==null){return g._.transform}b2=bJ(b2).replace(/\.{3}|\u2026/g,g._.transform||aZ);var bU=aT.parseTransformString(b2),bS=0,bQ=0,bP=0,bW=1,bV=1,b3=g._,bX=new aH;b3.transform=bU||[];if(bU){for(var bY=0,bR=bU.length;bY<bR;bY++){var bT=bU[bY],b=bT.length,S=bJ(bT[0]).toLowerCase(),b1=bT[0]!=S,bO=b1?bX.invert():0,b0,R,bZ,E,bN;if(S=="t"&&b==3){if(b1){b0=bO.x(0,0);R=bO.y(0,0);bZ=bO.x(bT[1],bT[2]);E=bO.y(bT[1],bT[2]);bX.translate(bZ-b0,E-R)}else{bX.translate(bT[1],bT[2])}}else{if(S=="r"){if(b==2){bN=bN||g.getBBox(1);bX.rotate(bT[1],bN.x+bN.width/2,bN.y+bN.height/2);bS+=bT[1]}else{if(b==4){if(b1){bZ=bO.x(bT[2],bT[3]);E=bO.y(bT[2],bT[3]);bX.rotate(bT[1],bZ,E)}else{bX.rotate(bT[1],bT[2],bT[3])}bS+=bT[1]}}}else{if(S=="s"){if(b==2||b==3){bN=bN||g.getBBox(1);bX.scale(bT[1],bT[b-1],bN.x+bN.width/2,bN.y+bN.height/2);bW*=bT[1];bV*=bT[b-1]}else{if(b==5){if(b1){bZ=bO.x(bT[3],bT[4]);E=bO.y(bT[3],bT[4]);bX.scale(bT[1],bT[2],bZ,E)}else{bX.scale(bT[1],bT[2],bT[3],bT[4])}bW*=bT[1];bV*=bT[2]}}}else{if(S=="m"&&b==7){bX.add(bT[1],bT[2],bT[3],bT[4],bT[5],bT[6])}}}}b3.dirtyT=1;g.matrix=bX}}g.matrix=bX;b3.sx=bW;b3.sy=bV;b3.deg=bS;b3.dx=bQ=bX.e;b3.dy=bP=bX.f;if(bW==1&&bV==1&&!bS&&b3.bbox){b3.bbox.x+=+bQ;b3.bbox.y+=+bP}else{b3.dirtyT=1}},n=function(g){var b=g[0];switch(b.toLowerCase()){case"t":return[b,0,0];case"m":return[b,1,0,0,1,0,0];case"r":if(g.length==4){return[b,0,g[2],g[3]]}else{return[b,0]}case"s":if(g.length==5){return[b,1,1,g[3],g[4]]}else{if(g.length==3){return[b,1,1]}else{return[b,1]}}}},aD=aT._equaliseTransform=function(S,R){R=bJ(R).replace(/\.{3}|\u2026/g,S);S=aT.parseTransformString(S)||[];R=aT.parseTransformString(R)||[];var b=o(S.length,R.length),bQ=[],bR=[],E=0,g,bN,bP,bO;for(;E<b;E++){bP=S[E]||n(R[E]);bO=R[E]||n(bP);if((bP[0]!=bO[0])||(bP[0].toLowerCase()=="r"&&(bP[2]!=bO[2]||bP[3]!=bO[3]))||(bP[0].toLowerCase()=="s"&&(bP[3]!=bO[3]||bP[4]!=bO[4]))){return}bQ[E]=[];bR[E]=[];for(g=0,bN=o(bP.length,bO.length);g<bN;g++){g in bP&&(bQ[E][g]=bP[g]);g in bO&&(bR[E][g]=bO[g])}}return{from:bQ,to:bR}};aT._getContainer=function(b,R,i,E){var g;g=E==null&&!aT.is(b,"object")?aC.doc.getElementById(b):b;if(g==null){return}if(g.tagName){if(R==null){return{container:g,width:g.style.pixelWidth||g.offsetWidth,height:g.style.pixelHeight||g.offsetHeight}}else{return{container:g,width:R,height:i}}}return{container:1,x:b,y:R,width:i,height:E}};aT.pathToRelative=aE;aT._engine={};aT.path2curve=Y;aT.matrix=function(i,g,bN,S,R,E){return new aH(i,g,bN,S,R,E)};function aH(i,g,bN,S,R,E){if(i!=null){this.a=+i;this.b=+g;this.c=+bN;this.d=+S;this.e=+R;this.f=+E}else{this.a=1;this.b=0;this.c=0;this.d=1;this.e=0;this.f=0}}(function(i){i.add=function(bW,bT,bR,bP,bN,S){var R=[[],[],[]],E=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],bV=[[bW,bR,bN],[bT,bP,S],[0,0,1]],bU,bS,bQ,bO;if(bW&&bW instanceof aH){bV=[[bW.a,bW.c,bW.e],[bW.b,bW.d,bW.f],[0,0,1]]}for(bU=0;bU<3;bU++){for(bS=0;bS<3;bS++){bO=0;for(bQ=0;bQ<3;bQ++){bO+=E[bU][bQ]*bV[bQ][bS]}R[bU][bS]=bO}}this.a=R[0][0];this.b=R[1][0];this.c=R[0][1];this.d=R[1][1];this.e=R[0][2];this.f=R[1][2]};i.invert=function(){var R=this,E=R.a*R.d-R.b*R.c;return new aH(R.d/E,-R.b/E,-R.c/E,R.a/E,(R.c*R.f-R.d*R.e)/E,(R.b*R.e-R.a*R.f)/E)};i.clone=function(){return new aH(this.a,this.b,this.c,this.d,this.e,this.f)};i.translate=function(E,R){this.add(1,0,0,1,E,R)};i.scale=function(R,bN,E,S){bN==null&&(bN=R);(E||S)&&this.add(1,0,0,1,E,S);this.add(R,0,0,bN,0,0);(E||S)&&this.add(1,0,0,1,-E,-S)};i.rotate=function(R,E,bO){R=aT.rad(R);E=E||0;bO=bO||0;var bN=+aw.cos(R).toFixed(9),S=+aw.sin(R).toFixed(9);this.add(bN,S,-S,bN,E,bO);this.add(1,0,0,1,-E,-bO)};i.x=function(E,R){return E*this.a+R*this.c+this.e};i.y=function(E,R){return E*this.b+R*this.d+this.f};i.get=function(E){return +this[bJ.fromCharCode(97+E)].toFixed(4)};i.toString=function(){return aT.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()};i.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"};i.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]};function g(E){return E[0]*E[0]+E[1]*E[1]}function b(E){var R=aw.sqrt(g(E));E[0]&&(E[0]/=R);E[1]&&(E[1]/=R)}i.split=function(){var R={};R.dx=this.e;R.dy=this.f;var bN=[[this.a,this.c],[this.b,this.d]];R.scalex=aw.sqrt(g(bN[0]));b(bN[0]);R.shear=bN[0][0]*bN[1][0]+bN[0][1]*bN[1][1];bN[1]=[bN[1][0]-bN[0][0]*R.shear,bN[1][1]-bN[0][1]*R.shear];R.scaley=aw.sqrt(g(bN[1]));b(bN[1]);R.shear/=R.scaley;var E=-bN[0][1],S=bN[1][1];if(S<0){R.rotate=aT.deg(aw.acos(S));if(E<0){R.rotate=360-R.rotate}}else{R.rotate=aT.deg(aw.asin(E))}R.isSimple=!+R.shear.toFixed(9)&&(R.scalex.toFixed(9)==R.scaley.toFixed(9)||!R.rotate);R.isSuperSimple=!+R.shear.toFixed(9)&&R.scalex.toFixed(9)==R.scaley.toFixed(9)&&!R.rotate;R.noRotation=!+R.shear.toFixed(9)&&!R.rotate;return R};i.toTransformString=function(E){var R=E||this[H]();if(R.isSimple){R.scalex=+R.scalex.toFixed(4);R.scaley=+R.scaley.toFixed(4);R.rotate=+R.rotate.toFixed(4);return(R.dx||R.dy?"t"+[R.dx,R.dy]:aZ)+(R.scalex!=1||R.scaley!=1?"s"+[R.scalex,R.scaley,0,0]:aZ)+(R.rotate?"r"+[R.rotate,0,0]:aZ)}else{return"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}})(aH.prototype);var X=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);if((navigator.vendor=="Apple Computer, Inc.")&&(X&&X[1]<4||navigator.platform.slice(0,2)=="iP")||(navigator.vendor=="Google Inc."&&X&&X[1]<8)){a6.safari=function(){var b=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){b.remove()})}}else{a6.safari=K}var T=function(){this.returnValue=false},bF=function(){return this.originalEvent.preventDefault()},ba=function(){this.cancelBubble=true},aL=function(){return this.originalEvent.stopPropagation()},aF=(function(){if(aC.doc.addEventListener){return function(S,E,i,g){var b=ab&&bz[E]?bz[E]:E,R=function(bS){var bR=aC.doc.documentElement.scrollTop||aC.doc.body.scrollTop,bT=aC.doc.documentElement.scrollLeft||aC.doc.body.scrollLeft,bN=bS.clientX+bT,bU=bS.clientY+bR;if(ab&&bz[am](E)){for(var bP=0,bQ=bS.targetTouches&&bS.targetTouches.length;bP<bQ;bP++){if(bS.targetTouches[bP].target==S){var bO=bS;bS=bS.targetTouches[bP];bS.originalEvent=bO;bS.preventDefault=bF;bS.stopPropagation=aL;break}}}return i.call(g,bS,bN,bU)};S.addEventListener(b,R,false);return function(){S.removeEventListener(b,R,false);return true}}}else{if(aC.doc.attachEvent){return function(S,E,i,g){var R=function(bP){bP=bP||aC.win.event;var bO=aC.doc.documentElement.scrollTop||aC.doc.body.scrollTop,bQ=aC.doc.documentElement.scrollLeft||aC.doc.body.scrollLeft,bN=bP.clientX+bQ,bR=bP.clientY+bO;bP.preventDefault=bP.preventDefault||T;bP.stopPropagation=bP.stopPropagation||ba;return i.call(g,bP,bN,bR)};S.attachEvent("on"+E,R);var b=function(){S.detachEvent("on"+E,R);return true};return b}}}})(),bg=[],bA=function(bP){var bS=bP.clientX,bR=bP.clientY,bU=aC.doc.documentElement.scrollTop||aC.doc.body.scrollTop,bV=aC.doc.documentElement.scrollLeft||aC.doc.body.scrollLeft,E,R=bg.length;while(R--){E=bg[R];if(ab){var bN=bP.touches.length,S;while(bN--){S=bP.touches[bN];if(S.identifier==E.el._drag.id){bS=S.clientX;bR=S.clientY;(bP.originalEvent?bP.originalEvent:bP).preventDefault();break}}}else{bP.preventDefault()}var g=E.el.node,b,bO=g.nextSibling,bT=g.parentNode,bQ=g.style.display;aC.win.opera&&bT.removeChild(g);g.style.display="none";b=E.el.paper.getElementByPoint(bS,bR);g.style.display=bQ;aC.win.opera&&(bO?bT.insertBefore(g,bO):bT.appendChild(g));b&&eve("raphael.drag.over."+E.el.id,E.el,b);bS+=bV;bR+=bU;eve("raphael.drag.move."+E.el.id,E.move_scope||E.el,bS-E.el._drag.x,bR-E.el._drag.y,bS,bR,bP)}},e=function(E){aT.unmousemove(bA).unmouseup(e);var g=bg.length,b;while(g--){b=bg[g];b.el._drag={};eve("raphael.drag.end."+b.el.id,b.end_scope||b.start_scope||b.move_scope||b.el,E)}bg=[]},bj=aT.el={};for(var az=U.length;az--;){(function(b){aT[b]=bj[b]=function(i,g){if(aT.is(i,"function")){this.events=this.events||[];this.events.push({name:b,f:i,unbind:aF(this.shape||this.node||aC.doc,b,i,g||this)})}return this};aT["un"+b]=bj["un"+b]=function(E){var i=this.events||[],g=i.length;while(g--){if(i[g].name==b&&i[g].f==E){i[g].unbind();i.splice(g,1);!i.length&&delete this.events;return this}}return this}})(U[az])}bj.data=function(g,R){var E=aW[this.id]=aW[this.id]||{};if(arguments.length==1){if(aT.is(g,"object")){for(var b in g){if(g[am](b)){this.data(b,g[b])}}return this}eve("raphael.data.get."+this.id,this,E[g],g);return E[g]}E[g]=R;eve("raphael.data.set."+this.id,this,R,g);return this};bj.removeData=function(b){if(b==null){aW[this.id]={}}else{aW[this.id]&&delete aW[this.id][b]}return this};bj.hover=function(E,b,i,g){return this.mouseover(E,i).mouseout(b,g||i)};bj.unhover=function(g,b){return this.unmouseover(g).unmouseout(b)};var bw=[];bj.drag=function(g,S,R,b,i,E){function bN(bP){(bP.originalEvent||bP).preventDefault();var bO=aC.doc.documentElement.scrollTop||aC.doc.body.scrollTop,bQ=aC.doc.documentElement.scrollLeft||aC.doc.body.scrollLeft;this._drag.x=bP.clientX+bQ;this._drag.y=bP.clientY+bO;this._drag.id=bP.identifier;!bg.length&&aT.mousemove(bA).mouseup(e);bg.push({el:this,move_scope:b,start_scope:i,end_scope:E});S&&eve.on("raphael.drag.start."+this.id,S);g&&eve.on("raphael.drag.move."+this.id,g);R&&eve.on("raphael.drag.end."+this.id,R);eve("raphael.drag.start."+this.id,i||b||this,bP.clientX+bQ,bP.clientY+bO,bP)}this._drag={};bw.push({el:this,start:bN});this.mousedown(bN);return this};bj.onDragOver=function(b){b?eve.on("raphael.drag.over."+this.id,b):eve.unbind("raphael.drag.over."+this.id)};bj.undrag=function(){var b=bw.length;while(b--){if(bw[b].el==this){this.unmousedown(bw[b].start);bw.splice(b,1);eve.unbind("raphael.drag.*."+this.id)}}!bw.length&&aT.unmousemove(bA).unmouseup(e)};a6.circle=function(b,E,i){var g=aT._engine.circle(this,b||0,E||0,i||0);this.__set__&&this.__set__.push(g);return g};a6.rect=function(b,S,g,E,R){var i=aT._engine.rect(this,b||0,S||0,g||0,E||0,R||0);this.__set__&&this.__set__.push(i);return i};a6.ellipse=function(b,R,E,i){var g=aT._engine.ellipse(this,b||0,R||0,E||0,i||0);this.__set__&&this.__set__.push(g);return g};a6.path=function(b){b&&!aT.is(b,al)&&!aT.is(b[0],bf)&&(b+=aZ);var g=aT._engine.path(aT.format[bI](aT,arguments),this);this.__set__&&this.__set__.push(g);return g};a6.image=function(R,b,S,g,E){var i=aT._engine.image(this,R||"about:blank",b||0,S||0,g||0,E||0);this.__set__&&this.__set__.push(i);return i};a6.text=function(b,E,i){var g=aT._engine.text(this,b||0,E||0,bJ(i));this.__set__&&this.__set__.push(g);return g};a6.set=function(g){!aT.is(g,"array")&&(g=Array.prototype.splice.call(arguments,0,arguments.length));var b=new an(g);this.__set__&&this.__set__.push(b);b.paper=this;b.type="set";return b};a6.setStart=function(b){this.__set__=b||this.set()};a6.setFinish=function(g){var b=this.__set__;delete this.__set__;return b};a6.setSize=function(g,b){return aT._engine.setSize.call(this,g,b)};a6.setViewBox=function(b,R,g,E,i){return aT._engine.setViewBox.call(this,b,R,g,E,i)};a6.top=a6.bottom=null;a6.raphael=aT;var bu=function(i){var R=i.getBoundingClientRect(),bP=i.ownerDocument,S=bP.body,b=bP.documentElement,E=b.clientTop||S.clientTop||0,bN=b.clientLeft||S.clientLeft||0,bO=R.top+(aC.win.pageYOffset||b.scrollTop||S.scrollTop)-E,g=R.left+(aC.win.pageXOffset||b.scrollLeft||S.scrollLeft)-bN;return{y:bO,x:g}};a6.getElementByPoint=function(g,bO){var bN=this,i=bN.canvas,S=aC.doc.elementFromPoint(g,bO);if(aC.win.opera&&S.tagName=="svg"){var R=bu(i),E=i.createSVGRect();E.x=g-R.x;E.y=bO-R.y;E.width=E.height=1;var b=i.getIntersectionList(E,null);if(b.length){S=b[b.length-1]}}if(!S){return null}while(S.parentNode&&S!=i.parentNode&&!S.raphael){S=S.parentNode}S==bN.canvas.parentNode&&(S=i);S=S&&S.raphael?bN.getById(S.raphaelid):null;return S};a6.getById=function(g){var b=this.bottom;while(b){if(b.id==g){return b}b=b.next}return null};a6.forEach=function(i,b){var g=this.bottom;while(g){if(i.call(b,g)===false){return this}g=g.next}return this};a6.getElementsByPoint=function(b,i){var g=this.set();this.forEach(function(E){if(E.isPointInside(b,i)){g.push(E)}});return g};function A(){return this.x+aS+this.y}function av(){return this.x+aS+this.y+aS+this.width+" \xd7 "+this.height}bj.isPointInside=function(b,i){var g=this.realPath=this.realPath||P[this.type](this);return aT.isPointInsidePath(g,b,i)};bj.getBBox=function(g){if(this.removed){return{}}var b=this._;if(g){if(b.dirty||!b.bboxwt){this.realPath=P[this.type](this);b.bboxwt=ao(this.realPath);b.bboxwt.toString=av;b.dirty=0}return b.bboxwt}if(b.dirty||b.dirtyT||!b.bbox){if(b.dirty||!this.realPath){b.bboxwt=0;this.realPath=P[this.type](this)}b.bbox=ao(N(this.realPath,this.matrix));b.bbox.toString=av;b.dirty=b.dirtyT=0}return b.bbox};bj.clone=function(){if(this.removed){return null}var b=this.paper[this.type]().attr(this.attr());this.__set__&&this.__set__.push(b);return b};bj.glow=function(bO){if(this.type=="text"){return null}bO=bO||{};var E={width:(bO.width||10)+(+this.attr("stroke-width")||1),fill:bO.fill||false,opacity:bO.opacity||0.5,offsetx:bO.offsetx||0,offsety:bO.offsety||0,color:bO.color||"#000"},bN=E.width/2,R=this.paper,b=R.set(),S=this.realPath||P[this.type](this);S=this.matrix?N(S,this.matrix):S;for(var g=1;g<bN+1;g++){b.push(R.path(S).attr({stroke:E.color,fill:E.fill?E.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(E.width/bN*g).toFixed(3),opacity:+(E.opacity/bN).toFixed(3)}))}return b.insertBefore(this).translate(E.offsetx,E.offsety)};var a9={},m=function(g,b,R,E,bP,bO,bN,S,i){if(i==null){return s(g,b,R,E,bP,bO,bN,S)}else{return aT.findDotsAtSegment(g,b,R,E,bP,bO,bN,S,F(g,b,R,E,bP,bO,bN,S,i))}},a8=function(b,g){return function(bW,S,bN){bW=Y(bW);var bS,bR,E,bO,R="",bV={},bT,bQ=0;for(var bP=0,bU=bW.length;bP<bU;bP++){E=bW[bP];if(E[0]=="M"){bS=+E[1];bR=+E[2]}else{bO=m(bS,bR,E[1],E[2],E[3],E[4],E[5],E[6]);if(bQ+bO>S){if(g&&!bV.start){bT=m(bS,bR,E[1],E[2],E[3],E[4],E[5],E[6],S-bQ);R+=["C"+bT.start.x,bT.start.y,bT.m.x,bT.m.y,bT.x,bT.y];if(bN){return R}bV.start=R;R=["M"+bT.x,bT.y+"C"+bT.n.x,bT.n.y,bT.end.x,bT.end.y,E[5],E[6]].join();bQ+=bO;bS=+E[5];bR=+E[6];continue}if(!b&&!g){bT=m(bS,bR,E[1],E[2],E[3],E[4],E[5],E[6],S-bQ);return{x:bT.x,y:bT.y,alpha:bT.alpha}}}bQ+=bO;bS=+E[5];bR=+E[6]}R+=E.shift()+E}bV.end=R;bT=b?bQ:g?bV:aT.findDotsAtSegment(bS,bR,E[0],E[1],E[2],E[3],E[4],E[5],1);bT.alpha&&(bT={x:bT.x,y:bT.y,alpha:bT.alpha});return bT}};var aU=a8(1),L=a8(),af=a8(0,1);aT.getTotalLength=aU;aT.getPointAtLength=L;aT.getSubpath=function(g,E,i){if(this.getTotalLength(g)-i<0.000001){return af(g,E).end}var b=af(g,i,1);return E?af(b,E).end:b};bj.getTotalLength=function(){if(this.type!="path"){return}if(this.node.getTotalLength){return this.node.getTotalLength()}return aU(this.attrs.path)};bj.getPointAtLength=function(b){if(this.type!="path"){return}return L(this.attrs.path,b)};bj.getSubpath=function(g,b){if(this.type!="path"){return}return aT.getSubpath(this.attrs.path,g,b)};var q=aT.easing_formulas={linear:function(b){return b},"<":function(b){return br(b,1.7)},">":function(b){return br(b,0.48)},"<>":function(bO){var E=0.48-bO/1.04,i=aw.sqrt(0.1734+E*E),b=i-E,bN=br(ay(b),1/3)*(b<0?-1:1),S=-i-E,R=br(ay(S),1/3)*(S<0?-1:1),g=bN+R+0.5;return(1-g)*3*g*g+g*g*g},backIn:function(g){var b=1.70158;return g*g*((b+1)*g-b)},backOut:function(g){g=g-1;var b=1.70158;return g*g*((b+1)*g+b)+1},elastic:function(b){if(b==!!b){return b}return br(2,-10*b)*aw.sin((b-0.075)*(2*aX)/0.3)+1},bounce:function(E){var g=7.5625,i=2.75,b;if(E<(1/i)){b=g*E*E}else{if(E<(2/i)){E-=(1.5/i);b=g*E*E+0.75}else{if(E<(2.5/i)){E-=(2.25/i);b=g*E*E+0.9375}else{E-=(2.625/i);b=g*E*E+0.984375}}}return b}};q.easeIn=q["ease-in"]=q["<"];q.easeOut=q["ease-out"]=q[">"];q.easeInOut=q["ease-in-out"]=q["<>"];q["back-in"]=q.backIn;q["back-out"]=q.backOut;var ad=[],aP=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(b,16)},bE=function(){var bO=+new Date,bW=0;for(;bW<ad.length;bW++){var b2=ad[bW];if(b2.el.removed||b2.paused){continue}var R=bO-b2.start,bU=b2.ms,bT=b2.easing,bX=b2.from,bR=b2.diff,g=b2.to,bQ=b2.t,bN=b2.el,bS={},b,b0={},b4;if(b2.initstatus){R=(b2.initstatus*b2.anim.top-b2.prev)/(b2.percent-b2.prev)*bU;b2.status=b2.initstatus;delete b2.initstatus;b2.stop&&ad.splice(bW--,1)}else{b2.status=(b2.prev+(b2.percent-b2.prev)*(R/bU))/b2.anim.top}if(R<0){continue}if(R<bU){var E=bT(R/bU);for(var bV in bX){if(bX[am](bV)){switch(au[bV]){case aN:b=+bX[bV]+E*bU*bR[bV];break;case"colour":b="rgb("+[J(aj(bX[bV].r+E*bU*bR[bV].r)),J(aj(bX[bV].g+E*bU*bR[bV].g)),J(aj(bX[bV].b+E*bU*bR[bV].b))].join(",")+")";break;case"path":b=[];for(var bZ=0,bP=bX[bV].length;bZ<bP;bZ++){b[bZ]=[bX[bV][bZ][0]];for(var bY=1,b1=bX[bV][bZ].length;bY<b1;bY++){b[bZ][bY]=+bX[bV][bZ][bY]+E*bU*bR[bV][bZ][bY]}b[bZ]=b[bZ].join(aS)}b=b.join(aS);break;case"transform":if(bR[bV].real){b=[];for(bZ=0,bP=bX[bV].length;bZ<bP;bZ++){b[bZ]=[bX[bV][bZ][0]];for(bY=1,b1=bX[bV][bZ].length;bY<b1;bY++){b[bZ][bY]=bX[bV][bZ][bY]+E*bU*bR[bV][bZ][bY]}}}else{var b3=function(b5){return +bX[bV][b5]+E*bU*bR[bV][b5]};b=[["m",b3(0),b3(1),b3(2),b3(3),b3(4),b3(5)]]}break;case"csv":if(bV=="clip-rect"){b=[];bZ=4;while(bZ--){b[bZ]=+bX[bV][bZ]+E*bU*bR[bV][bZ]}}break;default:var S=[][bG](bX[bV]);b=[];bZ=bN.paper.customAttributes[bV].length;while(bZ--){b[bZ]=+S[bZ]+E*bU*bR[bV][bZ]}break}bS[bV]=b}}bN.attr(bS);(function(b6,i,b5){setTimeout(function(){eve("raphael.anim.frame."+b6,i,b5)})})(bN.id,bN,b2.anim)}else{(function(b6,b5,i){setTimeout(function(){eve("raphael.anim.frame."+b5.id,b5,i);eve("raphael.anim.finish."+b5.id,b5,i);aT.is(b6,"function")&&b6.call(b5)})})(b2.callback,bN,b2.anim);bN.attr(g);ad.splice(bW--,1);if(b2.repeat>1&&!b2.next){for(b4 in g){if(g[am](b4)){b0[b4]=b2.totalOrigin[b4]}}b2.el.attr(b0);aO(b2.anim,b2.el,b2.anim.percents[0],null,b2.totalOrigin,b2.repeat-1)}if(b2.next&&!b2.stop){aO(b2.anim,b2.el,b2.next,null,b2.totalOrigin,b2.repeat)}}}aT.svg&&bN&&bN.paper&&bN.paper.safari();ad.length&&aP(bE)},J=function(b){return b>255?255:b<0?0:b};bj.animateWith=function(g,R,E,b,bO,bT){var bN=this;if(bN.removed){bT&&bT.call(bN);return bN}var bR=E instanceof bC?E:aT.animation(E,b,bO,bT),bQ,bP;aO(bR,bN,bR.percents[0],null,bN.attr());for(var S=0,bS=ad.length;S<bS;S++){if(ad[S].anim==R&&ad[S].el==g){ad[bS-1].start=ad[S].start;break}}return bN};function a5(bU,E,g,bT,bS,bO){var bP=3*E,bR=3*(bT-E)-bP,b=1-bP-bR,bN=3*g,bQ=3*(bS-g)-bN,bV=1-bN-bQ;function S(bW){return((b*bW+bR)*bW+bP)*bW}function i(bW,bY){var bX=R(bW,bY);return((bV*bX+bQ)*bX+bN)*bX}function R(bW,b3){var b2,b1,bZ,bX,b0,bY;for(bZ=bW,bY=0;bY<8;bY++){bX=S(bZ)-bW;if(ay(bX)<b3){return bZ}b0=(3*b*bZ+2*bR)*bZ+bP;if(ay(b0)<0.000001){break}bZ=bZ-bX/b0}b2=0;b1=1;bZ=bW;if(bZ<b2){return b2}if(bZ>b1){return b1}while(b2<b1){bX=S(bZ);if(ay(bX-bW)<b3){return bZ}if(bW>bX){b2=bZ}else{b1=bZ}bZ=(b1-b2)/2+b2}return bZ}return i(bU,1/(200*bO))}bj.onAnimation=function(b){b?eve.on("raphael.anim.frame."+this.id,b):eve.unbind("raphael.anim.frame."+this.id);return this};function bC(R,i){var g=[],E={};this.ms=i;this.times=1;if(R){for(var b in R){if(R[am](b)){E[ap(b)]=R[b];g.push(ap(b))}}g.sort(w)}this.anim=E;this.top=g[g.length-1];this.percents=g}bC.prototype.delay=function(g){var b=new bC(this.anim,this.ms);b.times=this.times;b.del=+g||0;return b};bC.prototype.repeat=function(g){var b=new bC(this.anim,this.ms);b.del=this.del;b.times=aw.floor(o(g,0))||1;return b};function aO(b6,E,b,b4,bO,bS){b=ap(b);var cd,bN,bR,ce=[],bY,bX,S,b0=b6.ms,b5={},R={},bU={};if(b4){for(b9=0,bT=ad.length;b9<bT;b9++){var cb=ad[b9];if(cb.el.id==E.id&&cb.anim==b6){if(cb.percent!=b){ad.splice(b9,1);bR=1}else{bN=cb}E.attr(cb.totalOrigin);break}}}else{b4=+R}for(var b9=0,bT=b6.percents.length;b9<bT;b9++){if(b6.percents[b9]==b||b6.percents[b9]>b4*b6.top){b=b6.percents[b9];bX=b6.percents[b9-1]||0;b0=b0/b6.top*(b-bX);bY=b6.percents[b9+1];cd=b6.anim[b];break}else{if(b4){E.attr(b6.anim[b6.percents[b9]])}}}if(!cd){return}if(!bN){for(var b2 in cd){if(cd[am](b2)){if(au[am](b2)||E.paper.customAttributes[am](b2)){b5[b2]=E.attr(b2);(b5[b2]==null)&&(b5[b2]=t[b2]);R[b2]=cd[b2];switch(au[b2]){case aN:bU[b2]=(R[b2]-b5[b2])/b0;break;case"colour":b5[b2]=aT.getRGB(b5[b2]);var b3=aT.getRGB(R[b2]);bU[b2]={r:(b3.r-b5[b2].r)/b0,g:(b3.g-b5[b2].g)/b0,b:(b3.b-b5[b2].b)/b0};break;case"path":var bP=Y(b5[b2],R[b2]),bW=bP[1];b5[b2]=bP[0];bU[b2]=[];for(b9=0,bT=b5[b2].length;b9<bT;b9++){bU[b2][b9]=[0];for(var b8=1,ca=b5[b2][b9].length;b8<ca;b8++){bU[b2][b9][b8]=(bW[b9][b8]-b5[b2][b9][b8])/b0}}break;case"transform":var cg=E._,cf=aD(cg[b2],R[b2]);if(cf){b5[b2]=cf.from;R[b2]=cf.to;bU[b2]=[];bU[b2].real=true;for(b9=0,bT=b5[b2].length;b9<bT;b9++){bU[b2][b9]=[b5[b2][b9][0]];for(b8=1,ca=b5[b2][b9].length;b8<ca;b8++){bU[b2][b9][b8]=(R[b2][b9][b8]-b5[b2][b9][b8])/b0}}}else{var b1=(E.matrix||new aH),cc={_:{transform:cg.transform},getBBox:function(){return E.getBBox(1)}};b5[b2]=[b1.a,b1.b,b1.c,b1.d,b1.e,b1.f];aQ(cc,R[b2]);R[b2]=cc._.transform;bU[b2]=[(cc.matrix.a-b1.a)/b0,(cc.matrix.b-b1.b)/b0,(cc.matrix.c-b1.c)/b0,(cc.matrix.d-b1.d)/b0,(cc.matrix.e-b1.e)/b0,(cc.matrix.f-b1.f)/b0]}break;case"csv":var g=bJ(cd[b2])[H](a),bQ=bJ(b5[b2])[H](a);if(b2=="clip-rect"){b5[b2]=bQ;bU[b2]=[];b9=bQ.length;while(b9--){bU[b2][b9]=(g[b9]-b5[b2][b9])/b0}}R[b2]=g;break;default:g=[][bG](cd[b2]);bQ=[][bG](b5[b2]);bU[b2]=[];b9=E.paper.customAttributes[b2].length;while(b9--){bU[b2][b9]=((g[b9]||0)-(bQ[b9]||0))/b0}break}}}}var bZ=cd.easing,b7=aT.easing_formulas[bZ];if(!b7){b7=bJ(bZ).match(c);if(b7&&b7.length==5){var bV=b7;b7=function(i){return a5(i,+bV[1],+bV[2],+bV[3],+bV[4],b0)}}else{b7=bD}}S=cd.start||b6.start||+new Date;cb={anim:b6,percent:b,timestamp:S,start:S+(b6.del||0),status:0,initstatus:b4||0,stop:false,ms:b0,easing:b7,from:b5,diff:bU,to:R,el:E,callback:cd.callback,prev:bX,next:bY,repeat:bS||b6.times,origin:E.attr(),totalOrigin:bO};ad.push(cb);if(b4&&!bN&&!bR){cb.stop=true;cb.start=new Date-b0*b4;if(ad.length==1){return bE()}}if(bR){cb.start=new Date-cb.ms*b4}ad.length==1&&aP(bE)}else{bN.initstatus=b4;bN.start=new Date-bN.ms*b4}eve("raphael.anim.start."+E.id,E,b6)}aT.animation=function(R,g,bN,S){if(R instanceof bC){return R}if(aT.is(bN,"function")||!bN){S=S||bN||null;bN=null}R=Object(R);g=+g||0;var E={},i,b;for(b in R){if(R[am](b)&&ap(b)!=b&&ap(b)+"%"!=b){i=true;E[b]=R[b]}}if(!i){return new bC(R,g)}else{bN&&(E.easing=bN);S&&(E.callback=S);return new bC({100:E},g)}};bj.animate=function(E,b,S,R){var g=this;if(g.removed){R&&R.call(g);return g}var i=E instanceof bC?E:aT.animation(E,b,S,R);aO(i,g,i.percents[0],null,g.attr());return g};bj.setTime=function(g,b){if(g&&b!=null){this.status(g,bo(b,g.ms)/g.ms)}return this};bj.status=function(S,R){var g=[],E=0,b,bN;if(R!=null){aO(S,this,-1,bo(R,1));return this}else{b=ad.length;for(;E<b;E++){bN=ad[E];if(bN.el.id==this.id&&(!S||bN.anim==S)){if(S){return bN.status}g.push({anim:bN.anim,status:bN.status})}}if(S){return 0}return g}};bj.pause=function(g){for(var b=0;b<ad.length;b++){if(ad[b].el.id==this.id&&(!g||ad[b].anim==g)){if(eve("raphael.anim.pause."+this.id,this,ad[b].anim)!==false){ad[b].paused=true}}}return this};bj.resume=function(g){for(var b=0;b<ad.length;b++){if(ad[b].el.id==this.id&&(!g||ad[b].anim==g)){var E=ad[b];if(eve("raphael.anim.resume."+this.id,this,E.anim)!==false){delete E.paused;this.status(E.anim,E.status)}}}return this};bj.stop=function(g){for(var b=0;b<ad.length;b++){if(ad[b].el.id==this.id&&(!g||ad[b].anim==g)){if(eve("raphael.anim.stop."+this.id,this,ad[b].anim)!==false){ad.splice(b--,1)}}}return this};function ac(g){for(var b=0;b<ad.length;b++){if(ad[b].el.paper==g){ad.splice(b--,1)}}}eve.on("raphael.remove",ac);eve.on("raphael.clear",ac);bj.toString=function(){return"Rapha\xebl\u2019s object"};var an=function(b){this.items=[];this.length=0;this.type="set";if(b){for(var g=0,E=b.length;g<E;g++){if(b[g]&&(b[g].constructor==bj.constructor||b[g].constructor==an)){this[this.items.length]=this.items[this.items.length]=b[g];this.length++}}}},be=an.prototype;be.push=function(){var R,b;for(var g=0,E=arguments.length;g<E;g++){R=arguments[g];if(R&&(R.constructor==bj.constructor||R.constructor==an)){b=this.items.length;this[b]=this.items[b]=R;this.length++}}return this};be.pop=function(){this.length&&delete this[this.length--];return this.items.pop()};be.forEach=function(R,b){for(var g=0,E=this.items.length;g<E;g++){if(R.call(b,this.items[g],g)===false){return this}}return this};for(var D in bj){if(bj[am](D)){be[D]=(function(b){return function(){var g=arguments;return this.forEach(function(i){i[b][bI](i,g)})}})(D)}}be.attr=function(g,bN){if(g&&aT.is(g,bf)&&aT.is(g[0],"object")){for(var b=0,S=g.length;b<S;b++){this.items[b].attr(g[b])}}else{for(var E=0,R=this.items.length;E<R;E++){this.items[E].attr(g,bN)}}return this};be.clear=function(){while(this.length){this.pop()}};be.splice=function(R,bO,bP){R=R<0?o(this.length+R,0):R;bO=o(0,bo(this.length-R,bO));var E=[],b=[],g=[],S;for(S=2;S<arguments.length;S++){g.push(arguments[S])}for(S=0;S<bO;S++){b.push(this[R+S])}for(;S<this.length-R;S++){E.push(this[R+S])}var bN=g.length;for(S=0;S<bN+E.length;S++){this.items[R+S]=this[R+S]=S<bN?g[S]:E[S-bN]}S=this.items.length=this.length-=bO-bN;while(this[S]){delete this[S++]}return new an(b)};be.exclude=function(E){for(var b=0,g=this.length;b<g;b++){if(this[b]==E){this.splice(b,1);return true}}};be.animate=function(E,b,bO,bQ){(aT.is(bO,"function")||!bO)&&(bQ=bO||null);var bN=this.items.length,R=bN,bR,bP=this,S;if(!bN){return this}bQ&&(S=function(){!--bN&&bQ.call(bP)});bO=aT.is(bO,al)?bO:S;var g=aT.animation(E,b,bO,S);bR=this.items[--R].animate(g);while(R--){this.items[R]&&!this.items[R].removed&&this.items[R].animateWith(bR,g,g)}return this};be.insertAfter=function(g){var b=this.items.length;while(b--){this.items[b].insertAfter(g)}return this};be.getBBox=function(){var b=[],bN=[],g=[],R=[];for(var E=this.items.length;E--;){if(!this.items[E].removed){var S=this.items[E].getBBox();b.push(S.x);bN.push(S.y);g.push(S.x+S.width);R.push(S.y+S.height)}}b=bo[bI](0,b);bN=bo[bI](0,bN);g=o[bI](0,g);R=o[bI](0,R);return{x:b,y:bN,x2:g,y2:R,width:g-b,height:R-bN}};be.clone=function(E){E=this.paper.set();for(var b=0,g=this.items.length;b<g;b++){E.push(this.items[b].clone())}return E};be.toString=function(){return"Rapha\xebl\u2018s set"};aT.registerFont=function(g){if(!g.face){return g}this.fonts=this.fonts||{};var E={w:g.w,face:{},glyphs:{}},i=g.face["font-family"];for(var bN in g.face){if(g.face[am](bN)){E.face[bN]=g.face[bN]}}if(this.fonts[i]){this.fonts[i].push(E)}else{this.fonts[i]=[E]}if(!g.svg){E.face["units-per-em"]=W(g.face["units-per-em"],10);for(var R in g.glyphs){if(g.glyphs[am](R)){var S=g.glyphs[R];E.glyphs[R]={w:S.w,k:{},d:S.d&&"M"+S.d.replace(/[mlcxtrv]/g,function(bO){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[bO]||"M"})+"z"};if(S.k){for(var b in S.k){if(S[am](b)){E.glyphs[R].k[b]=S.k[b]}}}}}}return g};a6.getFont=function(bP,bQ,g,R){R=R||"normal";g=g||"normal";bQ=+bQ||{normal:400,bold:700,lighter:300,bolder:800}[bQ]||400;if(!aT.fonts){return}var S=aT.fonts[bP];if(!S){var E=new RegExp("(^|\\s)"+bP.replace(/[^\w\d\s+!~.:_-]/g,aZ)+"(\\s|$)","i");for(var b in aT.fonts){if(aT.fonts[am](b)){if(E.test(b)){S=aT.fonts[b];break}}}}var bN;if(S){for(var bO=0,bR=S.length;bO<bR;bO++){bN=S[bO];if(bN.face["font-weight"]==bQ&&(bN.face["font-style"]==g||!bN.face["font-style"])&&bN.face["font-stretch"]==R){break}}}return bN};a6.print=function(bO,bN,b,bR,bS,b1,g){b1=b1||"middle";g=o(bo(g||0,1),-1);var b0=bJ(b)[H](aZ),bX=0,bZ=0,bV=aZ,b2;aT.is(bR,b)&&(bR=this.getFont(bR));if(bR){b2=(bS||16)/bR.face["units-per-em"];var R=bR.face.bbox[H](a),bQ=+R[0],E=R[3]-R[1],S=0,bT=+R[1]+(b1=="baseline"?E+(+bR.face.descent):E/2);for(var bW=0,bP=b0.length;bW<bP;bW++){if(b0[bW]=="\n"){bX=0;bY=0;bZ=0;S+=E}else{var bU=bZ&&bR.glyphs[b0[bW-1]]||{},bY=bR.glyphs[b0[bW]];bX+=bZ?(bU.w||bR.w)+(bU.k&&bU.k[b0[bW]]||0)+(bR.w*g):0;bZ=1}if(bY&&bY.d){bV+=aT.transformPath(bY.d,["t",bX*b2,S*b2,"s",b2,b2,bQ,bT,"t",(bO-bQ)/b2,(bN-bT)/b2])}}}return this.path(bV).attr({fill:"#000",stroke:"none"})};a6.add=function(R){if(aT.is(R,"array")){var E=this.set(),g=0,S=R.length,b;for(;g<S;g++){b=R[g]||{};by[am](b.type)&&E.push(this[b.type]().attr(b))}}return E};aT.format=function(g,i){var b=aT.is(i,bf)?[0][bG](i):arguments;g&&aT.is(g,al)&&b.length-1&&(g=g.replace(bt,function(R,E){return b[++E]==null?aZ:b[E]}));return g||aZ};aT.fullfill=(function(){var i=/\{([^\}]+)\}/g,b=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,g=function(S,R,bN){var E=bN;R.replace(b,function(bQ,bP,bO,bS,bR){bP=bP||bS;if(E){if(bP in E){E=E[bP]}typeof E=="function"&&bR&&(E=E())}});E=(E==null||E==bN?S:E)+"";return E};return function(R,E){return String(R).replace(i,function(bN,S){return g(bN,S,E)})}})();aT.ninja=function(){u.was?(aC.win.Raphael=u.is):delete Raphael;return aT};aT.st=be;(function(E,g,i){if(E.readyState==null&&E.addEventListener){E.addEventListener(g,i=function(){E.removeEventListener(g,i,false);E.readyState="complete"},false);E.readyState="loading"}function b(){(/in/).test(E.readyState)?setTimeout(b,9):aT.eve("raphael.DOMload")}b()})(document,"DOMContentLoaded");u.was?(aC.win.Raphael=aT):(Raphael=aT);eve.on("raphael.DOMload",function(){aq=true})})();window.Raphael.svg&&function(o){var e="hasOwnProperty",F=String,q=parseFloat,t=parseInt,g=Math,G=g.max,v=g.abs,i=g.pow,h=/[, ]+/,C=o.eve,u="",m=" ";var r="http://www.w3.org/1999/xlink",B={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},x={};o.toString=function(){return"Your browser supports SVG.\nYou are running Rapha\xebl "+this.version};var l=function(I,E){if(E){if(typeof I=="string"){I=l(I)}for(var H in E){if(E[e](H)){if(H.substring(0,6)=="xlink:"){I.setAttributeNS(r,H.substring(6),F(E[H]))}else{I.setAttribute(H,F(E[H]))}}}}else{I=o._g.doc.createElementNS("http://www.w3.org/2000/svg",I);I.style&&(I.style.webkitTapHighlightColor="rgba(0,0,0,0)")}return I},a=function(P,T){var R="linear",H=P.id+T,N=0.5,L=0.5,J=P.node,E=P.paper,V=J.style,I=o._g.doc.getElementById(H);if(!I){T=F(T).replace(o._radial_gradient,function(Y,W,Z){R="radial";if(W&&Z){N=q(W);L=q(Z);var X=((L>0.5)*2-1);i(N-0.5,2)+i(L-0.5,2)>0.25&&(L=g.sqrt(0.25-i(N-0.5,2))*X+0.5)&&L!=0.5&&(L=L.toFixed(5)-0.00001*X)}return u});T=T.split(/\s*\-\s*/);if(R=="linear"){var M=T.shift();M=-q(M);if(isNaN(M)){return null}var K=[0,0,g.cos(o.rad(M)),g.sin(o.rad(M))],S=1/(G(v(K[2]),v(K[3]))||1);K[2]*=S;K[3]*=S;if(K[2]<0){K[0]=-K[2];K[2]=0}if(K[3]<0){K[1]=-K[3];K[3]=0}}var Q=o._parseDots(T);if(!Q){return null}H=H.replace(/[\(\)\s,\xb0#]/g,"_");if(P.gradient&&H!=P.gradient.id){E.defs.removeChild(P.gradient);delete P.gradient}if(!P.gradient){I=l(R+"Gradient",{id:H});P.gradient=I;l(I,R=="radial"?{fx:N,fy:L}:{x1:K[0],y1:K[1],x2:K[2],y2:K[3],gradientTransform:P.matrix.invert()});E.defs.appendChild(I);for(var O=0,U=Q.length;O<U;O++){I.appendChild(l("stop",{offset:Q[O].offset?Q[O].offset:O?"100%":"0%","stop-color":Q[O].color||"#fff"}))}}}l(J,{fill:"url(#"+H+")",opacity:1,"fill-opacity":1});V.fill=u;V.opacity=1;V.fillOpacity=1;return 1},b=function(H){var E=H.getBBox(1);l(H.pattern,{patternTransform:H.matrix.invert()+" translate("+E.x+","+E.y+")"})},c=function(R,T,M){if(R.type=="path"){var E=F(T).toLowerCase().split("-"),Q=R.paper,ae=M?"end":"start",V=R.node,S=R.attrs,L=S["stroke-width"],Z=E.length,J="classic",Y,I,O,W,U,N=3,aa=3,P=5;while(Z--){switch(E[Z]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":J=E[Z];break;case"wide":aa=5;break;case"narrow":aa=2;break;case"long":N=5;break;case"short":N=2;break}}if(J=="open"){N+=2;aa+=2;P+=2;O=1;W=M?4:1;U={fill:"none",stroke:S.stroke}}else{W=O=N/2;U={fill:S.stroke,stroke:"none"}}if(R._.arrows){if(M){R._.arrows.endPath&&x[R._.arrows.endPath]--;R._.arrows.endMarker&&x[R._.arrows.endMarker]--}else{R._.arrows.startPath&&x[R._.arrows.startPath]--;R._.arrows.startMarker&&x[R._.arrows.startMarker]--}}else{R._.arrows={}}if(J!="none"){var H="raphael-marker-"+J,ad="raphael-marker-"+ae+J+N+aa;if(!o._g.doc.getElementById(H)){Q.defs.appendChild(l(l("path"),{"stroke-linecap":"round",d:B[J],id:H}));x[H]=1}else{x[H]++}var K=o._g.doc.getElementById(ad),X;if(!K){K=l(l("marker"),{id:ad,markerHeight:aa,markerWidth:N,orient:"auto",refX:W,refY:aa/2});X=l(l("use"),{"xlink:href":"#"+H,transform:(M?"rotate(180 "+N/2+" "+aa/2+") ":u)+"scale("+N/P+","+aa/P+")","stroke-width":(1/((N/P+aa/P)/2)).toFixed(4)});K.appendChild(X);Q.defs.appendChild(K);x[ad]=1}else{x[ad]++;X=K.getElementsByTagName("use")[0]}l(X,U);var ac=O*(J!="diamond"&&J!="oval");if(M){Y=R._.arrows.startdx*L||0;I=o.getTotalLength(S.path)-ac*L}else{Y=ac*L;I=o.getTotalLength(S.path)-(R._.arrows.enddx*L||0)}U={};U["marker-"+ae]="url(#"+ad+")";if(I||Y){U.d=Raphael.getSubpath(S.path,Y,I)}l(V,U);R._.arrows[ae+"Path"]=H;R._.arrows[ae+"Marker"]=ad;R._.arrows[ae+"dx"]=ac;R._.arrows[ae+"Type"]=J;R._.arrows[ae+"String"]=T}else{if(M){Y=R._.arrows.startdx*L||0;I=o.getTotalLength(S.path)-Y}else{Y=0;I=o.getTotalLength(S.path)-(R._.arrows.enddx*L||0)}R._.arrows[ae+"Path"]&&l(V,{d:Raphael.getSubpath(S.path,Y,I)});delete R._.arrows[ae+"Path"];delete R._.arrows[ae+"Marker"];delete R._.arrows[ae+"dx"];delete R._.arrows[ae+"Type"];delete R._.arrows[ae+"String"]}for(U in x){if(x[e](U)&&!x[U]){var ab=o._g.doc.getElementById(U);ab&&ab.parentNode.removeChild(ab)}}}},y={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},n=function(M,K,L){K=y[F(K).toLowerCase()];if(K){var I=M.attrs["stroke-width"]||"1",E={round:I,square:I,butt:0}[M.attrs["stroke-linecap"]||L["stroke-linecap"]]||0,J=[],H=K.length;while(H--){J[H]=K[H]*I+((H%2)?1:-1)*E}l(M.node,{"stroke-dasharray":J.join(",")})}},z=function(R,Z){var V=R.node,S=R.attrs,P=V.style.visibility;V.style.visibility="hidden";for(var U in Z){if(Z[e](U)){if(!o._availableAttrs[e](U)){continue}var T=Z[U];S[U]=T;switch(U){case"blur":R.blur(T);break;case"href":case"title":case"target":var X=V.parentNode;if(X.tagName.toLowerCase()!="a"){var K=l("a");X.insertBefore(K,V);K.appendChild(V);X=K}if(U=="target"){X.setAttributeNS(r,"show",T=="blank"?"new":T)}else{X.setAttributeNS(r,U,T)}break;case"cursor":V.style.cursor=T;break;case"transform":R.transform(T);break;case"arrow-start":c(R,T);break;case"arrow-end":c(R,T,1);break;case"clip-rect":var H=F(T).split(h);if(H.length==4){R.clip&&R.clip.parentNode.parentNode.removeChild(R.clip.parentNode);var I=l("clipPath"),W=l("rect");I.id=o.createUUID();l(W,{x:H[0],y:H[1],width:H[2],height:H[3]});I.appendChild(W);R.paper.defs.appendChild(I);l(V,{"clip-path":"url(#"+I.id+")"});R.clip=W}if(!T){var Q=V.getAttribute("clip-path");if(Q){var Y=o._g.doc.getElementById(Q.replace(/(^url\(#|\)$)/g,u));Y&&Y.parentNode.removeChild(Y);l(V,{"clip-path":u});delete R.clip}}break;case"path":if(R.type=="path"){l(V,{d:T?S.path=o._pathToAbsolute(T):"M0,0"});R._.dirty=1;if(R._.arrows){"startString" in R._.arrows&&c(R,R._.arrows.startString);"endString" in R._.arrows&&c(R,R._.arrows.endString,1)}}break;case"width":V.setAttribute(U,T);R._.dirty=1;if(S.fx){U="x";T=S.x}else{break}case"x":if(S.fx){T=-S.x-(S.width||0)}case"rx":if(U=="rx"&&R.type=="rect"){break}case"cx":V.setAttribute(U,T);R.pattern&&b(R);R._.dirty=1;break;case"height":V.setAttribute(U,T);R._.dirty=1;if(S.fy){U="y";T=S.y}else{break}case"y":if(S.fy){T=-S.y-(S.height||0)}case"ry":if(U=="ry"&&R.type=="rect"){break}case"cy":V.setAttribute(U,T);R.pattern&&b(R);R._.dirty=1;break;case"r":if(R.type=="rect"){l(V,{rx:T,ry:T})}else{V.setAttribute(U,T)}R._.dirty=1;break;case"src":if(R.type=="image"){V.setAttributeNS(r,"href",T)}break;case"stroke-width":if(R._.sx!=1||R._.sy!=1){T/=G(v(R._.sx),v(R._.sy))||1}if(R.paper._vbSize){T*=R.paper._vbSize}V.setAttribute(U,T);if(S["stroke-dasharray"]){n(R,S["stroke-dasharray"],Z)}if(R._.arrows){"startString" in R._.arrows&&c(R,R._.arrows.startString);"endString" in R._.arrows&&c(R,R._.arrows.endString,1)}break;case"stroke-dasharray":n(R,T,Z);break;case"fill":var L=F(T).match(o._ISURL);if(L){I=l("pattern");var O=l("image");I.id=o.createUUID();l(I,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});l(O,{x:0,y:0,"xlink:href":L[1]});I.appendChild(O);(function(aa){o._preload(L[1],function(){var ab=this.offsetWidth,ac=this.offsetHeight;l(aa,{width:ab,height:ac});l(O,{width:ab,height:ac});R.paper.safari()})})(I);R.paper.defs.appendChild(I);l(V,{fill:"url(#"+I.id+")"});R.pattern=I;R.pattern&&b(R);break}var J=o.getRGB(T);if(!J.error){delete Z.gradient;delete S.gradient;!o.is(S.opacity,"undefined")&&o.is(Z.opacity,"undefined")&&l(V,{opacity:S.opacity});!o.is(S["fill-opacity"],"undefined")&&o.is(Z["fill-opacity"],"undefined")&&l(V,{"fill-opacity":S["fill-opacity"]})}else{if((R.type=="circle"||R.type=="ellipse"||F(T).charAt()!="r")&&a(R,T)){if("opacity" in S||"fill-opacity" in S){var E=o._g.doc.getElementById(V.getAttribute("fill").replace(/^url\(#|\)$/g,u));if(E){var M=E.getElementsByTagName("stop");l(M[M.length-1],{"stop-opacity":("opacity" in S?S.opacity:1)*("fill-opacity" in S?S["fill-opacity"]:1)})}}S.gradient=T;S.fill="none";break}}J[e]("opacity")&&l(V,{"fill-opacity":J.opacity>1?J.opacity/100:J.opacity});case"stroke":J=o.getRGB(T);V.setAttribute(U,J.hex);U=="stroke"&&J[e]("opacity")&&l(V,{"stroke-opacity":J.opacity>1?J.opacity/100:J.opacity});if(U=="stroke"&&R._.arrows){"startString" in R._.arrows&&c(R,R._.arrows.startString);"endString" in R._.arrows&&c(R,R._.arrows.endString,1)}break;case"gradient":(R.type=="circle"||R.type=="ellipse"||F(T).charAt()!="r")&&a(R,T);break;case"opacity":if(S.gradient&&!S[e]("stroke-opacity")){l(V,{"stroke-opacity":T>1?T/100:T})}case"fill-opacity":if(S.gradient){E=o._g.doc.getElementById(V.getAttribute("fill").replace(/^url\(#|\)$/g,u));if(E){M=E.getElementsByTagName("stop");l(M[M.length-1],{"stop-opacity":T})}break}default:U=="font-size"&&(T=t(T,10)+"px");var N=U.replace(/(\-.)/g,function(aa){return aa.substring(1).toUpperCase()});V.style[N]=T;R._.dirty=1;V.setAttribute(U,T);break}}}s(R,Z);V.style.visibility=P},D=1.2,s=function(E,K){if(E.type!="text"||!(K[e]("text")||K[e]("font")||K[e]("font-size")||K[e]("x")||K[e]("y"))){return}var P=E.attrs,I=E.node,R=I.firstChild?t(o._g.doc.defaultView.getComputedStyle(I.firstChild,u).getPropertyValue("font-size"),10):10;if(K[e]("text")){P.text=K.text;while(I.firstChild){I.removeChild(I.firstChild)}var J=F(K.text).split("\n"),H=[],N;for(var L=0,Q=J.length;L<Q;L++){N=l("tspan");L&&l(N,{dy:R*D,x:P.x});N.appendChild(o._g.doc.createTextNode(J[L]));I.appendChild(N);H[L]=N}}else{H=I.getElementsByTagName("tspan");for(L=0,Q=H.length;L<Q;L++){if(L){l(H[L],{dy:R*D,x:P.x})}else{l(H[0],{dy:0})}}}l(I,{x:P.x,y:P.y});E._.dirty=1;var M=E._getBBox(),O=P.y-(M.y+M.height/2);O&&o.is(O,"finite")&&l(H[0],{dy:O})},w=function(H,E){var J=0,I=0;this[0]=this.node=H;H.raphael=true;this.id=o._oid++;H.raphaelid=this.id;this.matrix=o.matrix();this.realPath=null;this.paper=E;this.attrs=this.attrs||{};this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1};!E.bottom&&(E.bottom=this);this.prev=E.top;E.top&&(E.top.next=this);E.top=this;this.next=null},p=o.el;w.prototype=p;p.constructor=w;o._engine.path=function(E,J){var H=l("path");J.canvas&&J.canvas.appendChild(H);var I=new w(H,J);I.type="path";z(I,{fill:"none",stroke:"#000",path:E});return I};p.rotate=function(H,E,J){if(this.removed){return this}H=F(H).split(h);if(H.length-1){E=q(H[1]);J=q(H[2])}H=q(H[0]);(J==null)&&(E=J);if(E==null||J==null){var I=this.getBBox(1);E=I.x+I.width/2;J=I.y+I.height/2}this.transform(this._.transform.concat([["r",H,E,J]]));return this};p.scale=function(K,I,E,J){if(this.removed){return this}K=F(K).split(h);if(K.length-1){I=q(K[1]);E=q(K[2]);J=q(K[3])}K=q(K[0]);(I==null)&&(I=K);(J==null)&&(E=J);if(E==null||J==null){var H=this.getBBox(1)}E=E==null?H.x+H.width/2:E;J=J==null?H.y+H.height/2:J;this.transform(this._.transform.concat([["s",K,I,E,J]]));return this};p.translate=function(H,E){if(this.removed){return this}H=F(H).split(h);if(H.length-1){E=q(H[1])}H=q(H[0])||0;E=+E||0;this.transform(this._.transform.concat([["t",H,E]]));return this};p.transform=function(H){var I=this._;if(H==null){return I.transform}o._extractTransform(this,H);this.clip&&l(this.clip,{transform:this.matrix.invert()});this.pattern&&b(this);this.node&&l(this.node,{transform:this.matrix});if(I.sx!=1||I.sy!=1){var E=this.attrs[e]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":E})}return this};p.hide=function(){!this.removed&&this.paper.safari(this.node.style.display="none");return this};p.show=function(){!this.removed&&this.paper.safari(this.node.style.display="");return this};p.remove=function(){if(this.removed||!this.node.parentNode){return}var H=this.paper;H.__set__&&H.__set__.exclude(this);C.unbind("raphael.*.*."+this.id);if(this.gradient){H.defs.removeChild(this.gradient)}o._tear(this,H);if(this.node.parentNode.tagName.toLowerCase()=="a"){this.node.parentNode.parentNode.removeChild(this.node.parentNode)}else{this.node.parentNode.removeChild(this.node)}for(var E in this){this[E]=typeof this[E]=="function"?o._removedFactory(E):null}this.removed=true};p._getBBox=function(){if(this.node.style.display=="none"){this.show();var E=true}var I={};try{I=this.node.getBBox()}catch(H){}finally{I=I||{}}E&&this.hide();return I};p.attr=function(E,P){if(this.removed){return this}if(E==null){var M={};for(var O in this.attrs){if(this.attrs[e](O)){M[O]=this.attrs[O]}}M.gradient&&M.fill=="none"&&(M.fill=M.gradient)&&delete M.gradient;M.transform=this._.transform;return M}if(P==null&&o.is(E,"string")){if(E=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}if(E=="transform"){return this._.transform}var N=E.split(h),J={};for(var K=0,R=N.length;K<R;K++){E=N[K];if(E in this.attrs){J[E]=this.attrs[E]}else{if(o.is(this.paper.customAttributes[E],"function")){J[E]=this.paper.customAttributes[E].def}else{J[E]=o._availableAttrs[E]}}}return R-1?J:J[N[0]]}if(P==null&&o.is(E,"array")){J={};for(K=0,R=E.length;K<R;K++){J[E[K]]=this.attr(E[K])}return J}if(P!=null){var H={};H[E]=P}else{if(E!=null&&o.is(E,"object")){H=E}}for(var Q in H){C("raphael.attr."+Q+"."+this.id,this,H[Q])}for(Q in this.paper.customAttributes){if(this.paper.customAttributes[e](Q)&&H[e](Q)&&o.is(this.paper.customAttributes[Q],"function")){var L=this.paper.customAttributes[Q].apply(this,[].concat(H[Q]));this.attrs[Q]=H[Q];for(var I in L){if(L[e](I)){H[I]=L[I]}}}}z(this,H);return this};p.toFront=function(){if(this.removed){return this}if(this.node.parentNode.tagName.toLowerCase()=="a"){this.node.parentNode.parentNode.appendChild(this.node.parentNode)}else{this.node.parentNode.appendChild(this.node)}var E=this.paper;E.top!=this&&o._tofront(this,E);return this};p.toBack=function(){if(this.removed){return this}var H=this.node.parentNode;if(H.tagName.toLowerCase()=="a"){H.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild)}else{if(H.firstChild!=this.node){H.insertBefore(this.node,this.node.parentNode.firstChild)}}o._toback(this,this.paper);var E=this.paper;return this};p.insertAfter=function(E){if(this.removed){return this}var H=E.node||E[E.length-1].node;if(H.nextSibling){H.parentNode.insertBefore(this.node,H.nextSibling)}else{H.parentNode.appendChild(this.node)}o._insertafter(this,E,this.paper);return this};p.insertBefore=function(E){if(this.removed){return this}var H=E.node||E[0].node;H.parentNode.insertBefore(this.node,H);o._insertbefore(this,E,this.paper);return this};p.blur=function(H){var E=this;if(+H!==0){var I=l("filter"),J=l("feGaussianBlur");E.attrs.blur=H;I.id=o.createUUID();l(J,{stdDeviation:+H||1.5});I.appendChild(J);E.paper.defs.appendChild(I);E._blur=I;l(E.node,{filter:"url(#"+I.id+")"})}else{if(E._blur){E._blur.parentNode.removeChild(E._blur);delete E._blur;delete E.attrs.blur}E.node.removeAttribute("filter")}};o._engine.circle=function(H,E,L,K){var J=l("circle");H.canvas&&H.canvas.appendChild(J);var I=new w(J,H);I.attrs={cx:E,cy:L,r:K,fill:"none",stroke:"#000"};I.type="circle";l(J,I.attrs);return I};o._engine.rect=function(I,E,N,H,L,M){var K=l("rect");I.canvas&&I.canvas.appendChild(K);var J=new w(K,I);J.attrs={x:E,y:N,width:H,height:L,r:M||0,rx:M||0,ry:M||0,fill:"none",stroke:"#000"};J.type="rect";l(K,J.attrs);return J};o._engine.ellipse=function(H,E,M,L,K){var J=l("ellipse");H.canvas&&H.canvas.appendChild(J);var I=new w(J,H);I.attrs={cx:E,cy:M,rx:L,ry:K,fill:"none",stroke:"#000"};I.type="ellipse";l(J,I.attrs);return I};o._engine.image=function(I,M,E,N,H,L){var K=l("image");l(K,{x:E,y:N,width:H,height:L,preserveAspectRatio:"none"});K.setAttributeNS(r,"href",M);I.canvas&&I.canvas.appendChild(K);var J=new w(K,I);J.attrs={x:E,y:N,width:H,height:L,src:M};J.type="image";return J};o._engine.text=function(H,E,L,K){var J=l("text");H.canvas&&H.canvas.appendChild(J);var I=new w(J,H);I.attrs={x:E,y:L,"text-anchor":"middle",text:K,font:o._availableAttrs.font,stroke:"none",fill:"#000"};I.type="text";z(I,I.attrs);return I};o._engine.setSize=function(H,E){this.width=H||this.width;this.height=E||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);if(this._viewBox){this.setViewBox.apply(this,this._viewBox)}return this};o._engine.create=function(){var J=o._getContainer.apply(0,arguments),H=J&&J.container,N=J.x,M=J.y,I=J.width,O=J.height;if(!H){throw new Error("SVG container not found.")}var E=l("svg"),L="overflow:hidden;",K;N=N||0;M=M||0;I=I||512;O=O||342;l(E,{height:O,version:1.1,width:I,xmlns:"http://www.w3.org/2000/svg"});if(H==1){E.style.cssText=L+"position:absolute;left:"+N+"px;top:"+M+"px";o._g.doc.body.appendChild(E);K=1}else{E.style.cssText=L+"position:relative";if(H.firstChild){H.insertBefore(E,H.firstChild)}else{H.appendChild(E)}}H=new o._Paper;H.width=I;H.height=O;H.canvas=E;H.clear();H._left=H._top=0;K&&(H.renderfix=function(){});H.renderfix();return H};o._engine.setViewBox=function(L,J,N,E,H){C("raphael.setViewBox",this,this._viewBox,[L,J,N,E,H]);var P=G(N/this.width,E/this.height),K=this.top,O=H?"meet":"xMinYMin",I,M;if(L==null){if(this._vbSize){P=1}delete this._vbSize;I="0 0 "+this.width+m+this.height}else{this._vbSize=P;I=L+m+J+m+N+m+E}l(this.canvas,{viewBox:I,preserveAspectRatio:O});while(P&&K){M="stroke-width" in K.attrs?K.attrs["stroke-width"]:1;K.attr({"stroke-width":M});K._.dirty=1;K._.dirtyT=1;K=K.prev}this._viewBox=[L,J,N,E,!!H];return this};o.prototype.renderfix=function(){var L=this.canvas,E=L.style,K;try{K=L.getScreenCTM()||L.createSVGMatrix()}catch(J){K=L.createSVGMatrix()}var I=-K.e%1,H=-K.f%1;if(I||H){if(I){this._left=(this._left+I)%1;E.left=this._left+"px"}if(H){this._top=(this._top+H)%1;E.top=this._top+"px"}}};o.prototype.clear=function(){o.eve("raphael.clear",this);var E=this.canvas;while(E.firstChild){E.removeChild(E.firstChild)}this.bottom=this.top=null;(this.desc=l("desc")).appendChild(o._g.doc.createTextNode("Created with Rapha\xebl "+o.version));E.appendChild(this.desc);E.appendChild(this.defs=l("defs"))};o.prototype.remove=function(){C("raphael.remove",this);this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var E in this){this[E]=typeof this[E]=="function"?o._removedFactory(E):null}};var A=o.st;for(var f in p){if(p[e](f)&&!A[e](f)){A[f]=(function(E){return function(){var H=arguments;return this.forEach(function(I){I[E].apply(I,H)})}})(f)}}}(window.Raphael);window.Raphael.vml&&function(o){var f="hasOwnProperty",I=String,q=parseFloat,i=Math,F=i.round,L=i.max,G=i.min,v=i.abs,y="fill",l=/[, ]+/,D=o.eve,z=" progid:DXImageTransform.Microsoft",n=" ",t="",H={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},m=/([clmz]),?([^clmz]*)/gi,w=/ progid:\S+Blur\([^\)]+\)/g,K=/-?[^,\s-]+/g,e="position:absolute;left:0;top:0;width:1px;height:1px",b=21600,C={path:1,rect:1,image:1},u={circle:1,ellipse:1},g=function(V){var S=/[ahqstv]/ig,N=o._pathToAbsolute;I(V).match(S)&&(N=o._path2curve);S=/[clmz]/g;if(N==o._pathToAbsolute&&!I(V).match(S)){var R=I(V).replace(m,function(Z,ab,X){var aa=[],W=ab.toLowerCase()=="m",Y=H[ab];X.replace(K,function(ac){if(W&&aa.length==2){Y+=aa+H[ab=="m"?"l":"L"];aa=[]}aa.push(F(ac*b))});return Y+aa});return R}var T=N(V),M,E;R=[];for(var P=0,U=T.length;P<U;P++){M=T[P];E=T[P][0].toLowerCase();E=="z"&&(E="x");for(var O=1,Q=M.length;O<Q;O++){E+=F(M[O]*b)+(O!=Q-1?",":t)}R.push(E)}return R.join(n)},r=function(O,N,M){var E=o.matrix();E.rotate(-O,0.5,0.5);return{dx:E.x(N,M),dy:E.y(N,M)}},s=function(U,T,S,P,O,Q){var ac=U._,W=U.matrix,E=ac.fillpos,V=U.node,R=V.style,N=1,M="",Y,aa=b/T,Z=b/S;R.visibility="hidden";if(!T||!S){return}V.coordsize=v(aa)+n+v(Z);R.rotation=Q*(T*S<0?-1:1);if(Q){var ab=r(Q,P,O);P=ab.dx;O=ab.dy}T<0&&(M+="x");S<0&&(M+=" y")&&(N=-1);R.flip=M;V.coordorigin=(P*-aa)+n+(O*-Z);if(E||ac.fillsize){var X=V.getElementsByTagName(y);X=X&&X[0];V.removeChild(X);if(E){ab=r(Q,W.x(E[0],E[1]),W.y(E[0],E[1]));X.position=ab.dx*N+n+ab.dy*N}if(ac.fillsize){X.size=ac.fillsize[0]*v(T)+n+ac.fillsize[1]*v(S)}V.appendChild(X)}R.visibility="visible"};o.toString=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\xebl "+this.version};var c=function(E,R,M){var T=I(R).toLowerCase().split("-"),P=M?"end":"start",N=T.length,Q="classic",S="medium",O="medium";while(N--){switch(T[N]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":Q=T[N];break;case"wide":case"narrow":O=T[N];break;case"long":case"short":S=T[N];break}}var U=E.node.getElementsByTagName("stroke")[0];U[P+"arrow"]=Q;U[P+"arrowlength"]=S;U[P+"arrowwidth"]=O},A=function(ac,am){ac.attrs=ac.attrs||{};var ah=ac.node,aq=ac.attrs,Y=ah.style,U,ak=C[ac.type]&&(am.x!=aq.x||am.y!=aq.y||am.width!=aq.width||am.height!=aq.height||am.cx!=aq.cx||am.cy!=aq.cy||am.rx!=aq.rx||am.ry!=aq.ry||am.r!=aq.r),ab=u[ac.type]&&(aq.cx!=am.cx||aq.cy!=am.cy||aq.r!=am.r||aq.rx!=am.rx||aq.ry!=am.ry),au=ac;for(var Z in am){if(am[f](Z)){aq[Z]=am[Z]}}if(ak){aq.path=o._getPath[ac.type](ac);ac._.dirty=1}am.href&&(ah.href=am.href);am.title&&(ah.title=am.title);am.target&&(ah.target=am.target);am.cursor&&(Y.cursor=am.cursor);"blur" in am&&ac.blur(am.blur);if(am.path&&ac.type=="path"||ak){ah.path=g(~I(aq.path).toLowerCase().indexOf("r")?o._pathToAbsolute(aq.path):aq.path);if(ac.type=="image"){ac._.fillpos=[aq.x,aq.y];ac._.fillsize=[aq.width,aq.height];s(ac,1,1,0,0,0)}}"transform" in am&&ac.transform(am.transform);if(ab){var P=+aq.cx,N=+aq.cy,T=+aq.rx||+aq.r||0,S=+aq.ry||+aq.r||0;ah.path=o.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",F((P-T)*b),F((N-S)*b),F((P+T)*b),F((N+S)*b),F(P*b))}if("clip-rect" in am){var M=I(am["clip-rect"]).split(l);if(M.length==4){M[2]=+M[2]+(+M[0]);M[3]=+M[3]+(+M[1]);var aa=ah.clipRect||o._g.doc.createElement("div"),at=aa.style;at.clip=o.format("rect({1}px {2}px {3}px {0}px)",M);if(!ah.clipRect){at.position="absolute";at.top=0;at.left=0;at.width=ac.paper.width+"px";at.height=ac.paper.height+"px";ah.parentNode.insertBefore(aa,ah);aa.appendChild(ah);ah.clipRect=aa}}if(!am["clip-rect"]){ah.clipRect&&(ah.clipRect.style.clip="auto")}}if(ac.textpath){var ao=ac.textpath.style;am.font&&(ao.font=am.font);am["font-family"]&&(ao.fontFamily='"'+am["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,t)+'"');am["font-size"]&&(ao.fontSize=am["font-size"]);am["font-weight"]&&(ao.fontWeight=am["font-weight"]);am["font-style"]&&(ao.fontStyle=am["font-style"])}if("arrow-start" in am){c(au,am["arrow-start"])}if("arrow-end" in am){c(au,am["arrow-end"],1)}if(am.opacity!=null||am["stroke-width"]!=null||am.fill!=null||am.src!=null||am.stroke!=null||am["stroke-width"]!=null||am["stroke-opacity"]!=null||am["fill-opacity"]!=null||am["stroke-dasharray"]!=null||am["stroke-miterlimit"]!=null||am["stroke-linejoin"]!=null||am["stroke-linecap"]!=null){var ai=ah.getElementsByTagName(y),ap=false;ai=ai&&ai[0];!ai&&(ap=ai=J(y));if(ac.type=="image"&&am.src){ai.src=am.src}am.fill&&(ai.on=true);if(ai.on==null||am.fill=="none"||am.fill===null){ai.on=false}if(ai.on&&am.fill){var R=I(am.fill).match(o._ISURL);if(R){ai.parentNode==ah&&ah.removeChild(ai);ai.rotate=true;ai.src=R[1];ai.type="tile";var E=ac.getBBox(1);ai.position=E.x+n+E.y;ac._.fillpos=[E.x,E.y];o._preload(R[1],function(){ac._.fillsize=[this.offsetWidth,this.offsetHeight]})}else{ai.color=o.getRGB(am.fill).hex;ai.src=t;ai.type="solid";if(o.getRGB(am.fill).error&&(au.type in {circle:1,ellipse:1}||I(am.fill).charAt()!="r")&&a(au,am.fill,ai)){aq.fill="none";aq.gradient=am.fill;ai.rotate=false}}}if("fill-opacity" in am||"opacity" in am){var Q=((+aq["fill-opacity"]+1||2)-1)*((+aq.opacity+1||2)-1)*((+o.getRGB(am.fill).o+1||2)-1);Q=G(L(Q,0),1);ai.opacity=Q;if(ai.src){ai.color="none"}}ah.appendChild(ai);var V=(ah.getElementsByTagName("stroke")&&ah.getElementsByTagName("stroke")[0]),ar=false;!V&&(ar=V=J("stroke"));if((am.stroke&&am.stroke!="none")||am["stroke-width"]||am["stroke-opacity"]!=null||am["stroke-dasharray"]||am["stroke-miterlimit"]||am["stroke-linejoin"]||am["stroke-linecap"]){V.on=true}(am.stroke=="none"||am.stroke===null||V.on==null||am.stroke==0||am["stroke-width"]==0)&&(V.on=false);var ag=o.getRGB(am.stroke);V.on&&am.stroke&&(V.color=ag.hex);Q=((+aq["stroke-opacity"]+1||2)-1)*((+aq.opacity+1||2)-1)*((+ag.o+1||2)-1);var ad=(q(am["stroke-width"])||1)*0.75;Q=G(L(Q,0),1);am["stroke-width"]==null&&(ad=aq["stroke-width"]);am["stroke-width"]&&(V.weight=ad);ad&&ad<1&&(Q*=ad)&&(V.weight=1);V.opacity=Q;am["stroke-linejoin"]&&(V.joinstyle=am["stroke-linejoin"]||"miter");V.miterlimit=am["stroke-miterlimit"]||8;am["stroke-linecap"]&&(V.endcap=am["stroke-linecap"]=="butt"?"flat":am["stroke-linecap"]=="square"?"square":"round");if(am["stroke-dasharray"]){var af={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};V.dashstyle=af[f](am["stroke-dasharray"])?af[am["stroke-dasharray"]]:t}ar&&ah.appendChild(V)}if(au.type=="text"){au.paper.canvas.style.display=t;var aj=au.paper.span,ae=100,O=aq.font&&aq.font.match(/\d+(?:\.\d*)?(?=px)/);Y=aj.style;aq.font&&(Y.font=aq.font);aq["font-family"]&&(Y.fontFamily=aq["font-family"]);aq["font-weight"]&&(Y.fontWeight=aq["font-weight"]);aq["font-style"]&&(Y.fontStyle=aq["font-style"]);O=q(aq["font-size"]||O&&O[0])||10;Y.fontSize=O*ae+"px";au.textpath.string&&(aj.innerHTML=I(au.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var X=aj.getBoundingClientRect();au.W=aq.w=(X.right-X.left)/ae;au.H=aq.h=(X.bottom-X.top)/ae;au.X=aq.x;au.Y=aq.y+au.H/2;("x" in am||"y" in am)&&(au.path.v=o.format("m{0},{1}l{2},{1}",F(aq.x*b),F(aq.y*b),F(aq.x*b)+1));var W=["x","y","text","font","font-family","font-weight","font-style","font-size"];for(var al=0,an=W.length;al<an;al++){if(W[al] in am){au._.dirty=1;break}}switch(aq["text-anchor"]){case"start":au.textpath.style["v-text-align"]="left";au.bbx=au.W/2;break;case"end":au.textpath.style["v-text-align"]="right";au.bbx=-au.W/2;break;default:au.textpath.style["v-text-align"]="center";au.bbx=0;break}au.textpath.style["v-text-kern"]=true}},a=function(E,U,X){E.attrs=E.attrs||{};var V=E.attrs,O=Math.pow,P,Q,S="linear",T=".5 .5";E.attrs.gradient=U;U=I(U).replace(o._radial_gradient,function(aa,ab,Z){S="radial";if(ab&&Z){ab=q(ab);Z=q(Z);O(ab-0.5,2)+O(Z-0.5,2)>0.25&&(Z=i.sqrt(0.25-O(ab-0.5,2))*((Z>0.5)*2-1)+0.5);T=ab+n+Z}return t});U=U.split(/\s*\-\s*/);if(S=="linear"){var M=U.shift();M=-q(M);if(isNaN(M)){return null}}var R=o._parseDots(U);if(!R){return null}E=E.shape||E.node;if(R.length){E.removeChild(X);X.on=true;X.method="none";X.color=R[0].color;X.color2=R[R.length-1].color;var Y=[];for(var N=0,W=R.length;N<W;N++){R[N].offset&&Y.push(R[N].offset+n+R[N].color)}X.colors=Y.length?Y.join():"0% "+X.color;if(S=="radial"){X.type="gradientTitle";X.focus="100%";X.focussize="0 0";X.focusposition=T;X.angle=0}else{X.type="gradient";X.angle=(270-M)%360}E.appendChild(X)}return 1},x=function(M,E){this[0]=this.node=M;M.raphael=true;this.id=o._oid++;M.raphaelid=this.id;this.X=0;this.Y=0;this.attrs={};this.paper=E;this.matrix=o.matrix();this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1};!E.bottom&&(E.bottom=this);this.prev=E.top;E.top&&(E.top.next=this);E.top=this;this.next=null};var p=o.el;x.prototype=p;p.constructor=x;p.transform=function(P){if(P==null){return this._.transform}var R=this.paper._viewBoxShift,Q=R?"s"+[R.scale,R.scale]+"-1-1t"+[R.dx,R.dy]:t,U;if(R){U=P=I(P).replace(/\.{3}|\u2026/g,this._.transform||t)}o._extractTransform(this,Q+P);var V=this.matrix.clone(),X=this.skew,N=this.node,T,O=~I(this.attrs.fill).indexOf("-"),E=!I(this.attrs.fill).indexOf("url(");V.translate(-0.5,-0.5);if(E||O||this.type=="image"){X.matrix="1 0 0 1";X.offset="0 0";T=V.split();if((O&&T.noRotation)||!T.isSimple){N.style.filter=V.toFilter();var S=this.getBBox(),M=this.getBBox(1),Y=S.x-M.x,W=S.y-M.y;N.coordorigin=(Y*-b)+n+(W*-b);s(this,1,1,Y,W,0)}else{N.style.filter=t;s(this,T.scalex,T.scaley,T.dx,T.dy,T.rotate)}}else{N.style.filter=t;X.matrix=I(V);X.offset=V.offset()}U&&(this._.transform=U);return this};p.rotate=function(M,E,O){if(this.removed){return this}if(M==null){return}M=I(M).split(l);if(M.length-1){E=q(M[1]);O=q(M[2])}M=q(M[0]);(O==null)&&(E=O);if(E==null||O==null){var N=this.getBBox(1);E=N.x+N.width/2;O=N.y+N.height/2}this._.dirtyT=1;this.transform(this._.transform.concat([["r",M,E,O]]));return this};p.translate=function(M,E){if(this.removed){return this}M=I(M).split(l);if(M.length-1){E=q(M[1])}M=q(M[0])||0;E=+E||0;if(this._.bbox){this._.bbox.x+=M;this._.bbox.y+=E}this.transform(this._.transform.concat([["t",M,E]]));return this};p.scale=function(P,N,E,O){if(this.removed){return this}P=I(P).split(l);if(P.length-1){N=q(P[1]);E=q(P[2]);O=q(P[3]);isNaN(E)&&(E=null);isNaN(O)&&(O=null)}P=q(P[0]);(N==null)&&(N=P);(O==null)&&(E=O);if(E==null||O==null){var M=this.getBBox(1)}E=E==null?M.x+M.width/2:E;O=O==null?M.y+M.height/2:O;this.transform(this._.transform.concat([["s",P,N,E,O]]));this._.dirtyT=1;return this};p.hide=function(){!this.removed&&(this.node.style.display="none");return this};p.show=function(){!this.removed&&(this.node.style.display=t);return this};p._getBBox=function(){if(this.removed){return{}}return{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}};p.remove=function(){if(this.removed||!this.node.parentNode){return}this.paper.__set__&&this.paper.__set__.exclude(this);o.eve.unbind("raphael.*.*."+this.id);o._tear(this,this.paper);this.node.parentNode.removeChild(this.node);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var E in this){this[E]=typeof this[E]=="function"?o._removedFactory(E):null}this.removed=true};p.attr=function(E,U){if(this.removed){return this}if(E==null){var R={};for(var T in this.attrs){if(this.attrs[f](T)){R[T]=this.attrs[T]}}R.gradient&&R.fill=="none"&&(R.fill=R.gradient)&&delete R.gradient;R.transform=this._.transform;return R}if(U==null&&o.is(E,"string")){if(E==y&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}var S=E.split(l),O={};for(var P=0,W=S.length;P<W;P++){E=S[P];if(E in this.attrs){O[E]=this.attrs[E]}else{if(o.is(this.paper.customAttributes[E],"function")){O[E]=this.paper.customAttributes[E].def}else{O[E]=o._availableAttrs[E]}}}return W-1?O:O[S[0]]}if(this.attrs&&U==null&&o.is(E,"array")){O={};for(P=0,W=E.length;P<W;P++){O[E[P]]=this.attr(E[P])}return O}var M;if(U!=null){M={};M[E]=U}U==null&&o.is(E,"object")&&(M=E);for(var V in M){D("raphael.attr."+V+"."+this.id,this,M[V])}if(M){for(V in this.paper.customAttributes){if(this.paper.customAttributes[f](V)&&M[f](V)&&o.is(this.paper.customAttributes[V],"function")){var Q=this.paper.customAttributes[V].apply(this,[].concat(M[V]));this.attrs[V]=M[V];for(var N in Q){if(Q[f](N)){M[N]=Q[N]}}}}if(M.text&&this.type=="text"){this.textpath.string=M.text}A(this,M)}return this};p.toFront=function(){!this.removed&&this.node.parentNode.appendChild(this.node);this.paper&&this.paper.top!=this&&o._tofront(this,this.paper);return this};p.toBack=function(){if(this.removed){return this}if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild);o._toback(this,this.paper)}return this};p.insertAfter=function(E){if(this.removed){return this}if(E.constructor==o.st.constructor){E=E[E.length-1]}if(E.node.nextSibling){E.node.parentNode.insertBefore(this.node,E.node.nextSibling)}else{E.node.parentNode.appendChild(this.node)}o._insertafter(this,E,this.paper);return this};p.insertBefore=function(E){if(this.removed){return this}if(E.constructor==o.st.constructor){E=E[0]}E.node.parentNode.insertBefore(this.node,E.node);o._insertbefore(this,E,this.paper);return this};p.blur=function(E){var M=this.node.runtimeStyle,N=M.filter;N=N.replace(w,t);if(+E!==0){this.attrs.blur=E;M.filter=N+n+z+".Blur(pixelradius="+(+E||1.5)+")";M.margin=o.format("-{0}px 0 0 -{0}px",F(+E||1.5))}else{M.filter=N;M.margin=0;delete this.attrs.blur}};o._engine.path=function(O,M){var P=J("shape");P.style.cssText=e;P.coordsize=b+n+b;P.coordorigin=M.coordorigin;var Q=new x(P,M),E={fill:"none",stroke:"#000"};O&&(E.path=O);Q.type="path";Q.path=[];Q.Path=t;A(Q,E);M.canvas.appendChild(P);var N=J("skew");N.on=true;P.appendChild(N);Q.skew=N;Q.transform(t);return Q};o._engine.rect=function(M,R,P,S,N,E){var T=o._rectPath(R,P,S,N,E),O=M.path(T),Q=O.attrs;O.X=Q.x=R;O.Y=Q.y=P;O.W=Q.width=S;O.H=Q.height=N;Q.r=E;Q.path=T;O.type="rect";return O};o._engine.ellipse=function(M,E,R,Q,P){var O=M.path(),N=O.attrs;O.X=E-Q;O.Y=R-P;O.W=Q*2;O.H=P*2;O.type="ellipse";A(O,{cx:E,cy:R,rx:Q,ry:P});return O};o._engine.circle=function(M,E,Q,P){var O=M.path(),N=O.attrs;O.X=E-P;O.Y=Q-P;O.W=O.H=P*2;O.type="circle";A(O,{cx:E,cy:Q,r:P});return O};o._engine.image=function(M,E,S,Q,T,O){var V=o._rectPath(S,Q,T,O),P=M.path(V).attr({stroke:"none"}),R=P.attrs,N=P.node,U=N.getElementsByTagName(y)[0];R.src=E;P.X=R.x=S;P.Y=R.y=Q;P.W=R.width=T;P.H=R.height=O;R.path=V;P.type="image";U.parentNode==N&&N.removeChild(U);U.rotate=true;U.src=E;U.type="tile";P._.fillpos=[S,Q];P._.fillsize=[T,O];N.appendChild(U);s(P,1,1,0,0,0);return P};o._engine.text=function(E,R,Q,S){var O=J("shape"),U=J("path"),N=J("textpath");R=R||0;Q=Q||0;S=S||"";U.v=o.format("m{0},{1}l{2},{1}",F(R*b),F(Q*b),F(R*b)+1);U.textpathok=true;N.string=I(S);N.on=true;O.style.cssText=e;O.coordsize=b+n+b;O.coordorigin="0 0";var M=new x(O,E),P={fill:"#000",stroke:"none",font:o._availableAttrs.font,text:S};M.shape=O;M.path=U;M.textpath=N;M.type="text";M.attrs.text=I(S);M.attrs.x=R;M.attrs.y=Q;M.attrs.w=1;M.attrs.h=1;A(M,P);O.appendChild(N);O.appendChild(U);E.canvas.appendChild(O);var T=J("skew");T.on=true;O.appendChild(T);M.skew=T;M.transform(t);return M};o._engine.setSize=function(N,E){var M=this.canvas.style;this.width=N;this.height=E;N==+N&&(N+="px");E==+E&&(E+="px");M.width=N;M.height=E;M.clip="rect(0 "+N+" "+E+" 0)";if(this._viewBox){o._engine.setViewBox.apply(this,this._viewBox)}return this};o._engine.setViewBox=function(Q,P,R,N,O){o.eve("raphael.setViewBox",this,this._viewBox,[Q,P,R,N,O]);var E=this.width,T=this.height,U=1/L(R/E,N/T),S,M;if(O){S=T/N;M=E/R;if(R*S<E){Q-=(E-R*S)/2/S}if(N*M<T){P-=(T-N*M)/2/M}}this._viewBox=[Q,P,R,N,!!O];this._viewBoxShift={dx:-Q,dy:-P,scale:U};this.forEach(function(V){V.transform("...")});return this};var J;o._engine.initWin=function(N){var M=N.document;M.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!M.namespaces.rvml&&M.namespaces.add("rvml","urn:schemas-microsoft-com:vml");J=function(O){return M.createElement("<rvml:"+O+' class="rvml">')}}catch(E){J=function(O){return M.createElement("<"+O+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}};o._engine.initWin(o._g.win);o._engine.create=function(){var N=o._getContainer.apply(0,arguments),E=N.container,T=N.height,U,M=N.width,S=N.x,R=N.y;if(!E){throw new Error("VML container not found.")}var P=new o._Paper,Q=P.canvas=o._g.doc.createElement("div"),O=Q.style;S=S||0;R=R||0;M=M||512;T=T||342;P.width=M;P.height=T;M==+M&&(M+="px");T==+T&&(T+="px");P.coordsize=b*1000+n+b*1000;P.coordorigin="0 0";P.span=o._g.doc.createElement("span");P.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;";Q.appendChild(P.span);O.cssText=o.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",M,T);if(E==1){o._g.doc.body.appendChild(Q);O.left=S+"px";O.top=R+"px";O.position="absolute"}else{if(E.firstChild){E.insertBefore(Q,E.firstChild)}else{E.appendChild(Q)}}P.renderfix=function(){};return P};o.prototype.clear=function(){o.eve("raphael.clear",this);this.canvas.innerHTML=t;this.span=o._g.doc.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas.appendChild(this.span);this.bottom=this.top=null};o.prototype.remove=function(){o.eve("raphael.remove",this);this.canvas.parentNode.removeChild(this.canvas);for(var E in this){this[E]=typeof this[E]=="function"?o._removedFactory(E):null}return true};var B=o.st;for(var h in p){if(p[f](h)&&!B[f](h)){B[h]=(function(E){return function(){var M=arguments;return this.forEach(function(N){N[E].apply(N,M)})}})(h)}}}(window.Raphael);(function(){window.ScaleRaphael=function(c,f,b){var h=(typeof c=="string")?document.getElementById(c):c;if(!h.style.position){h.style.position="relative"}h.style.width=f+"px";h.style.height=b+"px";h.style.overflow="hidden";var e;if(Raphael.type=="VML"){h.innerHTML="<rvml:group style='position : absolute; width: 1000px; height: 1000px; top: 0px; left: 0px' coordsize='1000,1000' class='rvml' id='vmlgroup'></rvml:group>";e=document.getElementById("vmlgroup")}else{h.innerHTML="<div id='svggroup'></div>";e=document.getElementById("svggroup")}var g=new Raphael(e,f,b);var a;if(Raphael.type=="SVG"){g.canvas.setAttribute("viewBox","0 0 "+f+" "+b)}else{a=h.getElementsByTagName("div")[0]}g.changeSize=function(y,t,m,n){n=!n;var v=y/f;var p=t/b;var o=v<p?v:p;var l=parseInt(b*o);var s=parseInt(f*o);if(Raphael.type=="VML"){var r=document.getElementsByTagName("textpath");for(var q in r){var z=r[q];if(z.style){if(!z._fontSize){var x=z.style.font.split("px");z._fontSize=parseInt(x[0]);z._font=x[1]}z.style.font=z._fontSize*o+"px"+z._font}}var u;if(s<l){u=s*1000/f}else{u=l*1000/b}u=parseInt(u);e.style.width=u+"px";e.style.height=u+"px";if(n){e.style.left=parseInt((y-s)/2)+"px";e.style.top=parseInt((t-l)/2)+"px"}a.style.overflow="visible"}if(n){s=y;l=t}h.style.width=s+"px";h.style.height=l+"px";g.setSize(s,l);if(m){h.style.position="absolute";h.style.left=parseInt((y-s)/2)+"px";h.style.top=parseInt((t-l)/2)+"px"}};g.scaleAll=function(i){g.changeSize(f*i,b*i)};g.changeSize(f,b);g.w=f;g.h=b;return g}})();if(typeof exports==="undefined"){exports={}}if(typeof require!=="function"){require=function(a){return exports}}(function(){var E=function(aC){var aE=arguments[0],aB=1,aD=arguments[aB];while(aD){aE=aE.slice(0,-1)+aD.slice(1);aD=arguments[++aB]}return aE},u=function(aB){return"(?:"+aB+")"},c="[A-Za-z]",L="[\\x0D]",g="[0-9]",ae="[\\x22]",ar=E(g,"[A-Fa-f]"),ah="[\\x0A]",ab="[\\x20]",aj=u("%"+ar+ar),at="[\\:\\/\\?\\#\\[\\]\\@]",ak="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",I=E(at,ak),P=E(c,g,"[\\-\\.\\_\\~]"),e=u(c+E(c,g,"[\\+\\-\\.]")+"*"),o=u(u(aj+"|"+E(P,ak,"[\\:]"))+"*"),T=u(u("25[0-5]")+"|"+u("2[0-4]"+g)+"|"+u("1"+g+g)+"|"+u("[1-9]"+g)+"|"+g),aq=u(T+"\\."+T+"\\."+T+"\\."+T),K=u(ar+"{1,4}"),av=u(u(K+"\\:"+K)+"|"+aq),ao=u(E(P,ak,"[\\:]")+"+"),Q=u("v"+ar+"+\\."+E(P,ak,"[\\:]")+"+"),ap=u("\\["+u(ao+"|"+Q)+"\\]"),aA=u(u(aj+"|"+E(P,ak))+"*"),f=u(ap+"|"+aq+"|"+aA),X=u(g+"*"),i=u(u(o+"@")+"?"+f+u("\\:"+X)+"?"),q=u(aj+"|"+E(P,ak,"[\\:\\@]")),V=u(q+"*"),ai=u(q+"+"),ag=u(u(aj+"|"+E(P,ak,"[\\@]"))+"+"),a=u(u("\\/"+V)+"*"),p=u("\\/"+u(ai+a)+"?"),aw=u(ag+a),az=u(ai+a),b=u(""),l=u(a+"|"+p+"|"+aw+"|"+az+"|"+b),r=u(u(q+"|[\\/\\?]")+"*"),W=u(u(q+"|[\\/\\?]")+"*"),au=u(u("\\/\\/"+i+a)+"|"+p+"|"+az+"|"+b),Z=u(e+"\\:"+au+u("\\?"+r)+"?"+u("\\#"+W)+"?"),O=u(u("\\/\\/"+i+a)+"|"+p+"|"+aw+"|"+b),t=u(O+u("\\?"+r)+"?"+u("\\#"+W)+"?"),v=u(Z+"|"+t),ax=u(e+"\\:"+au+u("\\?"+r)+"?"),s=new RegExp("^"+u("("+Z+")|("+t+")")+"$"),an=new RegExp("^("+e+")\\:"+u(u("\\/\\/("+u("("+o+")@")+"?("+f+")"+u("\\:("+X+")")+"?)")+"?("+a+"|"+p+"|"+az+"|"+b+")")+u("\\?("+r+")")+"?"+u("\\#("+W+")")+"?$"),M=new RegExp("^(){0}"+u(u("\\/\\/("+u("("+o+")@")+"?("+f+")"+u("\\:("+X+")")+"?)")+"?("+a+"|"+p+"|"+aw+"|"+b+")")+u("\\?("+r+")")+"?"+u("\\#("+W+")")+"?$"),F=new RegExp("^("+e+")\\:"+u(u("\\/\\/("+u("("+o+")@")+"?("+f+")"+u("\\:("+X+")")+"?)")+"?("+a+"|"+p+"|"+az+"|"+b+")")+u("\\?("+r+")")+"?$"),N=new RegExp("^"+u("\\#("+W+")")+"?$"),G=new RegExp("^"+u("("+o+")@")+"?("+f+")"+u("\\:("+X+")")+"?$"),al=new RegExp(E("[^]",c,g,"[\\+\\-\\.]"),"g"),aa=new RegExp(E("[^\\%\\:]",P,ak),"g"),ay=new RegExp(E("[^\\%]",P,ak),"g"),R=new RegExp(E("[^\\%\\/\\:\\@]",P,ak),"g"),Y=new RegExp(E("[^\\%\\/\\@]",P,ak),"g"),B=new RegExp(E("[^\\%]",P,ak,"[\\:\\@\\/\\?]"),"g"),J=B,U=new RegExp(E("[^]",P,ak),"g"),H=new RegExp(P,"g"),w=new RegExp(E("[^\\%]",P,I),"g"),S=new RegExp(aj+"+","g"),n=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?([^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/i,D=/^\.\.?\//,C=/^\/\.(\/|$)/,A=/^\/\.\.(\/|$)/,y=/^\.\.?$/,x=/^\/?.*?(?=\/|$)/,z=("").match(/(){0}/)[1]===undefined,m=function(aB){var aC=aB.charCodeAt(0);if(aC<128){return"%"+aC.toString(16).toUpperCase()}else{if((aC>127)&&(aC<2048)){return"%"+((aC>>6)|192).toString(16).toUpperCase()+"%"+((aC&63)|128).toString(16).toUpperCase()}else{return"%"+((aC>>12)|224).toString(16).toUpperCase()+"%"+(((aC>>6)&63)|128).toString(16).toUpperCase()+"%"+((aC&63)|128).toString(16).toUpperCase()}}},am=function(aE){var aB="",aC=0,aF,aD;while(aC<aE.length){aF=parseInt(aE.substr(aC+1,2),16);if(aF<128){aD=String.fromCharCode(aF);if(aD.match(H)){aB+=aD}else{aB+=aE.substr(aC,3)}aC+=3}else{if((aF>191)&&(aF<224)){aB+=aE.substr(aC,6);aC+=6}else{aB+=aE.substr(aC,9);aC+=9}}}return aB},h=function(aF){var aC="",aE=0,aG,aD,aB;while(aE<aF.length){aG=parseInt(aF.substr(aE+1,2),16);if(aG<128){aC+=String.fromCharCode(aG);aE+=3}else{if((aG>191)&&(aG<224)){aD=parseInt(aF.substr(aE+4,2),16);aC+=String.fromCharCode(((aG&31)<<6)|(aD&63));aE+=6}else{aD=parseInt(aF.substr(aE+4,2),16);aB=parseInt(aF.substr(aE+7,2),16);aC+=String.fromCharCode(((aG&15)<<12)|((aD&63)<<6)|(aB&63));aE+=9}}}return aC},ad=function(aB){return aB===undefined?"undefined":(aB===null?"null":Object.prototype.toString.call(aB).split(" ").pop().split("]").shift().toLowerCase())},af=function(){this.errors=[]},ac=exports;af.prototype={scheme:undefined,authority:undefined,userinfo:undefined,host:undefined,port:undefined,path:undefined,query:undefined,fragment:undefined,reference:undefined,errors:undefined};ac.SCHEMES={};ac.parse=function(aF,aB){var aE,aD=new af(),aC;aF=aF?aF.toString():"";aB=aB||{};if(aB.reference==="suffix"){aF=(aB.scheme?aB.scheme+":":"")+"//"+aF}aE=aF.match(s);if(aE){if(aE[1]){aE=aF.match(an)}else{aE=aF.match(M)}}if(!aE){if(!aB.tolerant){aD.errors.push("URI is not strictly valid.")}aE=aF.match(n)}if(aE){if(z){aD.scheme=aE[1];aD.authority=aE[2];aD.userinfo=aE[3];aD.host=aE[4];aD.port=parseInt(aE[5],10);aD.path=aE[6]||"";aD.query=aE[7];aD.fragment=aE[8];if(isNaN(aD.port)){aD.port=aE[5]}}else{aD.scheme=aE[1]||undefined;aD.authority=(aF.indexOf("//")!==-1?aE[2]:undefined);aD.userinfo=(aF.indexOf("@")!==-1?aE[3]:undefined);aD.host=(aF.indexOf("//")!==-1?aE[4]:undefined);aD.port=parseInt(aE[5],10);aD.path=aE[6]||"";aD.query=(aF.indexOf("?")!==-1?aE[7]:undefined);aD.fragment=(aF.indexOf("#")!==-1?aE[8]:undefined);if(isNaN(aD.port)){aD.port=(aF.match(/\/\/.*\:(?:\/|\?|\#|$)/)?aE[4]:undefined)}}if(!aD.scheme&&!aD.authority&&!aD.path&&!aD.query){aD.reference="same-document"}else{if(!aD.scheme){aD.reference="relative"}else{if(!aD.fragment){aD.reference="absolute"}else{aD.reference="uri"}}}if(aB.reference&&aB.reference!=="suffix"&&aB.reference!==aD.reference){aD.errors.push("URI is not a "+aB.reference+" reference.")}aC=ac.SCHEMES[(aD.scheme||aB.scheme||"").toLowerCase()];if(aC&&aC.parse){aC.parse(aD,aB)}}else{aD.errors.push("URI can not be parsed.")}return aD};ac._recomposeAuthority=function(aC){var aB=[];if(aC.userinfo!==undefined||aC.host!==undefined||typeof aC.port==="number"){if(aC.userinfo!==undefined){aB.push(aC.userinfo.toString().replace(aa,m));aB.push("@")}if(aC.host!==undefined){aB.push(aC.host.toString().toLowerCase().replace(ay,m))}if(typeof aC.port==="number"){aB.push(":");aB.push(aC.port.toString(10))}}return aB.length?aB.join(""):undefined};ac.removeDotSegments=function(aC){var aB=[],aD;while(aC.length){if(aC.match(D)){aC=aC.replace(D,"")}else{if(aC.match(C)){aC=aC.replace(C,"/")}else{if(aC.match(A)){aC=aC.replace(A,"/");aB.pop()}else{if(aC==="."||aC===".."){aC=""}else{aD=aC.match(x)[0];aC=aC.slice(aD.length);aB.push(aD)}}}}}return aB.join("")};ac.serialize=function(aF,aB){var aD=[],aC,aE;aB=aB||{};aC=ac.SCHEMES[aF.scheme||aB.scheme];if(aC&&aC.serialize){aC.serialize(aF,aB)}if(aB.reference!=="suffix"&&aF.scheme){aD.push(aF.scheme.toString().toLowerCase().replace(al,""));aD.push(":")}aF.authority=ac._recomposeAuthority(aF);if(aF.authority!==undefined){if(aB.reference!=="suffix"){aD.push("//")}aD.push(aF.authority);if(aF.path&&aF.path.charAt(0)!=="/"){aD.push("/")}}if(aF.path){aE=ac.removeDotSegments(aF.path.toString().replace(/%2E/ig,"."));if(aF.scheme){aE=aE.replace(R,m)}else{aE=aE.replace(Y,m)}if(aF.authority===undefined){aE=aE.replace(/^\/\//,"/%2F")}aD.push(aE)}if(aF.query){aD.push("?");aD.push(aF.query.toString().replace(B,m))}if(aF.fragment){aD.push("#");aD.push(aF.fragment.toString().replace(J,m))}return aD.join("").replace(S,am).replace(/%[0-9A-Fa-f]{2}/g,function(aG){return aG.toUpperCase()})};ac.resolveComponents=function(aD,aC,aB,aF){var aE=new af();if(!aF){aD=ac.parse(ac.serialize(aD,aB),aB);aC=ac.parse(ac.serialize(aC,aB),aB)}aB=aB||{};if(!aB.tolerant&&aC.scheme){aE.scheme=aC.scheme;aE.authority=aC.authority;aE.userinfo=aC.userinfo;aE.host=aC.host;aE.port=aC.port;aE.path=ac.removeDotSegments(aC.path);aE.query=aC.query}else{if(aC.authority!==undefined){aE.authority=aC.authority;aE.userinfo=aC.userinfo;aE.host=aC.host;aE.port=aC.port;aE.path=ac.removeDotSegments(aC.path);aE.query=aC.query}else{if(!aC.path){aE.path=aD.path;if(aC.query!==undefined){aE.query=aC.query}else{aE.query=aD.query}}else{if(aC.path.charAt(0)==="/"){aE.path=ac.removeDotSegments(aC.path)}else{if(aD.authority!==undefined&&!aD.path){aE.path="/"+aC.path}else{if(!aD.path){aE.path=aC.path}else{aE.path=aD.path.slice(0,aD.path.lastIndexOf("/")+1)+aC.path}}aE.path=ac.removeDotSegments(aE.path)}aE.query=aC.query}aE.authority=aD.authority;aE.userinfo=aD.userinfo;aE.host=aD.host;aE.port=aD.port}aE.scheme=aD.scheme}aE.fragment=aC.fragment;return aE};ac.resolve=function(aD,aC,aB){return ac.serialize(ac.resolveComponents(ac.parse(aD,aB),ac.parse(aC,aB),aB,true),aB)};ac.normalize=function(aC,aB){if(typeof aC==="string"){return ac.serialize(ac.parse(aC,aB),aB)}else{if(ad(aC)==="object"){return ac.parse(ac.serialize(aC,aB),aB)}}return aC};ac.equal=function(aD,aC,aB){if(typeof aD==="string"){aD=ac.serialize(ac.parse(aD,aB),aB)}else{if(ad(aD)==="object"){aD=ac.serialize(aD,aB)}}if(typeof aC==="string"){aC=ac.serialize(ac.parse(aC,aB),aB)}else{if(ad(aC)==="object"){aC=ac.serialize(aC,aB)}}return aD===aC};ac.escapeComponent=function(aB){return aB&&aB.toString().replace(U,m)};ac.unescapeComponent=function(aB){return aB&&aB.toString().replace(S,h)};exports.pctEncChar=m;exports.pctDecChars=h;exports.Components=af;exports.URI=ac;exports.pctEncChar=m;exports.pctDecChars=h;exports.Components=af;exports.URI={SCHEMES:ac.SCHEMES,parse:ac.parse,removeDotSegments:ac.removeDotSegments,serialize:ac.serialize,resolveComponents:ac.resolveComponents,resolve:ac.resolve,normalize:ac.normalize,equal:ac.equal,escapeComponent:ac.escapeComponent,unescapeComponent:ac.unescapeComponent}}());(function(){var m=require("../uri"),i=m.URI,o=m.pctEncChar,b="(?:[0-9A-Za-z][0-9A-Za-z\\-]{1,31})",e="(?:\\%[0-9A-Fa-f]{2})",f="[0-9A-Za-z\\(\\)\\+\\,\\-\\.\\:\\=\\@\\;\\$\\_\\!\\*\\'\\/\\?\\#]",a="(?:(?:"+e+"|"+f+")+)",l=new RegExp("^urn\\:("+b+")$"),g=new RegExp("^("+b+")\\:("+a+")$"),c=/^([^\:]+)\:(.*)/,h=/[\x00-\x20\\\"\&\<\>\[\]\^\`\{\|\}\~\x7F-\xFF]/g,n=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/;i.SCHEMES.urn={parse:function(s,q){var t=s.path.match(g),p,r;if(!t){if(!q.tolerant){s.errors.push("URN is not strictly valid.")}t=s.path.match(c)}if(t){p="urn:"+t[1].toLowerCase();r=i.SCHEMES[p];if(!r){r=i.SCHEMES[p]={}}if(!r.serialize){r.serialize=i.SCHEMES.urn.serialize}s.scheme=p;s.path=t[2];if(r.parse){r.parse(s,q)}}else{s.errors.push("URN can not be parsed.")}return s},serialize:function(r,q){var p=r.scheme||q.scheme,s;if(p&&p!=="urn"){var s=p.match(l);if(!s){s=["urn:"+p,p]}r.scheme="urn";r.path=s[1]+":"+(r.path?r.path.replace(h,o):"")}return r}};i.SCHEMES["urn:uuid"]={serialize:function(q,p){if(!p.tolerant&&(!q.path||!q.path.match(n))){q.scheme=undefined}return i.SCHEMES.urn.serialize(q,p)}}}());var exports=exports||this,require=require||function(){return exports};(function(){var l=require("./uri/uri").URI,f={},D="0123456789abcdef".split(""),n,r,C,h;function e(E){return E===undefined?"undefined":(E===null?"null":Object.prototype.toString.call(E).split(" ").pop().split("]").shift().toLowerCase())}function o(){}function w(E){o.prototype=E||{};return new o()}function b(I,H,G){var E={},F;for(F in I){if(I[F]!==f[F]){E[F]=H.call(G,I[F],F,I)}}return E}n=function(F,I,H){var E=0,J=F.length,G=new Array(J);for(;E<J;++E){G[E]=I.call(H,F[E],E,F)}return G};if(Array.prototype.map){n=function(E,G,F){return Array.prototype.map.call(E,G,F)}}r=function(F,I,H){var E=0,J=F.length,G=[];for(;E<J;++E){if(I.call(H,F[E],E,F)){G[G.length]=F[E]}}return G};if(Array.prototype.filter){r=function(E,G,F){return Array.prototype.filter.call(E,G,F)}}C=function(F,G){var E=0,H=F.length;for(;E<H;++E){if(F[E]===G){return E}}return -1};if(Array.prototype.indexOf){C=function(E,F){return Array.prototype.indexOf.call(E,F)}}function y(E){return E!==undefined&&E!==null?(E instanceof Array&&!E.callee?E:(typeof E.length!=="number"||E.split||E.setInterval||E.call?[E]:Array.prototype.slice.call(E))):[]}function q(G){var E=[],F;switch(e(G)){case"object":for(F in G){if(G[F]!==f[F]){E[E.length]=F}}break;case"array":for(F=G.length-1;F>=0;--F){E[F]=F}break}return E}function g(E,F){if(C(E,F)===-1){E.push(F)}return E}function s(E,G){var F=C(E,G);if(F>-1){E.splice(F,1)}return E}function x(){return[D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],"-",D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],"-4",D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],"-",D[(Math.floor(Math.random()*16)&3)|8],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],"-",D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)]].join("")}function A(E){return encodeURIComponent(E).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")}function a(E){if(typeof E==="string"&&E.indexOf("#")===-1){E+="#"}return E}function v(E){if(E instanceof z){return E.getURI()}switch(e(E)){case"undefined":case"null":case"boolean":case"number":case"string":return E;case"object":return b(E,v);case"array":return n(E,v);default:return E.toString()}}function c(F,I,E,H,G){Error.call(this,H);this.uri=F instanceof z?F.getURI():F;this.schemaUri=I instanceof z?I.getURI():I;this.attribute=E;this.message=H;this.description=H;this.details=G}c.prototype=new Error();c.prototype.constructor=c;c.prototype.name="InitializationError";function t(){this.errors=[];this.validated={}}t.prototype.addError=function(F,I,E,H,G){this.errors.push({uri:F instanceof z?F.getURI():F,schemaUri:I instanceof z?I.getURI():I,attribute:E,message:H,details:v(G)})};t.prototype.registerValidation=function(F,E){if(!this.validated[F]){this.validated[F]=[E]}else{this.validated[F].push(E)}};t.prototype.isValidatedBy=function(F,E){return !!this.validated[F]&&C(this.validated[F],E)!==-1};function z(G,F,H,E){if(F instanceof z){if(typeof E!=="string"){E=F._fd}if(typeof H!=="string"){H=F._uri}F=F._value}if(typeof H!=="string"){H="urn:uuid:"+x()+"#"}else{if(H.indexOf(":")===-1){H=a(l.resolve("urn:uuid:"+x()+"#",H))}}this._env=G;this._value=F;this._uri=H;this._fd=E||this._env._options.defaultFragmentDelimiter}z.prototype.getEnvironment=function(){return this._env};z.prototype.getType=function(){return e(this._value)};z.prototype.getValue=function(){return this._value};z.prototype.getURI=function(){return this._uri};z.prototype.resolveURI=function(E){return a(l.resolve(this._uri,E))};z.prototype.getPropertyNames=function(){return q(this._value)};z.prototype.getProperty=function(E){var F=this._value?this._value[E]:undefined;if(F instanceof z){return F}return new z(this._env,F,this._uri+this._fd+A(E),this._fd)};z.prototype.getProperties=function(){var F=e(this._value),E=this;if(F==="object"){return b(this._value,function(H,G){if(H instanceof z){return H}return new z(E._env,H,E._uri+E._fd+A(G),E._fd)})}else{if(F==="array"){return n(this._value,function(H,G){if(H instanceof z){return H}return new z(E._env,H,E._uri+E._fd+A(G),E._fd)})}}};z.prototype.getValueOfProperty=function(E){if(this._value){if(this._value[E] instanceof z){return this._value[E]._value}return this._value[E]}};z.prototype.equals=function(E){if(E instanceof z){return this._value===E._value}return this._value===E};function B(H,F){var G,E;if(H instanceof z){H=H.getValue()}switch(e(H)){case"object":if(F){G={};for(E in H){if(H[E]!==f[E]){G[E]=B(H[E],F)}}return G}else{return w(H)}break;case"array":if(F){G=new Array(H.length);E=H.length;while(--E>=0){G[E]=B(H[E],F)}return G}else{return Array.prototype.slice.call(H)}break;default:return H}}function u(G,F,I,H){var E;z.call(this,G,F,I);if(H===true){this._schema=this}else{if(F instanceof u&&!(H instanceof u)){this._schema=F._schema}else{this._schema=H instanceof u?H:this._env.getDefaultSchema()||this._env.createEmptySchema()}}E=this._schema.getValueOfProperty("fragmentResolution");if(E==="dot-delimited"){this._fd="."}else{if(E==="slash-delimited"){this._fd="/"}}return this.rebuild()}u.prototype=w(z.prototype);u.prototype.getSchema=function(){var E=this._refs&&this._refs.describedby,F;if(E){F=E&&this._env.findSchema(E);if(F){if(!F.equals(this._schema)){this._schema=F;this.rebuild()}}else{if(this._env._options.enforceReferences){throw new c(this,this._schema,"{describedby}","Unknown schema reference",E)}}}return this._schema};u.prototype.getAttribute=function(H,G){var F,K,J,E,I=this.getSchema();if(!G&&this._attributes&&this._attributes.hasOwnProperty(H)){return this._attributes[H]}F=I.getProperty("properties").getProperty(H);K=F.getValueOfProperty("parser");J=this.getProperty(H);if(typeof K==="function"){E=K(J,F,G);if(!G&&this._attributes){this._attributes[H]=E}return E}return J.getValue()};u.prototype.getAttributes=function(){var G,I,F,E,J,H=this.getSchema();if(!this._attributes&&this.getType()==="object"){G=this.getProperties();I=H.getProperty("properties");this._attributes={};for(F in G){if(G[F]!==f[F]){E=I&&I.getProperty(F);J=E&&E.getValueOfProperty("parser");if(typeof J==="function"){this._attributes[F]=J(G[F],E)}else{this._attributes[F]=G[F].getValue()}}}}return B(this._attributes,false)};u.prototype.getLink=function(F,E){var G=this.getAttribute("links",[F,E]);if(G&&G.length&&G[G.length-1]){return G[G.length-1]}};u.prototype.validate=function(E,G,J,K,H){var F=this.getSchema(),I=F.getValueOfProperty("validator");if(!(E instanceof z)){E=this.getEnvironment().createInstance(E)}if(!(G instanceof t)){G=new t()}if(this._env._options.validateReferences&&this._refs){if(this._refs.describedby&&!this._env.findSchema(this._refs.describedby)){G.addError(this,this._schema,"{describedby}","Unknown schema reference",this._refs.describedby)}if(this._refs.full&&!this._env.findSchema(this._refs.full)){G.addError(this,this._schema,"{full}","Unknown schema reference",this._refs.full)}}if(typeof I==="function"&&!G.isValidatedBy(E.getURI(),this.getURI())){G.registerValidation(E.getURI(),this.getURI());I(E,this,F,G,J,K,H)}return G};function i(F){return function E(){var H=this,G=[],J=H._refs&&H._refs.full,I;while(J){I=H._env.findSchema(J);if(I){if(I._value===H._value){break}H=I;G.push(J);J=H._refs&&H._refs.full;if(G.indexOf(J)>-1){break}}else{if(H._env._options.enforceReferences){throw new c(H,H._schema,"{full}","Unknown schema reference",J)}else{J=null}}}return F.apply(H,arguments)}}(function(){var E;for(E in u.prototype){if(u.prototype[E]!==f[E]&&e(u.prototype[E])==="function"){u.prototype[E]=i(u.prototype[E])}}}());u.prototype.rebuild=function(){var E=this,F=E.getSchema().getValueOfProperty("initializer");E._refs=null;E._attributes=null;if(typeof F==="function"){E=F(E)}E._env._schemas[E._uri]=E;E.getAttributes();return E};u.prototype.setReference=function(E,F){if(!this._refs){this._refs={}}this._refs[E]=this.resolveURI(F)};u.prototype.getReference=function(E){return this._refs&&this._refs[E]};function m(I,F,K){var H=e(I),G=e(F),J,E;if(G==="undefined"){return B(I,true)}else{if(H==="undefined"||G!==H){return B(F,true)}else{if(G==="object"){if(I instanceof u){I=I.getAttributes()}if(F instanceof u){F=F.getAttributes();if(F["extends"]&&K&&F["extends"] instanceof u){F["extends"]=[F["extends"]]}}J=B(I,true);for(E in F){if(F[E]!==f[E]){J[E]=m(I[E],F[E],K)}}return J}else{return B(F,true)}}}}function p(){this._id=x();this._schemas={};this._options={};this.createSchema({},true,"urn:jsv:empty-schema#")}p.prototype.clone=function(){var E=new p();E._schemas=w(this._schemas);E._options=w(this._options);return E};p.prototype.createInstance=function(F,E){E=a(E);if(F instanceof z&&(!E||F.getURI()===E)){return F}return new z(this,F,E)};p.prototype.createSchema=function(G,F,E){E=a(E);if(G instanceof u&&(!E||G._uri===E)&&(!F||G.getSchema().equals(F))){return G}return new u(this,G,E,F)};p.prototype.createEmptySchema=function(){return this._schemas["urn:jsv:empty-schema#"]};p.prototype.findSchema=function(E){return this._schemas[a(E)]};p.prototype.setOption=function(E,F){this._options[E]=F};p.prototype.getOption=function(E){return this._options[E]};p.prototype.setDefaultFragmentDelimiter=function(E){if(typeof E==="string"&&E.length>0){this._options.defaultFragmentDelimiter=E}};p.prototype.getDefaultFragmentDelimiter=function(){return this._options.defaultFragmentDelimiter};p.prototype.setDefaultSchemaURI=function(E){if(typeof E==="string"){this._options.defaultSchemaURI=a(E)}};p.prototype.getDefaultSchema=function(){return this.findSchema(this._options.defaultSchemaURI)};p.prototype.validate=function(L,K){var E,H,G,F=new t();try{E=this.createInstance(L);F.instance=E}catch(J){F.addError(J.uri,J.schemaUri,J.attribute,J.message,J.details)}try{H=this.createSchema(K);F.schema=H;G=H.getSchema();F.schemaSchema=G}catch(I){F.addError(I.uri,I.schemaUri,I.attribute,I.message,I.details)}if(G){G.validate(H,F)}if(F.errors.length){return F}return H.validate(E,F)};p.prototype._checkForInvalidInstances=function(K,G){var N=[],I=[[G,this._schemas[G]]],E=0,M,F,L,H,J;while(E++<K&&I.length){M=I.shift();F=M[0];L=M[1];if(L instanceof u){if(this._schemas[L._uri]!==L){N.push("Instance "+F+" does not match "+L._uri)}else{H=L.getAttributes();for(J in H){if(H[J]!==f[J]){I.push([F+"/"+A(J),H[J]])}}}}else{if(e(L)==="object"){H=L;for(J in H){if(H.hasOwnProperty(J)){I.push([F+"/"+A(J),H[J]])}}}else{if(e(L)==="array"){H=L;for(J=0;J<H.length;++J){I.push([F+"/"+A(J),H[J]])}}}}}return N.length?N:E};h={_environments:{},_defaultEnvironmentID:"",isJSONInstance:function(E){return E instanceof z},isJSONSchema:function(E){return E instanceof u},createEnvironment:function(E){E=E||this._defaultEnvironmentID;if(!this._environments[E]){throw new Error("Unknown Environment ID")}return this._environments[E].clone()},Environment:p,registerEnvironment:function(F,E){F=F||(E||0)._id;if(F&&!this._environments[F]&&E instanceof p){E._id=F;this._environments[F]=E}},setDefaultEnvironmentID:function(E){if(typeof E==="string"){if(!this._environments[E]){throw new Error("Unknown Environment ID")}this._defaultEnvironmentID=E}},getDefaultEnvironmentID:function(){return this._defaultEnvironmentID},typeOf:e,createObject:w,mapObject:b,mapArray:n,filterArray:r,searchArray:C,toArray:y,keys:q,pushUnique:g,popFirst:s,clone:B,randomUUID:x,escapeURIComponent:A,formatURI:a,inherits:m,InitializationError:c};this.JSV=h;exports.JSV=h;require("./environments")}());(function(){var m={},o=require("./jsv").JSV,F,v,i,z,l,f,c,y,n,A,p,e,b,x,q,C,r,a,E,u,s,g,w,D,B,t;F={string:function(G,H){return G.getType()==="string"},number:function(G,H){return G.getType()==="number"},integer:function(G,H){return G.getType()==="number"&&G.getValue()%1===0},"boolean":function(G,H){return G.getType()==="boolean"},object:function(G,H){return G.getType()==="object"},array:function(G,H){return G.getType()==="array"},"null":function(G,H){return G.getType()==="null"},any:function(G,H){return true}};v=new o.Environment();v.setOption("validateReferences",true);v.setOption("enforceReferences",false);v.setOption("strict",false);i={"$schema":"http://json-schema.org/draft-00/hyper-schema#",id:"http://json-schema.org/draft-00/schema#",type:"object",properties:{type:{type:["string","array"],items:{type:["string",{"$ref":"#"}]},optional:true,uniqueItems:true,"default":"any",parser:function(G,H){var I;if(G.getType()==="string"){return G.getValue()}else{if(G.getType()==="object"){return G.getEnvironment().createSchema(G,H.getEnvironment().findSchema(H.resolveURI("#")))}else{if(G.getType()==="array"){I=H.getValueOfProperty("parser");return o.mapArray(G.getProperties(),function(J){return I(J,H)})}}}return"any"},validator:function(Q,J,R,L,P,S,G){var H=o.toArray(J.getAttribute("type")),O,M,N,K,I;if(Q.getType()!=="undefined"&&H&&H.length){I=R.getValueOfProperty("typeValidators")||{};for(O=0,M=H.length;O<M;++O){N=H[O];if(o.isJSONSchema(N)){K=o.createObject(L);K.errors=[];K.validated=o.clone(L.validated);if(N.validate(Q,K,P,S,G).errors.length===0){return true}}else{if(I[N]!==m[N]&&typeof I[N]==="function"){if(I[N](Q,L)){return true}}else{return true}}}L.addError(Q,J,"type","Instance is not a required type",H);return false}return true},typeValidators:F},properties:{type:"object",additionalProperties:{"$ref":"#"},optional:true,"default":{},parser:function(H,I,G){var J=H.getEnvironment(),K=I.getEnvironment();if(H.getType()==="object"){if(G){return J.createSchema(H.getProperty(G),K.findSchema(I.resolveURI("#")))}else{return o.mapObject(H.getProperties(),function(L){return J.createSchema(L,K.findSchema(I.resolveURI("#")))})}}return{}},validator:function(M,I,N,J,K,O,G){var H,L;if(M.getType()==="object"){H=I.getAttribute("properties");for(L in H){if(H[L]!==m[L]&&H[L]){H[L].validate(M.getProperty(L),J,M,I,L)}}}}},items:{type:[{"$ref":"#"},"array"],items:{"$ref":"#"},optional:true,"default":{},parser:function(G,H){if(G.getType()==="object"){return G.getEnvironment().createSchema(G,H.getEnvironment().findSchema(H.resolveURI("#")))}else{if(G.getType()==="array"){return o.mapArray(G.getProperties(),function(I){return I.getEnvironment().createSchema(I,H.getEnvironment().findSchema(H.resolveURI("#")))})}}return G.getEnvironment().createEmptySchema()},validator:function(Q,H,R,I,P,S,G){var M,L,O,J,N,K;if(Q.getType()==="array"){M=Q.getProperties();L=H.getAttribute("items");K=H.getAttribute("additionalProperties");if(o.typeOf(L)==="array"){for(O=0,J=M.length;O<J;++O){N=L[O]||K;if(N!==false){N.validate(M[O],I,Q,H,O)}else{I.addError(Q,H,"additionalProperties","Additional items are not allowed",N)}}}else{N=L||K;for(O=0,J=M.length;O<J;++O){N.validate(M[O],I,Q,H,O)}}}}},optional:{type:"boolean",optional:true,"default":false,parser:function(G,H){return !!G.getValue()},validator:function(G,L,I,H,K,M,J){if(G.getType()==="undefined"&&!L.getAttribute("optional")){H.addError(G,L,"optional","Property is required",false)}},validationRequired:true},additionalProperties:{type:[{"$ref":"#"},"boolean"],optional:true,"default":{},parser:function(G,H){if(G.getType()==="object"){return G.getEnvironment().createSchema(G,H.getEnvironment().findSchema(H.resolveURI("#")))}else{if(G.getType()==="boolean"&&G.getValue()===false){return false}}return G.getEnvironment().createEmptySchema()},validator:function(O,I,P,J,M,Q,G){var K,H,L,N;if(O.getType()==="object"){K=I.getAttribute("additionalProperties");H=I.getAttribute("properties")||{};L=O.getProperties();for(N in L){if(L[N]!==m[N]&&L[N]&&H[N]===m[N]){if(o.isJSONSchema(K)){K.validate(L[N],J,O,I,N)}else{if(K===false){J.addError(O,I,"additionalProperties","Additional properties are not allowed",K)}}}}}}},requires:{type:["string",{"$ref":"#"}],optional:true,parser:function(G,H){if(G.getType()==="string"){return G.getValue()}else{if(G.getType()==="object"){return G.getEnvironment().createSchema(G,H.getEnvironment().findSchema(H.resolveURI("#")))}}},validator:function(G,M,I,H,L,N,J){var K;if(G.getType()!=="undefined"&&L&&L.getType()!=="undefined"){K=M.getAttribute("requires");if(typeof K==="string"){if(L.getProperty(K).getType()==="undefined"){H.addError(G,M,"requires",'Property requires sibling property "'+K+'"',K)}}else{if(o.isJSONSchema(K)){K.validate(L,H)}}}}},minimum:{type:"number",optional:true,parser:function(G,H){if(G.getType()==="number"){return G.getValue()}},validator:function(M,H,N,I,K,O,G){var J,L;if(M.getType()==="number"){J=H.getAttribute("minimum");L=H.getAttribute("minimumCanEqual");if(typeof J==="number"&&(M.getValue()<J||(L===false&&M.getValue()===J))){I.addError(M,H,"minimum","Number is less than the required minimum value",J)}}}},maximum:{type:"number",optional:true,parser:function(G,H){if(G.getType()==="number"){return G.getValue()}},validator:function(M,I,N,K,L,O,G){var H,J;if(M.getType()==="number"){H=I.getAttribute("maximum");J=I.getAttribute("maximumCanEqual");if(typeof H==="number"&&(M.getValue()>H||(J===false&&M.getValue()===H))){K.addError(M,I,"maximum","Number is greater than the required maximum value",H)}}}},minimumCanEqual:{type:"boolean",optional:true,requires:"minimum","default":true,parser:function(G,H){if(G.getType()==="boolean"){return G.getValue()}return true}},maximumCanEqual:{type:"boolean",optional:true,requires:"maximum","default":true,parser:function(G,H){if(G.getType()==="boolean"){return G.getValue()}return true}},minItems:{type:"integer",optional:true,minimum:0,"default":0,parser:function(G,H){if(G.getType()==="number"){return G.getValue()}return 0},validator:function(G,M,J,H,L,N,K){var I;if(G.getType()==="array"){I=M.getAttribute("minItems");if(typeof I==="number"&&G.getProperties().length<I){H.addError(G,M,"minItems","The number of items is less than the required minimum",I)}}}},maxItems:{type:"integer",optional:true,minimum:0,parser:function(G,H){if(G.getType()==="number"){return G.getValue()}},validator:function(G,M,I,H,L,N,K){var J;if(G.getType()==="array"){J=M.getAttribute("maxItems");if(typeof J==="number"&&G.getProperties().length>J){H.addError(G,M,"maxItems","The number of items is greater than the required maximum",J)}}}},pattern:{type:"string",optional:true,format:"regex",parser:function(G,H){if(G.getType()==="string"){return G.getValue()}},validator:function(M,H,N,I,L,O,G){var K;try{K=new RegExp(H.getAttribute("pattern"));if(M.getType()==="string"&&K&&!K.test(M.getValue())){I.addError(M,H,"pattern","String does not match pattern",K.toString())}}catch(J){I.addError(H,N,"pattern","Invalid pattern",H.getValueOfProperty("pattern"))}}},minLength:{type:"integer",optional:true,minimum:0,"default":0,parser:function(G,H){if(G.getType()==="number"){return G.getValue()}return 0},validator:function(G,M,J,H,L,N,K){var I;if(G.getType()==="string"){I=M.getAttribute("minLength");if(typeof I==="number"&&G.getValue().length<I){H.addError(G,M,"minLength","String is less than the required minimum length",I)}}}},maxLength:{type:"integer",optional:true,parser:function(G,H){if(G.getType()==="number"){return G.getValue()}},validator:function(G,M,J,I,L,N,K){var H;if(G.getType()==="string"){H=M.getAttribute("maxLength");if(typeof H==="number"&&G.getValue().length>H){I.addError(G,M,"maxLength","String is greater than the required maximum length",H)}}}},"enum":{type:"array",optional:true,minItems:1,uniqueItems:true,parser:function(G,H){if(G.getType()==="array"){return G.getValue()}},validator:function(N,I,O,J,M,P,H){var G,L,K;if(N.getType()!=="undefined"){G=I.getAttribute("enum");if(G){for(L=0,K=G.length;L<K;++L){if(N.equals(G[L])){return true}}J.addError(N,I,"enum","Instance is not one of the possible values",G)}}}},title:{type:"string",optional:true},description:{type:"string",optional:true},format:{type:"string",optional:true,parser:function(G,H){if(G.getType()==="string"){return G.getValue()}},validator:function(M,H,N,I,K,O,G){var J,L;if(M.getType()==="string"){J=H.getAttribute("format");L=N.getValueOfProperty("formatValidators");if(typeof J==="string"&&L[J]!==m[J]&&typeof L[J]==="function"&&!L[J].call(this,M,I)){I.addError(M,H,"format","String is not in the required format",J)}}},formatValidators:{}},contentEncoding:{type:"string",optional:true},"default":{type:"any",optional:true},maxDecimal:{type:"integer",optional:true,minimum:0,parser:function(G,H){if(G.getType()==="number"){return G.getValue()}},validator:function(M,I,N,K,L,O,G){var J,H;if(M.getType()==="number"){J=I.getAttribute("maxDecimal");if(typeof J==="number"){H=M.getValue().toString(10).split(".")[1];if(H&&H.length>J){K.addError(M,I,"maxDecimal","The number of decimal places is greater than the allowed maximum",J)}}}}},disallow:{type:["string","array"],items:{type:"string"},optional:true,uniqueItems:true,parser:function(G,H){if(G.getType()==="string"||G.getType()==="array"){return G.getValue()}},validator:function(Q,I,R,K,O,S,G){var M=o.toArray(I.getAttribute("disallow")),N,L,P,H,J;if(Q.getType()!=="undefined"&&M&&M.length){H=R.getValueOfProperty("typeValidators")||{};for(N=0,L=M.length;N<L;++N){P=M[N];if(o.isJSONSchema(P)){J=o.createObject(K);J.errors=[];J.validated=o.clone(K.validated);if(P.validate(Q,J,O,S,G).errors.length===0){K.addError(Q,I,"disallow","Instance is a disallowed type",M);return false}}else{if(H[P]!==m[P]&&typeof H[P]==="function"){if(H[P](Q,K)){K.addError(Q,I,"disallow","Instance is a disallowed type",M);return false}}}}return true}return true},typeValidators:F},"extends":{type:[{"$ref":"#"},"array"],items:{"$ref":"#"},optional:true,"default":{},parser:function(G,H){if(G.getType()==="object"){return G.getEnvironment().createSchema(G,H.getEnvironment().findSchema(H.resolveURI("#")))}else{if(G.getType()==="array"){return o.mapArray(G.getProperties(),function(I){return I.getEnvironment().createSchema(I,H.getEnvironment().findSchema(H.resolveURI("#")))})}}},validator:function(N,H,O,I,M,P,G){var K=H.getAttribute("extends"),L,J;if(K){if(o.isJSONSchema(K)){K.validate(N,I,M,P,G)}else{if(o.typeOf(K)==="array"){for(L=0,J=K.length;L<J;++L){K[L].validate(N,I,M,P,G)}}}}}}},optional:true,"default":{},fragmentResolution:"dot-delimited",parser:function(G,H){if(G.getType()==="object"){return G.getEnvironment().createSchema(G,H)}},validator:function(P,I,Q,J,O,R,H){var S=I.getPropertyNames(),N,K,L=Q.getAttribute("properties"),M=P.getEnvironment().getOption("strict"),G;for(N in L){if(L[N]!==m[N]){if(L[N].getValueOfProperty("validationRequired")){o.pushUnique(S,N)}if(M&&L[N].getValueOfProperty("deprecated")){o.popFirst(S,N)}}}for(N=0,K=S.length;N<K;++N){if(L[S[N]]!==m[S[N]]){G=L[S[N]].getValueOfProperty("validator");if(typeof G==="function"){G(P,I,L[S[N]],J,O,R,H)}}}}};z={"$schema":"http://json-schema.org/draft-00/hyper-schema#",id:"http://json-schema.org/draft-00/hyper-schema#",properties:{links:{type:"array",items:{"$ref":"links#"},optional:true,parser:function(J,M,I){var L,H=M.getValueOfProperty("items")["$ref"],N=M.getEnvironment().findSchema(H),G=N&&N.getValueOfProperty("parser"),K;I=o.toArray(I);if(typeof G==="function"){L=o.mapArray(J.getProperties(),function(O){return G(O,N)})}else{L=o.toArray(J.getValue())}if(I[0]){L=o.filterArray(L,function(O){return O.rel===I[0]})}if(I[1]){K=M.getValueOfProperty("selfReferenceVariable");L=o.mapArray(L,function(Q){var O=I[1],P=Q.href;P=P.replace(/\{(.+)\}/g,function(V,U,T,R){var S;if(U===K){S=O.getValue()}else{S=O.getValueOfProperty(U)}return S!==undefined?String(S):""});return P?o.formatURI(O.resolveURI(P)):P})}return L},selfReferenceVariable:"-this"},fragmentResolution:{type:"string",optional:true,"default":"dot-delimited"},root:{type:"boolean",optional:true,"default":false},readonly:{type:"boolean",optional:true,"default":false},pathStart:{type:"string",optional:true,format:"uri",validator:function(G,L,I,H,K,N,J){var M;if(G.getType()!=="undefined"){M=L.getAttribute("pathStart");if(typeof M==="string"){if(G.getURI().indexOf(M)!==0){H.addError(G,L,"pathStart","Instance's URI does not start with "+M,M)}}}}},mediaType:{type:"string",optional:true,format:"media-type"},alternate:{type:"array",items:{"$ref":"#"},optional:true}},links:[{href:"{$ref}",rel:"full"},{href:"{$schema}",rel:"describedby"},{href:"{id}",rel:"self"}],initializer:function(H){var I,J,G;I=H._schema.getLink("describedby",H);if(I&&H._schema._uri!==I){H.setReference("describedby",I)}I=H._schema.getLink("self",H);if(o.typeOf(I)==="string"){H._uri=o.formatURI(I)}I=H._schema.getLink("full",H);if(I&&H._uri!==I){H.setReference("full",I)}J=H.getAttribute("extends");if(o.isJSONSchema(J)){G=o.inherits(J,H,true);H=H._env.createSchema(G,H._schema,H._uri)}return H}};l={"$schema":"http://json-schema.org/draft-00/hyper-schema#",id:"http://json-schema.org/draft-00/links#",type:"object",properties:{href:{type:"string"},rel:{type:"string"},method:{type:"string","default":"GET",optional:true},enctype:{type:"string",requires:"method",optional:true},properties:{type:"object",additionalProperties:{"$ref":"hyper-schema#"},optional:true,parser:function(I,J,H){var K=I.getEnvironment(),L=J.getEnvironment(),G=J.getValueOfProperty("additionalProperties")["$ref"];if(I.getType()==="object"){if(H){return K.createSchema(I.getProperty(H),L.findSchema(J.resolveURI(G)))}else{return o.mapObject(I.getProperties(),function(M){return K.createSchema(M,L.findSchema(J.resolveURI(G)))})}}}}},parser:function(G,I){var H=I.getProperty("properties");if(G.getType()==="object"){return o.mapObject(G.getProperties(),function(L,K){var J=H.getProperty(K),M=J&&J.getValueOfProperty("parser");if(typeof M==="function"){return M(L,J)}return L.getValue()})}return G.getValue()}};v.setOption("defaultFragmentDelimiter",".");v.setOption("defaultSchemaURI","http://json-schema.org/draft-00/schema#");f=v.createSchema(i,true,"http://json-schema.org/draft-00/schema#");c=v.createSchema(o.inherits(f,v.createSchema(z,true,"http://json-schema.org/draft-00/hyper-schema#"),true),true,"http://json-schema.org/draft-00/hyper-schema#");v.setOption("defaultSchemaURI","http://json-schema.org/draft-00/hyper-schema#");y=v.createSchema(l,c,"http://json-schema.org/draft-00/links#");n=o.inherits(i,{"$schema":"http://json-schema.org/draft-01/hyper-schema#",id:"http://json-schema.org/draft-01/schema#"});A=o.inherits(z,{"$schema":"http://json-schema.org/draft-01/hyper-schema#",id:"http://json-schema.org/draft-01/hyper-schema#"});p=o.inherits(l,{"$schema":"http://json-schema.org/draft-01/hyper-schema#",id:"http://json-schema.org/draft-01/links#"});v.setOption("defaultSchemaURI","http://json-schema.org/draft-01/schema#");e=v.createSchema(n,true,"http://json-schema.org/draft-01/schema#");b=v.createSchema(o.inherits(e,v.createSchema(A,true,"http://json-schema.org/draft-01/hyper-schema#"),true),true,"http://json-schema.org/draft-01/hyper-schema#");v.setOption("defaultSchemaURI","http://json-schema.org/draft-01/hyper-schema#");x=v.createSchema(p,b,"http://json-schema.org/draft-01/links#");q=o.inherits(n,{"$schema":"http://json-schema.org/draft-02/hyper-schema#",id:"http://json-schema.org/draft-02/schema#",properties:{uniqueItems:{type:"boolean",optional:true,"default":false,parser:function(G,H){return !!G.getValue()},validator:function(P,I,Q,J,O,R,G){var N,M,K,L,H;if(P.getType()==="array"&&I.getAttribute("uniqueItems")){N=P.getProperties();for(M=0,K=N.length-1;M<K;++M){for(L=M+1,H=N.length;L<H;++L){if(N[M].equals(N[L])){J.addError(P,I,"uniqueItems","Array can only contain unique items",{x:M,y:L})}}}}}},maxDecimal:{deprecated:true},divisibleBy:{type:"number",minimum:0,minimumCanEqual:false,optional:true,parser:function(G,H){if(G.getType()==="number"){return G.getValue()}},validator:function(N,J,O,K,M,P,G){var I,L,H;if(N.getType()==="number"){I=J.getAttribute("divisibleBy");if(I===0){K.addError(N,J,"divisibleBy","Nothing is divisible by 0",I)}else{if(I!==1){L=N.getValue();H=Math.max((L.toString().split(".")[1]||" ").length,(I.toString().split(".")[1]||" ").length);H=parseFloat(((L/I)%1).toFixed(H));if(0<H&&H<1){K.addError(N,J,"divisibleBy","Number is not divisible by "+I,I)}}}}}}},fragmentResolution:"slash-delimited"});C=o.inherits(A,{id:"http://json-schema.org/draft-02/hyper-schema#",properties:{fragmentResolution:{"default":"slash-delimited"}}});r=o.inherits(p,{"$schema":"http://json-schema.org/draft-02/hyper-schema#",id:"http://json-schema.org/draft-02/links#",properties:{targetSchema:{"$ref":"hyper-schema#",parser:b.getAttribute("parser")}}});v.setOption("defaultFragmentDelimiter","/");v.setOption("defaultSchemaURI","http://json-schema.org/draft-02/schema#");a=v.createSchema(q,true,"http://json-schema.org/draft-02/schema#");E=v.createSchema(o.inherits(a,v.createSchema(C,true,"http://json-schema.org/draft-02/hyper-schema#"),true),true,"http://json-schema.org/draft-02/hyper-schema#");v.setOption("defaultSchemaURI","http://json-schema.org/draft-02/hyper-schema#");u=v.createSchema(r,E,"http://json-schema.org/draft-02/links#");function h(P,G,H,Q){var I={},N,L,M,K,O;if(P.getType()==="object"){N=G.getAttribute("patternProperties");K=P.getProperties();for(L in N){if(N[L]!==m[L]){M=null;try{M=new RegExp(L)}catch(J){if(H){H.addError(G,Q,"patternProperties","Invalid pattern",L)}}if(M){for(O in K){if(K[O]!==m[O]&&M.test(O)){I[O]=I[O]?o.pushUnique(I[O],N[L]):[N[L]]}}}}}}return I}s=o.inherits(q,{"$schema":"http://json-schema.org/draft-03/schema#",id:"http://json-schema.org/draft-03/schema#",properties:{patternProperties:{type:"object",additionalProperties:{"$ref":"#"},"default":{},parser:a.getValueOfProperty("properties")["properties"]["parser"],validator:function(N,H,O,I,L,P,G){var J,M,K;if(N.getType()==="object"){J=h(N,H,I,O);for(M in J){if(J[M]!==m[M]){K=J[M].length;while(K--){J[M][K].validate(N.getProperty(M),I,N,H,M)}}}}}},additionalProperties:{validator:function(P,I,Q,J,N,R,G){var L,H,M,K,O;if(P.getType()==="object"){L=I.getAttribute("additionalProperties");H=I.getAttribute("properties")||{};M=P.getProperties();K=h(P,I);for(O in M){if(M[O]!==m[O]&&M[O]&&H[O]===m[O]&&K[O]===m[O]){if(o.isJSONSchema(L)){L.validate(M[O],J,P,I,O)}else{if(L===false){J.addError(P,I,"additionalProperties","Additional properties are not allowed",L)}}}}}}},items:{validator:function(Q,I,R,J,P,S,H){var M,L,O,K,N,G;if(Q.getType()==="array"){M=Q.getProperties();L=I.getAttribute("items");G=I.getAttribute("additionalItems");if(o.typeOf(L)==="array"){for(O=0,K=M.length;O<K;++O){N=L[O]||G;if(N!==false){N.validate(M[O],J,Q,I,O)}else{J.addError(Q,I,"additionalItems","Additional items are not allowed",N)}}}else{N=L||G;for(O=0,K=M.length;O<K;++O){N.validate(M[O],J,Q,I,O)}}}}},additionalItems:{type:[{"$ref":"#"},"boolean"],"default":{},parser:a.getValueOfProperty("properties")["additionalProperties"]["parser"],validator:function(O,I,P,J,N,Q,H){var G,L,M,K;if(O.getType()==="array"&&I.getProperty("items").getType()==="undefined"){G=I.getAttribute("additionalItems");L=O.getProperties();if(G!==false){for(M=0,K=L.length;M<K;++M){G.validate(L[M],J,O,I,M)}}else{if(L.length){J.addError(O,I,"additionalItems","Additional items are not allowed",G)}}}}},optional:{validationRequired:false,deprecated:true},required:{type:"boolean","default":false,parser:function(G,H){return !!G.getValue()},validator:function(G,L,I,H,K,M,J){if(G.getType()==="undefined"&&L.getAttribute("required")){H.addError(G,L,"required","Property is required",true)}}},requires:{deprecated:true},dependencies:{type:"object",additionalProperties:{type:["string","array",{"$ref":"#"}],items:{type:"string"}},"default":{},parser:function(H,I,G){function J(L){var K=L.getType();if(K==="string"||K==="array"){return L.getValue()}else{if(K==="object"){return L.getEnvironment().createSchema(L,I.getEnvironment().findSchema(I.resolveURI("#")))}}}if(H.getType()==="object"){if(G){return J(H.getProperty(G))}else{return o.mapObject(H.getProperties(),J)}}return{}},validator:function(Q,I,R,J,O,S,G){var L,P,H,M,N,K;if(Q.getType()==="object"){L=I.getAttribute("dependencies");for(P in L){if(L[P]!==m[P]&&Q.getProperty(P).getType()!=="undefined"){H=L[P];M=o.typeOf(H);if(M==="string"){if(Q.getProperty(H).getType()==="undefined"){J.addError(Q,I,"dependencies",'Property "'+P+'" requires sibling property "'+H+'"',L)}}else{if(M==="array"){for(N=0,K=H.length;N<K;++N){if(Q.getProperty(H[N]).getType()==="undefined"){J.addError(Q,I,"dependencies",'Property "'+P+'" requires sibling property "'+H[N]+'"',L)}}}else{if(o.isJSONSchema(H)){H.validate(Q,J)}}}}}}}},minimumCanEqual:{deprecated:true},maximumCanEqual:{deprecated:true},exclusiveMinimum:{type:"boolean","default":false,parser:function(G,H){return !!G.getValue()}},exclusiveMaximum:{type:"boolean","default":false,parser:function(G,H){return !!G.getValue()}},minimum:{validator:function(M,H,N,I,L,O,G){var J,K;if(M.getType()==="number"){J=H.getAttribute("minimum");K=H.getAttribute("exclusiveMinimum")||(!M.getEnvironment().getOption("strict")&&!H.getAttribute("minimumCanEqual"));if(typeof J==="number"&&(M.getValue()<J||(K===true&&M.getValue()===J))){I.addError(M,H,"minimum","Number is less than the required minimum value",J)}}}},maximum:{validator:function(M,I,N,J,L,O,G){var H,K;if(M.getType()==="number"){H=I.getAttribute("maximum");K=I.getAttribute("exclusiveMaximum")||(!M.getEnvironment().getOption("strict")&&!I.getAttribute("maximumCanEqual"));if(typeof H==="number"&&(M.getValue()>H||(K===true&&M.getValue()===H))){J.addError(M,I,"maximum","Number is greater than the required maximum value",H)}}}},contentEncoding:{deprecated:true},divisibleBy:{exclusiveMinimum:true},disallow:{items:{type:["string",{"$ref":"#"}]},parser:q.properties["type"]["parser"]},id:{type:"string",format:"uri"},"$ref":{type:"string",format:"uri"},"$schema":{type:"string",format:"uri"}},dependencies:{exclusiveMinimum:"minimum",exclusiveMaximum:"maximum"},initializer:function(H){var L,M,G,J=H.getValueOfProperty("$schema"),I=H.getValueOfProperty("$ref"),K=H.getValueOfProperty("id");if(J){L=H.resolveURI(J);H.setReference("describedby",L)}if(K){L=H.resolveURI(K);if(o.typeOf(L)==="string"){H._uri=o.formatURI(L)}}if(I){L=H.resolveURI(I);H.setReference("full",L)}M=H.getAttribute("extends");if(o.isJSONSchema(M)){G=o.inherits(M,H,true);H=H._env.createSchema(G,H._schema,H._uri)}return H}});g=o.inherits(C,{"$schema":"http://json-schema.org/draft-03/hyper-schema#",id:"http://json-schema.org/draft-03/hyper-schema#",properties:{links:{selfReferenceVariable:"@"},root:{deprecated:true},contentEncoding:{deprecated:false},alternate:{deprecated:true}}});w=o.inherits(r,{"$schema":"http://json-schema.org/draft-03/hyper-schema#",id:"http://json-schema.org/draft-03/links#",properties:{href:{required:true,format:"link-description-object-template"},rel:{required:true},properties:{deprecated:true},schema:{"$ref":"http://json-schema.org/draft-03/hyper-schema#"}}});v.setOption("defaultSchemaURI","http://json-schema.org/draft-03/schema#");D=v.createSchema(s,true,"http://json-schema.org/draft-03/schema#");B=v.createSchema(o.inherits(D,v.createSchema(g,true,"http://json-schema.org/draft-03/hyper-schema#"),true),true,"http://json-schema.org/draft-03/hyper-schema#");v.setOption("defaultSchemaURI","http://json-schema.org/draft-03/hyper-schema#");t=v.createSchema(w,true,"http://json-schema.org/draft-03/links#");v.setOption("latestJSONSchemaSchemaURI","http://json-schema.org/draft-03/schema#");v.setOption("latestJSONSchemaHyperSchemaURI","http://json-schema.org/draft-03/hyper-schema#");v.setOption("latestJSONSchemaLinksURI","http://json-schema.org/draft-03/links#");v._schemas["http://json-schema.org/schema#"]=D;v._schemas["http://json-schema.org/hyper-schema#"]=B;v._schemas["http://json-schema.org/links#"]=t;o.registerEnvironment("json-schema-draft-03",v);if(!o.getDefaultEnvironmentID()||o.getDefaultEnvironmentID()==="json-schema-draft-01"||o.getDefaultEnvironmentID()==="json-schema-draft-02"){o.setDefaultEnvironmentID("json-schema-draft-03")}}());(function(g){var o,B="",v=Math.PI,i=v/2,m="ontouchstart" in window,c=(m)?{start:"touchstart",move:"touchmove",end:"touchend"}:{start:"mousedown",move:"mousemove",end:"mouseup"},w={backward:["bl","tl"],forward:["br","tr"],all:["tl","bl","tr","br"]},l=["single","double"],f={page:1,gradients:true,duration:600,acceleration:true,display:"double",when:null},a={folding:null,corners:"forward",cornerSize:100,gradients:true,duration:600,acceleration:true},A=6,u={0:{top:0,left:0,right:"auto",bottom:"auto"},1:{top:0,right:0,left:"auto",bottom:"auto"}},s=function(F,E,G,D){return{css:{position:"absolute",top:F,left:E,overflow:D||"hidden","z-index":G||"auto"}}},q=function(J,I,H,G,F){var D=1-F,E=D*D*D,K=F*F*F;return h(Math.round(E*J.x+3*F*D*D*I.x+3*F*F*D*H.x+K*G.x),Math.round(E*J.y+3*F*D*D*I.y+3*F*F*D*H.y+K*G.y))},C=function(D){return D/180*v},r=function(D){return D/v*180},h=function(D,E){return{x:D,y:E}},p=function(D,F,E){return(o&&E)?" translate3d("+D+"px,"+F+"px, 0px) ":" translate("+D+"px, "+F+"px) "},y=function(D){return" rotate("+D+"deg) "},e=function(E,D){return Object.prototype.hasOwnProperty.call(D,E)},t=function(){var E=["Moz","Webkit","Khtml","O","ms"],D=E.length,F="";while(D--){if((E[D]+"Transform") in document.body.style){F="-"+E[D].toLowerCase()+"-"}}return F},b=function(P,F,E,K,Q){var T,N=[];if(B=="-webkit-"){for(T=0;T<Q;T++){N.push("color-stop("+K[T][0]+", "+K[T][1]+")")}P.css({"background-image":"-webkit-gradient(linear, "+F.x+"% "+F.y+"%,  "+E.x+"% "+E.y+"%, "+N.join(",")+" )"})}else{F={x:F.x/100*P.width(),y:F.y/100*P.height()};E={x:E.x/100*P.width(),y:E.y/100*P.height()};var O=E.x-F.x,M=E.y-F.y,U=Math.atan2(M,O),G=U-Math.PI/2,S=Math.abs(P.width()*Math.sin(G))+Math.abs(P.height()*Math.cos(G)),D=Math.sqrt(M*M+O*O),I=h((E.x<F.x)?P.width():0,(E.y<F.y)?P.height():0),J=Math.tan(U),H=-1/J,L=(H*I.x-I.y-J*F.x+F.y)/(H-J),V={x:L,y:H*L-H*I.x+I.y},R=(Math.sqrt(Math.pow(V.x-F.x,2)+Math.pow(V.y-F.y,2)));for(T=0;T<Q;T++){N.push(" "+K[T][1]+" "+((R+D*K[T][0])*100/S)+"%")}P.css({"background-image":B+"linear-gradient("+(-U)+"rad,"+N.join(",")+")"})}},z={init:function(F){if(o===undefined){o="WebKitCSSMatrix" in window||"MozPerspective" in document.body.style;B=t()}var D,G=this.data(),E=this.children();F=g.extend({width:this.width(),height:this.height()},f,F);G.opts=F;G.pageObjs={};G.pages={};G.pageWrap={};G.pagePlace={};G.pageMv=[];G.totalPages=F.pages||0;if(F.when){for(D in F.when){if(e(D,F.when)){this.bind(D,F.when[D])}}}this.css({position:"relative",width:F.width,height:F.height});this.turn("display",F.display);if(o&&!m&&F.acceleration){this.transform(p(0,0,true))}for(D=0;D<E.length;D++){this.turn("addPage",E[D],D+1)}this.turn("page",F.page);w=g.extend({},w,F.corners);g(this).bind(c.start,function(I){for(var H in G.pages){if(e(H,G.pages)&&x._eventStart.call(G.pages[H],I)===false){return false}}});g(document).bind(c.move,function(I){for(var H in G.pages){if(e(H,G.pages)){x._eventMove.call(G.pages[H],I)}}}).bind(c.end,function(I){for(var H in G.pages){if(e(H,G.pages)){x._eventEnd.call(G.pages[H],I)}}});G.done=true;return this},addPage:function(D,H){var E=false,G=this.data(),F=G.totalPages+1;if(H){if(H==F){H=F;E=true}else{if(H>F){throw new Error('It is impossible to add the page "'+H+'", the maximum value is: "'+F+'"')}}}else{H=F;E=true}if(H>=1&&H<=F){if(G.done){this.turn("stop")}if(H in G.pageObjs){z._movePages.call(this,H,1)}if(E){G.totalPages=F}G.pageObjs[H]=g(D).addClass("turn-page p"+H);z._addPage.call(this,H);if(G.done){this.turn("update")}z._removeFromDOM.call(this)}return this},_addPage:function(H){var G=this.data(),E=G.pageObjs[H];if(E){if(z._necessPage.call(this,H)){if(!G.pageWrap[H]){var D=(G.display=="double")?this.width()/2:this.width(),F=this.height();E.css({width:D,height:F});G.pagePlace[H]=H;G.pageWrap[H]=g("<div/>",{"class":"turn-page-wrapper",page:H,css:{position:"absolute",overflow:"hidden",width:D,height:F}}).css(u[(G.display=="double")?H%2:0]);this.append(G.pageWrap[H]);G.pageWrap[H].prepend(G.pageObjs[H])}if(!H||z._setPageLoc.call(this,H)==1){z._makeFlip.call(this,H)}}else{G.pagePlace[H]=0;if(G.pageObjs[H]){G.pageObjs[H].remove()}}}},hasPage:function(D){return D in this.data().pageObjs},_makeFlip:function(E){var D=this.data();if(!D.pages[E]&&D.pagePlace[E]==E){var G=D.display=="single",F=E%2;D.pages[E]=D.pageObjs[E].css({width:(G)?this.width():this.width()/2,height:this.height()}).flip({page:E,next:(G&&E===D.totalPages)?E-1:((F||G)?E+1:E-1),turn:this,duration:D.opts.duration,acceleration:D.opts.acceleration,corners:(G)?"all":((F)?"forward":"backward"),backGradient:D.opts.gradients,frontGradient:D.opts.gradients}).flip("disable",D.disabled).bind("pressed",z._pressed).bind("released",z._released).bind("start",z._start).bind("end",z._end).bind("flip",z._flip)}return D.pages[E]},_makeRange:function(){var F,E=this.data(),D=this.turn("range");for(F=D[0];F<=D[1];F++){z._addPage.call(this,F)}},range:function(H){var D,I,F,G=this.data();H=H||G.tpage||G.page;var E=z._view.call(this,H);if(H<1||H>G.totalPages){throw new Error('"'+H+'" is not a page for range')}E[1]=E[1]||E[0];if(E[0]>=1&&E[1]<=G.totalPages){D=Math.floor((A-2)/2);if(G.totalPages-E[1]>E[0]){I=Math.min(E[0]-1,D);F=2*D-I}else{F=Math.min(G.totalPages-E[1],D);I=2*D-F}}else{I=A-1;F=A-1}return[Math.max(1,E[0]-I),Math.min(G.totalPages,E[1]+F)]},_necessPage:function(E){if(E===0){return true}var D=this.turn("range");return E>=D[0]&&E<=D[1]},_removeFromDOM:function(){var E,D=this.data();for(E in D.pageWrap){if(e(E,D.pageWrap)&&!z._necessPage.call(this,E)){z._removePageFromDOM.call(this,E)}}},_removePageFromDOM:function(F){var E=this.data();if(E.pages[F]){var D=E.pages[F].data();if(D.f&&D.f.fwrapper){D.f.fwrapper.remove()}E.pages[F].remove();delete E.pages[F]}if(E.pageObjs[F]){E.pageObjs[F].remove()}if(E.pageWrap[F]){E.pageWrap[F].remove();delete E.pageWrap[F]}delete E.pagePlace[F]},removePage:function(E){var D=this.data();if(D.pageObjs[E]){this.turn("stop");z._removePageFromDOM.call(this,E);delete D.pageObjs[E];z._movePages.call(this,E,-1);D.totalPages=D.totalPages-1;z._makeRange.call(this);if(D.page>D.totalPages){this.turn("page",D.totalPages)}}return this},_movePages:function(I,H){var F,E=this.data(),G=E.display=="single",D=function(L){var J=L+H,K=J%2;if(E.pageObjs[L]){E.pageObjs[J]=E.pageObjs[L].removeClass("page"+L).addClass("page"+J)}if(E.pagePlace[L]&&E.pageWrap[L]){E.pagePlace[J]=J;E.pageWrap[J]=E.pageWrap[L].css(u[(G)?0:K]).attr("page",J);if(E.pages[L]){E.pages[J]=E.pages[L].flip("options",{page:J,next:(G||K)?J+1:J-1,corners:(G)?"all":((K)?"forward":"backward")})}if(H){delete E.pages[L];delete E.pagePlace[L];delete E.pageObjs[L];delete E.pageWrap[L];delete E.pageObjs[L]}}};if(H>0){for(F=E.totalPages;F>=I;F--){D(F)}}else{for(F=I;F<=E.totalPages;F++){D(F)}}},display:function(F){var E=this.data(),G=E.display;if(F){if(g.inArray(F,l)==-1){throw new Error('"'+F+'" is not a value for display')}if(F=="single"){if(!E.pageObjs[0]){this.turn("stop").css({overflow:"hidden"});E.pageObjs[0]=g("<div />",{"class":"turn-page p-temporal"}).css({width:this.width(),height:this.height()}).appendTo(this)}}else{if(E.pageObjs[0]){this.turn("stop").css({overflow:""});E.pageObjs[0].remove();delete E.pageObjs[0]}}E.display=F;if(G){var D=this.turn("size");z._movePages.call(this,1,0);this.turn("size",D.width,D.height).turn("update")}return this}else{return G}},animating:function(){return this.data().pageMv.length>0},disable:function(E){var G,F=this.data(),D=this.turn("view");F.disabled=E===undefined||E===true;for(G in F.pages){if(e(G,F.pages)){F.pages[G].flip("disable",E?g.inArray(G,D):false)}}return this},size:function(F,D){if(F&&D){var H=this.data(),E=(H.display=="double")?F/2:F,G;this.css({width:F,height:D});if(H.pageObjs[0]){H.pageObjs[0].css({width:E,height:D})}for(G in H.pageWrap){if(!e(G,H.pageWrap)){continue}H.pageObjs[G].css({width:E,height:D});H.pageWrap[G].css({width:E,height:D});if(H.pages[G]){H.pages[G].css({width:E,height:D})}}this.turn("resize");return this}else{return{width:this.width(),height:this.height()}}},resize:function(){var E,D=this.data();if(D.pages[0]){D.pageWrap[0].css({left:-this.width()});D.pages[0].flip("resize",true)}for(E=1;E<=D.totalPages;E++){if(D.pages[E]){D.pages[E].flip("resize",true)}}},_removeMv:function(F){var D,E=this.data();for(D=0;D<E.pageMv.length;D++){if(E.pageMv[D]==F){E.pageMv.splice(D,1);return true}}return false},_addMv:function(E){var D=this.data();z._removeMv.call(this,E);D.pageMv.push(E)},_view:function(E){var D=this.data();E=E||D.page;if(D.display=="double"){return(E%2)?[E-1,E]:[E,E+1]}else{return[E]}},view:function(F){var E=this.data(),D=z._view.call(this,F);return(E.display=="double")?[(D[0]>0)?D[0]:0,(D[1]<=E.totalPages)?D[1]:0]:[(D[0]>0&&D[0]<=E.totalPages)?D[0]:0]},stop:function(F){var E,G,H=this.data(),D=H.pageMv;H.pageMv=[];if(H.tpage){H.page=H.tpage;delete H.tpage}for(E in D){if(!e(E,D)){continue}G=H.pages[D[E]].data().f.opts;x._moveFoldingPage.call(H.pages[D[E]],null);H.pages[D[E]].flip("hideFoldedPage");H.pagePlace[G.next]=G.next;if(G.force){G.next=(G.page%2===0)?G.page-1:G.page+1;delete G.force}}this.turn("update");return this},pages:function(D){var F=this.data();if(D){if(D<F.totalPages){for(var E=D+1;E<=F.totalPages;E++){this.turn("removePage",E)}if(this.turn("page")>D){this.turn("page",D)}}F.totalPages=D;return this}else{return F.totalPages}},_fitPage:function(F,D){var E=this.data(),G=this.turn("view",F);if(E.page!=F){this.trigger("turning",[F,G]);if(g.inArray(1,G)!=-1){this.trigger("first")}if(g.inArray(E.totalPages,G)!=-1){this.trigger("last")}}if(!E.pageObjs[F]){return}E.tpage=F;this.turn("stop",D);z._removeFromDOM.call(this);z._makeRange.call(this);this.trigger("turned",[F,G])},_turnPage:function(H){var I,E,G=this.data(),D=this.turn("view"),J=this.turn("view",H);if(G.page!=H){this.trigger("turning",[H,J]);if(g.inArray(1,J)!=-1){this.trigger("first")}if(g.inArray(G.totalPages,J)!=-1){this.trigger("last")}}if(!G.pageObjs[H]){return}G.tpage=H;this.turn("stop");z._makeRange.call(this);if(G.display=="single"){I=D[0];E=J[0]}else{if(D[1]&&H>D[1]){I=D[1];E=J[0]}else{if(D[0]&&H<D[0]){I=D[0];E=J[1]}}}if(G.pages[I]){var F=G.pages[I].data().f.opts;G.tpage=E;if(F.next!=E){F.next=E;G.pagePlace[E]=F.page;F.force=true}if(G.display=="single"){G.pages[I].flip("turnPage",(J[0]>D[0])?"br":"bl")}else{G.pages[I].flip("turnPage")}}},page:function(E){E=parseInt(E,10);var D=this.data();if(E>0&&E<=D.totalPages){if(!D.done||g.inArray(E,this.turn("view"))!=-1){z._fitPage.call(this,E)}else{z._turnPage.call(this,E)}return this}else{return D.page}},next:function(){var D=this.data();return this.turn("page",z._view.call(this,D.page).pop()+1)},previous:function(){var D=this.data();return this.turn("page",z._view.call(this,D.page).shift()-1)},_addMotionPage:function(){var F=g(this).data().f.opts,E=F.turn,D=E.data();F.pageMv=F.page;z._addMv.call(E,F.pageMv);D.pagePlace[F.next]=F.page;E.turn("update")},_start:function(I,F,E){var G=F.turn.data(),D=g.Event("start");I.stopPropagation();F.turn.trigger(D,[F,E]);if(D.isDefaultPrevented()){I.preventDefault();return}if(G.display=="single"){var H=E.charAt(1)=="l";if((F.page==1&&H)||(F.page==G.totalPages&&!H)){I.preventDefault()}else{if(H){F.next=(F.next<F.page)?F.next:F.page-1;F.force=true}else{F.next=(F.next>F.page)?F.next:F.page+1}}}z._addMotionPage.call(this)},_end:function(J,H){var G=g(this),I=G.data().f,F=I.opts,E=F.turn,D=E.data();J.stopPropagation();if(H||D.tpage){if(D.tpage==F.next||D.tpage==F.page){delete D.tpage;z._fitPage.call(E,D.tpage||F.next,true)}}else{z._removeMv.call(E,F.pageMv);E.turn("update")}},_pressed:function(){var H,F=g(this),G=F.data().f,E=G.opts.turn,D=E.data().pages;for(H in D){if(H!=G.opts.page){D[H].flip("disable",true)}}return G.time=new Date().getTime()},_released:function(G,D){var E=g(this),F=E.data().f;G.stopPropagation();if((new Date().getTime())-F.time<200||D.x<0||D.x>g(this).width()){G.preventDefault();F.opts.turn.data().tpage=F.opts.next;F.opts.turn.turn("update");g(E).flip("turnPage")}},_flip:function(){var D=g(this).data().f.opts;D.turn.trigger("turn",[D.next])},calculateZ:function(O){var G,J,M,E,N,I=this,F=this.data(),L=this.turn("view"),H=L[0]||L[1],D={pageZ:{},partZ:{},pageV:{}},K=function(Q){var P=I.turn("view",Q);if(P[0]){D.pageV[P[0]]=true}if(P[1]){D.pageV[P[1]]=true}};for(G=0;G<O.length;G++){J=O[G];M=F.pages[J].data().f.opts.next;E=F.pagePlace[J];K(J);K(M);N=(F.pagePlace[M]==M)?M:J;D.pageZ[N]=F.totalPages-Math.abs(H-N);D.partZ[E]=F.totalPages*2+Math.abs(H-N)}return D},update:function(){var H,G=this.data();if(G.pageMv.length&&G.pageMv[0]!==0){var F,I=this.turn("calculateZ",G.pageMv),E=this.turn("view",G.tpage);if(G.pagePlace[E[0]]==E[0]){F=E[0]}else{if(G.pagePlace[E[1]]==E[1]){F=E[1]}}for(H in G.pageWrap){if(!e(H,G.pageWrap)){continue}G.pageWrap[H].css({display:(I.pageV[H])?"":"none","z-index":I.pageZ[H]||0});if(G.pages[H]){G.pages[H].flip("z",I.partZ[H]||null);if(I.pageV[H]){G.pages[H].flip("resize")}if(G.tpage){G.pages[H].flip("disable",true)}}}}else{for(H in G.pageWrap){if(!e(H,G.pageWrap)){continue}var D=z._setPageLoc.call(this,H);if(G.pages[H]){G.pages[H].flip("disable",G.disabled||D!=1).flip("z",null)}}}},_setPageLoc:function(F){var E=this.data(),D=this.turn("view");if(F==D[0]||F==D[1]){E.pageWrap[F].css({"z-index":E.totalPages,display:""});return 1}else{if((E.display=="single"&&F==D[0]+1)||(E.display=="double"&&F==D[0]-2||F==D[1]+2)){E.pageWrap[F].css({"z-index":E.totalPages-1,display:""});return 2}else{E.pageWrap[F].css({"z-index":0,display:"none"});return 0}}}},x={init:function(D){if(D.gradients){D.frontGradient=true;D.backGradient=true}this.data({f:{}});this.flip("options",D);x._addPageWrapper.call(this);return this},setData:function(E){var D=this.data();D.f=g.extend(D.f,E);return this},options:function(D){var E=this.data().f;if(D){x.setData.call(this,{opts:g.extend({},E.opts||a,D)});return this}else{return E.opts}},z:function(E){var D=this.data().f;D.opts["z-index"]=E;D.fwrapper.css({"z-index":E||parseInt(D.parent.css("z-index"),10)||0});return this},_cAllowed:function(){return w[this.data().f.opts.corners]||this.data().f.opts.corners},_cornerActivated:function(I){if(I.originalEvent===undefined){return false}I=(m)?I.originalEvent.touches:[I];var G=this.data().f,K=G.parent.offset(),F=this.width(),E=this.height(),J={x:Math.max(0,I[0].pageX-K.left),y:Math.max(0,I[0].pageY-K.top)},H=G.opts.cornerSize,D=x._cAllowed.call(this);if(J.x<=0||J.y<=0||J.x>=F||J.y>=E){return false}if(J.y<H){J.corner="t"}else{if(J.y>=E-H){J.corner="b"}else{return false}}if(J.x<=H){J.corner+="l"}else{if(J.x>=F-H){J.corner+="r"}else{return false}}return(g.inArray(J.corner,D)==-1)?false:J},_c:function(E,D){D=D||0;return({tl:h(D,D),tr:h(this.width()-D,D),bl:h(D,this.height()-D),br:h(this.width()-D,this.height()-D)})[E]},_c2:function(D){return{tl:h(this.width()*2,0),tr:h(-this.width(),0),bl:h(this.width()*2,this.height()),br:h(-this.width(),this.height())}[D]},_foldingPage:function(E){var D=this.data().f.opts;if(D.folding){return D.folding}else{if(D.turn){var F=D.turn.data();if(F.display=="single"){return(F.pageObjs[D.next])?F.pageObjs[0]:null}else{return F.pageObjs[D.next]}}}},_backGradient:function(){var E=this.data().f,D=E.opts.turn,F=E.opts.backGradient&&(!D||D.data().display=="single"||(E.opts.page!=2&&E.opts.page!=D.data().totalPages-1));if(F&&!E.bshadow){E.bshadow=g("<div/>",s(0,0,1)).css({position:"",width:this.width(),height:this.height()}).appendTo(E.parent)}return F},resize:function(F){var H=this.data().f,G=this.width(),D=this.height(),E=Math.round(Math.sqrt(Math.pow(G,2)+Math.pow(D,2)));if(F){H.wrapper.css({width:E,height:E});H.fwrapper.css({width:E,height:E}).children(":first-child").css({width:G,height:D});H.fpage.css({width:D,height:G});if(H.opts.frontGradient){H.ashadow.css({width:D,height:G})}if(x._backGradient.call(this)){H.bshadow.css({width:G,height:D})}}if(H.parent.is(":visible")){H.fwrapper.css({top:H.parent.offset().top,left:H.parent.offset().left});if(H.opts.turn){H.fparent.css({top:-H.opts.turn.offset().top,left:-H.opts.turn.offset().left})}}this.flip("z",H.opts["z-index"])},_addPageWrapper:function(){var H,G=this.data().f,J=this.parent();if(!G.wrapper){var F=this.css("left"),I=this.css("top"),E=this.width(),K=this.height(),L=Math.round(Math.sqrt(Math.pow(E,2)+Math.pow(K,2)));G.parent=J;G.fparent=(G.opts.turn)?G.opts.turn.data().fparent:g("#turn-fwrappers");if(!G.fparent){var D=g("<div/>",{css:{"pointer-events":"none"}}).hide();D.data().flips=0;if(G.opts.turn){D.css(s(-G.opts.turn.offset().top,-G.opts.turn.offset().left,"auto","visible").css).appendTo(G.opts.turn);G.opts.turn.data().fparent=D}else{D.css(s(0,0,"auto","visible").css).attr("id","turn-fwrappers").appendTo(g("body"))}G.fparent=D}this.css({position:"absolute",top:0,left:0,bottom:"auto",right:"auto"});G.wrapper=g("<div/>",s(0,0,this.css("z-index"))).appendTo(J).prepend(this);G.fwrapper=g("<div/>",s(J.offset().top,J.offset().left)).hide().appendTo(G.fparent);G.fpage=g("<div/>",{css:{cursor:"default"}}).appendTo(g("<div/>",s(0,0,0,"visible")).appendTo(G.fwrapper));if(G.opts.frontGradient){G.ashadow=g("<div/>",s(0,0,1)).appendTo(G.fpage)}x.setData.call(this,G);x.resize.call(this,true)}},_fold:function(T){var K=this,ab=0,I=0,Y,N,H,F,E,Q,J,O=h(0,0),X=h(0,0),D=h(0,0),S=this.width(),P=this.height(),aa=x._foldingPage.call(this),W=Math.tan(I),ac=this.data().f,Z=ac.opts.acceleration,V=ac.wrapper.height(),R=x._c.call(this,T.corner),M=T.corner.substr(0,1)=="t",G=T.corner.substr(1,1)=="l",U=function(){var an=h((R.x)?R.x-T.x:T.x,(R.y)?R.y-T.y:T.y),ak=(Math.atan2(an.y,an.x)),ao;I=i-ak;ab=r(I);ao=h((G)?S-an.x/2:T.x+an.x/2,an.y/2);var af=I-Math.atan2(ao.y,ao.x),ae=Math.max(0,Math.sin(af)*Math.sqrt(Math.pow(ao.x,2)+Math.pow(ao.y,2)));D=h(ae*Math.sin(I),ae*Math.cos(I));if(I>i){D.x=D.x+Math.abs(D.y*Math.tan(ak));D.y=0;if(Math.round(D.x*Math.tan(v-I))<P){T.y=Math.sqrt(Math.pow(P,2)+2*ao.x*an.x);if(M){T.y=P-T.y}return U()}}if(I>i){var al=v-I,am=V-P/Math.sin(al);O=h(Math.round(am*Math.cos(al)),Math.round(am*Math.sin(al)));if(G){O.x=-O.x}if(M){O.y=-O.y}}N=Math.round(D.y/Math.tan(I)+D.x);var aj=S-N,ah=aj*Math.cos(I*2),ag=aj*Math.sin(I*2);X=h(Math.round((G?aj-ah:N+ah)),Math.round((M)?ag:P-ag));Q=aj*Math.sin(I);var ad=x._c2.call(K,T.corner),ai=Math.sqrt(Math.pow(ad.x-T.x,2)+Math.pow(ad.y-T.y,2));J=(ai<S)?ai/S:1;if(ac.opts.frontGradient){E=Q>100?(Q-100)/Q:0;H=h(Q*Math.sin(i-I)/P*100,Q*Math.cos(i-I)/S*100);if(M){H.y=100-H.y}if(G){H.x=100-H.x}}if(x._backGradient.call(K)){F=h(Q*Math.sin(I)/S*100,Q*Math.cos(I)/P*100);if(!G){F.x=100-F.x}if(!M){F.y=100-F.y}}D.x=Math.round(D.x);D.y=Math.round(D.y);return true},L=function(ah,ag,aj,ai){var af=["0","auto"],ak=(S-V)*aj[0]/100,ae=(P-V)*aj[1]/100,al={left:af[ag[0]],top:af[ag[1]],right:af[ag[2]],bottom:af[ag[3]]},ad=(ai!=90&&ai!=-90)?(G?-1:1):0;aj=aj[0]+"% "+aj[1]+"%";K.css(al).transform(y(ai)+p(ah.x+ad,ah.y,Z),aj);ac.fpage.parent().css(al);ac.wrapper.transform(p(-ah.x+ak-ad,-ah.y+ae,Z)+y(-ai),aj);ac.fwrapper.transform(p(-ah.x+O.x+ak,-ah.y+O.y+ae,Z)+y(-ai),aj);ac.fpage.parent().transform(y(ai)+p(ah.x+X.x-O.x,ah.y+X.y-O.y,Z),aj);if(ac.opts.frontGradient){b(ac.ashadow,h(G?100:0,M?100:0),h(H.x,H.y),[[E,"rgba(0,0,0,0)"],[((1-E)*0.8)+E,"rgba(0,0,0,"+(0.2*J)+")"],[1,"rgba(255,255,255,"+(0.2*J)+")"]],3,I)}if(x._backGradient.call(K)){b(ac.bshadow,h(G?0:100,M?0:100),h(F.x,F.y),[[0.8,"rgba(0,0,0,0)"],[1,"rgba(0,0,0,"+(0.3*J)+")"],[1,"rgba(0,0,0,0)"]],3)}};switch(T.corner){case"tl":T.x=Math.max(T.x,1);U();L(D,[1,0,0,1],[100,0],ab);ac.fpage.transform(p(-P,-S,Z)+y(90-ab*2),"100% 100%");aa.transform(y(90)+p(0,-P,Z),"0% 0%");break;case"tr":T.x=Math.min(T.x,S-1);U();L(h(-D.x,D.y),[0,0,0,1],[0,0],-ab);ac.fpage.transform(p(0,-S,Z)+y(-90+ab*2),"0% 100%");aa.transform(y(270)+p(-S,0,Z),"0% 0%");break;case"bl":T.x=Math.max(T.x,1);U();L(h(D.x,-D.y),[1,1,0,0],[100,100],-ab);ac.fpage.transform(p(-P,0,Z)+y(-90+ab*2),"100% 0%");aa.transform(y(270)+p(-S,0,Z),"0% 0%");break;case"br":T.x=Math.min(T.x,S-1);U();L(h(-D.x,-D.y),[0,1,1,0],[0,100],ab);ac.fpage.transform(y(90-ab*2),"0% 0%");aa.transform(y(90)+p(0,-P,Z),"0% 0%");break}ac.point=T},_moveFoldingPage:function(D){var F=this.data().f,E=x._foldingPage.call(this);if(E){if(D){if(!F.fpage.children()[F.ashadow?"1":"0"]){x.setData.call(this,{backParent:E.parent()});F.fpage.prepend(E)}}else{if(F.backParent){F.backParent.prepend(E)}}}},_showFoldedPage:function(K,F){var G=x._foldingPage.call(this),E=this.data(),J=E.f;if(!J.point||J.point.corner!=K.corner){var I=g.Event("start");this.trigger(I,[J.opts,K.corner]);if(I.isDefaultPrevented()){return false}}if(G){if(F){var H=this,D=(J.point&&J.point.corner==K.corner)?J.point:x._c.call(this,K.corner,1);this.animatef({from:[D.x,D.y],to:[K.x,K.y],duration:500,frame:function(L){K.x=Math.round(L[0]);K.y=Math.round(L[1]);x._fold.call(H,K)}})}else{x._fold.call(this,K);if(E.effect&&!E.effect.turning){this.animatef(false)}}if(!J.fwrapper.is(":visible")){J.fparent.show().data().flips++;x._moveFoldingPage.call(this,true);J.fwrapper.show();if(J.bshadow){J.bshadow.show()}}return true}return false},hide:function(){var E=this.data().f,D=x._foldingPage.call(this);if((--E.fparent.data().flips)===0){E.fparent.hide()}this.css({left:0,top:0,right:"auto",bottom:"auto"}).transform("","0% 100%");E.wrapper.transform("","0% 100%");E.fwrapper.hide();if(E.bshadow){E.bshadow.hide()}D.transform("","0% 0%");return this},hideFoldedPage:function(D){var E=this.data().f;if(!E.point){return}var G=this,M=E.point,F=function(){E.point=null;G.flip("hide");G.trigger("end",[false])};if(D){var I=x._c.call(this,M.corner),H=(M.corner.substr(0,1)=="t"),L=(H)?Math.min(0,M.y-I.y)/2:Math.max(0,M.y-I.y)/2,K=h(M.x,M.y+L),J=h(I.x,I.y-L);this.animatef({from:0,to:1,frame:function(N){var O=q(M,K,J,I,N);M.x=O.x;M.y=O.y;x._fold.call(G,M)},complete:F,duration:800,hiding:true})}else{this.animatef(false);F()}},turnPage:function(F){var E=this,G=this.data().f;F={corner:(G.corner)?G.corner.corner:F||x._cAllowed.call(this)[0]};var H=G.point||x._c.call(this,F.corner,(G.opts.turn)?G.opts.turn.data().opts.elevation:0),D=x._c2.call(this,F.corner);this.trigger("flip").animatef({from:0,to:1,frame:function(I){var J=q(H,H,D,D,I);F.x=J.x;F.y=J.y;x._showFoldedPage.call(E,F)},complete:function(){E.trigger("end",[true])},duration:G.opts.duration,turning:true});G.corner=null},moving:function(){return"effect" in this.data()},isTurning:function(){return this.flip("moving")&&this.data().effect.turning},_eventStart:function(E){var D=this.data().f;if(!D.disabled&&!this.flip("isTurning")){D.corner=x._cornerActivated.call(this,E);if(D.corner&&x._foldingPage.call(this,D.corner)){x._moveFoldingPage.call(this,true);this.trigger("pressed",[D.point]);return false}else{D.corner=null}}},_eventMove:function(G){var F=this.data().f;if(!F.disabled){G=(m)?G.originalEvent.touches:[G];if(F.corner){var H=F.parent.offset();F.corner.x=G[0].pageX-H.left;F.corner.y=G[0].pageY-H.top;x._showFoldedPage.call(this,F.corner)}else{if(!this.data().effect&&this.is(":visible")){var E=x._cornerActivated.call(this,G[0]);if(E){var D=x._c.call(this,E.corner,F.opts.cornerSize/2);E.x=D.x;E.y=D.y;x._showFoldedPage.call(this,E,true)}else{x.hideFoldedPage.call(this,true)}}}}},_eventEnd:function(){var E=this.data().f;if(!E.disabled&&E.point){var D=g.Event("released");this.trigger(D,[E.point]);if(!D.isDefaultPrevented()){x.hideFoldedPage.call(this,true)}}E.corner=null},disable:function(D){x.setData.call(this,{disabled:D});return this}},n=function(F,D,E){if(!E[0]||typeof(E[0])=="object"){return D.init.apply(F,E)}else{if(D[E[0]]&&E[0].toString().substr(0,1)!="_"){return D[E[0]].apply(F,Array.prototype.slice.call(E,1))}else{throw E[0]+" is an invalid value"}}};g.extend(g.fn,{flip:function(E,D){return n(this,x,arguments)},turn:function(D){return n(this,z,arguments)},transform:function(E,D){var F={};if(D){F[B+"transform-origin"]=D}F[B+"transform"]=E;return this.css(F)},animatef:function(L){var G=this.data();if(G.effect){clearInterval(G.effect.handle)}if(L){if(!L.to.length){L.to=[L.to]}if(!L.from.length){L.from=[L.from]}if(!L.easing){L.easing=function(N,O,M,Q,P){return Q*Math.sqrt(1-(O=O/P-1)*O)+M}}var F,K=[],J=L.to.length,I=this,D=L.fps||30,E=-D,H=function(){var N,M=[];E=Math.min(L.duration,E+D);for(N=0;N<J;N++){M.push(L.easing(1,E,L.from[N],K[N],L.duration))}L.frame((J==1)?M[0]:M);if(E==L.duration){clearInterval(G.effect.handle);delete G.effect;I.data(G);if(L.complete){L.complete()}}};for(F=0;F<J;F++){K.push(L.to[F]-L.from[F])}G.effect=L;G.effect.handle=setInterval(H,D);this.data(G);H()}else{delete G.effect}}});g.isTouch=m})(jQuery);Array.prototype.contains=function(b){var a=this.length;while(a--){if(this[a]===b){return true}}return false};Array.prototype.clear=function(){var a=this.length;while(a--){this[a]=0}};var timeDiff={start:function(){d=new Date();time=d.getTime()},end:function(){d=new Date();return(d.getTime()-time)}};function Sudoku(){this.matrix=new Array(81);this.matrix.clear();this.level=0;this.shuffle=function(q){for(var m=0;m<9;m++){for(var g=0;g<9;g++){q[m*9+g]=(m*3+Math.floor(m/3)+g)%9+1}}for(var m=0;m<42;m++){var o=Math.ceil(Math.random()*9);var n;do{n=Math.ceil(Math.random()*9)}while(o==n);for(var v=0;v<9;v++){for(var e=0;e<e;k++){if(q[v*9+e]==o){q[v*9+e]=n}else{if(q[v*9+e]==n){q[v*9+e]=o}}}}}for(var p=0;p<42;p++){var t=Math.floor(Math.random()*3);var r=Math.floor(Math.random()*3);for(var v=0;v<9;v++){var l=this.matrix[v*9+(t*3+p%3)];this.matrix[v*9+(t*3+p%3)]=this.matrix[v*9+(r*3+p%3)];this.matrix[v*9+(r*3+p%3)]=l}}for(var u=0;u<42;u++){var h=Math.floor(Math.random()*3);var f=Math.floor(Math.random()*3);for(var v=0;v<9;v++){var l=this.matrix[v*9+(u%3*3+h)];this.matrix[v*9+(u%3*3+h)]=this.matrix[v*9+(u%3*3+f)];this.matrix[v*9+(u%3*3+f)]=l}}for(var u=0;u<42;u++){var b=Math.floor(Math.random()*3);var a=Math.floor(Math.random()*3);for(var e=0;e<9;e++){var l=this.matrix[(u%3*3+b)*9+e];this.matrix[(u%3*3+b)*9+e]=this.matrix[(u%3*3+a)*9+e];this.matrix[(u%3*3+a)*9+e]=l}}};this.maskBoardEasy=function(e,a){var g,f,b;for(g=0;g<81;g++){a[g]=e[g]}for(var g=0;g<3;g++){for(var f=0;f<3;f++){for(var b=0;b<5;b++){var h;do{h=Math.floor(Math.random()*9)}while(a[(g*3+Math.floor(h/3))*9+f*3+h%3]==0);a[(g*3+Math.floor(h/3))*9+f*3+h%3]=0}}}};this.getAvailable=function(m,n,h){var f,e,o,b,a,l;var g=new Array(9);g.clear();o=Math.floor(n/9);b=n%9;for(f=0;f<9;f++){e=o*9+f;if(m[e]>0){g[m[e]-1]=1}}for(f=0;f<9;f++){e=f*9+b;if(m[e]>0){g[m[e]-1]=1}}a=o-o%3;l=b-b%3;for(f=a;f<a+3;f++){for(e=l;e<l+3;e++){if(m[f*9+e]>0){g[m[f*9+e]-1]=1}}}e=0;if(h!=null){for(f=0;f<9;f++){if(g[f]==0){h[e++]=f+1}}}else{for(f=0;f<9;f++){if(g[f]==0){e++}}return e}if(e==0){return 0}for(f=0;f<18;f++){a=Math.floor(Math.random()*e);l=Math.floor(Math.random()*e);o=h[a];h[a]=h[l];h[l]=o}return e};this.getCell=function(b){var a=-1,g=10,e,c;var f=new Array(9);f.clear();for(e=0;e<81;e++){if(b[e]==0){c=this.getAvailable(b,e,null);if(c<g){g=c;a=e}if(g==1){break}}}return a};this.solve=function(b){var f,e,c=0;var a=this.getCell(b);if(a==-1){return 1}var g=new Array(9);g.clear();e=this.getAvailable(b,a,g);for(f=0;f<e;f++){b[a]=g[f];if(this.solve(b)==1){return 1}}b[a]=0;return 0};this.enumSolutions=function(b){var f,e,c=0;var a=this.getCell(b);if(a==-1){return 1}var g=new Array(9);g.clear();e=this.getAvailable(b,a,g);for(f=0;f<e;f++){b[a]=g[f];c+=this.enumSolutions(b);if(c>1){break}}b[a]=0;return c};this.maskBoard=function(q,w){var x,s,p,l,y,m=0,A,o=0,b,B;var h=new Array(9);h.clear();var z=new Array(81);z.clear();w.clear();do{do{b=Math.floor(Math.random()*81)}while((w[b]!=0)||(z[b]!=0));B=q[b];x=this.getAvailable(w,b,null);if(x>1){var u,f=Math.floor(b/9),e=b%9;u=0;for(x=0;x<9;x++){if(x==e){continue}s=f*9+x;if(w[s]>0){continue}A=this.getAvailable(w,s,h);for(s=0;s<A;s++){if(h[s]==B){u++;break}h[s]=0}}if(u>0){u=0;for(x=0;x<9;x++){if(x==f){continue}s=x*9+e;if(w[s]>0){continue}A=this.getAvailable(w,s,h);for(s=0;s<A;s++){if(h[s]==B){u++;break}h[s]=0}}if(u>0){u=0;l=f-f%3;y=e-e%3;for(x=l;x<l+3;x++){for(s=y;s<y+3;s++){if((x==f)&&(s==e)){continue}p=x*9+s;if(w[p]>0){continue}A=this.getAvailable(w,p,h);for(p=0;p<A;p++){if(h[p]==B){u++;break}h[p]=0}}}if(u>0){w[b]=B;o++}}}}z[b]=1;m++}while(m<81);do{do{b=Math.floor(Math.random()*81)}while((w[b]==0)||(z[b]==0));B=w[b];var g=this;var v=0;w[b]=0;v=this.enumSolutions(w);if(v>1){w[b]=B}z[b]=0;o--}while(o>0)};this._checkVal=function(a,l,e,h){var f,b,g,m;for(f=0;f<9;f++){if((f!=e)&&(a[l*9+f]==h)){return false}}for(f=0;f<9;f++){if((f!=l)&&(a[f*9+e]==h)){return false}}g=l-l%3;m=e-e%3;for(f=g;f<g+3;f++){for(b=m;b<m+3;b++){if(((f!=l)||(b!=e))&&(a[f*9+b]==h)){return false}}}return true};this.checkVal=function(c,a,b){return this._checkVal(this.matrix,c,a,b)};this.setVal=function(c,a,b){this.matrix[c*9+a]=b};this.getVal=function(b,a){return this.matrix[b*9+a]};this._newGame=function(){var c,e=0;var b=new Array(81);this.matrix.clear();this.solve(this.matrix);if(this.level==0){this.maskBoardEasy(this.matrix,b)}else{this.maskBoard(this.matrix,b);if(this.level==1){for(c=0;c<4;c++){do{var a=Math.floor(Math.random()*81)}while(b[a]!=0);b[a]=this.matrix[a]}}}this.save=this.matrix;this.matrix=b;timeDiff.start()};this.done;this._doHints=function(e,b,c,g){if(g>0){do{cell=Math.floor(Math.random()*81)}while((b[cell]==0)||(c[cell]==0));val=b[cell];var f=this;var a=0;b[cell]=0;a=this.enumSolutions(b);if(a>1){b[cell]=val}c[cell]=0;g--;var f=this;setTimeout(function(){f._doHints(e,b,c,g)},50)}else{this.save=this.matrix;this.matrix=b;this.done()}};this._doMask=function(q,v){var w,s,p,l,x,m=0,z,o=0,b,A;var h=new Array(9);h.clear();var y=new Array(81);y.clear();v.clear();do{do{b=Math.floor(Math.random()*81)}while((v[b]!=0)||(y[b]!=0));A=q[b];w=this.getAvailable(v,b,null);if(w>1){var u,f=Math.floor(b/9),e=b%9;u=0;for(w=0;w<9;w++){if(w==e){continue}s=f*9+w;if(v[s]>0){continue}z=this.getAvailable(v,s,h);for(s=0;s<z;s++){if(h[s]==A){u++;break}h[s]=0}}if(u>0){u=0;for(w=0;w<9;w++){if(w==f){continue}s=w*9+e;if(v[s]>0){continue}z=this.getAvailable(v,s,h);for(s=0;s<z;s++){if(h[s]==A){u++;break}h[s]=0}}if(u>0){u=0;l=f-f%3;x=e-e%3;for(w=l;w<l+3;w++){for(s=x;s<x+3;s++){if((w==f)&&(s==e)){continue}p=w*9+s;if(v[p]>0){continue}z=this.getAvailable(v,p,h);for(p=0;p<z;p++){if(h[p]==A){u++;break}h[p]=0}}}if(u>0){v[b]=A;o++}}}}y[b]=1;m++}while(m<81);var g=this;setTimeout(function(){g._doHints(q,v,y,o)},50)};this.newGame=function(){var c,e=0;var b=new Array(81);this.matrix.clear();this.solve(this.matrix);if(this.level==0){this.maskBoardEasy(this.matrix,b);this.save=this.matrix;this.matrix=b;timeDiff.start();this.done()}else{this._doMask(this.matrix,b);if(this.level==1){for(c=0;c<4;c++){do{var a=Math.floor(Math.random()*81)}while(b[a]!=0);b[a]=this.matrix[a]}}}};this.solveGame=function(){this.matrix=this.save};this.gameFinished=function(){for(var b=0;b<9;b++){for(var a=0;a<9;a++){var c=this.matrix[b*9+a];if((c==0)||(this._checkVal(this.matrix,b,a,c)==false)){return 0}}}return timeDiff.end()}};/*!
 * jQuery Cookie Plugin v1.3.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */
(function (factory) {
	if (typeof define === 'function' && define.amd) {
		// AMD. Register as anonymous module.
		define(['jquery'], factory);
	} else {
		// Browser globals.
		factory(jQuery);
	}
}(function ($) {

	var pluses = /\+/g;

	function raw(s) {
		return s;
	}

	function decoded(s) {
		return decodeURIComponent(s.replace(pluses, ' '));
	}

	function converted(s) {
		if (s.indexOf('"') === 0) {
			// This is a quoted cookie as according to RFC2068, unescape
			s = s.slice(1, -1).replace(/\\"/g, '"').replace(/\\\\/g, '\\');
		}
		try {
			return config.json ? JSON.parse(s) : s;
		} catch(er) {}
	}

	var config = $.cookie = function (key, value, options) {

		// write
		if (value !== undefined) {
			options = $.extend({}, config.defaults, options);

			if (typeof options.expires === 'number') {
				var days = options.expires, t = options.expires = new Date();
				t.setDate(t.getDate() + days);
			}

			value = config.json ? JSON.stringify(value) : String(value);

			return (document.cookie = [
				config.raw ? key : encodeURIComponent(key),
				'=',
				config.raw ? value : encodeURIComponent(value),
				options.expires ? '; expires=' + options.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE
				options.path    ? '; path=' + options.path : '',
				options.domain  ? '; domain=' + options.domain : '',
				options.secure  ? '; secure' : ''
			].join(''));
		}

		// read
		var decode = config.raw ? raw : decoded;
		var cookies = document.cookie.split('; ');
		var result = key ? undefined : {};
		for (var i = 0, l = cookies.length; i < l; i++) {
			var parts = cookies[i].split('=');
			var name = decode(parts.shift());
			var cookie = decode(parts.join('='));

			if (key && key === name) {
				result = converted(cookie);
				break;
			}

			if (!key) {
				result[name] = converted(cookie);
			}
		}

		return result;
	};

	config.defaults = {};

	$.removeCookie = function (key, options) {
		if ($.cookie(key) !== undefined) {
			// Must not alter options, thus extending a fresh object...
			$.cookie(key, '', $.extend({}, options, { expires: -1 }));
			return true;
		}
		return false;
	};

}));
/*!
 * jQuery resize event - v1.1 - 3/14/2010
 * http://benalman.com/projects/jquery-resize-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */

// Script: jQuery resize event
//
// *Version: 1.1, Last updated: 3/14/2010*
// 
// Project Home - http://benalman.com/projects/jquery-resize-plugin/
// GitHub       - http://github.com/cowboy/jquery-resize/
// Source       - http://github.com/cowboy/jquery-resize/raw/master/jquery.ba-resize.js
// (Minified)   - http://github.com/cowboy/jquery-resize/raw/master/jquery.ba-resize.min.js (1.0kb)
// 
// About: License
// 
// Copyright (c) 2010 "Cowboy" Ben Alman,
// Dual licensed under the MIT and GPL licenses.
// http://benalman.com/about/license/
// 
// About: Examples
// 
// This working example, complete with fully commented code, illustrates a few
// ways in which this plugin can be used.
// 
// resize event - http://benalman.com/code/projects/jquery-resize/examples/resize/
// 
// About: Support and Testing
// 
// Information about what version or versions of jQuery this plugin has been
// tested with, what browsers it has been tested in, and where the unit tests
// reside (so you can test it yourself).
// 
// jQuery Versions - 1.3.2, 1.4.1, 1.4.2
// Browsers Tested - Internet Explorer 6-8, Firefox 2-3.6, Safari 3-4, Chrome, Opera 9.6-10.1.
// Unit Tests      - http://benalman.com/code/projects/jquery-resize/unit/
// 
// About: Release History
// 
// 1.1 - (3/14/2010) Fixed a minor bug that was causing the event to trigger
//       immediately after bind in some circumstances. Also changed $.fn.data
//       to $.data to improve performance.
// 1.0 - (2/10/2010) Initial release

(function($,window,undefined){
  '$:nomunge'; // Used by YUI compressor.
  
  // A jQuery object containing all non-window elements to which the resize
  // event is bound.
  var elems = $([]),
    
    // Extend $.resize if it already exists, otherwise create it.
    jq_resize = $.resize = $.extend( $.resize, {} ),
    
    timeout_id,
    
    // Reused strings.
    str_setTimeout = 'setTimeout',
    str_resize = 'resize',
    str_data = str_resize + '-special-event',
    str_delay = 'delay',
    str_throttle = 'throttleWindow';
  
  // Property: jQuery.resize.delay
  // 
  // The numeric interval (in milliseconds) at which the resize event polling
  // loop executes. Defaults to 250.
  
  jq_resize[ str_delay ] = 250;
  
  // Property: jQuery.resize.throttleWindow
  // 
  // Throttle the native window object resize event to fire no more than once
  // every <jQuery.resize.delay> milliseconds. Defaults to true.
  // 
  // Because the window object has its own resize event, it doesn't need to be
  // provided by this plugin, and its execution can be left entirely up to the
  // browser. However, since certain browsers fire the resize event continuously
  // while others do not, enabling this will throttle the window resize event,
  // making event behavior consistent across all elements in all browsers.
  // 
  // While setting this property to false will disable window object resize
  // event throttling, please note that this property must be changed before any
  // window object resize event callbacks are bound.
  
  jq_resize[ str_throttle ] = true;
  
  // Event: resize event
  // 
  // Fired when an element's width or height changes. Because browsers only
  // provide this event for the window element, for other elements a polling
  // loop is initialized, running every <jQuery.resize.delay> milliseconds
  // to see if elements' dimensions have changed. You may bind with either
  // .resize( fn ) or .bind( "resize", fn ), and unbind with .unbind( "resize" ).
  // 
  // Usage:
  // 
  // > jQuery('selector').bind( 'resize', function(e) {
  // >   // element's width or height has changed!
  // >   ...
  // > });
  // 
  // Additional Notes:
  // 
  // * The polling loop is not created until at least one callback is actually
  //   bound to the 'resize' event, and this single polling loop is shared
  //   across all elements.
  // 
  // Double firing issue in jQuery 1.3.2:
  // 
  // While this plugin works in jQuery 1.3.2, if an element's event callbacks
  // are manually triggered via .trigger( 'resize' ) or .resize() those
  // callbacks may double-fire, due to limitations in the jQuery 1.3.2 special
  // events system. This is not an issue when using jQuery 1.4+.
  // 
  // > // While this works in jQuery 1.4+
  // > $(elem).css({ width: new_w, height: new_h }).resize();
  // > 
  // > // In jQuery 1.3.2, you need to do this:
  // > var elem = $(elem);
  // > elem.css({ width: new_w, height: new_h });
  // > elem.data( 'resize-special-event', { width: elem.width(), height: elem.height() } );
  // > elem.resize();
      
  $.event.special[ str_resize ] = {
    
    // Called only when the first 'resize' event callback is bound per element.
    setup: function() {
      // Since window has its own native 'resize' event, return false so that
      // jQuery will bind the event using DOM methods. Since only 'window'
      // objects have a .setTimeout method, this should be a sufficient test.
      // Unless, of course, we're throttling the 'resize' event for window.
      if ( !jq_resize[ str_throttle ] && this[ str_setTimeout ] ) { return false; }
      
      var elem = $(this);
      
      // Add this element to the list of internal elements to monitor.
      elems = elems.add( elem );
      
      // Initialize data store on the element.
      $.data( this, str_data, { w: elem.width(), h: elem.height() } );
      
      // If this is the first element added, start the polling loop.
      if ( elems.length === 1 ) {
        loopy();
      }
    },
    
    // Called only when the last 'resize' event callback is unbound per element.
    teardown: function() {
      // Since window has its own native 'resize' event, return false so that
      // jQuery will unbind the event using DOM methods. Since only 'window'
      // objects have a .setTimeout method, this should be a sufficient test.
      // Unless, of course, we're throttling the 'resize' event for window.
      if ( !jq_resize[ str_throttle ] && this[ str_setTimeout ] ) { return false; }
      
      var elem = $(this);
      
      // Remove this element from the list of internal elements to monitor.
      elems = elems.not( elem );
      
      // Remove any data stored on the element.
      elem.removeData( str_data );
      
      // If this is the last element removed, stop the polling loop.
      if ( !elems.length ) {
        clearTimeout( timeout_id );
      }
    },
    
    // Called every time a 'resize' event callback is bound per element (new in
    // jQuery 1.4).
    add: function( handleObj ) {
      // Since window has its own native 'resize' event, return false so that
      // jQuery doesn't modify the event object. Unless, of course, we're
      // throttling the 'resize' event for window.
      if ( !jq_resize[ str_throttle ] && this[ str_setTimeout ] ) { return false; }
      
      var old_handler;
      
      // The new_handler function is executed every time the event is triggered.
      // This is used to update the internal element data store with the width
      // and height when the event is triggered manually, to avoid double-firing
      // of the event callback. See the "Double firing issue in jQuery 1.3.2"
      // comments above for more information.
      
      function new_handler( e, w, h ) {
        var elem = $(this),
          data = $.data( this, str_data );
        
        // If called from the polling loop, w and h will be passed in as
        // arguments. If called manually, via .trigger( 'resize' ) or .resize(),
        // those values will need to be computed.
        data.w = w !== undefined ? w : elem.width();
        data.h = h !== undefined ? h : elem.height();
        
        old_handler.apply( this, arguments );
      };
      
      // This may seem a little complicated, but it normalizes the special event
      // .add method between jQuery 1.4/1.4.1 and 1.4.2+
      if ( $.isFunction( handleObj ) ) {
        // 1.4, 1.4.1
        old_handler = handleObj;
        return new_handler;
      } else {
        // 1.4.2+
        old_handler = handleObj.handler;
        handleObj.handler = new_handler;
      }
    }
    
  };
  
  function loopy() {
    
    // Start the polling loop, asynchronously.
    timeout_id = window[ str_setTimeout ](function(){
      
      // Iterate over all elements to which the 'resize' event is bound.
      elems.each(function(){
        var elem = $(this),
          width = elem.width(),
          height = elem.height(),
          data = $.data( this, str_data );
        
        // If element size has changed since the last time, update the element
        // data store and trigger the 'resize' event.
        if ( width !== data.w || height !== data.h ) {
          elem.trigger( str_resize, [ data.w = width, data.h = height ] );
        }
        
      });
      
      // Loop.
      loopy();
      
    }, jq_resize[ str_delay ] );
    
  };
  
})(jQuery,this);
/*!
 * jQuery Transit - CSS3 transitions and transformations
 * (c) 2011-2012 Rico Sta. Cruz <rico@ricostacruz.com>
 * MIT Licensed.
 *
 * http://ricostacruz.com/jquery.transit
 * http://github.com/rstacruz/jquery.transit
 */

(function($) {
  $.transit = {
    version: "0.9.9",

    // Map of $.css() keys to values for 'transitionProperty'.
    // See https://developer.mozilla.org/en/CSS/CSS_transitions#Properties_that_can_be_animated
    propertyMap: {
      marginLeft    : 'margin',
      marginRight   : 'margin',
      marginBottom  : 'margin',
      marginTop     : 'margin',
      paddingLeft   : 'padding',
      paddingRight  : 'padding',
      paddingBottom : 'padding',
      paddingTop    : 'padding'
    },

    // Will simply transition "instantly" if false
    enabled: true,

    // Set this to false if you don't want to use the transition end property.
    useTransitionEnd: false
  };

  var div = document.createElement('div');
  var support = {};

  // Helper function to get the proper vendor property name.
  // (`transition` => `WebkitTransition`)
  function getVendorPropertyName(prop) {
    // Handle unprefixed versions (FF16+, for example)
    if (prop in div.style) return prop;

    var prefixes = ['Moz', 'Webkit', 'O', 'ms'];
    var prop_ = prop.charAt(0).toUpperCase() + prop.substr(1);

    if (prop in div.style) { return prop; }

    for (var i=0; i<prefixes.length; ++i) {
      var vendorProp = prefixes[i] + prop_;
      if (vendorProp in div.style) { return vendorProp; }
    }
  }

  // Helper function to check if transform3D is supported.
  // Should return true for Webkits and Firefox 10+.
  function checkTransform3dSupport() {
    div.style[support.transform] = '';
    div.style[support.transform] = 'rotateY(90deg)';
    return div.style[support.transform] !== '';
  }

  var isChrome = navigator.userAgent.toLowerCase().indexOf('chrome') > -1;

  // Check for the browser's transitions support.
  support.transition      = getVendorPropertyName('transition');
  support.transitionDelay = getVendorPropertyName('transitionDelay');
  support.transform       = getVendorPropertyName('transform');
  support.transformOrigin = getVendorPropertyName('transformOrigin');
  support.transform3d     = checkTransform3dSupport();

  var eventNames = {
    'transition':       'transitionEnd',
    'MozTransition':    'transitionend',
    'OTransition':      'oTransitionEnd',
    'WebkitTransition': 'webkitTransitionEnd',
    'msTransition':     'MSTransitionEnd'
  };

  // Detect the 'transitionend' event needed.
  var transitionEnd = support.transitionEnd = eventNames[support.transition] || null;

  // Populate jQuery's `$.support` with the vendor prefixes we know.
  // As per [jQuery's cssHooks documentation](http://api.jquery.com/jQuery.cssHooks/),
  // we set $.support.transition to a string of the actual property name used.
  for (var key in support) {
    if (support.hasOwnProperty(key) && typeof $.support[key] === 'undefined') {
      $.support[key] = support[key];
    }
  }

  // Avoid memory leak in IE.
  div = null;

  // ## $.cssEase
  // List of easing aliases that you can use with `$.fn.transition`.
  $.cssEase = {
    '_default':       'ease',
    'in':             'ease-in',
    'out':            'ease-out',
    'in-out':         'ease-in-out',
    'snap':           'cubic-bezier(0,1,.5,1)',
    // Penner equations
    'easeOutCubic':   'cubic-bezier(.215,.61,.355,1)',
    'easeInOutCubic': 'cubic-bezier(.645,.045,.355,1)',
    'easeInCirc':     'cubic-bezier(.6,.04,.98,.335)',
    'easeOutCirc':    'cubic-bezier(.075,.82,.165,1)',
    'easeInOutCirc':  'cubic-bezier(.785,.135,.15,.86)',
    'easeInExpo':     'cubic-bezier(.95,.05,.795,.035)',
    'easeOutExpo':    'cubic-bezier(.19,1,.22,1)',
    'easeInOutExpo':  'cubic-bezier(1,0,0,1)',
    'easeInQuad':     'cubic-bezier(.55,.085,.68,.53)',
    'easeOutQuad':    'cubic-bezier(.25,.46,.45,.94)',
    'easeInOutQuad':  'cubic-bezier(.455,.03,.515,.955)',
    'easeInQuart':    'cubic-bezier(.895,.03,.685,.22)',
    'easeOutQuart':   'cubic-bezier(.165,.84,.44,1)',
    'easeInOutQuart': 'cubic-bezier(.77,0,.175,1)',
    'easeInQuint':    'cubic-bezier(.755,.05,.855,.06)',
    'easeOutQuint':   'cubic-bezier(.23,1,.32,1)',
    'easeInOutQuint': 'cubic-bezier(.86,0,.07,1)',
    'easeInSine':     'cubic-bezier(.47,0,.745,.715)',
    'easeOutSine':    'cubic-bezier(.39,.575,.565,1)',
    'easeInOutSine':  'cubic-bezier(.445,.05,.55,.95)',
    'easeInBack':     'cubic-bezier(.6,-.28,.735,.045)',
    'easeOutBack':    'cubic-bezier(.175, .885,.32,1.275)',
    'easeInOutBack':  'cubic-bezier(.68,-.55,.265,1.55)'
  };

  // ## 'transform' CSS hook
  // Allows you to use the `transform` property in CSS.
  //
  //     $("#hello").css({ transform: "rotate(90deg)" });
  //
  //     $("#hello").css('transform');
  //     //=> { rotate: '90deg' }
  //
  $.cssHooks['transit:transform'] = {
    // The getter returns a `Transform` object.
    get: function(elem) {
      return $(elem).data('transform') || new Transform();
    },

    // The setter accepts a `Transform` object or a string.
    set: function(elem, v) {
      var value = v;

      if (!(value instanceof Transform)) {
        value = new Transform(value);
      }

      // We've seen the 3D version of Scale() not work in Chrome when the
      // element being scaled extends outside of the viewport.  Thus, we're
      // forcing Chrome to not use the 3d transforms as well.  Not sure if
      // translate is affectede, but not risking it.  Detection code from
      // http://davidwalsh.name/detecting-google-chrome-javascript
      if (support.transform === 'WebkitTransform' && !isChrome) {
        elem.style[support.transform] = value.toString(true);
      } else {
        elem.style[support.transform] = value.toString();
      }

      $(elem).data('transform', value);
    }
  };

  // Add a CSS hook for `.css({ transform: '...' })`.
  // In jQuery 1.8+, this will intentionally override the default `transform`
  // CSS hook so it'll play well with Transit. (see issue #62)
  $.cssHooks.transform = {
    set: $.cssHooks['transit:transform'].set
  };

  // jQuery 1.8+ supports prefix-free transitions, so these polyfills will not
  // be necessary.
  if ($.fn.jquery < "1.8") {
    // ## 'transformOrigin' CSS hook
    // Allows the use for `transformOrigin` to define where scaling and rotation
    // is pivoted.
    //
    //     $("#hello").css({ transformOrigin: '0 0' });
    //
    $.cssHooks.transformOrigin = {
      get: function(elem) {
        return elem.style[support.transformOrigin];
      },
      set: function(elem, value) {
        elem.style[support.transformOrigin] = value;
      }
    };

    // ## 'transition' CSS hook
    // Allows you to use the `transition` property in CSS.
    //
    //     $("#hello").css({ transition: 'all 0 ease 0' });
    //
    $.cssHooks.transition = {
      get: function(elem) {
        return elem.style[support.transition];
      },
      set: function(elem, value) {
        elem.style[support.transition] = value;
      }
    };
  }

  // ## Other CSS hooks
  // Allows you to rotate, scale and translate.
  registerCssHook('scale');
  registerCssHook('translate');
  registerCssHook('rotate');
  registerCssHook('rotateX');
  registerCssHook('rotateY');
  registerCssHook('rotate3d');
  registerCssHook('perspective');
  registerCssHook('skewX');
  registerCssHook('skewY');
  registerCssHook('x', true);
  registerCssHook('y', true);

  // ## Transform class
  // This is the main class of a transformation property that powers
  // `$.fn.css({ transform: '...' })`.
  //
  // This is, in essence, a dictionary object with key/values as `-transform`
  // properties.
  //
  //     var t = new Transform("rotate(90) scale(4)");
  //
  //     t.rotate             //=> "90deg"
  //     t.scale              //=> "4,4"
  //
  // Setters are accounted for.
  //
  //     t.set('rotate', 4)
  //     t.rotate             //=> "4deg"
  //
  // Convert it to a CSS string using the `toString()` and `toString(true)` (for WebKit)
  // functions.
  //
  //     t.toString()         //=> "rotate(90deg) scale(4,4)"
  //     t.toString(true)     //=> "rotate(90deg) scale3d(4,4,0)" (WebKit version)
  //
  function Transform(str) {
    if (typeof str === 'string') { this.parse(str); }
    return this;
  }

  Transform.prototype = {
    // ### setFromString()
    // Sets a property from a string.
    //
    //     t.setFromString('scale', '2,4');
    //     // Same as set('scale', '2', '4');
    //
    setFromString: function(prop, val) {
      var args =
        (typeof val === 'string')  ? val.split(',') :
        (val.constructor === Array) ? val :
        [ val ];

      args.unshift(prop);

      Transform.prototype.set.apply(this, args);
    },

    // ### set()
    // Sets a property.
    //
    //     t.set('scale', 2, 4);
    //
    set: function(prop) {
      var args = Array.prototype.slice.apply(arguments, [1]);
      if (this.setter[prop]) {
        this.setter[prop].apply(this, args);
      } else {
        this[prop] = args.join(',');
      }
    },

    get: function(prop) {
      if (this.getter[prop]) {
        return this.getter[prop].apply(this);
      } else {
        return this[prop] || 0;
      }
    },

    setter: {
      // ### rotate
      //
      //     .css({ rotate: 30 })
      //     .css({ rotate: "30" })
      //     .css({ rotate: "30deg" })
      //     .css({ rotate: "30deg" })
      //
      rotate: function(theta) {
        this.rotate = unit(theta, 'deg');
      },

      rotateX: function(theta) {
        this.rotateX = unit(theta, 'deg');
      },

      rotateY: function(theta) {
        this.rotateY = unit(theta, 'deg');
      },

      // ### scale
      //
      //     .css({ scale: 9 })      //=> "scale(9,9)"
      //     .css({ scale: '3,2' })  //=> "scale(3,2)"
      //
      scale: function(x, y) {
        if (y === undefined) { y = x; }
        this.scale = x + "," + y;
      },

      // ### skewX + skewY
      skewX: function(x) {
        this.skewX = unit(x, 'deg');
      },

      skewY: function(y) {
        this.skewY = unit(y, 'deg');
      },

      // ### perspectvie
      perspective: function(dist) {
        this.perspective = unit(dist, 'px');
      },

      // ### x / y
      // Translations. Notice how this keeps the other value.
      //
      //     .css({ x: 4 })       //=> "translate(4px, 0)"
      //     .css({ y: 10 })      //=> "translate(4px, 10px)"
      //
      x: function(x) {
        this.set('translate', x, null);
      },

      y: function(y) {
        this.set('translate', null, y);
      },

      // ### translate
      // Notice how this keeps the other value.
      //
      //     .css({ translate: '2, 5' })    //=> "translate(2px, 5px)"
      //
      translate: function(x, y) {
        if (this._translateX === undefined) { this._translateX = 0; }
        if (this._translateY === undefined) { this._translateY = 0; }

        if (x !== null && x !== undefined) { this._translateX = unit(x, 'px'); }
        if (y !== null && y !== undefined) { this._translateY = unit(y, 'px'); }

        this.translate = this._translateX + "," + this._translateY;
      }
    },

    getter: {
      x: function() {
        return this._translateX || 0;
      },

      y: function() {
        return this._translateY || 0;
      },

      scale: function() {
        var s = (this.scale || "1,1").split(',');
        if (s[0]) { s[0] = parseFloat(s[0]); }
        if (s[1]) { s[1] = parseFloat(s[1]); }

        // "2.5,2.5" => 2.5
        // "2.5,1" => [2.5,1]
        return (s[0] === s[1]) ? s[0] : s;
      },

      rotate3d: function() {
        var s = (this.rotate3d || "0,0,0,0deg").split(',');
        for (var i=0; i<=3; ++i) {
          if (s[i]) { s[i] = parseFloat(s[i]); }
        }
        if (s[3]) { s[3] = unit(s[3], 'deg'); }

        return s;
      }
    },

    // ### parse()
    // Parses from a string. Called on constructor.
    parse: function(str) {
      var self = this;
      str.replace(/([a-zA-Z0-9]+)\((.*?)\)/g, function(x, prop, val) {
        self.setFromString(prop, val);
      });
    },

    // ### toString()
    // Converts to a `transition` CSS property string. If `use3d` is given,
    // it converts to a `-webkit-transition` CSS property string instead.
    toString: function(use3d) {
      var re = [];

      for (var i in this) {
        if (this.hasOwnProperty(i)) {
          // Don't use 3D transformations if the browser can't support it.
          if ((!support.transform3d) && (
            (i === 'rotateX') ||
            (i === 'rotateY') ||
            (i === 'perspective') ||
            (i === 'transformOrigin'))) { continue; }

          if (i[0] !== '_') {
            if (use3d && (i === 'scale')) {
              re.push(i + "3d(" + this[i] + ",1)");
            } else if (use3d && (i === 'translate')) {
              re.push(i + "3d(" + this[i] + ",0)");
            } else {
              re.push(i + "(" + this[i] + ")");
            }
          }
        }
      }

      return re.join(" ");
    }
  };

  function callOrQueue(self, queue, fn) {
    if (queue === true) {
      self.queue(fn);
    } else if (queue) {
      self.queue(queue, fn);
    } else {
      fn();
    }
  }

  // ### getProperties(dict)
  // Returns properties (for `transition-property`) for dictionary `props`. The
  // value of `props` is what you would expect in `$.css(...)`.
  function getProperties(props) {
    var re = [];

    $.each(props, function(key) {
      key = $.camelCase(key); // Convert "text-align" => "textAlign"
      key = $.transit.propertyMap[key] || $.cssProps[key] || key;
      key = uncamel(key); // Convert back to dasherized

      if ($.inArray(key, re) === -1) { re.push(key); }
    });

    return re;
  }

  // ### getTransition()
  // Returns the transition string to be used for the `transition` CSS property.
  //
  // Example:
  //
  //     getTransition({ opacity: 1, rotate: 30 }, 500, 'ease');
  //     //=> 'opacity 500ms ease, -webkit-transform 500ms ease'
  //
  function getTransition(properties, duration, easing, delay) {
    // Get the CSS properties needed.
    var props = getProperties(properties);

    // Account for aliases (`in` => `ease-in`).
    if ($.cssEase[easing]) { easing = $.cssEase[easing]; }

    // Build the duration/easing/delay attributes for it.
    var attribs = '' + toMS(duration) + ' ' + easing;
    if (parseInt(delay, 10) > 0) { attribs += ' ' + toMS(delay); }

    // For more properties, add them this way:
    // "margin 200ms ease, padding 200ms ease, ..."
    var transitions = [];
    $.each(props, function(i, name) {
      transitions.push(name + ' ' + attribs);
    });

    return transitions.join(', ');
  }

  // ## $.fn.transition
  // Works like $.fn.animate(), but uses CSS transitions.
  //
  //     $("...").transition({ opacity: 0.1, scale: 0.3 });
  //
  //     // Specific duration
  //     $("...").transition({ opacity: 0.1, scale: 0.3 }, 500);
  //
  //     // With duration and easing
  //     $("...").transition({ opacity: 0.1, scale: 0.3 }, 500, 'in');
  //
  //     // With callback
  //     $("...").transition({ opacity: 0.1, scale: 0.3 }, function() { ... });
  //
  //     // With everything
  //     $("...").transition({ opacity: 0.1, scale: 0.3 }, 500, 'in', function() { ... });
  //
  //     // Alternate syntax
  //     $("...").transition({
  //       opacity: 0.1,
  //       duration: 200,
  //       delay: 40,
  //       easing: 'in',
  //       complete: function() { /* ... */ }
  //      });
  //
  $.fn.transition = $.fn.transit = function(properties, duration, easing, callback) {
    var self  = this;
    var delay = 0;
    var queue = true;

    // Account for `.transition(properties, callback)`.
    if (typeof duration === 'function') {
      callback = duration;
      duration = undefined;
    }

    // Account for `.transition(properties, duration, callback)`.
    if (typeof easing === 'function') {
      callback = easing;
      easing = undefined;
    }

    // Alternate syntax.
    if (typeof properties.easing !== 'undefined') {
      easing = properties.easing;
      delete properties.easing;
    }

    if (typeof properties.duration !== 'undefined') {
      duration = properties.duration;
      delete properties.duration;
    }

    if (typeof properties.complete !== 'undefined') {
      callback = properties.complete;
      delete properties.complete;
    }

    if (typeof properties.queue !== 'undefined') {
      queue = properties.queue;
      delete properties.queue;
    }

    if (typeof properties.delay !== 'undefined') {
      delay = properties.delay;
      delete properties.delay;
    }

    // Set defaults. (`400` duration, `ease` easing)
    if (typeof duration === 'undefined') { duration = $.fx.speeds._default; }
    if (typeof easing === 'undefined')   { easing = $.cssEase._default; }

    duration = toMS(duration);

    // Build the `transition` property.
    var transitionValue = getTransition(properties, duration, easing, delay);

    // Compute delay until callback.
    // If this becomes 0, don't bother setting the transition property.
    var work = $.transit.enabled && support.transition;
    var i = work ? (parseInt(duration, 10) + parseInt(delay, 10)) : 0;

    // If there's nothing to do...
    if (i === 0) {
      var fn = function(next) {
        self.css(properties);
        if (callback) { callback.apply(self); }
        if (next) { next(); }
      };

      callOrQueue(self, queue, fn);
      return self;
    }

    // Save the old transitions of each element so we can restore it later.
    var oldTransitions = {};

    var run = function(nextCall) {
      var bound = false;

      // Prepare the callback.
      var cb = function() {
        if (bound) { self.unbind(transitionEnd, cb); }

        if (i > 0) {
          self.each(function() {
            this.style[support.transition] = (oldTransitions[this] || null);
          });
        }

        if (typeof callback === 'function') { callback.apply(self); }
        if (typeof nextCall === 'function') { nextCall(); }
      };

      if ((i > 0) && (transitionEnd) && ($.transit.useTransitionEnd)) {
        // Use the 'transitionend' event if it's available.
        bound = true;
        self.bind(transitionEnd, cb);
      } else {
        // Fallback to timers if the 'transitionend' event isn't supported.
        window.setTimeout(cb, i);
      }

      // Apply transitions.
      self.each(function() {
        if (i > 0) {
          this.style[support.transition] = transitionValue;
        }
        $(this).css(properties);
      });
    };

    // Defer running. This allows the browser to paint any pending CSS it hasn't
    // painted yet before doing the transitions.
    var deferredRun = function(next) {
        this.offsetWidth; // force a repaint
        run(next);
    };

    // Use jQuery's fx queue.
    callOrQueue(self, queue, deferredRun);

    // Chainability.
    return this;
  };

  function registerCssHook(prop, isPixels) {
    // For certain properties, the 'px' should not be implied.
    if (!isPixels) { $.cssNumber[prop] = true; }

    $.transit.propertyMap[prop] = support.transform;

    $.cssHooks[prop] = {
      get: function(elem) {
        var t = $(elem).css('transit:transform');
        return t.get(prop);
      },

      set: function(elem, value) {
        var t = $(elem).css('transit:transform');
        t.setFromString(prop, value);

        $(elem).css({ 'transit:transform': t });
      }
    };

  }

  // ### uncamel(str)
  // Converts a camelcase string to a dasherized string.
  // (`marginLeft` => `margin-left`)
  function uncamel(str) {
    return str.replace(/([A-Z])/g, function(letter) { return '-' + letter.toLowerCase(); });
  }

  // ### unit(number, unit)
  // Ensures that number `number` has a unit. If no unit is found, assume the
  // default is `unit`.
  //
  //     unit(2, 'px')          //=> "2px"
  //     unit("30deg", 'rad')   //=> "30deg"
  //
  function unit(i, units) {
    if ((typeof i === "string") && (!i.match(/^[\-0-9\.]+$/))) {
      return i;
    } else {
      return "" + i + units;
    }
  }

  // ### toMS(duration)
  // Converts given `duration` to a millisecond string.
  //
  //     toMS('fast')   //=> '400ms'
  //     toMS(10)       //=> '10ms'
  //
  function toMS(duration) {
    var i = duration;

    // Allow for string durations like 'fast'.
    if ($.fx.speeds[i]) { i = $.fx.speeds[i]; }

    return unit(i, 'ms');
  }

  // Export some functions for testable-ness.
  $.transit.getTransitionValue = getTransition;
})(jQuery);
/*! JsRender v1.0pre: http://github.com/BorisMoore/jsrender */
/*
* Optimized version of jQuery Templates, for rendering to string.
* Does not require jQuery, or HTML DOM
* Integrates with JsViews (http://github.com/BorisMoore/jsviews)
* Copyright 2012, Boris Moore
* Released under the MIT License.
*/
// informal pre beta commit counter: 22

(function(global, jQuery, undefined) {
	// global is the this object, which is window when running in the usual browser environment.
	"use strict";

	if (jQuery && jQuery.views || global.jsviews) { return; } // JsRender is already loaded

	//========================== Top-level vars ==========================

	var versionNumber = "v1.0pre",

		$, jsvStoreName, rTag, rTmplString,
//TODO	tmplFnsCache = {},
		delimOpenChar0 = "{", delimOpenChar1 = "{", delimCloseChar0 = "}", delimCloseChar1 = "}", linkChar = "^",
		FALSE = false, TRUE = true,

		rPath = /^(?:null|true|false|\d[\d.]*|([\w$]+|\.|~([\w$]+)|#(view|([\w$]+))?)([\w$.^]*?)(?:[.[^]([\w$]+)\]?)?)$/g,
		//                                     object     helper    view  viewProperty pathTokens      leafToken

		rParams = /(\()(?=|\s*\()|(?:([([])\s*)?(?:([#~]?[\w$.^]+)?\s*((\+\+|--)|\+|-|&&|\|\||===|!==|==|!=|<=|>=|[<>%*!:?\/]|(=))\s*|([#~]?[\w$.^]+)([([])?)|(,\s*)|(\(?)\\?(?:(')|("))|(?:\s*([)\]])([([]?))|(\s+)/g,
		//          lftPrn        lftPrn2                 path    operator err                                                eq          path2       prn    comma   lftPrn2   apos quot        rtPrn   prn2   space
		// (left paren? followed by (path? followed by operator) or (path followed by paren?)) or comma or apos or quot or right paren or space

		rNewLine = /\r?\n/g,
		rUnescapeQuotes = /\\(['"])/g,
		// escape quotes and \ character
		rEscapeQuotes = /([\\'"])/g,
		rBuildHash = /\x08(~)?([^\x08]+)\x08/g,
		rTestElseIf = /^if\s/,
		rFirstElem = /<(\w+)[>\s]/,
		rPrevElem = /<(\w+)[^>\/]*>[^>]*$/,
		autoTmplName = 0,
		viewId = 0,
		escapeMapForHtml = {
			"&": "&amp;",
			"<": "&lt;",
			">": "&gt;"
		},
        attrEncodeChars = /[<"'&]/g,
		htmlEncodeChars = /[\x00<>"'&]/g,
		tmplAttr = "data-jsv-tmpl",
		fnDeclStr = "var j=j||" + (jQuery ? "jQuery." : "js") + "views,",
		slice = [].slice,

		$render = {},
		jsvStores = {
			template: {
				compile: compileTmpl
			},
			tag: {
				compile: compileTag
			},
			helper: {},
			converter: {}
		},

		// jsviews object ($.views if jQuery is loaded)
		$views = {
			jsviews: versionNumber,
			render: $render,
			View: View,
			settings: {
				delimiters: $viewsDelimiters,
				debugMode: TRUE
			},
			sub: {
				// subscription, e.g. JsViews integration
				Error: JsViewsError,
				tmplFn: tmplFn,
				parse: parseParams,
				extend: $extend,
				error: error
//TODO			invoke: $invoke
			},
			_cnvt: convertVal,
			_tag: renderTag,

			// TODO provide better debug experience - e.g. support $.views.onError callback
			_err: function(e) {
				// Place a breakpoint here to intercept template rendering errors
				return $viewsSettings.debugMode ? ("Error: " + (e.message || e)) + ". " : '';
			}
		};

		function JsViewsError(message, object) {
			// Error exception type for JsViews/JsRender
			// Override of $.views.sub.Error is possible
			if (object && object.onError) {
				if (object.onError(message) === FALSE) {
					return;
				}
			}
			this.name = "JsRender Error";
			this.message = message || "JsRender error";
		}

		function $extend(target, source) {
			var name;
			target = target || {};
			for (name in source) {
				target[name] = source[name];
			}
			return target;
		}

//TODO		function $invoke() {
//			try {
//				return arguments[1].apply(arguments[0], arguments[2]);
//			}
//			catch(e) {
//				throw new $views.sub.Error(e, arguments[0]);
//			}
//		}

		(JsViewsError.prototype = new Error()).constructor = JsViewsError;

	//========================== Top-level functions ==========================

	//===================
	// jsviews.delimiters
	//===================

	function $viewsDelimiters(openChars, closeChars, link) {
		// Set the tag opening and closing delimiters and 'link' character. Default is "{{", "}}" and "^"
		// openChars, closeChars: opening and closing strings, each with two characters

		if (!$views.rTag || arguments.length) {
			delimOpenChar0 = openChars ? openChars.charAt(0) : delimOpenChar0; // Escape the characters - since they could be regex special characters
			delimOpenChar1 = openChars ? openChars.charAt(1) : delimOpenChar1;
			delimCloseChar0 = closeChars ? closeChars.charAt(0) : delimCloseChar0;
			delimCloseChar1 = closeChars ? closeChars.charAt(1) : delimCloseChar1;
			linkChar = link || linkChar;
			openChars = "\\" + delimOpenChar0 + "(\\" + linkChar + ")?\\" + delimOpenChar1;  // Default is "{^{"
			closeChars = "\\" + delimCloseChar0 + "\\" + delimCloseChar1;                   // Default is "}}"
			// Build regex with new delimiters
			//          tag    (followed by / space or })   or cvtr+colon or html or code
			rTag = "(?:(?:(\\w+(?=[\\/\\s\\" + delimCloseChar0 + "]))|(?:(\\w+)?(:)|(>)|!--((?:[^-]|-(?!-))*)--|(\\*)))"
				+ "\\s*((?:[^\\" + delimCloseChar0 + "]|\\" + delimCloseChar0 + "(?!\\" + delimCloseChar1 + "))*?)";

			// make rTag available to JsViews (or other components) for parsing binding expressions
			$views.rTag = rTag + ")";

			rTag = new RegExp(openChars + rTag + "(\\/)?|(?:\\/(\\w+)))" + closeChars, "g");

			// Default:    bind           tag       converter colon html     comment            code      params            slash   closeBlock
			//           /{(\^)?{(?:(?:(\w+(?=[\/\s}]))|(?:(\w+)?(:)|(>)|!--((?:[^-]|-(?!-))*)--|(\*)))\s*((?:[^}]|}(?!}))*?)(\/)?|(?:\/(\w+)))}}/g

			rTmplString = new RegExp("<.*>|([^\\\\]|^)[{}]|" + openChars + ".*" + closeChars);
			// rTmplString looks for html tags or { or } char not preceded by \\, or JsRender tags {{xxx}}. Each of these strings are considered NOT to be jQuery selectors
		}
		return [delimOpenChar0, delimOpenChar1, delimCloseChar0, delimCloseChar1, linkChar];
	}

	//=========
	// View.get
	//=========

	function getView(type) {
		// TODO complete/test/provide samples for this
		// If type is undefined, returns root view (view under top view).
		var view = this,
			root = !type || type === "root";
		while (root && view.parent.parent || view && view.type !== type) {
			view = view.parent;
		}
		return view;
	}

	//==========
	// View._hlp
	//==========

	function getHelper(helper) {
		// Helper method called as view._hlp(key) from compiled template, for helper functions or template parameters ~foo
		var wrapped,
			view = this,
			viewCtx = view.ctx ||{},
			tmplHelpers = view.tmpl.helpers || {};

		helper = (
			viewCtx[helper] !== undefined
				? viewCtx
				: tmplHelpers[helper] !== undefined
					? tmplHelpers
					: $helpers[helper] !== undefined
						? $helpers
						: {}
		)[helper];

		if (helper) {
			if (typeof helper === "function") {
				wrapped = function() {
						// If it is of type function, we will wrap it so it gets called with view as 'this' context.
						// If the helper ~foo() was in a data-link expression, the view will have a 'temporary' linkCtx property too.
						// However note that helper functions on deeper paths will not have access to view and tagCtx.
						// For example, ~util.foo() will have the ~util object as 'this' pointer
						var i,
							args = arguments;

						for (i in args) {
							if (typeof args[i] === "function") {
								args[i] = args[i].call(view.data);
							}
						}
						return helper.apply(view, args);
					};
				wrapped.depends = helper.depends;
			}
		}
		return wrapped || helper;
	}

	//==============
	// jsviews._cnvt
	//==============

	function convertVal(converter, view, self, tagCtx, bindingPaths, text) {
		// self is template object or linkCtx object
		if (converter || bindingPaths) {
			var tmplConverter,
				linkCtx = !self.markup && self,
				tag = {
					tagName:  converter + ":",
					tagCtx: tagCtx
				},
				args = tagCtx.args = slice.call(arguments, 5);

			tagCtx.view = view;
			tagCtx.bind = !!(linkCtx || bindingPaths);

			if (linkCtx) {
				linkCtx.tag = tag;
				tag.linkCtx = linkCtx;
				tagCtx.ctx = extendCtx(tagCtx.ctx, linkCtx.view.ctx);
			}
			tag.ctx = tagCtx.ctx || {};
			delete tagCtx.ctx;

			if (converter) {
				// A call to {{cnvt: ... }} or {^{cnvt: ... }} or data-link="{cnvt: ... }"
				tmplConverter = view.tmpl.converters;
				tmplConverter = tmplConverter && tmplConverter[converter] || $converters[converter];
				if (tmplConverter || error("Unknown converter: {{"+ converter + ":")) {
					text = tmplConverter.apply(tag, args);
				}
			}
			if (bindingPaths) {
				// A call to {^{: ... }} or {^{cnvt: ... }}
				bindingPaths = view.tmpl.bnds[bindingPaths-1];
				linkCtx.paths = bindingPaths;
				// Consider being able to switch off binding if parent view is not currently bound.
				view._.tag = tag; // Provide this tag on view, for markerNode on bound tags, and for getting the tagCtx and linkCtx during rendering.
				// Provide this tag on view, for addMarkerNode on bound tags to add the tag to view._.bnds, associated with the tag id,
				// and so when rendering subsequent {{else}}, will be associated with this tag
				//TODO does this work with nested elses and with {^{foo:...}} which also adds tag to view, for markerNodes.
				text = view._.onRender(text, view, TRUE);
	//Example:  text = '<script type="jsv123"></script>' + text + '<script type="jsv123/"></script>';
			}
		}
		return text;
	}

	//=============
	// jsviews._tag
	//=============

	function renderTag(tagName, parentView, self, content, tagCtx, bind) {
		// Called from within compiled template function, to render a template tag
		// Returns the rendered tag

		var ret, render, ctx, elses, tag, tags,
			tmpl = self.markup && self,
			// self is either a template object (if rendering a tag) or a linkCtx object (if linking using a link tag)
			linkCtx = !tmpl && self,
			parentView_ = parentView._,
			parentTmpl = tmpl || parentView.tmpl,
			tmplTags = parentTmpl.tags,
			childTemplates = parentTmpl.templates,
			tagDef = tmplTags && tmplTags[tagName] || $tags[tagName],
			args = tagCtx.args = arguments.length > 6 ? slice.call(arguments, 6) : [],
			props = tagCtx.props || {};

		tagCtx.view = parentView;
		tagCtx.ctx = extendCtx(tagCtx.ctx, parentView.ctx); // Extend parentView.ctx
		ctx = tagCtx.ctx || {};
		delete tagCtx.ctx;

		if (!tagDef) {
			error("Unknown tag: {{"+ tagName + "}}");
			return "";
		}
		tmpl = props.tmpl;

		// Set the tmpl property to the content of the block tag, unless set as an override property on the tag
		content = content && parentTmpl.tmpls[content - 1];
		tmpl = tmpl || content || tagDef.template || undefined;
		tmpl = "" + tmpl === tmpl // if a string
			? childTemplates && childTemplates[tmpl] || $templates[tmpl] || $templates(tmpl)
			: tmpl;

		if (tagName === "else") {
			tag = parentView._.tag;
			// Switch current tagCtx of tag instance to this {{else ...}}
			elses = tag._elses = tag._elses || [];
			elses.push(tmpl);
			tagCtx.isElse = elses.length;
			render = tag.render;
		}
		if (tagDef.init) {
			// init is the constructor for the tag/control instance

			// tags hash: tag.ctx.tags, merged with parentView.ctx.tags,
			tags = ctx.tags = parentView.ctx && extendCtx(ctx.tags, parentView.ctx.tags) || {};

			tag = tag || linkCtx.tag;
			if (tag) {
				// tag has already been instantiated, so keep it, but attach the current context, which may have changed
				// Add tag to tags hash
				tags[tagName] = tag;
			} else {
				// If the tag has not already been instantiated, we will create a new instance and add to the tags hash,
				// so ~tags.tagName will access the tag, even within the rendering of the template content of this tag
//	TODO provide error handling owned by the tag - using tag.onError
//			try {
					tag = tags[tagName] = new tagDef.init(tagCtx, linkCtx, ctx);
//				}
//				catch(e) {
//					tagDef.onError(e);
//				}
				tag.tmpl = tmpl;

				if (linkCtx) {
					tag.attr =
						// Setting attr on tag so renderContent knows whether to include script node markers.
						linkCtx.attr =
							// Setting attr on self to ensure outputting to the correct target attribute.
							linkCtx.attr || tagDef.attr || "";
				}
			}
			ctx.tag = tag;
		} else {
			// This is a simple tag declared as a function. We won't instantiate a specific tag constructor - just a standard instance object.
			tag = tag || {
				// tag instance object if no init constructor
				render: tagDef.render,
				renderContent: renderContent,
				tmpl: tmpl,
				tagName: tagName
			};
		}

		// Provide tagCtx, linkCtx and ctx access from tag
		tag.tagCtx = tagCtx;
		tag.ctx = ctx;
		if (linkCtx) {
			linkCtx.tag = tag;
			tag.linkCtx = linkCtx;
		}

		tag._is = "tag";
		tag._done = tagCtx.isElse ? tag._done : FALSE; // If not an {{else}} this is a new
		tmpl = tmpl || tag.tmpl;
		elses = tag._elses;

//TODO The above works for initial rendering, but when refreshing {^{foo}} need also to associate with {{else}} tags. Use compilation to bind else content templates and expressions with the primary tag template and expression.

		parentView_.tag = tag;
		// Provide this tag on view, for addMarkerNode on bound tags to add the tag to view._.bnds, associated with the tag id,
		// for getting the tagCtx and linkCtx during rendering, and so when rendering subsequent {{else}}, will be associated with this tag
		//TODO does this work with nested elses and with {^{foo:...}} which also adds tag to view, for markerNodes.

//		while (tmpl) {
			// If tagDef has a 'render' function, call it.
			// If the return result is undefined, return "", or, if a template (or content) is provided,
			// return the rendered template(using the current data or the first parameter as data);
			if (render = render || tag.render) {
				ret = render.apply(tag, args);

//	TODO		ret = $invoke(tag, render, args);
			}
			ret = ret !== undefined
				? ret    // Return result of render function unless it is undefined, in which case return rendered template
				: tmpl
					// render template on args[0] if defined, or otherwise on the current data item
					? tag.renderContent(tagCtx.data !== undefined ? tagCtx.data : parentView.data, undefined, parentView)
					: ""; // No return value from render, and no template defined, so return ::

//			tmpl = (tag !== "else" && elses) ? (tagCtx.isElse = tagCtx.isElse || 0, elses[tagCtx.isElse++]) : undefined;
//}

		// If bind, for {^{tag ... }}, insert script marker nodes
		return bind ? parentView_.onRender(ret, parentView, bind) : ret;
	}

	//=================
	// View constructor
	//=================

	function View(context, type, parentView, data, template, key, onRender) {
		// Constructor for view object in view hierarchy. (Augmented by JsViews if JsViews is loaded)
		var views, parentView_,
			isArray = type === "array",
			self_ = {
				key: 0,
				useKey: isArray ? 0 : 1,
				id: "" + viewId++,
				onRender: onRender,
				bnd: {}
			},
			self = {
				data: data,
				tmpl: template,
				views: isArray ? [] : {},
				parent: parentView,
				ctx: context,
				type: type,
				// If the data is an array, this is an 'array view' with a views array for each child 'item view'
				// If the data is not an array, this is an 'item view' with a views 'map' object for any child nested views
				// _useKey is non zero if is not an 'array view' (owning a data array). Uuse this as next key for adding to child views map
				get: getView,
				_hlp: getHelper,
				_: self_
		};

		if (parentView) {
			views = parentView.views;
			parentView_ = parentView._;
			if (parentView_.useKey) {
				// Parent is an 'item view'. Add this view to its views object
				// self._key = is the key in the parent view map
				views[self_.key = "_" + parentView_.useKey++] = self;
			} else {
				// Parent is an 'array view'. Add this view to its views array
				views.splice(
					// self._.key = self.index - the index in the parent view array
					self_.key = self.index =
						key !== undefined
							? key
							: views.length,
				0, self);
			}
			// If no context was passed in, use parent context
			// If context was passed in, it should have been merged already with parent context
			self.ctx = context || parentView.ctx;
		}
		return self;
	}

	//=============
	// Registration
	//=============

	function compileChildResources(parentTmpl) {
		var storeName, resources, resourceName, settings, compile;
		for (storeName in jsvStores) {
			settings = jsvStores[storeName];
			if ((compile = settings.compile) && (resources = parentTmpl[storeName + "s"])) {
				for (resourceName in resources) {
					// compile child resource declarations (templates, tags, converters or helpers)
					resources[resourceName] = compile(resourceName, resources[resourceName], parentTmpl, storeName, settings);
				}
			}
		}
	}

	function compileTag(name, item, parentTmpl) {
		var init, tmpl;
		if (typeof item === "function") {
			// Simple tag declared as function. No presenter instantation.
			item = {
				tagName: name,
				render: item,
				depends: item.depends
			};
		} else {
			// Tag declared as object, used as the prototype for tag instantiation (control/presenter)
			item.tagName = name;
			if (tmpl = item.template) {
				item.template = "" + tmpl === tmpl ? ($templates[tmpl] || $templates(tmpl)) : tmpl;
			}
			if (item.init !== FALSE) {
				init = item.init = item.init || function(tagCtx) {};
				init.prototype = item;
				(init.prototype = item).constructor = init;
			}
		}
		item.renderContent = renderContent;
		item.attr = "html";
		if (parentTmpl) {
			item._parentTmpl = parentTmpl;
		}
//TODO	item.onError = function(e) {
//			var error;
//			if (error = this.prototype.onError) {
//				error.call(this, e);
//			} else {
//				throw e;
//			}
//		}
		return item;
	}

	function compileTmpl(name, tmpl, parentTmpl, storeName, storeSettings, options) {
		// tmpl is either a template object, a selector for a template script block, the name of a compiled template, or a template object

		//==== nested functions ====
		function tmplOrMarkupFromStr(value) {
			// If value is of type string - treat as selector, or name of compiled template
			// Return the template object, if already compiled, or the markup string

			if (("" + value === value) || value.nodeType > 0) {
				try {
					elem = value.nodeType > 0
					? value
					: !rTmplString.test(value)
					// If value is a string and does not contain HTML or tag content, then test as selector
						&& jQuery && jQuery(value)[0];
					// If selector is valid and returns at least one element, get first element
					// If invalid, jQuery will throw. We will stay with the original string.
				} catch (e) { }

				if (elem) {
					// Generally this is a script element.
					// However we allow it to be any element, so you can for example take the content of a div,
					// use it as a template, and replace it by the same content rendered against data.
					// e.g. for linking the content of a div to a container, and using the initial content as template:
					// $.link("#content", model, {tmpl: "#content"});

					// Create a name for compiled template if none provided
					value = $templates[elem.getAttribute(tmplAttr)];
					if (!value) {
						// Not already compiled and cached, so compile and cache the name
						name = name || "_" + autoTmplName++;
						elem.setAttribute(tmplAttr, name);
						$templates[name] = value = compileTmpl(name, elem.innerHTML, parentTmpl, storeName, storeSettings, options); // Use tmpl as options
					}
				}
				return value;
			}
			// If value is not a string, return undefined
		}

		var tmplOrMarkup, elem;

		//==== Compile the template ====
		tmpl = tmpl || "";
		tmplOrMarkup = tmplOrMarkupFromStr(tmpl);

		// If options, then this was already compiled from a (script) element template declaration.
		// If not, then if tmpl is a template object, use it for options
		options = options || (tmpl.markup ? tmpl : {});
		options.tmplName = name;
		if (parentTmpl) {
			options._parentTmpl = parentTmpl;
		}
		// If tmpl is not a markup string or a selector string, then it must be a template object
		// In that case, get it from the markup property of the object
		if (!tmplOrMarkup && tmpl.markup && (tmplOrMarkup = tmplOrMarkupFromStr(tmpl.markup))) {
			if (tmplOrMarkup.fn && (tmplOrMarkup.debug !== tmpl.debug || tmplOrMarkup.allowCode !== tmpl.allowCode)) {
				// if the string references a compiled template object, but the debug or allowCode props are different, need to recompile
				tmplOrMarkup = tmplOrMarkup.markup;
			}
		}
		if (tmplOrMarkup !== undefined) {
			if (name && !parentTmpl) {
				$render[name] = function() {
					return tmpl.render.apply(tmpl, arguments);
				};
			}
			if (tmplOrMarkup.fn || tmpl.fn) {
				// tmpl is already compiled, so use it, or if different name is provided, clone it
				if (tmplOrMarkup.fn) {
					if (name && name !== tmplOrMarkup.name) {
						tmpl = extendCtx(options, tmplOrMarkup);
					} else {
						tmpl = tmplOrMarkup;
					}
				}
			} else {
				// tmplOrMarkup is a markup string, not a compiled template
				// Create template object
				tmpl = TmplObject(tmplOrMarkup, options);
				// Compile to AST and then to compiled function
				tmplFn(tmplOrMarkup, tmpl);
			}
			compileChildResources(options);
			return tmpl;
		}
	}
	//==== /end of function compile ====

	function TmplObject(markup, options) {
		// Template object constructor
		var htmlTag,
			wrapMap = $viewsSettings.wrapMap || {},
			tmpl = $extend(
				{
					markup: markup,
					tmpls: [],
					links: {},
					bnds: [],
					render: renderContent
				},
				options
			);

		if (!options.htmlTag) {
			// Set tmpl.tag to the top-level HTML tag used in the template, if any...
			htmlTag = rFirstElem.exec(markup);
			tmpl.htmlTag = htmlTag ? htmlTag[1].toLowerCase() : "";
		}
		htmlTag = wrapMap[tmpl.htmlTag];
		if (htmlTag && htmlTag !== wrapMap.div) {
			// When using JsViews, we trim templates which are inserted into HTML contexts where text nodes are not rendered (i.e. not 'Phrasing Content').
			tmpl.markup = $.trim(tmpl.markup);
			tmpl._elCnt = TRUE; // element content model (no rendered text nodes), not phrasing content model
		}

		return tmpl;
	}

	function registerStore(storeName, storeSettings) {

		function theStore(name, item, parentTmpl) {
			// The store is also the function used to add items to the store. e.g. $.templates, or $.views.tags

			// For store of name 'thing', Call as:
			//    $.views.things(items[, parentTmpl]),
			// or $.views.things(name, item[, parentTmpl])

			var onStore, compile, items, itemName, childTemplates, childTemplate, thisStore, childStoreName;

			if (name && "" + name !== name && !name.nodeType && !name.markup) {
				// Call to $.views.things(items[, parentTmpl]),

				// Adding items to the store
				// If name is a map, then item is parentTmpl. Iterate over map and call store for key.
				for (itemName in name) {
					theStore(itemName, name[itemName], item);
				}
				return $views;
			}
			thisStore = parentTmpl ? parentTmpl[storeNames] = parentTmpl[storeNames] || {} : theStore;

			// Adding a single unnamed item to the store
			if (item === undefined) {
				item = name;
				name = undefined;
			}
			compile = storeSettings.compile;
			if (onStore = $viewsSub.onBeforeStoreItem) {
				// e.g. provide an external compiler or preprocess the item.
				compile = onStore(thisStore, name, item, compile) || compile;
			}
			if (!name) {
				item = compile(undefined, item);
			} else if ("" + name === name) { // name must be a string
				if (item === null) {
					// If item is null, delete this entry
					delete thisStore[name];
				} else {
					thisStore[name] = compile ? (item = compile(name, item, parentTmpl, storeName, storeSettings)) : item;
					if (storeName === "template" && (childTemplates = thisStore[name].templates)) {
						// This is a template which has child templates defined. We will copy child items of parent template to each
						// child template, since items registered with the parent templates must also be accessible from the child template
						for (childStoreName in jsvStores) {
							// Find child items registered for this parent template
							childStoreName += "s";
							if (items = item[childStoreName]) {
								// Copy these items to each child template
								for (childTemplate in childTemplates ) {
									childTemplate = childTemplates[childTemplate];
									// Copy parent items except if overridden by item of same name in child template
									childTemplate[childStoreName] = extendCtx(childTemplate[childStoreName], items);
								}
							}
						}
					}
				}
			}
			if (item) {
				item._is = storeName;
			}
			if (onStore = $viewsSub.onStoreItem) {
				// e.g. JsViews integration
				onStore(thisStore, name, item, compile);
			}
			return item;
		}

		var storeNames = storeName + "s";

		$views[storeNames] = theStore;
		jsvStores[storeName] = storeSettings;
	}

	//==============
	// renderContent
	//==============

	function renderContent(data, context, parentView, key, isLayout, onRender) {
		// Render template against data as a tree of subviews (nested rendered template instances), or as a string (top-level template).
		// If the data is the parent view, treat as layout template, re-render with the same data context.
		var i, l, dataItem, newView, childView, itemResult, parentContext, props, swapContent, tagCtx, isTag, outerOnRender,
			self = this,
			tmpl = self,
			allowDataLink = self.attr === undefined || self.attr === "html",
			result = "";

		if (key === TRUE) {
			swapContent = TRUE;
			key = 0;
		}
		if (isTag = self._is === "tag") {
			tagCtx = self.tagCtx;
			// This is a call from renderTag
			tmpl = tagCtx.isElse ? self._elses[tagCtx.isElse-1] : self.tmpl;
			context = extendCtx(context, self.ctx);
			props = tagCtx.props || {};
			if ( props.link === FALSE ) {
				// link=false setting on block tag
				// We will override inherited value of link by the explicit setting link=false taken from props
				// The child views of an unlinked view are also unlinked. So setting child back to true will not have any effect.
				context =  context || {};
				context.link = FALSE;
			}
			parentView = parentView || tagCtx.view;
		} else {
			tmpl = self.jquery && (self[0] || error('Unknown template: "' + self.selector + '"')) // This is a call from $(selector).render
				|| self;
		}
		if (tmpl) {
			if (parentView) {
				onRender = onRender || parentView._.onRender;
				parentContext = parentView.ctx;
				if (data === parentView) {
					// Inherit the data from the parent view.
					// This may be the contents of an {{if}} block
					// Set isLayout = true so we don't iterate the if block if the data is an array.
					data = parentView.data;
					isLayout = TRUE;
				}
			}

			// Set additional context on views created here, (as modified context inherited from the parent, and to be inherited by child views)
			// Note: If no jQuery, $extend does not support chained copies - so limit extend() to two parameters
			context = extendCtx(context, parentContext);

			if (!tmpl.fn) {
				tmpl = $templates[tmpl] || $templates(tmpl);
			}

			if (tmpl) {
				onRender = (context && context.link) !== FALSE && allowDataLink && onRender;
				// If link===false, do not call onRender, so no data-linking marker nodes
				outerOnRender = onRender;
				if (onRender === TRUE) {
					// Used by view.refresh(). Don't create a new wrapper view.
					outerOnRender = undefined;
					onRender = parentView._.onRender;
				}
				if ($.isArray(data) && !isLayout) {
					// Create a view for the array, whose child views correspond to each data item.
					// (Note: if key and parentView are passed in along with parent view, treat as
					// insert -e.g. from view.addViews - so parentView is already the view item for array)
					newView = swapContent ? parentView : (key !== undefined && parentView) || View(context, "array", parentView, data, tmpl, key, onRender);
					for (i = 0, l = data.length; i < l; i++) {
						// Create a view for each data item.
						dataItem = data[i];
						childView = View(context, "item", newView, dataItem, tmpl, (key || 0) + i, onRender);
						itemResult = tmpl.fn(dataItem, childView, $views);
						result += newView._.onRender ? newView._.onRender(itemResult, childView) : itemResult;
					}
				} else {
					// Create a view for singleton data object.
					newView = swapContent ? parentView : View(context, "data", parentView, data, tmpl, key, onRender);
					result += tmpl.fn(data, newView, $views);
				}
				return outerOnRender ? outerOnRender(result, newView) : result;
			}
		}
		return "";
	}

	//===========================
	// Build and compile template
	//===========================

	// Generate a reusable function that will serve to render a template against data
	// (Compile AST then build template function)

	function error(message) {
		if ($viewsSettings.debugMode) {
			throw new $views.sub.Error(message);
		}
	}

	function syntaxError(message) {
		error("Syntax error\n" + message);
	}

	function tmplFn(markup, tmpl, isLinkExpression) {
		// Compile markup to AST (abtract syntax tree) then build the template function code from the AST nodes
		// Used for compiling templates, and also by JsViews to build functions for data link expressions


		//==== nested functions ====
		function pushprecedingContent(shift) {
			shift -= loc;
			if (shift) {
				content.push(markup.substr(loc, shift).replace(rNewLine, "\\n"));
			}
		}

		function blockTagCheck(tagName) {
			tagName && syntaxError('Unmatched or missing tag: "{{/' + tagName + '}}" in template:\n' + markup);
		}

		function parseTag(all, bind, tagName, converter, colon, html, comment, codeTag, params, slash, closeBlock, index) {

			//    bind         tag        converter colon html     comment            code      params            slash   closeBlock
			// /{(\^)?{(?:(?:(\w+(?=[\/\s}]))|(?:(\w+)?(:)|(>)|!--((?:[^-]|-(?!-))*)--|(\*)))\s*((?:[^}]|}(?!}))*?)(\/)?|(?:\/(\w+)))}}/g

			// Build abstract syntax tree (AST): [ tagName, converter, params, content, hash, bindings, contentMarkup ]
			if (html) {
				colon = ":";
				converter = "html";
			}
			var current0,
				pathBindings = [],
				code = "",
				hash = "",
				passedCtx = "",
				// Block tag if not self-closing and not {{:}} or {{>}} (special case) and not a data-link expression
				block = !slash && !colon && !comment && !isLinkExpression;

			//==== nested helper function ====
			tagName = tagName || colon;
			pushprecedingContent(index);
			loc = index + all.length; // location marker - parsed up to here
			if (codeTag) {
				if (allowCode) {
					content.push(["*", "\n" + params.replace(rUnescapeQuotes, "$1") + "\n"]);
				}
			} else if (tagName) {
				if (tagName === "else") {
					if (rTestElseIf.test(params)) {
						syntaxError('for "{{else if expr}}" use "{{else expr}}"');
					}
					current[6] = markup.substring(current[6], index); // contentMarkup for block tag
					current = stack.pop();
					content = current[3];
					block = TRUE;
				}
				if (params) {
					code = parseParams(params, pathBindings)
						.replace(rBuildHash, function(all, isCtx, keyValue) {
							if (isCtx) {
								passedCtx += keyValue + ",";
							} else {
								hash += keyValue + ",";
							}
							return "";
						});
				}
				hash = hash.slice(0, -1);
				code = code.slice(0, -1);
				newNode = [
						tagName,
						converter || "",
						code,
						block && [],
						"{" + (hash ? ("props:{" + hash + "},") : "") + 'params:"' + params + '"' + (passedCtx ? ",ctx:{" + passedCtx.slice(0, -1) + "}" : "") + "},",
						bind && pathBindings || 0
					];
				content.push(newNode);
				if (block) {
					stack.push(current);
					current = newNode;
					current[6] = loc; // Store current location of open tag, to be able to add contentMarkup when we reach closing tag
				}
			} else if (closeBlock) {
				current0 = current[0];
				blockTagCheck(closeBlock !== current0 && current0 && current0 !== "else");
				current[6] = markup.substring(current[6], index); // contentMarkup for block tag
				current = stack.pop();
			}
			blockTagCheck(!current && closeBlock);
			content = current[3];
		}
		//==== /end of nested functions ====

		var newNode,
			allowCode = tmpl && tmpl.allowCode,
			astTop = [],
			loc = 0,
			stack = [],
			content = astTop,
			current = [, , , astTop];

		markup = markup.replace(rEscapeQuotes, "\\$1");

//TODO	result = tmplFnsCache[markup];  // Only cache if template is not named and markup length < ..., and there are no bindings or subtemplates?? Consider standard optimization for data-link="a.b.c"
//		if (result) {
//			tmpl.fn = result;
//		} else {

//		result = markup;

		blockTagCheck(stack[0] && stack[0][3].pop()[0]);

		// Build the AST (abstract syntax tree) under astTop
		markup.replace(rTag, parseTag);

		pushprecedingContent(markup.length);

		if (loc = astTop[astTop.length-1]) {
			blockTagCheck("" + loc !== loc && (+loc[6] === loc[6]) && loc[0]);
		}
//			result = tmplFnsCache[markup] = buildCode(astTop, tmpl);
//		}
		return buildCode(astTop, tmpl);
	}

	function buildCode(ast, tmpl) {
		// Build the template function code from the AST nodes, and set as property on the passed-in template object
		// Used for compiling templates, and also by JsViews to build functions for data link expressions
		var i, node, hasTag, hasEncoder, getsValue, hasConverter, hasViewPath, tagName, converter, params, hash, bindings, bindingPaths, nestedTmpls, nestedTmpl, allowCode, content, markup,
			code = "",
			tmplOptions = {},
			l = ast.length;

		if (tmpl) {
			if (allowCode = tmpl.allowCode) {
				tmplOptions.allowCode = TRUE;
			}
			if (tmpl.debug) {
				tmplOptions.debug = TRUE;
			}
			bindings = tmpl.bnds;
			nestedTmpls = tmpl.tmpls;
		}

		for (i = 0; i < l; i++) {
			// AST nodes: [ tagName, converter, params, content, hash, bindings, contentMarkup, link ]
			node = ast[i];

			// Add newline for each callout to t() c() etc. and each markup string
			//TODO consider changing to ret += t()...; so debug break points can be inserted on each callout.
			code += "\nret+=";
			if ("" + node === node) {
				// a markup string to be inserted
				code += '"' + node + '";';
			} else {
				// a compiled tag expression to be inserted
				tagName = node[0];
				if (tagName === "*") {
					// If this {{* }} tag is at the beginning of the template, start with var ret="";
					// Otherwise remove the last "+\n" characters and replace with ";" to complete the ret += ...; statement, prior to inserted user code,
					code = (i ? code.slice(0, -5) : "") + node[1];
				} else {
					converter = node[1];
					params = node[2];
					content = node[3];
					hash = node[4];
					bindingPaths = node[5];
					markup = node[6];

					if (content) {
						// Create template object for nested template
						nestedTmpl = TmplObject(markup, tmplOptions);
						// Compile to AST and then to compiled function
						buildCode(content, nestedTmpl);
						nestedTmpls.push(nestedTmpl);
					}
					if (bindingPaths) {
						// Add leaf binding paths to template
						bindings.push(bindingPaths);
						bindingPaths = bindings.length;
					}
					hasViewPath = hasViewPath || hash.indexOf("view") > -1;
					// Add newline for each callout to t() c() etc.

					//TODO consider changing to ret += t()...; so debug break points can be inserted on each callout. At the same time, pass in ret to c() and t()
					// so they can look at the previous ret, and detect whether this is a jsrender tag within an HTML element tag. If so, don't insert marker nodes,
					// and make the databinding trigger view refresh on parent view... No need for people to set link=false.
					code += tagName === ":"
					? (converter === "html" && !bindingPaths
						? (hasEncoder = TRUE, "h(" + params+ ");")
						: converter || bindingPaths // Call _cnvt if there is a converter, or binding: {{cnvt: ... }}, {^{: ... }} or {^{cnvt: ... }}
							? (hasConverter = TRUE, 'c("' + converter + '",view,this,' + hash + bindingPaths + "," + params + ");")
							: (getsValue = TRUE, "(v=" + params + ')!=u?v:"";')
					)
					: (hasTag = TRUE, 't("' + tagName + '",view,this,'
						+ (content ? nestedTmpls.length : '""') // For block tags, pass in the key (nestedTmpls.length) to the nested content template
						+ "," + hash + bindingPaths + (params ? "," : "") + params) + ");";
				}
			}
		}

		// Include only the var references that are needed in the code
		code = fnDeclStr
		+ (getsValue ? "v," : "")
		+ (hasTag ? "t=j._tag," : "")
		+ (hasConverter ? "c=j._cnvt," : "")
		+ (hasEncoder ? "h=j.converters.html," : "")
		+ 'ret=""; try{\n'
		+ (tmplOptions.debug ? "debugger;" : "")
		+ code + "\nreturn ret;\n\n}catch(e){return j._err(e);}";

		try {
			code = new Function("data, view, j, u", code);
		} catch (e) {
			syntaxError("Compiled template code:\n\n" + code, e);
		}

		if (tmpl) {
			tmpl.fn = code;
		}
		return code;
	}

	function parseParams(params, bindings) {

		function parseTokens(all, lftPrn0, lftPrn, path, operator, err, eq, path2, prn, comma, lftPrn2, apos, quot, rtPrn, prn2, space) {
			// rParams = /(\()(?=|\s*\()|(?:([([])\s*)?(?:([#~]?[\w$^.]+)?\s*((\+\+|--)|\+|-|&&|\|\||===|!==|==|!=|<=|>=|[<>%*!:?\/]|(=))\s*|([#~]?[\w$^.]+)([([])?)|(,\s*)|(\(?)\\?(?:(')|("))|(?:\s*([)\]])([([]?))|(\s+)
			//          lftPrn0-flwed by (- lftPrn               path    operator err                                                eq         path2       prn    comma   lftPrn3   apos quot        rtPrn   prn2   space
			// (left paren? followed by (path? followed by operator) or (path followed by paren?)) or comma or apos or quot or right paren or space
			operator = operator || "";
			lftPrn = lftPrn || lftPrn0 || lftPrn2;
			path = path || path2;
			prn = prn || prn2 || "";

			function parsePath(all, object, helper, view, viewProperty, pathTokens, leafToken) {
				// rPath = /^(?:null|true|false|\d[\d.]*|([\w$]+|~([\w$]+)|#(view|([\w$]+))?)([\w$.^]*?)(?:[.[^]([\w$]+)\]?)?)$/g,
				//                                        object   helper    view  viewProperty pathTokens       leafToken

				if (object) {
					bindings.push(path);
					if (object !== ".") {
						var leaf,
							ret = (helper
								? 'view._hlp("' + helper + '")'
								: view
									? "view"
									: "data")
							+ (leafToken
								? (viewProperty
									? "." + viewProperty
									: helper
										? ""
										: (view ? "" : "." + object)
									) + (pathTokens || "")
								: (leafToken = helper ? "" : view ? viewProperty || "" : object, ""));

						leaf = (leafToken ? "." + leafToken : "");
						ret = ret + leaf;
						ret = ret.slice(0, 9) === "view.data"
						? ret.slice(5) // convert #view.data... to data...
						: ret;
						return ret;
					}
				}
				return all;
			}

			if (err) {
				syntaxError(params);
			} else {
				return (aposed
					// within single-quoted string
					? (aposed = !apos, (aposed ? all : '"'))
					: quoted
					// within double-quoted string
						? (quoted = !quot, (quoted ? all : '"'))
						:
					(
						(lftPrn
								? (parenDepth++, lftPrn)
								: "")
						+ (space
							? (parenDepth
								? ""
								: named
									? (named = FALSE, "\b")
									: ","
							)
							: eq
					// named param
								? (parenDepth && syntaxError(params), named = TRUE, '\b' + path + ':')
								: path
					// path
									? (path.split("^").join(".").replace(rPath, parsePath)
										+ (prn
											? (fnCall[++parenDepth] = TRUE, prn)
											: operator)
									)
									: operator
										? operator
										: rtPrn
					// function
											? ((fnCall[parenDepth--] = FALSE, rtPrn)
												+ (prn
													? (fnCall[++parenDepth] = TRUE, prn)
													: "")
											)
											: comma
												? (fnCall[parenDepth] || syntaxError(params), ",") // We don't allow top-level literal arrays or objects
												: lftPrn0
													? ""
													: (aposed = apos, quoted = quot, '"')
					))
				);
			}
		}
		var named,
			fnCall = {},
			parenDepth = 0,
			quoted = FALSE, // boolean for string content in double quotes
			aposed = FALSE; // or in single quotes

		bindings.expr = params.replace(rUnescapeQuotes, "$1");
		return (params + " ").replace(rParams, parseTokens);
	}

	//==========
	// Utilities
	//==========

	// HTML encoding helper
	function replacerForHtml(ch) {
		// Original code from Mike Samuel <msamuel@google.com>
		return escapeMapForHtml[ch]
			// Intentional assignment that caches the result of encoding ch.
			|| (escapeMapForHtml[ch] = "&#" + ch.charCodeAt(0) + ";");
	}

	// Merge objects, in particular contexts which inherit from parent contexts
	function extendCtx(context, parentContext) {
		// Return copy of parentContext, unless context is defined and is different, in which case return a new merged context
		// If neither context nor parentContext are undefined, return undefined
		return context && context !== parentContext
			? (parentContext
				? $extend($extend({}, parentContext), context)
				: context)
			: parentContext && $extend({}, parentContext);
	}

	//========================== Initialize ==========================

	for (jsvStoreName in jsvStores) {
		registerStore(jsvStoreName, jsvStores[jsvStoreName]);
	}

	var $templates = $views.templates,
		$converters = $views.converters,
		$helpers = $views.helpers,
		$tags = $views.tags,
		$viewsSub = $views.sub,
		$viewsSettings = $views.settings;

	if (jQuery) {
		////////////////////////////////////////////////////////////////////////////////////////////////
		// jQuery is loaded, so make $ the jQuery object
		$ = jQuery;
		$.render = $render;
		$.views = $views;
		$.templates = $templates = $views.templates;
		$.fn.render = renderContent;

	} else {
		////////////////////////////////////////////////////////////////////////////////////////////////
		// jQuery is not loaded.

		$ = global.jsviews = $views;

		$.isArray = Array && Array.isArray || function(obj) {
			return Object.prototype.toString.call(obj) === "[object Array]";
		};
	}

	//========================== Register tags ==========================

	$tags({
		"if": function(val) {
			var self = this;
				// If not done and val is truey, set done=true on tag instance and render content. Otherwise return ""
				// On else will call this function again on the same tag instance.
			return (self._done || arguments.length && !val)
				? ""
				: (self._done = true,
					// Test is satisfied, so render content on current context. Rather than return undefined
					// (which will render the tmpl/content on the current context but will iterate if it is an array),
					// we pass in the view. This ensures treating as a layout template - with no iteration
					self.renderContent(self.tagCtx.view));
		},
// Temporary fix for binding to {{if}}
//	"if": {
//		render: function(val) {
//			var self = this;
//			return (self._done || arguments.length && !val) ? "" : (self._done = true, self.renderContent(self.tagCtx.view));
//		}
//	},
		"else": function() {}, // Does nothing but ensures {{else}} tags are recognized as valid
		"for": function() {
			var i, arg, undef,
				self = this,
				tagCtx = self.tagCtx,
				result = "",
				args = arguments,
				done = 0,
				l = args.length;

			if (!l) {
				return tagCtx.done
					? ""
					: (tagCtx.done = TRUE,
						// Test is satisfied, so render content on current context. Rather than return undefined
						// (which will render the tmpl/content on the current context but will iterate if it is an array),
						// we pass in the view. This ensures treating as a layout template - with no iteration
						self.renderContent(tagCtx.view));
			}
			for (i = 0; i < l; i++) {
				arg = args[i];
				undef = arg === undefined;
				if (!undef) {
					done += $.isArray(arg) ? arg.length : 1;
					result += self.renderContent(arg);
				} else {
					return "";
				}
			}
			tagCtx.done = done;
			return result;
		},
		"*": function(value) {
			return value;
		}
	});

	//========================== Register global helpers ==========================

	//	$helpers({ // Global helper functions
	//		// TODO add any useful built-in helper functions
	//	});

	//========================== Register converters ==========================

	$converters({
		html: function(text) {
			// HTML encoding helper: Replace < > & and ' and " by corresponding entities.
			return text != undefined ? String(text).replace(htmlEncodeChars, replacerForHtml) : "";
		},
		attr: function(text) {
			// Attribute encoding helper: Replace < & ' and " by corresponding entities.
			return text != undefined ? String(text).replace(attrEncodeChars, replacerForHtml) : "";
		},
		url: function(text) {
			// TODO - support chaining {{attr|url:....}} to protect against injection attacks from url parameters containing " or '.
			// URL encoding helper.
			return text != undefined ? encodeURI(String(text)) : "";
		}
	});

	//========================== Define default delimiters ==========================
	$viewsDelimiters();

})(this, this.jQuery);
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_-_Entwicklungsgeschichte\js\mykkro-viewer.js
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_-_Entwicklungsgeschichte\js\mykkro-viewer.js
VELIKOST: 203085 B (198.33 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
// configuration file
var DEBUG = false;

var Config = {
};
var __ = function(arg) {
    return LocaleStrings[arg] || arg;
}

/*
	Base.js, version 1.1
	Copyright 2006-2007, Dean Edwards
	License: http://www.opensource.org/licenses/mit-license.php
*/

var Base = function() {
	// dummy
};

Base.extend = function(_instance, _static) { // subclass
	var extend = Base.prototype.extend;
	
	// build the prototype
	Base._prototyping = true;
	var proto = new this;
	extend.call(proto, _instance);
	delete Base._prototyping;
	
	// create the wrapper for the constructor function
	//var constructor = proto.constructor.valueOf(); //-dean
	var constructor = proto.constructor;
	var klass = proto.constructor = function() {
		if (!Base._prototyping) {
			if (this._constructing || this.constructor == klass) { // instantiation
				this._constructing = true;
				constructor.apply(this, arguments);
				delete this._constructing;
			} else if (arguments[0] != null) { // casting
				return (arguments[0].extend || extend).call(arguments[0], proto);
			}
		}
	};
	
	// build the class interface
	klass.ancestor = this;
	klass.extend = this.extend;
	klass.forEach = this.forEach;
	klass.implement = this.implement;
	klass.prototype = proto;
	klass.toString = this.toString;
	klass.valueOf = function(type) {
		//return (type == "object") ? klass : constructor; //-dean
		return (type == "object") ? klass : constructor.valueOf();
	};
	extend.call(klass, _static);
	// class initialisation
	if (typeof klass.init == "function") klass.init();
	return klass;
};

Base.prototype = {	
	extend: function(source, value) {
		if (arguments.length > 1) { // extending with a name/value pair
			var ancestor = this[source];
			if (ancestor && (typeof value == "function") && // overriding a method?
				// the valueOf() comparison is to avoid circular references
				(!ancestor.valueOf || ancestor.valueOf() != value.valueOf()) &&
				/\bbase\b/.test(value)) {
				// get the underlying method
				var method = value.valueOf();
				// override
				value = function() {
					var previous = this.base || Base.prototype.base;
					this.base = ancestor;
					var returnValue = method.apply(this, arguments);
					this.base = previous;
					return returnValue;
				};
				// point to the underlying method
				value.valueOf = function(type) {
					return (type == "object") ? value : method;
				};
				value.toString = Base.toString;
			}
			this[source] = value;
		} else if (source) { // extending with an object literal
			var extend = Base.prototype.extend;
			// if this object has a customised extend method then use it
			if (!Base._prototyping && typeof this != "function") {
				extend = this.extend || extend;
			}
			var proto = {toSource: null};
			// do the "toString" and other methods manually
			var hidden = ["constructor", "toString", "valueOf"];
			// if we are prototyping then include the constructor
			var i = Base._prototyping ? 0 : 1;
			while (key = hidden[i++]) {
				if (source[key] != proto[key]) {
					extend.call(this, key, source[key]);

				}
			}
			// copy each of the source object's properties to this object
			for (var key in source) {
				if (!proto[key]) extend.call(this, key, source[key]);
			}
		}
		return this;
	},

	base: function() {
		// call this method from any other method to invoke that method's ancestor
	}
};

// initialise
Base = Base.extend({
	constructor: function() {
		this.extend(arguments[0]);
	}
}, {
	ancestor: Object,
	version: "1.1",
	
	forEach: function(object, block, context) {
		for (var key in object) {
			if (this.prototype[key] === undefined) {
				block.call(context, object[key], key, object);
			}
		}
	},
		
	implement: function() {
		for (var i = 0; i < arguments.length; i++) {
			if (typeof arguments[i] == "function") {
				// if it's a function, call it
				arguments[i](this.prototype);
			} else {
				// add the interface using the extend method
				this.prototype.extend(arguments[i]);
			}
		}
		return this;
	},
	
	toString: function() {
		return String(this.valueOf());
	}
});

// requires: jquery

var log = function(what) {
    $("body").prepend($("<pre>").text(what));
}


// From http://www.terrainformatica.com/?p=13
var delegate = function( that, thatMethod )
{
    if(arguments.length > 2)
    {
        var _params = [];
        for(var n = 2; n < arguments.length; ++n) _params.push(arguments[n]);
        return function() { return thatMethod.apply(that,_params); };
    }
    else
      return function() { return thatMethod.call(that); };
}

var delegate_cp = function( that, thatMethod ) {
    return function() { return thatMethod.apply(that,arguments); }
};

function utf8_encode( s ) {
  return unescape( encodeURIComponent( s ) );
}

function utf8_decode( s ) {
  return decodeURIComponent( escape( s ) );
}

/**
 * Returns the first data element of an object, regardless on its key name.
 */
var extractRoot = function(data) {
  for(var key in data) {
    return data[key];
  }
}


Array.prototype.toObject = function() {
    var out = {};
    for(var i=0; i<this.length; i++) {
        out[i] = this[i];
    }
    return out;
}


// from 4umi.com/web/javascript

// -- Standard functions

// Array.concat() - Join two arrays
if( typeof Array.prototype.concat==='undefined' ) {
 Array.prototype.concat = function( a ) {
  for( var i = 0, b = this.copy(); i<a.length; i++ ) {
   b[b.length] = a[i];
  }
  return b;
  };
}

// Array.copy() - Copy an array
if( typeof Array.prototype.copy==='undefined' ) {
 Array.prototype.copy = function() {
  var a = [], i = this.length;
  while( i-- ) {
   a[i] = typeof this[i].copy!=='undefined' ? this[i].copy() : this[i];
  }
  return a;
 };
}

// Array.pop() - Remove and return the last element of an array
if( typeof Array.prototype.pop==='undefined' ) {
 Array.prototype.pop = function() {
  var b = this[this.length-1];
  this.length--;
  return b;
 };
}

// Array.push() - Add an element to the end of an array, return the new length
if( typeof Array.prototype.push==='undefined' ) {
 Array.prototype.push = function() {
  for( var i = 0, b = this.length, a = arguments, l = a.length; i<l; i++ ) {
   this[b+i] = a[i];
  }
  return this.length;
 };
}

// Array.shift() - Remove and return the first element
if( typeof Array.prototype.shift==='undefined' ) {
 Array.prototype.shift = function() {
  for( var i = 0, b = this[0], l = this.length-1; i<l; i++ ) {
   this[i] = this[i+1];
  }
  this.length--;
  return b;
 };
}

// Array.slice() - Copy and return several elements
if( typeof Array.prototype.slice==='undefined' ) {
 Array.prototype.slice = function( a, c ) {
  var i, l = this.length, r = [];
  if( !c ) { c = l; }
  if( c<0 ) { c = l + c; }
  if( a<0 ) { a = l - a; }
  if( c<a ) { i = a; a = c; c = i; }
  for( i = 0; i < c - a; i++ ) { r[i] = this[a+i]; }
  return r;
 };
}

// Array.splice() - Remove or replace several elements and return any deleted elements
if( typeof Array.prototype.splice==='undefined' ) {
 Array.prototype.splice = function( a, c ) {
  var i = 0, e = arguments, d = this.copy(), f = a, l = this.length;
  if( !c ) { c = l - a; }
  for( i; i < e.length - 2; i++ ) { this[a + i] = e[i + 2]; }
  for( a; a < l - c; a++ ) { this[a + e.length - 2] = d[a - c]; }
  this.length -= c - e.length + 2;
  return d.slice( f, f + c );
 };
}

// Array.unshift() - Add an element to the beginning of an array
if( typeof Array.prototype.unshift==='undefined' ) {
 Array.prototype.unshift = function() {
  this.reverse();
  var a = arguments, i = a.length;
  while(i--) { this.push(a[i]); }
  this.reverse();
  return this.length;
 };
}

// -- 4umi additional functions

// Array.forEach( function ) - Apply a function to each element
Array.prototype.forEach = function( f ) {
 var i = this.length, j, l = this.length;
 for( i=0; i<l; i++ ) { if( ( j = this[i] ) ) { f( j ); } }
};

// Array.indexOf( value, begin, strict ) - Return index of the first element that matches value
Array.prototype.indexOf = function( v, b, s ) {
 for( var i = +b || 0, l = this.length; i < l; i++ ) {
  if( this[i]===v || s && this[i]==v ) { return i; }
 }
 return -1;
};

// Array.insert( index, value ) - Insert value at index, without overwriting existing keys
Array.prototype.insert = function( i, v ) {
 if( i>=0 ) {
  var a = this.slice(), b = a.splice( i );
  a[i] = v;
  return a.concat( b );
 }
};

// Array.lastIndexOf( value, begin, strict ) - Return index of the last element that matches value
Array.prototype.lastIndexOf = function( v, b, s ) {
 b = +b || 0;
 var i = this.length; while(i-->b) {
  if( this[i]===v || s && this[i]==v ) { return i; }
 }
 return -1;
};

// Array.random( range ) - Return a random element, optionally up to or from range
Array.prototype.random = function( r ) {
 var i = 0, l = this.length;
 if( !r ) { r = this.length; }
 else if( r > 0 ) { r = r % l; }
 else { i = r; r = l + r % l; }
 return this[ Math.floor( r * Math.random() - i ) ];
};

// Array.shuffle( deep ) - Randomly interchange elements
Array.prototype.shuffle = function( b ) {
 var i = this.length, j, t;
 while( i ) {
  j = Math.floor( ( i-- ) * Math.random() );
  t = b && typeof this[i].shuffle!=='undefined' ? this[i].shuffle() : this[i];
  this[i] = this[j];
  this[j] = t;
 }
 return this;
};

// Array.unique( strict ) - Remove duplicate values
Array.prototype.unique = function( b ) {
 var a = [], i, l = this.length;
 for( i=0; i<l; i++ ) {
  if( a.indexOf( this[i], 0, b ) < 0 ) { a.push( this[i] ); }
 }
 return a;
};

// Array.walk() - Change each value according to a callback function
Array.prototype.walk = function( f ) {
 var a = [], i = this.length;
 while(i--) { a.push( f( this[i] ) ); }
 return a.reverse();
};

String.prototype.capitalize = function() {
    return this.charAt(0).toUpperCase() + this.slice(1);
}

String.prototype.trim=function(){return this.replace(/^\s\s*/, '').replace(/\s\s*$/, '');};

String.prototype.ltrim=function(){return this.replace(/^\s+/,'');}

String.prototype.rtrim=function(){return this.replace(/\s+$/,'');}

String.prototype.fulltrim=function(){return this.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,'').replace(/\s+/g,' ');}

String.prototype.camelCase = function() { 
    var s = this.trim();
    return ( /\S[A-Z]/.test( s ) ) ?
        s.replace( /(.)([A-Z])/g, function(t,a,b) { return a + ' ' + b.toLowerCase(); } ) :
        s.replace( /( )([a-z])/g, function(t,a,b) { return b.toUpperCase(); } );
}

// TODO remove, substitute with capitalize
String.prototype.firstLetterToUpper = function()
{
    return this.charAt(0).toUpperCase() + this.slice(1);
}


// code generation utilities

var CodeGenUtils = {
    getSetterName: function(name) {
        return "set" + name.firstLetterToUpper();
    },
    getGetterName: function(name, isBoolean) {
        return (isBoolean ? "is" : "get") + name.firstLetterToUpper();
    }
}



String.prototype.endsWith = function(suffix) {
    return this.indexOf(suffix, this.length - suffix.length) !== -1;
};

if (typeof String.prototype.startsWith != 'function') {
  String.prototype.startsWith = function (str){
    return this.slice(0, str.length) == str;
  };
}

function htmlEncode( input ) {
    return String(input)
        .replace(/&/g, '&amp;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '\'')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;');
}

function htmlDecode( input ) {
    return String(input)
        .replace(/&amp;/g, '&')
        .replace(/&quot;/g, '\"')
        .replace(/'/g, '\'')
        .replace(/&lt;/g, '<')
        .replace(/&gt;/g, '>');
}

function base64_decode (data) {
  // http://kevin.vanzonneveld.net
  // +   original by: Tyler Akins (http://rumkin.com)
  // +   improved by: Thunder.m
  // +      input by: Aman Gupta
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +   bugfixed by: Onno Marsman
  // +   bugfixed by: Pellentesque Malesuada
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +      input by: Brett Zamir (http://brett-zamir.me)
  // +   bugfixed by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // *     example 1: base64_decode('S2V2aW4gdmFuIFpvbm5ldmVsZA==');
  // *     returns 1: 'Kevin van Zonneveld'
  // mozilla has this native
  // - but breaks in 2.0.0.12!
  //if (typeof this.window['atob'] == 'function') {
  //    return atob(data);
  //}
  var b64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
  var o1, o2, o3, h1, h2, h3, h4, bits, i = 0,
    ac = 0,
    dec = "",
    tmp_arr = [];

  if (!data) {
    return data;
  }

  data += '';

  do { // unpack four hexets into three octets using index points in b64
    h1 = b64.indexOf(data.charAt(i++));
    h2 = b64.indexOf(data.charAt(i++));
    h3 = b64.indexOf(data.charAt(i++));
    h4 = b64.indexOf(data.charAt(i++));

    bits = h1 << 18 | h2 << 12 | h3 << 6 | h4;

    o1 = bits >> 16 & 0xff;
    o2 = bits >> 8 & 0xff;
    o3 = bits & 0xff;

    if (h3 == 64) {
      tmp_arr[ac++] = String.fromCharCode(o1);
    } else if (h4 == 64) {
      tmp_arr[ac++] = String.fromCharCode(o1, o2);
    } else {
      tmp_arr[ac++] = String.fromCharCode(o1, o2, o3);
    }
  } while (i < data.length);

  dec = tmp_arr.join('');

  return dec;
}



function base64_encode (data) {
  // http://kevin.vanzonneveld.net
  // +   original by: Tyler Akins (http://rumkin.com)
  // +   improved by: Bayron Guevara
  // +   improved by: Thunder.m
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +   bugfixed by: Pellentesque Malesuada
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +   improved by: Rafał Kukawski (http://kukawski.pl)
  // *     example 1: base64_encode('Kevin van Zonneveld');
  // *     returns 1: 'S2V2aW4gdmFuIFpvbm5ldmVsZA=='
  // mozilla has this native
  // - but breaks in 2.0.0.12!
  //if (typeof this.window['btoa'] == 'function') {
  //    return btoa(data);
  //}
  var b64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
  var o1, o2, o3, h1, h2, h3, h4, bits, i = 0,
    ac = 0,
    enc = "",
    tmp_arr = [];

  if (!data) {
    return data;
  }

  do { // pack three octets into four hexets
    o1 = data.charCodeAt(i++);
    o2 = data.charCodeAt(i++);
    o3 = data.charCodeAt(i++);

    bits = o1 << 16 | o2 << 8 | o3;

    h1 = bits >> 18 & 0x3f;
    h2 = bits >> 12 & 0x3f;
    h3 = bits >> 6 & 0x3f;
    h4 = bits & 0x3f;

    // use hexets to index into b64, and append result to encoded string
    tmp_arr[ac++] = b64.charAt(h1) + b64.charAt(h2) + b64.charAt(h3) + b64.charAt(h4);
  } while (i < data.length);

  enc = tmp_arr.join('');

  var r = data.length % 3;

  return (r ? enc.slice(0, r - 3) : enc) + '==='.slice(r || 3);

}


// Array Remove - By John Resig (MIT Licensed)
Array.prototype.remove = function(from, to) {
  var rest = this.slice((to || from) + 1 || this.length);
  this.length = from < 0 ? this.length + from : from;
  return this.push.apply(this, rest);
};

jQuery.fn.swap = function(b) {
    b = jQuery(b)[0];
    var a = this[0];

    var t = a.parentNode.insertBefore(document.createTextNode(''), a);
    b.parentNode.insertBefore(a, b);
    t.parentNode.insertBefore(b, t);
    t.parentNode.removeChild(t);

    return this;
};


// smallest jQuery plugin :)
jQuery.fn.reverse = [].reverse;


var makeSvgScalable = function(svg) {
    var el = svg[0];
    var ww = el.getAttribute("width");
    var hh = el.getAttribute("height");
    el.setAttribute('width', '100%');
    el.setAttribute('height', '100%');
    el.setAttribute('viewBox', '0 0 '+ww+' '+hh);
    el.setAttribute('preserveAspectRatio', 'xMidyMid meet');
};

var Common = {
    postJsonData: function(url, data, success, error) {
        $.ajax({
            type: "post",       // Request method: post, get
            url: url,
            data: JSON.stringify(data), 
            dataType: "json",    // Expected response type
            contentType: "application/json",
            cache: false,
            success: success || $.noop,
            error: error || $.noop
        });
    }
};

var JQ = {
    button: function(caption, click, parent) {
        var btn = $("<button>").text(caption);
        if(click) btn.click(click);
        if(parent) btn.appendTo(parent);
        return btn;
    },
    linkButton: function(content, click, parent) {
        var btn = JQ.put($("<a>"), content);
        if(click) btn.click(click);
        if(parent) btn.appendTo(parent);
        return btn;
    },
    link: function(content, href, tooltip, parent) {
        var link = JQ.put($("<a>"), content).attr({"title":tooltip, "href":href});
        if(parent) link.appendTo(parent);
        return link;
    },
    ul: function(parent) {
        var ul = $("<ul>");
        if(parent) ul.appendTo(parent);
        return ul;
    },
    li: function(klass, parent) {
        var li = $("<li>").addClass(klass);
        if(parent) li.appendTo(parent);
        return li;
    },
    checkbox: function(name, checked, parent) {
        var input = $("<input>").attr({'type':'checkbox', 'name':name}).prop("checked", checked);
        if(parent) input.appendTo(parent);
        return input;
    },
    textfield: function(name, value, parent) {
        var input = $("<input>").attr({'type':'text', 'name':name, "value":value});
        if(parent) input.appendTo(parent);
        return input;
    },
    span: function(content, klass, parent) {
        var span = JQ.put("span", content).addClass(klass);
        if(parent) span.appendTo(parent);
        return span;
    },
    div: function(content, klass, parent) {
        var div = JQ.put("div", content).addClass(klass);
        if(parent) div.appendTo(parent);
        return div;
    },
    p: function(content, klass, parent) {
        var p = JQ.put("p", content).addClass(klass);
        if(parent) p.appendTo(parent);
        return p;
    },
    h1: function(content, klass, parent) {
        return JQ.hN(1, content, klass, parent);
    },
    h2: function(content, klass, parent) {
        return JQ.hN(2, content, klass, parent);
    },
    h3: function(content, klass, parent) {
        return JQ.hN(3, content, klass, parent);
    },
    h4: function(content, klass, parent) {
        return JQ.hN(4, content, klass, parent);
    },
    h5: function(content, klass, parent) {
        return JQ.hN(5, content, klass, parent);
    },
    h6: function(content, klass, parent) {
        return JQ.hN(6, content, klass, parent);
    },
    hN: function(level, content, klass, parent) {
        var heading = JQ.put("h"+level, content).addClass(klass);
        if(parent) heading.appendTo(parent);
        return heading;
    },
    label: function(content, klass, parent) {
        var label = JQ.put("label", content).addClass(klass);
        if(parent) label.appendTo(parent);
        return label;
    },
    clear: function(parent) {
        var clr = $("<div>").addClass("clear");
        if(parent) clr.appendTo(parent);
        return clr;
    },
    show: function(elem, enabled) {
        if(enabled) elem.show(); else elem.hide();
    },
    form: function(klass, parent) {
        var div = $("<form>").addClass(klass);
        if(parent) div.appendTo(parent);
        return div;
    },
    fieldset: function(klass, parent) {
        var div = $("<fieldset>").addClass(klass);
        if(parent) div.appendTo(parent);
        return div;
    },
    toggleLink: function(captionOn, captionOff, target, parent) {
        var visible = target.is(":visible");
        var btn = JQ.put("a", visible ? captionOn : captionOff).click(function() {
            var visible = target.is(":visible");
            if(visible) {
                target.hide();
                btn.text(captionOff);
            } else {
                target.show();
                btn.text(captionOn);
            }
        });
        if(parent) btn.appendTo(parent);
        return btn;
    },
    linkExt: function(caption, href, tooltip, parent) {
        return JQ.link(caption, href, tooltip, parent).attr("target","_blank");
    },
    put: function(where, what) {
        if(typeof(where) == "string") {
            where = $("<"+where+">");
        }
        if(what) {
            if(typeof(what) == "string") {
                where.text(what);
            } else {
                where.append(what);
            }
        }
        return where;
    }
};

// kazda 'vec' ma options (s defaultni hodnotou) a slots
var Thing = Base.extend({
    constructor: function(options, slots) {
        this.options = $.extend({}, this.defaults(), options);        
        this.tid = Thing.tid++;
        Thing.things[this.tid] = this;
        this.element = $("<div>").addClass(this.getClass()).attr("data-tid", this.tid);
        if(DEBUG) {
            this.element.css("background-color", '#'+Math.floor(Math.random()*16777215).toString(16));
        }
        this.slots = {};
        this.parent = null;
        this.name = null;
        // initializing...
	    this.slotChanged($.noop);
        this.init();
        this.setSlots(slots);
        // display update
        this.refresh();
    },
    copy: function() {
        return Thing.create(this.serialize());
    },
    remove: function() {
        this.replaceWith(Thing.empty());        
    },
    replaceWith: function(thing) {
        if(this.parent) {
            this.parent.setSlot(this.name, thing);
            this.parent = null;
            this.name = null;           
            Thing.things[this.tid] = null;
        }
    },
    // obali this dekoratorem
    decorate: function(deco) {
        if(this.parent) {
            var par = this.parent;
            var slot = this.name;
            deco.setSlot('content', this);
            par.setSlot(slot, deco);
            return deco;
        }
    },
    serialize: function() {
        var slots = {};
        var numslots = 0;
        for(var key in this.slots) {
            slots[key] = this.slots[key].serialize();
            numslots++;
        }
        var obj = {
            type: this.getType(),
            options: this.options
        };
        if(numslots) obj.slots = slots
        return obj;
    },
    getType: function() {
        return this._type;
    },
    getClass: function() {
        return this._klass.split(" ").map(function(a){return "mykkro-"+a;}).join(" ");
    },
    init: function() {
        // create structure and variables
    },
    refresh: function() {
        // options changed...
        this.element.attr('class','');
        this.element.addClass(this.getClass());
        this.element.addClass(this.options.css);
    },
    get: function() {
        return this.element;
    },
    defaults: function() {
        return this._defaults;
    },
    // muzeme se dostat takhle i ke slotu ve slotu
    content: function(key, value) {
        var ndx = key.indexOf(".");
        if(ndx>=0) {
            // odkazujeme se na slot ve slotu
            var newKey = key.substring(0,ndx);
            var rest = key.substring(ndx+1);
            return this.getSlot(newKey).content(rest, value);
        }
        if(this.hasSlot(key)) {
            if(value) {
                // setter
                this.setSlot(key, value);
                return this;
            } else {
                // getter
                return this.getSlot(key);
            }
        } else {
            // unknown slot!
            return null;
        }
    },
    hasSlot: function(key) {
        return !!this.slots[key];
    },
    getSlot: function(key) {
        return this.slots[key];
    },
    setSlot: function(key, thing) {
        this.slots[key] = thing;
        thing._setParent(this, key);
        // DOM manipulation - to be overridden
	    this.slotChanged(key);
        return this;
    },
    removeSlot: function(key) {
        delete this.slots[key]
    },
    clearSlots: function() {
        for(var key in this.slots) {
            this.setSlot(key, Thing.empty());
        }
    },
    setOptions: function(opts) {
        this.options = $.extend(this.options, opts);
        this.refresh();
	    this.slotChanged('options');
    },
    setSlots: function(slots) {
        if(slots) {
            // pokud je parametr pole, udelat z nej objekt
            if($.isArray(slots)) slots = slots.toObject();
            for(var key in slots) {
                this.setSlot(key, slots[key]);
            }
        }
    },
    _setParent: function(parent, key) {
        this.parent = parent;
        this.name = key;
    },
    isEmpty: function() {
        return this.getType() == "empty";
    },
    slotChanged: function(arg) {
        if(typeof arg == "function") {
            this.onslotchanged = arg;
        } else {
            return this.onslotchanged(this, arg);
        }
    },    
    // bez parametru vraci rekurzivne vsechny sloty
    findSlots: function(predicate, out) {
        if(!predicate) predicate = function() { return true; };
        if(!out) out = [];
        if(predicate(this)) out.push(this);
        for(var key in this.slots) {
            this.slots[key].findSlots(predicate, out);
        }
        return out;
    },
    findEmptySlots: function(out) {
        return this.findSlots(function(thing) { return thing.isEmpty(); }, out)
    },
    findSlotsByType: function(type, out) {
        return this.findSlots(function(thing) { return thing.getType() == type; }, out)
    },
    getTree: function() {
        var node = { type: this.getType(), children: {} };
        for(var key in this.slots) {
            node.children[key] = this.slots[key].getTree();
        }
        return node;
    },
    _toggleTreeView: function(node) {
        node.children(".slots").toggleClass('collapsed');
    },
    // TODO mohlo by si to pamatovat expands/collapse mezi updaty
    /* example decorator:
        decorator = function(thing, node) {
            $("<div>").addClass("toolz").insertAfter(node.find(">h2"));
        };
    */
    getTreeView: function(decorator) {
        var self = this;
        var node = $("<div>").addClass('node').attr('data-type', this.getType()).attr('data-tid', this.tid);
        var hdr = $("<h2>").text(this.getType()).appendTo(node);
        var slots = $("<div>").addClass('slots').appendTo(node);
        hdr.click(function() {
            self._toggleTreeView(node);
        });
        for(var key in this.slots) {
            (function(){
                var subtree = self.slots[key].getTreeView(decorator);
                var subheading = $("<h3>").text(key).click(function() {
                    $(this).toggleClass('collapsed');
                    self._toggleTreeView(subtree);
                });
                slots.append(subheading);
                slots.append(subtree);
            })();
        }
        node.append($("<div>").addClass('clear'));
        if(decorator) decorator(this, node);
        return node;
    },
    _type: "thing",
    _defaults: {
        "css": ""
    },
    _klass: "thing",
    _schema: {
       "type":"object",
       "properties":{
       },
       "additionalProperties":true
    }

},{    
    tid: 0,
    things: {},
    create: function(def, opts) {
        if(!def) {
            return Thing.empty();
        }
        // udelat deserializaci
        // { type, options, slots }
        var klassName = def.type.replace(/-([a-z])/g, function (g) { return g[1].toUpperCase() });
        klassName = klassName.capitalize();
        var klazz = window[klassName];
        var slots = def.slots;
        var oid = def.id;
        if($.isArray(slots)) slots = slots.toObject();
        for(var key in slots) {
            slots[key] = Thing.create(slots[key]);
        }
        var thing = new klazz($.extend(def.options, opts), slots);
        thing.oid = oid
        return thing
    },
    empty: function(options) {
        return new Empty(options);
    }
});



var Empty = Thing.extend({
    refresh: function() {
        this.element.empty();
        /*
        if(this.parent) this.element.html(
            $("<div>").text(this.parent.getType()+"#"+this.name)
        );
        */
    },
    _setParent: function(parent, key) {
        this.base(parent, key);
        this.refresh();
    },
    _klass: "empty thing",
    _type: "empty"
});


var Imager = Thing.extend({
    refresh: function() {
        var img = $("<div>")
            .css("background-image",'url("'+this.options.url+'")')
            .css('background-position',this.options['position'])
            .css('background-repeat',this.options['repeat'])
            .css('background-color',this.options['color'])
            .css('background-size',this.options['size'])
            .css('-moz-background-size',this.options['size'])
            .css('-webkit-background-size',this.options['size']);
        this.element.html(img);
    },
    _klass: "imager thing",
    _type: "imager",
    _defaults: {
        "url": "images/demo/australie1.jpg",
        "repeat": "no-repeat",
        "position": "center center",
        "color": "white",
        "size": "cover" 
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "color": {
			    "type":"string",
			    "id": "color",
			    "required":true,
                "format": "color"
		    },
		    "position": {
			    "type":"string",
			    "id": "position",
			    "required":true
		    },
		    "repeat": {
			    "type":"string",
			    "id": "repeat",
			    "required":true
		    },
		    "size": {
			    "type":"string",
			    "id": "size",
                "enum":["cover","contain"],
			    "required":true
		    },
		    "url": {
			    "type":"string",
			    "id": "url",
                "format": "my-image-uri",
			    "required":true
		    }
	    }
    }

});


var RaphaelThing = Thing.extend({
    refresh: function() {
        var o = this.options;
        var div = $("<div>");
        this.element.html(div);
        var paper = Raphael(div.get(0), "100%","100%");
        paper.setViewBox(0, 0, o.width, o.height, true);
        this.canvas = paper;
    },
    _klass: "raphael-thing thing",
    _type: "raphael-thing",
    _defaults: {
        width: 100,
        height: 100
    },
    _schema: {
       "type":"object",
       "description":"RaphaelThing properties",
       "properties":{
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }

});


var CanvasThing = Thing.extend({
    init: function() {
        var o = this.options;
        var self = this;
        this.canvas = $("<canvas>").appendTo(this.element).attr({width:o.width, height:o.height});
        // pouziva CSS transformaci, rastr je porad stejne velky
        if(o.autoscale) {
            this.element.resize(function() {
                var el = $(this);
                var o = self.options;
                var zoom = Math.min(el.width()/o.width, el.height()/o.height);
                el.css({
                    "-moz-transform": "scale("+zoom+")", 
                    "-webkit-transform": "scale("+zoom+")", 
                    "-moz-transform-origin":"0px 0px", 
                    "-webkit-transform-origin":"0px 0px"
                });
            });
        }
        // zvetsuje fyzicky pocet pixelu rastru
        if(o.autoresize) {
            this.element.resize(function() {
                var el = $(this);
                var ww = el.width();
                var hh = el.height();
                if(o.keepaspectratio) { var asp = o.width/o.height; if(ww/hh > asp) ww = hh*asp; else hh = ww/asp; }
                self.canvas.attr({
                    "width": ww, 
                    "height": hh
                });
                self.refresh();
            });
            var el = this.element;
            var ww = el.width();
            var hh = el.height();
            if(o.keepaspectratio) { var asp = o.width/o.height; if(ww/hh > asp) ww = hh*asp; else hh = ww/asp; }
            this.canvas.attr({
                "width": ww, 
                "height": hh
            });            
        }
    },
    refresh: function() {
        var context = this.canvas.get(0).getContext('2d');
        if (context) {
            this.draw(context, this.canvas.width() || this.options.width, this.canvas.height() || this.options.height);
        }
    },
    draw: function(g, w, h) {
        /* by default, draws only rectangle... */
        g.strokeRect(0,  0, w, h);
    },
    _klass: "canvas-thing thing",
    _type: "canvas-thing",
    _defaults: {
        width: 100,
        height: 100,
        autoscale: false,
        autoresize: true,
        keepaspectratio: true
    },
    _schema: {
       "type":"object",
       "description":"CanvasThing properties",
       "properties":{
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          },
          "autoscale":{
             "type":"boolean",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


// http://www.nihilogic.dk/labs/javascript_canvas_fractals/
var Fractal = CanvasThing.extend({
    draw: function(ctx, w, h) {
        var smoothColors = this.options.smoothcolors;
        var vx = this.options.vx;
        var vy = this.options.vy;
        var zoom = this.options.zoom;

        var imageData = !!ctx.getImageData;
        var startit = 30;
        var xmin, xmax, ymin, ymax, dx, dy;
        var er = 2;

        var colors = {
	        red : [[0,0,1],[0,1,0],[0,1,0]],
	        blue : [[0,0,0],[0,1,0],[0,1,1]],
	        green : [[0,1,0],[0,0,1],[0,1,0]],
	        orange : [[1,1,1],[0,1,0],[0,0,0]],
	        magenta : [[0,0,1],[0,0.1,0.5],[0,0,1]],
	        yellow : [[0.2,0.2,1],[0.2,0.2,1],[0,0,0.2]],

        };

        var log2 = 1 / Math.log(2.0);
        var sin = Math.sin;
        var cos = Math.cos;
        var exp = Math.exp;
        var phi = 1.6180339887;
        function cosh(a) {
            return (exp(a) + exp(-a))/2;
        }
        function sinh(a) {
            return (exp(a) - exp(-a))/2;
        }
        function csin(x,y) {
	        return [sin(x) * cosh(y), cos(x) * sinh(y)];
        }
        function ccos(x,y) {
	        return [cos(x)*cosh(y), -sin(x)*sinh(y)];
        }
        function cexp(x,y) {
	        return [exp(x)*cos(y), exp(x)*sin(y)];
        }
        function cmul(c1,c2) {
	        return [
		        c1[0]*c2[0]-c1[1]*c2[1],
		        c1[0]*c2[1]+c1[1]*c2[0]
	        ];
        }

        var fractals = {

	        mandelbrot : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        var lastxx, lastyy;
		        do {
			        y = (x+x)*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2) {

				        y = (x+x)*y + y0; // iterate once for more for smoother colors
				        x = xx - yy + x0;
				        yy = y*y;
				        xx = x*x;

				        break;
			        }
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliacubed : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {

			        tx = x;
			        ty = y;

			        tx2 = x*x-y*y;
			        ty2 = 2*x*y;

			        x = tx2*tx-ty2*ty + 1-phi;
			        y = tx2*ty+ty2*tx + 0.3;

			        xx = x*x;
			        yy = y*y;

			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        multibrot3 : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var tx, ty, tx2, ty2;
		        var xx = x*x, yy = y*y;
		        do {
			        tx = x;
			        ty = y;
			        tx2 = xx-yy;
			        ty2 = 2*x*y;
			        x = tx2*tx-ty2*ty + x0;
			        y = tx2*ty+ty2*tx + y0;
			        xx = x*x;
			        yy = y*y;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        multibrot4 : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = 2*x*y;
			        x = xx - yy;
			        yy = y*y;
			        xx = x*x;
			        y = 2*x*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        multibrot8 : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = 2*x*y;
			        x = xx - yy;
			        yy = y*y;
			        xx = x*x;
			        y = 2*x*y;
			        x = xx - yy;
			        yy = y*y;
			        xx = x*x;
			        y = 2*x*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        burningship : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = 2*Math.abs(x*y) - y0;
			        x = xx - yy - x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        tricorn : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = -y;

			        y = (x+x)*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        julia_base : function(x, y, it, er2, cr, ci) {
		        var xx = x*x, yy = y*y;
		        do {
			        y = (x+x)*y + ci;
			        x = xx - yy + cr;
			        yy = y*y;
			        xx = x*x;

			        if (xx+yy > er2) {
				        y = (x+x)*y + ci;
				        x = xx - yy + cr;
				        yy = y*y;
				        xx = x*x;

				        break;
			        }
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        julia1 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, phi - 2, phi - 1);
	        },

	        julia2 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 1-phi, 0);
	        },

	        julia3 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 0.285, 0);
	        },

	        julia4 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 0.285, 0.01);
	        },

	        julia5 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.835, -0.2321);
	        },

	        julia6 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.7, -0.3);
	        },

	        julia7 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 0, 1);
	        },

	        julia8 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.391, -0.587);
	        },

	        julia9 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.123, 0.745);
	        },

	        julia10 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.75, 0);
	        },

	        julia11 : function(x, y, it, er2) {
		        var zr, zi;
		        var cr = 0.6;
		        var ci = 1.1;
		        var xx = x*x, yy = y*y;
		        do {
			        zr = x - (x?(x<0?-1:1):0);
			        zi = y;
			        x = cr*zr-ci*zi;
			        y = cr*zi+ci*zr;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliasine_base : function(x, y, it, er2, cr, ci) {
		        var xx = x*x, yy = y*y;
		        var z, expy, expmy;
		        var c = [cr, ci];
		        do {
			        //z = csin(x,y);
			        expy = exp(y);
			        expmy = exp(-y);
			        z = [sin(x) * (expy + expmy)/2, cos(x) * (expy - expmy)/2];

			        x = c[0]*z[0]-c[1]*z[1];
			        y = c[0]*z[1]+c[1]*z[0];

			        yy = y*y, xx = x*x;
			        if (xx+yy > 500)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliasine : function(x, y, it, er2) {
		        return fractals["juliasine_base"](x, y, it, er2, 1, 0.1);
	        },

	        juliasine2 : function(x, y, it, er2) {
		        return fractals["juliasine_base"](x, y, it, er2, 1, 0.3);
	        },

	        juliacosine_base : function(x, y, it, er2, cr, ci) {
		        var xx = x*x, yy = y*y;
		        var z, expy, expmy;
		        var c = [cr, ci];
		        do {
			        //z = ccos(x,y);
			        expy = exp(y);
			        expmy = exp(-y);
			        z = [cos(x) * (expy + expmy)/2, -sin(x) * (expy - expmy)/2];

			        x = c[0]*z[0]-c[1]*z[1];
			        y = c[0]*z[1]+c[1]*z[0];

			        yy = y*y, xx = x*x;
			        if (xx+yy > 500)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliacosine : function(x, y, it, er2) {
		        return fractals["juliacosine_base"](x, y, it, er2, 1, 0.6);
	        },

	        juliacosine2 : function(x, y, it, er2) {
		        return fractals["juliacosine_base"](x, y, it, er2, Math.PI/2 * 1.5, Math.PI/2 * 0.05);
	        },

	        juliacosine3 : function(x, y, it, er2) {
		        var xx = x*x, yy = y*y;
		        var z, expy, expmy;
		        var c = [1, 0.1];
		        do {
			        //z = ccos(x,y);
			        expy = exp(y);
			        expmy = exp(-y);
			        z = [cos(x) * (expy + expmy)/2, -sin(x) * (expy - expmy)/2];

			        x = c[0]*z[0]-c[1]*z[1];
			        y = c[0]*z[1]+c[1]*z[0];

			        tx = x;
			        x = -y;
			        y = tx;

			        yy = y*y, xx = x*x;
			        if (xx+yy > 500)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

        };

        // from http://www.nihilogic.dk/labs/javascript_canvas_fractals/
        function render(fncFrac, colWeights) {
	        var time = new Date().getTime();

	        ctx.fillStyle = "#000000";
	        ctx.fillRect(0,0,w,h);

	        if (imageData) {
		        var data = ctx.getImageData(0,0,w,h);
		        var pixels = data.data;
	        }

	        var mi = Math.max(startit, Math.round(Math.max(Math.log(zoom),1) * startit));
	        var itfac = 1/mi*startit

	        xmin = vx - 2/zoom;
	        xmax = vx + 2/zoom;
	        ymin = vy - 2/zoom;
	        ymax = vy + 2/zoom;

	        dx = xmax-xmin;
	        dy = ymax-ymin;

	        var px, py, it;

	        var er2 = er*er;

	        var c1, c2, c3, m;
	        var col1, col2, col3;
	        var cw0 = colWeights[0], cw1 = colWeights[1], cw2 = colWeights[2];

	        var i = (w*h)-1;
	        do {
		        var offset = i*4;

		        px = (i%w);
		        py = h-((i/w)|0);

		        var res = fncFrac(
			        xmin + px/w * dx, 
			        ymin + py/h * dy, 
			        mi, er2
		        )

		        it = mi - res.it;

		        var mag = smoothColors ? 
				        (it * itfac) - (Math.log(Math.log(res.xx+res.yy))) * log2
				        : it * itfac;

		        //if (color == "bw") {
			    //    c1 = c2 = c3 = 
				//        (res.it==mi) ? 255 : 255 - mag/startit * 255;
		        //} else {
			        if (res.it == 0)
				        continue;

			        if (mag < startit/3) {
				        m = (mag*3);
				        col1 = m * 4;
				        col2 = m * 4;
				        col3 = m * 10;
			        } else if (mag < startit/1.5) {
				        m = (mag-startit/3)*3;
				        col1 = 80 + m * 8;
				        col2 = 80 + m * 8;
				        col3 = 200 + m * 2.5;
			        } else {
				        m = (mag-2*startit/3)*3
				        col1 = 220 + m * 1.5;
				        col2 = 220 + m * 1.5;
				        col3 = 255;
			        }

			        c1 = col1*cw0[0] + col2*cw0[1] + col3*cw0[2];
			        c2 = col1*cw1[0] + col2*cw1[1] + col3*cw1[2];
			        c3 = col1*cw2[0] + col2*cw2[1] + col3*cw2[2];
		        //}

		        c1 = c1 < 0 ? 0 : c1;
		        c2 = c2 < 0 ? 0 : c2;
		        c3 = c3 < 0 ? 0 : c3;

		        c1 = c1 > 255 ? 255 : c1;
		        c2 = c2 > 255 ? 255 : c2;
		        c3 = c3 > 255 ? 255 : c3;

		        if (!imageData) {
			        ctx.fillStyle = "rgb(" + (c1|0) + "," + (c2|0) + "," + (c3|0) + ")";
			        ctx.fillRect((px|0), h-((py|0)), 1, 1);
		        } else {
			        pixels[offset] = c1;
			        pixels[offset+1] = c2;
			        pixels[offset+2] = c3;
		        }

	        } while(--i);

	        if (imageData) {
		        ctx.putImageData(data,0,0);
		        ctx.fillRect(0,0,0,0);
	        }
        };

        render(fractals[this.options.algorithm], colors[this.options.color]);
    },
    _klass: "fractal thing",
    _type: "fractal",
    _defaults: {
        width: 300,
        height: 300,
        autoscale: false,
        autoresize: true,
        keepaspectratio: true,
        algorithm: "mandelbrot",
        color: "yellow",
        smoothcolors: true,
        vx: 0.3,
        vy: 0,
        zoom: 10
    },
    _schema: {
       "type":"object",
       "description":"Fractal properties",
       "properties":{
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          },
          "autoscale":{
             "type":"boolean",
             "required":false
          }
       },
       "additionalProperties":true
    }
});


var Html = Thing.extend({
    init: function() {
        this.inner = $("<div>");
        this.element.html(this.inner);
    },
    refresh: function() {
        this.base();
        this.inner.html(this.options.html).attr('class',this.options.innerCss);
    },
    _klass: "html thing",
    _type: "html",
    _defaults: {
        html: ""
    },
    _schema: {
       "type":"object",
       "description":"Html properties",
       "properties":{
          "html":{
             "type":"string",
             "required":true
          },
          "css":{
             "type":"string",
             "required":false
          },
          "innerCss":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


var Svg = Thing.extend({
    init: function() {
    },
    refresh: function() {
        this.base();
        this.element.html(this.options.svg);
    },
    _klass: "svg thing",
    _type: "svg",
    _defaults: {
        svg: '<svg xmlns="http://www.w3.org/2000/svg" version="1.1">'
    },
    _schema: {
       "type":"object",
       "description":"Svg properties",
       "properties":{
          "svg":{
             "type":"string",
             "required":true
          },
          "width":{
             "type":"string",
             "required":false
          },
          "height":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


var SvgEditor = Thing.extend({
    change: function(arg) {
        if(typeof arg == 'function') {
            this.onchange = arg;
        } else {
            this.onchange(arg);
        }
    },
    init: function() {
        var self = this;
        self.onchange = $.noop;
        self.frame = $('<iframe src="'+baseUrl+'testing/svgedit">').attr('width',self.options.width).attr('height', self.options.height);
        self.frame.ready(function() {
            // http://code.google.com/p/svg-edit/wiki/TipsAndTricks
            // waiting for real load
            (function(){
                try {
                    var cw = self.frame[0].contentWindow;
                    var md = cw.methodDraw;
                    md.ready(function() {     
                        cw.svgCanvas.setSvgString(self.options.svg);
                    });        
                    md.addExtension("server_opensave", {
                        callback: function() {
                            md.setCustomHandlers({
	                            save: function(win, data) {
		                            self.options.svg = data;
                                    self.onchange(data);
	                            }
                            });
                        }
                    });
                }
                catch (Ex){
                    setTimeout(arguments.callee, 1000);
                }
            })();
        });
        self.frame.appendTo(self.element);
    },
    refresh: function() {
        this.base();
    },
    _klass: "svg-editor thing",
    _type: "svg-editor",
    _defaults: {
        svg: '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100" height="100"></svg>',
        width: "800px",
        height: "600px"
    },
    _schema: {
       "type":"object",
       "description":"SvgEditor properties",
       "properties":{
          "svg":{
             "type":"string",
             "required":true
          },
          "width":{
             "type":"string",
             "required":false
          },
          "height":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


var TextThing = Html.extend({
    refresh: function() {
        this.base();
        var o = this.options;
        if(o['h-align'] && o['h-align'] != 'center') this.inner.addClass(o['h-align']);
        if(o['v-align'] && o['v-align'] != 'center') this.inner.addClass(o['v-align']);
        this.inner.css('font-size', o['font-size']);
        this.inner.css('font-family', o['font-family']);
    },
    _klass: "text-thing html thing",
    _type: "text-thing",
    _defaults: {
        "html": "",
        "css": "",
        "h-align": "center",
        "v-align": "center",
        "font-size": "20px",
        "font-family": "Georgia, serif"
    },
    _schema: {
       "type":"object",
       "properties":{
          "html":{
             "type":"string",
	     "format":"richtext",
             "required":true
          },
          "h-align":{
             "type":"string",
             "enum":["left","center","right"],
             "required":false
          },
          "v-align":{
             "type":"string",
             "enum":["top","center","bottom"],
             "required":false
          },
          "font-size":{
             "type":"string",
             "enum":["50%","60%","75%", "85%", "100%", "120%", "150%", "175%", "200%", "250%"],
             "required":false
          },
          "font-family":{
             "type":"string",
             "enum":[
'Arial,Arial,Helvetica,sans-serif',
'Arial Black,Arial Black,Gadget,sans-serif',
'Comic Sans MS,Comic Sans MS,cursive',
'Courier New,Courier New,Courier,monospace',
'Georgia,Georgia,serif',
'Impact,Charcoal,sans-serif',
'Lucida Console,Monaco,monospace',
'Lucida Sans Unicode,Lucida Grande,sans-serif',
'Palatino Linotype,Book Antiqua,Palatino,serif',
'Tahoma,Geneva,sans-serif',
'Times New Roman,Times,serif',
'Trebuchet MS,Helvetica,sans-serif',
'Verdana,Geneva,sans-serif' 
],
             /*"format":"font",*/
             "required":false
          }
       },
       "additionalProperties":true
    }
});


var Templated = Thing.extend({
    refresh: function() {
        var tmpl = $.templates( "#"+this.options.template+"Template" );
        var html = tmpl.render(this.options);
        this.element.html(html);
        this.element.find("[data-slot]").each(function() { 
            $(this).html(Thing.empty().get()); 
        });
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.find("[data-slot='"+key+"']").html(value.get());
        return this;
    },
    _klass: "templated thing",
    _type: "templated",
    _defaults: {
        template: "demo",
        name: "Myrousz"
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "template": {
			    "type":"string",
			    "required":true
		    },
		    "name": {
			    "type":"string",
			    "required":true
		    }
	    }
    }
});


var Snippet = Thing.extend({
    refresh: function() {
        var o = this.options;
        var code = $("<pre>").text(o.code);
        this.element.html(code);
        SyntaxHighlighter.highlight({title: o.title, 'brush':o.lang}, code.get(0));        
    },
    _klass: "snippet thing",
    _type: "snippet",
    _defaults: {
        "title": "",
        "lang": "js",
        "code": ""
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "title": {
			    "type":"string",
			    "required":false
		    },
		    "lang": {
			    "type":"string",
                "enum":["js","php","plain"],
			    "required":true
		    },
		    "code": {
			    "type":"string",
			    "required":true
		    }
	    }
    }
});


var SoftKeyboard = Thing.extend({
    init: function() {
        this.keys = {};
        this.onkeypress = $.noop;
    },
    refresh: function() {
        var kbd = $("<div>");
        var rows = this.options.rows;
        var cols = this.options.rows;
        for(var key in this.options.keys) {
            var k = this.options.keys[key];
            var kk = this._makeKey(key, k).appendTo(kbd);
            this.keys[key] = kk;
        }
        this.element.html(kbd);
    },
    getKeyButton: function(key) {
        return {"name":key, "button":this.keys[key], "key":this.options.keys[key]};
    },
    _makeKey: function(name, k) {
        var self = this;
        var o = this.options;
        var top = Math.floor(100*k.top/o.rows) + "%";
        var left = Math.floor(100*k.left/o.columns) + "%";
        var ww = k.size || k.width;
        var hh = k.size || k.height;
        var mm = 2;
        var width = Math.floor(100*ww/o.columns) + "%";
        var height = Math.floor(100*hh/o.rows) + "%";
        var div = $("<button>").addClass("key key-"+name).css({'top':top, 'left':left, 'width':width, 'height':height}).append($("<div>").text(k.label));
        div.click(function() {
            if(k['switch']) {
                div.toggleClass("active");
            }
            self.keyPressed(self.getKeyButton(name));
        });
        return div;
    },
    keyPressed: function(kb) {
        if(typeof kb == 'function') {
            this.onkeypress = kb;
        } else {
            this.onkeypress(kb);
        }
    },
    getSwitchState: function(name) {
        if(this.options.keys[name] && this.options.keys[name]['switch']) {
            return this.keys[name].hasClass("active");
        } else {
            return false;
        }
    },    
    _klass: "soft-keyboard thing",
    _type: "soft-keyboard",
    _defaults: {
        "rows": 8,
        "columns": 20,
        "keys": {
            "q" : { "left":0, "top":0, "size":2, "label":"Q"},
            "w" : { "left":2, "top":0, "size":2, "label":"W"},
            "e" : { "left":4, "top":0, "size":2, "label":"E"},
            "r" : { "left":6, "top":0, "size":2, "label":"R"},
            "t" : { "left":8, "top":0, "size":2, "label":"T"},
            "y" : { "left":10, "top":0, "size":2, "label":"Y"},
            "u" : { "left":12, "top":0, "size":2, "label":"U"},
            "i" : { "left":14, "top":0, "size":2, "label":"I"},
            "o" : { "left":16, "top":0, "size":2, "label":"O"},
            "p" : { "left":18, "top":0, "size":2, "label":"P"},
            "a" : { "left":1, "top":2, "size":2, "label":"A"},
            "s" : { "left":3, "top":2, "size":2, "label":"S"},
            "d" : { "left":5, "top":2, "size":2, "label":"D"},
            "f" : { "left":7, "top":2, "size":2, "label":"F"},
            "g" : { "left":9, "top":2, "size":2, "label":"G"},
            "h" : { "left":11, "top":2, "size":2, "label":"H"},
            "j" : { "left":13, "top":2, "size":2, "label":"J"},
            "k" : { "left":15, "top":2, "size":2, "label":"K"},
            "l" : { "left":17, "top":2, "size":2, "label":"L"},
            "caps" : { "left":0, "top":4, "width":3, "height":2, "label":__("caps"), "switch":true},
            "z" : { "left":3, "top":4, "size":2, "label":"Z"},
            "x" : { "left":5, "top":4, "size":2, "label":"X"},
            "c" : { "left":7, "top":4, "size":2, "label":"C"},
            "v" : { "left":9, "top":4, "size":2, "label":"V"},
            "b" : { "left":11, "top":4, "size":2, "label":"B"},
            "n" : { "left":13, "top":4, "size":2, "label":"N"},
            "m" : { "left":15, "top":4, "size":2, "label":"M"},
            "del" : { "left":17, "top":4, "width":3, "height":2, "label":__("del")},
            "nums" : { "left":0, "top":6, "width":4, "height":2, "label":__("?123")},
            "comma" : { "left":4, "top":6, "width":3, "height":2, "label":","},
            "space" : { "left":7, "top":6, "width":6, "height":2, "label":__("space")},
            "dot" : { "left":13, "top":6, "width":3, "height":2, "label":"."},
            "enter" : { "left":16, "top":6, "width":4, "height":2, "label":__("enter")}
        }
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "rows": {
			    "type":"integer",
			    "required":true
		    },
		    "columns": {
			    "type":"integer",
			    "required":true
		    }
	    }
    }
});


var SoftTextEditor = Thing.extend({
    init: function() {
        var self = this;
        this.onchange = $.noop;
        this.keyboard = new SoftKeyboard();
        this.keyboard.keyPressed(function(kb) {
            self._keyPressed(kb);
        });
        this.textfield = $("<textarea>").val(this.options.value).change(function() {
            self.options.value = $(this).val();
        });
        this.buttonOk = $("<button>").addClass('done').text(__("Done")).click(function() {
            self.change(self.textfield.val());
        });
        this.element
            .append($("<div>").addClass("textfield").append(this.textfield))
            .append($("<div>").addClass("btn").append(this.buttonOk))            
            .append(this.keyboard.get());
    },
    refresh: function() {
        this.textfield.val(this.options.value);
    },
    // TODO napojit
    change: function(arg) {
        if(typeof arg == 'function') {
            this.onchange = arg;
        } else {
            this.onchange(arg);
        }
    },
    _keyPressed: function(kb) {
        var cc = kb.name;
        switch(cc) {
            case 'caps': 
                this.capsLock = this.keyboard.getSwitchState('caps');
                break;
            case 'del':
                // delete last character
                this.options.value = this.options.value.slice(0, -1);
                this.refresh();
                break;
            case 'nums': 
                break;
            case 'enter':
                this.options.value += "\n";
                this.refresh();
                break;
            case 'comma':
                this.options.value += ",";
                this.refresh();
                break;
            case 'space':
                this.options.value += " ";
                this.refresh();
                break;
            case 'dot':
                this.options.value += ".";
                this.refresh();
                break;
            default:
                if(this.capsLock) {
                    // invert case...
                    cc = ( cc >= 'A' && cc <= 'Z' ) ? cc.toLowerCase() : cc.toUpperCase();
                }
                this.options.value += cc;
                this.refresh();
        }
    },
    _klass: "soft-text-editor thing",
    _type: "soft-text-editor",
    _defaults: {
        "value": ""
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "value": {
			    "type":"string",
			    "required":true
		    }
	    }
    }
});



var HolidayCalendar = {
    // kdy je velikonocni nedele - bozi hod velikonocni?
    easter: {
        "2012": {month: 4, day: 8},
        "2013": {month: 3, day: 31},
        "2014": {month: 4, day: 20},
        "2015": {month: 4, day: 5}
    },
    data: 
// BEGIN JSON DATA
[
    {
        "month": "Leden",
        "days": [
            {
                "number": "1",
                "names": [
                    "Nový rok"/*,
                    "Den obnovy samostatného českého státu"*/
                ],
                "holiday": true
            },
            {
                "number": "2",
                "names": [
                    "Karina"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Radmila"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Diana"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Dalimil"
                ]
            },
            {
                "number": "6",
                "names": [
                    /*"Kašpar",
                    "Melichar",
                    "Baltazar"*/"Tři králové"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Vilma"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Čestmír"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Vladan"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Břetislav"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Bohdana"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Pravoslav"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Edita"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Radovan"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Alice"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Ctirad"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Drahoslav"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Vladislav"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Sára/Doubravka"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Ilona"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Běla"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Slavomír"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Zdeněk"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Milena"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Miloš"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Zora"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Ingrid"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Otýlie"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Zdislava"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Robin"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Marika"
                ]
            }
        ]
    },
    {
        "month": "Únor",
        "days": [
            {
                "number": "1",
                "names": [
                    "Hynek"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Nela"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Blažej"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Jarmila"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Dobromila"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Vanda"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Veronika"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Milada"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Apolena"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Mojmír"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Božena"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Slavěna"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Věnceslav"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Valentýn"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Jiřina"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Ljuba"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Miloslava"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Gizela"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Patrik"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Oldřich"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Lenka"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Petr"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Svatopluk"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Matěj"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Liliana"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Dorota"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Alexandr"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Lumír"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Horymír"
                ]
            }
        ]
    },
    {
        "month": "Březen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Bedřich"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Anežka"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Kamil"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Stela"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Kazimír"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Miroslav"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Tomáš"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Gabriela"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Františka"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Viktorie"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Anděla"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Řehoř"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Růžena"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Matylda/Rút"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Ida"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Herbert/Elena"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Vlastimil"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Eduard"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Josef"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Světlana"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Radek"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Leona"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Ivona"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Gabriel"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Marian"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Emanuel"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Dita"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Soňa"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Taťána"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Arnošt"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Kvido"
                ]
            }
        ]
    },
    {
        "month": "Duben",
        "days": [
            {
                "number": "1",
                "names": [
                    "Hugo"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Erika"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Richard"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Ivana"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Miroslava"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Vendula"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Hermína/Herman"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Ema"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Dušan"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Darja"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Izabela"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Július"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Aleš"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Vincenc"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Anastázie"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Irena"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Rudolf"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Valérie"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Rostislav"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Marcela"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Alexandra"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Evženie"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Vojtěch"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jiří"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Marek"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Oto"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Jaroslav"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Vlastislav"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Robert"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Blahoslav"
                ]
            }
        ]
    },
    {
        "month": "Květen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Svátek práce"
                ],
                "holiday": true
            },
            {
                "number": "2",
                "names": [
                    "Zikmund"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Alexej"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Květoslav"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Klaudie"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Radoslav"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Stanislav"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Den vítězství"
                ],
                "holiday": true
            },
            {
                "number": "9",
                "names": [
                    "Ctibor"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Blažena"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Svatava"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Pankrác"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Servác"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Bonifác"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Žofie"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Přemysl"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Aneta"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Nataša"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Ivo"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Zbyšek"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Monika"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Emil"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Vladimír"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jana"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Viola"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Filip"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Valdemar"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Vilém"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Maxmilián"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Ferdinand"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Kamila"
                ]
            }
        ]
    },
    {
        "month": "Červen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Laura"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Jarmil"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Tamara"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Dalibor"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Dobroslav"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Norbert"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Iveta"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Medard"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Stanislava"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Gita"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Bruno"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Antonie"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Antonín"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Roland"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Vít"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Zbyněk"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Adolf"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Milan"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Leoš"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Květa"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Alois"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Pavla"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Zdeňka"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jan"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Ivan"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Adriana"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Ladislav"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Lubomír"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Petr a Pavel"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Šárka"
                ]
            }
        ]
    },
    {
        "month": "Červenec",
        "days": [
            {
                "number": "1",
                "names": [
                    "Jaroslava"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Patricie"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Radomír"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Prokop"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Cyril a Metoděj"
                ],
                "holiday": true
            },
            {
                "number": "6",
                "names": [
                    /*"Den upálení Mistra Jana Husa"*/"Jan Hus"
                ],
                "holiday": true
            },
            {
                "number": "7",
                "names": [
                    "Bohuslava"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Nora"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Drahoslava"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Libuše/Amálie"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Olga"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Bořek"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Markéta"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Karolína"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Jindřich"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Luboš"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Martina"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Drahomíra"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Čeněk"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Ilja/Eliáš"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Vítězslav"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Magdalena"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Libor"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Kristýna"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Jakub"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Anna"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Věroslav"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Viktor"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Marta"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Bořivoj"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Ignác"
                ]
            }
        ]
    },
    {
        "month": "Srpen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Oskar"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Gustav"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Miluše"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Dominik"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Kristián"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Oldřiška"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Lada"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Soběslav"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Roman"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Vavřinec"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Zuzana"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Klára"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Alena"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Alan"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Hana"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Jáchym"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Petra"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Helena"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Ludvík"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Bernard"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Johana"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Bohuslav"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Sandra"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Bartoloměj"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Radim"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Luděk"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Otakar"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Augustýn"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Evelína"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Vladěna"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Pavlína"
                ]
            }
        ]
    },
    {
        "month": "Září",
        "days": [
            {
                "number": "1",
                "names": [
                    "Linda/Samuel"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Adéla"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Bronislav"
                    /* /Bronislava"*/
                ]
            },
            {
                "number": "4",
                "names": [
                    "Jindřiška"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Boris"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Boleslav"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Regina"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Mariana"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Daniela"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Irma"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Denisa"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Marie"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Lubor"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Radka"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Jolana"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Ludmila"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Naděžda"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Kryštof"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Zita"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Oleg"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Matouš"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Darina"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Berta"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jaromír"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Zlata"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Andrea"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Jonáš"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Václav"/*,
                    "Den české státnosti"*/
                ],
                "holiday": true
            },
            {
                "number": "29",
                "names": [
                    "Michal"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Jeroným"
                ]
            }
        ]
    },
    {
        "month": "Říjen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Igor"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Olivie/Oliver"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Bohumil"
                ]
            },
            {
                "number": "4",
                "names": [
                    "František"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Eliška"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Hanuš"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Justýna"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Věra"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Štefan/Sára"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Marina"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Andrej"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Marcel"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Renáta"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Agáta"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Tereza"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Havel"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Hedvika"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Lukáš"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Michaela"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Vendelín"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Brigita"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Sabina"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Teodor"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Nina"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Beáta"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Erik"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Šarlota/Zoe"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Státní svátek"/*,
                    "Den vzniku samostatného československého státu"*/
                ],
                "holiday": true
            },
            {
                "number": "29",
                "names": [
                    "Silvie"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Tadeáš"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Štěpánka"
                ]
            }
        ]
    },
    {
        "month": "Listopad",
        "days": [
            {
                "number": "1",
                "names": [
                    "Felix"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Památka zesnulých"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Hubert"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Karel"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Miriam"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Liběna"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Saskie"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Bohumír"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Bohdan"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Evžen"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Martin"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Benedikt"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Tibor"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Sáva"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Leopold"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Otmar"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Mahulena"/*,
                    "Den boje za svobodu a demokracii"*/
                ],
                "holiday": true
            },
            {
                "number": "18",
                "names": [
                    "Romana"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Alžběta"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Nikola"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Albert"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Cecílie"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Klement"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Emílie"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Kateřina"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Artur"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Xenie"
                ]
            },
            {
                "number": "28",
                "names": [
                    "René"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Zina"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Ondřej"
                ]
            }
        ]
    },
    {
        "month": "Prosinec",
        "days": [
            {
                "number": "1",
                "names": [
                    "Iva"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Blanka"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Svatoslav"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Barbora"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Jitka"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Mikuláš"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Ambrož/Benjamín"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Květoslava"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Vratislav"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Julie"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Dana"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Simona"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Lucie"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Lydie"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Radana"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Albína"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Daniel"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Miloslav"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Ester"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Dagmar"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Natálie"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Šimon"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Vlasta"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Adam a Eva"/*,
                    "Štědrý den"*/
                ],
                "holiday": true
            },
            {
                "number": "25",
                "names": [
                    "Boží hod vánoční"
                ],
                "holiday": true
            },
            {
                "number": "26",
                "names": [
                    "Štěpán"/*,
                    "Druhý svátek vánoční"*/
                ],
                "holiday": true
            },
            {
                "number": "27",
                "names": [
                    "Žaneta"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Bohumila"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Judita"
                ]
            },
            {
                "number": "30",
                "names": [
                    "David"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Silvestr"
                ]
            }
        ]
    }
]
// END JSON DATA
};

var Calendar = RaphaelThing.extend({
    /* canvas size: 1000x1000 */
    refresh: function() { 
        this.base();   
        var d = this.options;
        this.paper = this.canvas;
        this.paper.clear();
        this.lineAttr = { "fill": "none", "stroke": d.lineColor};
        this.monthNameAttr = { "stroke": "none", "fill": d.fontColor, "font-family":d.fontFamily, "font-size":d.titleFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.monthCapAttr = { "fill": d.fontColor, "stroke": "none", "font-family":d.fontFamily, "font-size":d.dayCapFontSize, "font-style":d.fontStyle};
        this.dayNumAttr = { "stroke": "none", "fill":d.fontColor, "font-family":d.fontFamily, "font-weight":"bold", "font-size":d.numbersFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.dayNameAttr = { "stroke": "none", "fill": d.fontColor, "font-family":d.fontFamily, "font-size":d.namesFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.dayNumAttrHigh = { "stroke": "none", "fill": d.fontColorHigh, "font-family":d.fontFamily, "font-weight":"bold", "font-size":d.numbersFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.dayNameAttrHigh = { "stroke": "none", "fill": d.fontColorHigh, "font-family":d.fontFamily, "font-size":d.namesFontSize, "font-style":d.fontStyle, "text-anchor":"end"};

        this.monthCapOffset = 12;
        this.boxWidth = 142;
        this.boxHeight = 142;
        this.drawMonth(d.year, d.month);
        // HACK: https://github.com/DmitryBaranovskiy/raphael/issues/491
        this.element.find("tspan").attr("dy", 0);
    },

    drawMonthGrid: function(rows, x, y) {
        // draws grid 7x5 with day captions
        for(var i=0; i<=7; i++) {
            // draw captions
            // draw vertical lines
            var xx = x + i*this.boxWidth;
            var str = "M"+xx+","+y+"l0,"+rows*this.boxHeight;
            this.paper.path(str).attr(this.lineAttr); 
            if(i<7) this.paper.text(xx+this.boxWidth/2, y-this.monthCapOffset, this.locale[this.currentLocale].daysOfWeek[i]).attr(this.monthCapAttr);
        }
        for(var j=0; j<=rows; j++) {
            // draw horizontal lines
            var yy = y + j*this.boxHeight;
            var str = "M"+x+","+yy+"l"+7*this.boxWidth+",0";
            this.paper.path(str).attr(this.lineAttr);            
        }                    
    },

    drawDayBox: function(row, column, year, month, day, x, y) {
        // is day sunday?
        var sunday = this.getDayOfWeek(year, month, day) == 0;
        // is day holiday?
        var holiday = HolidayCalendar.data[month-1].days[day-1].holiday;

        var xx = x + (column+1)*this.boxWidth - 5;
        // print number...
        var yy = y + (row+1-0.45)*this.boxHeight - 5;
        this.paper.text(xx, yy, day).attr((sunday || holiday) ? this.dayNumAttrHigh : this.dayNumAttr);
        // print name
        var yy = y + (row+1-0.1)*this.boxHeight - 5;
        this.paper.text(xx, yy, HolidayCalendar.data[month-1].days[day-1].names[0]).attr(holiday ? this.dayNameAttrHigh : this.dayNameAttr);
    },

    drawMonth: function(year, month) {
        var x = 0;
        var column = this.getDayOfWeek(year, month, 1);
        // nedele = 0! pondeli 1...
        column = (column==0) ? 6 : column-1;
        // how many total rows?
        lastColumn = column+HolidayCalendar.data[month-1].days.length;
        var totalRows = Math.floor((lastColumn+6)/7);
        var y = 7*this.boxHeight - totalRows*this.boxHeight;
        // draw month name
        var mn = this.locale[this.currentLocale].months[month-1] + " "+year;
        this.drawMonthGrid(totalRows, x, y);
        this.paper.text(x+7*this.boxWidth, y-0.7*this.boxHeight, mn).attr(this.monthNameAttr);
        var row = 0;
        for(var i=0; i<HolidayCalendar.data[month-1].days.length; i++) {
            this.drawDayBox(row, column, year, month, i+1, x, y);
            column++;
            if(column == 7) {
                column = 0;
                row++;
            }
        }

    },
    locale: {
        "en": {
            "months": [
                "January","February","March","April","May","June","July","August","September","October","November","December"
            ],
            "daysOfWeek": [
                "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"
            ]
        },
        "cz": {
            "months": [
                "Leden","Únor","Březen","Duben","Květen","Červen","Červenec","Srpen","Září","Říjen","Listopad","Prosinec"
            ],
            "daysOfWeek": [
                "Pondělí", "Úterý", "Středa", "Čtvrtek", "Pátek", "Sobota", "Neděle"
            ]
        }
    },
    currentLocale: 'cz',
    getDayOfWeek: function(year, month, day) {
        var d = new Date(year, month-1, day, 0, 0, 0, 0);
        return d.getDay();
    },
    isLeapYear: function(yr) {
        return new Date(yr,2-1,29).getDate()==29;
    },

    _klass: "calendar raphael-thing thing",
    _type: "calendar",
    _defaults: {
        width: 1000,
        height: 1000,
        year: 2012,
        month: 12,
        fontFamily: "Arial", 
        fontStyle: "italic", 
        lineColor: "black",
        fontColor: "black",
        fontColorHigh: "red",
        titleFontSize: "40",
        dayCapFontSize: "20",
        numbersFontSize: "60",
        namesFontSize: "16"
    },
    _schema: {
       "type":"object",
       "description":"Calendar properties",
       "properties":{
          "year":{
             "type":"string",
             "enum":["2012", "2013","2014","2015"],
             "required":true
          },
          "month":{
             "type":"string",
             "enum":["1", "2","3","4","5","6","7","8","9","10","11","12"],
             "required":true
          },
            // .....
          "titleFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "dayCapFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "numbersFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "namesFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "fontFamily":{
             "type":"string",
             "enum":["Georgia, serif","Arial, Helvetica, sans-serif","Impact, Charcoal, sans-serif", "Tahoma, Geneva, sans-serif", "Verdana, Geneva, sans-serif", "Monaco, monospace"],
             "required":true
          },
          "fontStyle":{
             "type":"string",
             "enum":["regular","italic","monospace"],
             "required":true
          }
       },
       "additionalProperties":true
    }
});



// TODO kdyz zmenim parametry hodin a ulozim, nepromitne se to do inputu

var Clock = RaphaelThing.extend({
    refresh: function() {
        this.base();
        var 
            o = this.options,
            size = o.size,
            canvas = this.canvas,
            clock = canvas.circle(size*.5,size*.5, size * .475);
        clock.attr({"fill":o.fillColor,"stroke":o.strokeColor,"stroke-width":(size*.025)})
        var hour_sign;
        for(i=0;i<12;i++){
            var start_x = size*.5+Math.round((size*.4)*Math.cos(30*i*Math.PI/180));
            var start_y = size*.5+Math.round((size*.4)*Math.sin(30*i*Math.PI/180));
            var end_x = size*.5+Math.round((size*.45)*Math.cos(30*i*Math.PI/180));
            var end_y = size*.5+Math.round((size*.45)*Math.sin(30*i*Math.PI/180));
            hour_sign = canvas.path("M"+start_x+" "+start_y+"L"+end_x+" "+end_y);
        }
        this.hour_hand = canvas.path("M" + size*.5 + " " + size*.5 + "L" + size*.5 + " " + (size*.25) + "");
        this.hour_hand.attr({stroke: o.hourHandColor, "stroke-width": size*.03});
        this.minute_hand = canvas.path("M" + size*.5 + " " + size*.5 + "L" + size*.5 + " " + (size*.2) + "");
        this.minute_hand.attr({stroke: o.minuteHandColor, "stroke-width": size*.02});
        this.second_hand = canvas.path("M" + size*.5 + " " + (size*.55) + "L" + size*.5 + " " + (size*.125) + "");
        this.second_hand.attr({stroke: o.secondHandColor, "stroke-width": size*.01});
        var pin = canvas.circle(size*.5, size*.5, size*.025);
        pin.attr("fill", o.pinColor);

        var self = this;
        var updater = function() {
            self.update();
        };
        updater();
        setInterval(updater,1000); 
    },
    update: function() {
        var self = this,
            size = this.options.size,
            now = new Date(),
            hours = now.getHours(),
            minutes = now.getMinutes(),
            seconds = now.getSeconds(),
            cc = ","+(size*.5)+","+(size*.5);
        self.hour_hand.transform('r'+(30*hours+(minutes/2.5))+cc);
        self.minute_hand.transform('r'+(6*minutes)+cc);
        self.second_hand.transform('r'+(6*seconds)+cc);
    },
    _klass: "clock raphael-thing thing",
    _type: "clock",
    _defaults: {
        width: 100,
        height: 100,
        size: 100,
        fillColor: "white", 
        strokeColor: "black", 
        pinColor: "gray",
        hourHandColor:"black", 
        minuteHandColor:"black",
        secondHandColor:"black"
    },
    _schema: {
       "type":"object",
       "description":"Clock properties",
       "properties":{
          "size":{
             "type":"integer",
             "required":true
          },
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          },
          "fillColor":{
             "type":"string",
             "format": "color",
             "required":true
          },
          "strokeColor": { "type": "string", "required": true, "format": "color" },
          "pinColor": { "type": "string", "required": true, "format": "color" },
          "hourHandColor": { "type": "string", "required": true, "format": "color" },
          "minuteHandColor": { "type": "string", "required": true, "format": "color" },
          "secondHandColor": { "type": "string", "required": true, "format": "color" }
       },
       "additionalProperties":true
    }
});


var Modal = Thing.extend({
    init: function() {
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.html($("<p>").html(value.get()));
        this.refresh();
        return this;
    },
    _fullOpts: function() {
      return $.extend({modal: true}, this.options)
    },
    show: function() {
        var self = this;
	    $(self.element).dialog(this._fullOpts());
	    $(self.element).dialog('open');
    },
    close: function() {
	    $(this.element).dialog('close');
    },
    refresh: function() {
    	$(this.element).dialog(this._fullOpts());
    },
    _klass: "modal thing",
    _type: "modal",
    _defaults: {
        autoOpen: false,
        minHeight: 608, // 560,  
        minWidth: 760, //740
        title: 'Dialog',
        closeOnEscape: true
    },
    _schema: {
       "type":"object",
       "properties":{
          "title": {
             "type": "string",
             "required": false
          },
          "autoOpen":{
             "type":"boolean",
             "required":true
          },
          "minHeight":{
             "type":"string",
             "required":true
          },
          "minWidth":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }

}, {
    show: function(thing, opts) {
        var modal = new Modal(opts);
        modal.content('content',thing);
        modal.show();
        return modal;
    }
});


var Dummy = Html.extend({
    refresh: function() {
        this.base();
        this.element.css('width', this.options['width']);
        this.element.css('height',this.options['height']);
        this.element.css('color',this.options['color']);
        this.element.css('background-color',this.options['background-color']);
    },
    _klass: "dummy html thing",
    _type: "dummy",
    _defaults: {
        html: "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla sed dolor nisl, in suscipit justo. Donec a enim et est porttitor semper at vitae augue. Proin at nulla at dui mattis mattis. Nam a volutpat ante. Aliquam consequat dui eu sem convallis ullamcorper. Nulla suscipit, massa vitae suscipit ornare, tellus est consequat nunc, quis blandit elit odio eu arcu. Nam a urna nec nisl varius sodales. Mauris iaculis tincidunt orci id commodo. Aliquam non magna quis tortor malesuada aliquam eget ut lacus. Nam ut vestibulum est. Praesent volutpat tellus in eros dapibus elementum. Nam laoreet risus non nulla mollis ac luctus felis dapibus. Pellentesque mattis elementum augue non sollicitudin. Nullam lobortis fermentum elit ac mollis. Nam ac varius risus. Cras faucibus euismod nulla, ac auctor diam rutrum sit amet. Nulla vel odio erat, ac mattis enim.",
        'width': "",
        'height': '',
        'color': '',
        'background-color': ''
    },
    _schema: {
       "type":"object",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "height":{
             "type":"string",
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          },
          "background-color":{
             "type":"string",
             "format": "color",
             "required":true
          }
       },
       "additionalProperties":true
    }
});

// decorator = thing with a single slot named 'content'

// TODO podedit toto vsechno od 'Decorator'
// kvuli reverzibilite dekoratoru by bylo dobre kdyby kazdy menil css properties 'wrapper' divu
var Decorator = Thing.extend({
    init: function() {
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.html(value.get());
        return this;
    },
    unwrap: function() {
        this.replaceWith(this.getSlot('content'));
    },
    _klass: "decorator thing",
    _type: "decorator"
});


















var Clickable = Thing.extend({
    init: function() {
        this.pane = $("<div>").addClass("clickable-pane");
        this.setSlot('content', Thing.empty());
        this.click($.noop);
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.empty()
            .append(value.get())
            .append(this.pane);
        return this;
    },
    refresh: function() {
      this.base();
      this.pane.attr('title', this.options.tooltip);
    },
    click: function(arg) {
        if(arg) {
            this.onclick = arg;
            this.pane.click(this.onclick);
        } else {
            return this.onclick();
        }
    },
    _klass: "clickable thing",
    _type: "clickable",
    _defaults: {
      "tooltip": ""
    }
});


var Editable = Thing.extend({
    init: function() {
        this.onchanged = $.noop;
        this.editor = $("<div>").addClass("editable-editor");
        this.pane = $("<div>").addClass("editable-pane");
        this.element.append(this.pane).append(this.editor);
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        var self = this;
        var schema = value._schema;
        this.editor.empty();
        if(!schema) {
            // pouzit radsi json editor
        } else {
            this.editor.jsonform({schema: value._schema, value: value.options, name: __("Properties")+" - "+value._type});
            this.editor.jsonform('change', function() {
                self._save(true);
            });
            this.editor.jsonform('save', function() {
                self._save();
            });
        }
        this.pane.html(value.get());
        return this;
    },
    _save: function(stay) {
        var self = this;
        // value changed in editor...
        var newVal = self.editor.jsonform('value');
        self.getSlot('content').setOptions(newVal);
        if(!stay) self.onchanged(newVal);
    },
    _klass: "editable thing",
    _type: "editable",
    _defaults: {}
}, {
    edit: function(thing, changed) {
        var edt = new Editable();
        edt.setSlot('content', thing.copy());
        var modal = Modal.show(edt, {height: 630, minHeight: 630, width: 840, minWidth: 840, resizable: false, draggable: true, title:__('Properties')});
        edt.onchanged = function(newVal) {
            modal.close();
            if(changed) changed(newVal);
        };
    }
});



var ToolbarDecorator = Thing.extend({
    init: function() {
        this._content = $("<div>")
            .addClass("mykkro-toolbar-decorator-content")
            .appendTo(this.element);
        this.setSlot('content', Thing.empty());
    },
    refresh: function() {
	    this.base();
        if(this.options.hidden) {
            this.element.toolbar({tools:{}});
        } else {
            this.element.toolbar({tools:this.options.tools});
        }
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this._content.html(value.get());
        return this;
    },
    showToolbar: function() {
        this.options.hidden = false;
        this.refresh();
    },
    hideToolbar: function() {
        this.options.hidden = true;
        this.refresh();
    },
    serialize: function() {
        // toolbar decorator se nebude serializovat (aspon automaticky ne)
        return this.getSlot('content').serialize();
    },
    getTree: function() {
        // skip the outer layer...
        return this.getSlot('content').getTree();
    },
    getTreeView: function(decorator) {
        // skip the outer layer...
        return this.getSlot('content').getTreeView(decorator);
    },
    _klass: "toolbar-decorator thing",
    _type: "toolbar-decorator",
    _defaults: {
        tools: {}
    } 
});


var ContextmenuDecorator = Thing.extend({
    init: function() {
        this._content = $("<div>")
            .addClass("mykkro-contextmenu-decorator-content")
            .appendTo(this.element);
        this.setSlot('content', Thing.empty());
    },
    refresh: function() {
	    this.base();
        if(this.options.hidden) {
            this.element.toolbar({tools:{}});
        } else {
            this.element.toolbar({tools:this.options.tools});
        }
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this._content.html(value.get());
        return this;
    },
    showToolbar: function() {
        this.options.hidden = false;
        this.refresh();
    },
    hideToolbar: function() {
        this.options.hidden = true;
        this.refresh();
    },
    serialize: function() {
        // toolbar decorator se nebude serializovat (aspon automaticky ne)
        return this.getSlot('content').serialize();
    },
    getTree: function() {
        // skip the outer layer...
        return this.getSlot('content').getTree();
    },
    getTreeView: function(decorator) {
        // skip the outer layer...
        return this.getSlot('content').getTreeView(decorator);
    },
    _klass: "contextmenu-decorator thing",
    _type: "contextmenu-decorator",
    _defaults: {
        tools: {}
    } 
});


var Page = Decorator.extend({
    // options changed...
    refresh: function() {
        this.element.css({
          'width': this.options['width'],
          'height': this.options['height'],
          'background-size': 'cover',
          'background-image': 'url('+this.options['background_url']+')'
        })
    },
    _klass: "page decorator thing",
    _type: "page",
    _defaults: {
        'width': '500px',
        'height': '700px',
        'background_url': ''
    },
    _schema: {
       "type":"object",
       "description":"Page properties",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "height":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var Preview = Decorator.extend({
    // options changed...
    refresh: function() {
        this.element.css('width',this.options['width']);
        this.element.css('height',this.options['height']);
    },
    _klass: "preview decorator thing",
    _type: "preview",
    _defaults: {
        'width': '80px',
        'height': '110px',
        'label': 'preview',
        'description': ''
    },
    _schema: {
       "type":"object",
       "description":"Clock properties",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "height":{
             "type":"string",
             "required":true
          },
          "label":{
             "type":"string",
             "required":false
          },
          "description":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }
});


var OpacityDecorator = Decorator.extend({
    refresh: function() {
      this.base();
      this.element.css('opacity',this.options.opacity);
    },
    _klass: "opacity-decorator decorator thing",
    _type: "opacity-decorator",
    _defaults: {
        opacity: 0.8
    },
    _schema: {
       "type":"object",
       "description":"Clock properties",
       "properties":{
          "opacity":{
             "type":"number",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var InsetDecorator = Decorator.extend({
    refresh: function() {
	this.base();
        this.element.css('padding',this.options.top+'% '+this.options.right+"% "+this.options.bottom+"% "+this.options.left+"%");
    },
    _klass: "inset-decorator decorator thing",
    _type: "inset-decorator",
    _defaults: {
        top: 2,
        left: 2,
        right: 2,
        bottom: 2
    },
    _schema: {
	"type":"object",
	"$schema": "http://json-schema.org/draft-03/schema",
	"properties":{
		"bottom": {
			"type":"number",
			"id": "bottom",
			"required":true
		},
		"left": {
			"type":"number",
			"id": "left",
			"required":true
		},
		"right": {
			"type":"number",
			"id": "right",
			"required":true
		},
		"top": {
			"type":"number",
			"id": "top",
			"required":true
		}
	},
       "additionalProperties":true
    }

});



var ShadowDecorator = Decorator.extend({
    // options changed...
    refresh: function() {
	this.base();
        var br = this.options['h-shadow']+" "+this.options['v-shadow']+" "+this.options.blur+" "+this.options.spread+" "+this.options.color;
        this.element.css('box-shadow',br);
        this.element.css('-webkit-box-shadow',br);
    },
    _klass: "shadow-decorator decorator thing",
    _type: "shadow-decorator",
    _defaults: {
        'h-shadow': "5px",
        'v-shadow': "5px",
        blur: "5px",
        spread: "5px",
        color: "#666"
    },
    _schema: {
       "type":"object",
       "properties":{
          "h-shadow":{
             "type":"string",
             "required":true
          },
          "v-shadow":{
             "type":"string",
             "required":true
          },
          "blur":{
             "type":"string",
             "required":true
          },
          "spread":{
             "type":"string",
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          }
       },
       "additionalProperties":true
    }
});





var BackgroundDecorator = Decorator.extend({
    // options changed...
    refresh: function() {
        this.base();
        if(this.options['image']) 
            this.element.css('background-image','url("'+this.options['image']+'")');
        else 
            this.element.css('background-image','');
        this.element.css('background-position',this.options['position']);
        this.element.css('background-repeat',this.options['repeat']);
        this.element.css('background-color',this.options['color']);
        this.element.css('background-size',this.options['size']);
    },
    _klass: "background-decorator decorator thing",
    _type: "background-decorator",
    _defaults: {
        'image': "",
        'repeat': 'no-repeat',
        'position': 'center center',
        'color': 'white',
        'size': 'cover'
    },
    _schema: {
       "type":"object",
       "properties":{
          "image":{
             "type":"string",
             "format": "my-image-uri",
            // TODO vadi mu kdyz je to false - option se neda rozkliknout
             "required":true
          },
          "repeat":{
             "enum": ["repeat","no-repeat","repeat-x","repeat-y"],
             "type":"string",
             "required":true // TODO
          },
          "position":{
             "type":"string",
             "required":true // TODO
          },
          "size":{
             "type":"string",
             "enum": ["cover","contain"],
             "required":true // TODO
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true // TODO
          }
       },
       "additionalProperties":true
    }
});



// TODO sloucit nejak s rounded decoratorem
var BorderDecorator = Decorator.extend({
    // options changed...
    refresh: function() {
        this.base();
        this.element.css('border-width', this.options['width']);
        this.element.css('border-style',this.options['style']);
        this.element.css('border-color',this.options['color']);
    },
    _klass: "border-decorator decorator thing",
    _type: "border-decorator",
    _defaults: {
        'width': "1px",
        'style': 'solid',
        'color': 'black'
    },
    _schema: {
       "type":"object",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "style":{
             "type":"string",
             "enum": ["none","solid","dotted","dashed","double","groove","ridge","inset","outset"],
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var RoundedDecorator = BorderDecorator.extend({
    refresh: function() {
        this.base();
        var br = this.options.radius;
        // TODO individualne vsechny 4 rohy
        this.element.css('border-radius',br);
        this.element.css('-webkit-border-radius',br);
        this.element.css('-moz-border-radius',br);
    },
    _klass: "rounded-decorator decorator thing",
    _type: "rounded-decorator",
    _defaults: {
        'width': "1px",
        'style': 'solid',
        'color': 'black',
        radius: "5%"
    },
    _schema: {
       "type":"object",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "style":{
             "type":"string",
             "enum": ["none","solid","dotted","dashed","double","groove","ridge","inset","outset"],
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          },
          "radius":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }
});



var PageDecorator = Thing.extend({
    init: function() {
        this.base();
        this.pageContent = $("<div>").addClass("page-content").appendTo(this.element);
        this.pageInfo = $("<div>").addClass('page-info').appendTo(this.element);
        this.setSlot('content', Thing.empty());
    },
    // options changed...
    refresh: function() {
        // TODO text mask?
        this.base();
        if(this.options.showInfo) this.pageInfo.show(); else this.pageInfo.hide();
        this.pageInfo.text("Page "+this.options.pageNumber);
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.pageContent.html(value.get());
        return this;
    },
    _klass: "page-decorator thing",
    _type: "page-decorator",
    _defaults: {
        'showInfo' : false,
        'pageNumber': 2,
        'pagesTotal' : 3,
        'recordsTotal' : 10
    },
    _schema: {
       "type":"object",
       "properties":{
          "showInfo":{
             "type":"boolean",
             "required":true
          },
          "pageNumber":{
             "type":"integer",
             "required":true
          },
          "pagesTotal":{
             "type":"integer",
             "required":true
          },
          "recordsTotal":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var CenteringDecorator = Thing.extend({
    init: function() {
        this.inner = $("<div>").addClass('content-inner').appendTo(
            $("<div>").addClass('center3').appendTo(
                $("<div>").addClass('center2').appendTo(
                    this.element
                )
            )
        );
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.inner.html(value.get());
        return this;
    },
    // options changed...
    refresh: function() {
        this.base();
        this.element.css('text-align',this.options['x-align']);
        this.element.children(".center2").css('vertical-align',this.options['y-align']);
        this.inner.css('width',this.options['content-width']);
        this.inner.css('height',this.options['content-height']);
    },
    _klass: "centering-decorator decorator thing",
    _type: "centering-decorator",
    _defaults: {
        'x-align': "center",
        'y-align': 'center',
        'content-width': '',
        'content-height': ''
    },
    _schema: {
       "type":"object",
       "properties":{
          "x-align":{
             "enum": ["left","center","right"],
             "type":"string",
             "required":true // TODO
          },
          "y-align":{
             "enum": ["top","middle","bottom"],
             "type":"string",
             "required":true // TODO
          },
          "content-width":{
             "type":"string",
             "required":true // TODO
          },
          "content-height":{
             "type":"string",
             "required":true // TODO
          }
       },
       "additionalProperties":true
    }
});



var Ajax = Decorator.extend({
    init: function() {
        this.loaded($.noop);
        this.received(function(data) { return data; });
        this.transform(function(data) { return Thing.create(data); })
        this.base();
        this.reload();
    },
    reload: function() {
        var url = this.options.url;
        var self = this;
        if(url) {
            $.ajax({
              url: url,
              dataType: 'json',
              //data: data,
              success: function(data) {
                var thing = self.transform(self.received(data));
                self.setSlot('content', thing);
                self.loaded(thing);
              },
              error: function(jqXHR, textStatus, errorThrown) {
                // TODO dat tam misto toho chyb. panel
                alert("AJAX failed! "+textStatus);
              }
            });
        }
        if(this.options.reloadInterval) {
            var fun = function() { self.reload(); };
            setTimeout(fun, 1000*this.options.reloadInterval);
        }
    },
    loaded: function(arg) {
        if(typeof arg == 'function') {
            this.onloaded = arg;
        } else {
            return this.onloaded(arg);
        }
    },
    received: function(arg) {
        if(typeof arg == 'function') {
            this.onreceive = arg;
        } else {
            return this.onreceive(arg);
        }
    },
    transform: function(arg) {
        if(typeof arg == 'function') {
            this.ontransform = arg;
        } else {
            return this.ontransform(arg);
        }
    },
    _klass: "ajax thing",
    _type: "ajax",
    _defaults: {
        url: '', //"testing/thing.json",
        reloadInterval: 0 //60 // in seconds
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "reloadInterval": {
			    "type":"integer",
			    "required":true
		    },
		    "url": {
			    "type":"string",
			    "id": "url",
                "format": "uri",
			    "required":true
		    }
	    }
    }
});




var AjaxPager = Thing.extend({
    init: function() {
        var self = this;
        this.base();
        this.page = new Ajax();
        this.page.received(function(data) { return self._dataReceived(data);});
        this.page.transform(function(data) { return self._dataTransform(data);});
        this.page.loaded(function(ajax) {self._pageLoaded(ajax);});
        this.page.get().appendTo(this.element);
        this.createControls();
        this.setPage(this.options.page);
    },
    createControls: function() {
        this.pagerControls = $("<div>").addClass('pager-controls');
        if(!this.options.disablePagerControl) this.pagerControls.appendTo(this.element);
    },
    refreshView: function() {
        this.setPage(this.options.page);
    },
    setPage: function(num) {
        this.options.page = num;
        var url = null;
        if(this.options.page && this.options.baseUrl) {
            url = this.getPageUrl(this.options.page);
            this.page.options.url = url;
            this.page.reload();
        } else {
            // signal error
        }
    },
    getPageUrl: function(page) {
        return this.options.baseUrl + page + ".json";
    },
    // muzeme podedit pokud potrebujeme jine chovani, transformaci dat aj.
    _dataReceived: function(data) {
        return data;
    },
    _dataTransform: function(data) {
        return Thing.create(data);
    },
    _pageLoaded: function(ajax) {
        this.pagerControls.empty();
        if(ajax instanceof PageDecorator) {
            // rebuild page controls
            this._buildPageControls(ajax);
        }
    },
    _buildPageControls: function(paged) {
        // TODO udelat PagerControls jako Thing
        // stranky jsou cislovany od jedne, nejmensi cislo je 1
        var o = paged.options;
        if(o.pageNumber>1) {
            // add first link
            this.pagerControls.append(this._makePageLink(1, "first"));
        }
        if(o.pageNumber>1) {
            // add previous link
            this.pagerControls.append(this._makePageLink(o.pageNumber-1, "previous"));
        }
        this.pagerControls
            .append($("<span>").text(__("Page")+" "+o.pageNumber+" "+__("from")+" "+o.pagesTotal));        
        if(o.pageNumber<o.pagesTotal) {
            // add previous link
            this.pagerControls.append(this._makePageLink(o.pageNumber+1, "next"));
        }
        if(o.pageNumber<o.pagesTotal) {
            // add first link
            this.pagerControls.append(this._makePageLink(o.pagesTotal, "last"));
        }
    },
    _makePageLink: function(pageno, type) {
        var self = this;
        return $('<a href="#">').text(type).click(function() {
            self.setPage(pageno);
            return false;
        });
    },
    _klass: "ajax-pager thing",
    _type: "ajax-pager",
    _defaults: {
        baseUrl: '',// 'testing/multi/',
        page: 1,
        disablePagerControl: false
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "page": {
			    "type":"integer",
			    "required":true
		    },
		    "url": {
			    "type":"string",
			    "id": "url",
                "format": "uri",
			    "required":true
		    }
	    }
    }
});


var Layout = Thing.extend({
    _klass: "layout thing",
    _type: "layout"
});









var Slot = Base.extend({
    constructor: function(parent, name) {
        this.name = name;
        this.parent = parent;
        this.element = $("<div>").addClass("mykkro-slot").attr('data-name', name);
        this.thing = null;
    },
    empty: function() {
        this.element.empty();
        this.thing = null;
    },
    set: function(thing) {
        this.element.empty().append(thing.get());
        this.thing = thing;
    },
    get: function() {
        return this.thing;
    }
});


// TODO metody na prohazovani elementu - move to front/back, move up, move down
// TODO metody insert/delete?
// TODO -> DynamicLayout
var GrowableLayout = Layout.extend({
    init: function() {
        this.cells = []; // v tomto poradi budou v this.element!
        this.cellMap = {}; 
    },
    // remove all slots
    // TODO obsolete, use removeSlots instead
    clear: function() {
        this.element.empty();
        this.cells = [];
        this.cellMap = {};
    },
    length: function() {
        return this.cells.length;
    },
    first: function() {
        return this.cells.length ? this.cells[0] : undefined;
    },
    last: function() {
        return this.cells.length ? this.cells[this.cells.length-1] : undefined;
    },
    nth: function(ndx) {
        return (ndx>=0 && ndx<this.cells.length) ? this.cells[ndx] : undefined;
    },
    isEmpty: function() {
        return this.cells.length;
    },
    // dynamically add slot
    add: function(thing) {        
        var ndx = this.cells.length;
        var slot = new Slot(this, ndx);
        slot.element.appendTo(this.element);
        this.cells.push(slot);
        this.cellMap[ndx] = slot;
        this.setSlot(ndx, thing);
        return slot;
    },
    setSlot: function(key, value) {
        // TODO implement hasSlot
        this.base(key, value);
        this.cellMap[key].set(value);
        return this;
    },
    removeSlots: function() {
        // remove slot content...
        this.clearSlots(); 
        // remove slots proper...
        this.element.empty();
        this.slots = {};
        this.cells = [];
        this.cellMap = {};
    },
    setSlots: function(slots) {
        // remove existing slots...
        this.removeSlots();
        if(slots) {
            // pokud je parametr pole, udelat z nej objekt
            if($.isArray(slots)) slots = slots.toObject();
            for(var key in slots) {
                this.add(slots[key]);
            }
        }
    },
    _klass: "growable-layout layout thing",
    _type: "growable-layout",
    _defaults: {
        "css": "" //"mykkro-flow-layout"
    },
    _schema: {
       "type":"object",
       "properties":{
          "css":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }
});



// TODO metody na prohazovani elementu - move to front/back, move up, move down
// TODO metody insert/delete?
// TODO -> DynamicLayout
// TODO ze by se to poradi slotu dalo ulozit?
var OrderableLayout = GrowableLayout.extend({
    init: function() {
        this.cells = []; // v tomto poradi budou v this.element!
        this.cellMap = {}; 
    },
    // what muze byt Slot nebo Thing
    getSlotIndex: function(what) {
        if(what && typeof what === 'object') {
            for(var i=0; i<this.cells.length; i++) {
                if(this.cells[i] == what || this.cells[i].get() == what) return i;
            }
            return -1;
        } else {
            if(what>=0 && what < this.cells.length) return what;
            return -1;
        }
    },
    moveSlotUp: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>0) {
            // swap slots 'i-1' and 'i'
            this.swapSlots(slot-1, slot);
        }
    },
    moveSlotDown: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>=0 && slot<this.cells.length-1) {
            // swap slots 'i' and 'i+1'
            this.swapSlots(slot, slot+1);
        }
    },
    moveSlotToTop: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>0) {
            this.swapSlots(0, slot);
        }
    },
    moveSlotToBottom: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>=0 && slot<this.cells.length-1) {
            this.swapSlots(slot, this.cells.length-1);
        }
    },
    swapSlots: function(slot1, slot2) {
        slot1 = this.getSlotIndex(slot1);
        slot2 = this.getSlotIndex(slot2);
        if(slot1 != slot2) {
            // prohodit to v DOM...
            this.cells[slot1].element.swap(this.cells[slot2].element);
            var tmp = this.cells[slot1];
            this.cells[slot1] = this.cells[slot2];
            this.cells[slot2] = tmp;
        }
    },
    shuffle: function() {
        var len = this.cells.length;
        for (var i = len-1; i >=0; i--) {
            var randomIndex = Math.floor(Math.random()*(i+1)); 
            this.swapSlots(randomIndex, i);
        }
    },
    remove: function(what) {        
        var ndx = this.getSlotIndex(what);
        if(ndx>=0) {
            var slot = this.cells[ndx];
            this.cellMap[slot.name] = null;
            // remove from array
            this.cells.remove(ndx);
            // remove from DOM
            slot.element.remove();
            this.refresh();
        }
    },
    _klass: "orderable-layout growable-layout layout thing",
    _type: "orderable-layout",
    _defaults: {
        "css": "" //"mykkro-flow-layout"
    },
    _schema: {
       "type":"object",
       "properties":{
          "css":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }
});



var PreviewPager = AjaxPager.extend({
    constructor: function(options, callback) {
        this.base(options); // baseUrl, query, includePublic, allTags, disableSearchBox
        this.onselected = callback || $.noop;
    },
    createControls: function() {
        this.base();
        var self = this
        var changer = function() {
            self.refreshView()
        }
        this.searchBox = $('<input type="text" name="sf-text" class="search rounded" placeholder="Search...">').attr("value", this.options.query).on("change keyup paste", changer)
        this.publicCBox = $('<input type="checkbox" name="sf-public">').prop('checked', this.options.includePublic).change(changer)
        this.allCBox = $('<input type="checkbox" name="sf-all">').prop("checked", this.options.allTags).change(changer)
        if(!this.options.disableSearchBox) {
            var sc = $("<div>")
                .addClass('search-controls')
                .appendTo(this.element)
                .append(
                    $('<label>').append(this.searchBox), 
                    $('<label>').append(this.publicCBox, $('<span>Include public content</span>')),
                    $('<label>').append(this.allCBox, $('<span>Use all tags</span>'))
                );
        }
    },
    getPageUrl: function(page) {
        var text = encodeURIComponent(this.searchBox.val())
        var publ = this.publicCBox.is(':checked') ? 'true' : 'false'
        var all = this.allCBox.is(':checked') ? 'true' : 'false'
        return this.base(page) + "?public="+publ+"&text="+text+"&all="+all
    },
    _dataReceived: function(data) {
        return data;
    },
    _dataTransform: function(data) {
        var self = this;
        var ol = new OrderableLayout({"css":"mykkro-flow-layout"});
        for(var i=0; i<data.items.length; i++) {
            var thing = Thing.create(data.items[i].preview);
            var clickable = new Clickable({tooltip: data.items[i].title});
            clickable.setSlot('content', thing);
            (function() {
                var url = data.items[i].url;
                clickable.click(function() {
                    self._selected(url);
                });
/*
                // TODO settings - otevre formular
                // Thing ma definovane schema pro validaci options
                var st = makeSettingsToolbar(function(){
                    // change thing's settings
                    self._selected(url, true);
                });
                st.setSlot('content', clickable);
                ol.add(st);
*/
                ol.add(clickable);
            })();
        }
        var pd = new PageDecorator({
            'pageNumber': data.page,
            'pagesTotal' : data.pagesTotal,
            'recordsTotal' : data.itemsTotal            
        });
        pd.setSlot('content', ol);
        return pd;
    },
    _selected: function(url, editSettings) {
        var self = this;
         $.ajax({
              url: url,
              dataType: 'json',
              //data: data,
              success: function(data) {
                   console.log("Selected:")
                   console.log(data)
                  if(editSettings) {
                     // ziskat schema, zobrazit formular, nastavit data.options                    
                  }
                  var thing = Thing.create(data);
                  self.onselected(thing);
              }
          });
    },
    _type: "preview-pager"
}, {
    choose: function(type, callback, options) {
        options = options || {}
	    var mm = {};
        var url = baseUrl+'api/pagedpreviews/'+type+'/';
        var ap = new PreviewPager($.extend({baseUrl:url}, options), function(thing) { 
            mm.modal.close();
            if(callback) callback(thing);
        });
        /**/options.resizable = false/**/
        mm.modal = Modal.show(ap, options);
    }
});


// TODO vertical split
var SplitLayout = Layout.extend({
    init: function() {
        this.first = $("<div>");
        this.second = $("<div>");
        this.element.append(this.first).append(this.second);
        this.setSlot('first', Thing.empty());
        this.setSlot('second', Thing.empty());
    },
    // options changed...
    refresh: function() {
        this.base();
        var first = this.options.ratio + "%";
        var gap = this.options.gap + "%";
        var xx = (this.options.ratio + this.options.gap) + "%";
        var second = (100 - this.options.ratio - this.options.gap) + "%";
        if(this.options.horizontal) {
            this.first.css("left","0px").css("top","0px").css("width",first).css('height','100%');
            this.second.css("left",xx).css("top","0px").css("width",second).css('height','100%');
        } else {
            this.first.css("left","0px").css("top","0px").css("height",first).css('width','100%');
            this.second.css("left","0px").css("top",xx).css("height",second).css('width','100%');
        }
    },
    setSlot: function(key, value) {
        // TODO implement hasSlot
        this.base(key, value);
        if(key=='first') {
            this.first.empty().append(value.get());
        }
        if(key=='second') {
            this.second.empty().append(value.get());
        }
        return this;
    },
    _klass: "split-layout layout thing",
    _type: "split-layout",
    _defaults: {
        ratio: 70, // v %
        gap: 2, // v %
        horizontal: false
    },
    _schema: {
       "type":"object",
       "properties":{
          "horizontal":{
             "type":"boolean",
             "required":true
          },
          "ratio":{
             "type":"integer",
             "required":true
          },
          "gap":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});



var GridLayout = Layout.extend({
    init: function() {
        // TODO create grid and slots
        this.cellCount = 0;
        this.cells = {};
        for(var i=0; i<this.options.rows; i++) {
            for(var j=0; j<this.options.columns; j++) {
                // create slot
                this.cells[this.cellCount] = $("<div>").appendTo(this.element);                
                // set slot value
                this.setSlot(this.cellCount, Thing.empty());
                this.cellCount++;
            }
        }
    },
    // options changed...
    refresh: function() {
        this.base();
        var gap = this.options.gap;
        var cols = this.options.columns;
        var rows = this.options.rows;
        if(cols*rows != this.cellCount) {
          // resize grid...
          if(cols*rows < this.cellCount) {
            // truncate array...
            while(this.cellCount > rows*cols) {
                this.cellCount--;
                this.removeSlot(this.cellCount)
            }
          } else {
            // expand array by adding new elements
            while(this.cellCount<rows*cols) {
                // create slot
                this.cells[this.cellCount] = $("<div>").appendTo(this.element);                
                // set slot value
                this.setSlot(this.cellCount, Thing.empty());
                this.cellCount++;
            }
          }          
        }
        var ww = Math.round(10*(100 - (cols-1)*gap)/cols)/10;
        var hh = Math.round(10*(100 - (rows-1)*gap)/rows)/10;
        var xx = 0;
        var yy = 0;
        var ndx = 0;
        for(var i=0; i<rows; i++) {
            for(var j=0; j<cols; j++) {
                this.cells[ndx].css({
                    "width": ww+"%",
                    "height": hh+"%",
                    "left": xx+"%",
                    "top": yy+"%"
                });
                ndx++;
                xx += ww + gap;
            }
            xx = 0;
            yy += hh + gap;
        }
    },
    setSlot: function(key, value) {
        if(!!this.cells[key]) {
          this.base(key, value);
          this.cells[key].empty().append(value.get());
        }
        return this;
    },
    removeSlot: function(key) {
        if(this.hasSlot(key)) {
          this.cells[key].remove()
          delete this.cells[key]                
          this.base(key);
        }
    },
    _klass: "grid-layout layout thing",
    _type: "grid-layout",
    _defaults: {
        rows: 3, // nemelo by se menit za behu
        columns: 3, // nemelo by se menit za behu
        gap: 2 // v procentech
    },
    _schema: {
       "type":"object",
       "properties":{
          "rows":{
             "type":"integer",
             "required":true
          },
          "columns":{
             "type":"integer",
             "required":true
          },
          "gap":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});



var SwitchLayout = GrowableLayout.extend({
    refresh: function() {
        this.base();
        var index = parseInt(this.options.index)+1;
        this.element.children().hide();
        this.element.find("div:nth-child("+index+")").show();
    },
    setIndex: function(ndx) {
        this.options.index = ndx;
        this.refresh();
    },
    add: function(thing) {
        var slot = this.base(thing);
        this.refresh();
        return slot;
    },
    _klass: "switch-layout growable-layout layout thing",
    _type: "switch-layout",
    _defaults: {
        "css": "", //"mykkro-flow-layout"
        index: 0
    },
    _schema: {
       "type":"object",
       "properties":{
          "css":{
             "type":"string",
             "required":false
          },
          "index":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var Book = GrowableLayout.extend({
    currentPage: 0,
    init: function() {
        this.base();
        console.log("Book created")
        console.log(this)
    },
    refresh: function() {
        this.base();
    },
    // TODO tohle se muze zavolat jen pokud jsou stranky uz vlozena do DOMu
    makeDisplay: function() {
        var self = this;
	    // kniha = <div class="mykkro-book> <div class="mykkro-slot"> .. </div>
	    this.element.addClass(this.options.display);
	    switch(this.options.display) {
	      case 'basic':
	        // add page numbers...
	        break;
	      case "turnable":
	        this.element.turn({gradients: true, acceleration: true});
            this.element.bind("start", function(ev, pageObject, corner) { 
                self.onTurnStart(ev, pageObject, corner); })
            this.element.bind("turning", function(ev, page, pageObject) { 
                self.onTurning(ev, page, pageObject); })
            this.element.bind("turned", function(ev, page, view) { 
                self.onTurned(ev, page, view); })
            this.element.bind("end", function(ev, pageObject, turned) { 
                self.onTurnEnd(ev, pageObject, turned); })
	        break;
	    }
    },
    _setPage: function(page) {
        if(!this.currentPage) {
            // page 1 became visible
            this.onPageVisibilityChange(page, true);
        }
        else if(this.currentPage>>1 == page>>1) {
            // je videt porad stejna dvoustrana
        } else {            
            // visibility changed
            var oldPages = 2*(Math.floor(this.currentPage / 2));
            var newPages = 2*(Math.floor(page / 2));
            this.onPageVisibilityChange(oldPages, false);
            this.onPageVisibilityChange(oldPages+1, false);
            this.onPageVisibilityChange(newPages, true);
            this.onPageVisibilityChange(newPages+1, true);
        }
        this.currentPage = page;
        // notifikovat stranky pokud se jejich viditelnost zmenila
        this.onPageChange(page);
    },
    // TODO udelat si na to taky bind funkci
    onPageVisibilityChange: function(page, visible) {
        if(typeof(page)=='function') this._onPageVisibilityChange = page;  
        else {
            // mame takovou stranku?
            var name = page-1;
            if(this.slots[name]) {
                this._updatePageVisibility(page, visible);
                if(this._onPageVisibilityChange) this._onPageVisibilityChange(page, visible);
            }
        }
    },
    _updatePageVisibility: function(page, visible) {
        // pri zviditelneni musim refereshnout vsechny audio-decoratory a video-thingy
        // pri zneviditelneni vypnout jejich playback
        //log("Page: "+page+" visibility: "+visible);
        var name = page-1;
        var thing = this.slots[name];
        var media = [];
        thing.findSlotsByType('audio-decorator', media);
        thing.findSlotsByType('video-thing', media)
        //log(audio.length+","+video.length);
        if(visible) {
            // page became visible...
            for(var i=0; i<media.length; i++) {
                media[i].refresh();
                if(media[i].options['autoplay']) {
                    media[i].play();
                }
            }
        } else {
            // TODO stop only if playing...
            for(var i=0; i<media.length; i++) media[i]._kill();
        }
    },
    onPageChange: function(ev) {
        if(typeof(ev)=='function') this._onPageChange = ev;  
        else {
            if(this._onPageChange) this._onPageChange(ev);
        }
    },
    onInit: function(ev) {
        if(typeof(ev)=='function') this._onInit = ev;  
        else {
            this._setPage(1);
            if(this._onInit) this._onInit();
        }
    },
    onExit: function(ev) {
        if(typeof(ev)=='function') this._onExit = ev;  
        else {
            if(this._onExit) this._onExit();
        }
    },
    onTurnStart: function(ev, pageObject, corner) {
        if(typeof(ev)=='function') this._onTurnStart = ev;  
        else {
            if(this._onTurnStart) this._onTurnStart(ev, pageObject, corner);
        }
    }, 
    onTurning: function(ev, page, pageObject) {
        if(typeof(ev)=='function') this._onTurning = ev;  
        else {
            if(this._onTurning) this._onTurning(ev, page, pageObject);
        }
    }, 
    onTurned: function(ev, page, view) { 
        if(typeof(ev)=='function') this._onTurned = ev;  
        else {
            this._setPage(page);
            if(this._onTurned) this._onTurned(ev, page, view);
        }
    }, 
    onTurnEnd: function(ev, pageObject, turned) { // nefunguje
        if(typeof(ev)=='function') this._onTurnEnd = ev;  
        else {
            if(this._onTurnEnd) this._onTurnEnd(ev, pageObject, corner);
        }
    }, 
    _klass: "book growable-layout layout thing",
    _type: "book",
    _defaults: {
        "title": "My Book",
	    "display": "basic"
    },
    _schema: {
       "type":"object",
       "properties":{
          "title":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var Quest = Thing.extend({
    init: function() {
        this.status = 'active';
        this.finished($.noop);
    },
    refresh: function() {
        this.base();
        //this.inner.html(this.options.html).attr('class',this.options.innerCss);
    },
    finished: function(arg) {
        if(typeof arg == 'function') {
            this.onfinished = arg;
        } else {
            return this.onfinished(arg);
        }
    },
    pass: function() {
        this.status = 'passed';
        this.finished({'quest':this, 'status':this.status});
    },
    fail: function() {
        this.status = 'failed';
        this.finished({'quest':this, 'status':this.status});
    },
    _klass: "quest thing",
    _type: "quest",
    _defaults: {
        //html: ""
    },
    _schema: {
       "type":"object",
       "description":"Quest properties",
       "properties":{
/*
          "html":{
             "type":"string",
             "required":true
          },
          "css":{
             "type":"string",
             "required":false
          },
          "innerCss":{
             "type":"string",
             "required":false
          }
*/
       },
       "additionalProperties":true
    }

});

var DemoQuest = Quest.extend({
    init: function() {
        this.base();
        var self = this;
        this.passButton = $("<button>").text("Pass").click(function() { self.pass(); }).appendTo(this.element);
        this.failButton = $("<button>").text("Fail").click(function() { self.fail(); }).appendTo(this.element);
        this.statusBar = $("<span>").appendTo(this.element);
        this.statusBar.text('active');
    },
    pass: function() {
        this.statusBar.text('passed');
        this.passButton.prop('disabled', true);
        this.failButton.prop('disabled', true);
        this.base();
    },
    fail: function() {
        this.statusBar.text('failed');
        this.passButton.prop('disabled', true);
        this.failButton.prop('disabled', true);
        this.base();
    },
    _klass: "demo-quest quest thing",
    _type: "demo-quest",
    _defaults: {
        //html: ""
    },
    _schema: {
       "type":"object",
       "description":"Demo Quest properties",
       "properties":{
/*
          "html":{
             "type":"string",
             "required":true
          },
          "css":{
             "type":"string",
             "required":false
          },
          "innerCss":{
             "type":"string",
             "required":false
          }
*/
       },
       "additionalProperties":true
    }

});

var PlayerControls = Thing.extend({
    _onplay: $.noop,
    _onpause: $.noop,
    _onstop: $.noop,
    init: function() {
        var self = this;
        var cont = $("<div>").addClass('controls').appendTo(this.element);
        this._playBtn = $("<button>")
            .addClass("play").append($("<span>").text("Play"))
            .appendTo(cont).click(function() { self.onPlay(); });
        this._pauseBtn = $("<button>")
            .addClass("pause").append($("<span>").text("Pause"))
            .appendTo(cont).click(function() { self.onPause(); });
        this._stopBtn = $("<button>")
            .addClass("stop").append($("<span>").text("Stop"))
            .appendTo(cont).click(function() { self.onStop(); });
        this.controls = cont;
        this.playing = false;
        this.paused = false;
    },
    refresh: function() {
        this.base();
        this.controls.toggleClass('playing', this.playing);
        this._playBtn.prop('disabled', this.playing);
        this._pauseBtn.prop('disabled', !this.playing);
        this._stopBtn.prop('disabled', !(this.playing/* || this.paused*/));    
        if(this.playing) {
            this._playBtn.hide();
            this._pauseBtn.show();
        } else {
            this._playBtn.show();
            this._pauseBtn.hide();
        }        
        if(this.playing/* || this.paused*/) {
            this._stopBtn.show();
        } else {
            this._stopBtn.hide();
        }
    },
    updateGui: function(playing, paused) {
        this.playing = playing;
        this.paused = paused;
        this.refresh();
    },
    onPlay: function(kb) {
        if(typeof kb == 'function') {
            this._onplay = kb;
        } else {
            this.updateGui(true, false);
            this._onplay(kb);
        }
    },
    onPause: function(kb) {
        if(typeof kb == 'function') {
            this._onpause = kb;
        } else {
            this.updateGui(false, true);
            this._onpause(kb);
        }
    },
    onStop: function(kb) {
        if(typeof kb == 'function') {
            this._onstop = kb;
        } else {
            this.updateGui(false, false);
            this._onstop(kb);
        }
    },
    _klass: "player-controls thing",
    _type: "player-controls",
    _defaults: {
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
	    }
    }
});


var AudioDecorator = Thing.extend({
    _onplay: $.noop,
    _onpause: $.noop,
    _onstop: $.noop,
    _onkill: $.noop,
    onPlay: function(kb) {
        if(typeof kb == 'function') {
            this._onplay = kb;
        } else {
            this._onplay(kb);
        }
    },
    onPause: function(kb) {
        if(typeof kb == 'function') {
            this._onpause = kb;
        } else {
            this._onpause(kb);
        }
    },
    onStop: function(kb) {
        if(typeof kb == 'function') {
            this._onstop = kb;
        } else {
            this._onstop(kb);
        }
    },
    onKill: function(kb) {
        if(typeof kb == 'function') {
            this._onkill = kb;
        } else {
            this._onkill(kb);
        }
    },
    init: function() {
        this.slot = $("<div>").addClass("slot");
        this.setSlot('content', Thing.empty());
    },
    play: function() {
        this._play();
        this.player.updateGui(true, false);
    },
    _play: function() {
        this.audio.get(0).play();
        this.onPlay();
    },
    _pause: function() {
        this.audio.get(0).pause();
        this.onPause();
    },
    _stop: function() {
        // regenerate player...
        this.refresh();
        this.onStop();
    },
    _kill: function() {
        this.audio.get(0).pause();
        this.audio.get(0).src = "";
        this.onKill();
    },
    _setVolume: function(vol) {
        // HTML5 volume is between 0 and 1
        this.audio.get(0).volume = vol / 100.0;
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.slot.html(value.get());
        return this;
    },
    _addSource: function(uri, type) {
        if(uri) $("<source>").attr({src:uri, type: type, preload: false/**/}).appendTo(this.audio);
    },
    refresh: function() {
        this.base();
        var self = this;
        this.audio = $("<audio>");
        this.player = new PlayerControls();  
        this.player.onPlay(function() { self._play(); });
        this.player.onPause(function() { self._pause(); });
        this.player.onStop(function() { self._stop(); });
        var cc = new CenteringDecorator({},{content: this.player});
        this.pane = cc.get();
        this.pane.addClass("player");
        this.element.empty()
            .append(this.slot)
            .append(this.pane)
            .append(this.audio);

        // incorrect... and unnecessary: this.audio.remove("source");
        this.audio.prop('loop', this.options.loop);
        if(this.options.uri) {            
            var ext = this.options.uri.split('.').pop();
            this.options.ogg = (ext == 'ogg') ? this.options.uri : '';
            this.options.mp3 = (ext == 'mp3') ? this.options.uri : '';
        }
        this._addSource(this.options.ogg, 'audio/ogg; codecs="vorbis"');
        this._addSource(this.options.mp3, 'audio/mpeg; codecs="mp3"');
        // HTML5 volume is between 0 and 1
        this._setVolume(this.options.volume);
    },
    _klass: "audio-decorator decorator thing",
    _type: "audio-decorator",
    _defaults: {
        'ogg': "",
        'mp3': "",
        'uri': "",
        'autoplay': false,
        'loop': false,
        'volume': 50
    },
    _schema: {
       "type":"object",
       "properties":{
          "uri":{
             "type":"string",
             "format": "my-voice-uri",
            // TODO vadi mu kdyz je to false - option se neda rozkliknout
             "required":true
          },
          "volume":{
             "type":"integer",
             "required":true // TODO
          },
          "autoplay":{
             "type":"boolean",
             "required":true // TODO
          },
          "loop":{
             "type":"boolean",
             "required":true // TODO
          }
       },
       "additionalProperties":true
    }
});



var VideoThing = Thing.extend({
    _onplay: $.noop,
    _onpause: $.noop,
    _onstop: $.noop,
    _onkill: $.noop,
    onPlay: function(kb) {
        if(typeof kb == 'function') {
            this._onplay = kb;
        } else {
            this._onplay(kb);
        }
    },
    onPause: function(kb) {
        if(typeof kb == 'function') {
            this._onpause = kb;
        } else {
            this._onpause(kb);
        }
    },
    onStop: function(kb) {
        if(typeof kb == 'function') {
            this._onstop = kb;
        } else {
            this._onstop(kb);
        }
    },
    onKill: function(kb) {
        if(typeof kb == 'function') {
            this._onkill = kb;
        } else {
            this._onkill(kb);
        }
    },
    init: function() {
    },
    play: function() {
        this._play();
        this.player.updateGui(true, false);
    },
    _play: function() {
        this.video.get(0).play();
        this.onPlay();
    },
    _pause: function() {
        this.video.get(0).pause();
        this.onPause();
    },
    _stop: function() {
        //this.video.get(0).pause();
        //this.video.get(0).currentTime = 0;
        // regenerate player...
        this.refresh();  // TODO udelat to lepe
        this.onStop();
    },
    _kill: function() {
        this.video.get(0).pause();
        this.video.get(0).src = "";
        this.onKill();
    },
    _setVolume: function(vol) {
        // HTML5 volume is between 0 and 1
        this.video.get(0).volume = vol / 100.0;
    },
    _addSource: function(uri, type) {
        if(uri) {
            $("<source>").attr({src:uri, type: type, preload: false/**/}).appendTo(this.video);
        }
    },
    refresh: function() {
        this.base();
        var self = this;
        this.video = $("<video>");
        this.player = new PlayerControls();  
        this.player.onPlay(function() { self._play(); });
        this.player.onPause(function() { self._pause(); });
        this.player.onStop(function() { self._stop(); });
        var cc = new CenteringDecorator({},{content: this.player});
        this.pane = cc.get();
        this.pane.addClass("player");
        this.element.empty()
            .append(this.video)
            .append(this.pane);

        this.video.prop('loop', this.options.loop);
        if(this.options.uri) {            
            var ext = this.options.uri.split('.').pop();
            this.options.ogg = (ext == 'ogg' || ext == 'ogv') ? this.options.uri : '';
            this.options.mp4 = (ext == 'mp4') ? this.options.uri : '';
            this.options.webm = (ext == 'webm') ? this.options.uri : '';
        }
        this._addSource(this.options.ogg, 'video/ogg; codecs="theora, vorbis"');
        this._addSource(this.options.mp4, 'video/mp4; codecs="avc1.42E01E, mp4a.40.2"');
        this._addSource(this.options.webm, 'video/webm; codecs="vp8, vorbis"');
        ////this.video.get(0).src = this.options.uri;
        // TODO tohle nejak zlobi v Chrome, pri znovuvytvareni videi... ale ve FF to zda se funguje

        // HTML5 volume is between 0 and 1
        this._setVolume(this.options.volume);
        this.video.on('canplay canplaythrough', function(){
            console.log('canplay event fired');
        });
    },
    _klass: "video-thing thing",
    _type: "video-thing",
    _defaults: {
        "uri": "",
        'ogg': "",
        'mp4': "",
        'webm': "",
        'autoplay': false,
        'loop': false,
        'volume': 50
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "uri": {
			    "type":"string",
                "format": "my-video-uri",
			    "required":true
    	    },
            "volume":{
                "type":"integer",
                "required":true // TODO
            },
            "autoplay":{
                "type":"boolean",
                "required":true // TODO
            },
            "loop":{
                "type":"boolean",
                "required":true // TODO
            }
	    }
    }

});


/*

document.addEventListener('DOMContentLoaded', function(){
    var v = document.getElementById('vid');
    var canvas = document.getElementById('canvas');
    var context = canvas.getContext('2d');

    var cw = canvas.clientWidth;
    var ch = canvas.clientHeight;
    canvas.width = cw;
    canvas.height = ch;

    v.addEventListener('play', function(){
        draw(this,context);
    },false);

},false);

var mode = 'stretch';
function draw(v,c) {
    var canvas = document.getElementById('canvas');
    var w = canvas.clientWidth;
    var h = canvas.clientHeight;
    if(v.paused || v.ended) return false;
    if(mode == 'stretch') {
        c.drawImage(v,0,0,w,h); //-> stretch
    } else if(mode == 'cover') {
        // TODO tady je neco spatne
        var sx=0, sy=0, sw=v.width, sh=v.height;
        if(sw/sh < w/h) {
            sy = (sh - h*sw/w)/2;
            sh = h*sw/w;
        } else {
            sx = (sw - w*sh/h)/2;
            sw = w*sh/h;
        }
        c.drawImage(v,sx,sy,sw,sh,0,0,w,h); 
    } else { // contain
        var ww = v.width;
        var hh = v.height;
        var x = y = 0;
        if(ww/hh < w/h) {
            x = (w-ww*h/hh)/2;
            c.drawImage(v,x,0,ww*h/hh,h); 
        } else {
            y = (h-hh*w/ww)/2;
            c.drawImage(v,0,y,w,hh*w/ww); 
        }
    }
    setTimeout(draw,20,v,c);
}

<canvas id="canvas"></canvas>

*/

// TODO udelat z toho Thing
// TODO k ikonam pridat tooltipy

var BookViewer = Base.extend({
    constructor: function(options) {
        this.bookData = options.data;
        this.bookUrl = options.url;
        this.eventUrl = options.eventUrl;
        this.fullscreen = options.fullscreen;
        this.defaultWidth = 920;
        this.defaultHeight = 600;
        this.tools = {};
        this.bookContent = null;
        this.eventHistory = [];
    },
    makeIcon: function(icon, title) {
        return $("<div>").addClass('icon icon-48 icon-'+icon).css('display','inline-block').attr("title", title);
    },
    makeTool: function(icon, label, left/*bool*/, top, click) {
        this.tools[icon] = this.makeIcon(icon, label).css({position:'absolute', top: top}).css(left ? {'left':'6px'}:{'right':'6px'}).click(click).appendTo($("#book-wrapper"));
        return this.tools[icon];
    },
    showIcon: function(icon, enable) {
        if(enable) this.tools[icon].show() ; else this.tools[icon].hide();
    },
    turnNext: function() {
        this.bookContent.get().turn("next");
        this.logEvent('book_page_turn', this.bookUrl, this.bookContent.get().turn("page"));
    },
    turnPrevious: function() {
        this.bookContent.get().turn("previous");
        this.logEvent('book_page_turn', this.bookUrl, this.bookContent.get().turn("page"));
    },
    turnFirst: function() {
        this.bookContent.get().turn("page", 1);
        this.logEvent('book_page_turn', this.bookUrl, 1);
    },
    goHome: function() {
        this.logEvent('book_close', this.bookUrl);
        window.location.href = this.bookUrl;
    },
    close: function() {
        this.logEvent('book_close', this.bookUrl);
        window.open('','_parent','');
        window.close();
    },
    _setPageBackgrounds: function(bookContent, o) {
        var totalPages = bookContent.length()
        for(var i=0; i<totalPages; i++) {
            var slot = bookContent.nth(i)
            var elem = slot.element
            var css = { "background-size": "cover", "background-color": "white"}
            if(i==0) {
                // first page
                css["background-image"] = 'url('+o.frontpage_image_url+')'
            } else if(i == totalPages-1 && i%2!=0) {
                // last page, must be odd
                css["background-image"] = 'url('+o.backpage_image_url+')'
            } else if(i%2==0) {
                // even page
                css["background-image"] = 'url('+o.evenpage_image_url+')'
            } else {
                // odd page
                css["background-image"] = 'url('+o.oddpage_image_url+')'
            }
            elem.css(css)
        }
    },
    init: function() {
        /* display book... */
        var self = this;
        var width = this.defaultWidth;
        var height = this.defaultHeight;
        console.log("BookViewer: Displaying book")
        console.log(this.bookData)
        var o = this.bookData.options      
        // create wrapper...
        var wrapper = $("<div>")
            .attr("id", "book-wrapper")
            .css('position','relative')
            .css("background-image", 'url('+o.background_image_url+')')
            .appendTo($("#content"));
        this.bookContent = Thing.create(this.bookData, {"display":"turnable"});

        this._setPageBackgrounds(this.bookContent, o)

        // find audio and video Things and monitor their play, stop, pause, kill events
        var media = [];
        this.bookContent.findSlotsByType('audio-decorator', media);
        this.bookContent.findSlotsByType('video-thing', media);
        for(var i=0; i<media.length; i++) {
            var m = media[i]; 
            var src = m.options.uri;           
            (function(){
                m.onPlay(function() { self.logEvent('book_media_play', src); });
                m.onPause(function() { self.logEvent('book_media_pause', src); });
                m.onStop(function() { self.logEvent('book_media_stop', src); });
                m.onKill(function() { self.logEvent('book_media_kill', src); });
            })();
        }
        // init book...
        this.bookContent.onInit();
        $("#book-wrapper").css({width:width+"px", height:height+"px"}).html(this.bookContent.get());
        this.bookContent.makeDisplay();

        // events...
        $(window).unload(function() {
            self.bookContent.onExit(); // TODO tohle mi nejak nefunguje...
        });
        $(window).resize(function() {
            if(self.fullscreen) {
                self.updateToolbar(self.recreate());
            }
        });
        $(window).bind("fullscreen-toggle", function(e, state) {
            self.setFullscreen(state);
        });
        this.bookContent.get().bind("turned", function(event, page, view) {
          self.updateToolbar();
        });
        this.makeTool('turn-right', __('Previous page'), true, '50%', function() { self.turnPrevious();});
        this.makeTool('turn-left', __('Next page'), false, '50%', function() { self.turnNext();});
        //this.makeTool('fullscreen-on', __('Fullscreen on'), true, '68px', function() { self.setFullscreen(true);});
        //this.makeTool('fullscreen-off', __('Fullscreen off'), true, '68px', function() { self.setFullscreen(false)});
        this.makeTool('closebook', __('Close book'), false, '16px', function() { self.turnFirst();});
        //if(this.bookUrl) this.makeTool('home', __('Back to editor'), true, '16px', function() { self.goHome();});
        // reduce close icon in size...
        this.tools['closebook'].css({top: '16px', width: "24px", height: "24px"});

        // update icons...
        $("#book-wrapper >.icon-turn-left").css("background-image", 'url('+o.turnleft_image_url+')')
        $("#book-wrapper >.icon-turn-right").css("background-image", 'url('+o.turnright_image_url+')')

        this.updateToolbar();
        this.logEvent('book_open', this.bookUrl);
    },
    logEvent: function(type, src, data) {
        var timestamp = Math.floor(new Date().getTime() / 1000);
        this.logSingleEvent({"type":type,"src":src,"data":data,"timestamp":timestamp});
        if(type == 'book_close') {  
            // flush events...
            this.flushEventLog();
        }
    },
    logSingleEvent: function(evt) {
        this.eventHistory.push(evt);
        if(this.eventUrl) {
            Common.postJsonData(this.eventUrl+".json", evt);
        }
    },
    flushEventLog: function() {
        // TODO odesilat eventy pres AJAX
        console.log(JSON.stringify(this.eventHistory, null, 4));
    },
    setFullscreen: function(full) {
        this.fullscreen = full;
        this.bookContent.get().turn('disable', true);
        if(this.fullscreen) {
            $("#book-wrapper").appendTo($("#fullscreen"));
            $("#container").hide();
            $("#fullscreen").show();            
        } else {
            $("#book-wrapper").appendTo($("#content"));
            $("#container").show();
            $("#fullscreen").hide();

        }
        this.bookContent.get().turn('disable', false);
        this.updateToolbar(this.recreate());
        this.logEvent('book_fullscreen', this.bookUrl, full);
        return full;    
    },
    recreate: function() {
        var width = this.defaultWidth;
        var height = this.defaultHeight;
        // kniha je velka 800x560 - pomer stran cca 1:sqrt(2) ~ 1:1.428
        if(this.fullscreen) {
            var ww = $(window).width();
            var hh = $(window).height();
            var scaleFactor = ww/width;
            var scaleFactor2 = hh/height;
            var scale = Math.min(scaleFactor, scaleFactor2);
            width = /*Math.floor(width*scale);*/ww;
            height = /*Math.floor(height*scale);*/hh;
        } 
        // resize wrapper and pages...
        $("#book-wrapper").css({width:width+"px", height:height+"px"});
        if(this.fullscreen) {
            // na okrajich musi zbyt 8% mista; to odpovida 60px 
            var sidex = Math.max(Math.floor(width*0.08), 60);
            var newWidth = width - 2*sidex;
            var newHeight = Math.floor(newWidth/1.428);
            var maxHeight = height-40;
            if(newHeight > maxHeight) {
                newWidth = Math.floor(newWidth*maxHeight/newHeight);
                newHeight = maxHeight;
            }
        } else {
            var newWidth = width - 120;
            var newHeight = height - 40;
        }
        this.bookContent.get().turn('size', newWidth, newHeight);
        return newWidth;
    },
    updateToolbar: function(gapWidth) {
        var page = this.bookContent.get().turn("page");
        var pages = this.bookContent.get().turn("pages");
        this.showIcon('turn-right', page>1);
        this.showIcon('turn-left', page<(pages-pages%2)); // kdyz ma kniha 3 strany, uz nejde druha otocit
        //this.showIcon('fullscreen-on', !this.fullscreen);
        //this.showIcon('fullscreen-off', this.fullscreen);
        
        if(gapWidth) {
            var gapSize = 60;
            if(this.fullscreen) {
                gapSize += Math.floor(($("#book-wrapper").width() - gapWidth)/2);
            }
            var hh = this.bookContent.get().height();
            var iconSize = Math.min(gapSize - 12, 240);
            var iconSizeHalf = Math.floor(iconSize/2);
            var hh2 = Math.max(Math.floor(hh/2-iconSize/2), 28+3*iconSize);
            this.tools['turn-right'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['turn-left'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            //this.tools['fullscreen-on'].css({top: (20+iconSize)+'px', width: iconSize+"px", height: iconSize+"px"});
            //this.tools['fullscreen-off'].css({top: (20+iconSize)+'px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['closebook'].css({top: '16px', width: iconSizeHalf+"px", height: iconSizeHalf+"px"});
            //if(this.bookUrl) this.tools['home'].css({top: '16px', width: iconSize+"px", height: iconSize+"px"});
        }
    }
});

var ExportBookViewer = BookViewer.extend({
    constructor: function(options) {
        this.base(options);
        console.log(options);
    },
    // TODO refactor...
    init: function() {
        /* display book... */
        var self = this
        var width = this.defaultWidth
        var height = this.defaultHeight
        var o = this.bookData.options      
        // create wrapper...
        $("<div>")
            .attr("id", "book-wrapper")
            .css('position','relative')
            .css('background-image','url('+o.background_image_url+')')
            .appendTo($("#fullscreen"));
        this.bookContent = Thing.create(this.bookData, {"display":"turnable"});

        this._setPageBackgrounds(this.bookContent, o)

        this.bookContent.onInit();
        $("#book-wrapper").css({width:width+"px", height:height+"px"}).html(this.bookContent.get());
        this.bookContent.makeDisplay();

        // events...
        $(window).unload(function() {
            self.bookContent.onExit(); // TODO tohle mi nejak nefunguje...
        });
        $(window).resize(function() {
            if(self.fullscreen) {
                self.updateToolbar(self.recreate());
            }
        });
        $(window).bind("fullscreen-toggle", function(e, state) {
            self.setFullscreen(state);
        });
        this.bookContent.get().bind("turned", function(event, page, view) {
          self.updateToolbar();
        });
        this.makeTool('turn-right', __('Previous page'), true, '50%', function() { self.turnPrevious();});
        this.makeTool('turn-left', __('Next page'), false, '50%', function() { self.turnNext();});
        this.makeTool('closebook', __('Close book'), false, '16px', function() { self.close();});
        // reduce close icon in size...
        this.tools['closebook'].css({top: '16px', width: "24px", height: "24px"});

        // update icons...
        $("#book-wrapper >.icon-turn-left").css("background-image", 'url('+o.turnleft_image_url+')')
        $("#book-wrapper >.icon-turn-right").css("background-image", 'url('+o.turnright_image_url+')')

        this.setFullscreen(true);
        this.logEvent('book_open', this.bookUrl);
    },
    updateToolbar: function(gapWidth) {
        var page = this.bookContent.get().turn("page");
        var pages = this.bookContent.get().turn("pages");
        this.showIcon('turn-right', page>1);
        this.showIcon('turn-left', page<(pages-pages%2)); // kdyz ma kniha 3 strany, uz nejde druha otocit

        if(gapWidth) {
            var gapSize = 60;
            if(this.fullscreen) {
                gapSize += Math.floor(($("#book-wrapper").width() - gapWidth)/2);
            }
            var hh = this.bookContent.get().height();
            var iconSize = Math.min(gapSize - 12, 240);
            var iconSizeHalf = Math.floor(iconSize/2);
            var hh2 = Math.max(Math.floor(hh/2-iconSize/2), 28+2*iconSize);
            this.tools['turn-right'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['turn-left'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['closebook'].css({top: '16px', width: iconSizeHalf+"px", height: iconSizeHalf+"px"});
        }
    },
    setFullscreen: function(full) {
        this.fullscreen = full;
        this.updateToolbar(this.recreate());
        this.logEvent('book_fullscreen', this.bookUrl, full);
        return full;    
    },
    logEvent: function(type, origin, data) {
        // does nothing...
    }
});



// uses: jquery, common, base

// tohle projde markup a vytvori widgety tam kde jsou na to pripravena data
// widget ma serverovou cast/sablonu a JS na klientovi ktery z toho muze vyrobit
// treba graficky editor nebo embedded SVG

function valueDecode(value) {
    if((/^!/).test(value)) {
        // je to bud base64 nebo to zacina vykricnikem
        value = value.substring(1);
        if(!(/^!/).test(value)) {
            // je to base64
            value = JSON.parse(utf8_decode(base64_decode(value)));
        } else {
            value = htmlDecode(value);
        }
    } else {
        value = htmlDecode(value);
    }
    return value;
}

function valueEncode(value) {
    if(jQuery.isPlainObject(value)) {
        return '!' + base64_encode(utf8_encode(JSON.stringify(value)));
    } else {
        var out = htmlEncode(value);
        if(out.startsWith('!')) out = "!" + out;
    }
    return out;
}

function widgetize(what) {
    what.reverse().each(function() {
        var self = $(this);        
        // find the widget class...
        var csss = self.attr("class").split(" ");
        for(var i=0; i<csss.length; i++) {
            // je to widget?
            if(csss[i].endsWith("-widget")) {
                var widgetClass = csss[i].replace(/-widget$/, "");
                // gather all data-attributes
                var data = self.data();        
                for(var key in data) {
                    var value = data[key];
                    data[key] = valueDecode(data[key]);
                    self.data(key, data[key]);
                }
                // vytvorime widget - zavolame JS/jQuery plugin a predame mu parametry v data
                console.log(data)
                self[widgetClass](data);
                break;
            }
        }
    });
}


var Widget = Base.extend({
    constructor: function(element, options) {
        this.element = element;
        this.options = $.extend({}, options);
        // promenne widgetu...
        this.wid = Widget.getUniqueId();
        this.element.data('wid', this.wid);
        Widget.cache[this.wid] = this;
    },
    init: function() {
        // inicializace ramce pro widget (toho co se nemeni)
    },
    refresh: function() {
        // volat pokazde pokud se zmeni data
    },
    destroy: function() {
        // uvedeni widgetu do puvodniho stavu
    }
},{
    wid: 1,
    getUniqueId: function() {
        return 'widget'+Widget.wid++;
    },
    cache: {}
});







var ThingWidget = Widget.extend({
    init: function() {
        var self = this;
        var def = this.options.def;
        if(def) {
            var thing = Thing.create(def);
            this.element.empty().append(thing.get());
        }
        self.refresh();
    },
    refresh: function() {
    }
});

// widgety...
(function($){

    var defaultOptions = { def: { type: "empty" } };

    var methods = {
        init : function(options) {
            var settings = $.extend({}, defaultOptions, options);
            return this.each(function() {
                var $this = $(this);
                var widget = new ThingWidget($this, settings);
                widget.init();
            });
        }
    };

    $.fn.thing = function(methodOrOptions) {
        if ( methods[methodOrOptions] ) {
            return methods[ methodOrOptions ].apply( this, Array.prototype.slice.call( arguments, 1 ));
        } else if ( typeof methodOrOptions === 'object' || ! methodOrOptions ) {
            // Default to "init"
            return methods.init.apply( this, arguments );
        } else {
            $.error( 'Method ' +  method + ' does not exist on jQuery.thing' );
        }    
    };

})(jQuery);


// TODO rozeznavani 'media' podle pripony

var _audioPlayerIndex = 1;
var makeAudioPlayer = function(parent, media) {
    var id = _audioPlayerIndex++;
    var playerId = 'jquery_cplayer_'+id;
    var containerId = 'cp_container_'+id;
    var html = $.render.circlePlayer({playerId: playerId, containerId: containerId});
    var div = $("<div>").html(html);
    parent.append(div);
    // ensure that player div is at the root of body
    $("#"+playerId).appendTo($("body"));

	var myCirclePlayer = new CirclePlayer("#"+playerId, media, {
		cssSelectorAncestor: "#"+containerId
	});
    return div;
};

var _videoPlayerIndex = 1;
var makeVideoPlayer = function(parent, media) {
    var id = _videoPlayerIndex++;
    var playerId = 'jquery_jplayer_'+id;
    var containerId = 'jp_container_'+id;
    var html = $.render.videoPlayer({playerId: playerId, containerId: containerId});
    var div = $("<div>").html(html).appendTo(parent);
    $("#"+playerId).jPlayer({
        ready: function () {
          $(this).jPlayer("setMedia", media);
        },
        swfPath: "/js",
        supplied: "m4v, ogv",
        cssSelectorAncestor: "#"+containerId
    });    
    return div;
};

// initialization...
$(document).ready(function() {

    // widgetizer...
    widgetize($(".widget"));

});
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_Takova_normalni_rodinka\book.json
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_Takova_normalni_rodinka\book.json
VELIKOST: 8210 B (8.02 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
{"type":"book","options":[],"slots":[{"type":"text-thing","options":{"html":"Slovensko - Vysok\u00e9 Tatry 2020","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},{"type":"grid-layout","options":{"rows":2,"columns":2,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/331\/DSCN0665_2_original.jpg","repeat":"no-repeat","position":"center center","color":"","size":"cover"}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"text-thing","options":{"html":"<p>Star&yacute; Smokovec &rArr; Hrebienok &rArr; Malou Studenou dolinou &rArr; p\u0159es Z&aacute;mkovsk&eacute;ho chatu &rArr; na Teryho chatu <span style=\"font-size:14px\"><strong>:)<\/strong><\/span><\/p>\r\n","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}},{"type":"text-thing","options":{"html":"Mlha \"na Blatech\"","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/347\/DSCN0666_2_original.jpg","repeat":"no-repeat","position":"center center","color":"","size":"cover"}}}}]},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"audio-decorator","options":{"ogg":"","mp3":"voices\/30\/Mumford_Sons_Hopeless_Wanderer_Official_Music_Video_original.mp3","uri":"voices\/30\/Mumford_Sons_Hopeless_Wanderer_Official_Music_Video_original.mp3","autoplay":true,"loop":false,"volume":50},"slots":{"content":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/333\/DSCN0669_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}}}},{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"video-thing","options":{"uri":"videos\/10\/video_1596110981_original.mp4","ogg":"","mp4":"videos\/10\/video_1596110981_original.mp4","webm":"","autoplay":true,"loop":true,"volume":20}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/334\/DSCN0670_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}]},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/335\/DSCN0679_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}},{"type":"grid-layout","options":{"rows":1,"columns":2,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/337\/DSCN0689_2_original.jpg","repeat":"no-repeat","position":"center center","color":"","size":"cover"}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"audio-decorator","options":{"ogg":"","mp3":"voices\/31\/Jelen_Abych_tu_zil_original.mp3","uri":"voices\/31\/Jelen_Abych_tu_zil_original.mp3","autoplay":true,"loop":false,"volume":50},"slots":{"content":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/336\/DSCN0685_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}}}}]},{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"text-thing","options":{"html":"<p><em><strong><span style=\"background-color:#800080\">\u010clenov&eacute; v&yacute;pravy :))<\/span><\/strong><\/em><\/p>\r\n\r\n<p>&nbsp;<\/p>\r\n","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/338\/DSCN0696_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}]},{"type":"split-layout","options":{"ratio":65,"gap":2,"horizontal":false},"slots":{"first":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/339\/DSCN0697_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}},"second":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"text-thing","options":{"html":"<h1><u><strong>Popradsk&eacute; pleso<\/strong><\/u><\/h1>\r\n\r\n<h3>- ledovcov&eacute; jezero v <em>Mengusovsk&eacute; dolin\u011b<\/em> ve Vysok&yacute;ch Tatr&aacute;ch<\/h3>\r\n","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}}}},{"type":"split-layout","options":{"ratio":33,"gap":2,"horizontal":false},"slots":{"first":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"text-thing","options":{"html":"<h1><u><strong>&#39;Nad mraky&#39;<\/strong><\/u><\/h1>\r\n\r\n<h3><em>- v&yacute;hled z Ostrvy<\/em><\/h3>\r\n","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}},"second":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/340\/DSCN0706_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"grid-layout","options":{"rows":2,"columns":2,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/341\/DSCN0708_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}},{"type":"text-thing","options":{"html":"Popradsk\u00e9 pleso z Ostrvy","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},{"type":"text-thing","options":{"html":"V\u00fdhled z Ostrvy","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/342\/DSCN0712_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}]},{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/343\/DSCN0716_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/344\/DSCN0717_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}]},{"type":"split-layout","options":{"ratio":33,"gap":2,"horizontal":false},"slots":{"first":{"type":"text-thing","options":{"html":"Batizovsk\u00e9 pleso pod Gerlachovsk\u00fdm \u0161t\u00edtem","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},"second":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/345\/DSCN0720_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"audio-decorator","options":{"ogg":"","mp3":"voices\/32\/Tom_Petty_And_The_Heartbreakers_Learning_To_Fly_Version_1_original.mp3","uri":"voices\/32\/Tom_Petty_And_The_Heartbreakers_Learning_To_Fly_Version_1_original.mp3","autoplay":true,"loop":false,"volume":75},"slots":{"content":{"type":"text-thing","options":{"html":"A tady na\u0161e v\u00fdprava kon\u010d\u00ed :)","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}}}}]}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_Takova_normalni_rodinka\connector.js
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_Takova_normalni_rodinka\connector.js
VELIKOST: 26 B (26.00 B)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
var bookman_connector = {}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_Takova_normalni_rodinka\files
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_Takova_normalni_rodinka\files
VELIKOST: 1663 B (1.62 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
{"images\/331\/DSCN0665_2_original.jpg":"images\/331\/DSCN0665_2_original.jpg","images\/347\/DSCN0666_2_original.jpg":"images\/347\/DSCN0666_2_original.jpg","voices\/30\/Mumford_Sons_Hopeless_Wanderer_Official_Music_Video_original.mp3":"voices\/30\/Mumford_Sons_Hopeless_Wanderer_Official_Music_Video_original.mp3","images\/333\/DSCN0669_2_original.jpg":"images\/333\/DSCN0669_2_original.jpg","videos\/10\/video_1596110981_original.mp4":"videos\/10\/video_1596110981_original.mp4","images\/334\/DSCN0670_2_original.jpg":"images\/334\/DSCN0670_2_original.jpg","images\/335\/DSCN0679_2_original.jpg":"images\/335\/DSCN0679_2_original.jpg","images\/337\/DSCN0689_2_original.jpg":"images\/337\/DSCN0689_2_original.jpg","voices\/31\/Jelen_Abych_tu_zil_original.mp3":"voices\/31\/Jelen_Abych_tu_zil_original.mp3","images\/336\/DSCN0685_2_original.jpg":"images\/336\/DSCN0685_2_original.jpg","images\/338\/DSCN0696_2_original.jpg":"images\/338\/DSCN0696_2_original.jpg","images\/339\/DSCN0697_original.JPG":"images\/339\/DSCN0697_original.JPG","images\/340\/DSCN0706_original.JPG":"images\/340\/DSCN0706_original.JPG","images\/341\/DSCN0708_original.JPG":"images\/341\/DSCN0708_original.JPG","images\/342\/DSCN0712_2_original.jpg":"images\/342\/DSCN0712_2_original.jpg","images\/343\/DSCN0716_2_original.jpg":"images\/343\/DSCN0716_2_original.jpg","images\/344\/DSCN0717_2_original.jpg":"images\/344\/DSCN0717_2_original.jpg","images\/345\/DSCN0720_original.JPG":"images\/345\/DSCN0720_original.JPG","voices\/32\/Tom_Petty_And_The_Heartbreakers_Learning_To_Fly_Version_1_original.mp3":"voices\/32\/Tom_Petty_And_The_Heartbreakers_Learning_To_Fly_Version_1_original.mp3"}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_Takova_normalni_rodinka\index.html
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_Takova_normalni_rodinka\index.html
VELIKOST: 957 B (957.00 B)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>eScrapBook</title>
<link href="images/favicon.ico" type="image/x-icon" rel="icon">
<link href="images/favicon.ico" type="image/x-icon" rel="shortcut icon">
<link rel="stylesheet" type="text/css" href="css/viewer.css">
<link rel="stylesheet" type="text/css" href="css/styles.css">
<script>
    var LocaleStrings = {};
</script>
<script type="text/javascript" src="js/libs-viewer.js"></script>
<script type="text/javascript" src="js/mykkro-viewer.js"></script></head>
<body>
<script>
// TODO dat do pluginu/widgetu/etc. a pridat ovladaci prvky
// udelat z toho neco jako BookViewerThing 
$(document).ready(function() {
	console.log("Ahoj");
	$.getJSON("book.json", function(json) {
    		console.log(json); // this will show the info it in firebug console
	});
});
</script>
<div id="fullscreen" style="width: 100%; height: 100%;">
</div>
</body>
</html>
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_Takova_normalni_rodinka\index2.html
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_Takova_normalni_rodinka\index2.html
VELIKOST: 9206 B (8.99 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>eScrapBook</title>
<link href="images/favicon.ico" type="image/x-icon" rel="icon">
<link href="images/favicon.ico" type="image/x-icon" rel="shortcut icon">
<link rel="stylesheet" type="text/css" href="css/viewer.css">
<link rel="stylesheet" type="text/css" href="css/styles.css">
<script>
    var LocaleStrings = {};
</script>
<script type="text/javascript" src="js/libs-viewer.js"></script>
<script type="text/javascript" src="js/mykkro-viewer.js"></script></head>
<script type="text/javascript" src="connector.js"></script>
<script type="text/javascript" src="logging.js"></script>
</head>
<body>
<script>
$(document).ready(function() {

    bookman_log({"message":"Logging enabled."})

    var book = {"type":"book","options":[],"slots":[{"type":"text-thing","options":{"html":"Slovensko - Vysok\u00e9 Tatry 2020","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},{"type":"grid-layout","options":{"rows":2,"columns":2,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/331\/DSCN0665_2_original.jpg","repeat":"no-repeat","position":"center center","color":"","size":"cover"}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"text-thing","options":{"html":"<p>Star&yacute; Smokovec &rArr; Hrebienok &rArr; Malou Studenou dolinou &rArr; p\u0159es Z&aacute;mkovsk&eacute;ho chatu &rArr; na Teryho chatu <span style=\"font-size:14px\"><strong>:)<\/strong><\/span><\/p>\r\n","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}},{"type":"text-thing","options":{"html":"Mlha \"na Blatech\"","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/347\/DSCN0666_2_original.jpg","repeat":"no-repeat","position":"center center","color":"","size":"cover"}}}}]},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"audio-decorator","options":{"ogg":"","mp3":"voices\/30\/Mumford_Sons_Hopeless_Wanderer_Official_Music_Video_original.mp3","uri":"voices\/30\/Mumford_Sons_Hopeless_Wanderer_Official_Music_Video_original.mp3","autoplay":true,"loop":false,"volume":50},"slots":{"content":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/333\/DSCN0669_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}}}},{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"video-thing","options":{"uri":"videos\/10\/video_1596110981_original.mp4","ogg":"","mp4":"videos\/10\/video_1596110981_original.mp4","webm":"","autoplay":true,"loop":true,"volume":20}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/334\/DSCN0670_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}]},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/335\/DSCN0679_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}},{"type":"grid-layout","options":{"rows":1,"columns":2,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/337\/DSCN0689_2_original.jpg","repeat":"no-repeat","position":"center center","color":"","size":"cover"}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"audio-decorator","options":{"ogg":"","mp3":"voices\/31\/Jelen_Abych_tu_zil_original.mp3","uri":"voices\/31\/Jelen_Abych_tu_zil_original.mp3","autoplay":true,"loop":false,"volume":50},"slots":{"content":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/336\/DSCN0685_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}}}}]},{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"text-thing","options":{"html":"<p><em><strong><span style=\"background-color:#800080\">\u010clenov&eacute; v&yacute;pravy :))<\/span><\/strong><\/em><\/p>\r\n\r\n<p>&nbsp;<\/p>\r\n","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/338\/DSCN0696_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}]},{"type":"split-layout","options":{"ratio":65,"gap":2,"horizontal":false},"slots":{"first":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/339\/DSCN0697_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}},"second":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"text-thing","options":{"html":"<h1><u><strong>Popradsk&eacute; pleso<\/strong><\/u><\/h1>\r\n\r\n<h3>- ledovcov&eacute; jezero v <em>Mengusovsk&eacute; dolin\u011b<\/em> ve Vysok&yacute;ch Tatr&aacute;ch<\/h3>\r\n","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}}}},{"type":"split-layout","options":{"ratio":33,"gap":2,"horizontal":false},"slots":{"first":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"text-thing","options":{"html":"<h1><u><strong>&#39;Nad mraky&#39;<\/strong><\/u><\/h1>\r\n\r\n<h3><em>- v&yacute;hled z Ostrvy<\/em><\/h3>\r\n","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}},"second":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/340\/DSCN0706_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"grid-layout","options":{"rows":2,"columns":2,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/341\/DSCN0708_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}},{"type":"text-thing","options":{"html":"Popradsk\u00e9 pleso z Ostrvy","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},{"type":"text-thing","options":{"html":"V\u00fdhled z Ostrvy","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/342\/DSCN0712_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}]},{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/343\/DSCN0716_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/344\/DSCN0717_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}]},{"type":"split-layout","options":{"ratio":33,"gap":2,"horizontal":false},"slots":{"first":{"type":"text-thing","options":{"html":"Batizovsk\u00e9 pleso pod Gerlachovsk\u00fdm \u0161t\u00edtem","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},"second":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/345\/DSCN0720_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"audio-decorator","options":{"ogg":"","mp3":"voices\/32\/Tom_Petty_And_The_Heartbreakers_Learning_To_Fly_Version_1_original.mp3","uri":"voices\/32\/Tom_Petty_And_The_Heartbreakers_Learning_To_Fly_Version_1_original.mp3","autoplay":true,"loop":false,"volume":75},"slots":{"content":{"type":"text-thing","options":{"html":"A tady na\u0161e v\u00fdprava kon\u010d\u00ed :)","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}}}}]};
    var bookView = new ExportBookViewer({data:book, fullscreen:true});
    bookView.init();
});
</script>
<div id="fullscreen" style="width: 100%; height: 100%;">
</div>
</body>
</html>
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_Takova_normalni_rodinka\logging.js
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_Takova_normalni_rodinka\logging.js
VELIKOST: 750 B (750.00 B)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
var bookman_log = function(data) {
  console.log(data);
}

if(bookman_connector && bookman_connector.connectorUrl) {
    console.log("Logging is available, target is "+bookman_connector.connectorUrl)
    var serialize = function(obj) {
      var str = [];
      for(var p in obj)
         str.push(encodeURIComponent(p) + "=" + encodeURIComponent(obj[p]));
      return str.join("&");
    }
    // use iframe...
    bookman_log = function(data) {
        var iframe = $("<iframe>").attr("src", bookman_connector.connectorUrl + "?" + serialize(data))
        $("#iframe-target").html(iframe)
    }
    $(function() {
      $("body").append('<div id="iframe-target" style="display:none">')
    })
} else {
    console.log("Logging is not available")
}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_Takova_normalni_rodinka\README
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_Takova_normalni_rodinka\README
VELIKOST: 44 B (44.00 B)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
This is automatically generated README file.
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_Takova_normalni_rodinka\RUNeScrapBook
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_Takova_normalni_rodinka\RUNeScrapBook
VELIKOST: 49 B (49.00 B)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
#!/bin/bash
chromium-browser --kiosk "index.html"
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_Takova_normalni_rodinka\RUNeScrapBook.bat
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_Takova_normalni_rodinka\RUNeScrapBook.bat
VELIKOST: 53 B (53.00 B)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
@echo off
start chrome.exe --kiosk "%~dp0index.html"
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_Takova_normalni_rodinka\wow.json
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_Takova_normalni_rodinka\wow.json
VELIKOST: 206 B (206.00 B)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
{
	"name": "wow-contrib-samplebook",
	"apptype": "wow/scrapbook",
	"title": "Iranische Kultur",
	"description": "Iranische Kultur for demonstration purposes.",
	"version": "0.1",
	"author": "Marek"
}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_Takova_normalni_rodinka\css\combined.css
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_Takova_normalni_rodinka\css\combined.css
VELIKOST: 31886 B (31.14 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
/* http://meyerweb.com/eric/tools/css/reset/ 
   v2.0b1 | 201101 
   NOTE: WORK IN PROGRESS
   USE WITH CAUTION AND TEST WITH ABANDON */

html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section, summary,
time, mark, audio, video {
	margin: 0;
	padding: 0;
	border: 0;
	outline: 0;
	font-size: 100%;
	font: inherit;
	vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section {
	display: block;
}
body {
	line-height: 1;
}
ol, ul {
	list-style: none;
}
blockquote, q {
	quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
	content: '';
	content: none;
}

/* remember to define visible focus styles! 
:focus {
	outline: ?????;
} */

/* remember to highlight inserts somehow! */
ins {
	text-decoration: none;
}
del {
	text-decoration: line-through;
}

table {
	border-collapse: collapse;
	border-spacing: 0;
}
/*
 * qTip2 - Pretty powerful tooltips - v2.1.1
 * http://qtip2.com
 *
 * Copyright (c) 2013 Craig Michael Thompson
 * Released under the MIT, GPL licenses
 * http://jquery.org/license
 *
 * Date: Sat Jul 20 2013 02:23 UTC+0000
 * Plugins: tips svg modal
 * Styles: basic css3
 */
.qtip{
	position: absolute;
	left: -28000px;
	top: -28000px;
	display: none;

	max-width: 280px;
	min-width: 50px;
	
	font-size: 10.5px;
	line-height: 12px;

	direction: ltr;

	box-shadow: none;
	padding: 0;
}

	.qtip-content{
		position: relative;
		padding: 5px 9px;
		overflow: hidden;

		text-align: left;
		word-wrap: break-word;
	}

	.qtip-titlebar{
		position: relative;
		padding: 5px 35px 5px 10px;
		overflow: hidden;

		border-width: 0 0 1px;
		font-weight: bold;
	}

	.qtip-titlebar + .qtip-content{ border-top-width: 0 !important; }

	/* Default close button class */
	.qtip-close{
		position: absolute;
		right: -9px; top: -9px;

		cursor: pointer;
		outline: medium none;

		border-width: 1px;
		border-style: solid;
		border-color: transparent;
	}

		.qtip-titlebar .qtip-close{
			right: 4px; top: 50%;
			margin-top: -9px;
		}
	
		* html .qtip-titlebar .qtip-close{ top: 16px; } /* IE fix */

		.qtip-titlebar .ui-icon,
		.qtip-icon .ui-icon{
			display: block;
			text-indent: -1000em;
			direction: ltr;
		}

		.qtip-icon, .qtip-icon .ui-icon{
			-moz-border-radius: 3px;
			-webkit-border-radius: 3px;
			border-radius: 3px;
			text-decoration: none;
		}

			.qtip-icon .ui-icon{
				width: 18px;
				height: 14px;

				line-height: 14px;
				text-align: center;
				text-indent: 0;
				font: normal bold 10px/13px Tahoma,sans-serif;

				color: inherit;
				background: transparent none no-repeat -100em -100em;
			}

/* Applied to 'focused' tooltips e.g. most recently displayed/interacted with */
.qtip-focus{}

/* Applied on hover of tooltips i.e. added/removed on mouseenter/mouseleave respectively */
.qtip-hover{}

/* Default tooltip style */
.qtip-default{
	border-width: 1px;
	border-style: solid;
	border-color: #F1D031;

	background-color: #FFFFA3;
	color: #555;
}

	.qtip-default .qtip-titlebar{
		background-color: #FFEF93;
	}

	.qtip-default .qtip-icon{
		border-color: #CCC;
		background: #F1F1F1;
		color: #777;
	}
	
	.qtip-default .qtip-titlebar .qtip-close{
		border-color: #AAA;
		color: #111;
	}



/*! Light tooltip style */
.qtip-light{
	background-color: white;
	border-color: #E2E2E2;
	color: #454545;
}

	.qtip-light .qtip-titlebar{
		background-color: #f1f1f1;
	}


/*! Dark tooltip style */
.qtip-dark{
	background-color: #505050;
	border-color: #303030;
	color: #f3f3f3;
}

	.qtip-dark .qtip-titlebar{
		background-color: #404040;
	}

	.qtip-dark .qtip-icon{
		border-color: #444;
	}

	.qtip-dark .qtip-titlebar .ui-state-hover{
		border-color: #303030;
	}


/*! Cream tooltip style */
.qtip-cream{
	background-color: #FBF7AA;
	border-color: #F9E98E;
	color: #A27D35;
}

	.qtip-cream .qtip-titlebar{
		background-color: #F0DE7D;
	}

	.qtip-cream .qtip-close .qtip-icon{
		background-position: -82px 0;
	}


/*! Red tooltip style */
.qtip-red{
	background-color: #F78B83;
	border-color: #D95252;
	color: #912323;
}

	.qtip-red .qtip-titlebar{
		background-color: #F06D65;
	}

	.qtip-red .qtip-close .qtip-icon{
		background-position: -102px 0;
	}

	.qtip-red .qtip-icon{
		border-color: #D95252;
	}

	.qtip-red .qtip-titlebar .ui-state-hover{
		border-color: #D95252;
	}


/*! Green tooltip style */
.qtip-green{
	background-color: #CAED9E;
	border-color: #90D93F;
	color: #3F6219;
}

	.qtip-green .qtip-titlebar{
		background-color: #B0DE78;
	}

	.qtip-green .qtip-close .qtip-icon{
		background-position: -42px 0;
	}


/*! Blue tooltip style */
.qtip-blue{
	background-color: #E5F6FE;
	border-color: #ADD9ED;
	color: #5E99BD;
}

	.qtip-blue .qtip-titlebar{
		background-color: #D0E9F5;
	}

	.qtip-blue .qtip-close .qtip-icon{
		background-position: -2px 0;
	}



.qtip-shadow{
	-webkit-box-shadow: 1px 1px 3px 1px rgba(0, 0, 0, 0.15);
	-moz-box-shadow: 1px 1px 3px 1px rgba(0, 0, 0, 0.15);
	box-shadow: 1px 1px 3px 1px rgba(0, 0, 0, 0.15);
}

/* Add rounded corners to your tooltips in: FF3+, Chrome 2+, Opera 10.6+, IE9+, Safari 2+ */
.qtip-rounded,
.qtip-tipsy,
.qtip-bootstrap{
	-moz-border-radius: 5px;
	-webkit-border-radius: 5px;
	border-radius: 5px;
}

.qtip-rounded .qtip-titlebar{
	-moz-border-radius: 4px 4px 0 0;
	-webkit-border-radius: 4px 4px 0 0;
	border-radius: 4px 4px 0 0;
}

/* Youtube tooltip style */
.qtip-youtube{
	-moz-border-radius: 2px;
	-webkit-border-radius: 2px;
	border-radius: 2px;
	
	-webkit-box-shadow: 0 0 3px #333;
	-moz-box-shadow: 0 0 3px #333;
	box-shadow: 0 0 3px #333;

	color: white;
	border-width: 0;

	background: #4A4A4A;
	background-image: -webkit-gradient(linear,left top,left bottom,color-stop(0,#4A4A4A),color-stop(100%,black));
	background-image: -webkit-linear-gradient(top,#4A4A4A 0,black 100%);
	background-image: -moz-linear-gradient(top,#4A4A4A 0,black 100%);
	background-image: -ms-linear-gradient(top,#4A4A4A 0,black 100%);
	background-image: -o-linear-gradient(top,#4A4A4A 0,black 100%);
}

	.qtip-youtube .qtip-titlebar{
		background-color: #4A4A4A;
		background-color: rgba(0,0,0,0);
	}
	
	.qtip-youtube .qtip-content{
		padding: .75em;
		font: 12px arial,sans-serif;
		
		filter: progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr=#4a4a4a,EndColorStr=#000000);
		-ms-filter: "progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr=#4a4a4a,EndColorStr=#000000);";
	}

	.qtip-youtube .qtip-icon{
		border-color: #222;
	}

	.qtip-youtube .qtip-titlebar .ui-state-hover{
		border-color: #303030;
	}


/* jQuery TOOLS Tooltip style */
.qtip-jtools{
	background: #232323;
	background: rgba(0, 0, 0, 0.7);
	background-image: -webkit-gradient(linear, left top, left bottom, from(#717171), to(#232323));
	background-image: -moz-linear-gradient(top, #717171, #232323);
	background-image: -webkit-linear-gradient(top, #717171, #232323);
	background-image: -ms-linear-gradient(top, #717171, #232323);
	background-image: -o-linear-gradient(top, #717171, #232323);

	border: 2px solid #ddd;
	border: 2px solid rgba(241,241,241,1);

	-moz-border-radius: 2px;
	-webkit-border-radius: 2px;
	border-radius: 2px;

	-webkit-box-shadow: 0 0 12px #333;
	-moz-box-shadow: 0 0 12px #333;
	box-shadow: 0 0 12px #333;
}

	/* IE Specific */
	.qtip-jtools .qtip-titlebar{
		background-color: transparent;
		filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#717171,endColorstr=#4A4A4A);
		-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#717171,endColorstr=#4A4A4A)";
	}
	.qtip-jtools .qtip-content{
		filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#4A4A4A,endColorstr=#232323);
		-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#4A4A4A,endColorstr=#232323)";
	}

	.qtip-jtools .qtip-titlebar,
	.qtip-jtools .qtip-content{
		background: transparent;
		color: white;
		border: 0 dashed transparent;
	}

	.qtip-jtools .qtip-icon{
		border-color: #555;
	}

	.qtip-jtools .qtip-titlebar .ui-state-hover{
		border-color: #333;
	}


/* Cluetip style */
.qtip-cluetip{
	-webkit-box-shadow: 4px 4px 5px rgba(0, 0, 0, 0.4);
	-moz-box-shadow: 4px 4px 5px rgba(0, 0, 0, 0.4);
	box-shadow: 4px 4px 5px rgba(0, 0, 0, 0.4);

	background-color: #D9D9C2;
	color: #111;
	border: 0 dashed transparent;
}

	.qtip-cluetip .qtip-titlebar{
		background-color: #87876A;
		color: white;
		border: 0 dashed transparent;
	}
	
	.qtip-cluetip .qtip-icon{
		border-color: #808064;
	}
	
	.qtip-cluetip .qtip-titlebar .ui-state-hover{
		border-color: #696952;
		color: #696952;
	}


/* Tipsy style */
.qtip-tipsy{
	background: black;
	background: rgba(0, 0, 0, .87);

	color: white;
	border: 0 solid transparent;

	font-size: 11px;
	font-family: 'Lucida Grande', sans-serif;
	font-weight: bold;
	line-height: 16px;
	text-shadow: 0 1px black;
}

	.qtip-tipsy .qtip-titlebar{
		padding: 6px 35px 0 10px;
		background-color: transparent;
	}

	.qtip-tipsy .qtip-content{
		padding: 6px 10px;
	}
	
	.qtip-tipsy .qtip-icon{
		border-color: #222;
		text-shadow: none;
	}

	.qtip-tipsy .qtip-titlebar .ui-state-hover{
		border-color: #303030;
	}


/* Tipped style */
.qtip-tipped{
	border: 3px solid #959FA9;

	-moz-border-radius: 3px;
	-webkit-border-radius: 3px;
	border-radius: 3px;

	background-color: #F9F9F9;
	color: #454545;

	font-weight: normal;
	font-family: serif;
}

	.qtip-tipped .qtip-titlebar{
		border-bottom-width: 0;

		color: white;
		background: #3A79B8;
		background-image: -webkit-gradient(linear, left top, left bottom, from(#3A79B8), to(#2E629D));
		background-image: -webkit-linear-gradient(top, #3A79B8, #2E629D);
		background-image: -moz-linear-gradient(top, #3A79B8, #2E629D);
		background-image: -ms-linear-gradient(top, #3A79B8, #2E629D);
		background-image: -o-linear-gradient(top, #3A79B8, #2E629D);
		filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#3A79B8,endColorstr=#2E629D);
		-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#3A79B8,endColorstr=#2E629D)";
	}

	.qtip-tipped .qtip-icon{
		border: 2px solid #285589;
		background: #285589;
	}

		.qtip-tipped .qtip-icon .ui-icon{
			background-color: #FBFBFB;
			color: #555;
		}


/**
 * Twitter Bootstrap style.
 *
 * Tested with IE 8, IE 9, Chrome 18, Firefox 9, Opera 11.
 * Does not work with IE 7.
 */
.qtip-bootstrap{
	/** Taken from Bootstrap body */
	font-size: 14px;
	line-height: 20px;
	color: #333333;

	/** Taken from Bootstrap .popover */
	padding: 1px;
	background-color: #ffffff;
	border: 1px solid #ccc;
	border: 1px solid rgba(0, 0, 0, 0.2);
	-webkit-border-radius: 6px;
	-moz-border-radius: 6px;
	border-radius: 6px;
	-webkit-box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
	-moz-box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
	box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
	-webkit-background-clip: padding-box;
	-moz-background-clip: padding;
	background-clip: padding-box;
}

	.qtip-bootstrap .qtip-titlebar{
		/** Taken from Bootstrap .popover-title */
		padding: 8px 14px;
		margin: 0;
		font-size: 14px;
		font-weight: normal;
		line-height: 18px;
		background-color: #f7f7f7;
		border-bottom: 1px solid #ebebeb;
		-webkit-border-radius: 5px 5px 0 0;
		-moz-border-radius: 5px 5px 0 0;
		border-radius: 5px 5px 0 0;
	}

		.qtip-bootstrap .qtip-titlebar .qtip-close{
			/**
			 * Overrides qTip2:
			 * .qtip-titlebar .qtip-close{
			 *   [...]
			 *   right: 4px;
			 *   top: 50%;
			 *   [...]
			 *   border-style: solid;
			 * }
			 */
			right: 11px;
			top: 45%;
			border-style: none;
		}

	.qtip-bootstrap .qtip-content{
		/** Taken from Bootstrap .popover-content */
		padding: 9px 14px;
	}

	.qtip-bootstrap .qtip-icon{
		/**
		 * Overrides qTip2:
		 * .qtip-default .qtip-icon {
		 *   border-color: #CCC;
		 *   background: #F1F1F1;
		 *   color: #777;
		 * }
		 */
		background: transparent;
	}

		.qtip-bootstrap .qtip-icon .ui-icon{
			/**
			 * Overrides qTip2:
			 * .qtip-icon .ui-icon{
			 *   width: 18px;
			 *   height: 14px;
			 * }
			 */
			width: auto;
			height: auto;

			/* Taken from Bootstrap .close */
			float: right;
			font-size: 20px;
			font-weight: bold;
			line-height: 18px;
			color: #000000;
			text-shadow: 0 1px 0 #ffffff;
			opacity: 0.2;
			filter: alpha(opacity=20);
		}

		.qtip-bootstrap .qtip-icon .ui-icon:hover{
			/* Taken from Bootstrap .close:hover */
			color: #000000;
			text-decoration: none;
			cursor: pointer;
			opacity: 0.4;
			filter: alpha(opacity=40);
		}


/* IE9 fix - removes all filters */
.qtip:not(.ie9haxors) div.qtip-content,
.qtip:not(.ie9haxors) div.qtip-titlebar{
	filter: none;
	-ms-filter: none;
}



.qtip .qtip-tip{
	margin: 0 auto;
	overflow: hidden;
	z-index: 10;
	
}

	/* Opera bug #357 - Incorrect tip position
	https://github.com/Craga89/qTip2/issues/367 */
	x:-o-prefocus, .qtip .qtip-tip{
		visibility: hidden;
	}

	.qtip .qtip-tip,
	.qtip .qtip-tip .qtip-vml,
	.qtip .qtip-tip canvas{
		position: absolute;

		color: #123456;
		background: transparent;
		border: 0 dashed transparent;
	}
	
	.qtip .qtip-tip canvas{ top: 0; left: 0; }

	.qtip .qtip-tip .qtip-vml{
		behavior: url(#default#VML);
		display: inline-block;
		visibility: visible;
	}

#qtip-overlay{
	position: fixed;
	left: -10000em;
	top: -10000em;
}

	/* Applied to modals with show.modal.blur set to true */
	#qtip-overlay.blurs{ cursor: pointer; }

	/* Change opacity of overlay here */
	#qtip-overlay div{
		position: absolute;
		left: 0; top: 0;
		width: 100%; height: 100%;

		background-color: black;

		opacity: 0.7;
		filter:alpha(opacity=70);
		-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=70)";
	}


.jsoneditor-field, .jsoneditor-value, .jsoneditor-field-readonly, .jsoneditor-readonly {
    border: 1px solid transparent;
    min-height: 16px;
    min-width: 24px;
    padding: 2px;
    margin: 1px;
    outline: none;
    word-wrap: break-word;
    float: left;
}

/* adjust margin of p elements inside editable divs, needed for Opera, IE */
.jsoneditor-field p, .jsoneditor-value p {
    margin: 0;
}

.jsoneditor-value {
    word-break: break-word;
}

.jsoneditor-empty {
    background-color: #E5E5E5;
    border-radius: 2px;
}

.jsoneditor-separator {
    padding: 3px 0;
    vertical-align: top;
}

.jsoneditor-value:focus, .jsoneditor-field:focus,
        .jsoneditor-value:hover, .jsoneditor-field:hover,
        .jsoneditor-search-highlight {
    background-color: #FFFFAB;
    border: 1px solid yellow;
    border-radius: 2px;
}

.jsoneditor-search-highlight-active,
        .jsoneditor-search-highlight-active:focus,
        .jsoneditor-search-highlight-active:hover {
    background-color: #ffee00;
    border: 1px solid #ffc700;
    border-radius: 2px;
}

.jsoneditor-field-readonly:hover {
    border: 1px solid white;
}

.jsoneditor-readonly {
    color: gray;
}

button.jsoneditor-remove, button.jsoneditor-append, button.jsoneditor-duplicate,
button.jsoneditor-collapsed, button.jsoneditor-expanded,
button.jsoneditor-invisible, button.jsoneditor-dragarea,
button.jsoneditor-type-auto, button.jsoneditor-type-string,
button.jsoneditor-type-array, button.jsoneditor-type-object {
    width: 24px;
    height: 24px;
    padding: 0;
    margin: 0;
    border: none;
    cursor: pointer;
    background: url('../img/jsoneditor-icons.png');
}

button:disabled {
    color: #808080;
}

button.jsoneditor-collapsed {
    background-position: -168px 0;
}

button.jsoneditor-expanded {
    background-position: -168px -24px;
}

button.jsoneditor-invisible {
    visibility: hidden;
    background: none;
}

button.jsoneditor-collapsed, button.jsoneditor-expanded,
button.jsoneditor-invisible {
    float: left;
}

button.jsoneditor-remove {
    background-position: -24px -24px;
}
button.jsoneditor-remove:hover {
    background-position: -24px 0;
}

button.jsoneditor-append {
    background-position: 0 -24px;
}
button.jsoneditor-append:hover {
    background-position: 0 0;
}

button.jsoneditor-duplicate {
    background-position: -48px -24px;
}
button.jsoneditor-duplicate:hover {
    background-position: -48px 0;
}

button.jsoneditor-type-string {
    background-position: -144px -24px;
}
button.jsoneditor-type-string:hover {
    background-position: -144px 0;
}

button.jsoneditor-type-auto {
    background-position: -120px -24px;
}
button.jsoneditor-type-auto:hover {
    background-position: -120px 0;
}

button.jsoneditor-type-object {
    background-position: -72px -24px;
}
button.jsoneditor-type-object:hover {
    background-position: -72px 0;
}

button.jsoneditor-type-array {
    background-position: -96px -24px;
}
button.jsoneditor-type-array:hover {
    background-position: -96px 0;
}

div.jsoneditor-select {
    border: 1px solid gray;
    background-color: white;
    box-shadow: 4px 4px 10px rgba(128, 128, 128, 0.5);
}

div.jsoneditor-option {
    color: #4D4D4D;
    background-color: white;

    border: none;
    margin: 0;
    display: block;
    text-align: left;
    cursor: pointer;
}
div.jsoneditor-option:hover {
    background-color: #FFFFAB;
    color: #1A1A1A;
}
div.jsoneditor-option-selected {
    background-color: #D5DDF6;
}
div.jsoneditor-option-text {
    height: 24px;
    line-height: 24px;
    padding: 0 12px 0 0;
    display: inline-block;
}

div.jsoneditor-option-string, div.jsoneditor-option-auto,
div.jsoneditor-option-object, div.jsoneditor-option-array {
    float: left;
    width: 24px;
    height: 24px;
    display: inline-block;
    background: url('../img/jsoneditor-icons.png');
}
div.jsoneditor-option-string {
    background-position: -144px 0;
}
div.jsoneditor-option-auto {
    background-position: -120px 0;
}
div.jsoneditor-option-object {
    background-position: -72px 0;
}
div.jsoneditor-option-array {
    background-position: -96px 0;
}


div.jsoneditor-frame {
    color: #1A1A1A;
    border: 1px solid #97B0F8;
    box-sizing: border-box;
    width: 100%;
    height: 100%;
    overflow: auto;
    position: relative;
    padding: 0;
}

table.jsoneditor-table {
    border-collapse: collapse;
    border-spacing: 0;
    width: 100%;
    margin: 0;
}

div.jsoneditor-content-outer, div.jsonformatter-content {
    width: 100%;
    height: 100%;
    margin: -35px 0 0 0;
    padding: 35px 0 0 0;

    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;

    overflow: hidden;
}

div.jsoneditor-content {
    width: 100%;
    height: 100%;
    position: relative;
    overflow: auto;
}

textarea.jsonformatter-textarea {
    width: 100%;
    height: 100%;
    margin: 0;

    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;

    border: none;
    background-color: white;
    resize: none;
}

tr.jsoneditor-tr-highlight {
    background-color: #FFFFAB;
}

button.jsoneditor-dragarea {
    width: 16px;
    height: 24px;
    /*
    margin: 3px 0;
    background: url('img/dots_gray.gif') top center;
    background-repeat: repeat-y;
    */
    background: url('../img/jsoneditor-icons.png') -220px 0;

    display: block;
    cursor: move;
}

div.jsoneditor-menu {
    width: 100%;
    height: 35px;
    padding: 2px;
    margin: 0;
    overflow: hidden;
    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;

    color: #1A1A1A;
    background-color: #D5DDF6;
    border-bottom: 1px solid #97B0F8;
}

table.jsoneditor-search {
    position: absolute;
    right: 2px;
    top: 2px;
}

table.jsoneditor-search-input {
    border-collapse: collapse;
}

div.jsoneditor-search {
    border: 1px solid #97B0F8;
    background-color: white;
    padding: 0 2px;
    margin: 0;
}

input.jsoneditor-search {
    width: 120px;
    border: none;
    outline: none;
    margin: 1px;
}

div.jsoneditor-search-results {
    color: #4d4d4d;
    padding-right: 5px;
}

button.jsoneditor-search-refresh, button.jsoneditor-search-next,
        button.jsoneditor-search-previous {
    width: 16px;
    height: 24px;
    padding: 0;
    margin: 0;
    border: none;
    background: url('../img/jsoneditor-icons.png');
    vertical-align: top;
}

button.jsoneditor-search-refresh {
    width: 18px;
    background-position: -243px -25px;
}

button.jsoneditor-search-next {
    cursor: pointer;
    background-position: -268px -25px;
}
button.jsoneditor-search-next:hover {
    background-position: -268px -1px;
}

button.jsoneditor-search-previous {
    cursor: pointer;
    background-position: -292px -25px;
    margin-right: 2px;
}
button.jsoneditor-search-previous:hover {
    background-position: -292px -1px;
}


button.jsoneditor-menu {
    width: 26px;
    height: 26px;
    margin: 2px;
    padding: 2px;
    border-radius: 2px;
    border: 1px solid #aec0f8;
    background: #e3eaf6 url('../img/jsoneditor-icons.png');
}

button.jsoneditor-menu:hover {
    background-color: #f0f2f5;
}
button.jsoneditor-menu:active {
    background-color: #ffffff;
}
button.jsoneditor-menu:disabled {
    background-color: #e3eaf6;
}

button.jsoneditor-collapse-all {
    background-position: -312px 0;
}
button.jsoneditor-expand-all {
    background-position: -312px -24px;
}
button.jsoneditor-undo {
    background-position: -336px 0;
}
button.jsoneditor-redo {
    background-position: -360px 0;
}
button.jsoneditor-undo:disabled {
    background-position: -336px -24px;
}
button.jsoneditor-redo:disabled {
    background-position: -360px -24px;
}
/* TODO: css for button:disabled is not supported by IE8 */
button.jsoneditor-compact {
    background-position: -384px 0;
}
button.jsoneditor-format {
    background-position: -384px -24px;
}


tr, th, td {
    padding: 0;
    margin: 0;
}

td.jsoneditor-td {
    vertical-align: top;
}

td.jsoneditor-td {
    padding: 0 3px;
}

td.jsoneditor-td-edit {
    background-color: #F5F5F5;
    padding: 0;
}

td.jsoneditor-td-tree {
    vertical-align: top;
}

td.jsoneditor-droparea {
    height: 24px;

    border-top: 1px dashed gray;
    border-bottom: 1px dashed gray;
    background-color: #FFFF80;
}

.jsoneditor-field, .jsoneditor-value, .jsoneditor-td, .jsoneditor-th,
.jsoneditor-type,
.jsonformatter-textarea {
    font-family: droid sans mono, monospace, courier new, courier, sans-serif;
    font-size: 10pt;
    color: #1A1A1A;
}

.jsoneditor-hidden-focus {
    position: absolute;
    left: -1000px;
    top: -1000px;
    border: none;
    outline: none;
}
.toolbar-wrapper {
    display: block;
    position: relative;
}

.toolbar {
    position: absolute;
    bottom: 0;
    right: 0;
    border-radius: 5px; 
    -moz-border-radius: 5px; 
    -webkit-border-radius: 5px; 
    border: 1px solid gray;
    background-color: lightgray;
}


.my-tooltip {
	display: inline;
	position: relative;
}

.my-tooltip:hover:after{
	background: #333;
	background: rgba(0,0,0,.8);
	border-radius: 5px;
	bottom: 26px;
	color: #fff;
	content: attr(data-title);
	left: 20%;
	padding: 5px 15px;
	position: absolute;
	z-index: 98;
    width: 180px;
}

.my-tooltip:hover:before{
	border: solid;
	border-color: #333 transparent;
	border-width: 6px 6px 0 6px;
	bottom: 20px;
	content: "";
	left: 50%;
	position: absolute;
	z-index: 99;
}


/*
.icon-default.icon-hover {
    background-image: url(../images/icons/32/Redo.png);
}
*/


.syntaxhighlighter a,
.syntaxhighlighter div,
.syntaxhighlighter code,
.syntaxhighlighter table,
.syntaxhighlighter table td,
.syntaxhighlighter table tr,
.syntaxhighlighter table tbody,
.syntaxhighlighter table thead,
.syntaxhighlighter table caption,
.syntaxhighlighter textarea {
  -moz-border-radius: 0 0 0 0 !important;
  -webkit-border-radius: 0 0 0 0 !important;
  background: none !important;
  border: 0 !important;
  bottom: auto !important;
  float: none !important;
  height: auto !important;
  left: auto !important;
  line-height: 1.1em !important;
  margin: 0 !important;
  outline: 0 !important;
  overflow: visible !important;
  padding: 0 !important;
  position: static !important;
  right: auto !important;
  text-align: left !important;
  top: auto !important;
  vertical-align: baseline !important;
  width: auto !important;
  box-sizing: content-box !important;
  font-family: "Consolas", "Bitstream Vera Sans Mono", "Courier New", Courier, monospace !important;
  font-weight: normal !important;
  font-style: normal !important;
  font-size: 1em !important;
  min-height: inherit !important;
  min-height: auto !important;
}

.syntaxhighlighter {
  width: 100% !important;
  margin: 1em 0 1em 0 !important;
  position: relative !important;
  overflow-x: auto !important;
  overflow-y: hidden !important;
  font-size: 1em !important;
}
.syntaxhighlighter.source {
  overflow: hidden !important;
}
.syntaxhighlighter .bold {
  font-weight: bold !important;
}
.syntaxhighlighter .italic {
  font-style: italic !important;
}
.syntaxhighlighter .line {
  white-space: pre !important;
}
.syntaxhighlighter table {
  width: 100% !important;
}
.syntaxhighlighter table caption {
  text-align: left !important;
  padding: .5em 0 0.5em 1em !important;
}
.syntaxhighlighter table td.code {
  width: 100% !important;
}
.syntaxhighlighter table td.code .container {
  position: relative !important;
}
.syntaxhighlighter table td.code .container textarea {
  box-sizing: border-box !important;
  position: absolute !important;
  left: 0 !important;
  top: 0 !important;
  width: 100% !important;
  height: 100% !important;
  border: none !important;
  background: white !important;
  padding-left: 1em !important;
  overflow: hidden !important;
  white-space: pre !important;
}
.syntaxhighlighter table td.gutter .line {
  text-align: right !important;
  padding: 0 0.5em 0 1em !important;
}
.syntaxhighlighter table td.code .line {
  padding: 0 1em !important;
}
.syntaxhighlighter.nogutter td.code .container textarea, .syntaxhighlighter.nogutter td.code .line {
  padding-left: 0em !important;
}
.syntaxhighlighter.show {
  display: block !important;
}
.syntaxhighlighter.collapsed table {
  display: none !important;
}
.syntaxhighlighter.collapsed .toolbar {
  padding: 0.1em 0.8em 0em 0.8em !important;
  font-size: 1em !important;
  position: static !important;
  width: auto !important;
  height: auto !important;
}
.syntaxhighlighter.collapsed .toolbar span {
  display: inline !important;
  margin-right: 1em !important;
}
.syntaxhighlighter.collapsed .toolbar span a {
  padding: 0 !important;
  display: none !important;
}
.syntaxhighlighter.collapsed .toolbar span a.expandSource {
  display: inline !important;
}
.syntaxhighlighter .toolbar {
  position: absolute !important;
  right: 1px !important;
  top: 1px !important;
  width: 11px !important;
  height: 11px !important;
  font-size: 10px !important;
  z-index: 10 !important;
}
.syntaxhighlighter .toolbar span.title {
  display: inline !important;
}
.syntaxhighlighter .toolbar a {
  display: block !important;
  text-align: center !important;
  text-decoration: none !important;
  padding-top: 1px !important;
}
.syntaxhighlighter .toolbar a.expandSource {
  display: none !important;
}
.syntaxhighlighter.ie {
  font-size: .9em !important;
  padding: 1px 0 1px 0 !important;
}
.syntaxhighlighter.ie .toolbar {
  line-height: 8px !important;
}
.syntaxhighlighter.ie .toolbar a {
  padding-top: 0px !important;
}
.syntaxhighlighter.printing .line.alt1 .content,
.syntaxhighlighter.printing .line.alt2 .content,
.syntaxhighlighter.printing .line.highlighted .number,
.syntaxhighlighter.printing .line.highlighted.alt1 .content,
.syntaxhighlighter.printing .line.highlighted.alt2 .content {
  background: none !important;
}
.syntaxhighlighter.printing .line .number {
  color: #bbbbbb !important;
}
.syntaxhighlighter.printing .line .content {
  color: black !important;
}
.syntaxhighlighter.printing .toolbar {
  display: none !important;
}
.syntaxhighlighter.printing a {
  text-decoration: none !important;
}
.syntaxhighlighter.printing .plain, .syntaxhighlighter.printing .plain a {
  color: black !important;
}
.syntaxhighlighter.printing .comments, .syntaxhighlighter.printing .comments a {
  color: #008200 !important;
}
.syntaxhighlighter.printing .string, .syntaxhighlighter.printing .string a {
  color: blue !important;
}
.syntaxhighlighter.printing .keyword {
  color: #006699 !important;
  font-weight: bold !important;
}
.syntaxhighlighter.printing .preprocessor {
  color: gray !important;
}
.syntaxhighlighter.printing .variable {
  color: #aa7700 !important;
}
.syntaxhighlighter.printing .value {
  color: #009900 !important;
}
.syntaxhighlighter.printing .functions {
  color: #ff1493 !important;
}
.syntaxhighlighter.printing .constants {
  color: #0066cc !important;
}
.syntaxhighlighter.printing .script {
  font-weight: bold !important;
}
.syntaxhighlighter.printing .color1, .syntaxhighlighter.printing .color1 a {
  color: gray !important;
}
.syntaxhighlighter.printing .color2, .syntaxhighlighter.printing .color2 a {
  color: #ff1493 !important;
}
.syntaxhighlighter.printing .color3, .syntaxhighlighter.printing .color3 a {
  color: red !important;
}
.syntaxhighlighter.printing .break, .syntaxhighlighter.printing .break a {
  color: black !important;
}
.syntaxhighlighter {
  background-color: white !important;
}
.syntaxhighlighter .line.alt1 {
  background-color: white !important;
}
.syntaxhighlighter .line.alt2 {
  background-color: white !important;
}
.syntaxhighlighter .line.highlighted.alt1, .syntaxhighlighter .line.highlighted.alt2 {
  background-color: #e0e0e0 !important;
}
.syntaxhighlighter .line.highlighted.number {
  color: black !important;
}
.syntaxhighlighter table caption {
  color: black !important;
}
.syntaxhighlighter .gutter {
  color: #afafaf !important;
}
.syntaxhighlighter .gutter .line {
  border-right: 3px solid #6ce26c !important;
}
.syntaxhighlighter .gutter .line.highlighted {
  background-color: #6ce26c !important;
  color: white !important;
}
.syntaxhighlighter.printing .line .content {
  border: none !important;
}
.syntaxhighlighter.collapsed {
  overflow: visible !important;
}
.syntaxhighlighter.collapsed .toolbar {
  color: blue !important;
  background: white !important;
  border: 1px solid #6ce26c !important;
}
.syntaxhighlighter.collapsed .toolbar a {
  color: blue !important;
}
.syntaxhighlighter.collapsed .toolbar a:hover {
  color: red !important;
}
.syntaxhighlighter .toolbar {
  color: white !important;
  background: #6ce26c !important;
  border: none !important;
}
.syntaxhighlighter .toolbar a {
  color: white !important;
}
.syntaxhighlighter .toolbar a:hover {
  color: black !important;
}
.syntaxhighlighter .plain, .syntaxhighlighter .plain a {
  color: black !important;
}
.syntaxhighlighter .comments, .syntaxhighlighter .comments a {
  color: #008200 !important;
}
.syntaxhighlighter .string, .syntaxhighlighter .string a {
  color: blue !important;
}
.syntaxhighlighter .keyword {
  color: #006699 !important;
}
.syntaxhighlighter .preprocessor {
  color: gray !important;
}
.syntaxhighlighter .variable {
  color: #aa7700 !important;
}
.syntaxhighlighter .value {
  color: #009900 !important;
}
.syntaxhighlighter .functions {
  color: #ff1493 !important;
}
.syntaxhighlighter .constants {
  color: #0066cc !important;
}
.syntaxhighlighter .script {
  font-weight: bold !important;
  color: #006699 !important;
  background-color: none !important;
}
.syntaxhighlighter .color1, .syntaxhighlighter .color1 a {
  color: gray !important;
}
.syntaxhighlighter .color2, .syntaxhighlighter .color2 a {
  color: #ff1493 !important;
}
.syntaxhighlighter .color3, .syntaxhighlighter .color3 a {
  color: red !important;
}

.syntaxhighlighter .keyword {
  font-weight: bold !important;
}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_Takova_normalni_rodinka\css\styles.css
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_Takova_normalni_rodinka\css\styles.css
VELIKOST: 50381 B (49.20 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
.hello-widget .area{width:200px;height:200px;background-color:#abc;display:block;position:relative;cursor:crosshair;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.hello-widget .pointer{position:absolute;left:0px;top:0px;width:10px;height:10px;background-color:blue;cursor:crosshair;-webkit-border-radius:5px;-moz-border-radius:5px;border-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:5px;padding:10px}.hello-widget .coords{height:10%;padding-top:45%;text-align:center;width:100%;cursor:crosshair;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.my-paddy{width:100px;height:100px;background-color:orange;position:relative}.my-paddy > .my-paddy-picker{width:10px;height:10px;background-color:blue;position:absolute}.jsoneditor-widget{background-color:white}.fiddles.form .textarea textarea{width:400px;height:200px;font-family:monospace;font-size:12px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.fiddles.form .jsoneditor-widget{width:400px}.editable-editor .fieldset fieldset{border:none;padding:0px}.ui-mykkro-fieldset,.ui-mykkro-titled,.ui-mykkro-optional{margin-bottom:5px}.ui-mykkro-fieldset > .ui-widget-header,.ui-mykkro-titled > .ui-widget-header,.ui-mykkro-optional > .ui-widget-header{padding:3px;position:relative;background:#ccc;color:black;border-color:#aaa}.ui-mykkro-fieldset > .ui-widget-content,.ui-mykkro-titled > .ui-widget-content,.ui-mykkro-optional > .ui-widget-content{padding:3px 20px;position:relative;background:#ddd;border-color:#aaa}.ui-mykkro-fieldset legend{display:block;width:100%;margin:0;padding:0;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.slider input{text-align:center;width:50px}.mykkro-thing{display:block;width:100%;height:100%;overflow:hidden}.mykkro-html{overflow:hidden;position:relative}.mykkro-html > div{overflow:hidden;position:absolute;width:100%}.mykkro-ajax{width:auto;height:auto}.mykkro-empty{background-color:#aaa;border:1px solid #666;display:-moz-box;-moz-box-orient:horizontal;-moz-box-pack:center;-moz-box-align:center;display:-webkit-box;-webkit-box-orient:horizontal;-webkit-box-pack:center;-webkit-box-align:center;display:box;box-orient:horizontal;box-pack:center;box-align:center;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;font-size:12px;opacity:0.7}.mykkro-editable > .editable-pane{width:385px;height:530px;display:inline-block;padding:10px;border:1px gray solid}.mykkro-editable > .editable-editor{width:392px;height:540px;display:inline-block;vertical-align:top;margin-left:12px;overflow:auto}.mykkro-clickable > div{width:100%;height:100%}.mykkro-clickable > .clickable-pane{position:absolute;background-color:#666;left:0px;top:0px;opacity:0}.mykkro-clickable > .clickable-pane:hover{opacity:0.3}.mykkro-clickable{position:relative}.mykkro-soft-text-editor{width:500px;height:200px}.mykkro-soft-text-editor > .textfield{padding:5px;vertical-align:top;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;display:inline-block;width:80%;height:30%}.mykkro-soft-text-editor > .textfield > textarea{width:100%;height:100%;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:10px;padding:10px;padding:4px;border:1px solid black;font-size:20px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.mykkro-soft-text-editor > .btn{display:inline-block;width:20%;height:30%;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;padding:5px}.mykkro-soft-text-editor > .btn > button{-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:10px;padding:10px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;height:100%;text-align:center}.mykkro-soft-text-editor > .mykkro-soft-keyboard{height:70%}.mykkro-soft-keyboard > div{position:relative;height:100%}.mykkro-soft-keyboard > div .key{position:absolute;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;padding:5px}.mykkro-soft-keyboard > div .key > div{-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;text-align:center;width:100%;height:100%;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:10px;padding:10px}.mykkro-soft-keyboard > div .key.active > div{background-color:#cfc}.mykkro-soft-keyboard > div .key:hover > div{background-color:#aaa}.mykkro-soft-keyboard > div .key.active:hover > div{background-color:#afa}.mykkro-modal .mykkro-soft-text-editor{width:100%;height:550px}.mykkro-modal .mykkro-soft-text-editor .key{font-size:36px}.mykkro-modal .mykkro-soft-text-editor .key > div{padding-top:20px}.mykkro-modal .mykkro-soft-text-editor .key.key-caps,.mykkro-modal .mykkro-soft-text-editor .key.key-del,.mykkro-modal .mykkro-soft-text-editor .key.key-space,.mykkro-modal .mykkro-soft-text-editor .key.key-enter,.mykkro-modal .mykkro-soft-text-editor .key.key-nums{background:#ddd;background:-webkit-gradient(linear,left bottom,left top,color-stop(0,#bbb),color-stop(1,#ddd));background:-ms-linear-gradient(bottom,#bbb,#ddd);background:-moz-linear-gradient(center bottom,#bbb 0%,#ddd 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#dddddd', endColorstr='#bbbbbb', GradientType=0)}.mykkro-modal .mykkro-soft-text-editor .done{font-size:30px;background:#afa;background:-webkit-gradient(linear,left bottom,left top,color-stop(0,#4f4),color-stop(1,#afa));background:-ms-linear-gradient(bottom,#4f4,#afa);background:-moz-linear-gradient(center bottom,#4f4 0%,#afa 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#aaffaa', endColorstr='#44ff44', GradientType=0)}.mykkro-calendar > div{width:100%;height:100%}.mykkro-text-thing{display:table;overflow:hidden}.mykkro-html.mykkro-text-thing > div{position:relative;display:table-cell;vertical-align:middle;text-align:center;width:100%;margin:0 auto}.mykkro-html.mykkro-text-thing > div.top{vertical-align:top}.mykkro-html.mykkro-text-thing > div.bottom{vertical-align:bottom}.mykkro-html.mykkro-text-thing > div.left{text-align:left}.mykkro-html.mykkro-text-thing > div.right{text-align:right}.mykkro-html.mykkro-text-thing{font-size:20px;line-height:130%;font-family:Georgia, serif}.mykkro-preview > .mykkro-html.mykkro-text-thing{font-size:20px;line-height:20px}.mykkro-preview{-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;border:1px solid #333;background-color:white}.mykkro-preview .mykkro-empty > div{display:none}.mykkro-dummy{position:relative}.mykkro-dummy > div{overflow:hidden;position:absolute;width:100%}.mykkro-imager > div{width:100%;height:100%}.mykkro-centering-decorator{width:100%;height:100%;text-align:center;display:table}.mykkro-centering-decorator .center2{display:table-cell;vertical-align:middle}.mykkro-centering-decorator .center2 .center3{margin:0 auto;display:block}.mykkro-centering-decorator .center2 .center3 .content-inner{margin:0 auto;display:inline-block;text-align:left}.mykkro-page{border:1px solid black}#fullscreen{display:block;height:100%;overflow:hidden}#fullscreen #book-wrapper >.icon-turn-left{background-image:url("../images/icon-turn-left-256.png")}#fullscreen #book-wrapper >.icon-turn-right{background-image:url("../images/icon-turn-right-256.png")}#book-wrapper{margin:0 auto;background-repeat:repeat;padding:19px 59px;width:920px;height:600px;-webkit-border-top-right-radius:10px;-webkit-border-bottom-right-radius:10px;-webkit-border-bottom-left-radius:10px;-webkit-border-top-left-radius:10px;-moz-border-radius-topright:10px;-moz-border-radius-bottomright:10px;-moz-border-radius-bottomleft:10px;-moz-border-radius-topleft:10px;border-top-right-radius:10px;border-bottom-right-radius:10px;border-bottom-left-radius:10px;border-top-left-radius:10px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}#book-wrapper > .mykkro-book{margin:0 auto}.mykkro-book.turnable > div > div > .mykkro-slot{background-color:white;width:400px;height:560px}.mykkro-book.basic{width:auto;height:auto}.mykkro-book.basic > .mykkro-slot{background-color:white;width:500px;height:700px}.mykkro-flow-layout > div{display:inline-block;vertical-align:bottom;padding:5px}.mykkro-stack-layout{position:relative;width:100%;height:100%}.mykkro-stack-layout > div{position:absolute;overflow:hidden}.mykkro-split-layout{position:relative}.mykkro-split-layout > div{position:absolute;overflow:hidden}.mykkro-grid-layout{position:relative}.mykkro-grid-layout > div{position:absolute;overflow:hidden}.sudoku-board{display:table;table-layout:fixed;width:100%;height:100%;border:#aaa solid 2px;color:#777;border-spacing:0px;border-collapse:separate}.sudoku-row{display:table-row}.sudoku-square{display:table-cell}.sudoku-square-in{display:table;table-layout:fixed;width:100%;height:100%;border:#aaa solid 1px;color:#777;border-spacing:0px;border-collapse:separate}.sudoku-smallrow{display:table-row}.sudoku-cell{display:table-cell}.sudoku-cell-in{display:table;table-layout:fixed;width:100%;height:100%;border:#aaa dashed 1px;color:#777;border-spacing:0px;border-collapse:separate;text-align:center}.sudoku-cell-cell{display:table-cell;vertical-align:middle}.mykkro-player-controls > .controls{opacity:1}.mykkro-player-controls > .controls.playing{opacity:0.5}.mykkro-player-controls > .controls > button{width:128px;height:128px;background-size:100%;background-color:transparent;background-repeat:no-repeat;border:none;margin-right:10px}.mykkro-player-controls > .controls > button.play{background-image:url('../images/icons/128/media_playback_start.png')}.mykkro-player-controls > .controls > button.pause{background-image:url('../images/icons/128/media_playback_pause.png');width:80px;height:80px}.mykkro-player-controls > .controls > button.stop{background-image:url('../images/icons/128/media_playback_stop.png');width:80px;height:80px}.mykkro-player-controls > .controls > button > span{display:none}.mykkro-preview .mykkro-player-controls > .controls > button{width:32px;height:32px;margin-right:4px}.mykkro-preview .mykkro-player-controls > .controls > button.pause,.mykkro-preview .mykkro-player-controls > .controls > button.stop{width:24px;height:24px}.mykkro-audio-decorator{position:relative}.mykkro-audio-decorator > .player{position:absolute;left:0px;top:0px}.mykkro-audio-decorator > .player .controls{opacity:0.5}.mykkro-audio-decorator > .player .controls.playing{opacity:0.3}.mykkro-audio-decorator > .player:hover .controls{opacity:1}.mykkro-audio-decorator > .player:hover .controls.playing{opacity:0.5}.mykkro-audio-decorator > .slot{width:100%;height:100%}.mykkro-video-thing{position:relative}.mykkro-video-thing > .player{position:absolute;left:0px;top:0px}.mykkro-video-thing > .player .controls{opacity:0.5}.mykkro-video-thing > .player .controls.playing{opacity:0}.mykkro-video-thing > .player:hover .controls{opacity:1}.mykkro-video-thing > .player:hover .controls.playing{opacity:0.5}.mykkro-video-thing > video{width:100%;height:100%}.mykkro-toolbar-decorator-content{width:100%;height:100%}.mykkro-ref-decorator{position:relative}.mykkro-ref-decorator .mykkro-ref-decorator-content{width:100%;height:100%}.mykkro-ref-decorator .mykkro-ref-decorator-control{display:block;position:absolute;right:0px;bottom:0px}.ref-link{display:inline-block;opacity:0.3;background-color:#ccc;font-size:20px;font-weight:bold;font-family:Ubuntu, sans-serif;-webkit-border-top-right-radius:16px;-webkit-border-bottom-right-radius:16px;-webkit-border-bottom-left-radius:16px;-webkit-border-top-left-radius:16px;-moz-border-radius-topright:16px;-moz-border-radius-bottomright:16px;-moz-border-radius-bottomleft:16px;-moz-border-radius-topleft:16px;border-top-right-radius:16px;border-bottom-right-radius:16px;border-bottom-left-radius:16px;border-top-left-radius:16px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;padding:2px 8px}.ref-link:hover{opacity:0.8}.ref-tooltip > p{font-style:italic}.mykkro-ref-list{font-size:20px;font-weight:500;font-family:Ubuntu, sans-serif}.mykkro-ref-list > p{padding:8px}.mykkro-ref-list ul{position:relative}.mykkro-ref-list ul .ref-label{font-size:16px;padding:4px;color:#333}.mykkro-modal .mykkro-page-decorator{height:auto}.mykkro-modal .mykkro-ajax-pager .mykkro-ajax{height:530px}.panel-body .pager{padding:10px 0px}.panel-body .pager span,.panel-body .pager a{display:inline-block;margin:3px;width:30px;height:20px;line-height:20px;background-color:#def;border:1px solid #aaa;text-align:center}.panel-body .pager span{background-color:#abc;font-weight:bold}.mykkro-preview .mykkro-html.mykkro-text-thing{font-size:8px}.mykkro-ajax-pager > .pager-controls{text-align:center;padding:4px}.mykkro-ajax-pager > .pager-controls > *{padding:0px 4px}.mykkro-inset-decorator,.mykkro-border-decorator{-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.mykkro-rounded-decorator{-webkit-mask-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAA5JREFUeNpiYGBgAAgwAAAEAAGbA+oJAAAAAElFTkSuQmCC);overflow:hidden;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.pageditor-widget{position:relative}.pageditor-widget .mykkro-page{background-color:white}form #tree-view-container{background-color:azure}#tree-view-container{position:absolute;left:516px;top:0px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:#eeecdd;border:1px solid #aaa;padding:10px;width:390px;height:700px;overflow:auto}#tree-view{display:block;color:black}#tree-view h2{font-size:12px;padding:3px;height:12px;margin-bottom:2px}#tree-view h3{display:inline-block;float:left;font-size:12px;padding:3px;height:12px;display:inline-block;width:50px;margin-right:10px;margin-bottom:2px;text-align:center;-webkit-border-top-right-radius:10px;-webkit-border-bottom-right-radius:10px;-webkit-border-bottom-left-radius:10px;-webkit-border-top-left-radius:10px;-moz-border-radius-topright:10px;-moz-border-radius-bottomright:10px;-moz-border-radius-bottomleft:10px;-moz-border-radius-topleft:10px;border-top-right-radius:10px;border-bottom-right-radius:10px;border-bottom-left-radius:10px;border-top-left-radius:10px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;background-color:lightblue}#tree-view h3.collapsed{background-color:#ccc}#tree-view .node{display:block;margin-left:20px}#tree-view > .node{margin-left:0px}#tree-view .slots.collapsed{display:none}#tree-view .tools{display:inline-block}#tree-view .tools > .toolbar{position:relative;border:none;background:none}#tree-view h2{display:inline-block}body{width:100%;*zoom:1}body:before,body:after{content:"";display:table}body:after{clear:both}.icon-link-bg{display:inline-block}.panel .icon-link-bg,.dashboard-items .icon-link-bg,input[type='submit']{background-image:-moz-linear-gradient(top,#ddd,#c4c4c4);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#ddd),color-stop(1,#c4c4c4));border-radius:16px;border:1px solid #aaaaaa;-webkit-border-radius:16px;-moz-border-radius:16px;text-decoration:none;text-shadow:#ddd 0 1px 0;padding:3px 8px;margin:2px;display:inline-block}input[type='submit']{background-image:-moz-linear-gradient(top,#ccf,#9999ff);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#ccf),color-stop(1,#9999ff));color:#000;text-shadow:#ccf 0 1px 0;font-weight:normal;padding:5px 15px}input[type='submit']:hover{background-image:-moz-linear-gradient(top,#8f8fff,#5c5cff);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#8f8fff),color-stop(1,#5c5cff))}.panel .icon-link-bg.danger{background-image:-moz-linear-gradient(top,#fbb,#ff8888);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#fbb),color-stop(1,#ff8888));color:#000000;text-shadow:#fbb 0 1px 0;font-weight:normal}.panel .icon-link-bg.danger:hover{background-image:-moz-linear-gradient(top,#ff8383,#ff5050);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#ff8383),color-stop(1,#ff5050))}.panel .icon-link-bg.download{background-image:-moz-linear-gradient(top,#afa,#77ff77);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#afa),color-stop(1,#77ff77));color:#000000;text-shadow:#afa 0 1px 0;font-weight:normal}.panel .icon-link-bg.download:hover{background-image:-moz-linear-gradient(top,#77d977,#4fce4f);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#77d977),color-stop(1,#4fce4f))}.panel .icon-link-bg:hover,.dashboard-items .icon-link-bg:hover{background-image:-moz-linear-gradient(top,#c7c7c7,#adadad);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#c7c7c7),color-stop(1,#adadad))}.icon-link{display:inline-block;height:16px;line-height:16px;padding-left:20px;font-size:13px}a.icon-link,a.icon-link:link,a.icon-link:hover,a.icon-link:visited,a.icon-link:active{font-weight:300;color:#000}.icon-button{display:inline-block;background-size:cover;background-repeat:no-repeat no-repeat}.icon{display:block;background-size:cover;background-repeat:no-repeat no-repeat}.icon-12,.icon-tiny{width:12px;height:12px}.icon-16,.icon-small{width:16px;height:16px}.icon-24,.icon-medium{width:24px;height:24px}.icon-32,.icon-big{width:32px;height:32px}.icon-48,.icon-huge{width:48px;height:48px}.icon-snippet{background-color:transparent;background-image:url('../images/icons/48/snippet.png');background-repeat:no-repeat;background-position:left top}.icon-book{background-color:transparent;background-image:url('../images/icons/48/book.png');background-repeat:no-repeat;background-position:left top}.icon-image{background-color:transparent;background-image:url('../images/icons/48/image.png');background-repeat:no-repeat;background-position:left top}.icon-image.icon-32{background-color:transparent;background-image:url('../images/icons/32/Picture.png');background-repeat:no-repeat;background-position:left top}.icon-drawing{background-color:transparent;background-image:url('../images/icons/48/drawing.png');background-repeat:no-repeat;background-position:left top}.icon-drawing.icon-32{background-color:transparent;background-image:url('../images/icons/32/Picture.png');background-repeat:no-repeat;background-position:left top}.icon-note{background-color:transparent;background-image:url('../images/icons/48/note.png');background-repeat:no-repeat;background-position:left top}.icon-fiddle{background-color:transparent;background-image:url('../images/icons/48/fiddle.png');background-repeat:no-repeat;background-position:left top}.icon-usergroup{background-color:transparent;background-image:url('../images/icons/48/usergroup.png');background-repeat:no-repeat;background-position:left top}.icon-membergroup{background-color:transparent;background-image:url('../images/icons/48/membergroup.png');background-repeat:no-repeat;background-position:left top}.icon-todo{background-color:transparent;background-image:url('../images/icons/48/todo.png');background-repeat:no-repeat;background-position:left top}.icon-profile{background-color:transparent;background-image:url('../images/icons/48/profile.png');background-repeat:no-repeat;background-position:left top}.icon-logger{background-color:transparent;background-image:url('../images/icons/48/logger.png');background-repeat:no-repeat;background-position:left top}.icon-nodetype{background-color:transparent;background-image:url('../images/icons/48/nodetype.png');background-repeat:no-repeat;background-position:left top}.icon-plot{background-color:transparent;background-image:url('../images/icons/48/plot.png');background-repeat:no-repeat;background-position:left top}.icon-expression{background-color:transparent;background-image:url('../images/icons/48/expression.png');background-repeat:no-repeat;background-position:left top}.icon-video{background-color:transparent;background-image:url('../images/icons/48/video.png');background-repeat:no-repeat;background-position:left top}.icon-video.icon-32{background-color:transparent;background-image:url('../images/icons/32/Movie.png');background-repeat:no-repeat;background-position:left top}.icon-voice.icon-32{background-color:transparent;background-image:url('../images/icons/32/speaker-icon.png');background-repeat:no-repeat;background-position:left top}.icon-voice{background-color:transparent;background-image:url('../images/icons/48/voice.png');background-repeat:no-repeat;background-position:left top}.icon-article{background-color:transparent;background-image:url('../images/icons/48/article.png');background-repeat:no-repeat;background-position:left top}.icon-article.icon-32{background-color:transparent;background-image:url('../images/icons/32/article.png');background-repeat:no-repeat;background-position:left top}.icon-text{background-color:transparent;background-image:url('../images/icons/32/Edit text.png');background-repeat:no-repeat;background-position:left top}.icon-design{background-color:transparent;background-image:url('../images/icons/48/design.png');background-repeat:no-repeat;background-position:left top}.icon-design.icon-32{background-color:transparent;background-image:url('../images/icons/32/layout.png');background-repeat:no-repeat;background-position:left top}.icon-settings{background-color:transparent;background-image:url('../images/icons/48/settings.png');background-repeat:no-repeat;background-position:left top}.icon-settings.icon-32{background-color:transparent;background-image:url('../images/icons/32/Settings.png');background-repeat:no-repeat;background-position:left top}.icon-show-all{background-color:transparent;background-image:url('../images/icons/16/show-all.png');background-repeat:no-repeat;background-position:left top}.icon-view{background-color:transparent;background-image:url('../images/icons/16/view.png');background-repeat:no-repeat;background-position:left top}.icon-edit{background-color:transparent;background-image:url('../images/icons/16/edit.png');background-repeat:no-repeat;background-position:left top}.icon-add-page{background-color:transparent;background-image:url('../images/icons/16/db_add.png');background-repeat:no-repeat;background-position:left top}.icon-remove-page{background-color:transparent;background-image:url('../images/icons/16/db_remove.png');background-repeat:no-repeat;background-position:left top}.icon-add{background-color:transparent;background-image:url('../images/icons/16/add.png');background-repeat:no-repeat;background-position:left top}.icon-remove-16{background-color:transparent;background-image:url('../images/icons/16/delete.png');background-repeat:no-repeat;background-position:left top}.icon-remove{background-color:transparent;background-image:url('../images/icons/32/Erase.png');background-repeat:no-repeat;background-position:left top}.icon-remove.icon-16{background-color:transparent;background-image:url('../images/icons/16/delete.png');background-repeat:no-repeat;background-position:left top}.icon-bomb{background-color:transparent;background-image:url('../images/icons/32/bomb.png');background-repeat:no-repeat;background-position:left top}.icon-favorites{background-color:transparent;background-image:url('../images/icons/32/Favourites.png');background-repeat:no-repeat;background-position:left top}.icon-export-16{background-color:transparent;background-image:url('../images/icons/16/Export.png');background-repeat:no-repeat;background-position:left top}.icon-export{background-color:transparent;background-image:url('../images/icons/32/Export.png');background-repeat:no-repeat;background-position:left top}.icon-export.icon-16{background-color:transparent;background-image:url('../images/icons/16/Export.png');background-repeat:no-repeat;background-position:left top}.icon-info{background-color:transparent;background-image:url('../images/icons/32/Info.png');background-repeat:no-repeat;background-position:left top}.icon-no{background-color:transparent;background-image:url('../images/icons/32/No.png');background-repeat:no-repeat;background-position:left top}.icon-ok{background-color:transparent;background-image:url('../images/icons/32/Ok.png');background-repeat:no-repeat;background-position:left top}.icon-tools{background-color:transparent;background-image:url('../images/icons/32/Tools.png');background-repeat:no-repeat;background-position:left top}.icon-play{background-color:transparent;background-image:url('../images/icons/32/Play.png');background-repeat:no-repeat;background-position:left top}.icon-preview{background-color:transparent;background-image:url('../images/icons/32/Preview.png');background-repeat:no-repeat;background-position:left top}.icon-refresh{background-color:transparent;background-image:url('../images/icons/32/Refresh.png');background-repeat:no-repeat;background-position:left top}.icon-undo{background-color:transparent;background-image:url('../images/icons/32/Undo.png');background-repeat:no-repeat;background-position:left top}.icon-yes{background-color:transparent;background-image:url('../images/icons/32/Yes.png');background-repeat:no-repeat;background-position:left top}.icon-warning{background-color:transparent;background-image:url('../images/icons/32/Warning.png');background-repeat:no-repeat;background-position:left top}.icon-default{background-color:transparent;background-image:url('../images/icons/32/Refresh.png');background-repeat:no-repeat;background-position:left top}.icon-home{background-color:transparent;background-image:url('../images/icons/48/kfm_home.png');background-repeat:no-repeat;background-position:left top}.icon-turn-left{background-color:transparent;background-image:url('../images/icons/48/left_turn.png');background-repeat:no-repeat;background-position:left top}.icon-turn-right{background-color:transparent;background-image:url('../images/icons/48/right_turn.png');background-repeat:no-repeat;background-position:left top}.icon-fullscreen-on{background-color:transparent;background-image:url('../images/icons/48/window_fullscreen.png');background-repeat:no-repeat;background-position:left top}.icon-fullscreen-off{background-color:transparent;background-image:url('../images/icons/48/window_nofullscreen.png');background-repeat:no-repeat;background-position:left top}.icon-closebook{background-color:transparent;background-image:url('../images/icons/48/fileclose-red.png');background-repeat:no-repeat;background-position:left top}.icon-hover{opacity:0.5}.icon-regex{background-color:transparent;background-image:url('../images/icons/48/regex.png');background-repeat:no-repeat;background-position:left top}.icon-formula{background-color:transparent;background-image:url('../images/icons/48/formula.png');background-repeat:no-repeat;background-position:left top}.icon-search{background-color:transparent;background-image:url('../images/icons/48/search.png');background-repeat:no-repeat;background-position:left top}.icon-help{background-color:transparent;background-image:url('../images/icons/48/help.png');background-repeat:no-repeat;background-position:left top}.previews > ul > li{position:relative;background-color:#a6c4e1;padding-top:5px;padding-bottom:5px}.previews > ul > li:nth-child(odd){background-color:#cde}.preview{-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;display:block;position:relative;float:left;padding-left:70px;width:100%;min-height:68px}.preview.icon-only{width:68px;height:68px;padding:10px}.preview.image-preview.icon-only{width:100px;height:100px;padding:10px}.preview.video-preview.icon-only{width:200px;height:140px;padding:10px}.preview.drawing-preview.icon-only{width:120px;height:120px;padding:10px}.preview.design-preview.icon-only{width:104px;height:134px;padding:0px}.design-preview{min-height:134px;padding:10px 10px 10px 110px}.image-preview{padding:10px 10px 10px 100px;min-height:100px}.video-preview{padding-left:200px;min-height:140px}.video-preview img{width:180px;height:120px}.drawing-preview{padding-left:120px;min-height:120px}.drawing-preview .drawing-wrapper{width:100px;height:100px}.preview .media-icon{width:48px;height:48px}.preview .media-icon-small{width:24px;height:24px}.preview .media-icon,.image-preview img,.video-preview img,.design-preview .mykkro-preview,.drawing-preview .drawing-wrapper{position:absolute;top:10px;left:10px}.preview .media-icon > svg,.image-preview img > svg,.video-preview img > svg,.design-preview .mykkro-preview > svg,.drawing-preview .drawing-wrapper > svg{position:absolute}.preview h3{font-family:'Quattrocento Sans', sans-serif;font-weight:bold;font-size:20px}.preview .description{font-style:italic;color:#333;margin-bottom:6px}.preview .reference{margin-bottom:6px;font-size:80%}.preview .tags{margin-bottom:6px;font-size:80%}.preview .times{font-size:80%;color:#666}.previews{margin-top:16px;margin-bottom:16px}.previews.single{margin:0}.media-icon{width:48px;height:48px}.touchpad-widget{width:200px;height:200px;background-color:#abc;display:block;position:relative}.touchpad-widget > .pointer{position:absolute;left:0px;top:0px;width:10px;height:10px;background-color:blue}ul.dashboard-menu{list-style:none;margin:0;padding:0;display:block}ul.dashboard-menu li{margin:2px 0px;display:inline-block;vertical-align:top;width:90px;height:90px;background:#eef;background:-moz-linear-gradient(-45deg,#eef 0%,#ccf 100%);background:-webkit-gradient(linear,left top,right bottom,color-stop(0%,#eef),color-stop(100%,#ccf));background:-webkit-linear-gradient(-45deg,#eef 0%,#ccf 100%);background:-o-linear-gradient(-45deg,#eef 0%,#ccf 100%);background:-ms-linear-gradient(-45deg,#eef 0%,#ccf 100%);background:linear-gradient(135deg,#eef 0%,#ccf 100%);text-align:center;font-size:12px;overflow:hidden}ul.dashboard-menu li .dashboard-icon{margin:4px auto}ul.dashboard-menu li a{width:100%;height:100%;display:block;color:black;font-weight:300}ul.dashboard-menu li:hover{background:#eee;background:-moz-linear-gradient(-45deg,#eee 0%,#ccc 100%);background:-webkit-gradient(linear,left top,right bottom,color-stop(0%,#eee),color-stop(100%,#ccc));background:-webkit-linear-gradient(-45deg,#eee 0%,#ccc 100%);background:-o-linear-gradient(-45deg,#eee 0%,#ccc 100%);background:-ms-linear-gradient(-45deg,#eee 0%,#ccc 100%);background:linear-gradient(135deg,#eee 0%,#ccc 100%)}ul.dashboard-menu li.active{background:#fff;background:-moz-linear-gradient(-45deg,#fff 0%,#ddd 100%);background:-webkit-gradient(linear,left top,right bottom,color-stop(0%,#fff),color-stop(100%,#ddd));background:-webkit-linear-gradient(-45deg,#fff 0%,#ddd 100%);background:-o-linear-gradient(-45deg,#fff 0%,#ddd 100%);background:-ms-linear-gradient(-45deg,#fff 0%,#ddd 100%);background:linear-gradient(135deg,#fff 0%,#ddd 100%)}ul.dashboard-menu li.active:hover{background:#eee;background:-moz-linear-gradient(-45deg,#eee 0%,#bbb 100%);background:-webkit-gradient(linear,left top,right bottom,color-stop(0%,#eee),color-stop(100%,#bbb));background:-webkit-linear-gradient(-45deg,#eee 0%,#bbb 100%);background:-o-linear-gradient(-45deg,#eee 0%,#bbb 100%);background:-ms-linear-gradient(-45deg,#eee 0%,#bbb 100%);background:linear-gradient(135deg,#eee 0%,#bbb 100%)}.dashboard-items{margin:10px 0px}.dashboard-icon{width:48px;height:48px}ul.etabs{margin-bottom:12px}.tab-container .panel-container{background:#fff;border:solid #666 1px;padding:10px;-moz-border-radius:0 4px 4px 4px;-webkit-border-radius:0 4px 4px 4px}.datagrid-info{margin-bottom:10px;font-weight:bolder}.datagrid table{border-collapse:collapse;text-align:left;width:100%}.datagrid{font:normal 12px/150% Arial, Helvetica, sans-serif;background:#fff;overflow:hidden;border:1px solid #8C8C8C;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px}.datagrid table td,.datagrid table th{padding:3px 10px}.datagrid table thead th{background:-webkit-gradient(linear,left top,left bottom,color-stop(0.05,#8C8C8C),color-stop(1,#7D7D7D));background:-moz-linear-gradient(center top,#8C8C8C 5%,#7D7D7D 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#8C8C8C',endColorstr='#7D7D7D');background-color:#8C8C8C;color:#FFFFFF;font-size:15px;font-weight:bold;border-left:1px solid #A3A3A3}.datagrid table thead th:first-child{border:none}.datagrid table tbody td{color:#7D7D7D;border-left:1px solid #DBDBDB;font-size:12px;font-weight:normal}.datagrid table tbody .alt td{background:#EBEBEB;color:#7D7D7D}.datagrid table tbody td:first-child{border-left:none}.datagrid table tbody tr:last-child td{border-bottom:none}.datagrid table tfoot td div{border-top:1px solid #8C8C8C;background:#EBEBEB}.datagrid table tfoot td{padding:0;font-size:12px}.datagrid table tfoot td div{padding:2px}.datagrid table tfoot td ul{margin:0;padding:0;list-style:none;text-align:right}.datagrid table tfoot li{display:inline}.datagrid table tfoot li a{text-decoration:none;display:inline-block;padding:2px 8px;margin:1px;color:#F5F5F5;border:1px solid #8C8C8C;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;background:-webkit-gradient(linear,left top,left bottom,color-stop(0.05,#8C8C8C),color-stop(1,#7D7D7D));background:-moz-linear-gradient(center top,#8C8C8C 5%,#7D7D7D 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#8C8C8C',endColorstr='#7D7D7D');background-color:#8C8C8C}.datagrid table tfoot ul a.active,.datagrid table tfoot ul a:hover{text-decoration:none;border-color:#7D7D7D;color:#F5F5F5;background:none;background-color:#8C8C8C}input.search{padding:6px 15px 6px 30px;margin:3px;background:url('../images/search.png') no-repeat 8px 6px}input.rounded{border-radius:15px;-moz-border-radius:15px;-webkit-border-radius:15px}input.search[type=text]{color:#bcbcbc;width:400px}form.lighter{padding:5px;border:1px solid #aaa;background-color:#cdcdcd;margin-bottom:10px}form.lighter input[type=text]{border:1px solid #d0d0d0;background-color:#fcfcfc;margin-right:10px}form.lighter fieldset{margin:0px;border:none}form.lighter .sf-nodes li{display:inline-block;margin-right:10px;width:150px}a.search-type-switcher{margin-left:20px;font-size:85%;color:#666}a.search-nodes-all,a.search-nodes-none{margin-right:10px;font-size:85%;color:#666}.sf-nodes ul{margin:12px 0px 6px 0px}.search-result > p{margin-bottom:10px}.search-result .pagination-links a{margin-right:10px;font-size:85%;color:#666}.search-result .previews ol{counter-reset:item;list-style:none}.search-result .previews ol > li{padding:10px 4px;display:list-item;position:relative;font-size:28px;background-color:#a6c4e1}.search-result .previews ol > li:nth-child(odd){background-color:#cde}.search-result .previews ol > li >h3,.search-result .previews ol > li >div,.search-result .previews ol > li >a{font-size:12px}.search-result .previews ol > li:before{content:counter(item) ". ";counter-increment:item;float:left;text-align:right;width:50px}.search-result .previews ol .sf-node{position:relative}.search-result .previews ol .sf-node .title{font-size:16px;font-weight:bold}.search-result .previews ol .sf-node .title a:link{color:#044}.search-result .previews ol .sf-node .title a:hover{color:#033}.search-result .previews ol .sf-node .title.untitled a:link{color:#666}.search-result .previews ol .sf-node .title.untitled a:hover{color:#333}.search-result .previews ol .sf-node .type-title{font-size:12px;font-weight:normal}.search-result .previews ol .sf-node .type-title a:link{color:#aaa}.search-result .previews ol .sf-node .type-title a:hover{color:#666}.search-result .previews ol .sf-node .description{font-size:12px;color:#333;margin-bottom:6px}.search-result .previews ol .sf-node .modified{font-size:10px;color:#666}.search-result .previews.preview-test ol > li > .sf-node-overlay{position:absolute;width:100%;height:100%;z-index:100;top:0;left:0}.search-result .previews.preview-test ol > li > .sf-node-overlay:hover{background-color:cyan;opacity:0.3}.search-result .previews.preview-test ol > li > .sf-node-overlay.preview-loading,.search-result .previews.preview-test ol > li > .sf-node-overlay.preview-loading:hover{background-color:red;opacity:0.1}.search-result .previews.preview-test ol > li .sf-node-preview{position:relative;display:inline-block;vertical-align:top;margin:0px 8px}.search-result .previews.preview-test ol > li .sf-node-info{display:inline-block;vertical-align:top}.search-result .previews.preview-test ol .sf-avatar{width:24px;height:24px;position:absolute;right:-5px;bottom:-5px;display:none}.usergroup-avatar{display:inline-block;vertical-align:top}.usergroup-other{display:inline-block;vertical-align:top}.usergroup-user .avatar{width:68px;height:68px}.usergroup-user .avatar img{width:100%;height:100%}.usergroup-user{background-color:#ccb;padding:4px}.usergroup-user.odd{background-color:#ddc}.usergroup-user.member{background-color:#cfc}.usergroup-user.member.odd{background-color:#dfd}.usergroup-user .role{font-style:italic;font-size:90%;color:#333;margin-bottom:4px}.usergroup-user .joined{font-size:80%;color:#666;margin-bottom:4px}.usergroup-detail h6{margin-bottom:8px}.usergroup-detail{margin-bottom:20px}#snippet-content-wrapper{position:relative;width:800px;height:400px}#SnippetContent{display:none}.ribbon{background-color:#a00;overflow:hidden;position:absolute;right:-80px;top:-30px;-moz-transform:rotate(45deg);-webkit-transform:rotate(45deg);-moz-box-shadow:0 0 1em #888;-webkit-box-shadow:0 0 1em #888}.ribbon a:link,.ribbon a:visited{border:1px solid #faa;color:#fff;display:block;font:bold 81.25% 'Helvetiva Neue', Helvetica, Arial, sans-serif;margin:0.05em 0;padding:0.5em 3.5em;text-align:center;text-decoration:none;text-shadow:0 0 0.5em #444}html{font-size:14px;font-family:'Ubuntu', sans-serif;font-weight:300;background-color:#cdcdcd}body{height:100%}#container{width:960px;margin:0 auto;overflow:hidden}#container{background-color:none}#breadcrumb{font-size:13px;padding:6px;float:left}#header{width:100%;padding:10px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.logo{background:#eef url(../images/logo-scrapbook.png) no-repeat left top;width:268px;height:74px;display:inline-block;float:left}.user-controls{font-size:13px;padding:6px;float:right}#content{-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;margin:0px;width:100%}#content #accordion{background-color:#bbb}#content #accordion .ui-accordion-content{border-left:1px solid #aaa;border-right:1px solid #aaa;border-bottom:1px solid #aaa}#footer{width:100%;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;color:#666;padding:16px;text-align:center}h1,h2,h3,h4,h5,h6{font-weight:bolder}h1{font-size:40px;margin-bottom:10px}h2{font-size:34px;margin-bottom:10px}h3{font-size:28px;margin-bottom:8px}h4{font-size:24px;margin-bottom:6px}h5{font-size:20px;margin-bottom:5px}h6{font-size:16px;margin-bottom:4px}strong,b{font-weight:bold}em,i{font-style:italic}a:link{text-decoration:none;font-weight:normal;color:#008}a:visited{text-decoration:none;font-weight:normal;color:#008}a:hover{text-decoration:none;font-weight:normal;color:brown}a:active{text-decoration:none;font-weight:normal;color:#008}.clear{clear:both}.ui-accordion-header > a{margin-left:20px}.ui-dialog .ui-dialog-titlebar{background-color:#acf}.ui-dialog .ui-dialog-titlebar .ui-dialog-titlebar-close{margin-top:-10px !important;margin-right:10px !important;padding-top:0px !important}.logged-user .info{margin-right:10px}.autoform form{margin-bottom:1em;background:#eed;border:1px solid #ddd;-webkit-border-radius:2px;-moz-border-radius:2px;border-radius:2px;-moz-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);-webkit-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);-o-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);box-shadow:0 0 8px 2px rgba(0,0,0,0.1);padding:15px;background:#E8e3b1}.autoform form legend{font-weight:bolder;font-size:18px}.autoform form fieldset{padding:10px;background:#e2dc9d;border:1px solid #dcd58a}.autoform form label{padding-bottom:4px}.message{margin:1em;-webkit-border-radius:salmon;-moz-border-radius:salmon;border-radius:salmon;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:salmon;padding:10px;color:black;font-weight:bolder;font-size:16px}#authMessage{background-color:orange}.autoform fieldset{margin-bottom:16px}.autoform label{display:block;font-size:90%;margin-top:6px}.autoform .input input:not([type=submit]):not([type=file]),.autoform .input textarea{width:400px}.richtextfield textarea{width:250px;height:160px}#UserLoginForm fieldset input{width:150px}.input .error-message{color:red;font-size:90%;padding:6px}.panel{margin-bottom:1em;background:#eed;border:1px solid #ddd;-webkit-border-radius:2px;-moz-border-radius:2px;border-radius:2px;-moz-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);-webkit-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);-o-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);box-shadow:0 0 8px 2px rgba(0,0,0,0.1);padding:15px}.panel.main{background:#eed;border:1px solid #ddd;-webkit-border-radius:2px;-moz-border-radius:2px;border-radius:2px;-moz-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);-webkit-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);-o-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);box-shadow:0 0 8px 2px rgba(0,0,0,0.1);padding:15px;background:#fea}.panel.headless .panel-body{margin:0}.avatar{width:90px;height:90px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:#ffe;padding:4px}.user-info .avatar{display:inline-block;vertical-align:top;margin-right:20px}.user-info .other{display:inline-block;vertical-align:top}.panel-body{margin-top:20px}.panel-actions{margin-top:20px}.image-detail > .panel-body > img{max-width:100%}.splash{margin:1em;-webkit-border-radius:maroon;-moz-border-radius:maroon;border-radius:maroon;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:maroon;padding:10px}.splash > ul{margin:20px}.splash > ul > li{font-weight:bolder}.splash > p{margin-bottom:10px}.actions{margin-top:8px}.node >.node-field{padding:5px;-webkit-border-radius:azure;-moz-border-radius:azure;border-radius:azure;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:azure;padding:10px;margin-bottom:5px}.node >.node-field > h3{font-size:14px}.node >.node-field > h4{font-size:12px;font-weight:lighter;color:gray}.mykkro-page-editor-links{margin:6px 0px}.mykkro-page-editor-links > span{display:inline-block;margin-right:2px;padding:4px}.mykkro-page-editor-links > span.number-link{-webkit-border-radius:#eec;-moz-border-radius:#eec;border-radius:#eec;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:#eec;padding:10px;padding:4px;text-align:center}.mykkro-page-editor-links > span.number-link.current{border:2px solid #a00}.mykkro-page-editor-links > span.disabled{display:none}.Web_OnlineTools_Logo{float:left;padding:8px}.Web_OnlineTools_Logo h1{border:0px;margin:0px;padding:0px;text-align:center;text-indent:0px;font-size:40x;line-height:46px;font-family:Trebuchet MS;color:#284460;font-weight:bold;text-shadow:0px 0px 9px #000000}.Web_OnlineTools_Logo h2{border:0px;margin:0px;padding:0px;text-align:center;text-indent:24px;font-size:15px;line-height:20px;font-style:italic;font-family:Trebuchet MS;color:#74777a;text-shadow:-1px 1px 17px #000000}.imagesearch-widget{display:inline-block}.imagesearch-widget .imagesearch-preview{width:50px;height:68px;display:inline-block;margin:8px;vertical-align:top;background-color:#ddf}.imagesearch-widget > button{display:inline-block;vertical-align:top;margin-top:8px}.form .pageditor-widget .mykkro-empty:hover{background-color:#bbb;border:2px dotted #666}.tubeplayer-wrapper{position:relative;width:100%;height:100%;margin:0;padding:0}.tubeplayer-container{width:100%;height:100%;margin:0;padding:0}.tubeplayer-glasspane{width:100%;height:100%;position:absolute;top:0px;left:0px}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_Takova_normalni_rodinka\css\viewer.css
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_Takova_normalni_rodinka\css\viewer.css
VELIKOST: 1315 B (1.28 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
/* http://meyerweb.com/eric/tools/css/reset/ 
   v2.0b1 | 201101 
   NOTE: WORK IN PROGRESS
   USE WITH CAUTION AND TEST WITH ABANDON */

html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section, summary,
time, mark, audio, video {
	margin: 0;
	padding: 0;
	border: 0;
	outline: 0;
	font-size: 100%;
	font: inherit;
	vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section {
	display: block;
}
body {
	line-height: 1;
}
ol, ul {
	list-style: none;
}
blockquote, q {
	quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
	content: '';
	content: none;
}

/* remember to define visible focus styles! 
:focus {
	outline: ?????;
} */

/* remember to highlight inserts somehow! */
ins {
	text-decoration: none;
}
del {
	text-decoration: line-through;
}

table {
	border-collapse: collapse;
	border-spacing: 0;
}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_Takova_normalni_rodinka\js\libs-viewer.js
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_Takova_normalni_rodinka\js\libs-viewer.js
VELIKOST: 433967 B (423.80 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
/*! jQuery v2.0.3 | (c) 2005, 2013 jQuery Foundation, Inc. | jquery.org/license
//@ sourceMappingURL=jquery-2.0.3.min.map
*/
(function(e,undefined){var t,n,r=typeof undefined,i=e.location,o=e.document,s=o.documentElement,a=e.jQuery,u=e.$,l={},c=[],p="2.0.3",f=c.concat,h=c.push,d=c.slice,g=c.indexOf,m=l.toString,y=l.hasOwnProperty,v=p.trim,x=function(e,n){return new x.fn.init(e,n,t)},b=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,w=/\S+/g,T=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,C=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,k=/^-ms-/,N=/-([\da-z])/gi,E=function(e,t){return t.toUpperCase()},S=function(){o.removeEventListener("DOMContentLoaded",S,!1),e.removeEventListener("load",S,!1),x.ready()};x.fn=x.prototype={jquery:p,constructor:x,init:function(e,t,n){var r,i;if(!e)return this;if("string"==typeof e){if(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:T.exec(e),!r||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof x?t[0]:t,x.merge(this,x.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:o,!0)),C.test(r[1])&&x.isPlainObject(t))for(r in t)x.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return i=o.getElementById(r[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):x.isFunction(e)?n.ready(e):(e.selector!==undefined&&(this.selector=e.selector,this.context=e.context),x.makeArray(e,this))},selector:"",length:0,toArray:function(){return d.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=x.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return x.each(this,e,t)},ready:function(e){return x.ready.promise().done(e),this},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(x.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:h,sort:[].sort,splice:[].splice},x.fn.init.prototype=x.fn,x.extend=x.fn.extend=function(){var e,t,n,r,i,o,s=arguments[0]||{},a=1,u=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[1]||{},a=2),"object"==typeof s||x.isFunction(s)||(s={}),u===a&&(s=this,--a);u>a;a++)if(null!=(e=arguments[a]))for(t in e)n=s[t],r=e[t],s!==r&&(l&&r&&(x.isPlainObject(r)||(i=x.isArray(r)))?(i?(i=!1,o=n&&x.isArray(n)?n:[]):o=n&&x.isPlainObject(n)?n:{},s[t]=x.extend(l,o,r)):r!==undefined&&(s[t]=r));return s},x.extend({expando:"jQuery"+(p+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===x&&(e.$=u),t&&e.jQuery===x&&(e.jQuery=a),x},isReady:!1,readyWait:1,holdReady:function(e){e?x.readyWait++:x.ready(!0)},ready:function(e){(e===!0?--x.readyWait:x.isReady)||(x.isReady=!0,e!==!0&&--x.readyWait>0||(n.resolveWith(o,[x]),x.fn.trigger&&x(o).trigger("ready").off("ready")))},isFunction:function(e){return"function"===x.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[m.call(e)]||"object":typeof e},isPlainObject:function(e){if("object"!==x.type(e)||e.nodeType||x.isWindow(e))return!1;try{if(e.constructor&&!y.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||o;var r=C.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=x.buildFragment([e],t,i),i&&x(i).remove(),x.merge([],r.childNodes))},parseJSON:JSON.parse,parseXML:function(e){var t,n;if(!e||"string"!=typeof e)return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(r){t=undefined}return(!t||t.getElementsByTagName("parsererror").length)&&x.error("Invalid XML: "+e),t},noop:function(){},globalEval:function(e){var t,n=eval;e=x.trim(e),e&&(1===e.indexOf("use strict")?(t=o.createElement("script"),t.text=e,o.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(k,"ms-").replace(N,E)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,o=e.length,s=j(e);if(n){if(s){for(;o>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(s){for(;o>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:function(e){return null==e?"":v.call(e)},makeArray:function(e,t){var n=t||[];return null!=e&&(j(Object(e))?x.merge(n,"string"==typeof e?[e]:e):h.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:g.call(t,e,n)},merge:function(e,t){var n=t.length,r=e.length,i=0;if("number"==typeof n)for(;n>i;i++)e[r++]=t[i];else while(t[i]!==undefined)e[r++]=t[i++];return e.length=r,e},grep:function(e,t,n){var r,i=[],o=0,s=e.length;for(n=!!n;s>o;o++)r=!!t(e[o],o),n!==r&&i.push(e[o]);return i},map:function(e,t,n){var r,i=0,o=e.length,s=j(e),a=[];if(s)for(;o>i;i++)r=t(e[i],i,n),null!=r&&(a[a.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(a[a.length]=r);return f.apply([],a)},guid:1,proxy:function(e,t){var n,r,i;return"string"==typeof t&&(n=e[t],t=e,e=n),x.isFunction(e)?(r=d.call(arguments,2),i=function(){return e.apply(t||this,r.concat(d.call(arguments)))},i.guid=e.guid=e.guid||x.guid++,i):undefined},access:function(e,t,n,r,i,o,s){var a=0,u=e.length,l=null==n;if("object"===x.type(n)){i=!0;for(a in n)x.access(e,t,a,n[a],!0,o,s)}else if(r!==undefined&&(i=!0,x.isFunction(r)||(s=!0),l&&(s?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(x(e),n)})),t))for(;u>a;a++)t(e[a],n,s?r:r.call(e[a],a,t(e[a],n)));return i?e:l?t.call(e):u?t(e[0],n):o},now:Date.now,swap:function(e,t,n,r){var i,o,s={};for(o in t)s[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=s[o];return i}}),x.ready.promise=function(t){return n||(n=x.Deferred(),"complete"===o.readyState?setTimeout(x.ready):(o.addEventListener("DOMContentLoaded",S,!1),e.addEventListener("load",S,!1))),n.promise(t)},x.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()});function j(e){var t=e.length,n=x.type(e);return x.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}t=x(o),function(e,undefined){var t,n,r,i,o,s,a,u,l,c,p,f,h,d,g,m,y,v="sizzle"+-new Date,b=e.document,w=0,T=0,C=st(),k=st(),N=st(),E=!1,S=function(e,t){return e===t?(E=!0,0):0},j=typeof undefined,D=1<<31,A={}.hasOwnProperty,L=[],q=L.pop,H=L.push,O=L.push,F=L.slice,P=L.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",W="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",$=W.replace("w","w#"),B="\\["+M+"*("+W+")"+M+"*(?:([*^$|!~]?=)"+M+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+$+")|)|)"+M+"*\\]",I=":("+W+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+B.replace(3,8)+")*)|.*)\\)|)",z=RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),_=RegExp("^"+M+"*,"+M+"*"),X=RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=RegExp(M+"*[+~]"),Y=RegExp("="+M+"*([^\\]'\"]*)"+M+"*\\]","g"),V=RegExp(I),G=RegExp("^"+$+"$"),J={ID:RegExp("^#("+W+")"),CLASS:RegExp("^\\.("+W+")"),TAG:RegExp("^("+W.replace("w","w*")+")"),ATTR:RegExp("^"+B),PSEUDO:RegExp("^"+I),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:RegExp("^(?:"+R+")$","i"),needsContext:RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Q=/^[^{]+\{\s*\[native \w/,K=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Z=/^(?:input|select|textarea|button)$/i,et=/^h\d$/i,tt=/'|\\/g,nt=RegExp("\\\\([\\da-f]{1,6}"+M+"?|("+M+")|.)","ig"),rt=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(55296|r>>10,56320|1023&r)};try{O.apply(L=F.call(b.childNodes),b.childNodes),L[b.childNodes.length].nodeType}catch(it){O={apply:L.length?function(e,t){H.apply(e,F.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}function ot(e,t,r,i){var o,s,a,u,l,f,g,m,x,w;if((t?t.ownerDocument||t:b)!==p&&c(t),t=t||p,r=r||[],!e||"string"!=typeof e)return r;if(1!==(u=t.nodeType)&&9!==u)return[];if(h&&!i){if(o=K.exec(e))if(a=o[1]){if(9===u){if(s=t.getElementById(a),!s||!s.parentNode)return r;if(s.id===a)return r.push(s),r}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(a))&&y(t,s)&&s.id===a)return r.push(s),r}else{if(o[2])return O.apply(r,t.getElementsByTagName(e)),r;if((a=o[3])&&n.getElementsByClassName&&t.getElementsByClassName)return O.apply(r,t.getElementsByClassName(a)),r}if(n.qsa&&(!d||!d.test(e))){if(m=g=v,x=t,w=9===u&&e,1===u&&"object"!==t.nodeName.toLowerCase()){f=gt(e),(g=t.getAttribute("id"))?m=g.replace(tt,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",l=f.length;while(l--)f[l]=m+mt(f[l]);x=U.test(e)&&t.parentNode||t,w=f.join(",")}if(w)try{return O.apply(r,x.querySelectorAll(w)),r}catch(T){}finally{g||t.removeAttribute("id")}}}return kt(e.replace(z,"$1"),t,r,i)}function st(){var e=[];function t(n,r){return e.push(n+=" ")>i.cacheLength&&delete t[e.shift()],t[n]=r}return t}function at(e){return e[v]=!0,e}function ut(e){var t=p.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function lt(e,t){var n=e.split("|"),r=e.length;while(r--)i.attrHandle[n[r]]=t}function ct(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||D)-(~e.sourceIndex||D);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function pt(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function ft(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ht(e){return at(function(t){return t=+t,at(function(n,r){var i,o=e([],n.length,t),s=o.length;while(s--)n[i=o[s]]&&(n[i]=!(r[i]=n[i]))})})}s=ot.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},n=ot.support={},c=ot.setDocument=function(e){var t=e?e.ownerDocument||e:b,r=t.defaultView;return t!==p&&9===t.nodeType&&t.documentElement?(p=t,f=t.documentElement,h=!s(t),r&&r.attachEvent&&r!==r.top&&r.attachEvent("onbeforeunload",function(){c()}),n.attributes=ut(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=ut(function(e){return e.appendChild(t.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=ut(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),n.getById=ut(function(e){return f.appendChild(e).id=v,!t.getElementsByName||!t.getElementsByName(v).length}),n.getById?(i.find.ID=function(e,t){if(typeof t.getElementById!==j&&h){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},i.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){return e.getAttribute("id")===t}}):(delete i.find.ID,i.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){var n=typeof e.getAttributeNode!==j&&e.getAttributeNode("id");return n&&n.value===t}}),i.find.TAG=n.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==j?t.getElementsByTagName(e):undefined}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},i.find.CLASS=n.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==j&&h?t.getElementsByClassName(e):undefined},g=[],d=[],(n.qsa=Q.test(t.querySelectorAll))&&(ut(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||d.push("\\["+M+"*(?:value|"+R+")"),e.querySelectorAll(":checked").length||d.push(":checked")}),ut(function(e){var n=t.createElement("input");n.setAttribute("type","hidden"),e.appendChild(n).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&d.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||d.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),d.push(",.*:")})),(n.matchesSelector=Q.test(m=f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&ut(function(e){n.disconnectedMatch=m.call(e,"div"),m.call(e,"[s!='']:x"),g.push("!=",I)}),d=d.length&&RegExp(d.join("|")),g=g.length&&RegExp(g.join("|")),y=Q.test(f.contains)||f.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},S=f.compareDocumentPosition?function(e,r){if(e===r)return E=!0,0;var i=r.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(r);return i?1&i||!n.sortDetached&&r.compareDocumentPosition(e)===i?e===t||y(b,e)?-1:r===t||y(b,r)?1:l?P.call(l,e)-P.call(l,r):0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,n){var r,i=0,o=e.parentNode,s=n.parentNode,a=[e],u=[n];if(e===n)return E=!0,0;if(!o||!s)return e===t?-1:n===t?1:o?-1:s?1:l?P.call(l,e)-P.call(l,n):0;if(o===s)return ct(e,n);r=e;while(r=r.parentNode)a.unshift(r);r=n;while(r=r.parentNode)u.unshift(r);while(a[i]===u[i])i++;return i?ct(a[i],u[i]):a[i]===b?-1:u[i]===b?1:0},t):p},ot.matches=function(e,t){return ot(e,null,null,t)},ot.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&c(e),t=t.replace(Y,"='$1']"),!(!n.matchesSelector||!h||g&&g.test(t)||d&&d.test(t)))try{var r=m.call(e,t);if(r||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(i){}return ot(t,p,null,[e]).length>0},ot.contains=function(e,t){return(e.ownerDocument||e)!==p&&c(e),y(e,t)},ot.attr=function(e,t){(e.ownerDocument||e)!==p&&c(e);var r=i.attrHandle[t.toLowerCase()],o=r&&A.call(i.attrHandle,t.toLowerCase())?r(e,t,!h):undefined;return o===undefined?n.attributes||!h?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null:o},ot.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},ot.uniqueSort=function(e){var t,r=[],i=0,o=0;if(E=!n.detectDuplicates,l=!n.sortStable&&e.slice(0),e.sort(S),E){while(t=e[o++])t===e[o]&&(i=r.push(o));while(i--)e.splice(r[i],1)}return e},o=ot.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=o(t);return n},i=ot.selectors={cacheLength:50,createPseudo:at,match:J,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(nt,rt),e[3]=(e[4]||e[5]||"").replace(nt,rt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ot.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ot.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return J.CHILD.test(e[0])?null:(e[3]&&e[4]!==undefined?e[2]=e[4]:n&&V.test(n)&&(t=gt(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(nt,rt).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=C[e+" "];return t||(t=RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&C(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==j&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=ot.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var l,c,p,f,h,d,g=o!==s?"nextSibling":"previousSibling",m=t.parentNode,y=a&&t.nodeName.toLowerCase(),x=!u&&!a;if(m){if(o){while(g){p=t;while(p=p[g])if(a?p.nodeName.toLowerCase()===y:1===p.nodeType)return!1;d=g="only"===e&&!d&&"nextSibling"}return!0}if(d=[s?m.firstChild:m.lastChild],s&&x){c=m[v]||(m[v]={}),l=c[e]||[],h=l[0]===w&&l[1],f=l[0]===w&&l[2],p=h&&m.childNodes[h];while(p=++h&&p&&p[g]||(f=h=0)||d.pop())if(1===p.nodeType&&++f&&p===t){c[e]=[w,h,f];break}}else if(x&&(l=(t[v]||(t[v]={}))[e])&&l[0]===w)f=l[1];else while(p=++h&&p&&p[g]||(f=h=0)||d.pop())if((a?p.nodeName.toLowerCase()===y:1===p.nodeType)&&++f&&(x&&((p[v]||(p[v]={}))[e]=[w,f]),p===t))break;return f-=i,f===r||0===f%r&&f/r>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||ot.error("unsupported pseudo: "+e);return r[v]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?at(function(e,n){var i,o=r(e,t),s=o.length;while(s--)i=P.call(e,o[s]),e[i]=!(n[i]=o[s])}):function(e){return r(e,0,n)}):r}},pseudos:{not:at(function(e){var t=[],n=[],r=a(e.replace(z,"$1"));return r[v]?at(function(e,t,n,i){var o,s=r(e,null,i,[]),a=e.length;while(a--)(o=s[a])&&(e[a]=!(t[a]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),!n.pop()}}),has:at(function(e){return function(t){return ot(e,t).length>0}}),contains:at(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:at(function(e){return G.test(e||"")||ot.error("unsupported lang: "+e),e=e.replace(nt,rt).toLowerCase(),function(t){var n;do if(n=h?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===f},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return et.test(e.nodeName)},input:function(e){return Z.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:ht(function(){return[0]}),last:ht(function(e,t){return[t-1]}),eq:ht(function(e,t,n){return[0>n?n+t:n]}),even:ht(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:ht(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:ht(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:ht(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}},i.pseudos.nth=i.pseudos.eq;for(t in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[t]=pt(t);for(t in{submit:!0,reset:!0})i.pseudos[t]=ft(t);function dt(){}dt.prototype=i.filters=i.pseudos,i.setFilters=new dt;function gt(e,t){var n,r,o,s,a,u,l,c=k[e+" "];if(c)return t?0:c.slice(0);a=e,u=[],l=i.preFilter;while(a){(!n||(r=_.exec(a)))&&(r&&(a=a.slice(r[0].length)||a),u.push(o=[])),n=!1,(r=X.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace(z," ")}),a=a.slice(n.length));for(s in i.filter)!(r=J[s].exec(a))||l[s]&&!(r=l[s](r))||(n=r.shift(),o.push({value:n,type:s,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?ot.error(e):k(e,u).slice(0)}function mt(e){var t=0,n=e.length,r="";for(;n>t;t++)r+=e[t].value;return r}function yt(e,t,n){var i=t.dir,o=n&&"parentNode"===i,s=T++;return t.first?function(t,n,r){while(t=t[i])if(1===t.nodeType||o)return e(t,n,r)}:function(t,n,a){var u,l,c,p=w+" "+s;if(a){while(t=t[i])if((1===t.nodeType||o)&&e(t,n,a))return!0}else while(t=t[i])if(1===t.nodeType||o)if(c=t[v]||(t[v]={}),(l=c[i])&&l[0]===p){if((u=l[1])===!0||u===r)return u===!0}else if(l=c[i]=[p],l[1]=e(t,n,a)||r,l[1]===!0)return!0}}function vt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function xt(e,t,n,r,i){var o,s=[],a=0,u=e.length,l=null!=t;for(;u>a;a++)(o=e[a])&&(!n||n(o,r,i))&&(s.push(o),l&&t.push(a));return s}function bt(e,t,n,r,i,o){return r&&!r[v]&&(r=bt(r)),i&&!i[v]&&(i=bt(i,o)),at(function(o,s,a,u){var l,c,p,f=[],h=[],d=s.length,g=o||Ct(t||"*",a.nodeType?[a]:a,[]),m=!e||!o&&t?g:xt(g,f,e,a,u),y=n?i||(o?e:d||r)?[]:s:m;if(n&&n(m,y,a,u),r){l=xt(y,h),r(l,[],a,u),c=l.length;while(c--)(p=l[c])&&(y[h[c]]=!(m[h[c]]=p))}if(o){if(i||e){if(i){l=[],c=y.length;while(c--)(p=y[c])&&l.push(m[c]=p);i(null,y=[],l,u)}c=y.length;while(c--)(p=y[c])&&(l=i?P.call(o,p):f[c])>-1&&(o[l]=!(s[l]=p))}}else y=xt(y===s?y.splice(d,y.length):y),i?i(null,s,y,u):O.apply(s,y)})}function wt(e){var t,n,r,o=e.length,s=i.relative[e[0].type],a=s||i.relative[" "],l=s?1:0,c=yt(function(e){return e===t},a,!0),p=yt(function(e){return P.call(t,e)>-1},a,!0),f=[function(e,n,r){return!s&&(r||n!==u)||((t=n).nodeType?c(e,n,r):p(e,n,r))}];for(;o>l;l++)if(n=i.relative[e[l].type])f=[yt(vt(f),n)];else{if(n=i.filter[e[l].type].apply(null,e[l].matches),n[v]){for(r=++l;o>r;r++)if(i.relative[e[r].type])break;return bt(l>1&&vt(f),l>1&&mt(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(z,"$1"),n,r>l&&wt(e.slice(l,r)),o>r&&wt(e=e.slice(r)),o>r&&mt(e))}f.push(n)}return vt(f)}function Tt(e,t){var n=0,o=t.length>0,s=e.length>0,a=function(a,l,c,f,h){var d,g,m,y=[],v=0,x="0",b=a&&[],T=null!=h,C=u,k=a||s&&i.find.TAG("*",h&&l.parentNode||l),N=w+=null==C?1:Math.random()||.1;for(T&&(u=l!==p&&l,r=n);null!=(d=k[x]);x++){if(s&&d){g=0;while(m=e[g++])if(m(d,l,c)){f.push(d);break}T&&(w=N,r=++n)}o&&((d=!m&&d)&&v--,a&&b.push(d))}if(v+=x,o&&x!==v){g=0;while(m=t[g++])m(b,y,l,c);if(a){if(v>0)while(x--)b[x]||y[x]||(y[x]=q.call(f));y=xt(y)}O.apply(f,y),T&&!a&&y.length>0&&v+t.length>1&&ot.uniqueSort(f)}return T&&(w=N,u=C),b};return o?at(a):a}a=ot.compile=function(e,t){var n,r=[],i=[],o=N[e+" "];if(!o){t||(t=gt(e)),n=t.length;while(n--)o=wt(t[n]),o[v]?r.push(o):i.push(o);o=N(e,Tt(i,r))}return o};function Ct(e,t,n){var r=0,i=t.length;for(;i>r;r++)ot(e,t[r],n);return n}function kt(e,t,r,o){var s,u,l,c,p,f=gt(e);if(!o&&1===f.length){if(u=f[0]=f[0].slice(0),u.length>2&&"ID"===(l=u[0]).type&&n.getById&&9===t.nodeType&&h&&i.relative[u[1].type]){if(t=(i.find.ID(l.matches[0].replace(nt,rt),t)||[])[0],!t)return r;e=e.slice(u.shift().value.length)}s=J.needsContext.test(e)?0:u.length;while(s--){if(l=u[s],i.relative[c=l.type])break;if((p=i.find[c])&&(o=p(l.matches[0].replace(nt,rt),U.test(u[0].type)&&t.parentNode||t))){if(u.splice(s,1),e=o.length&&mt(u),!e)return O.apply(r,o),r;break}}}return a(e,f)(o,t,!h,r,U.test(e)),r}n.sortStable=v.split("").sort(S).join("")===v,n.detectDuplicates=E,c(),n.sortDetached=ut(function(e){return 1&e.compareDocumentPosition(p.createElement("div"))}),ut(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||lt("type|href|height|width",function(e,t,n){return n?undefined:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),n.attributes&&ut(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||lt("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?undefined:e.defaultValue}),ut(function(e){return null==e.getAttribute("disabled")})||lt(R,function(e,t,n){var r;return n?undefined:(r=e.getAttributeNode(t))&&r.specified?r.value:e[t]===!0?t.toLowerCase():null}),x.find=ot,x.expr=ot.selectors,x.expr[":"]=x.expr.pseudos,x.unique=ot.uniqueSort,x.text=ot.getText,x.isXMLDoc=ot.isXML,x.contains=ot.contains}(e);var D={};function A(e){var t=D[e]={};return x.each(e.match(w)||[],function(e,n){t[n]=!0}),t}x.Callbacks=function(e){e="string"==typeof e?D[e]||A(e):x.extend({},e);var t,n,r,i,o,s,a=[],u=!e.once&&[],l=function(p){for(t=e.memory&&p,n=!0,s=i||0,i=0,o=a.length,r=!0;a&&o>s;s++)if(a[s].apply(p[0],p[1])===!1&&e.stopOnFalse){t=!1;break}r=!1,a&&(u?u.length&&l(u.shift()):t?a=[]:c.disable())},c={add:function(){if(a){var n=a.length;(function s(t){x.each(t,function(t,n){var r=x.type(n);"function"===r?e.unique&&c.has(n)||a.push(n):n&&n.length&&"string"!==r&&s(n)})})(arguments),r?o=a.length:t&&(i=n,l(t))}return this},remove:function(){return a&&x.each(arguments,function(e,t){var n;while((n=x.inArray(t,a,n))>-1)a.splice(n,1),r&&(o>=n&&o--,s>=n&&s--)}),this},has:function(e){return e?x.inArray(e,a)>-1:!(!a||!a.length)},empty:function(){return a=[],o=0,this},disable:function(){return a=u=t=undefined,this},disabled:function(){return!a},lock:function(){return u=undefined,t||c.disable(),this},locked:function(){return!u},fireWith:function(e,t){return!a||n&&!u||(t=t||[],t=[e,t.slice?t.slice():t],r?u.push(t):l(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!n}};return c},x.extend({Deferred:function(e){var t=[["resolve","done",x.Callbacks("once memory"),"resolved"],["reject","fail",x.Callbacks("once memory"),"rejected"],["notify","progress",x.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return x.Deferred(function(n){x.each(t,function(t,o){var s=o[0],a=x.isFunction(e[t])&&e[t];i[o[1]](function(){var e=a&&a.apply(this,arguments);e&&x.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s+"With"](this===r?n.promise():this,a?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?x.extend(e,r):r}},i={};return r.pipe=r.then,x.each(t,function(e,o){var s=o[2],a=o[3];r[o[1]]=s.add,a&&s.add(function(){n=a},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=s.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=d.call(arguments),r=n.length,i=1!==r||e&&x.isFunction(e.promise)?r:0,o=1===i?e:x.Deferred(),s=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?d.call(arguments):r,n===a?o.notifyWith(t,n):--i||o.resolveWith(t,n)}},a,u,l;if(r>1)for(a=Array(r),u=Array(r),l=Array(r);r>t;t++)n[t]&&x.isFunction(n[t].promise)?n[t].promise().done(s(t,l,n)).fail(o.reject).progress(s(t,u,a)):--i;return i||o.resolveWith(l,n),o.promise()}}),x.support=function(t){var n=o.createElement("input"),r=o.createDocumentFragment(),i=o.createElement("div"),s=o.createElement("select"),a=s.appendChild(o.createElement("option"));return n.type?(n.type="checkbox",t.checkOn=""!==n.value,t.optSelected=a.selected,t.reliableMarginRight=!0,t.boxSizingReliable=!0,t.pixelPosition=!1,n.checked=!0,t.noCloneChecked=n.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!a.disabled,n=o.createElement("input"),n.value="t",n.type="radio",t.radioValue="t"===n.value,n.setAttribute("checked","t"),n.setAttribute("name","t"),r.appendChild(n),t.checkClone=r.cloneNode(!0).cloneNode(!0).lastChild.checked,t.focusinBubbles="onfocusin"in e,i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===i.style.backgroundClip,x(function(){var n,r,s="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",a=o.getElementsByTagName("body")[0];a&&(n=o.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(n).appendChild(i),i.innerHTML="",i.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",x.swap(a,null!=a.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===i.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(i,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(i,null)||{width:"4px"}).width,r=i.appendChild(o.createElement("div")),r.style.cssText=i.style.cssText=s,r.style.marginRight=r.style.width="0",i.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),a.removeChild(n))}),t):t}({});var L,q,H=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,O=/([A-Z])/g;function F(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=x.expando+Math.random()}F.uid=1,F.accepts=function(e){return e.nodeType?1===e.nodeType||9===e.nodeType:!0},F.prototype={key:function(e){if(!F.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=F.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(r){t[this.expando]=n,x.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var r,i=this.key(e),o=this.cache[i];if("string"==typeof t)o[t]=n;else if(x.isEmptyObject(o))x.extend(this.cache[i],t);else for(r in t)o[r]=t[r];return o},get:function(e,t){var n=this.cache[this.key(e)];return t===undefined?n:n[t]},access:function(e,t,n){var r;return t===undefined||t&&"string"==typeof t&&n===undefined?(r=this.get(e,t),r!==undefined?r:this.get(e,x.camelCase(t))):(this.set(e,t,n),n!==undefined?n:t)},remove:function(e,t){var n,r,i,o=this.key(e),s=this.cache[o];if(t===undefined)this.cache[o]={};else{x.isArray(t)?r=t.concat(t.map(x.camelCase)):(i=x.camelCase(t),t in s?r=[t,i]:(r=i,r=r in s?[r]:r.match(w)||[])),n=r.length;while(n--)delete s[r[n]]}},hasData:function(e){return!x.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}},L=new F,q=new F,x.extend({acceptData:F.accepts,hasData:function(e){return L.hasData(e)||q.hasData(e)},data:function(e,t,n){return L.access(e,t,n)},removeData:function(e,t){L.remove(e,t)},_data:function(e,t,n){return q.access(e,t,n)},_removeData:function(e,t){q.remove(e,t)}}),x.fn.extend({data:function(e,t){var n,r,i=this[0],o=0,s=null;if(e===undefined){if(this.length&&(s=L.get(i),1===i.nodeType&&!q.get(i,"hasDataAttrs"))){for(n=i.attributes;n.length>o;o++)r=n[o].name,0===r.indexOf("data-")&&(r=x.camelCase(r.slice(5)),P(i,r,s[r]));q.set(i,"hasDataAttrs",!0)}return s}return"object"==typeof e?this.each(function(){L.set(this,e)}):x.access(this,function(t){var n,r=x.camelCase(e);if(i&&t===undefined){if(n=L.get(i,e),n!==undefined)return n;if(n=L.get(i,r),n!==undefined)return n;if(n=P(i,r,undefined),n!==undefined)return n}else this.each(function(){var n=L.get(this,r);L.set(this,r,t),-1!==e.indexOf("-")&&n!==undefined&&L.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){L.remove(this,e)})}});function P(e,t,n){var r;if(n===undefined&&1===e.nodeType)if(r="data-"+t.replace(O,"-$1").toLowerCase(),n=e.getAttribute(r),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:H.test(n)?JSON.parse(n):n}catch(i){}L.set(e,t,n)}else n=undefined;return n}x.extend({queue:function(e,t,n){var r;return e?(t=(t||"fx")+"queue",r=q.get(e,t),n&&(!r||x.isArray(n)?r=q.access(e,t,x.makeArray(n)):r.push(n)),r||[]):undefined},dequeue:function(e,t){t=t||"fx";var n=x.queue(e,t),r=n.length,i=n.shift(),o=x._queueHooks(e,t),s=function(){x.dequeue(e,t)
};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,s,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return q.get(e,n)||q.access(e,n,{empty:x.Callbacks("once memory").add(function(){q.remove(e,[t+"queue",n])})})}}),x.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),n>arguments.length?x.queue(this[0],e):t===undefined?this:this.each(function(){var n=x.queue(this,e,t);x._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&x.dequeue(this,e)})},dequeue:function(e){return this.each(function(){x.dequeue(this,e)})},delay:function(e,t){return e=x.fx?x.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=x.Deferred(),o=this,s=this.length,a=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=undefined),e=e||"fx";while(s--)n=q.get(o[s],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(a));return a(),i.promise(t)}});var R,M,W=/[\t\r\n\f]/g,$=/\r/g,B=/^(?:input|select|textarea|button)$/i;x.fn.extend({attr:function(e,t){return x.access(this,x.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){x.removeAttr(this,e)})},prop:function(e,t){return x.access(this,x.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[x.propFix[e]||e]})},addClass:function(e){var t,n,r,i,o,s=0,a=this.length,u="string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).addClass(e.call(this,t,this.className))});if(u)for(t=(e||"").match(w)||[];a>s;s++)if(n=this[s],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):" ")){o=0;while(i=t[o++])0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=x.trim(r)}return this},removeClass:function(e){var t,n,r,i,o,s=0,a=this.length,u=0===arguments.length||"string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).removeClass(e.call(this,t,this.className))});if(u)for(t=(e||"").match(w)||[];a>s;s++)if(n=this[s],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):"")){o=0;while(i=t[o++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?x.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):x.isFunction(e)?this.each(function(n){x(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var t,i=0,o=x(this),s=e.match(w)||[];while(t=s[i++])o.hasClass(t)?o.removeClass(t):o.addClass(t)}else(n===r||"boolean"===n)&&(this.className&&q.set(this,"__className__",this.className),this.className=this.className||e===!1?"":q.get(this,"__className__")||"")})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(W," ").indexOf(t)>=0)return!0;return!1},val:function(e){var t,n,r,i=this[0];{if(arguments.length)return r=x.isFunction(e),this.each(function(n){var i;1===this.nodeType&&(i=r?e.call(this,n,x(this).val()):e,null==i?i="":"number"==typeof i?i+="":x.isArray(i)&&(i=x.map(i,function(e){return null==e?"":e+""})),t=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&t.set(this,i,"value")!==undefined||(this.value=i))});if(i)return t=x.valHooks[i.type]||x.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&(n=t.get(i,"value"))!==undefined?n:(n=i.value,"string"==typeof n?n.replace($,""):null==n?"":n)}}}),x.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||0>i,s=o?null:[],a=o?i+1:r.length,u=0>i?a:o?i:0;for(;a>u;u++)if(n=r[u],!(!n.selected&&u!==i||(x.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&x.nodeName(n.parentNode,"optgroup"))){if(t=x(n).val(),o)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=x.makeArray(t),s=i.length;while(s--)r=i[s],(r.selected=x.inArray(x(r).val(),o)>=0)&&(n=!0);return n||(e.selectedIndex=-1),o}}},attr:function(e,t,n){var i,o,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return typeof e.getAttribute===r?x.prop(e,t,n):(1===s&&x.isXMLDoc(e)||(t=t.toLowerCase(),i=x.attrHooks[t]||(x.expr.match.bool.test(t)?M:R)),n===undefined?i&&"get"in i&&null!==(o=i.get(e,t))?o:(o=x.find.attr(e,t),null==o?undefined:o):null!==n?i&&"set"in i&&(o=i.set(e,n,t))!==undefined?o:(e.setAttribute(t,n+""),n):(x.removeAttr(e,t),undefined))},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(w);if(o&&1===e.nodeType)while(n=o[i++])r=x.propFix[n]||n,x.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!x.support.radioValue&&"radio"===t&&x.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,o,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return o=1!==s||!x.isXMLDoc(e),o&&(t=x.propFix[t]||t,i=x.propHooks[t]),n!==undefined?i&&"set"in i&&(r=i.set(e,n,t))!==undefined?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||B.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),M={set:function(e,t,n){return t===!1?x.removeAttr(e,n):e.setAttribute(n,n),n}},x.each(x.expr.match.bool.source.match(/\w+/g),function(e,t){var n=x.expr.attrHandle[t]||x.find.attr;x.expr.attrHandle[t]=function(e,t,r){var i=x.expr.attrHandle[t],o=r?undefined:(x.expr.attrHandle[t]=undefined)!=n(e,t,r)?t.toLowerCase():null;return x.expr.attrHandle[t]=i,o}}),x.support.optSelected||(x.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){x.propFix[this.toLowerCase()]=this}),x.each(["radio","checkbox"],function(){x.valHooks[this]={set:function(e,t){return x.isArray(t)?e.checked=x.inArray(x(e).val(),t)>=0:undefined}},x.support.checkOn||(x.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var I=/^key/,z=/^(?:mouse|contextmenu)|click/,_=/^(?:focusinfocus|focusoutblur)$/,X=/^([^.]*)(?:\.(.+)|)$/;function U(){return!0}function Y(){return!1}function V(){try{return o.activeElement}catch(e){}}x.event={global:{},add:function(e,t,n,i,o){var s,a,u,l,c,p,f,h,d,g,m,y=q.get(e);if(y){n.handler&&(s=n,n=s.handler,o=s.selector),n.guid||(n.guid=x.guid++),(l=y.events)||(l=y.events={}),(a=y.handle)||(a=y.handle=function(e){return typeof x===r||e&&x.event.triggered===e.type?undefined:x.event.dispatch.apply(a.elem,arguments)},a.elem=e),t=(t||"").match(w)||[""],c=t.length;while(c--)u=X.exec(t[c])||[],d=m=u[1],g=(u[2]||"").split(".").sort(),d&&(f=x.event.special[d]||{},d=(o?f.delegateType:f.bindType)||d,f=x.event.special[d]||{},p=x.extend({type:d,origType:m,data:i,handler:n,guid:n.guid,selector:o,needsContext:o&&x.expr.match.needsContext.test(o),namespace:g.join(".")},s),(h=l[d])||(h=l[d]=[],h.delegateCount=0,f.setup&&f.setup.call(e,i,g,a)!==!1||e.addEventListener&&e.addEventListener(d,a,!1)),f.add&&(f.add.call(e,p),p.handler.guid||(p.handler.guid=n.guid)),o?h.splice(h.delegateCount++,0,p):h.push(p),x.event.global[d]=!0);e=null}},remove:function(e,t,n,r,i){var o,s,a,u,l,c,p,f,h,d,g,m=q.hasData(e)&&q.get(e);if(m&&(u=m.events)){t=(t||"").match(w)||[""],l=t.length;while(l--)if(a=X.exec(t[l])||[],h=g=a[1],d=(a[2]||"").split(".").sort(),h){p=x.event.special[h]||{},h=(r?p.delegateType:p.bindType)||h,f=u[h]||[],a=a[2]&&RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=f.length;while(o--)c=f[o],!i&&g!==c.origType||n&&n.guid!==c.guid||a&&!a.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(f.splice(o,1),c.selector&&f.delegateCount--,p.remove&&p.remove.call(e,c));s&&!f.length&&(p.teardown&&p.teardown.call(e,d,m.handle)!==!1||x.removeEvent(e,h,m.handle),delete u[h])}else for(h in u)x.event.remove(e,h+t[l],n,r,!0);x.isEmptyObject(u)&&(delete m.handle,q.remove(e,"events"))}},trigger:function(t,n,r,i){var s,a,u,l,c,p,f,h=[r||o],d=y.call(t,"type")?t.type:t,g=y.call(t,"namespace")?t.namespace.split("."):[];if(a=u=r=r||o,3!==r.nodeType&&8!==r.nodeType&&!_.test(d+x.event.triggered)&&(d.indexOf(".")>=0&&(g=d.split("."),d=g.shift(),g.sort()),c=0>d.indexOf(":")&&"on"+d,t=t[x.expando]?t:new x.Event(d,"object"==typeof t&&t),t.isTrigger=i?2:3,t.namespace=g.join("."),t.namespace_re=t.namespace?RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=undefined,t.target||(t.target=r),n=null==n?[t]:x.makeArray(n,[t]),f=x.event.special[d]||{},i||!f.trigger||f.trigger.apply(r,n)!==!1)){if(!i&&!f.noBubble&&!x.isWindow(r)){for(l=f.delegateType||d,_.test(l+d)||(a=a.parentNode);a;a=a.parentNode)h.push(a),u=a;u===(r.ownerDocument||o)&&h.push(u.defaultView||u.parentWindow||e)}s=0;while((a=h[s++])&&!t.isPropagationStopped())t.type=s>1?l:f.bindType||d,p=(q.get(a,"events")||{})[t.type]&&q.get(a,"handle"),p&&p.apply(a,n),p=c&&a[c],p&&x.acceptData(a)&&p.apply&&p.apply(a,n)===!1&&t.preventDefault();return t.type=d,i||t.isDefaultPrevented()||f._default&&f._default.apply(h.pop(),n)!==!1||!x.acceptData(r)||c&&x.isFunction(r[d])&&!x.isWindow(r)&&(u=r[c],u&&(r[c]=null),x.event.triggered=d,r[d](),x.event.triggered=undefined,u&&(r[c]=u)),t.result}},dispatch:function(e){e=x.event.fix(e);var t,n,r,i,o,s=[],a=d.call(arguments),u=(q.get(this,"events")||{})[e.type]||[],l=x.event.special[e.type]||{};if(a[0]=e,e.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,e)!==!1){s=x.event.handlers.call(this,e,u),t=0;while((i=s[t++])&&!e.isPropagationStopped()){e.currentTarget=i.elem,n=0;while((o=i.handlers[n++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(o.namespace))&&(e.handleObj=o,e.data=o.data,r=((x.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,a),r!==undefined&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,i,o,s=[],a=t.delegateCount,u=e.target;if(a&&u.nodeType&&(!e.button||"click"!==e.type))for(;u!==this;u=u.parentNode||this)if(u.disabled!==!0||"click"!==e.type){for(r=[],n=0;a>n;n++)o=t[n],i=o.selector+" ",r[i]===undefined&&(r[i]=o.needsContext?x(i,this).index(u)>=0:x.find(i,this,null,[u]).length),r[i]&&r.push(o);r.length&&s.push({elem:u,handlers:r})}return t.length>a&&s.push({elem:this,handlers:t.slice(a)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,s=t.button;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||o,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),e.which||s===undefined||(e.which=1&s?1:2&s?3:4&s?2:0),e}},fix:function(e){if(e[x.expando])return e;var t,n,r,i=e.type,s=e,a=this.fixHooks[i];a||(this.fixHooks[i]=a=z.test(i)?this.mouseHooks:I.test(i)?this.keyHooks:{}),r=a.props?this.props.concat(a.props):this.props,e=new x.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target||(e.target=o),3===e.target.nodeType&&(e.target=e.target.parentNode),a.filter?a.filter(e,s):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==V()&&this.focus?(this.focus(),!1):undefined},delegateType:"focusin"},blur:{trigger:function(){return this===V()&&this.blur?(this.blur(),!1):undefined},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&x.nodeName(this,"input")?(this.click(),!1):undefined},_default:function(e){return x.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=x.extend(new x.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?x.event.trigger(i,null,t):x.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},x.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},x.Event=function(e,t){return this instanceof x.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.getPreventDefault&&e.getPreventDefault()?U:Y):this.type=e,t&&x.extend(this,t),this.timeStamp=e&&e.timeStamp||x.now(),this[x.expando]=!0,undefined):new x.Event(e,t)},x.Event.prototype={isDefaultPrevented:Y,isPropagationStopped:Y,isImmediatePropagationStopped:Y,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=U,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=U,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=U,this.stopPropagation()}},x.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){x.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return(!i||i!==r&&!x.contains(r,i))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),x.support.focusinBubbles||x.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){x.event.simulate(t,e.target,x.event.fix(e),!0)};x.event.special[t]={setup:function(){0===n++&&o.addEventListener(e,r,!0)},teardown:function(){0===--n&&o.removeEventListener(e,r,!0)}}}),x.fn.extend({on:function(e,t,n,r,i){var o,s;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=undefined);for(s in e)this.on(s,t,n,e[s],i);return this}if(null==n&&null==r?(r=t,n=t=undefined):null==r&&("string"==typeof t?(r=n,n=undefined):(r=n,n=t,t=undefined)),r===!1)r=Y;else if(!r)return this;return 1===i&&(o=r,r=function(e){return x().off(e),o.apply(this,arguments)},r.guid=o.guid||(o.guid=x.guid++)),this.each(function(){x.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,x(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=undefined),n===!1&&(n=Y),this.each(function(){x.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){x.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?x.event.trigger(e,t,n,!0):undefined}});var G=/^.[^:#\[\.,]*$/,J=/^(?:parents|prev(?:Until|All))/,Q=x.expr.match.needsContext,K={children:!0,contents:!0,next:!0,prev:!0};x.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(x(e).filter(function(){for(t=0;i>t;t++)if(x.contains(r[t],this))return!0}));for(t=0;i>t;t++)x.find(e,r[t],n);return n=this.pushStack(i>1?x.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t=x(e,this),n=t.length;return this.filter(function(){var e=0;for(;n>e;e++)if(x.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(et(this,e||[],!0))},filter:function(e){return this.pushStack(et(this,e||[],!1))},is:function(e){return!!et(this,"string"==typeof e&&Q.test(e)?x(e):e||[],!1).length},closest:function(e,t){var n,r=0,i=this.length,o=[],s=Q.test(e)||"string"!=typeof e?x(e,t||this.context):0;for(;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(11>n.nodeType&&(s?s.index(n)>-1:1===n.nodeType&&x.find.matchesSelector(n,e))){n=o.push(n);break}return this.pushStack(o.length>1?x.unique(o):o)},index:function(e){return e?"string"==typeof e?g.call(x(e),this[0]):g.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?x(e,t):x.makeArray(e&&e.nodeType?[e]:e),r=x.merge(this.get(),n);return this.pushStack(x.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}});function Z(e,t){while((e=e[t])&&1!==e.nodeType);return e}x.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return x.dir(e,"parentNode")},parentsUntil:function(e,t,n){return x.dir(e,"parentNode",n)},next:function(e){return Z(e,"nextSibling")},prev:function(e){return Z(e,"previousSibling")},nextAll:function(e){return x.dir(e,"nextSibling")},prevAll:function(e){return x.dir(e,"previousSibling")},nextUntil:function(e,t,n){return x.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return x.dir(e,"previousSibling",n)},siblings:function(e){return x.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return x.sibling(e.firstChild)},contents:function(e){return e.contentDocument||x.merge([],e.childNodes)}},function(e,t){x.fn[e]=function(n,r){var i=x.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=x.filter(r,i)),this.length>1&&(K[e]||x.unique(i),J.test(e)&&i.reverse()),this.pushStack(i)}}),x.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?x.find.matchesSelector(r,e)?[r]:[]:x.find.matches(e,x.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,t,n){var r=[],i=n!==undefined;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&x(e).is(n))break;r.push(e)}return r},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});function et(e,t,n){if(x.isFunction(t))return x.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return x.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(G.test(t))return x.filter(t,e,n);t=x.filter(t,e)}return x.grep(e,function(e){return g.call(t,e)>=0!==n})}var tt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,nt=/<([\w:]+)/,rt=/<|&#?\w+;/,it=/<(?:script|style|link)/i,ot=/^(?:checkbox|radio)$/i,st=/checked\s*(?:[^=]|=\s*.checked.)/i,at=/^$|\/(?:java|ecma)script/i,ut=/^true\/(.*)/,lt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ct={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ct.optgroup=ct.option,ct.tbody=ct.tfoot=ct.colgroup=ct.caption=ct.thead,ct.th=ct.td,x.fn.extend({text:function(e){return x.access(this,function(e){return e===undefined?x.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=pt(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=pt(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?x.filter(e,this):this,i=0;for(;null!=(n=r[i]);i++)t||1!==n.nodeType||x.cleanData(mt(n)),n.parentNode&&(t&&x.contains(n.ownerDocument,n)&&dt(mt(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++)1===e.nodeType&&(x.cleanData(mt(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return x.clone(this,e,t)})},html:function(e){return x.access(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===undefined&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!it.test(e)&&!ct[(nt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(tt,"<$1></$2>");try{for(;r>n;n++)t=this[n]||{},1===t.nodeType&&(x.cleanData(mt(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=x.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(r&&r.parentNode!==i&&(r=this.nextSibling),x(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=f.apply([],e);var r,i,o,s,a,u,l=0,c=this.length,p=this,h=c-1,d=e[0],g=x.isFunction(d);if(g||!(1>=c||"string"!=typeof d||x.support.checkClone)&&st.test(d))return this.each(function(r){var i=p.eq(r);g&&(e[0]=d.call(this,r,i.html())),i.domManip(e,t,n)});if(c&&(r=x.buildFragment(e,this[0].ownerDocument,!1,!n&&this),i=r.firstChild,1===r.childNodes.length&&(r=i),i)){for(o=x.map(mt(r,"script"),ft),s=o.length;c>l;l++)a=r,l!==h&&(a=x.clone(a,!0,!0),s&&x.merge(o,mt(a,"script"))),t.call(this[l],a,l);if(s)for(u=o[o.length-1].ownerDocument,x.map(o,ht),l=0;s>l;l++)a=o[l],at.test(a.type||"")&&!q.access(a,"globalEval")&&x.contains(u,a)&&(a.src?x._evalUrl(a.src):x.globalEval(a.textContent.replace(lt,"")))}return this}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){x.fn[e]=function(e){var n,r=[],i=x(e),o=i.length-1,s=0;for(;o>=s;s++)n=s===o?this:this.clone(!0),x(i[s])[t](n),h.apply(r,n.get());return this.pushStack(r)}}),x.extend({clone:function(e,t,n){var r,i,o,s,a=e.cloneNode(!0),u=x.contains(e.ownerDocument,e);if(!(x.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||x.isXMLDoc(e)))for(s=mt(a),o=mt(e),r=0,i=o.length;i>r;r++)yt(o[r],s[r]);if(t)if(n)for(o=o||mt(e),s=s||mt(a),r=0,i=o.length;i>r;r++)gt(o[r],s[r]);else gt(e,a);return s=mt(a,"script"),s.length>0&&dt(s,!u&&mt(e,"script")),a},buildFragment:function(e,t,n,r){var i,o,s,a,u,l,c=0,p=e.length,f=t.createDocumentFragment(),h=[];for(;p>c;c++)if(i=e[c],i||0===i)if("object"===x.type(i))x.merge(h,i.nodeType?[i]:i);else if(rt.test(i)){o=o||f.appendChild(t.createElement("div")),s=(nt.exec(i)||["",""])[1].toLowerCase(),a=ct[s]||ct._default,o.innerHTML=a[1]+i.replace(tt,"<$1></$2>")+a[2],l=a[0];while(l--)o=o.lastChild;x.merge(h,o.childNodes),o=f.firstChild,o.textContent=""}else h.push(t.createTextNode(i));f.textContent="",c=0;while(i=h[c++])if((!r||-1===x.inArray(i,r))&&(u=x.contains(i.ownerDocument,i),o=mt(f.appendChild(i),"script"),u&&dt(o),n)){l=0;while(i=o[l++])at.test(i.type||"")&&n.push(i)}return f},cleanData:function(e){var t,n,r,i,o,s,a=x.event.special,u=0;for(;(n=e[u])!==undefined;u++){if(F.accepts(n)&&(o=n[q.expando],o&&(t=q.cache[o]))){if(r=Object.keys(t.events||{}),r.length)for(s=0;(i=r[s])!==undefined;s++)a[i]?x.event.remove(n,i):x.removeEvent(n,i,t.handle);q.cache[o]&&delete q.cache[o]}delete L.cache[n[L.expando]]}},_evalUrl:function(e){return x.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}});function pt(e,t){return x.nodeName(e,"table")&&x.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function ft(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function ht(e){var t=ut.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function dt(e,t){var n=e.length,r=0;for(;n>r;r++)q.set(e[r],"globalEval",!t||q.get(t[r],"globalEval"))}function gt(e,t){var n,r,i,o,s,a,u,l;if(1===t.nodeType){if(q.hasData(e)&&(o=q.access(e),s=q.set(t,o),l=o.events)){delete s.handle,s.events={};for(i in l)for(n=0,r=l[i].length;r>n;n++)x.event.add(t,i,l[i][n])}L.hasData(e)&&(a=L.access(e),u=x.extend({},a),L.set(t,u))}}function mt(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return t===undefined||t&&x.nodeName(e,t)?x.merge([e],n):n}function yt(e,t){var n=t.nodeName.toLowerCase();"input"===n&&ot.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}x.fn.extend({wrapAll:function(e){var t;return x.isFunction(e)?this.each(function(t){x(this).wrapAll(e.call(this,t))}):(this[0]&&(t=x(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return x.isFunction(e)?this.each(function(t){x(this).wrapInner(e.call(this,t))}):this.each(function(){var t=x(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=x.isFunction(e);return this.each(function(n){x(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){x.nodeName(this,"body")||x(this).replaceWith(this.childNodes)}).end()}});var vt,xt,bt=/^(none|table(?!-c[ea]).+)/,wt=/^margin/,Tt=RegExp("^("+b+")(.*)$","i"),Ct=RegExp("^("+b+")(?!px)[a-z%]+$","i"),kt=RegExp("^([+-])=("+b+")","i"),Nt={BODY:"block"},Et={position:"absolute",visibility:"hidden",display:"block"},St={letterSpacing:0,fontWeight:400},jt=["Top","Right","Bottom","Left"],Dt=["Webkit","O","Moz","ms"];function At(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Dt.length;while(i--)if(t=Dt[i]+n,t in e)return t;return r}function Lt(e,t){return e=t||e,"none"===x.css(e,"display")||!x.contains(e.ownerDocument,e)}function qt(t){return e.getComputedStyle(t,null)}function Ht(e,t){var n,r,i,o=[],s=0,a=e.length;for(;a>s;s++)r=e[s],r.style&&(o[s]=q.get(r,"olddisplay"),n=r.style.display,t?(o[s]||"none"!==n||(r.style.display=""),""===r.style.display&&Lt(r)&&(o[s]=q.access(r,"olddisplay",Rt(r.nodeName)))):o[s]||(i=Lt(r),(n&&"none"!==n||!i)&&q.set(r,"olddisplay",i?n:x.css(r,"display"))));for(s=0;a>s;s++)r=e[s],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[s]||"":"none"));return e}x.fn.extend({css:function(e,t){return x.access(this,function(e,t,n){var r,i,o={},s=0;if(x.isArray(t)){for(r=qt(e),i=t.length;i>s;s++)o[t[s]]=x.css(e,t[s],!1,r);return o}return n!==undefined?x.style(e,t,n):x.css(e,t)},e,t,arguments.length>1)},show:function(){return Ht(this,!0)},hide:function(){return Ht(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Lt(this)?x(this).show():x(this).hide()})}}),x.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=vt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,s,a=x.camelCase(t),u=e.style;return t=x.cssProps[a]||(x.cssProps[a]=At(u,a)),s=x.cssHooks[t]||x.cssHooks[a],n===undefined?s&&"get"in s&&(i=s.get(e,!1,r))!==undefined?i:u[t]:(o=typeof n,"string"===o&&(i=kt.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(x.css(e,t)),o="number"),null==n||"number"===o&&isNaN(n)||("number"!==o||x.cssNumber[a]||(n+="px"),x.support.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),s&&"set"in s&&(n=s.set(e,n,r))===undefined||(u[t]=n)),undefined)}},css:function(e,t,n,r){var i,o,s,a=x.camelCase(t);return t=x.cssProps[a]||(x.cssProps[a]=At(e.style,a)),s=x.cssHooks[t]||x.cssHooks[a],s&&"get"in s&&(i=s.get(e,!0,n)),i===undefined&&(i=vt(e,t,r)),"normal"===i&&t in St&&(i=St[t]),""===n||n?(o=parseFloat(i),n===!0||x.isNumeric(o)?o||0:i):i}}),vt=function(e,t,n){var r,i,o,s=n||qt(e),a=s?s.getPropertyValue(t)||s[t]:undefined,u=e.style;return s&&(""!==a||x.contains(e.ownerDocument,e)||(a=x.style(e,t)),Ct.test(a)&&wt.test(t)&&(r=u.width,i=u.minWidth,o=u.maxWidth,u.minWidth=u.maxWidth=u.width=a,a=s.width,u.width=r,u.minWidth=i,u.maxWidth=o)),a};function Ot(e,t,n){var r=Tt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function Ft(e,t,n,r,i){var o=n===(r?"border":"content")?4:"width"===t?1:0,s=0;for(;4>o;o+=2)"margin"===n&&(s+=x.css(e,n+jt[o],!0,i)),r?("content"===n&&(s-=x.css(e,"padding"+jt[o],!0,i)),"margin"!==n&&(s-=x.css(e,"border"+jt[o]+"Width",!0,i))):(s+=x.css(e,"padding"+jt[o],!0,i),"padding"!==n&&(s+=x.css(e,"border"+jt[o]+"Width",!0,i)));return s}function Pt(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=qt(e),s=x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,o);if(0>=i||null==i){if(i=vt(e,t,o),(0>i||null==i)&&(i=e.style[t]),Ct.test(i))return i;r=s&&(x.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+Ft(e,t,n||(s?"border":"content"),r,o)+"px"}function Rt(e){var t=o,n=Nt[e];return n||(n=Mt(e,t),"none"!==n&&n||(xt=(xt||x("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(xt[0].contentWindow||xt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=Mt(e,t),xt.detach()),Nt[e]=n),n}function Mt(e,t){var n=x(t.createElement(e)).appendTo(t.body),r=x.css(n[0],"display");return n.remove(),r}x.each(["height","width"],function(e,t){x.cssHooks[t]={get:function(e,n,r){return n?0===e.offsetWidth&&bt.test(x.css(e,"display"))?x.swap(e,Et,function(){return Pt(e,t,r)}):Pt(e,t,r):undefined},set:function(e,n,r){var i=r&&qt(e);return Ot(e,n,r?Ft(e,t,r,x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,i),i):0)}}}),x(function(){x.support.reliableMarginRight||(x.cssHooks.marginRight={get:function(e,t){return t?x.swap(e,{display:"inline-block"},vt,[e,"marginRight"]):undefined}}),!x.support.pixelPosition&&x.fn.position&&x.each(["top","left"],function(e,t){x.cssHooks[t]={get:function(e,n){return n?(n=vt(e,t),Ct.test(n)?x(e).position()[t]+"px":n):undefined}}})}),x.expr&&x.expr.filters&&(x.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight},x.expr.filters.visible=function(e){return!x.expr.filters.hidden(e)}),x.each({margin:"",padding:"",border:"Width"},function(e,t){x.cssHooks[e+t]={expand:function(n){var r=0,i={},o="string"==typeof n?n.split(" "):[n];for(;4>r;r++)i[e+jt[r]+t]=o[r]||o[r-2]||o[0];return i}},wt.test(e)||(x.cssHooks[e+t].set=Ot)});var Wt=/%20/g,$t=/\[\]$/,Bt=/\r?\n/g,It=/^(?:submit|button|image|reset|file)$/i,zt=/^(?:input|select|textarea|keygen)/i;x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=x.prop(this,"elements");return e?x.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!x(this).is(":disabled")&&zt.test(this.nodeName)&&!It.test(e)&&(this.checked||!ot.test(e))}).map(function(e,t){var n=x(this).val();return null==n?null:x.isArray(n)?x.map(n,function(e){return{name:t.name,value:e.replace(Bt,"\r\n")}}):{name:t.name,value:n.replace(Bt,"\r\n")}}).get()}}),x.param=function(e,t){var n,r=[],i=function(e,t){t=x.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(t===undefined&&(t=x.ajaxSettings&&x.ajaxSettings.traditional),x.isArray(e)||e.jquery&&!x.isPlainObject(e))x.each(e,function(){i(this.name,this.value)});else for(n in e)_t(n,e[n],t,i);return r.join("&").replace(Wt,"+")};function _t(e,t,n,r){var i;if(x.isArray(t))x.each(t,function(t,i){n||$t.test(e)?r(e,i):_t(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==x.type(t))r(e,t);else for(i in t)_t(e+"["+i+"]",t[i],n,r)}x.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){x.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),x.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)
},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var Xt,Ut,Yt=x.now(),Vt=/\?/,Gt=/#.*$/,Jt=/([?&])_=[^&]*/,Qt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Kt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Zt=/^(?:GET|HEAD)$/,en=/^\/\//,tn=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,nn=x.fn.load,rn={},on={},sn="*/".concat("*");try{Ut=i.href}catch(an){Ut=o.createElement("a"),Ut.href="",Ut=Ut.href}Xt=tn.exec(Ut.toLowerCase())||[];function un(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(w)||[];if(x.isFunction(n))while(r=o[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function ln(e,t,n,r){var i={},o=e===on;function s(a){var u;return i[a]=!0,x.each(e[a]||[],function(e,a){var l=a(t,n,r);return"string"!=typeof l||o||i[l]?o?!(u=l):undefined:(t.dataTypes.unshift(l),s(l),!1)}),u}return s(t.dataTypes[0])||!i["*"]&&s("*")}function cn(e,t){var n,r,i=x.ajaxSettings.flatOptions||{};for(n in t)t[n]!==undefined&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&x.extend(!0,e,r),e}x.fn.load=function(e,t,n){if("string"!=typeof e&&nn)return nn.apply(this,arguments);var r,i,o,s=this,a=e.indexOf(" ");return a>=0&&(r=e.slice(a),e=e.slice(0,a)),x.isFunction(t)?(n=t,t=undefined):t&&"object"==typeof t&&(i="POST"),s.length>0&&x.ajax({url:e,type:i,dataType:"html",data:t}).done(function(e){o=arguments,s.html(r?x("<div>").append(x.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){s.each(n,o||[e.responseText,t,e])}),this},x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){x.fn[t]=function(e){return this.on(t,e)}}),x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ut,type:"GET",isLocal:Kt.test(Xt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":sn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":x.parseJSON,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?cn(cn(e,x.ajaxSettings),t):cn(x.ajaxSettings,e)},ajaxPrefilter:un(rn),ajaxTransport:un(on),ajax:function(e,t){"object"==typeof e&&(t=e,e=undefined),t=t||{};var n,r,i,o,s,a,u,l,c=x.ajaxSetup({},t),p=c.context||c,f=c.context&&(p.nodeType||p.jquery)?x(p):x.event,h=x.Deferred(),d=x.Callbacks("once memory"),g=c.statusCode||{},m={},y={},v=0,b="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(2===v){if(!o){o={};while(t=Qt.exec(i))o[t[1].toLowerCase()]=t[2]}t=o[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===v?i:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return v||(e=y[n]=y[n]||e,m[e]=t),this},overrideMimeType:function(e){return v||(c.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>v)for(t in e)g[t]=[g[t],e[t]];else T.always(e[T.status]);return this},abort:function(e){var t=e||b;return n&&n.abort(t),k(0,t),this}};if(h.promise(T).complete=d.add,T.success=T.done,T.error=T.fail,c.url=((e||c.url||Ut)+"").replace(Gt,"").replace(en,Xt[1]+"//"),c.type=t.method||t.type||c.method||c.type,c.dataTypes=x.trim(c.dataType||"*").toLowerCase().match(w)||[""],null==c.crossDomain&&(a=tn.exec(c.url.toLowerCase()),c.crossDomain=!(!a||a[1]===Xt[1]&&a[2]===Xt[2]&&(a[3]||("http:"===a[1]?"80":"443"))===(Xt[3]||("http:"===Xt[1]?"80":"443")))),c.data&&c.processData&&"string"!=typeof c.data&&(c.data=x.param(c.data,c.traditional)),ln(rn,c,t,T),2===v)return T;u=c.global,u&&0===x.active++&&x.event.trigger("ajaxStart"),c.type=c.type.toUpperCase(),c.hasContent=!Zt.test(c.type),r=c.url,c.hasContent||(c.data&&(r=c.url+=(Vt.test(r)?"&":"?")+c.data,delete c.data),c.cache===!1&&(c.url=Jt.test(r)?r.replace(Jt,"$1_="+Yt++):r+(Vt.test(r)?"&":"?")+"_="+Yt++)),c.ifModified&&(x.lastModified[r]&&T.setRequestHeader("If-Modified-Since",x.lastModified[r]),x.etag[r]&&T.setRequestHeader("If-None-Match",x.etag[r])),(c.data&&c.hasContent&&c.contentType!==!1||t.contentType)&&T.setRequestHeader("Content-Type",c.contentType),T.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+("*"!==c.dataTypes[0]?", "+sn+"; q=0.01":""):c.accepts["*"]);for(l in c.headers)T.setRequestHeader(l,c.headers[l]);if(c.beforeSend&&(c.beforeSend.call(p,T,c)===!1||2===v))return T.abort();b="abort";for(l in{success:1,error:1,complete:1})T[l](c[l]);if(n=ln(on,c,t,T)){T.readyState=1,u&&f.trigger("ajaxSend",[T,c]),c.async&&c.timeout>0&&(s=setTimeout(function(){T.abort("timeout")},c.timeout));try{v=1,n.send(m,k)}catch(C){if(!(2>v))throw C;k(-1,C)}}else k(-1,"No Transport");function k(e,t,o,a){var l,m,y,b,w,C=t;2!==v&&(v=2,s&&clearTimeout(s),n=undefined,i=a||"",T.readyState=e>0?4:0,l=e>=200&&300>e||304===e,o&&(b=pn(c,T,o)),b=fn(c,b,T,l),l?(c.ifModified&&(w=T.getResponseHeader("Last-Modified"),w&&(x.lastModified[r]=w),w=T.getResponseHeader("etag"),w&&(x.etag[r]=w)),204===e||"HEAD"===c.type?C="nocontent":304===e?C="notmodified":(C=b.state,m=b.data,y=b.error,l=!y)):(y=C,(e||!C)&&(C="error",0>e&&(e=0))),T.status=e,T.statusText=(t||C)+"",l?h.resolveWith(p,[m,C,T]):h.rejectWith(p,[T,C,y]),T.statusCode(g),g=undefined,u&&f.trigger(l?"ajaxSuccess":"ajaxError",[T,c,l?m:y]),d.fireWith(p,[T,C]),u&&(f.trigger("ajaxComplete",[T,c]),--x.active||x.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,n){return x.get(e,t,n,"json")},getScript:function(e,t){return x.get(e,undefined,t,"script")}}),x.each(["get","post"],function(e,t){x[t]=function(e,n,r,i){return x.isFunction(n)&&(i=i||r,r=n,n=undefined),x.ajax({url:e,type:t,dataType:i,data:n,success:r})}});function pn(e,t,n){var r,i,o,s,a=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),r===undefined&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in a)if(a[i]&&a[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}s||(s=i)}o=o||s}return o?(o!==u[0]&&u.unshift(o),n[o]):undefined}function fn(e,t,n,r){var i,o,s,a,u,l={},c=e.dataTypes.slice();if(c[1])for(s in e.converters)l[s.toLowerCase()]=e.converters[s];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(s=l[u+" "+o]||l["* "+o],!s)for(i in l)if(a=i.split(" "),a[1]===o&&(s=l[u+" "+a[0]]||l["* "+a[0]])){s===!0?s=l[i]:l[i]!==!0&&(o=a[0],c.unshift(a[1]));break}if(s!==!0)if(s&&e["throws"])t=s(t);else try{t=s(t)}catch(p){return{state:"parsererror",error:s?p:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return x.globalEval(e),e}}}),x.ajaxPrefilter("script",function(e){e.cache===undefined&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),x.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=x("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),o.head.appendChild(t[0])},abort:function(){n&&n()}}}});var hn=[],dn=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=hn.pop()||x.expando+"_"+Yt++;return this[e]=!0,e}}),x.ajaxPrefilter("json jsonp",function(t,n,r){var i,o,s,a=t.jsonp!==!1&&(dn.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&dn.test(t.data)&&"data");return a||"jsonp"===t.dataTypes[0]?(i=t.jsonpCallback=x.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(dn,"$1"+i):t.jsonp!==!1&&(t.url+=(Vt.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return s||x.error(i+" was not called"),s[0]},t.dataTypes[0]="json",o=e[i],e[i]=function(){s=arguments},r.always(function(){e[i]=o,t[i]&&(t.jsonpCallback=n.jsonpCallback,hn.push(i)),s&&x.isFunction(o)&&o(s[0]),s=o=undefined}),"script"):undefined}),x.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var gn=x.ajaxSettings.xhr(),mn={0:200,1223:204},yn=0,vn={};e.ActiveXObject&&x(e).on("unload",function(){for(var e in vn)vn[e]();vn=undefined}),x.support.cors=!!gn&&"withCredentials"in gn,x.support.ajax=gn=!!gn,x.ajaxTransport(function(e){var t;return x.support.cors||gn&&!e.crossDomain?{send:function(n,r){var i,o,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(i in e.xhrFields)s[i]=e.xhrFields[i];e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(i in n)s.setRequestHeader(i,n[i]);t=function(e){return function(){t&&(delete vn[o],t=s.onload=s.onerror=null,"abort"===e?s.abort():"error"===e?r(s.status||404,s.statusText):r(mn[s.status]||s.status,s.statusText,"string"==typeof s.responseText?{text:s.responseText}:undefined,s.getAllResponseHeaders()))}},s.onload=t(),s.onerror=t("error"),t=vn[o=yn++]=t("abort"),s.send(e.hasContent&&e.data||null)},abort:function(){t&&t()}}:undefined});var xn,bn,wn=/^(?:toggle|show|hide)$/,Tn=RegExp("^(?:([+-])=|)("+b+")([a-z%]*)$","i"),Cn=/queueHooks$/,kn=[An],Nn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=Tn.exec(t),o=i&&i[3]||(x.cssNumber[e]?"":"px"),s=(x.cssNumber[e]||"px"!==o&&+r)&&Tn.exec(x.css(n.elem,e)),a=1,u=20;if(s&&s[3]!==o){o=o||s[3],i=i||[],s=+r||1;do a=a||".5",s/=a,x.style(n.elem,e,s+o);while(a!==(a=n.cur()/r)&&1!==a&&--u)}return i&&(s=n.start=+s||+r||0,n.unit=o,n.end=i[1]?s+(i[1]+1)*i[2]:+i[2]),n}]};function En(){return setTimeout(function(){xn=undefined}),xn=x.now()}function Sn(e,t,n){var r,i=(Nn[t]||[]).concat(Nn["*"]),o=0,s=i.length;for(;s>o;o++)if(r=i[o].call(n,t,e))return r}function jn(e,t,n){var r,i,o=0,s=kn.length,a=x.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;var t=xn||En(),n=Math.max(0,l.startTime+l.duration-t),r=n/l.duration||0,o=1-r,s=0,u=l.tweens.length;for(;u>s;s++)l.tweens[s].run(o);return a.notifyWith(e,[l,o,n]),1>o&&u?n:(a.resolveWith(e,[l]),!1)},l=a.promise({elem:e,props:x.extend({},t),opts:x.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:xn||En(),duration:n.duration,tweens:[],createTween:function(t,n){var r=x.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)l.tweens[n].run(1);return t?a.resolveWith(e,[l,t]):a.rejectWith(e,[l,t]),this}}),c=l.props;for(Dn(c,l.opts.specialEasing);s>o;o++)if(r=kn[o].call(l,e,c,l.opts))return r;return x.map(c,Sn,l),x.isFunction(l.opts.start)&&l.opts.start.call(e,l),x.fx.timer(x.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function Dn(e,t){var n,r,i,o,s;for(n in e)if(r=x.camelCase(n),i=t[r],o=e[n],x.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),s=x.cssHooks[r],s&&"expand"in s){o=s.expand(o),delete e[r];for(n in o)n in e||(e[n]=o[n],t[n]=i)}else t[r]=i}x.Animation=x.extend(jn,{tweener:function(e,t){x.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Nn[n]=Nn[n]||[],Nn[n].unshift(t)},prefilter:function(e,t){t?kn.unshift(e):kn.push(e)}});function An(e,t,n){var r,i,o,s,a,u,l=this,c={},p=e.style,f=e.nodeType&&Lt(e),h=q.get(e,"fxshow");n.queue||(a=x._queueHooks(e,"fx"),null==a.unqueued&&(a.unqueued=0,u=a.empty.fire,a.empty.fire=function(){a.unqueued||u()}),a.unqueued++,l.always(function(){l.always(function(){a.unqueued--,x.queue(e,"fx").length||a.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===x.css(e,"display")&&"none"===x.css(e,"float")&&(p.display="inline-block")),n.overflow&&(p.overflow="hidden",l.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],wn.exec(i)){if(delete t[r],o=o||"toggle"===i,i===(f?"hide":"show")){if("show"!==i||!h||h[r]===undefined)continue;f=!0}c[r]=h&&h[r]||x.style(e,r)}if(!x.isEmptyObject(c)){h?"hidden"in h&&(f=h.hidden):h=q.access(e,"fxshow",{}),o&&(h.hidden=!f),f?x(e).show():l.done(function(){x(e).hide()}),l.done(function(){var t;q.remove(e,"fxshow");for(t in c)x.style(e,t,c[t])});for(r in c)s=Sn(f?h[r]:0,r,l),r in h||(h[r]=s.start,f&&(s.end=s.start,s.start="width"===r||"height"===r?1:0))}}function Ln(e,t,n,r,i){return new Ln.prototype.init(e,t,n,r,i)}x.Tween=Ln,Ln.prototype={constructor:Ln,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(x.cssNumber[n]?"":"px")},cur:function(){var e=Ln.propHooks[this.prop];return e&&e.get?e.get(this):Ln.propHooks._default.get(this)},run:function(e){var t,n=Ln.propHooks[this.prop];return this.pos=t=this.options.duration?x.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Ln.propHooks._default.set(this),this}},Ln.prototype.init.prototype=Ln.prototype,Ln.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=x.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){x.fx.step[e.prop]?x.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[x.cssProps[e.prop]]||x.cssHooks[e.prop])?x.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Ln.propHooks.scrollTop=Ln.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},x.each(["toggle","show","hide"],function(e,t){var n=x.fn[t];x.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(qn(t,!0),e,r,i)}}),x.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Lt).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=x.isEmptyObject(e),o=x.speed(t,n,r),s=function(){var t=jn(this,x.extend({},e),o);(i||q.get(this,"finish"))&&t.stop(!0)};return s.finish=s,i||o.queue===!1?this.each(s):this.queue(o.queue,s)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=undefined),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=x.timers,s=q.get(this);if(i)s[i]&&s[i].stop&&r(s[i]);else for(i in s)s[i]&&s[i].stop&&Cn.test(i)&&r(s[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));(t||!n)&&x.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=q.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=x.timers,s=r?r.length:0;for(n.finish=!0,x.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;s>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}});function qn(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=jt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}x.each({slideDown:qn("show"),slideUp:qn("hide"),slideToggle:qn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){x.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),x.speed=function(e,t,n){var r=e&&"object"==typeof e?x.extend({},e):{complete:n||!n&&t||x.isFunction(e)&&e,duration:e,easing:n&&t||t&&!x.isFunction(t)&&t};return r.duration=x.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in x.fx.speeds?x.fx.speeds[r.duration]:x.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){x.isFunction(r.old)&&r.old.call(this),r.queue&&x.dequeue(this,r.queue)},r},x.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},x.timers=[],x.fx=Ln.prototype.init,x.fx.tick=function(){var e,t=x.timers,n=0;for(xn=x.now();t.length>n;n++)e=t[n],e()||t[n]!==e||t.splice(n--,1);t.length||x.fx.stop(),xn=undefined},x.fx.timer=function(e){e()&&x.timers.push(e)&&x.fx.start()},x.fx.interval=13,x.fx.start=function(){bn||(bn=setInterval(x.fx.tick,x.fx.interval))},x.fx.stop=function(){clearInterval(bn),bn=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fx.step={},x.expr&&x.expr.filters&&(x.expr.filters.animated=function(e){return x.grep(x.timers,function(t){return e===t.elem}).length}),x.fn.offset=function(e){if(arguments.length)return e===undefined?this:this.each(function(t){x.offset.setOffset(this,e,t)});var t,n,i=this[0],o={top:0,left:0},s=i&&i.ownerDocument;if(s)return t=s.documentElement,x.contains(t,i)?(typeof i.getBoundingClientRect!==r&&(o=i.getBoundingClientRect()),n=Hn(s),{top:o.top+n.pageYOffset-t.clientTop,left:o.left+n.pageXOffset-t.clientLeft}):o},x.offset={setOffset:function(e,t,n){var r,i,o,s,a,u,l,c=x.css(e,"position"),p=x(e),f={};"static"===c&&(e.style.position="relative"),a=p.offset(),o=x.css(e,"top"),u=x.css(e,"left"),l=("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1,l?(r=p.position(),s=r.top,i=r.left):(s=parseFloat(o)||0,i=parseFloat(u)||0),x.isFunction(t)&&(t=t.call(e,n,a)),null!=t.top&&(f.top=t.top-a.top+s),null!=t.left&&(f.left=t.left-a.left+i),"using"in t?t.using.call(e,f):p.css(f)}},x.fn.extend({position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===x.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),x.nodeName(e[0],"html")||(r=e.offset()),r.top+=x.css(e[0],"borderTopWidth",!0),r.left+=x.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-x.css(n,"marginTop",!0),left:t.left-r.left-x.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||s;while(e&&!x.nodeName(e,"html")&&"static"===x.css(e,"position"))e=e.offsetParent;return e||s})}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,n){var r="pageYOffset"===n;x.fn[t]=function(i){return x.access(this,function(t,i,o){var s=Hn(t);return o===undefined?s?s[n]:t[i]:(s?s.scrollTo(r?e.pageXOffset:o,r?o:e.pageYOffset):t[i]=o,undefined)},t,i,arguments.length,null)}});function Hn(e){return x.isWindow(e)?e:9===e.nodeType&&e.defaultView}x.each({Height:"height",Width:"width"},function(e,t){x.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){x.fn[r]=function(r,i){var o=arguments.length&&(n||"boolean"!=typeof r),s=n||(r===!0||i===!0?"margin":"border");return x.access(this,function(t,n,r){var i;return x.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):r===undefined?x.css(t,n,s):x.style(t,n,r,s)},t,o?r:undefined,o,null)}})}),x.fn.size=function(){return this.length},x.fn.andSelf=x.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=x:"function"==typeof define&&define.amd&&define("jquery",[],function(){return x}),"object"==typeof e&&"object"==typeof e.document&&(e.jQuery=e.$=x)})(window);
(function(l){var b=jQuery.fn.jquery>="1.8";var m={xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",html:"http://www.w3.org/1999/xhtml/"};rbackslash=/\\(?!\\)/g;var r={};for(var f in m){r[m[f]]=f}l.extend({xmlns:l.extend({},m,{"":"*"})});var n=[];l.fn.extend({xmlns:function(u,v){if(typeof u=="string"){u={"":u}}if(u){n.push(l.xmlns);l.xmlns=l.extend({},l.xmlns,u);if(v!==undefined){if(typeof v=="string"){return this.find(v).xmlns(undefined)}else{var t=this;try{t=v.call(this);if(!t){t=this}}finally{t.xmlns(undefined)}return t}}else{return this}}else{l.xmlns=(n?n.pop():{});return this}}});var p=function(u){if(!u){return l.xmlns[""]}u=u.substr(0,u.length-1);if(u==""||u=="*"){return u}var t=l.xmlns[u];if(typeof(t)=="undefined"){throw"Syntax error, undefined namespace prefix '"+u+"'"}return t};var g=(b)?function(t,u){l.expr.match[t]=u}:function(t,u){l.expr.match[t]=new RegExp(u.source+/(?![^\[]*\])(?![^\(]*\))/.source);if(l.expr.leftMatch){l.expr.leftMatch[t]=new RegExp(/(^(?:.|\r|\n)*?)/.source+l.expr.match[t].source.replace(/\\(\d+)/g,function(w,v){return"\\"+(v-0+1)}))}};if(b){g("TAG",/^((?:((?:\\.|[-\w*]|[^\x00-\xa0])+\|)?((?:\\.|[-\w*]|[^\x00-\xa0])+)))/)}else{g("TAG",/^((?:((?:[\w\u00c0-\uFFFF\*_-]*\|)?)((?:[\w\u00c0-\uFFFF\*_-]|\\.)+)))/)}var a=document.createElement("div");var e=false;a.appendChild(document.createComment(""));if(a.getElementsByTagName("*").length>0){e=true}var s=true;if(a.localName&&a.localName=="div"){s=false}a=null;l.expr.find.TAG=function(w,t,B){if(!jQuery.isArray(w)){if(typeof t.getElementsByTagName!=="undefined"){return t.getElementsByTagName(w)}}var z=p(w[2]);var x=w[3];var y;if(typeof t.getElementsByTagNameNS!="undefined"){y=t.getElementsByTagNameNS(z,x)}else{if(typeof t.selectNodes!="undefined"){if(t.ownerDocument){t.ownerDocument.setProperty("SelectionLanguage","XPath")}else{t.setProperty("SelectionLanguage","XPath")}var A="";if(z!="*"){if(x!="*"){A="namespace-uri()='"+z+"' and local-name()='"+x+"'"}else{A="namespace-uri()='"+z+"'"}}else{if(x!="*"){A="local-name()='"+x+"'"}}if(A){y=t.selectNodes("descendant-or-self::*["+A+"]")}else{y=t.selectNodes("descendant-or-self::*")}}else{y=t.getElementsByTagName(x);if(e&&x=="*"){var v=[];for(var u=0;y[u];u++){if(y[u].nodeType==1){v.push(y[u])}}y=v}if(y&&z!="*"){var v=[];for(var u=0;y[u];u++){if(y[u].namespaceURI==z||y[u].tagUrn==z){v.push(y[u])}}y=v}}}return y};var q=function(t){return t.nodeType===9&&t.documentElement.nodeName!=="HTML"||!!t.ownerDocument&&t.ownerDocument.documentElement.nodeName!=="HTML"};l.expr.preFilter.TAG=function(w,u,v,t,y,z){var x=w[3];if(!z){if(s){x=x.toUpperCase()}else{x=x.toLowerCase()}}return[w[0],p(w[2]),x]};function c(t,u){return function(x){var v=x.namespaceURI?x.namespaceURI:x.tagUrn;var w=x.localName?x.localName:x.tagName;if(t=="*"||v==t||(t==""&&!v)){return((u=="*"&&x.nodeType==1)||w==u)}return false}}l.expr.filter.TAG=(b)?c:function(w,t){var u=t[1];var v=t[2];return c(u,v).call(this,w,null)};if(b){g("ATTR",/^\[[\x20\t\r\n\f]*(((?:\\.|[-\w]|[^\x00-\xa0])+\|)?((?:\\.|[-\w]|[^\x00-\xa0])+))[\x20\t\r\n\f]*(?:([*^$|!~]?=)[\x20\t\r\n\f]*(?:(['"])((?:\\.|[^\\])*?)\5|((?:\\.|[-\w]|[^\x00-\xa0])+\|)?((?:\\.|[-\w#]|[^\x00-\xa0])+)|)|)[\x20\t\r\n\f]*\]/)}else{g("ATTR",/\[\s*((?:((?:[\w\u00c0-\uFFFF\*_-]*\|)?)((?:[\w\u00c0-\uFFFF_-]|\\.)+)))\s*(?:(\S?=)\s*(['"]*)(.*?)\5|)\s*\]/)}l.expr.preFilter.ATTR=(b)?function(u,v,w){var t=u[1].replace(rbackslash,"");if(u[4]=="~="){u[6]=" "+u[6]+" "}u[5]=(u[6]||u[7]||"").replace(rbackslash,"");if(!u[2]||u[2]=="|"){u[2]=""}else{u[2]=p(u[2])}return u.slice(0,6)}:function(x,u,v,t,y,z){var w=x[3].replace(/\\/g,"");if(!z&&l.expr.attrMap[w]){x[3]=l.expr.attrMap[w]}if(x[4]=="~="){x[6]=" "+x[6]+" "}if(!x[2]||x[2]=="|"){x[2]=""}else{x[2]=p(x[2])}return x};var o=function(t,v,u){if(t==null){return v==="!="}if(!v){return true}t+="";return v==="="?t===u:v==="!="?t!==u:v==="^="?u&&t.indexOf(u)===0:v==="*="?u&&t.indexOf(u)>-1:v==="$="?u&&t.substr(t.length-u.length)===u:v==="~="?(" "+t+" ").indexOf(u)>-1:v==="|="?t===u||t.substr(0,u.length+1)===u+"-":false};function h(v,w,u,x,t){return function(E,C){if(w==""){var z=l(E).attr(u);return o(z,x,t)}else{if(w!="*"&&typeof E.getAttributeNS!="undefined"){return o(E.getAttributeNS(w,u),x,t)}var A=E.attributes;for(var B=0;A[B];B++){var D=A[B].localName;if(!D){D=A[B].nodeName;var y=D.indexOf(":");if(y>=0){D=D.substr(y+1)}}if(D==u){z=A[B].nodeValue;if(w=="*"||A[B].namespaceURI==w){if(o(z,x,t)){return true}}if(A[B].namespaceURI===""&&A[B].prefix){if(A[B].prefix==r[w]){if(o(z,x,t)){return true}}}}}return false}}}l.expr.filter.ATTR=(b)?h:function(y,v){var x=v[2];var u=v[3];var w=v[4];var t=v[6];return h(null,x,u,w,t).call(this,y,null)}})(jQuery);(function($){var escape=/["\\\x00-\x1f\x7f-\x9f]/g,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},hasOwn=Object.prototype.hasOwnProperty;$.toJSON=typeof JSON==="object"&&JSON.stringify?JSON.stringify:function(o){if(o===null){return"null"}var pairs,k,name,val,type=$.type(o);if(type==="undefined"){return undefined}if(type==="number"||type==="boolean"){return String(o)}if(type==="string"){return $.quoteString(o)}if(typeof o.toJSON==="function"){return $.toJSON(o.toJSON())}if(type==="date"){var month=o.getUTCMonth()+1,day=o.getUTCDate(),year=o.getUTCFullYear(),hours=o.getUTCHours(),minutes=o.getUTCMinutes(),seconds=o.getUTCSeconds(),milli=o.getUTCMilliseconds();if(month<10){month="0"+month}if(day<10){day="0"+day}if(hours<10){hours="0"+hours}if(minutes<10){minutes="0"+minutes}if(seconds<10){seconds="0"+seconds}if(milli<100){milli="0"+milli}if(milli<10){milli="0"+milli}return'"'+year+"-"+month+"-"+day+"T"+hours+":"+minutes+":"+seconds+"."+milli+'Z"'}pairs=[];if($.isArray(o)){for(k=0;k<o.length;k++){pairs.push($.toJSON(o[k])||"null")}return"["+pairs.join(",")+"]"}if(typeof o==="object"){for(k in o){if(hasOwn.call(o,k)){type=typeof k;if(type==="number"){name='"'+k+'"'}else{if(type==="string"){name=$.quoteString(k)}else{continue}}type=typeof o[k];if(type!=="function"&&type!=="undefined"){val=$.toJSON(o[k]);pairs.push(name+":"+val)}}}return"{"+pairs.join(",")+"}"}};$.evalJSON=typeof JSON==="object"&&JSON.parse?JSON.parse:function(str){return eval("("+str+")")};$.secureEvalJSON=typeof JSON==="object"&&JSON.parse?JSON.parse:function(str){var filtered=str.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"");if(/^[\],:{}\s]*$/.test(filtered)){return eval("("+str+")")}throw new SyntaxError("Error parsing JSON, source is not valid.")};$.quoteString=function(str){if(str.match(escape)){return'"'+str.replace(escape,function(a){var c=meta[a];if(typeof c==="string"){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"'}return'"'+str+'"'}}(jQuery));(function(m,p,v,r,n){var t=v.createElement("div"),h=t.style,c="Transform",C=["O"+c,"ms"+c,"Webkit"+c,"Moz"+c],z=C.length,a,l,G="Float32Array" in p,J,w,F=/Matrix([^)]*)/,q=/^\s*matrix\(\s*1\s*,\s*0\s*,\s*0\s*,\s*1\s*(?:,\s*0(?:px)?\s*){2}\)\s*$/,I="transform",K="transformOrigin",H="translate",f="rotate",s="scale",B="skew",b="matrix";while(z--){if(C[z] in h){m.support[I]=a=C[z];m.support[K]=a+"Origin";continue}}if(!a){m.support.matrixFilter=l=h.filter===""}m.cssNumber[I]=m.cssNumber[K]=true;if(a&&a!=I){m.cssProps[I]=a;m.cssProps[K]=a+"Origin";if(a=="Moz"+c){J={get:function(M,L){return(L?m.css(M,a).split("px").join(""):M.style[a])},set:function(L,M){L.style[a]=/matrix\([^)p]*\)/.test(M)?M.replace(/matrix((?:[^,]*,){4})([^,]*),([^)]*)/,b+"$1$2px,$3px"):M}}}else{if(/^1\.[0-5](?:\.|$)/.test(m.fn.jquery)){J={get:function(M,L){return(L?m.css(M,a.replace(/^ms/,"Ms")):M.style[a])}}}}}else{if(l){J={get:function(P,O,L){var N=(O&&P.currentStyle?P.currentStyle:P.style),M,Q;if(N&&F.test(N.filter)){M=RegExp.$1.split(",");M=[M[0].split("=")[1],M[2].split("=")[1],M[1].split("=")[1],M[3].split("=")[1]]}else{M=[1,0,0,1]}if(!m.cssHooks[K]){M[4]=N?parseInt(N.left,10)||0:0;M[5]=N?parseInt(N.top,10)||0:0}else{Q=m._data(P,"transformTranslate",n);M[4]=Q?Q[0]:0;M[5]=Q?Q[1]:0}return L?M:b+"("+M+")"},set:function(R,S,N){var M=R.style,O,L,Q,P;if(!N){M.zoom=1}S=y(S);L=["Matrix(M11="+S[0],"M12="+S[2],"M21="+S[1],"M22="+S[3],"SizingMethod='auto expand'"].join();Q=(O=R.currentStyle)&&O.filter||M.filter||"";M.filter=F.test(Q)?Q.replace(F,L):Q+" progid:DXImageTransform.Microsoft."+L+")";if(!m.cssHooks[K]){if((P=m.transform.centerOrigin)){M[P=="margin"?"marginLeft":"left"]=-(R.offsetWidth/2)+(R.clientWidth/2)+"px";M[P=="margin"?"marginTop":"top"]=-(R.offsetHeight/2)+(R.clientHeight/2)+"px"}M.left=S[4]+"px";M.top=S[5]+"px"}else{m.cssHooks[K].set(R,S)}}}}}if(J){m.cssHooks[I]=J}w=J&&J.get||m.css;m.fx.step.transform=function(P){var O=P.elem,M=P.start,Q=P.end,U=P.pos,N="",S=100000,R,L,T,V;if(!M||typeof M==="string"){if(!M){M=w(O,a)}if(l){O.style.zoom=1}Q=Q.split("+=").join(M);m.extend(P,e(M,Q));M=P.start;Q=P.end}R=M.length;while(R--){L=M[R];T=Q[R];V=+false;switch(L[0]){case H:V="px";case s:V||(V="");N=L[0]+"("+r.round((L[1][0]+(T[1][0]-L[1][0])*U)*S)/S+V+","+r.round((L[1][1]+(T[1][1]-L[1][1])*U)*S)/S+V+")"+N;break;case B+"X":case B+"Y":case f:N=L[0]+"("+r.round((L[1]+(T[1]-L[1])*U)*S)/S+"rad)"+N;break}}P.origin&&(N=P.origin+N);J&&J.set?J.set(O,N,+true):O.style[a]=N};function y(N){N=N.split(")");var O=m.trim,R=-1,Q=N.length-1,T,L,M,P=G?new Float32Array(6):[],U=G?new Float32Array(6):[],S=G?new Float32Array(6):[1,0,0,1,0,0];P[0]=P[3]=S[0]=S[3]=1;P[1]=P[2]=P[4]=P[5]=0;while(++R<Q){T=N[R].split("(");L=O(T[0]);M=T[1];U[0]=U[3]=1;U[1]=U[2]=U[4]=U[5]=0;switch(L){case H+"X":U[4]=parseInt(M,10);break;case H+"Y":U[5]=parseInt(M,10);break;case H:M=M.split(",");U[4]=parseInt(M[0],10);U[5]=parseInt(M[1]||0,10);break;case f:M=g(M);U[0]=r.cos(M);U[1]=r.sin(M);U[2]=-r.sin(M);U[3]=r.cos(M);break;case s+"X":U[0]=+M;break;case s+"Y":U[3]=M;break;case s:M=M.split(",");U[0]=M[0];U[3]=M.length>1?M[1]:M[0];break;case B+"X":U[2]=r.tan(g(M));break;case B+"Y":U[1]=r.tan(g(M));break;case b:M=M.split(",");U[0]=M[0];U[1]=M[1];U[2]=M[2];U[3]=M[3];U[4]=parseInt(M[4],10);U[5]=parseInt(M[5],10);break}S[0]=P[0]*U[0]+P[2]*U[1];S[1]=P[1]*U[0]+P[3]*U[1];S[2]=P[0]*U[2]+P[2]*U[3];S[3]=P[1]*U[2]+P[3]*U[3];S[4]=P[0]*U[4]+P[2]*U[5]+P[4];S[5]=P[1]*U[4]+P[3]*U[5]+P[5];P=[S[0],S[1],S[2],S[3],S[4],S[5]]}return S}function u(O){var P,N,M,L=O[0],S=O[1],R=O[2],Q=O[3];if(L*Q-S*R){P=r.sqrt(L*L+S*S);L/=P;S/=P;M=L*R+S*Q;R-=L*M;Q-=S*M;N=r.sqrt(R*R+Q*Q);R/=N;Q/=N;M/=N;if(L*Q<S*R){L=-L;S=-S;M=-M;P=-P}}else{P=N=M=0}return[[H,[+O[4],+O[5]]],[f,r.atan2(S,L)],[B+"X",r.atan(M)],[s,[P,N]]]}function e(S,M){var P={start:[],end:[]},N=-1,L,O,Q,R;(S=="none"||E(S))&&(S="");(M=="none"||E(M))&&(M="");if(S&&M&&!M.indexOf("matrix")&&x(S).join()==x(M.split(")")[0]).join()){P.origin=S;S="";M=M.slice(M.indexOf(")")+1)}if(!S&&!M){return}if(!S||!M||A(S)==A(M)){S&&(S=S.split(")"))&&(L=S.length);M&&(M=M.split(")"))&&(L=M.length);while(++N<L-1){S[N]&&(O=S[N].split("("));M[N]&&(Q=M[N].split("("));R=m.trim((O||Q)[0]);D(P.start,o(R,O?O[1]:0));D(P.end,o(R,Q?Q[1]:0))}}else{P.start=u(y(S));P.end=u(y(M))}return P}function o(O,P){var M=+(!O.indexOf(s)),N,L=O.replace(/e[XY]/,"e");switch(O){case H+"Y":case s+"Y":P=[M,P?parseFloat(P):M];break;case H+"X":case H:case s+"X":N=1;case s:P=P?(P=P.split(","))&&[parseFloat(P[0]),parseFloat(P.length>1?P[1]:O==s?N||P[0]:M+"")]:[M,M];break;case B+"X":case B+"Y":case f:P=P?g(P):0;break;case b:return u(P?x(P):[1,0,0,1,0,0]);break}return[[L,P]]}function E(L){return q.test(L)}function A(L){return L.replace(/(?:\([^)]*\))|\s/g,"")}function D(M,L,N){while(N=L.shift()){M.push(N)}}function g(L){return ~L.indexOf("deg")?parseInt(L,10)*(r.PI*2/360):~L.indexOf("grad")?parseInt(L,10)*(r.PI/200):parseFloat(L)}function x(L){L=/([^,]*),([^,]*),([^,]*),([^,]*),([^,p]*)(?:px)?,([^)p]*)(?:px)?/.exec(L);return[L[1],L[2],L[3],L[4],L[5],L[6]]}m.transform={centerOrigin:"margin"}})(jQuery,window,document,Math);(function(e){var s=e.extend,n="mousedown",t="mousemove",o="mouseup",r="touchstart",l="touchmove",u="touchend",g="touchcancel";function f(A,y,z){if(y.substr(0,5)!=="touch"){return e(A).unbind(y,z)}var B,x;for(x=0;x<w._binds.length;x++){if(w._binds[x].elem===A&&w._binds[x].type===y&&w._binds[x].func===z){if(document.addEventListener){A.removeEventListener(y,w._binds[x].fnc,false)}else{A.detachEvent("on"+y,w._binds[x].fnc)}w._binds.splice(x--,1)}}}function w(B,y,A,z){if(y.substr(0,5)!=="touch"){return e(B).bind(y,z,A)}var C,x;if(w[y]){return w[y].bind(B,y,A,z)}C=function(D){if(!D){D=window.event}if(!D.stopPropagation){D.stopPropagation=function(){this.cancelBubble=true}}D.data=z;A.call(B,D)};if(document.addEventListener){B.addEventListener(y,C,false)}else{B.attachEvent("on"+y,C)}w._binds.push({elem:B,type:y,func:A,fnc:C})}function h(y,x){var z={move:{x:0,y:0},offset:{x:0,y:0},position:{x:0,y:0},start:{x:0,y:0},affects:document.documentElement,stopPropagation:false,preventDefault:true,touch:true};s(z,x);z.element=y;w(y,n,v,z);if(z.touch){w(y,r,a,z)}}function m(x){f(x,n,n)}function v(x){x.data.position.x=x.pageX;x.data.position.y=x.pageY;x.data.start.x=x.pageX;x.data.start.y=x.pageY;x.data.event=x;if(x.data.onstart&&x.data.onstart.call(x.data.element,x.data)){return}if(x.preventDefault&&x.data.preventDefault){x.preventDefault()}if(x.stopPropagation&&x.data.stopPropagation){x.stopPropagation()}w(x.data.affects,t,b,x.data);w(x.data.affects,o,q,x.data)}function b(x){if(x.preventDefault&&x.data.preventDefault){x.preventDefault()}if(x.stopPropagation&&x.data.preventDefault){x.stopPropagation()}x.data.move.x=x.pageX-x.data.position.x;x.data.move.y=x.pageY-x.data.position.y;x.data.position.x=x.pageX;x.data.position.y=x.pageY;x.data.offset.x=x.pageX-x.data.start.x;x.data.offset.y=x.pageY-x.data.start.y;x.data.event=x;if(x.data.onmove){x.data.onmove.call(x.data.element,x.data)}}function q(x){if(x.preventDefault&&x.data.preventDefault){x.preventDefault()}if(x.stopPropagation&&x.data.stopPropagation){x.stopPropagation()}f(x.data.affects,t,b);f(x.data.affects,o,q);x.data.event=x;if(x.data.onfinish){x.data.onfinish.call(x.data.element,x.data)}}function a(x){x.data.position.x=x.touches[0].pageX;x.data.position.y=x.touches[0].pageY;x.data.start.x=x.touches[0].pageX;x.data.start.y=x.touches[0].pageY;x.data.event=x;if(x.data.onstart&&x.data.onstart.call(x.data.element,x.data)){return}if(x.preventDefault&&x.data.preventDefault){x.preventDefault()}if(x.stopPropagation&&x.data.stopPropagation){x.stopPropagation()}w(x.data.affects,l,p,x.data);w(x.data.affects,u,c,x.data)}function p(x){if(x.preventDefault&&x.data.preventDefault){x.preventDefault()}if(x.stopPropagation&&x.data.stopPropagation){x.stopPropagation()}x.data.move.x=x.touches[0].pageX-x.data.position.x;x.data.move.y=x.touches[0].pageY-x.data.position.y;x.data.position.x=x.touches[0].pageX;x.data.position.y=x.touches[0].pageY;x.data.offset.x=x.touches[0].pageX-x.data.start.x;x.data.offset.y=x.touches[0].pageY-x.data.start.y;x.data.event=x;if(x.data.onmove){x.data.onmove.call(x.data.elem,x.data)}}function c(x){if(x.preventDefault&&x.data.preventDefault){x.preventDefault()}if(x.stopPropagation&&x.data.stopPropagation){x.stopPropagation()}f(x.data.affects,l,p);f(x.data.affects,u,c);x.data.event=x;if(x.data.onfinish){x.data.onfinish.call(x.data.element,x.data)}}w._binds=[];e.fn.grab=function(y,x){return this.each(function(){return h(this,y,x)})};e.fn.ungrab=function(x){return this.each(function(){return m(this,x)})}})(jQuery);PureCSSMatrix=(function(){var b=/deg$/;var f=/([0-9.\-e]+)/g;var g=/([a-zA-Z]+)\(([^\)]+)\)/g;function c(l){if(l&&l!==null&&l!="none"){if(l instanceof Matrix){this.setMatrix(l)}else{this.setMatrixValue(l)}}else{this.m=Matrix.I(3)}}c.prototype.setMatrix=function(l){this.m=l};function e(m){var l=parseFloat(h(m));if(m.match(b)){l=(2*Math.PI)*l/360}return l}c.prototype.setMatrixValue=function(o){var l=Matrix.I(3);var m;while((m=g.exec(o))!==null){var p=m[1].toLowerCase();var r=m[2].split(",");var n;if(p=="matrix"){n=Matrix.create([[parseFloat(r[0]),parseFloat(r[2]),parseFloat(h(r[4]))],[parseFloat(r[1]),parseFloat(r[3]),parseFloat(h(r[5]))],[0,0,1]])}else{if(p=="translate"){n=Matrix.I(3);n.elements[0][2]=parseFloat(h(r[0]));n.elements[1][2]=parseFloat(h(r[1]))}else{if(p=="scale"){var s=parseFloat(r[0]);var q;if(r.length>1){q=parseFloat(r[1])}else{q=s}n=Matrix.create([[s,0,0],[0,q,0],[0,0,1]])}else{if(p=="rotate"){n=Matrix.RotationZ(e(r[0]))}else{if(p=="skew"||p=="skewx"){n=Matrix.I(3);n.elements[0][1]=Math.tan(e(r[0]))}else{if(p=="skewy"){n=Matrix.I(3);n.elements[1][0]=Math.tan(e(r[0]))}else{console.log("Problem with setMatrixValue",p,r)}}}}}}l=l.multiply(n)}this.m=l};c.prototype.multiply=function(l){return new c(this.m.multiply(l.m))};c.prototype.inverse=function(){if(Math.abs(this.m.elements[0][0])<0.000001){this.m.elements[0][0]=0}return new c(this.m.inverse())};c.prototype.translate=function(l,n){var m=Matrix.I(3);m.elements[0][2]=l;m.elements[1][2]=n;return new c(this.m.multiply(m))};c.prototype.scale=function(n,m){var l=Matrix.create([[n,0,0],[0,m,0],[0,0,1]]);return new c(this.m.multiply(l))};c.prototype.rotate=function(l){var m=Matrix.RotationZ(l);return new c(this.m.multiply(m))};c.prototype.toString=function(){var m=this.m.elements;var l="";if($.browser.mozilla||$.browser.opera){l="px"}return"matrix("+a(m[0][0])+", "+a(m[1][0])+", "+a(m[0][1])+", "+a(m[1][1])+", "+a(m[0][2])+l+", "+a(m[1][2])+l+")"};c.prototype.elements=function(){var l=this.m.elements;return{a:l[0][0],b:l[1][0],c:l[0][1],d:l[1][1],e:l[0][2],f:l[1][2]}};function h(l){return l.match(f)}function a(l){return Number(l).toFixed(6)}return c})();if(!$.zoomooz){$.zoomooz={}}$.zoomooz.helpers=(function(c,b){var a=["-moz-","-webkit-","-o-","-ms-"];b.forEachPrefix=function(f,g){for(var e=0;e<a.length;e++){f(a[e])}if(g){f("")}};b.getElementTransform=function(e){var f;b.forEachPrefix(function(g){f=f||c(e).css(g+"transform")},true);return f};return b})(jQuery,{});(function(e){var q;var z;var h=/([0-9.\-e]+)/g;var b=/([a-z]+)\(([^\)]+)\)/g;var u=/deg$/;var s=e.zoomooz.helpers;var r={duration:450,easing:"ease",nativeanimation:false};var o;jQuery.cssHooks.MsTransform={set:function(C,D){C.style.msTransform=D}};jQuery.cssHooks.MsTransformOrigin={set:function(C,D){C.style.msTransformOrigin=D}};e.fn.animateTransformation=function(D,C,G,E){C=jQuery.extend({},r,C);var F=(e.browser.webkit&&C.nativeanimation);if(o){clearTimeout(o);o=null}if(F&&G){o=setTimeout(G,C.duration)}this.each(function(){var H=e(this);if(!D){D=new PureCSSMatrix()}var I=y(H);var J=l(I,A(D));if(F){H.css(m(B(J),C.duration,C.easing));if(E){E()}}else{a(H,I,J,C,G,E)}})};e.fn.setTransformation=function(C){this.each(function(){var D=e(this);var E=y(D);var F=l(E,A(C));D.css(m(B(F)))})};function m(C,E,H){var G={};s.forEachPrefix(function(I){G[I+"transform"]=C},true);if(E){var D=n(E/1000,6)+"s";G["-webkit-transition-duration"]=D;G["-o-transition-duration"]=D;G["-moz-transition-duration"]=D}if(H){var F=x(H);G["-webkit-transition-timing-function"]=F;G["-o-transition-timing-function"]=F;G["-moz-transition-timing-function"]=D}return G}function a(C,D,G,E,H,F){if(!D){D=A(new PureCSSMatrix())}q=(new Date()).getTime();if(z){clearInterval(z);z=null}if(E.easing){E.easingfunction=v(E.easing,E.duration)}t(C,D,G,E,H);if(F){F()}z=setInterval(function(){t(C,D,G,E,H)},1)}function t(C,I,F,E,H){var G=(new Date()).getTime()-q;var D;if(E.easingfunction){D=E.easingfunction(G/E.duration)}else{D=G/E.duration}C.css(m(B(f(I,F,D))));if(G>E.duration){clearInterval(z);z=null;D=1;if(H){H()}}}function A(O){var D=O.elements();var P=D.a,M=D.b,K=D.c,J=D.d,I=D.e,H=D.f;if(Math.abs(P*J-M*K)<0.01){console.log("fail!");return}var G=I,F=H;var N=Math.sqrt(P*P+M*M);P=P/N;M=M/N;var E=P*K+M*J;K-=P*E;J-=M*E;var L=Math.sqrt(K*K+J*J);K=K/L;J=J/L;E=E/L;if((P*J-M*K)<0){P=-P;M=-M;K=-K;J=-J;N=-N;L=-L}var C=Math.atan2(M,P);return{tx:G,ty:F,r:C,k:Math.atan(E),sx:N,sy:L}}function B(C){var D="";D+="translate("+n(C.tx,6)+"px,"+n(C.ty,6)+"px) ";D+="rotate("+n(C.r,6)+"rad) skewX("+n(C.k,6)+"rad) ";D+="scale("+n(C.sx,6)+","+n(C.sy,6)+")";return D}function x(C){if((C instanceof Array)){return"cubic-bezier("+n(C[0],6)+","+n(C[1],6)+","+n(C[2],6)+","+n(C[3],6)+")"}else{return C}}function v(D,E){var F=[];if((D instanceof Array)){F=D}else{switch(D){case"linear":F=[0,0,1,1];break;case"ease":F=[0.25,0.1,0.25,1];break;case"ease-in":F=[0.42,0,1,1];break;case"ease-out":F=[0,0,0.58,1];break;case"ease-in-out":F=[0.42,0,0.58,1];break}}var C=function(G){return c(G,F[0],F[1],F[2],F[3],E)};return C}function g(F,H,G,D,J){var C,I,E=((1-F)*(1-F)*(1-F));C=H*(3*F*F*(1-F))+D*(3*F*(1-F)*(1-F))+E;I=G*(3*F*F*(1-F))+J*(3*F*(1-F)*(1-F))+E;return{x:Math.abs(C),y:Math.abs(I)}}function c(Q,E,D,M,L,C){var P=0,T=0,G=0,N=0,R=0,F=0;function K(U){return((P*U+T)*U+G)*U}function J(U){return((N*U+R)*U+F)*U}function S(U){return(3*P*U+2*T)*U+G}function O(U){return 1/(200*U)}function I(U,V){return J(H(U,V))}function H(ab,ac){var aa,Z,Y,V,U,X;function W(ad){if(ad>=0){return ad}else{return 0-ad}}for(Y=ab,X=0;X<8;X++){V=K(Y)-ab;if(W(V)<ac){return Y}U=S(Y);if(W(U)<0.000001){break}Y=Y-V/U}aa=0;Z=1;Y=ab;if(Y<aa){return aa}if(Y>Z){return Z}while(aa<Z){V=K(Y);if(W(V-ab)<ac){return Y}if(ab>V){aa=Y}else{Z=Y}Y=(Z-aa)*0.5+aa}return Y}G=3*E;T=3*(M-E)-G;P=1-G-T;F=3*D;R=3*(L-D)-F;N=1-F-R;return I(Q,O(C))}function y(E){var D=s.getElementTransform(E);var F;if(!D){F=new PureCSSMatrix()}else{F=new PureCSSMatrix(D)}var C=A(F);C.r=p(D);return C}function p(G){var F=0;var D;while((D=b.exec(G))!==null){var H=D[1].toLowerCase();var I=D[2].split(",");if(H=="matrix"){var J=H+"("+D[2]+")";F+=A(new PureCSSMatrix(J)).r}else{if(H=="rotate"){var E=I[0];var C=parseFloat(w(E));if(E.match(u)){C=(2*Math.PI)*C/360}F+=C}}}return F}function l(C,D){if(Math.abs(C.r-D.r)>Math.PI){if(D.r<C.r){while(Math.abs(C.r-D.r)>Math.PI){D.r+=(2*Math.PI)}}else{while(Math.abs(C.r-D.r)>Math.PI){D.r-=(2*Math.PI)}}}return D}function f(C,F,G){var E={};for(var D in C){if(C.hasOwnProperty(D)){E[D]=C[D]+(F[D]-C[D])*G}}return E}function n(E,C){C=Math.abs(parseInt(C,10))||0;var D=Math.pow(10,C);return Math.round(E*D)/D}function w(C){return C.match(h)}})(jQuery);(function(l){var g=l.zoomooz.helpers;var o=["duration","easing","nativeanimation"];m();if(!l.zoomooz){l.zoomooz={}}l.zoomooz.setup=function(u){l.zoomooz.defaultSettings=jQuery.extend(p(),u)};l.fn.zoomSettings=function(u){var v;this.each(function(){var w=l(this);v=s(w,u)});return v};l.fn.zoomTo=function(v,u){this.each(function(){var w=l(this);if(!u){v=w.zoomSettings(v)}h(w,v);if(v.debug){if(l("#debug").length===0){l(v.root).append('<div id="debug"><div>')}else{l("#debug").html("")}r(w,v)}else{if(l("#debug").length!==0){l("#debug").html("")}}});return this};function s(v,A){var z=jQuery.extend({},A);if(!l.zoomooz.defaultSettings){l.zoomooz.setup()}var y=l.zoomooz.defaultSettings;var u=jQuery.extend({},z);for(var x in y){if(y.hasOwnProperty(x)&&!u[x]){u[x]=v.data(x)}}for(var w=0;w<o.length;w++){var x=o[w];if(!u[x]){u[x]=v.data(x)}}return jQuery.extend({},y,u)}function m(){var v=document.createElement("style");v.type="text/css";var u="";g.forEachPrefix(function(w){u+=w+"transform-origin: 0 0;"},true);v.innerHTML="html {height:100%;}.noScroll{overflow:hidden !important;}body.noScroll,html.noScroll body{margin-right:15px;}* {"+u+"}";document.getElementsByTagName("head")[0].appendChild(v)}function p(){return{targetsize:0.9,scalemode:"both",root:l(document.body),debug:false,animationendcallback:null,closeclick:false}}function h(y,w){var A=b(y,w);var x;var z=null;f(w.root);if(y[0]!==w.root[0]){var u=e(y,w.root).inverse();x=c(y,u,w);if(w.animationendcallback){z=function(){w.animationendcallback.call(y[0])}}}else{x=(new PureCSSMatrix()).translate(-A.x,-A.y);z=function(){var C=l(w.root);var B=A.elem;B.removeClass("noScroll");C.setTransformation(new PureCSSMatrix());C.data("original-scroll",null);l(document).off("touchmove");if(B[0]==document.body||B[0]==window){window.scrollTo(A.x,A.y)}else{B.scrollLeft(A.x);B.scrollTop(A.y)}if(w.animationendcallback){w.animationendcallback.call(y[0])}}}var v=null;if(A&&A.animationstartedcallback){v=A.animationstartedcallback}l(w.root).animateTransformation(x,w,z,v)}function b(w,v){var A=v.root;var u=A.parent();if(w[0]===A[0]){var z=A.data("original-scroll");if(z){return z}else{return{elem:u,x:0,"y:":0}}}else{if(!A.data("original-scroll")){var y=A.scrollTop();var B=A.scrollLeft();var w=A;if(!y){y=u.scrollTop();B=u.scrollLeft();w=u}var z={elem:w,x:B,y:y};A.data("original-scroll",z);l(document).on("touchmove",function(C){C.preventDefault()});var x="translate(-"+B+"px,-"+y+"px)";g.forEachPrefix(function(C){A.css(C+"transform",x)});w.addClass("noScroll");z.animationstartedcallback=function(){if(w[0]==document.body||w[0]==document){window.scrollTo(0,0)}else{w.scrollLeft(0);w.scrollTop(0)}};return z}}}function f(z){var A=l(z).parent();var w=A.width();var y=A.height();var u=w/2;var v=y/2;var x=q(u)+"px "+q(v)+"px";g.forEachPrefix(function(B){z.css(B+"transform-origin",x)})}function c(H,D,G){var L=G.targetsize;var K=G.scalemode;var u=G.root;var I=l(u).parent();var C=I.width();var E=I.height();var v=C/H.outerWidth();var x=E/H.outerHeight();var M;if(K=="width"){M=L*v}else{if(K=="height"){M=L*x}else{if(K=="both"){M=L*Math.min(v,x)}else{if(K=="scale"){M=L}else{console.log("wrong zoommode");return}}}}var B=(C-H.outerWidth()*M)/2;var y=(E-H.outerHeight()*M)/2;var F=C/2;var w=E/2;var z=-parseFloat(u.css("margin-left"))||0;var J=-parseFloat(u.css("margin-top"))||0;var A=(new PureCSSMatrix()).translate(z,J).translate(-F,-w).translate(B,y).scale(M,M).multiply(D).translate(F,w);return A}function t(v,u,w){return[v.a*u+v.c*w+v.e,v.b*u+v.d*w+v.f]}function r(v,u){var w=e(v,u.root).elements();n(t(w,0,0));n(t(w,0,v.outerHeight()));n(t(w,v.outerWidth(),v.outerHeight()));n(t(w,v.outerWidth(),0))}function n(w){var u="width:4px;height:4px;background-color:red;position:absolute;margin-left:-2px;margin-top:-2px;";u+="left:"+w[0]+"px;top:"+w[1]+"px;";var v='<div class="debuglabel" style="'+u+'"></div>';l("#debug").append(v)}function e(C,G){var J=C[0];if(!J||!J.ownerDocument){return null}var I=new PureCSSMatrix();var v;if(J===J.ownerDocument.body){var L=jQuery.offset.bodyOffset(J);v=new PureCSSMatrix();v=v.translate(L.left,L.top);I=I.multiply(v);return I}var A;if(jQuery.offset.initialize){jQuery.offset.initialize();A={fixedPosition:jQuery.offset.supportsFixedPosition,doesNotAddBorder:jQuery.offset.doesNotAddBorder,doesAddBorderForTableAndCells:jQuery.support.doesAddBorderForTableAndCells,subtractsBorderForOverflowNotVisible:jQuery.offset.subtractsBorderForOverflowNotVisible}}else{A=jQuery.support}var u=J.offsetParent;var M=J.ownerDocument;var y;var K=M.documentElement;var B=M.body;var H=G[0];var F=M.defaultView;var x;if(F){x=F.getComputedStyle(J,null)}else{x=J.currentStyle}var D=J.offsetTop;var w=J.offsetLeft;var z=a().translate(w,D);z=z.multiply(a(J));I=z.multiply((I));while((J=J.parentNode)&&J!==H){D=0;w=0;if(A.fixedPosition&&x.position==="fixed"){break}y=F?F.getComputedStyle(J,null):J.currentStyle;D-=J.scrollTop;w-=J.scrollLeft;if(J===u){D+=J.offsetTop;w+=J.offsetLeft;if(A.doesNotAddBorder&&!(A.doesAddBorderForTableAndCells&&/^t(able|d|h)$/i.test(J.nodeName))){D+=parseFloat(y.borderTopWidth)||0;w+=parseFloat(y.borderLeftWidth)||0}u=J.offsetParent}if(A.subtractsBorderForOverflowNotVisible&&y.overflow!=="visible"){D+=parseFloat(y.borderTopWidth)||0;w+=parseFloat(y.borderLeftWidth)||0}x=y;if(J.offsetParent==H){D-=parseFloat(l(J.offsetParent).css("margin-top"))||0;w-=parseFloat(l(J.offsetParent).css("margin-left"))||0}z=a().translate(w,D);z=z.multiply(a(J));I=z.multiply(I)}D=0;w=0;if(x.position==="relative"||x.position==="static"){D+=B.offsetTop;w+=B.offsetLeft}if(A.fixedPosition&&x.position==="fixed"){D+=Math.max(K.scrollTop,B.scrollTop);w+=Math.max(K.scrollLeft,B.scrollLeft)}var E=(new PureCSSMatrix()).translate(w,D);I=I.multiply(E);return I}function q(u){return Number(u).toFixed(6)}function a(v){var u=g.getElementTransform(v);if(!u){return new PureCSSMatrix()}else{return new PureCSSMatrix(u)}}})(jQuery);(function(b){if(!b.zoomooz){b.zoomooz={}}var a=b.zoomooz.helpers;b.fn.zoomTarget=function(f){this.each(function(){var g=b(this).zoomSettings(f);c(b(this),b(this),g)})};function c(f,n,g){f.addClass("zoomTarget");if(!g.animationendcallback){if(!g.closeclick){g.animationendcallback=function(){b(".selectedZoomTarget").removeClass("selectedZoomTarget zoomNotClickable");f.addClass("selectedZoomTarget zoomNotClickable")}}else{g.animationendcallback=function(){b(".selectedZoomTarget").removeClass("selectedZoomTarget zoomNotClickable");f.addClass("selectedZoomTarget")}}}var m=n.closest(".zoomContainer");if(m.length!=0){g.root=m}var h=g.root;if(!h.hasClass("zoomTarget")){var l=h.zoomSettings({});l.animationendcallback=function(){var o=b(this);b(".selectedZoomTarget").removeClass("selectedZoomTarget zoomNotClickable");o.addClass("selectedZoomTarget zoomNotClickable");o.parent().addClass("selectedZoomTarget zoomNotClickable")};c(h,h,l);c(h.parent(),h,l);h.click()}f.on("click",function(o){if(g.closeclick&&n.hasClass("selectedZoomTarget")){g.root.click()}else{n.zoomTo(g)}o.stopPropagation()})}function e(){var f=document.createElement("style");f.type="text/css";function g(h){var l="-webkit-touch-callout: "+(h?"default":"none")+";";a.forEachPrefix(function(m){l+=m+"user-select:"+(h?"text":"none")+";"},true);return l}f.innerHTML=".zoomTarget{"+g(false)+"}.zoomTarget:hover{cursor:pointer!important;}.zoomNotClickable{"+g(true)+"}.zoomNotClickable:hover{cursor:auto!important;}.zoomContainer{position:relative;padding:1px;margin:-1px;}";document.getElementsByTagName("head")[0].appendChild(f)}e();b(document).ready(function(){b(".zoomTarget").zoomTarget()})})(jQuery);(function(a){if(!a.zoomooz){a.zoomooz={}}a.fn.zoomContainer=function(b){};a(document).ready(function(){a(".zoomContainer").zoomContainer()})})(jQuery);var Sylvester={version:"0.1.3",precision:0.000001};function Matrix(){}Matrix.prototype={dup:function(){return Matrix.create(this.elements)},canMultiplyFromLeft:function(a){var b=a.elements||a;if(typeof(b[0][0])=="undefined"){b=Matrix.create(b).elements}return(this.elements[0].length==b.length)},multiply:function(s){var l=s.modulus?true:false;var p=s.elements||s;if(typeof(p[0][0])=="undefined"){p=Matrix.create(p).elements}if(!this.canMultiplyFromLeft(p)){return null}var f=this.elements.length,g=f,n,b,e=p[0].length,h;var r=this.elements[0].length,a=[],o,m,q;do{n=g-f;a[n]=[];b=e;do{h=e-b;o=0;m=r;do{q=r-m;o+=this.elements[n][q]*p[q][h]}while(--m);a[n][h]=o}while(--b)}while(--f);var p=Matrix.create(a);return l?p.col(1):p},isSquare:function(){return(this.elements.length==this.elements[0].length)},toRightTriangular:function(){var g=this.dup(),e;var b=this.elements.length,c=b,f,h,l=this.elements[0].length,a;do{f=c-b;if(g.elements[f][f]==0){for(j=f+1;j<c;j++){if(g.elements[j][f]!=0){e=[];h=l;do{a=l-h;e.push(g.elements[f][a]+g.elements[j][a])}while(--h);g.elements[f]=e;break}}}if(g.elements[f][f]!=0){for(j=f+1;j<c;j++){var m=g.elements[j][f]/g.elements[f][f];e=[];h=l;do{a=l-h;e.push(a<=f?0:g.elements[j][a]-g.elements[f][a]*m)}while(--h);g.elements[j]=e}}}while(--b);return g},determinant:function(){if(!this.isSquare()){return null}var f=this.toRightTriangular();var c=f.elements[0][0],e=f.elements.length-1,a=e,b;do{b=a-e+1;c=c*f.elements[b][b]}while(--e);return c},isSingular:function(){return(this.isSquare()&&this.determinant()===0)},augment:function(n){var l=n.elements||n;if(typeof(l[0][0])=="undefined"){l=Matrix.create(l).elements}var f=this.dup(),m=f.elements[0].length;var c=f.elements.length,e=c,h,a,b=l[0].length,g;if(c!=l.length){return null}do{h=e-c;a=b;do{g=b-a;f.elements[h][m+g]=l[h][g]}while(--a)}while(--c);return f},inverse:function(){if(!this.isSquare()||this.isSingular()){return null}var c=this.elements.length,e=c,l,h;var m=this.augment(Matrix.I(c)).toRightTriangular();var n,o=m.elements[0].length,a,g,b;var q=[],f;do{l=c-1;g=[];n=o;q[l]=[];b=m.elements[l][l];do{a=o-n;f=m.elements[l][a]/b;g.push(f);if(a>=e){q[l].push(f)}}while(--n);m.elements[l]=g;for(h=0;h<l;h++){g=[];n=o;do{a=o-n;g.push(m.elements[h][a]-m.elements[l][a]*m.elements[h][l])}while(--n);m.elements[h]=g}}while(--c);return Matrix.create(q)},setElements:function(l){var o,a=l.elements||l;if(typeof(a[0][0])!="undefined"){var e=a.length,g=e,b,c,m;this.elements=[];do{o=g-e;b=a[o].length;c=b;this.elements[o]=[];do{m=c-b;this.elements[o][m]=a[o][m]}while(--b)}while(--e);return this}var f=a.length,h=f;this.elements=[];do{o=h-f;this.elements.push([a[o]])}while(--f);return this}};Matrix.create=function(a){var b=new Matrix();return b.setElements(a)};Matrix.I=function(g){var f=[],a=g,e,c,b;do{e=a-g;f[e]=[];c=a;do{b=a-c;f[e][b]=(e==b)?1:0}while(--c)}while(--g);return Matrix.create(f)};(function(f,h,m,n,b){var l={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(s){for(var p=0;p<s.length;p++){var q=s[p].string;var r=s[p].prop;this.versionSearchString=s[p].versionSearch||s[p].identity;if(q){if(q.indexOf(s[p].subString)!=-1){return s[p].identity}}else{if(r){return s[p].identity}}}},searchVersion:function(q){var p=q.indexOf(this.versionSearchString);if(p==-1){return}return parseFloat(q.substring(p+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:h.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};l.init();var o={MSIE:{Windows:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"}},Firefox:{Windows:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Linux:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Mac:{ctrlKey:false,altKey:false,metaKey:true,shiftKey:true,which:70,string:"&#x21E7;&#x2318;F",alt:"Shift+Command+F"}},Chrome:{Windows:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Linux:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Mac:{ctrlKey:false,altKey:false,metaKey:true,shiftKey:true,which:70,string:"&#x21E7;&#x2318;F",alt:"Shift+Command+F"}},Safari:{Mac:{ctrlKey:true,altKey:false,metaKey:false,shiftKey:true,which:70,string:"^&#x2318;F",alt:"Control+Command+F"}},Opera:{Windows:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Linux:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Mac:{ctrlKey:false,altKey:false,metaKey:true,shiftKey:true,which:70,string:"&#x21E7;&#x2318;F",alt:"Shift+Command+F"}},};var g=function(){return(m.clientHeight==n&&m.clientWidth==b)||h.fullScreen||(h.outerHeight==n&&h.outerWidth==b)||(l.browser=="Safari"&&h.outerHeight==(n-40)&&h.outerWidth==b)},c=f(h);var a=o[l.browser][l.OS];var e={shortcut:a.string,longform:a.alt};c.data("fullscreen-state",g()).data("fullscreen-key",e).resize(function(){var p=g();if(c.data("fullscreen-state")&&!p){c.data("fullscreen-state",p).trigger("fullscreen-toggle",[false]).trigger("fullscreen-off")}else{if(!c.data("fullscreen-state")&&p){c.data("fullscreen-state",p).trigger("fullscreen-toggle",[true]).trigger("fullscreen-on")}}}).keydown(function(p){if(a&&p.ctrlKey==a.ctrlKey&&p.altKey==a.altKey&&p.metaKey==a.metaKey&&p.shiftKey==a.shiftKey&&p.which==a.which){c.trigger("fullscreen-key",[a.string,a.alt])}})})(jQuery,this,document.documentElement,screen.height,screen.width);(function(b,a,c){(function(e){if(typeof define==="function"&&define.amd){define(["jquery","imagesloaded"],e)}else{if(jQuery&&!jQuery.fn.qtip){e(jQuery)}}}(function(at){var Q=true,G=false,ae=null,Z="x",W="y",L="width",ay="height",q="top",e="left",au="bottom",n="right",I="center",v="flip",V="flipinvert",r="shift",z,az,ak,h,aF={},s="qtip",E="data-hasqtip",ac="data-qtip-id",aj=["ui-widget","ui-tooltip"],y="."+s,ad="click dblclick mousedown mouseup mousemove mouseleave mouseenter".split(" "),B=s+"-fixed",O=s+"-default",M=s+"-focus",aE=s+"-hover",T=s+"-disabled",aD="_replacedByqTip",F="oldtitle",aC;BROWSER={ie:(function(){var C=3,X=a.createElement("div");while((X.innerHTML="<!--[if gt IE "+(++C)+"]><i></i><![endif]-->")){if(!X.getElementsByTagName("i")[0]){break}}return C>4?C:NaN}()),iOS:parseFloat((""+(/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))||G};function aw(Y,X,aG,C){this.id=aG;this.target=Y;this.tooltip=ae;this.elements=elements={target:Y};this._id=s+"-"+aG;this.timers={img:{}};this.options=X;this.plugins={};this.cache=cache={event:{},target:at(),disabled:G,attr:C,onTooltip:G,lastClass:""};this.rendered=this.destroyed=this.disabled=this.waiting=this.hiddenDuringWait=this.positioning=this.triggering=G}az=aw.prototype;az.render=function(aI){if(this.rendered||this.destroyed){return this}var aL=this,aN=this.options,X=this.cache,C=this.elements,aK=aN.content.text,aH=aN.content.title,aG=aN.content.button,aJ=aN.position,Y="."+this._id+" ",aM=[];at.attr(this.target[0],"aria-describedby",this._id);this.tooltip=C.tooltip=tooltip=at("<div/>",{id:this._id,"class":[s,O,aN.style.classes,s+"-pos-"+aN.position.my.abbrev()].join(" "),width:aN.style.width||"",height:aN.style.height||"",tracking:aJ.target==="mouse"&&aJ.adjust.mouse,role:"alert","aria-live":"polite","aria-atomic":G,"aria-describedby":this._id+"-content","aria-hidden":Q}).toggleClass(T,this.disabled).attr(ac,this.id).data(s,this).appendTo(aJ.container).append(C.content=at("<div />",{"class":s+"-content",id:this._id+"-content","aria-atomic":Q}));this.rendered=-1;this.positioning=Q;if(aH){this._createTitle();if(!at.isFunction(aH)){aM.push(this._updateTitle(aH,G))}}if(aG){this._createButton()}if(!at.isFunction(aK)){aM.push(this._updateContent(aK,G))}this.rendered=Q;this._setWidget();at.each(aN.events,function(aO,aP){at.isFunction(aP)&&tooltip.bind((aO==="toggle"?["tooltipshow","tooltiphide"]:["tooltip"+aO]).join(Y)+Y,aP)});at.each(aF,function(aP){var aO;if(this.initialize==="render"&&(aO=this(aL))){aL.plugins[aP]=aO}});this._assignEvents();at.when.apply(at,aM).then(function(){aL._trigger("render");aL.positioning=G;if(!aL.hiddenDuringWait&&(aN.show.ready||aI)){aL.toggle(Q,X.event,G)}aL.hiddenDuringWait=G});z.api[this.id]=this;return this};az.destroy=function(C){if(this.destroyed){return this.target}function X(){if(this.destroyed){return}this.destroyed=Q;var Y=this.target,aG=Y.attr(F);if(this.rendered){this.tooltip.stop(1,0).find("*").remove().end().remove()}at.each(this.plugins,function(aH){this.destroy&&this.destroy()});clearTimeout(this.timers.show);clearTimeout(this.timers.hide);this._unassignEvents();Y.removeData(s).removeAttr(ac).removeAttr("aria-describedby");if(this.options.suppress&&aG){Y.attr("title",aG).removeAttr(F)}this._unbind(Y);this.options=this.elements=this.cache=this.timers=this.plugins=this.mouse=ae;delete z.api[this.id]}if(C!==Q&&this.rendered){tooltip.one("tooltiphidden",at.proxy(X,this));!this.triggering&&this.hide()}else{X.call(this)}return this.target};function A(C){return C===ae||at.type(C)!=="object"}function P(C){return !(at.isFunction(C)||(C&&C.attr)||C.length||(at.type(C)==="object"&&(C.jquery||C.then)))}function w(Y){var X,aH,aG,C;if(A(Y)){return G}if(A(Y.metadata)){Y.metadata={type:Y.metadata}}if("content" in Y){X=Y.content;if(A(X)||X.jquery||X.done){X=Y.content={text:(aH=P(X)?G:X)}}else{aH=X.text}if("ajax" in X){aG=X.ajax;C=aG&&aG.once!==G;delete X.ajax;X.text=function(aK,aJ){var aL=aH||at(this).attr(aJ.options.content.attr)||"Loading...",aI=at.ajax(at.extend({},aG,{context:aJ})).then(aG.success,ae,aG.error).then(function(aM){if(aM&&C){aJ.set("content.text",aM)}return aM},function(aO,aM,aN){if(aJ.destroyed||aO.status===0){return}aJ.set("content.text",aM+": "+aN)});return !C?(aJ.set("content.text",aL),aI):aL}}if("title" in X){if(!A(X.title)){X.button=X.title.button;X.title=X.title.text}if(P(X.title||G)){X.title=G}}}if("position" in Y&&A(Y.position)){Y.position={my:Y.position,at:Y.position}}if("show" in Y&&A(Y.show)){Y.show=Y.show.jquery?{target:Y.show}:Y.show===Q?{ready:Q}:{event:Y.show}}if("hide" in Y&&A(Y.hide)){Y.hide=Y.hide.jquery?{target:Y.hide}:{event:Y.hide}}if("style" in Y&&A(Y.style)){Y.style={classes:Y.style}}at.each(aF,function(){this.sanitize&&this.sanitize(Y)});return Y}h=az.checks={builtin:{"^id$":function(aG,aH,X,Y){var aI=X===Q?z.nextid:X,C=s+"-"+aI;if(aI!==G&&aI.length>0&&!at("#"+C).length){this._id=C;if(this.rendered){this.tooltip[0].id=this._id;this.elements.content[0].id=this._id+"-content";this.elements.title[0].id=this._id+"-title"}}else{aG[aH]=Y}},"^prerender":function(X,Y,C){C&&!this.rendered&&this.render(this.options.show.ready)},"^content.text$":function(X,Y,C){this._updateContent(C)},"^content.attr$":function(Y,aG,C,X){if(this.options.content.text===this.target.attr(X)){this._updateContent(this.target.attr(C))}},"^content.title$":function(X,Y,C){if(!C){return this._removeTitle()}C&&!this.elements.title&&this._createTitle();this._updateTitle(C)},"^content.button$":function(X,Y,C){this._updateButton(C)},"^content.title.(text|button)$":function(X,Y,C){this.set("content."+Y,C)},"^position.(my|at)$":function(X,Y,C){"string"===typeof C&&(X[Y]=new ak(C,Y==="at"))},"^position.container$":function(X,Y,C){this.tooltip.appendTo(C)},"^show.ready$":function(X,Y,C){C&&(!this.rendered&&this.render(Q)||this.toggle(Q))},"^style.classes$":function(Y,aG,C,X){this.tooltip.removeClass(X).addClass(C)},"^style.width|height":function(X,Y,C){this.tooltip.css(Y,C)},"^style.widget|content.title":function(){this._setWidget()},"^style.def":function(X,Y,C){this.tooltip.toggleClass(O,!!C)},"^events.(render|show|move|hide|focus|blur)$":function(X,Y,C){tooltip[(at.isFunction(C)?"":"un")+"bind"]("tooltip"+Y,C)},"^(show|hide|position).(event|target|fixed|inactive|leave|distance|viewport|adjust)":function(){var C=this.options.position;tooltip.attr("tracking",C.target==="mouse"&&C.adjust.mouse);this._unassignEvents();this._assignEvents()}}};function am(C,aG){var X=0,aI,Y=C,aH=aG.split(".");while(Y=Y[aH[X++]]){if(X<aH.length){aI=Y}}return[aI||C,aH.pop()]}az.get=function(X){if(this.destroyed){return this}var Y=am(this.options,X.toLowerCase()),C=Y[0][Y[1]];return C.precedance?C.string():C};function ab(aG,X){var Y,aH,C;for(Y in this.checks){for(aH in this.checks[Y]){if(C=(new RegExp(aH,"i")).exec(aG)){X.push(C);if(Y==="builtin"||this.plugins[Y]){this.checks[Y][aH].apply(this.plugins[Y]||this,X)}}}}}var x=/^position\.(my|at|adjust|target|container|viewport)|style|content|show\.ready/i,t=/^prerender|show\.ready/i;az.set=function(aH,aI){if(this.destroyed){return this}var aJ=this.rendered,C=G,aG=this.options,Y=this.checks,X;if("string"===typeof aH){X=aH;aH={};aH[X]=aI}else{aH=at.extend({},aH)}at.each(aH,function(aL,aM){if(!aJ&&!t.test(aL)){delete aH[aL];return}var aN=am(aG,aL.toLowerCase()),aK;aK=aN[0][aN[1]];aN[0][aN[1]]=aM&&aM.nodeType?at(aM):aM;C=x.test(aL)||C;aH[aL]=[aN[0],aN[1],aM,aK]});w(aG);this.positioning=Q;at.each(aH,at.proxy(ab,this));this.positioning=G;if(this.rendered&&this.tooltip[0].offsetWidth>0&&C){this.reposition(aG.position.target==="mouse"?ae:this.cache.event)}return this};az._update=function(aH,aG,C){var Y=this,X=this.cache;if(!this.rendered||!aH){return G}if(at.isFunction(aH)){aH=aH.call(this.elements.target,X.event,this)||""}if(at.isFunction(aH.then)){X.waiting=Q;return aH.then(function(aI){X.waiting=G;return Y._update(aI,aG)},ae,function(aI){return Y._update(aI,aG)})}if(aH===G||(!aH&&aH!=="")){return G}if(aH.jquery&&aH.length>0){aG.children().detach().end().append(aH.css({display:"block"}))}else{aG.html(aH)}X.waiting=Q;return(at.fn.imagesLoaded?aG.imagesLoaded():at.Deferred().resolve(at([]))).done(function(aI){X.waiting=G;if(aI.length&&Y.rendered&&Y.tooltip[0].offsetWidth>0){Y.reposition(X.event,!aI.length)}}).promise()};az._updateContent=function(X,C){this._update(X,this.elements.content,C)};az._updateTitle=function(X,C){if(this._update(X,this.elements.title,C)===G){this._removeTitle(G)}};az._createTitle=function(){var C=this.elements,X=this._id+"-title";if(C.titlebar){this._removeTitle()}C.titlebar=at("<div />",{"class":s+"-titlebar "+(this.options.style.widget?aA("header"):"")}).append(C.title=at("<div />",{id:X,"class":s+"-title","aria-atomic":Q})).insertBefore(C.content).delegate(".qtip-close","mousedown keydown mouseup keyup mouseout",function(Y){at(this).toggleClass("ui-state-active ui-state-focus",Y.type.substr(-4)==="down")}).delegate(".qtip-close","mouseover mouseout",function(Y){at(this).toggleClass("ui-state-hover",Y.type==="mouseover")});if(this.options.content.button){this._createButton()}};az._removeTitle=function(C){var X=this.elements;if(X.title){X.titlebar.remove();X.titlebar=X.title=X.button=ae;if(C!==G){this.reposition()}}};az.reposition=function(aV,aS){if(!this.rendered||this.positioning||this.destroyed){return this}this.positioning=Q;var aR=this.cache,aH=this.tooltip,aY=this.options.position,a0=aY.target,aP=aY.my,aQ=aY.at,aX=aY.viewport,aN=aY.container,aT=aY.adjust,X=aT.method.split(" "),aW=aH.outerWidth(G),aU=aH.outerHeight(G),aJ=0,aK=0,Y=aH.css("position"),aZ={left:0,top:0},C=aH[0].offsetWidth>0,aO=aV&&aV.type==="scroll",aG=at(b),a1=aN[0].ownerDocument,aM=this.mouse,aL,aI;if(at.isArray(a0)&&a0.length===2){aQ={x:e,y:q};aZ={left:a0[0],top:a0[1]}}else{if(a0==="mouse"&&((aV&&aV.pageX)||aR.event.pageX)){aQ={x:e,y:q};aV=aM&&aM.pageX&&(aT.mouse||!aV||!aV.pageX)?aM:(aV&&(aV.type==="resize"||aV.type==="scroll")?aR.event:aV&&aV.pageX&&aV.type==="mousemove"?aV:(!aT.mouse||this.options.show.distance)&&aR.origin&&aR.origin.pageX?aR.origin:aV)||aV||aR.event||aM||{};if(Y!=="static"){aZ=aN.offset()}if(a1.body.offsetWidth!==(b.innerWidth||a1.documentElement.clientWidth)){aI=at(a1.body).offset()}aZ={left:aV.pageX-aZ.left+(aI&&aI.left||0),top:aV.pageY-aZ.top+(aI&&aI.top||0)};if(aT.mouse&&aO){aZ.left-=aM.scrollX-aG.scrollLeft();aZ.top-=aM.scrollY-aG.scrollTop()}}else{if(a0==="event"&&aV&&aV.target&&aV.type!=="scroll"&&aV.type!=="resize"){aR.target=at(aV.target)}else{if(a0!=="event"){aR.target=at(a0.jquery?a0:elements.target)}}a0=aR.target;a0=at(a0).eq(0);if(a0.length===0){return this}else{if(a0[0]===a||a0[0]===b){aJ=BROWSER.iOS?b.innerWidth:a0.width();aK=BROWSER.iOS?b.innerHeight:a0.height();if(a0[0]===b){aZ={top:(aX||a0).scrollTop(),left:(aX||a0).scrollLeft()}}}else{if(aF.imagemap&&a0.is("area")){aL=aF.imagemap(this,a0,aQ,aF.viewport?X:G)}else{if(aF.svg&&a0[0].ownerSVGElement){aL=aF.svg(this,a0,aQ,aF.viewport?X:G)}else{aJ=a0.outerWidth(G);aK=a0.outerHeight(G);aZ=a0.offset()}}}}if(aL){aJ=aL.width;aK=aL.height;aI=aL.offset;aZ=aL.position}aZ=this.reposition.offset(a0,aZ,aN);if((BROWSER.iOS>3.1&&BROWSER.iOS<4.1)||(BROWSER.iOS>=4.3&&BROWSER.iOS<4.33)||(!BROWSER.iOS&&Y==="fixed")){aZ.left-=aG.scrollLeft();aZ.top-=aG.scrollTop()}if(!aL||(aL&&aL.adjustable!==G)){aZ.left+=aQ.x===n?aJ:aQ.x===I?aJ/2:0;aZ.top+=aQ.y===au?aK:aQ.y===I?aK/2:0}}}aZ.left+=aT.x+(aP.x===n?-aW:aP.x===I?-aW/2:0);aZ.top+=aT.y+(aP.y===au?-aU:aP.y===I?-aU/2:0);if(aF.viewport){aZ.adjusted=aF.viewport(this,aZ,aY,aJ,aK,aW,aU);if(aI&&aZ.adjusted.left){aZ.left+=aI.left}if(aI&&aZ.adjusted.top){aZ.top+=aI.top}}else{aZ.adjusted={left:0,top:0}}if(!this._trigger("move",[aZ,aX.elem||aX],aV)){return this}delete aZ.adjusted;if(aS===G||!C||isNaN(aZ.left)||isNaN(aZ.top)||a0==="mouse"||!at.isFunction(aY.effect)){aH.css(aZ)}else{if(at.isFunction(aY.effect)){aY.effect.call(aH,this,at.extend({},aZ));aH.queue(function(a2){at(this).css({opacity:"",height:""});if(BROWSER.ie){this.style.removeAttribute("filter")}a2()})}}this.positioning=G;return this};az.reposition.offset=function(aG,aK,X){if(!X[0]){return aK}var aN=at(aG[0].ownerDocument),aJ=!!BROWSER.ie&&a.compatMode!=="CSS1Compat",aM=X[0],Y,aI,C,aH;function aL(aP,aO){aK.left+=aO*aP.scrollLeft();aK.top+=aO*aP.scrollTop()}do{if((aI=at.css(aM,"position"))!=="static"){if(aI==="fixed"){C=aM.getBoundingClientRect();aL(aN,-1)}else{C=at(aM).position();C.left+=(parseFloat(at.css(aM,"borderLeftWidth"))||0);C.top+=(parseFloat(at.css(aM,"borderTopWidth"))||0)}aK.left-=C.left+(parseFloat(at.css(aM,"marginLeft"))||0);aK.top-=C.top+(parseFloat(at.css(aM,"marginTop"))||0);if(!Y&&(aH=at.css(aM,"overflow"))!=="hidden"&&aH!=="visible"){Y=at(aM)}}}while((aM=aM.offsetParent));if(Y&&(Y[0]!==aN[0]||aJ)){aL(Y,1)}return aK};var ag=(ak=az.reposition.Corner=function(X,C){X=(""+X).replace(/([A-Z])/," $1").replace(/middle/gi,I).toLowerCase();this.x=(X.match(/left|right/i)||X.match(/center/)||["inherit"])[0].toLowerCase();this.y=(X.match(/top|bottom|center/i)||["inherit"])[0].toLowerCase();this.forceY=!!C;var Y=X.charAt(0);this.precedance=(Y==="t"||Y==="b"?W:Z)}).prototype;ag.invert=function(X,C){this[X]=this[X]===e?n:this[X]===n?e:C||this[X]};ag.string=function(){var C=this.x,X=this.y;return C===X?C:this.precedance===W||(this.forceY&&X!=="center")?X+" "+C:C+" "+X};ag.abbrev=function(){var C=this.string().split(" ");return C[0].charAt(0)+(C[1]&&C[1].charAt(0)||"")};ag.clone=function(){return new ak(this.string(),this.forceY)};az.toggle=function(aI,aQ){var aO=this.cache,X=this.options,aH=this.tooltip;if(aQ){if((/over|enter/).test(aQ.type)&&(/out|leave/).test(aO.event.type)&&X.show.target.add(aQ.target).length===X.show.target.length&&aH.has(aQ.relatedTarget).length){return this}aO.event=at.extend({},aQ)}this.waiting&&!aI&&(this.hiddenDuringWait=Q);if(!this.rendered){return aI?this.render(1):this}else{if(this.destroyed||this.disabled){return this}}var aG=aI?"show":"hide",aN=this.options[aG],aM=this.options[!aI?"show":"hide"],aS=this.options.position,aK=this.options.content,aP=this.tooltip.css("width"),C=this.tooltip[0].offsetWidth>0,aJ=aI||aN.target.length===1,aL=!aQ||aN.target.length<2||aO.target[0]===aQ.target,aR,aU,Y,aT;if((typeof aI).search("boolean|number")){aI=!C}aR=!aH.is(":animated")&&C===aI&&aL;aU=!aR?!!this._trigger(aG,[90]):ae;if(aU!==G&&aI){this.focus(aQ)}if(!aU||aR){return this}at.attr(aH[0],"aria-hidden",!!!aI);if(aI){aO.origin=at.extend({},this.mouse);if(at.isFunction(aK.text)){this._updateContent(aK.text,G)}if(at.isFunction(aK.title)){this._updateTitle(aK.title,G)}if(!aC&&aS.target==="mouse"&&aS.adjust.mouse){at(a).bind("mousemove."+s,this._storeMouse);aC=Q}if(!aP){aH.css("width",aH.outerWidth(G))}this.reposition(aQ,arguments[2]);if(!aP){aH.css("width","")}if(!!aN.solo){(typeof aN.solo==="string"?at(aN.solo):at(y,aN.solo)).not(aH).not(aN.target).qtip("hide",at.Event("tooltipsolo"))}}else{clearTimeout(this.timers.show);delete aO.origin;if(aC&&!at(y+'[tracking="true"]:visible',aN.solo).not(aH).length){at(a).unbind("mousemove."+s);aC=G}this.blur(aQ)}after=at.proxy(function(){if(aI){if(BROWSER.ie){aH[0].style.removeAttribute("filter")}aH.css("overflow","");if("string"===typeof aN.autofocus){at(this.options.show.autofocus,aH).focus()}this.options.show.target.trigger("qtip-"+this.id+"-inactive")}else{aH.css({display:"",visibility:"",opacity:"",left:"",top:""})}this._trigger(aI?"visible":"hidden")},this);if(aN.effect===G||aJ===G){aH[aG]();after()}else{if(at.isFunction(aN.effect)){aH.stop(1,1);aN.effect.call(aH,this);aH.queue("fx",function(aV){after();aV()})}else{aH.fadeTo(90,aI?1:0,after)}}if(aI){aN.target.trigger("qtip-"+this.id+"-inactive")}return this};az.show=function(C){return this.toggle(Q,C)};az.hide=function(C){return this.toggle(G,C)};az.focus=function(aG){if(!this.rendered||this.destroyed){return this}var aI=at(y),aH=this.tooltip,Y=parseInt(aH[0].style.zIndex,10),X=z.zindex+aI.length,C;if(!aH.hasClass(M)){if(this._trigger("focus",[X],aG)){if(Y!==X){aI.each(function(){if(this.style.zIndex>Y){this.style.zIndex=this.style.zIndex-1}});aI.filter("."+M).qtip("blur",aG)}aH.addClass(M)[0].style.zIndex=X}}return this};az.blur=function(C){if(!this.rendered||this.destroyed){return this}this.tooltip.removeClass(M);this._trigger("blur",[this.tooltip.css("zIndex")],C);return this};az.disable=function(C){if(this.destroyed){return this}if("boolean"!==typeof C){C=!(this.tooltip.hasClass(T)||this.disabled)}if(this.rendered){this.tooltip.toggleClass(T,C).attr("aria-disabled",C)}this.disabled=!!C;return this};az.enable=function(){return this.disable(G)};az._createButton=function(){var X=this,aH=this.elements,aG=aH.tooltip,Y=this.options.content.button,C=typeof Y==="string",aI=C?Y:"Close tooltip";if(aH.button){aH.button.remove()}if(Y.jquery){aH.button=Y}else{aH.button=at("<a />",{"class":"qtip-close "+(this.options.style.widget?"":s+"-icon"),title:aI,"aria-label":aI}).prepend(at("<span />",{"class":"ui-icon ui-icon-close",html:"&times;"}))}aH.button.appendTo(aH.titlebar||aG).attr("role","button").click(function(aJ){if(!aG.hasClass(T)){X.hide(aJ)}return G})};az._updateButton=function(C){if(!this.rendered){return G}var X=this.elements.button;if(C){this._createButton()}else{X.remove()}};function aA(C){return aj.concat("").join(C?"-"+C+" ":" ")}az._setWidget=function(){var C=this.options.style.widget,aG=this.elements,Y=aG.tooltip,X=Y.hasClass(T);Y.removeClass(T);T=C?"ui-state-disabled":"qtip-disabled";Y.toggleClass(T,X);Y.toggleClass("ui-helper-reset "+aA(),C).toggleClass(O,this.options.style.def&&!C);if(aG.content){aG.content.toggleClass(aA("content"),C)}if(aG.titlebar){aG.titlebar.toggleClass(aA("header"),C)}if(aG.button){aG.button.toggleClass(s+"-icon",!C)}};function K(C){if(this.tooltip.hasClass(T)){return G}clearTimeout(this.timers.show);clearTimeout(this.timers.hide);var X=at.proxy(function(){this.toggle(Q,C)},this);if(this.options.show.delay>0){this.timers.show=setTimeout(X,this.options.show.delay)}else{X()}}function g(aG){if(this.tooltip.hasClass(T)){return G}var X=at(aG.relatedTarget),C=X.closest(y)[0]===this.tooltip[0],Y=X[0]===this.options.show.target[0];clearTimeout(this.timers.show);clearTimeout(this.timers.hide);if(this!==X[0]&&(this.options.position.target==="mouse"&&C)||(this.options.hide.fixed&&((/mouse(out|leave|move)/).test(aG.type)&&(C||Y)))){try{aG.preventDefault();aG.stopImmediatePropagation()}catch(aH){}return}var aI=at.proxy(function(){this.toggle(G,aG)},this);if(this.options.hide.delay>0){this.timers.hide=setTimeout(aI,this.options.hide.delay)}else{aI()}}function l(C){if(this.tooltip.hasClass(T)||!this.options.hide.inactive){return G}clearTimeout(this.timers.inactive);this.timers.inactive=setTimeout(at.proxy(function(){this.hide(C)},this),this.options.hide.inactive)}function ah(C){if(this.rendered&&this.tooltip[0].offsetWidth>0){this.reposition(C)}}az._storeMouse=function(C){this.mouse={pageX:C.pageX,pageY:C.pageY,type:"mousemove",scrollX:b.pageXOffset||a.body.scrollLeft||a.documentElement.scrollLeft,scrollY:b.pageYOffset||a.body.scrollTop||a.documentElement.scrollTop}};az._bind=function(C,Y,aI,aH,X){var aG="."+this._id+(aH?"-"+aH:"");Y.length&&at(C).bind((Y.split?Y:Y.join(aG+" "))+aG,at.proxy(aI,X||this))};az._unbind=function(C,X){at(C).unbind("."+this._id+(X?"-"+X:""))};var aa="."+s;function ap(C,X,Y){at(a.body).delegate(C,(X.split?X:X.join(aa+" "))+aa,function(){var aG=z.api[at.attr(this,ac)];aG&&!aG.disabled&&Y.apply(aG,arguments)})}at(function(){ap(y,["mouseenter","mouseleave"],function(X){var aG=X.type==="mouseenter",Y=at(X.currentTarget),aH=at(X.relatedTarget||X.target),C=this.options;if(aG){this.focus(X);Y.hasClass(B)&&!Y.hasClass(T)&&clearTimeout(this.timers.hide)}else{if(C.position.target==="mouse"&&C.hide.event&&C.show.target&&!aH.closest(C.show.target[0]).length){this.hide(X)}}Y.toggleClass(aE,aG)});ap("["+ac+"]",ad,l)});az._trigger=function(X,C,Y){var aG=at.Event("tooltip"+X);aG.originalEvent=(Y&&at.extend({},Y))||this.cache.event||ae;this.triggering=Q;this.tooltip.trigger(aG,[this].concat(C||[]));this.triggering=G;return !aG.isDefaultPrevented()};az._assignEvents=function(){var aP=this.options,aM=aP.position,aO=this.tooltip,aI=aP.show.target,aL=aP.hide.target,aJ=aM.container,Y=aM.viewport,aH=at(a),aG=at(a.body),aK=at(b),X=aP.show.event?at.trim(""+aP.show.event).split(" "):[],aN=aP.hide.event?at.trim(""+aP.hide.event).split(" "):[],C=[];if(/mouse(out|leave)/i.test(aP.hide.event)&&aP.hide.leave==="window"){this._bind(aH,["mouseout","blur"],function(aQ){if(!/select|option/.test(aQ.target.nodeName)&&!aQ.relatedTarget){this.hide(aQ)}})}if(aP.hide.fixed){aL=aL.add(aO.addClass(B))}else{if(/mouse(over|enter)/i.test(aP.show.event)){this._bind(aL,"mouseleave",function(){clearTimeout(this.timers.show)})}}if((""+aP.hide.event).indexOf("unfocus")>-1){this._bind(aJ.closest("html"),["mousedown","touchstart"],function(aT){var aS=at(aT.target),aR=this.rendered&&!this.tooltip.hasClass(T)&&this.tooltip[0].offsetWidth>0,aQ=aS.parents(y).filter(this.tooltip[0]).length>0;if(aS[0]!==this.target[0]&&aS[0]!==this.tooltip[0]&&!aQ&&!this.target.has(aS[0]).length&&aR){this.hide(aT)}})}if("number"===typeof aP.hide.inactive){this._bind(aI,"qtip-"+this.id+"-inactive",l);this._bind(aL.add(aO),z.inactiveEvents,l,"-inactive")}aN=at.map(aN,function(aR){var aQ=at.inArray(aR,X);if((aQ>-1&&aL.add(aI).length===aL.length)){C.push(X.splice(aQ,1)[0]);return}return aR});this._bind(aI,X,K);this._bind(aL,aN,g);this._bind(aI,C,function(aQ){(this.tooltip[0].offsetWidth>0?g:K).call(this,aQ)});this._bind(aI.add(aO),"mousemove",function(aT){if("number"===typeof aP.hide.distance){var aS=this.cache.origin||{},aR=this.options.hide.distance,aQ=Math.abs;if(aQ(aT.pageX-aS.pageX)>=aR||aQ(aT.pageY-aS.pageY)>=aR){this.hide(aT)}}this._storeMouse(aT)});if(aM.target==="mouse"){if(aM.adjust.mouse){if(aP.hide.event){this._bind(aI,["mouseenter","mouseleave"],function(aQ){this.cache.onTarget=aQ.type==="mouseenter"})}this._bind(aH,"mousemove",function(aQ){if(this.rendered&&this.cache.onTarget&&!this.tooltip.hasClass(T)&&this.tooltip[0].offsetWidth>0){this.reposition(aQ)}})}}if(aM.adjust.resize||Y.length){this._bind(at.event.special.resize?Y:aK,"resize",ah)}if(aM.adjust.scroll){this._bind(aK.add(aM.container),"scroll",ah)}};az._unassignEvents=function(){var C=[this.options.show.target[0],this.options.hide.target[0],this.rendered&&this.tooltip[0],this.options.position.container[0],this.options.position.viewport[0],this.options.position.container.closest("html")[0],b,a];if(this.rendered){this._unbind(at([]).pushStack(at.grep(C,function(X){return typeof X==="object"})))}else{at(C[0]).unbind("."+this._id+"-create")}};function af(aG,X,C){var aH,aQ,aL,Y,aO,aI=at(a.body),aN=aG[0]===a?aI:aG,aM=(aG.metadata)?aG.metadata(C.metadata):ae,aP=C.metadata.type==="html5"&&aM?aM[C.metadata.name]:ae,aJ=aG.data(C.metadata.name||"qtipopts");try{aJ=typeof aJ==="string"?at.parseJSON(aJ):aJ}catch(aK){}Y=at.extend(Q,{},z.defaults,C,typeof aJ==="object"?w(aJ):ae,w(aP||aM));aQ=Y.position;Y.id=X;if("boolean"===typeof Y.content.text){aL=aG.attr(Y.content.attr);if(Y.content.attr!==G&&aL){Y.content.text=aL}else{return G}}if(!aQ.container.length){aQ.container=aI}if(aQ.target===G){aQ.target=aN}if(Y.show.target===G){Y.show.target=aN}if(Y.show.solo===Q){Y.show.solo=aQ.container.closest("body")}if(Y.hide.target===G){Y.hide.target=aN}if(Y.position.viewport===Q){Y.position.viewport=aQ.container}aQ.container=aQ.container.eq(0);aQ.at=new ak(aQ.at,Q);aQ.my=new ak(aQ.my);if(aG.data(s)){if(Y.overwrite){aG.qtip("destroy")}else{if(Y.overwrite===G){return G}}}aG.attr(E,X);if(Y.suppress&&(aO=aG.attr("title"))){aG.removeAttr("title").attr(F,aO).attr("title","")}aH=new aw(aG,Y,X,!!aL);aG.data(s,aH);aG.one("remove.qtip-"+X+" removeqtip.qtip-"+X,function(){var aR;if((aR=at(this).data(s))){aR.destroy()}});return aH}z=at.fn.qtip=function(X,aI,aJ){var aK=(""+X).toLowerCase(),aH=ae,C=at.makeArray(arguments).slice(1),aG=C[C.length-1],Y=this[0]?at.data(this[0],s):ae;if((!arguments.length&&Y)||aK==="api"){return Y}else{if("string"===typeof X){this.each(function(){var aL=at.data(this,s);if(!aL){return Q}if(aG&&aG.timeStamp){aL.cache.event=aG}if(aI&&(aK==="option"||aK==="options")){if(aJ!==c||at.isPlainObject(aI)){aL.set(aI,aJ)}else{aH=aL.get(aI);return G}}else{if(aL[aK]){aL[aK].apply(aL,C)}}});return aH!==ae?aH:this}else{if("object"===typeof X||!arguments.length){Y=w(at.extend(Q,{},X));return z.bind.call(this,Y,aG)}}}};z.bind=function(X,C){return this.each(function(aI){var aG,Y,aH,aK,aJ,aM;aM=at.isArray(X.id)?X.id[aI]:X.id;aM=!aM||aM===G||aM.length<1||z.api[aM]?z.nextid++:aM;aK=".qtip-"+aM+"-create";aJ=af(at(this),aM,X);if(aJ===G){return Q}else{z.api[aM]=aJ}aG=aJ.options;at.each(aF,function(){if(this.initialize==="initialize"){this(aJ)}});Y={show:aG.show.target,hide:aG.hide.target};aH={show:at.trim(""+aG.show.event).replace(/ /g,aK+" ")+aK,hide:at.trim(""+aG.hide.event).replace(/ /g,aK+" ")+aK};if(/mouse(over|enter)/i.test(aH.show)&&!/mouse(out|leave)/i.test(aH.hide)){aH.hide+=" mouseleave"+aK}Y.show.bind("mousemove"+aK,function(aN){aJ._storeMouse(aN);aJ.cache.onTarget=Q});function aL(aO){function aN(){aJ.render(typeof aO==="object"||aG.show.ready);Y.show.add(Y.hide).unbind(aK)}if(aJ.disabled){return G}aJ.cache.event=at.extend({},aO);aJ.cache.target=aO?at(aO.target):[c];if(aG.show.delay>0){clearTimeout(aJ.timers.show);aJ.timers.show=setTimeout(aN,aG.show.delay);if(aH.show!==aH.hide){Y.hide.bind(aH.hide,function(){clearTimeout(aJ.timers.show)})}}else{aN()}}Y.show.bind(aH.show,aL);if(aG.show.ready||aG.prerender){aL(C)}})};z.api={};at.each({attr:function(C,aH){if(this.length){var X=this[0],aG="title",Y=at.data(X,"qtip");if(C===aG&&Y&&"object"===typeof Y&&Y.options.suppress){if(arguments.length<2){return at.attr(X,F)}if(Y&&Y.options.content.attr===aG&&Y.cache.attr){Y.set("content.text",aH)}return this.attr(F,aH)}}return at.fn["attr"+aD].apply(this,arguments)},clone:function(X){var aG=at([]),Y="title",C=at.fn["clone"+aD].apply(this,arguments);if(!X){C.filter("["+F+"]").attr("title",function(){return at.attr(this,F)}).removeAttr(F)}return C}},function(X,Y){if(!Y||at.fn[X+aD]){return Q}var C=at.fn[X+aD]=at.fn[X];at.fn[X]=function(){return Y.apply(this,arguments)||C.apply(this,arguments)}});if(!at.ui){at["cleanData"+aD]=at.cleanData;at.cleanData=function(C){for(var X=0,Y;(Y=at(C[X])).length;X++){if(Y.attr(E)){try{Y.triggerHandler("removeqtip")}catch(aG){}}}at["cleanData"+aD].apply(this,arguments)}}z.version="2.1.1";z.nextid=0;z.inactiveEvents=ad;z.zindex=15000;z.defaults={prerender:G,id:G,overwrite:Q,suppress:Q,content:{text:Q,attr:"title",title:G,button:G},position:{my:"top left",at:"bottom right",target:G,container:G,viewport:G,adjust:{x:0,y:0,mouse:Q,scroll:Q,resize:Q,method:"flipinvert flipinvert"},effect:function(X,Y,C){at(this).animate(Y,{duration:200,queue:G})}},show:{target:G,event:"mouseenter",effect:Q,delay:90,solo:G,ready:G,autofocus:G},hide:{target:G,event:"mouseleave",effect:Q,delay:0,fixed:G,inactive:G,leave:"window",distance:G},style:{classes:"",widget:G,width:G,height:G,def:Q},events:{render:ae,move:ae,show:ae,hide:ae,toggle:ae,visible:ae,hidden:ae,focus:ae,blur:ae}};var m,S=".qtip-tip",N="margin",ax="border",ar="color",an="background-color",ai="transparent",aq=" !important",av=!!a.createElement("canvas").getContext,f=/rgba?\(0, 0, 0(, 0)?\)|transparent|#123456/i;function U(C){return C.charAt(0).toUpperCase()+C.slice(1)}var D={},H=["Webkit","O","Moz","ms"];function o(aG,aJ){var C=aJ.charAt(0).toUpperCase()+aJ.slice(1),Y=(aJ+" "+H.join(C+" ")+C).split(" "),aI,aH,X=0;if(D[aJ]){return aG.css(D[aJ])}while((aI=Y[X++])){if((aH=aG.css(aI))!==c){return D[aJ]=aI,aH}}}function J(C,X){return parseInt(o(C,X),10)}if(!av){createVML=function(C,Y,X){return"<qtipvml:"+C+' xmlns="urn:schemas-microsoft.com:vml" class="qtip-vml" '+(Y||"")+' style="behavior: url(#default#VML); '+(X||"")+'" />'}}function ao(X,C){this._ns="tip";this.options=C;this.offset=C.offset;this.size=[C.width,C.height];this.init((this.qtip=X))}at.extend(ao.prototype,{init:function(Y){var C,X;X=this.element=Y.elements.tip=at("<div />",{"class":s+"-tip"}).prependTo(Y.tooltip);if(av){C=at("<canvas />").appendTo(this.element)[0].getContext("2d");C.lineJoin="miter";C.miterLimit=100;C.save()}else{C=createVML("shape",'coordorigin="0,0"',"position:absolute;");this.element.html(C+C);Y._bind(at("*",X).add(X),["click","mousedown"],function(aG){aG.stopPropagation()},this._ns)}Y._bind(Y.tooltip,"tooltipmove",this.reposition,this._ns,this);this.create()},_swapDimensions:function(){this.size[0]=this.options.height;this.size[1]=this.options.width},_resetDimensions:function(){this.size[0]=this.options.width;this.size[1]=this.options.height},_useTitle:function(C){var X=this.qtip.elements.titlebar;return X&&(C.y===q||(C.y===I&&this.element.position().top+(this.size[1]/2)+this.options.offset<X.outerHeight(Q)))},_parseCorner:function(C){var X=this.qtip.options.position.my;if(C===G||X===G){C=G}else{if(C===Q){C=new ak(X.string())}else{if(!C.string){C=new ak(C);C.fixed=Q}}}return C},_parseWidth:function(Y,X,C){var aG=this.qtip.elements,aH=ax+U(X)+"Width";return(C?J(C,aH):(J(aG.content,aH)||J(this._useTitle(Y)&&aG.titlebar||aG.content,aH)||J(tooltip,aH)))||0},_parseRadius:function(C){var X=this.qtip.elements,Y=ax+U(C.y)+U(C.x)+"Radius";return BROWSER.ie<9?0:J(this._useTitle(C)&&X.titlebar||X.content,Y)||J(X.tooltip,Y)||0},_invalidColour:function(C,aG,X){var Y=C.css(aG);return !Y||(X&&Y===C.css(X))||f.test(Y)?G:Y},_parseColours:function(aH){var aJ=this.qtip.elements,aI=this.element.css("cssText",""),aG=ax+U(aH[aH.precedance])+U(ar),X=this._useTitle(aH)&&aJ.titlebar||aJ.content,Y=this._invalidColour,C=[];C[0]=Y(aI,an)||Y(X,an)||Y(aJ.content,an)||Y(tooltip,an)||aI.css(an);C[1]=Y(aI,aG,ar)||Y(X,aG,ar)||Y(aJ.content,aG,ar)||Y(tooltip,aG,ar)||tooltip.css(aG);at("*",aI).add(aI).css("cssText",an+":"+ai+aq+";"+ax+":0"+aq+";");return C},_calculateSize:function(aM){var aK=aM.precedance===W,X=this.options[aK?"height":"width"],aN=this.options[aK?"width":"height"],aJ=aM.abbrev()==="c",C=X*(aJ?0.5:1),aG=Math.pow,aO=Math.round,aL,aI,aP,Y=Math.sqrt(aG(C,2)+aG(aN,2)),aH=[(this.border/C)*Y,(this.border/aN)*Y];aH[2]=Math.sqrt(aG(aH[0],2)-aG(this.border,2));aH[3]=Math.sqrt(aG(aH[1],2)-aG(this.border,2));aL=Y+aH[2]+aH[3]+(aJ?0:aH[0]);aI=aL/Y;aP=[aO(aI*X),aO(aI*aN)];return aK?aP:aP.reverse()},_calculateTip:function(aI){var aG=this.size[0],X=this.size[1],Y=Math.ceil(aG/2),aH=Math.ceil(X/2),C={br:[0,0,aG,X,aG,0],bl:[0,0,aG,0,0,X],tr:[0,X,aG,0,aG,X],tl:[0,0,0,X,aG,X],tc:[0,X,Y,0,aG,X],bc:[0,0,aG,0,Y,X],rc:[0,0,aG,aH,0,X],lc:[aG,0,aG,X,0,aH]};C.lt=C.br;C.rt=C.bl;C.lb=C.tr;C.rb=C.tl;return C[aI.abbrev()]},create:function(){var C=this.corner=(av||BROWSER.ie)&&this._parseCorner(this.options.corner);if((this.enabled=!!this.corner&&this.corner.abbrev()!=="c")){this.qtip.cache.corner=C.clone();this.update()}this.element.toggle(this.enabled);return this.corner},update:function(aN,aJ){if(!this.enabled){return this}var C=this.qtip.elements,aM=this.element,aR=aM.children(),aQ=this.options,aP=this.size,aS=aQ.mimic,aO=Math.round,aI,X,Y,aL,aG,aK,aH;if(!aN){aN=this.qtip.cache.corner||this.corner}if(aS===G){aS=aN}else{aS=new ak(aS);aS.precedance=aN.precedance;if(aS.x==="inherit"){aS.x=aN.x}else{if(aS.y==="inherit"){aS.y=aN.y}else{if(aS.x===aS.y){aS[aN.precedance]=aN[aN.precedance]}}}}X=aS.precedance;if(aN.precedance===Z){this._swapDimensions()}else{this._resetDimensions()}aI=this.color=this._parseColours(aN);if(aI[1]!==ai){aH=this.border=this._parseWidth(aN,aN[aN.precedance]);if(aQ.border&&aH<1){aI[0]=aI[1]}this.border=aH=aQ.border!==Q?aQ.border:aH}else{this.border=aH=0}aL=this._calculateTip(aS);aK=this.size=this._calculateSize(aN);aM.css({width:aK[0],height:aK[1],lineHeight:aK[1]+"px"});if(aN.precedance===W){aG=[aO(aS.x===e?aH:aS.x===n?aK[0]-aP[0]-aH:(aK[0]-aP[0])/2),aO(aS.y===q?aK[1]-aP[1]:0)]}else{aG=[aO(aS.x===e?aK[0]-aP[0]:0),aO(aS.y===q?aH:aS.y===au?aK[1]-aP[1]-aH:(aK[1]-aP[1])/2)]}if(av){aR.attr(L,aK[0]).attr(ay,aK[1]);Y=aR[0].getContext("2d");Y.restore();Y.save();Y.clearRect(0,0,3000,3000);Y.fillStyle=aI[0];Y.strokeStyle=aI[1];Y.lineWidth=aH*2;Y.translate(aG[0],aG[1]);Y.beginPath();Y.moveTo(aL[0],aL[1]);Y.lineTo(aL[2],aL[3]);Y.lineTo(aL[4],aL[5]);Y.closePath();if(aH){if(tooltip.css("background-clip")==="border-box"){Y.strokeStyle=aI[0];Y.stroke()}Y.strokeStyle=aI[1];Y.stroke()}Y.fill()}else{aL="m"+aL[0]+","+aL[1]+" l"+aL[2]+","+aL[3]+" "+aL[4]+","+aL[5]+" xe";aG[2]=aH&&/^(r|b)/i.test(aN.string())?BROWSER.ie===8?2:1:0;aR.css({coordsize:(aP[0]+aH)+" "+(aP[1]+aH),antialias:""+(aS.string().indexOf(I)>-1),left:aG[0]-(aG[2]*Number(X===Z)),top:aG[1]-(aG[2]*Number(X===W)),width:aP[0]+aH,height:aP[1]+aH}).each(function(aT){var aU=at(this);aU[aU.prop?"prop":"attr"]({coordsize:(aP[0]+aH)+" "+(aP[1]+aH),path:aL,fillcolor:aI[0],filled:!!aT,stroked:!aT}).toggle(!!(aH||aT));!aT&&aU.html(createVML("stroke",'weight="'+(aH*2)+'px" color="'+aI[1]+'" miterlimit="1000" joinstyle="miter"'))})}if(aJ!==G){this.calculate(aN)}},calculate:function(aK){if(!this.enabled){return G}var aL=this,C=this.qtip.elements,aJ=this.element,X=this.options.offset,Y=this.qtip.tooltip.hasClass("ui-widget"),aI={},aG,aM,aH;aK=aK||this.corner;aG=aK.precedance;aM=this._calculateSize(aK);aH=[aK.x,aK.y];if(aG===Z){aH.reverse()}at.each(aH,function(aQ,aP){var aN,aR,aO;if(aP===I){aN=aG===W?e:q;aI[aN]="50%";aI[N+"-"+aN]=-Math.round(aM[aG===W?0:1]/2)+X}else{aN=aL._parseWidth(aK,aP,C.tooltip);aR=aL._parseWidth(aK,aP,C.content);aO=aL._parseRadius(aK);aI[aP]=Math.max(-aL.border,aQ?aR:(X+(aO>aN?aO:-aN)))}});aI[aK[aG]]-=aM[aG===Z?0:1];aJ.css({margin:"",top:"",bottom:"",left:"",right:""}).css(aI);return aI},reposition:function(aG,aL,aO,aM){if(!this.enabled){return}var X=aL.cache,aQ=this.corner.clone(),aP=aO.adjusted,C=aL.options.position.adjust.method.split(" "),Y=C[0],aI=C[1]||C[0],aH={left:G,top:G,x:0,y:0},aJ,aK={},aN;if(this.corner.fixed!==Q){if(Y===r&&aQ.precedance===Z&&aP.left&&aQ.y!==I){aQ.precedance=aQ.precedance===Z?W:Z}else{if(Y!==r&&aP.left){aQ.x=aQ.x===I?(aP.left>0?e:n):(aQ.x===e?n:e)}}if(aI===r&&aQ.precedance===W&&aP.top&&aQ.x!==I){aQ.precedance=aQ.precedance===W?Z:W}else{if(aI!==r&&aP.top){aQ.y=aQ.y===I?(aP.top>0?q:au):(aQ.y===q?au:q)}}if(aQ.string()!==X.corner.string()&&(X.cornerTop!==aP.top||X.cornerLeft!==aP.left)){this.update(aQ,G)}}aJ=this.calculate(aQ,aP);if(aJ.right!==c){aJ.left=-aJ.right}if(aJ.bottom!==c){aJ.top=-aJ.bottom}aJ.user=this.offset;if(aH.left=(Y===r&&!!aP.left)){if(aQ.x===I){aK[N+"-left"]=aH.x=aJ[N+"-left"]-aP.left}else{aN=aJ.right!==c?[aP.left,-aJ.left]:[-aP.left,aJ.left];if((aH.x=Math.max(aN[0],aN[1]))>aN[0]){aO.left-=aP.left;aH.left=G}aK[aJ.right!==c?n:e]=aH.x}}if(aH.top=(aI===r&&!!aP.top)){if(aQ.y===I){aK[N+"-top"]=aH.y=aJ[N+"-top"]-aP.top}else{aN=aJ.bottom!==c?[aP.top,-aJ.top]:[-aP.top,aJ.top];if((aH.y=Math.max(aN[0],aN[1]))>aN[0]){aO.top-=aP.top;aH.top=G}aK[aJ.bottom!==c?au:q]=aH.y}}this.element.css(aK).toggle(!((aH.x&&aH.y)||(aQ.x===I&&aH.y)||(aQ.y===I&&aH.x)));aO.left-=aJ.left.charAt?aJ.user:Y!==r||aH.top||!aH.left&&!aH.top?aJ.left:0;aO.top-=aJ.top.charAt?aJ.user:aI!==r||aH.left||!aH.left&&!aH.top?aJ.top:0;X.cornerLeft=aP.left;X.cornerTop=aP.top;X.corner=aQ.clone()},destroy:function(){this.qtip._unbind(this.qtip.tooltip,this._ns);if(this.qtip.elements.tip){this.qtip.elements.tip.find("*").remove().end().remove()}}});m=aF.tip=function(C){return new ao(C,C.options.style.tip)};m.initialize="render";m.sanitize=function(C){if(C.style&&"tip" in C.style){opts=C.style.tip;if(typeof opts!=="object"){opts=C.style.tip={corner:opts}}if(!(/string|boolean/i).test(typeof opts.corner)){opts.corner=Q}}};h.tip={"^position.my|style.tip.(corner|mimic|border)$":function(){this.create();this.qtip.reposition()},"^style.tip.(height|width)$":function(C){this.size=size=[C.width,C.height];this.update();this.qtip.reposition()},"^content.title|style.(classes|widget)$":function(){this.update()}};at.extend(Q,z.defaults,{style:{tip:{corner:Q,mimic:G,width:6,height:6,border:Q,offset:0}}});aF.polys={polygon:function(X,aN){var aO={width:0,height:0,position:{top:10000000000,right:0,bottom:0,left:10000000000},adjustable:G},aI=0,aJ,aM=[],aL=1,aK=1,aH=0,Y=0,aG,C;aI=X.length;while(aI--){aJ=[parseInt(X[--aI],10),parseInt(X[aI+1],10)];if(aJ[0]>aO.position.right){aO.position.right=aJ[0]}if(aJ[0]<aO.position.left){aO.position.left=aJ[0]}if(aJ[1]>aO.position.bottom){aO.position.bottom=aJ[1]}if(aJ[1]<aO.position.top){aO.position.top=aJ[1]}aM.push(aJ)}aG=aO.width=Math.abs(aO.position.right-aO.position.left);C=aO.height=Math.abs(aO.position.bottom-aO.position.top);if(aN.abbrev()==="c"){aO.position={left:aO.position.left+(aO.width/2),top:aO.position.top+(aO.height/2)}}else{while(aG>0&&C>0&&aL>0&&aK>0){aG=Math.floor(aG/2);C=Math.floor(C/2);if(aN.x===e){aL=aG}else{if(aN.x===n){aL=aO.width-aG}else{aL+=Math.floor(aG/2)}}if(aN.y===q){aK=C}else{if(aN.y===au){aK=aO.height-C}else{aK+=Math.floor(C/2)}}aI=aM.length;while(aI--){if(aM.length<2){break}aH=aM[aI][0]-aO.position.left;Y=aM[aI][1]-aO.position.top;if((aN.x===e&&aH>=aL)||(aN.x===n&&aH<=aL)||(aN.x===I&&(aH<aL||aH>(aO.width-aL)))||(aN.y===q&&Y>=aK)||(aN.y===au&&Y<=aK)||(aN.y===I&&(Y<aK||Y>(aO.height-aK)))){aM.splice(aI,1)}}}aO.position={left:aM[0][0],top:aM[0][1]}}return aO},rect:function(Y,X,aH,aG,C){return{width:Math.abs(aH-Y),height:Math.abs(aG-X),position:{left:Math.min(Y,aH),top:Math.min(X,aG)}}},_angles:{tc:3/2,tr:7/4,tl:5/4,bc:1/2,br:1/4,bl:3/4,rc:2,lc:1,c:0},ellipse:function(X,aK,aI,aH,aG){var aJ=aF.polys._angles[aG.abbrev()],Y=aI*Math.cos(aJ*Math.PI),C=aH*Math.sin(aJ*Math.PI);return{width:(aI*2)-Math.abs(Y),height:(aH*2)-Math.abs(C),position:{left:X+Y,top:aK+C},adjustable:G}},circle:function(C,aG,Y,X){return aF.polys.ellipse(C,aG,Y,Y,X)}};aF.svg=function(aK,aJ,aM,aG){var aL=at(a),Y=aJ[0],aN={},X,aI,aH,C;while(!Y.getBBox){Y=Y.parentNode}if(!Y.getBBox||!Y.parentNode){return G}switch(Y.nodeName){case"rect":aH=aF.svg.toPixel(Y,Y.x.baseVal.value,Y.y.baseVal.value);C=aF.svg.toPixel(Y,Y.x.baseVal.value+Y.width.baseVal.value,Y.y.baseVal.value+Y.height.baseVal.value);aN=aF.polys.rect(aH[0],aH[1],C[0],C[1],aM);break;case"ellipse":case"circle":aH=aF.svg.toPixel(Y,Y.cx.baseVal.value,Y.cy.baseVal.value);aN=aF.polys.ellipse(aH[0],aH[1],(Y.rx||Y.r).baseVal.value,(Y.ry||Y.r).baseVal.value,aM);break;case"line":case"polygon":case"polyline":points=Y.points||[{x:Y.x1.baseVal.value,y:Y.y1.baseVal.value},{x:Y.x2.baseVal.value,y:Y.y2.baseVal.value}];for(aN=[],i=-1,len=points.numberOfItems||points.length;++i<len;){next=points.getItem?points.getItem(i):points[i];aN.push.apply(aN,aF.svg.toPixel(Y,next.x,next.y))}aN=aF.polys.polygon(aN,aM);break;default:aI=Y.getBBox();mtx=Y.getScreenCTM();root=Y.farthestViewportElement||Y;if(!root.createSVGPoint){return G}point=root.createSVGPoint();point.x=aI.x;point.y=aI.y;tPoint=point.matrixTransform(mtx);aN.position={left:tPoint.x,top:tPoint.y};point.x+=aI.width;point.y+=aI.height;tPoint=point.matrixTransform(mtx);aN.width=tPoint.x-aN.position.left;aN.height=tPoint.y-aN.position.top;break}aN.position.left+=aL.scrollLeft();aN.position.top+=aL.scrollTop();return aN};aF.svg.toPixel=function(aI,Y,aJ){var aH=aI.getScreenCTM(),aG=aI.farthestViewportElement||aI,X,C;if(!aG.createSVGPoint){return G}C=aG.createSVGPoint();C.x=Y;C.y=aJ;X=C.matrixTransform(aH);return[X.x,X.y]};var R,p,u="qtip-modal",al="."+u;p=function(){var aL=this,aJ={},X,Y,aI,C;function aH(aO){if(at.expr[":"].focusable){return at.expr[":"].focusable}var aM=!isNaN(at.attr(aO,"tabindex")),aR=aO.nodeName&&aO.nodeName.toLowerCase(),aQ,aP,aN;if("area"===aR){aQ=aO.parentNode;aP=aQ.name;if(!aO.href||!aP||aQ.nodeName.toLowerCase()!=="map"){return false}aN=at("img[usemap=#"+aP+"]")[0];return !!aN&&aN.is(":visible")}return(/input|select|textarea|button|object/.test(aR)?!aO.disabled:"a"===aR?aO.href||aM:aM)}function aG(aM){if(aJ.length<1&&aM.length){aM.not("body").blur()}else{aJ.first().focus()}}function aK(aN){if(!C.is(":visible")){return}var aP=at(aN.target),aO=X.tooltip,aM=aP.closest(y),aQ;aQ=aM.length<1?G:(parseInt(aM[0].style.zIndex,10)>parseInt(aO[0].style.zIndex,10));if(!aQ&&aP.closest(y)[0]!==aO[0]){aG(aP)}Y=aN.target===aJ[aJ.length-1]}at.extend(aL,{init:function(){C=aL.elem=at("<div />",{id:"qtip-overlay",html:"<div></div>",mousedown:function(){return G}}).hide();function aM(){var aN=at(this);C.css({height:aN.height(),width:aN.width()})}at(b).bind("resize"+al,aM);aM();at(a.body).bind("focusin"+al,aK);at(a).bind("keydown"+al,function(aN){if(X&&X.options.show.modal.escape&&aN.keyCode===27){X.hide(aN)}});C.bind("click"+al,function(aN){if(X&&X.options.show.modal.blur){X.hide(aN)}});return aL},update:function(aM){X=aM;if(aM.options.show.modal.stealfocus!==G){aJ=aM.tooltip.find("*").filter(function(){return aH(this)})}else{aJ=[]}},toggle:function(aR,aM,aO){var aQ=at(a.body),aU=aR.tooltip,aW=aR.options.show.modal,aV=aW.effect,aS=aM?"show":"hide",aN=C.is(":visible"),aP=at(al).filter(":visible:not(:animated)").not(aU),aT;aL.update(aR);if(aM&&aW.stealfocus!==G){aG(at(":focus"))}C.toggleClass("blurs",aW.blur);if(aM){C.css({left:0,top:0}).appendTo(a.body)}if((C.is(":animated")&&aN===aM&&aI!==G)||(!aM&&aP.length)){return aL}C.stop(Q,G);if(at.isFunction(aV)){aV.call(C,aM)}else{if(aV===G){C[aS]()}else{C.fadeTo(parseInt(aO,10)||90,aM?1:0,function(){if(!aM){C.hide()}})}}if(!aM){C.queue(function(aX){C.css({left:"",top:""});if(!at(al).length){C.detach()}aX()})}aI=aM;if(X.destroyed){X=ae}return aL}});aL.init()};p=new p();function aB(X,C){this.options=C;this._ns="-modal";this.init((this.qtip=X))}at.extend(aB.prototype,{init:function(X){var C=X.tooltip;if(!this.options.on){return this}X.elements.overlay=p.elem;C.addClass(u).css("z-index",aF.modal.zindex+at(al).length);X._bind(C,["tooltipshow","tooltiphide"],function(aH,aG,aJ){var Y=aH.originalEvent;if(aH.target===C[0]){if(Y&&aH.type==="tooltiphide"&&/mouse(leave|enter)/.test(Y.type)&&at(Y.relatedTarget).closest(overlay[0]).length){try{aH.preventDefault()}catch(aI){}}else{if(!Y||(Y&&!Y.solo)){this.toggle(aH,aH.type==="tooltipshow",aJ)}}}},this._ns,this);X._bind(C,"tooltipfocus",function(aI,aH){if(aI.isDefaultPrevented()||aI.target!==C[0]){return}var aJ=at(al),aG=aF.modal.zindex+aJ.length,Y=parseInt(C[0].style.zIndex,10);p.elem[0].style.zIndex=aG-1;aJ.each(function(){if(this.style.zIndex>Y){this.style.zIndex-=1}});aJ.filter("."+M).qtip("blur",aI.originalEvent);C.addClass(M)[0].style.zIndex=aG;p.update(aH);try{aI.preventDefault()}catch(aK){}},this._ns,this);X._bind(C,"tooltiphide",function(Y){if(Y.target===C[0]){at(al).filter(":visible").not(C).last().qtip("focus",Y)}},this._ns,this)},toggle:function(C,X,Y){if(C&&C.isDefaultPrevented()){return this}p.toggle(this.qtip,!!X,Y)},destroy:function(){this.qtip.tooltip.removeClass(u);this.qtip._unbind(this.qtip.tooltip,this._ns);p.toggle(this.qtip,G);delete this.qtip.elements.overlay}});R=aF.modal=function(C){return new aB(C,C.options.show.modal)};R.sanitize=function(C){if(C.show){if(typeof C.show.modal!=="object"){C.show.modal={on:!!C.show.modal}}else{if(typeof C.show.modal.on==="undefined"){C.show.modal.on=Q}}}};R.zindex=z.zindex-200;R.initialize="render";h.modal={"^show.modal.(on|blur)$":function(){this.destroy();this.init();this.qtip.elems.overlay.toggle(this.qtip.tooltip[0].offsetWidth>0)}};at.extend(Q,z.defaults,{show:{modal:{on:G,effect:Q,blur:Q,stealfocus:Q,escape:Q}}})}))}(window,document));(function(m){var f="0.4.2",n="hasOwnProperty",b=/[\.\/]/,a="*",h=function(){},g=function(q,p){return q-p},e,l,o={n:{}},c=function(p,F){p=String(p);var y=o,v=l,A=Array.prototype.slice.call(arguments,2),C=c.listeners(p),B=0,x=false,s,r=[],w={},t=[],q=e,D=[];e=p;l=0;for(var u=0,E=C.length;u<E;u++){if("zIndex" in C[u]){r.push(C[u].zIndex);if(C[u].zIndex<0){w[C[u].zIndex]=C[u]}}}r.sort(g);while(r[B]<0){s=w[r[B++]];t.push(s.apply(F,A));if(l){l=v;return t}}for(u=0;u<E;u++){s=C[u];if("zIndex" in s){if(s.zIndex==r[B]){t.push(s.apply(F,A));if(l){break}do{B++;s=w[r[B]];s&&t.push(s.apply(F,A));if(l){break}}while(s)}else{w[s.zIndex]=s}}else{t.push(s.apply(F,A));if(l){break}}}l=v;e=q;return t.length?t:null};c._events=o;c.listeners=function(p){var x=p.split(b),v=o,B,w,q,t,A,s,u,y,z=[v],r=[];for(t=0,A=x.length;t<A;t++){y=[];for(s=0,u=z.length;s<u;s++){v=z[s].n;w=[v[x[t]],v[a]];q=2;while(q--){B=w[q];if(B){y.push(B);r=r.concat(B.f||[])}}}z=y}return r};c.on=function(p,s){p=String(p);if(typeof s!="function"){return function(){}}var u=p.split(b),t=o;for(var q=0,r=u.length;q<r;q++){t=t.n;t=t.hasOwnProperty(u[q])&&t[u[q]]||(t[u[q]]={n:{}})}t.f=t.f||[];for(q=0,r=t.f.length;q<r;q++){if(t.f[q]==s){return h}}t.f.push(s);return function(v){if(+v==+v){s.zIndex=+v}}};c.f=function(q){var p=[].slice.call(arguments,1);return function(){c.apply(null,[q,null].concat(p).concat([].slice.call(arguments,0)))}};c.stop=function(){l=1};c.nt=function(p){if(p){return new RegExp("(?:\\.|\\/|^)"+p+"(?:\\.|\\/|$)").test(e)}return e};c.nts=function(){return e.split(b)};c.off=c.unbind=function(q,v){if(!q){c._events=o={n:{}};return}var x=q.split(b),w,z,r,t,A,s,u,y=[o];for(t=0,A=x.length;t<A;t++){for(s=0;s<y.length;s+=r.length-2){r=[s,1];w=y[s].n;if(x[t]!=a){if(w[x[t]]){r.push(w[x[t]])}}else{for(z in w){if(w[n](z)){r.push(w[z])}}}y.splice.apply(y,r)}}for(t=0,A=y.length;t<A;t++){w=y[t];while(w.n){if(v){if(w.f){for(s=0,u=w.f.length;s<u;s++){if(w.f[s]==v){w.f.splice(s,1);break}}!w.f.length&&delete w.f}for(z in w.n){if(w.n[n](z)&&w.n[z].f){var p=w.n[z].f;for(s=0,u=p.length;s<u;s++){if(p[s]==v){p.splice(s,1);break}}!p.length&&delete w.n[z].f}}}else{delete w.f;for(z in w.n){if(w.n[n](z)&&w.n[z].f){delete w.n[z].f}}}w=w.n}}};c.once=function(p,q){var r=function(){c.unbind(p,r);return q.apply(this,arguments)};return c.on(p,r)};c.version=f;c.toString=function(){return"You are running Eve "+f};(typeof module!="undefined"&&module.exports)?(module.exports=c):(typeof define!="undefined"?(define("eve",[],function(){return c})):(m.eve=c))})(this);(function(){function aT(E){if(aT.is(E,"function")){return aq?E():eve.on("raphael.DOMload",E)}else{if(aT.is(E,bf)){return aT._engine.create[bI](aT,E.splice(0,3+aT.is(E[0],aN))).add(E)}else{var b=Array.prototype.slice.call(arguments,0);if(aT.is(b[b.length-1],"function")){var g=b.pop();return aq?g.call(aT._engine.create[bI](aT,b)):eve.on("raphael.DOMload",function(){g.call(aT._engine.create[bI](aT,b))})}else{return aT._engine.create[bI](aT,arguments)}}}}aT.version="2.1.0";aT.eve=eve;var aq,a=/[, ]+/,by={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},bt=/\{(\d+)\}/g,bL="prototype",am="hasOwnProperty",aC={doc:document,win:window},u={was:Object.prototype[am].call(aC.win,"Raphael"),is:aC.win.Raphael},bH=function(){this.ca=this.customAttributes={}},a6,bq="appendChild",bI="apply",bG="concat",ab="createTouch" in aC.doc,aZ="",aS=" ",bJ=String,H="split",U="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[H](aS),bz={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},bM=bJ.prototype.toLowerCase,aw=Math,o=aw.max,bo=aw.min,ay=aw.abs,br=aw.pow,aX=aw.PI,aN="number",al="string",bf="array",a7="toString",bb="fill",a3=Object.prototype.toString,bB={},l="push",f=aT._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,C=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,ax={"NaN":1,"Infinity":1,"-Infinity":1},c=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,aj=aw.round,B="setAttribute",ap=parseFloat,W=parseInt,bv=bJ.prototype.toUpperCase,t=aT._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},au=aT._availableAnimAttrs={blur:aN,"clip-rect":"csv",cx:aN,cy:aN,fill:"colour","fill-opacity":aN,"font-size":aN,height:aN,opacity:aN,path:"path",r:aN,rx:aN,ry:aN,stroke:"colour","stroke-opacity":aN,"stroke-width":aN,transform:"transform",width:aN,x:aN,y:aN},ae=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]/g,bk=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,p={hs:1,rg:1},bi=/,?([achlmqrstvxz]),?/gi,a2=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,ak=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,aR=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/ig,aY=aT._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,aW={},bs=function(E,g){return E.key-g.key},w=function(E,g){return ap(E)-ap(g)},K=function(){},bD=function(b){return b},aB=aT._rectPath=function(b,S,g,E,R){if(R){return[["M",b+R,S],["l",g-R*2,0],["a",R,R,0,0,1,R,R],["l",0,E-R*2],["a",R,R,0,0,1,-R,R],["l",R*2-g,0],["a",R,R,0,0,1,-R,-R],["l",0,R*2-E],["a",R,R,0,0,1,R,-R],["z"]]}return[["M",b,S],["l",g,0],["l",0,E],["l",-g,0],["z"]]},M=function(b,R,E,g){if(g==null){g=E}return[["M",b,R],["m",0,-g],["a",E,g,0,1,1,0,2*g],["a",E,g,0,1,1,0,-2*g],["z"]]},P=aT._getPath={path:function(b){return b.attr("path")},circle:function(g){var b=g.attrs;return M(b.cx,b.cy,b.r)},ellipse:function(g){var b=g.attrs;return M(b.cx,b.cy,b.rx,b.ry)},rect:function(g){var b=g.attrs;return aB(b.x,b.y,b.width,b.height,b.r)},image:function(g){var b=g.attrs;return aB(b.x,b.y,b.width,b.height)},text:function(b){var g=b._getBBox();return aB(g.x,g.y,g.width,g.height)},set:function(b){var g=b._getBBox();return aB(g.x,g.y,g.width,g.height)}},N=aT.mapPath=function(bQ,bN){if(!bN){return bQ}var bO,S,E,b,bP,R,g;bQ=Y(bQ);for(E=0,bP=bQ.length;E<bP;E++){g=bQ[E];for(b=1,R=g.length;b<R;b+=2){bO=bN.x(g[b],g[b+1]);S=bN.y(g[b],g[b+1]);g[b]=bO;g[b+1]=S}}return bQ};aT._g=aC;aT.type=(aC.win.SVGAngle||aC.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML");if(aT.type=="VML"){var aG=aC.doc.createElement("div"),aJ;aG.innerHTML='<v:shape adj="1"/>';aJ=aG.firstChild;aJ.style.behavior="url(#default#VML)";if(!(aJ&&typeof aJ.adj=="object")){return(aT.type=aZ)}aG=null}aT.svg=!(aT.vml=aT.type=="VML");aT._Paper=bH;aT.fn=a6=bH.prototype=aT.prototype;aT._id=0;aT._oid=0;aT.is=function(g,b){b=bM.call(b);if(b=="finite"){return !ax[am](+g)}if(b=="array"){return g instanceof Array}return(b=="null"&&g===null)||(b==typeof g&&g!==null)||(b=="object"&&g===Object(g))||(b=="array"&&Array.isArray&&Array.isArray(g))||a3.call(g).slice(8,-1).toLowerCase()==b};function Z(E){if(Object(E)!==E){return E}var g=new E.constructor;for(var b in E){if(E[am](b)){g[b]=Z(E[b])}}return g}aT.angle=function(S,bO,E,bN,g,R){if(g==null){var b=S-E,bP=bO-bN;if(!b&&!bP){return 0}return(180+aw.atan2(-bP,-b)*180/aX+360)%360}else{return aT.angle(S,bO,g,R)-aT.angle(E,bN,g,R)}};aT.rad=function(b){return b%360*aX/180};aT.deg=function(b){return b*180/aX%360};aT.snapTo=function(g,R,b){b=aT.is(b,"finite")?b:10;if(aT.is(g,bf)){var E=g.length;while(E--){if(ay(g[E]-R)<=b){return g[E]}}}else{g=+g;var S=R%g;if(S<b){return R-S}if(S>g-b){return R-S+g}}return R};var h=aT.createUUID=(function(b,g){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(b,g).toUpperCase()}})(/[xy]/g,function(E){var g=aw.random()*16|0,b=E=="x"?g:(g&3|8);return b.toString(16)});aT.setWindow=function(b){eve("raphael.setWindow",aT,aC.win,b);aC.win=b;aC.doc=aC.win.document;if(aT._engine.initWin){aT._engine.initWin(aC.win)}};var bh=function(E){if(aT.vml){var b=/^\s+|\s+$/g;var S;try{var bN=new ActiveXObject("htmlfile");bN.write("<body>");bN.close();S=bN.body}catch(bO){S=createPopup().document.body}var g=S.createTextRange();bh=aI(function(bP){try{S.style.color=bJ(bP).replace(b,aZ);var bQ=g.queryCommandValue("ForeColor");bQ=((bQ&255)<<16)|(bQ&65280)|((bQ&16711680)>>>16);return"#"+("000000"+bQ.toString(16)).slice(-6)}catch(bR){return"none"}})}else{var R=aC.doc.createElement("i");R.title="Rapha\xebl Colour Picker";R.style.display="none";aC.doc.body.appendChild(R);bh=aI(function(bP){R.style.color=bP;return aC.doc.defaultView.getComputedStyle(R,aZ).getPropertyValue("color")})}return bh(E)},aK=function(){return"hsb("+[this.h,this.s,this.b]+")"},O=function(){return"hsl("+[this.h,this.s,this.l]+")"},z=function(){return this.hex},a0=function(bN,S,E){if(S==null&&aT.is(bN,"object")&&"r" in bN&&"g" in bN&&"b" in bN){E=bN.b;S=bN.g;bN=bN.r}if(S==null&&aT.is(bN,al)){var R=aT.getRGB(bN);bN=R.r;S=R.g;E=R.b}if(bN>1||S>1||E>1){bN/=255;S/=255;E/=255}return[bN,S,E]},a4=function(bN,S,E,bO){bN*=255;S*=255;E*=255;var R={r:bN,g:S,b:E,hex:aT.rgb(bN,S,E),toString:z};aT.is(bO,"finite")&&(R.opacity=bO);return R};aT.color=function(b){var g;if(aT.is(b,"object")&&"h" in b&&"s" in b&&"b" in b){g=aT.hsb2rgb(b);b.r=g.r;b.g=g.g;b.b=g.b;b.hex=g.hex}else{if(aT.is(b,"object")&&"h" in b&&"s" in b&&"l" in b){g=aT.hsl2rgb(b);b.r=g.r;b.g=g.g;b.b=g.b;b.hex=g.hex}else{if(aT.is(b,"string")){b=aT.getRGB(b)}if(aT.is(b,"object")&&"r" in b&&"g" in b&&"b" in b){g=aT.rgb2hsl(b);b.h=g.h;b.s=g.s;b.l=g.l;g=aT.rgb2hsb(b);b.v=g.b}else{b={hex:"none"};b.r=b.g=b.b=b.h=b.s=b.v=b.l=-1}}}b.toString=z;return b};aT.hsb2rgb=function(bO,bR,bP,S){if(this.is(bO,"object")&&"h" in bO&&"s" in bO&&"b" in bO){bP=bO.b;bR=bO.s;bO=bO.h;S=bO.o}bO*=360;var bN,bQ,g,E,b;bO=(bO%360)/60;b=bP*bR;E=b*(1-ay(bO%2-1));bN=bQ=g=bP-b;bO=~~bO;bN+=[b,E,0,0,E,b][bO];bQ+=[E,b,b,E,0,0][bO];g+=[0,0,E,b,b,E][bO];return a4(bN,bQ,g,S)};aT.hsl2rgb=function(bP,bR,bN,S){if(this.is(bP,"object")&&"h" in bP&&"s" in bP&&"l" in bP){bN=bP.l;bR=bP.s;bP=bP.h}if(bP>1||bR>1||bN>1){bP/=360;bR/=100;bN/=100}bP*=360;var bO,bQ,g,E,b;bP=(bP%360)/60;b=2*bR*(bN<0.5?bN:1-bN);E=b*(1-ay(bP%2-1));bO=bQ=g=bN-b/2;bP=~~bP;bO+=[b,E,0,0,E,b][bP];bQ+=[E,b,b,E,0,0][bP];g+=[0,0,E,b,b,E][bP];return a4(bO,bQ,g,S)};aT.rgb2hsb=function(bQ,bP,E){E=a0(bQ,bP,E);bQ=E[0];bP=E[1];E=E[2];var bO,bN,R,bR;R=o(bQ,bP,E);bR=R-bo(bQ,bP,E);bO=(bR==0?null:R==bQ?(bP-E)/bR:R==bP?(E-bQ)/bR+2:(bQ-bP)/bR+4);bO=((bO+360)%6)*60/360;bN=bR==0?0:bR/R;return{h:bO,s:bN,b:R,toString:aK}};aT.rgb2hsl=function(E,bP,bS){bS=a0(E,bP,bS);E=bS[0];bP=bS[1];bS=bS[2];var bT,bO,bR,bQ,bN,R;bQ=o(E,bP,bS);bN=bo(E,bP,bS);R=bQ-bN;bT=(R==0?null:bQ==E?(bP-bS)/R:bQ==bP?(bS-E)/R+2:(E-bP)/R+4);bT=((bT+360)%6)*60/360;bR=(bQ+bN)/2;bO=(R==0?0:bR<0.5?R/(2*bR):R/(2-2*bR));return{h:bT,s:bO,l:bR,toString:O}};aT._path2string=function(){return this.join(",").replace(bi,"$1")};function bm(R,E){for(var b=0,g=R.length;b<g;b++){if(R[b]===E){return R.push(R.splice(b,1)[0])}}}function aI(R,g,b){function E(){var S=Array.prototype.slice.call(arguments,0),bO=S.join("\u2400"),bN=E.cache=E.cache||{},bP=E.count=E.count||[];if(bN[am](bO)){bm(bP,bO);return b?b(bN[bO]):bN[bO]}bP.length>=1000&&delete bN[bP.shift()];bP.push(bO);bN[bO]=R[bI](g,S);return b?b(bN[bO]):bN[bO]}return E}var bx=aT._preload=function(E,g){var b=aC.doc.createElement("img");b.style.cssText="position:absolute;left:-9999em;top:-9999em";b.onload=function(){g.call(this);this.onload=null;aC.doc.body.removeChild(this)};b.onerror=function(){aC.doc.body.removeChild(this)};aC.doc.body.appendChild(b);b.src=E};function at(){return this.hex}aT.getRGB=aI(function(b){if(!b||!!((b=bJ(b)).indexOf("-")+1)){return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:at}}if(b=="none"){return{r:-1,g:-1,b:-1,hex:"none",toString:at}}!(p[am](b.toLowerCase().substring(0,2))||b.charAt()=="#")&&(b=bh(b));var S,g,E,bO,R,bQ,bP,bN=b.match(C);if(bN){if(bN[2]){bO=W(bN[2].substring(5),16);E=W(bN[2].substring(3,5),16);g=W(bN[2].substring(1,3),16)}if(bN[3]){bO=W((bQ=bN[3].charAt(3))+bQ,16);E=W((bQ=bN[3].charAt(2))+bQ,16);g=W((bQ=bN[3].charAt(1))+bQ,16)}if(bN[4]){bP=bN[4][H](bk);g=ap(bP[0]);bP[0].slice(-1)=="%"&&(g*=2.55);E=ap(bP[1]);bP[1].slice(-1)=="%"&&(E*=2.55);bO=ap(bP[2]);bP[2].slice(-1)=="%"&&(bO*=2.55);bN[1].toLowerCase().slice(0,4)=="rgba"&&(R=ap(bP[3]));bP[3]&&bP[3].slice(-1)=="%"&&(R/=100)}if(bN[5]){bP=bN[5][H](bk);g=ap(bP[0]);bP[0].slice(-1)=="%"&&(g*=2.55);E=ap(bP[1]);bP[1].slice(-1)=="%"&&(E*=2.55);bO=ap(bP[2]);bP[2].slice(-1)=="%"&&(bO*=2.55);(bP[0].slice(-3)=="deg"||bP[0].slice(-1)=="\xb0")&&(g/=360);bN[1].toLowerCase().slice(0,4)=="hsba"&&(R=ap(bP[3]));bP[3]&&bP[3].slice(-1)=="%"&&(R/=100);return aT.hsb2rgb(g,E,bO,R)}if(bN[6]){bP=bN[6][H](bk);g=ap(bP[0]);bP[0].slice(-1)=="%"&&(g*=2.55);E=ap(bP[1]);bP[1].slice(-1)=="%"&&(E*=2.55);bO=ap(bP[2]);bP[2].slice(-1)=="%"&&(bO*=2.55);(bP[0].slice(-3)=="deg"||bP[0].slice(-1)=="\xb0")&&(g/=360);bN[1].toLowerCase().slice(0,4)=="hsla"&&(R=ap(bP[3]));bP[3]&&bP[3].slice(-1)=="%"&&(R/=100);return aT.hsl2rgb(g,E,bO,R)}bN={r:g,g:E,b:bO,toString:at};bN.hex="#"+(16777216|bO|(E<<8)|(g<<16)).toString(16).slice(1);aT.is(R,"finite")&&(bN.opacity=R);return bN}return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:at}},aT);aT.hsb=aI(function(R,E,g){return aT.hsb2rgb(R,E,g).hex});aT.hsl=aI(function(E,g,b){return aT.hsl2rgb(E,g,b).hex});aT.rgb=aI(function(S,R,E){return"#"+(16777216|E|(R<<8)|(S<<16)).toString(16).slice(1)});aT.getColor=function(g){var E=this.getColor.start=this.getColor.start||{h:0,s:1,b:g||0.75},b=this.hsb2rgb(E.h,E.s,E.b);E.h+=0.075;if(E.h>1){E.h=0;E.s-=0.2;E.s<=0&&(this.getColor.start={h:0,s:1,b:E.b})}return b.hex};aT.getColor.reset=function(){delete this.start};function bd(E,bN){var S=[];for(var g=0,b=E.length;b-2*!bN>g;g+=2){var R=[{x:+E[g-2],y:+E[g-1]},{x:+E[g],y:+E[g+1]},{x:+E[g+2],y:+E[g+3]},{x:+E[g+4],y:+E[g+5]}];if(bN){if(!g){R[0]={x:+E[b-2],y:+E[b-1]}}else{if(b-4==g){R[3]={x:+E[0],y:+E[1]}}else{if(b-2==g){R[2]={x:+E[0],y:+E[1]};R[3]={x:+E[2],y:+E[3]}}}}}else{if(b-4==g){R[3]=R[2]}else{if(!g){R[0]={x:+E[g],y:+E[g+1]}}}}S.push(["C",(-R[0].x+6*R[1].x+R[2].x)/6,(-R[0].y+6*R[1].y+R[2].y)/6,(R[1].x+6*R[2].x-R[3].x)/6,(R[1].y+6*R[2].y-R[3].y)/6,R[2].x,R[2].y])}return S}aT.parsePathString=function(b){if(!b){return null}var E=aa(b);if(E.arr){return a1(E.arr)}var R={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},g=[];if(aT.is(b,bf)&&aT.is(b[0],bf)){g=a1(b)}if(!g.length){bJ(b).replace(a2,function(bN,S,bQ){var bP=[],bO=S.toLowerCase();bQ.replace(aR,function(bS,bR){bR&&bP.push(+bR)});if(bO=="m"&&bP.length>2){g.push([S][bG](bP.splice(0,2)));bO="l";S=S=="m"?"l":"L"}if(bO=="r"){g.push([S][bG](bP))}else{while(bP.length>=R[bO]){g.push([S][bG](bP.splice(0,R[bO])));if(!R[bO]){break}}}})}g.toString=aT._path2string;E.arr=a1(g);return g};aT.parseTransformString=aI(function(g){if(!g){return null}var E={r:3,s:4,t:2,m:6},b=[];if(aT.is(g,bf)&&aT.is(g[0],bf)){b=a1(g)}if(!b.length){bJ(g).replace(ak,function(S,R,bP){var bO=[],bN=bM.call(R);bP.replace(aR,function(bR,bQ){bQ&&bO.push(+bQ)});b.push([R][bG](bO))})}b.toString=aT._path2string;return b});var aa=function(g){var b=aa.ps=aa.ps||{};if(b[g]){b[g].sleep=100}else{b[g]={sleep:100}}setTimeout(function(){for(var E in b){if(b[am](E)&&E!=g){b[E].sleep--;!b[E].sleep&&delete b[E]}}});return b[g]};aT.findDotsAtSegment=function(g,b,b6,b4,bO,S,bR,bP,bZ){var bW=1-bZ,b1=br(bW,3),b2=br(bW,2),bT=bZ*bZ,bQ=bT*bZ,bV=b1*g+b2*3*bZ*b6+bW*3*bZ*bZ*bO+bQ*bR,bS=b1*b+b2*3*bZ*b4+bW*3*bZ*bZ*S+bQ*bP,b0=g+2*bZ*(b6-g)+bT*(bO-2*b6+g),bY=b+2*bZ*(b4-b)+bT*(S-2*b4+b),b5=b6+2*bZ*(bO-b6)+bT*(bR-2*bO+b6),b3=b4+2*bZ*(S-b4)+bT*(bP-2*S+b4),bX=bW*g+bZ*b6,bU=bW*b+bZ*b4,R=bW*bO+bZ*bR,E=bW*S+bZ*bP,bN=(90-aw.atan2(b0-b5,bY-b3)*180/aX);(b0>b5||bY<b3)&&(bN+=180);return{x:bV,y:bS,m:{x:b0,y:bY},n:{x:b5,y:b3},start:{x:bX,y:bU},end:{x:R,y:E},alpha:bN}};aT.bezierBBox=function(g,b,R,E,bQ,bO,bN,S){if(!aT.is(g,"array")){g=[g,b,R,E,bQ,bO,bN,S]}var bP=bc.apply(null,g);return{x:bP.min.x,y:bP.min.y,x2:bP.max.x,y2:bP.max.y,width:bP.max.x-bP.min.x,height:bP.max.y-bP.min.y}};aT.isPointInsideBBox=function(g,b,E){return b>=g.x&&b<=g.x2&&E>=g.y&&E<=g.y2};aT.isBBoxIntersect=function(E,g){var b=aT.isPointInsideBBox;return b(g,E.x,E.y)||b(g,E.x2,E.y)||b(g,E.x,E.y2)||b(g,E.x2,E.y2)||b(E,g.x,g.y)||b(E,g.x2,g.y)||b(E,g.x,g.y2)||b(E,g.x2,g.y2)||(E.x<g.x2&&E.x>g.x||g.x<E.x2&&g.x>E.x)&&(E.y<g.y2&&E.y>g.y||g.y<E.y2&&g.y>E.y)};function bl(b,bO,bN,S,R){var E=-3*bO+9*bN-9*S+3*R,g=b*E+6*bO-12*bN+6*S;return b*g-3*bO+3*bN}function s(bZ,S,bY,E,bX,g,bU,b,bR){if(bR==null){bR=1}bR=bR>1?1:bR<0?0:bR;var bS=bR/2,bT=12,bO=[-0.1252,0.1252,-0.3678,0.3678,-0.5873,0.5873,-0.7699,0.7699,-0.9041,0.9041,-0.9816,0.9816],bW=[0.2491,0.2491,0.2335,0.2335,0.2032,0.2032,0.1601,0.1601,0.1069,0.1069,0.0472,0.0472],R=0;for(var bV=0;bV<bT;bV++){var bP=bS*bO[bV]+bS,bQ=bl(bP,bZ,bY,bX,bU),b0=bl(bP,S,E,g,b),bN=bQ*bQ+b0*b0;R+=bW[bV]*aw.sqrt(bN)}return bS*R}function F(E,bT,g,bS,b,bQ,bV,bP,bR){if(bR<0||s(E,bT,g,bS,b,bQ,bV,bP)<bR){return}var bU=1,R=bU/2,bN=bU-R,S,bO=0.01;S=s(E,bT,g,bS,b,bQ,bV,bP,bN);while(ay(S-bR)>bO){R/=2;bN+=(S<bR?1:-1)*R;S=s(E,bT,g,bS,b,bQ,bV,bP,bN)}return bN}function Q(R,bU,E,bS,b,bR,bW,bQ){if(o(R,E)<bo(b,bW)||bo(R,E)>o(b,bW)||o(bU,bS)<bo(bR,bQ)||bo(bU,bS)>o(bR,bQ)){return}var bP=(R*bS-bU*E)*(b-bW)-(R-E)*(b*bQ-bR*bW),bO=(R*bS-bU*E)*(bR-bQ)-(bU-bS)*(b*bQ-bR*bW),S=(R-E)*(bR-bQ)-(bU-bS)*(b-bW);if(!S){return}var bV=bP/S,bT=bO/S,bN=+bV.toFixed(2),g=+bT.toFixed(2);if(bN<+bo(R,E).toFixed(2)||bN>+o(R,E).toFixed(2)||bN<+bo(b,bW).toFixed(2)||bN>+o(b,bW).toFixed(2)||g<+bo(bU,bS).toFixed(2)||g>+o(bU,bS).toFixed(2)||g<+bo(bR,bQ).toFixed(2)||g>+o(bR,bQ).toFixed(2)){return}return{x:bV,y:bT}}function aA(g,b){return ah(g,b)}function v(g,b){return ah(g,b,1)}function ah(b5,b4,b3){var R=aT.bezierBBox(b5),g=aT.bezierBBox(b4);if(!aT.isBBoxIntersect(R,g)){return b3?0:[]}var bY=s.apply(0,b5),bX=s.apply(0,b4),bP=~~(bY/5),bO=~~(bX/5),bV=[],bU=[],E={},b6=b3?0:[];for(var b0=0;b0<bP+1;b0++){var bW=aT.findDotsAtSegment.apply(aT,b5.concat(b0/bP));bV.push({x:bW.x,y:bW.y,t:b0/bP})}for(b0=0;b0<bO+1;b0++){bW=aT.findDotsAtSegment.apply(aT,b4.concat(b0/bO));bU.push({x:bW.x,y:bW.y,t:b0/bO})}for(b0=0;b0<bP;b0++){for(var bZ=0;bZ<bO;bZ++){var b2=bV[b0],b=bV[b0+1],b1=bU[bZ],bN=bU[bZ+1],bT=ay(b.x-b2.x)<0.001?"y":"x",bS=ay(bN.x-b1.x)<0.001?"y":"x",S=Q(b2.x,b2.y,b.x,b.y,b1.x,b1.y,bN.x,bN.y);if(S){if(E[S.x.toFixed(4)]==S.y.toFixed(4)){continue}E[S.x.toFixed(4)]=S.y.toFixed(4);var bR=b2.t+ay((S[bT]-b2[bT])/(b[bT]-b2[bT]))*(b.t-b2.t),bQ=b1.t+ay((S[bS]-b1[bS])/(bN[bS]-b1[bS]))*(bN.t-b1.t);if(bR>=0&&bR<=1&&bQ>=0&&bQ<=1){if(b3){b6++}else{b6.push({x:S.x,y:S.y,t1:bR,t2:bQ})}}}}}return b6}aT.pathIntersection=function(g,b){return G(g,b)};aT.pathIntersectionNumber=function(g,b){return G(g,b,1)};function G(E,b,bZ){E=aT._path2curve(E);b=aT._path2curve(b);var bX,bN,bW,R,bU,bO,g,bR,b3,b2,b4=bZ?0:[];for(var bV=0,bP=E.length;bV<bP;bV++){var b1=E[bV];if(b1[0]=="M"){bX=bU=b1[1];bN=bO=b1[2]}else{if(b1[0]=="C"){b3=[bX,bN].concat(b1.slice(1));bX=b3[6];bN=b3[7]}else{b3=[bX,bN,bX,bN,bU,bO,bU,bO];bX=bU;bN=bO}for(var bT=0,bY=b.length;bT<bY;bT++){var b0=b[bT];if(b0[0]=="M"){bW=g=b0[1];R=bR=b0[2]}else{if(b0[0]=="C"){b2=[bW,R].concat(b0.slice(1));bW=b2[6];R=b2[7]}else{b2=[bW,R,bW,R,g,bR,g,bR];bW=g;R=bR}var bQ=ah(b3,b2,bZ);if(bZ){b4+=bQ}else{for(var bS=0,S=bQ.length;bS<S;bS++){bQ[bS].segment1=bV;bQ[bS].segment2=bT;bQ[bS].bez1=b3;bQ[bS].bez2=b2}b4=b4.concat(bQ)}}}}}return b4}aT.isPointInsidePath=function(g,b,R){var E=aT.pathBBox(g);return aT.isPointInsideBBox(E,b,R)&&G(g,[["M",b,R],["H",E.x2+10]],1)%2==1};aT._removedFactory=function(b){return function(){eve("raphael.log",null,"Rapha\xebl: you are calling to method \u201c"+b+"\u201d of removed object",b)}};var ao=aT.pathBBox=function(bW){var bQ=aa(bW);if(bQ.bbox){return Z(bQ.bbox)}if(!bW){return{x:0,y:0,width:0,height:0,x2:0,y2:0}}bW=Y(bW);var bT=0,bS=0,S=[],g=[],E;for(var bO=0,bV=bW.length;bO<bV;bO++){E=bW[bO];if(E[0]=="M"){bT=E[1];bS=E[2];S.push(bT);g.push(bS)}else{var bP=bc(bT,bS,E[1],E[2],E[3],E[4],E[5],E[6]);S=S[bG](bP.min.x,bP.max.x);g=g[bG](bP.min.y,bP.max.y);bT=E[5];bS=E[6]}}var b=bo[bI](0,S),bU=bo[bI](0,g),bN=o[bI](0,S),R=o[bI](0,g),bR={x:b,y:bU,x2:bN,y2:R,width:bN-b,height:R-bU};bQ.bbox=Z(bR);return bR},a1=function(g){var b=Z(g);b.toString=aT._path2string;return b},aE=aT._pathToRelative=function(R){var bP=aa(R);if(bP.rel){return a1(bP.rel)}if(!aT.is(R,bf)||!aT.is(R&&R[0],bf)){R=aT.parsePathString(R)}var bS=[],bU=0,bT=0,bX=0,bW=0,E=0;if(R[0][0]=="M"){bU=R[0][1];bT=R[0][2];bX=bU;bW=bT;E++;bS.push(["M",bU,bT])}for(var bO=E,bY=R.length;bO<bY;bO++){var b=bS[bO]=[],bV=R[bO];if(bV[0]!=bM.call(bV[0])){b[0]=bM.call(bV[0]);switch(b[0]){case"a":b[1]=bV[1];b[2]=bV[2];b[3]=bV[3];b[4]=bV[4];b[5]=bV[5];b[6]=+(bV[6]-bU).toFixed(3);b[7]=+(bV[7]-bT).toFixed(3);break;case"v":b[1]=+(bV[1]-bT).toFixed(3);break;case"m":bX=bV[1];bW=bV[2];default:for(var bN=1,bQ=bV.length;bN<bQ;bN++){b[bN]=+(bV[bN]-((bN%2)?bU:bT)).toFixed(3)}}}else{b=bS[bO]=[];if(bV[0]=="m"){bX=bV[1]+bU;bW=bV[2]+bT}for(var S=0,g=bV.length;S<g;S++){bS[bO][S]=bV[S]}}var bR=bS[bO].length;switch(bS[bO][0]){case"z":bU=bX;bT=bW;break;case"h":bU+=+bS[bO][bR-1];break;case"v":bT+=+bS[bO][bR-1];break;default:bU+=+bS[bO][bR-2];bT+=+bS[bO][bR-1]}}bS.toString=aT._path2string;bP.rel=a1(bS);return bS},y=aT._pathToAbsolute=function(bT){var E=aa(bT);if(E.abs){return a1(E.abs)}if(!aT.is(bT,bf)||!aT.is(bT&&bT[0],bf)){bT=aT.parsePathString(bT)}if(!bT||!bT.length){return[["M",0,0]]}var bZ=[],bO=0,bN=0,bR=0,bQ=0,R=0;if(bT[0][0]=="M"){bO=+bT[0][1];bN=+bT[0][2];bR=bO;bQ=bN;R++;bZ[0]=["M",bO,bN]}var bY=bT.length==3&&bT[0][0]=="M"&&bT[1][0].toUpperCase()=="R"&&bT[2][0].toUpperCase()=="Z";for(var bS,b,bW=R,bP=bT.length;bW<bP;bW++){bZ.push(bS=[]);b=bT[bW];if(b[0]!=bv.call(b[0])){bS[0]=bv.call(b[0]);switch(bS[0]){case"A":bS[1]=b[1];bS[2]=b[2];bS[3]=b[3];bS[4]=b[4];bS[5]=b[5];bS[6]=+(b[6]+bO);bS[7]=+(b[7]+bN);break;case"V":bS[1]=+b[1]+bN;break;case"H":bS[1]=+b[1]+bO;break;case"R":var S=[bO,bN][bG](b.slice(1));for(var bV=2,bX=S.length;bV<bX;bV++){S[bV]=+S[bV]+bO;S[++bV]=+S[bV]+bN}bZ.pop();bZ=bZ[bG](bd(S,bY));break;case"M":bR=+b[1]+bO;bQ=+b[2]+bN;default:for(bV=1,bX=b.length;bV<bX;bV++){bS[bV]=+b[bV]+((bV%2)?bO:bN)}}}else{if(b[0]=="R"){S=[bO,bN][bG](b.slice(1));bZ.pop();bZ=bZ[bG](bd(S,bY));bS=["R"][bG](b.slice(-2))}else{for(var bU=0,g=b.length;bU<g;bU++){bS[bU]=b[bU]}}}switch(bS[0]){case"Z":bO=bR;bN=bQ;break;case"H":bO=bS[1];break;case"V":bN=bS[1];break;case"M":bR=bS[bS.length-2];bQ=bS[bS.length-1];default:bO=bS[bS.length-2];bN=bS[bS.length-1]}}bZ.toString=aT._path2string;E.abs=a1(bZ);return bZ},bK=function(g,R,b,E){return[g,R,b,E,b,E]},bp=function(g,R,bO,S,b,E){var bN=1/3,bP=2/3;return[bN*g+bP*bO,bN*R+bP*S,bN*b+bP*bO,bN*E+bP*S,b,E]},ag=function(bV,cq,b4,b2,bW,bQ,R,bU,cp,bX){var b1=aX*120/180,b=aX/180*(+bW||0),b8=[],b5,cm=aI(function(cs,cv,cr){var cu=cs*aw.cos(cr)-cv*aw.sin(cr),ct=cs*aw.sin(cr)+cv*aw.cos(cr);return{x:cu,y:ct}});if(!bX){b5=cm(bV,cq,-b);bV=b5.x;cq=b5.y;b5=cm(bU,cp,-b);bU=b5.x;cp=b5.y;var g=aw.cos(aX/180*bW),bS=aw.sin(aX/180*bW),ca=(bV-bU)/2,b9=(cq-cp)/2;var ck=(ca*ca)/(b4*b4)+(b9*b9)/(b2*b2);if(ck>1){ck=aw.sqrt(ck);b4=ck*b4;b2=ck*b2}var E=b4*b4,cd=b2*b2,cf=(bQ==R?-1:1)*aw.sqrt(ay((E*cd-E*b9*b9-cd*ca*ca)/(E*b9*b9+cd*ca*ca))),bZ=cf*b4*b9/b2+(bV+bU)/2,bY=cf*-b2*ca/b4+(cq+cp)/2,bP=aw.asin(((cq-bY)/b2).toFixed(9)),bO=aw.asin(((cp-bY)/b2).toFixed(9));bP=bV<bZ?aX-bP:bP;bO=bU<bZ?aX-bO:bO;bP<0&&(bP=aX*2+bP);bO<0&&(bO=aX*2+bO);if(R&&bP>bO){bP=bP-aX*2}if(!R&&bO>bP){bO=bO-aX*2}}else{bP=bX[0];bO=bX[1];bZ=bX[2];bY=bX[3]}var bT=bO-bP;if(ay(bT)>b1){var b0=bO,b3=bU,bR=cp;bO=bP+b1*(R&&bO>bP?1:-1);bU=bZ+b4*aw.cos(bO);cp=bY+b2*aw.sin(bO);b8=ag(bU,cp,b4,b2,bW,0,R,b3,bR,[bO,b0,bZ,bY])}bT=bO-bP;var bN=aw.cos(bP),co=aw.sin(bP),S=aw.cos(bO),cn=aw.sin(bO),cb=aw.tan(bT/4),ce=4/3*b4*cb,cc=4/3*b2*cb,cl=[bV,cq],cj=[bV+ce*co,cq-cc*bN],ci=[bU+ce*cn,cp-cc*S],cg=[bU,cp];cj[0]=2*cl[0]-cj[0];cj[1]=2*cl[1]-cj[1];if(bX){return[cj,ci,cg][bG](b8)}else{b8=[cj,ci,cg][bG](b8).join()[H](",");var b6=[];for(var ch=0,b7=b8.length;ch<b7;ch++){b6[ch]=ch%2?cm(b8[ch-1],b8[ch],b).y:cm(b8[ch],b8[ch+1],b).x}return b6}},ai=function(g,b,R,E,bQ,bP,bO,bN,bR){var S=1-bR;return{x:br(S,3)*g+br(S,2)*3*bR*R+S*3*bR*bR*bQ+br(bR,3)*bO,y:br(S,3)*b+br(S,2)*3*bR*E+S*3*bR*bR*bP+br(bR,3)*bN}},bc=aI(function(R,g,bN,S,bY,bX,bU,bR){var bW=(bY-2*bN+R)-(bU-2*bY+bN),bT=2*(bN-R)-2*(bY-bN),bQ=R-bN,bP=(-bT+aw.sqrt(bT*bT-4*bW*bQ))/2/bW,bO=(-bT-aw.sqrt(bT*bT-4*bW*bQ))/2/bW,bS=[g,bR],bV=[R,bU],E;ay(bP)>"1e12"&&(bP=0.5);ay(bO)>"1e12"&&(bO=0.5);if(bP>0&&bP<1){E=ai(R,g,bN,S,bY,bX,bU,bR,bP);bV.push(E.x);bS.push(E.y)}if(bO>0&&bO<1){E=ai(R,g,bN,S,bY,bX,bU,bR,bO);bV.push(E.x);bS.push(E.y)}bW=(bX-2*S+g)-(bR-2*bX+S);bT=2*(S-g)-2*(bX-S);bQ=g-S;bP=(-bT+aw.sqrt(bT*bT-4*bW*bQ))/2/bW;bO=(-bT-aw.sqrt(bT*bT-4*bW*bQ))/2/bW;ay(bP)>"1e12"&&(bP=0.5);ay(bO)>"1e12"&&(bO=0.5);if(bP>0&&bP<1){E=ai(R,g,bN,S,bY,bX,bU,bR,bP);bV.push(E.x);bS.push(E.y)}if(bO>0&&bO<1){E=ai(R,g,bN,S,bY,bX,bU,bR,bO);bV.push(E.x);bS.push(E.y)}return{min:{x:bo[bI](0,bV),y:bo[bI](0,bS)},max:{x:o[bI](0,bV),y:o[bI](0,bS)}}}),Y=aT._path2curve=aI(function(bX,bS){var bQ=!bS&&aa(bX);if(!bS&&bQ.curve){return a1(bQ.curve)}var R=y(bX),bT=bS&&y(bS),bU={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},g={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},bN=function(bZ,b0){var bY,b1;if(!bZ){return["C",b0.x,b0.y,b0.x,b0.y,b0.x,b0.y]}!(bZ[0] in {T:1,Q:1})&&(b0.qx=b0.qy=null);switch(bZ[0]){case"M":b0.X=bZ[1];b0.Y=bZ[2];break;case"A":bZ=["C"][bG](ag[bI](0,[b0.x,b0.y][bG](bZ.slice(1))));break;case"S":bY=b0.x+(b0.x-(b0.bx||b0.x));b1=b0.y+(b0.y-(b0.by||b0.y));bZ=["C",bY,b1][bG](bZ.slice(1));break;case"T":b0.qx=b0.x+(b0.x-(b0.qx||b0.x));b0.qy=b0.y+(b0.y-(b0.qy||b0.y));bZ=["C"][bG](bp(b0.x,b0.y,b0.qx,b0.qy,bZ[1],bZ[2]));break;case"Q":b0.qx=bZ[1];b0.qy=bZ[2];bZ=["C"][bG](bp(b0.x,b0.y,bZ[1],bZ[2],bZ[3],bZ[4]));break;case"L":bZ=["C"][bG](bK(b0.x,b0.y,bZ[1],bZ[2]));break;case"H":bZ=["C"][bG](bK(b0.x,b0.y,bZ[1],b0.y));break;case"V":bZ=["C"][bG](bK(b0.x,b0.y,b0.x,bZ[1]));break;case"Z":bZ=["C"][bG](bK(b0.x,b0.y,b0.X,b0.Y));break}return bZ},b=function(bY,bZ){if(bY[bZ].length>7){bY[bZ].shift();var b0=bY[bZ];while(b0.length){bY.splice(bZ++,0,["C"][bG](b0.splice(0,6)))}bY.splice(bZ,1);bV=o(R.length,bT&&bT.length||0)}},E=function(b2,b1,bZ,bY,b0){if(b2&&b1&&b2[b0][0]=="M"&&b1[b0][0]!="M"){b1.splice(b0,0,["M",bY.x,bY.y]);bZ.bx=0;bZ.by=0;bZ.x=b2[b0][1];bZ.y=b2[b0][2];bV=o(R.length,bT&&bT.length||0)}};for(var bP=0,bV=o(R.length,bT&&bT.length||0);bP<bV;bP++){R[bP]=bN(R[bP],bU);b(R,bP);bT&&(bT[bP]=bN(bT[bP],g));bT&&b(bT,bP);E(R,bT,bU,g,bP);E(bT,R,g,bU,bP);var bO=R[bP],bW=bT&&bT[bP],S=bO.length,bR=bT&&bW.length;bU.x=bO[S-2];bU.y=bO[S-1];bU.bx=ap(bO[S-4])||bU.x;bU.by=ap(bO[S-3])||bU.y;g.bx=bT&&(ap(bW[bR-4])||g.x);g.by=bT&&(ap(bW[bR-3])||g.y);g.x=bT&&bW[bR-2];g.y=bT&&bW[bR-1]}if(!bT){bQ.curve=a1(R)}return bT?[R,bT]:R},null,a1),x=aT._parseDots=aI(function(bQ){var bP=[];for(var S=0,bR=bQ.length;S<bR;S++){var b={},bO=bQ[S].match(/^([^:]*):?([\d\.]*)/);b.color=aT.getRGB(bO[1]);if(b.color.error){return null}b.color=b.color.hex;bO[2]&&(b.offset=bO[2]+"%");bP.push(b)}for(S=1,bR=bP.length-1;S<bR;S++){if(!bP[S].offset){var g=ap(bP[S-1].offset||0),E=0;for(var R=S+1;R<bR;R++){if(bP[R].offset){E=bP[R].offset;break}}if(!E){E=100;R=bR}E=ap(E);var bN=(E-g)/(R-S+1);for(;S<R;S++){g+=bN;bP[S].offset=g+"%"}}}return bP}),aM=aT._tear=function(b,g){b==g.top&&(g.top=b.prev);b==g.bottom&&(g.bottom=b.next);b.next&&(b.next.prev=b.prev);b.prev&&(b.prev.next=b.next)},ar=aT._tofront=function(b,g){if(g.top===b){return}aM(b,g);b.next=null;b.prev=g.top;g.top.next=b;g.top=b},r=aT._toback=function(b,g){if(g.bottom===b){return}aM(b,g);b.next=g.bottom;b.prev=null;g.bottom.prev=b;g.bottom=b},I=aT._insertafter=function(g,b,E){aM(g,E);b==E.top&&(E.top=g);b.next&&(b.next.prev=g);g.next=b.next;g.prev=b;b.next=g},aV=aT._insertbefore=function(g,b,E){aM(g,E);b==E.bottom&&(E.bottom=g);b.prev&&(b.prev.next=g);g.prev=b.prev;b.prev=g;g.next=b},bn=aT.toMatrix=function(E,b){var R=ao(E),g={_:{transform:aZ},getBBox:function(){return R}};aQ(g,b);return g.matrix},V=aT.transformPath=function(g,b){return N(g,bn(g,b))},aQ=aT._extractTransform=function(g,b2){if(b2==null){return g._.transform}b2=bJ(b2).replace(/\.{3}|\u2026/g,g._.transform||aZ);var bU=aT.parseTransformString(b2),bS=0,bQ=0,bP=0,bW=1,bV=1,b3=g._,bX=new aH;b3.transform=bU||[];if(bU){for(var bY=0,bR=bU.length;bY<bR;bY++){var bT=bU[bY],b=bT.length,S=bJ(bT[0]).toLowerCase(),b1=bT[0]!=S,bO=b1?bX.invert():0,b0,R,bZ,E,bN;if(S=="t"&&b==3){if(b1){b0=bO.x(0,0);R=bO.y(0,0);bZ=bO.x(bT[1],bT[2]);E=bO.y(bT[1],bT[2]);bX.translate(bZ-b0,E-R)}else{bX.translate(bT[1],bT[2])}}else{if(S=="r"){if(b==2){bN=bN||g.getBBox(1);bX.rotate(bT[1],bN.x+bN.width/2,bN.y+bN.height/2);bS+=bT[1]}else{if(b==4){if(b1){bZ=bO.x(bT[2],bT[3]);E=bO.y(bT[2],bT[3]);bX.rotate(bT[1],bZ,E)}else{bX.rotate(bT[1],bT[2],bT[3])}bS+=bT[1]}}}else{if(S=="s"){if(b==2||b==3){bN=bN||g.getBBox(1);bX.scale(bT[1],bT[b-1],bN.x+bN.width/2,bN.y+bN.height/2);bW*=bT[1];bV*=bT[b-1]}else{if(b==5){if(b1){bZ=bO.x(bT[3],bT[4]);E=bO.y(bT[3],bT[4]);bX.scale(bT[1],bT[2],bZ,E)}else{bX.scale(bT[1],bT[2],bT[3],bT[4])}bW*=bT[1];bV*=bT[2]}}}else{if(S=="m"&&b==7){bX.add(bT[1],bT[2],bT[3],bT[4],bT[5],bT[6])}}}}b3.dirtyT=1;g.matrix=bX}}g.matrix=bX;b3.sx=bW;b3.sy=bV;b3.deg=bS;b3.dx=bQ=bX.e;b3.dy=bP=bX.f;if(bW==1&&bV==1&&!bS&&b3.bbox){b3.bbox.x+=+bQ;b3.bbox.y+=+bP}else{b3.dirtyT=1}},n=function(g){var b=g[0];switch(b.toLowerCase()){case"t":return[b,0,0];case"m":return[b,1,0,0,1,0,0];case"r":if(g.length==4){return[b,0,g[2],g[3]]}else{return[b,0]}case"s":if(g.length==5){return[b,1,1,g[3],g[4]]}else{if(g.length==3){return[b,1,1]}else{return[b,1]}}}},aD=aT._equaliseTransform=function(S,R){R=bJ(R).replace(/\.{3}|\u2026/g,S);S=aT.parseTransformString(S)||[];R=aT.parseTransformString(R)||[];var b=o(S.length,R.length),bQ=[],bR=[],E=0,g,bN,bP,bO;for(;E<b;E++){bP=S[E]||n(R[E]);bO=R[E]||n(bP);if((bP[0]!=bO[0])||(bP[0].toLowerCase()=="r"&&(bP[2]!=bO[2]||bP[3]!=bO[3]))||(bP[0].toLowerCase()=="s"&&(bP[3]!=bO[3]||bP[4]!=bO[4]))){return}bQ[E]=[];bR[E]=[];for(g=0,bN=o(bP.length,bO.length);g<bN;g++){g in bP&&(bQ[E][g]=bP[g]);g in bO&&(bR[E][g]=bO[g])}}return{from:bQ,to:bR}};aT._getContainer=function(b,S,E,R){var g;g=R==null&&!aT.is(b,"object")?aC.doc.getElementById(b):b;if(g==null){return}if(g.tagName){if(S==null){return{container:g,width:g.style.pixelWidth||g.offsetWidth,height:g.style.pixelHeight||g.offsetHeight}}else{return{container:g,width:S,height:E}}}return{container:1,x:b,y:S,width:E,height:R}};aT.pathToRelative=aE;aT._engine={};aT.path2curve=Y;aT.matrix=function(E,g,bO,bN,S,R){return new aH(E,g,bO,bN,S,R)};function aH(E,g,bO,bN,S,R){if(E!=null){this.a=+E;this.b=+g;this.c=+bO;this.d=+bN;this.e=+S;this.f=+R}else{this.a=1;this.b=0;this.c=0;this.d=1;this.e=0;this.f=0}}(function(E){E.add=function(bX,bU,bS,bQ,bO,bN){var S=[[],[],[]],R=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],bW=[[bX,bS,bO],[bU,bQ,bN],[0,0,1]],bV,bT,bR,bP;if(bX&&bX instanceof aH){bW=[[bX.a,bX.c,bX.e],[bX.b,bX.d,bX.f],[0,0,1]]}for(bV=0;bV<3;bV++){for(bT=0;bT<3;bT++){bP=0;for(bR=0;bR<3;bR++){bP+=R[bV][bR]*bW[bR][bT]}S[bV][bT]=bP}}this.a=S[0][0];this.b=S[1][0];this.c=S[0][1];this.d=S[1][1];this.e=S[0][2];this.f=S[1][2]};E.invert=function(){var S=this,R=S.a*S.d-S.b*S.c;return new aH(S.d/R,-S.b/R,-S.c/R,S.a/R,(S.c*S.f-S.d*S.e)/R,(S.b*S.e-S.a*S.f)/R)};E.clone=function(){return new aH(this.a,this.b,this.c,this.d,this.e,this.f)};E.translate=function(R,S){this.add(1,0,0,1,R,S)};E.scale=function(S,bO,R,bN){bO==null&&(bO=S);(R||bN)&&this.add(1,0,0,1,R,bN);this.add(S,0,0,bO,0,0);(R||bN)&&this.add(1,0,0,1,-R,-bN)};E.rotate=function(S,R,bP){S=aT.rad(S);R=R||0;bP=bP||0;var bO=+aw.cos(S).toFixed(9),bN=+aw.sin(S).toFixed(9);this.add(bO,bN,-bN,bO,R,bP);this.add(1,0,0,1,-R,-bP)};E.x=function(R,S){return R*this.a+S*this.c+this.e};E.y=function(R,S){return R*this.b+S*this.d+this.f};E.get=function(R){return +this[bJ.fromCharCode(97+R)].toFixed(4)};E.toString=function(){return aT.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()};E.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"};E.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]};function g(R){return R[0]*R[0]+R[1]*R[1]}function b(R){var S=aw.sqrt(g(R));R[0]&&(R[0]/=S);R[1]&&(R[1]/=S)}E.split=function(){var S={};S.dx=this.e;S.dy=this.f;var bO=[[this.a,this.c],[this.b,this.d]];S.scalex=aw.sqrt(g(bO[0]));b(bO[0]);S.shear=bO[0][0]*bO[1][0]+bO[0][1]*bO[1][1];bO[1]=[bO[1][0]-bO[0][0]*S.shear,bO[1][1]-bO[0][1]*S.shear];S.scaley=aw.sqrt(g(bO[1]));b(bO[1]);S.shear/=S.scaley;var R=-bO[0][1],bN=bO[1][1];if(bN<0){S.rotate=aT.deg(aw.acos(bN));if(R<0){S.rotate=360-S.rotate}}else{S.rotate=aT.deg(aw.asin(R))}S.isSimple=!+S.shear.toFixed(9)&&(S.scalex.toFixed(9)==S.scaley.toFixed(9)||!S.rotate);S.isSuperSimple=!+S.shear.toFixed(9)&&S.scalex.toFixed(9)==S.scaley.toFixed(9)&&!S.rotate;S.noRotation=!+S.shear.toFixed(9)&&!S.rotate;return S};E.toTransformString=function(R){var S=R||this[H]();if(S.isSimple){S.scalex=+S.scalex.toFixed(4);S.scaley=+S.scaley.toFixed(4);S.rotate=+S.rotate.toFixed(4);return(S.dx||S.dy?"t"+[S.dx,S.dy]:aZ)+(S.scalex!=1||S.scaley!=1?"s"+[S.scalex,S.scaley,0,0]:aZ)+(S.rotate?"r"+[S.rotate,0,0]:aZ)}else{return"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}})(aH.prototype);var X=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);if((navigator.vendor=="Apple Computer, Inc.")&&(X&&X[1]<4||navigator.platform.slice(0,2)=="iP")||(navigator.vendor=="Google Inc."&&X&&X[1]<8)){a6.safari=function(){var b=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){b.remove()})}}else{a6.safari=K}var T=function(){this.returnValue=false},bF=function(){return this.originalEvent.preventDefault()},ba=function(){this.cancelBubble=true},aL=function(){return this.originalEvent.stopPropagation()},aF=(function(){if(aC.doc.addEventListener){return function(bN,R,E,g){var b=ab&&bz[R]?bz[R]:R,S=function(bT){var bS=aC.doc.documentElement.scrollTop||aC.doc.body.scrollTop,bU=aC.doc.documentElement.scrollLeft||aC.doc.body.scrollLeft,bO=bT.clientX+bU,bV=bT.clientY+bS;if(ab&&bz[am](R)){for(var bQ=0,bR=bT.targetTouches&&bT.targetTouches.length;bQ<bR;bQ++){if(bT.targetTouches[bQ].target==bN){var bP=bT;bT=bT.targetTouches[bQ];bT.originalEvent=bP;bT.preventDefault=bF;bT.stopPropagation=aL;break}}}return E.call(g,bT,bO,bV)};bN.addEventListener(b,S,false);return function(){bN.removeEventListener(b,S,false);return true}}}else{if(aC.doc.attachEvent){return function(bN,R,E,g){var S=function(bQ){bQ=bQ||aC.win.event;var bP=aC.doc.documentElement.scrollTop||aC.doc.body.scrollTop,bR=aC.doc.documentElement.scrollLeft||aC.doc.body.scrollLeft,bO=bQ.clientX+bR,bS=bQ.clientY+bP;bQ.preventDefault=bQ.preventDefault||T;bQ.stopPropagation=bQ.stopPropagation||ba;return E.call(g,bQ,bO,bS)};bN.attachEvent("on"+R,S);var b=function(){bN.detachEvent("on"+R,S);return true};return b}}}})(),bg=[],bA=function(bP){var bS=bP.clientX,bR=bP.clientY,bU=aC.doc.documentElement.scrollTop||aC.doc.body.scrollTop,bV=aC.doc.documentElement.scrollLeft||aC.doc.body.scrollLeft,E,R=bg.length;while(R--){E=bg[R];if(ab){var bN=bP.touches.length,S;while(bN--){S=bP.touches[bN];if(S.identifier==E.el._drag.id){bS=S.clientX;bR=S.clientY;(bP.originalEvent?bP.originalEvent:bP).preventDefault();break}}}else{bP.preventDefault()}var g=E.el.node,b,bO=g.nextSibling,bT=g.parentNode,bQ=g.style.display;aC.win.opera&&bT.removeChild(g);g.style.display="none";b=E.el.paper.getElementByPoint(bS,bR);g.style.display=bQ;aC.win.opera&&(bO?bT.insertBefore(g,bO):bT.appendChild(g));b&&eve("raphael.drag.over."+E.el.id,E.el,b);bS+=bV;bR+=bU;eve("raphael.drag.move."+E.el.id,E.move_scope||E.el,bS-E.el._drag.x,bR-E.el._drag.y,bS,bR,bP)}},e=function(E){aT.unmousemove(bA).unmouseup(e);var g=bg.length,b;while(g--){b=bg[g];b.el._drag={};eve("raphael.drag.end."+b.el.id,b.end_scope||b.start_scope||b.move_scope||b.el,E)}bg=[]},bj=aT.el={};for(var az=U.length;az--;){(function(b){aT[b]=bj[b]=function(E,g){if(aT.is(E,"function")){this.events=this.events||[];this.events.push({name:b,f:E,unbind:aF(this.shape||this.node||aC.doc,b,E,g||this)})}return this};aT["un"+b]=bj["un"+b]=function(R){var E=this.events||[],g=E.length;while(g--){if(E[g].name==b&&E[g].f==R){E[g].unbind();E.splice(g,1);!E.length&&delete this.events;return this}}return this}})(U[az])}bj.data=function(g,R){var E=aW[this.id]=aW[this.id]||{};if(arguments.length==1){if(aT.is(g,"object")){for(var b in g){if(g[am](b)){this.data(b,g[b])}}return this}eve("raphael.data.get."+this.id,this,E[g],g);return E[g]}E[g]=R;eve("raphael.data.set."+this.id,this,R,g);return this};bj.removeData=function(b){if(b==null){aW[this.id]={}}else{aW[this.id]&&delete aW[this.id][b]}return this};bj.hover=function(R,b,E,g){return this.mouseover(R,E).mouseout(b,g||E)};bj.unhover=function(g,b){return this.unmouseover(g).unmouseout(b)};var bw=[];bj.drag=function(g,bN,S,b,E,R){function bO(bQ){(bQ.originalEvent||bQ).preventDefault();var bP=aC.doc.documentElement.scrollTop||aC.doc.body.scrollTop,bR=aC.doc.documentElement.scrollLeft||aC.doc.body.scrollLeft;this._drag.x=bQ.clientX+bR;this._drag.y=bQ.clientY+bP;this._drag.id=bQ.identifier;!bg.length&&aT.mousemove(bA).mouseup(e);bg.push({el:this,move_scope:b,start_scope:E,end_scope:R});bN&&eve.on("raphael.drag.start."+this.id,bN);g&&eve.on("raphael.drag.move."+this.id,g);S&&eve.on("raphael.drag.end."+this.id,S);eve("raphael.drag.start."+this.id,E||b||this,bQ.clientX+bR,bQ.clientY+bP,bQ)}this._drag={};bw.push({el:this,start:bO});this.mousedown(bO);return this};bj.onDragOver=function(b){b?eve.on("raphael.drag.over."+this.id,b):eve.unbind("raphael.drag.over."+this.id)};bj.undrag=function(){var b=bw.length;while(b--){if(bw[b].el==this){this.unmousedown(bw[b].start);bw.splice(b,1);eve.unbind("raphael.drag.*."+this.id)}}!bw.length&&aT.unmousemove(bA).unmouseup(e)};a6.circle=function(b,R,E){var g=aT._engine.circle(this,b||0,R||0,E||0);this.__set__&&this.__set__.push(g);return g};a6.rect=function(b,bN,g,R,S){var E=aT._engine.rect(this,b||0,bN||0,g||0,R||0,S||0);this.__set__&&this.__set__.push(E);return E};a6.ellipse=function(b,S,R,E){var g=aT._engine.ellipse(this,b||0,S||0,R||0,E||0);this.__set__&&this.__set__.push(g);return g};a6.path=function(b){b&&!aT.is(b,al)&&!aT.is(b[0],bf)&&(b+=aZ);var g=aT._engine.path(aT.format[bI](aT,arguments),this);this.__set__&&this.__set__.push(g);return g};a6.image=function(S,b,bN,g,R){var E=aT._engine.image(this,S||"about:blank",b||0,bN||0,g||0,R||0);this.__set__&&this.__set__.push(E);return E};a6.text=function(b,R,E){var g=aT._engine.text(this,b||0,R||0,bJ(E));this.__set__&&this.__set__.push(g);return g};a6.set=function(g){!aT.is(g,"array")&&(g=Array.prototype.splice.call(arguments,0,arguments.length));var b=new an(g);this.__set__&&this.__set__.push(b);b.paper=this;b.type="set";return b};a6.setStart=function(b){this.__set__=b||this.set()};a6.setFinish=function(g){var b=this.__set__;delete this.__set__;return b};a6.setSize=function(g,b){return aT._engine.setSize.call(this,g,b)};a6.setViewBox=function(b,S,g,R,E){return aT._engine.setViewBox.call(this,b,S,g,R,E)};a6.top=a6.bottom=null;a6.raphael=aT;var bu=function(E){var S=E.getBoundingClientRect(),bQ=E.ownerDocument,bN=bQ.body,b=bQ.documentElement,R=b.clientTop||bN.clientTop||0,bO=b.clientLeft||bN.clientLeft||0,bP=S.top+(aC.win.pageYOffset||b.scrollTop||bN.scrollTop)-R,g=S.left+(aC.win.pageXOffset||b.scrollLeft||bN.scrollLeft)-bO;return{y:bP,x:g}};a6.getElementByPoint=function(g,bP){var bO=this,E=bO.canvas,bN=aC.doc.elementFromPoint(g,bP);if(aC.win.opera&&bN.tagName=="svg"){var S=bu(E),R=E.createSVGRect();R.x=g-S.x;R.y=bP-S.y;R.width=R.height=1;var b=E.getIntersectionList(R,null);if(b.length){bN=b[b.length-1]}}if(!bN){return null}while(bN.parentNode&&bN!=E.parentNode&&!bN.raphael){bN=bN.parentNode}bN==bO.canvas.parentNode&&(bN=E);bN=bN&&bN.raphael?bO.getById(bN.raphaelid):null;return bN};a6.getById=function(g){var b=this.bottom;while(b){if(b.id==g){return b}b=b.next}return null};a6.forEach=function(E,b){var g=this.bottom;while(g){if(E.call(b,g)===false){return this}g=g.next}return this};a6.getElementsByPoint=function(b,E){var g=this.set();this.forEach(function(R){if(R.isPointInside(b,E)){g.push(R)}});return g};function A(){return this.x+aS+this.y}function av(){return this.x+aS+this.y+aS+this.width+" \xd7 "+this.height}bj.isPointInside=function(b,E){var g=this.realPath=this.realPath||P[this.type](this);return aT.isPointInsidePath(g,b,E)};bj.getBBox=function(g){if(this.removed){return{}}var b=this._;if(g){if(b.dirty||!b.bboxwt){this.realPath=P[this.type](this);b.bboxwt=ao(this.realPath);b.bboxwt.toString=av;b.dirty=0}return b.bboxwt}if(b.dirty||b.dirtyT||!b.bbox){if(b.dirty||!this.realPath){b.bboxwt=0;this.realPath=P[this.type](this)}b.bbox=ao(N(this.realPath,this.matrix));b.bbox.toString=av;b.dirty=b.dirtyT=0}return b.bbox};bj.clone=function(){if(this.removed){return null}var b=this.paper[this.type]().attr(this.attr());this.__set__&&this.__set__.push(b);return b};bj.glow=function(bO){if(this.type=="text"){return null}bO=bO||{};var E={width:(bO.width||10)+(+this.attr("stroke-width")||1),fill:bO.fill||false,opacity:bO.opacity||0.5,offsetx:bO.offsetx||0,offsety:bO.offsety||0,color:bO.color||"#000"},bN=E.width/2,R=this.paper,b=R.set(),S=this.realPath||P[this.type](this);S=this.matrix?N(S,this.matrix):S;for(var g=1;g<bN+1;g++){b.push(R.path(S).attr({stroke:E.color,fill:E.fill?E.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(E.width/bN*g).toFixed(3),opacity:+(E.opacity/bN).toFixed(3)}))}return b.insertBefore(this).translate(E.offsetx,E.offsety)};var a9={},m=function(g,b,S,R,bQ,bP,bO,bN,E){if(E==null){return s(g,b,S,R,bQ,bP,bO,bN)}else{return aT.findDotsAtSegment(g,b,S,R,bQ,bP,bO,bN,F(g,b,S,R,bQ,bP,bO,bN,E))}},a8=function(b,g){return function(bW,S,bN){bW=Y(bW);var bS,bR,E,bO,R="",bV={},bT,bQ=0;for(var bP=0,bU=bW.length;bP<bU;bP++){E=bW[bP];if(E[0]=="M"){bS=+E[1];bR=+E[2]}else{bO=m(bS,bR,E[1],E[2],E[3],E[4],E[5],E[6]);if(bQ+bO>S){if(g&&!bV.start){bT=m(bS,bR,E[1],E[2],E[3],E[4],E[5],E[6],S-bQ);R+=["C"+bT.start.x,bT.start.y,bT.m.x,bT.m.y,bT.x,bT.y];if(bN){return R}bV.start=R;R=["M"+bT.x,bT.y+"C"+bT.n.x,bT.n.y,bT.end.x,bT.end.y,E[5],E[6]].join();bQ+=bO;bS=+E[5];bR=+E[6];continue}if(!b&&!g){bT=m(bS,bR,E[1],E[2],E[3],E[4],E[5],E[6],S-bQ);return{x:bT.x,y:bT.y,alpha:bT.alpha}}}bQ+=bO;bS=+E[5];bR=+E[6]}R+=E.shift()+E}bV.end=R;bT=b?bQ:g?bV:aT.findDotsAtSegment(bS,bR,E[0],E[1],E[2],E[3],E[4],E[5],1);bT.alpha&&(bT={x:bT.x,y:bT.y,alpha:bT.alpha});return bT}};var aU=a8(1),L=a8(),af=a8(0,1);aT.getTotalLength=aU;aT.getPointAtLength=L;aT.getSubpath=function(g,R,E){if(this.getTotalLength(g)-E<0.000001){return af(g,R).end}var b=af(g,E,1);return R?af(b,R).end:b};bj.getTotalLength=function(){if(this.type!="path"){return}if(this.node.getTotalLength){return this.node.getTotalLength()}return aU(this.attrs.path)};bj.getPointAtLength=function(b){if(this.type!="path"){return}return L(this.attrs.path,b)};bj.getSubpath=function(g,b){if(this.type!="path"){return}return aT.getSubpath(this.attrs.path,g,b)};var q=aT.easing_formulas={linear:function(b){return b},"<":function(b){return br(b,1.7)},">":function(b){return br(b,0.48)},"<>":function(bP){var R=0.48-bP/1.04,E=aw.sqrt(0.1734+R*R),b=E-R,bO=br(ay(b),1/3)*(b<0?-1:1),bN=-E-R,S=br(ay(bN),1/3)*(bN<0?-1:1),g=bO+S+0.5;return(1-g)*3*g*g+g*g*g},backIn:function(g){var b=1.70158;return g*g*((b+1)*g-b)},backOut:function(g){g=g-1;var b=1.70158;return g*g*((b+1)*g+b)+1},elastic:function(b){if(b==!!b){return b}return br(2,-10*b)*aw.sin((b-0.075)*(2*aX)/0.3)+1},bounce:function(R){var g=7.5625,E=2.75,b;if(R<(1/E)){b=g*R*R}else{if(R<(2/E)){R-=(1.5/E);b=g*R*R+0.75}else{if(R<(2.5/E)){R-=(2.25/E);b=g*R*R+0.9375}else{R-=(2.625/E);b=g*R*R+0.984375}}}return b}};q.easeIn=q["ease-in"]=q["<"];q.easeOut=q["ease-out"]=q[">"];q.easeInOut=q["ease-in-out"]=q["<>"];q["back-in"]=q.backIn;q["back-out"]=q.backOut;var ad=[],aP=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(b,16)},bE=function(){var bO=+new Date,bW=0;for(;bW<ad.length;bW++){var b2=ad[bW];if(b2.el.removed||b2.paused){continue}var R=bO-b2.start,bU=b2.ms,bT=b2.easing,bX=b2.from,bR=b2.diff,g=b2.to,bQ=b2.t,bN=b2.el,bS={},b,b0={},b4;if(b2.initstatus){R=(b2.initstatus*b2.anim.top-b2.prev)/(b2.percent-b2.prev)*bU;b2.status=b2.initstatus;delete b2.initstatus;b2.stop&&ad.splice(bW--,1)}else{b2.status=(b2.prev+(b2.percent-b2.prev)*(R/bU))/b2.anim.top}if(R<0){continue}if(R<bU){var E=bT(R/bU);for(var bV in bX){if(bX[am](bV)){switch(au[bV]){case aN:b=+bX[bV]+E*bU*bR[bV];break;case"colour":b="rgb("+[J(aj(bX[bV].r+E*bU*bR[bV].r)),J(aj(bX[bV].g+E*bU*bR[bV].g)),J(aj(bX[bV].b+E*bU*bR[bV].b))].join(",")+")";break;case"path":b=[];for(var bZ=0,bP=bX[bV].length;bZ<bP;bZ++){b[bZ]=[bX[bV][bZ][0]];for(var bY=1,b1=bX[bV][bZ].length;bY<b1;bY++){b[bZ][bY]=+bX[bV][bZ][bY]+E*bU*bR[bV][bZ][bY]}b[bZ]=b[bZ].join(aS)}b=b.join(aS);break;case"transform":if(bR[bV].real){b=[];for(bZ=0,bP=bX[bV].length;bZ<bP;bZ++){b[bZ]=[bX[bV][bZ][0]];for(bY=1,b1=bX[bV][bZ].length;bY<b1;bY++){b[bZ][bY]=bX[bV][bZ][bY]+E*bU*bR[bV][bZ][bY]}}}else{var b3=function(b5){return +bX[bV][b5]+E*bU*bR[bV][b5]};b=[["m",b3(0),b3(1),b3(2),b3(3),b3(4),b3(5)]]}break;case"csv":if(bV=="clip-rect"){b=[];bZ=4;while(bZ--){b[bZ]=+bX[bV][bZ]+E*bU*bR[bV][bZ]}}break;default:var S=[][bG](bX[bV]);b=[];bZ=bN.paper.customAttributes[bV].length;while(bZ--){b[bZ]=+S[bZ]+E*bU*bR[bV][bZ]}break}bS[bV]=b}}bN.attr(bS);(function(b7,b5,b6){setTimeout(function(){eve("raphael.anim.frame."+b7,b5,b6)})})(bN.id,bN,b2.anim)}else{(function(b7,b6,b5){setTimeout(function(){eve("raphael.anim.frame."+b6.id,b6,b5);eve("raphael.anim.finish."+b6.id,b6,b5);aT.is(b7,"function")&&b7.call(b6)})})(b2.callback,bN,b2.anim);bN.attr(g);ad.splice(bW--,1);if(b2.repeat>1&&!b2.next){for(b4 in g){if(g[am](b4)){b0[b4]=b2.totalOrigin[b4]}}b2.el.attr(b0);aO(b2.anim,b2.el,b2.anim.percents[0],null,b2.totalOrigin,b2.repeat-1)}if(b2.next&&!b2.stop){aO(b2.anim,b2.el,b2.next,null,b2.totalOrigin,b2.repeat)}}}aT.svg&&bN&&bN.paper&&bN.paper.safari();ad.length&&aP(bE)},J=function(b){return b>255?255:b<0?0:b};bj.animateWith=function(g,R,E,b,bO,bT){var bN=this;if(bN.removed){bT&&bT.call(bN);return bN}var bR=E instanceof bC?E:aT.animation(E,b,bO,bT),bQ,bP;aO(bR,bN,bR.percents[0],null,bN.attr());for(var S=0,bS=ad.length;S<bS;S++){if(ad[S].anim==R&&ad[S].el==g){ad[bS-1].start=ad[S].start;break}}return bN};function a5(bV,R,g,bU,bT,bP){var bQ=3*R,bS=3*(bU-R)-bQ,b=1-bQ-bS,bO=3*g,bR=3*(bT-g)-bO,bW=1-bO-bR;function bN(bX){return((b*bX+bS)*bX+bQ)*bX}function E(bX,bZ){var bY=S(bX,bZ);return((bW*bY+bR)*bY+bO)*bY}function S(bX,b4){var b3,b2,b0,bY,b1,bZ;for(b0=bX,bZ=0;bZ<8;bZ++){bY=bN(b0)-bX;if(ay(bY)<b4){return b0}b1=(3*b*b0+2*bS)*b0+bQ;if(ay(b1)<0.000001){break}b0=b0-bY/b1}b3=0;b2=1;b0=bX;if(b0<b3){return b3}if(b0>b2){return b2}while(b3<b2){bY=bN(b0);if(ay(bY-bX)<b4){return b0}if(bX>bY){b3=b0}else{b2=b0}b0=(b2-b3)/2+b3}return b0}return E(bV,1/(200*bP))}bj.onAnimation=function(b){b?eve.on("raphael.anim.frame."+this.id,b):eve.unbind("raphael.anim.frame."+this.id);return this};function bC(S,E){var g=[],R={};this.ms=E;this.times=1;if(S){for(var b in S){if(S[am](b)){R[ap(b)]=S[b];g.push(ap(b))}}g.sort(w)}this.anim=R;this.top=g[g.length-1];this.percents=g}bC.prototype.delay=function(g){var b=new bC(this.anim,this.ms);b.times=this.times;b.del=+g||0;return b};bC.prototype.repeat=function(g){var b=new bC(this.anim,this.ms);b.del=this.del;b.times=aw.floor(o(g,0))||1;return b};function aO(b6,E,b,b4,bO,bS){b=ap(b);var cd,bN,bR,ce=[],bY,bX,S,b0=b6.ms,b5={},R={},bU={};if(b4){for(b9=0,bT=ad.length;b9<bT;b9++){var cb=ad[b9];if(cb.el.id==E.id&&cb.anim==b6){if(cb.percent!=b){ad.splice(b9,1);bR=1}else{bN=cb}E.attr(cb.totalOrigin);break}}}else{b4=+R}for(var b9=0,bT=b6.percents.length;b9<bT;b9++){if(b6.percents[b9]==b||b6.percents[b9]>b4*b6.top){b=b6.percents[b9];bX=b6.percents[b9-1]||0;b0=b0/b6.top*(b-bX);bY=b6.percents[b9+1];cd=b6.anim[b];break}else{if(b4){E.attr(b6.anim[b6.percents[b9]])}}}if(!cd){return}if(!bN){for(var b2 in cd){if(cd[am](b2)){if(au[am](b2)||E.paper.customAttributes[am](b2)){b5[b2]=E.attr(b2);(b5[b2]==null)&&(b5[b2]=t[b2]);R[b2]=cd[b2];switch(au[b2]){case aN:bU[b2]=(R[b2]-b5[b2])/b0;break;case"colour":b5[b2]=aT.getRGB(b5[b2]);var b3=aT.getRGB(R[b2]);bU[b2]={r:(b3.r-b5[b2].r)/b0,g:(b3.g-b5[b2].g)/b0,b:(b3.b-b5[b2].b)/b0};break;case"path":var bP=Y(b5[b2],R[b2]),bW=bP[1];b5[b2]=bP[0];bU[b2]=[];for(b9=0,bT=b5[b2].length;b9<bT;b9++){bU[b2][b9]=[0];for(var b8=1,ca=b5[b2][b9].length;b8<ca;b8++){bU[b2][b9][b8]=(bW[b9][b8]-b5[b2][b9][b8])/b0}}break;case"transform":var cg=E._,cf=aD(cg[b2],R[b2]);if(cf){b5[b2]=cf.from;R[b2]=cf.to;bU[b2]=[];bU[b2].real=true;for(b9=0,bT=b5[b2].length;b9<bT;b9++){bU[b2][b9]=[b5[b2][b9][0]];for(b8=1,ca=b5[b2][b9].length;b8<ca;b8++){bU[b2][b9][b8]=(R[b2][b9][b8]-b5[b2][b9][b8])/b0}}}else{var b1=(E.matrix||new aH),cc={_:{transform:cg.transform},getBBox:function(){return E.getBBox(1)}};b5[b2]=[b1.a,b1.b,b1.c,b1.d,b1.e,b1.f];aQ(cc,R[b2]);R[b2]=cc._.transform;bU[b2]=[(cc.matrix.a-b1.a)/b0,(cc.matrix.b-b1.b)/b0,(cc.matrix.c-b1.c)/b0,(cc.matrix.d-b1.d)/b0,(cc.matrix.e-b1.e)/b0,(cc.matrix.f-b1.f)/b0]}break;case"csv":var g=bJ(cd[b2])[H](a),bQ=bJ(b5[b2])[H](a);if(b2=="clip-rect"){b5[b2]=bQ;bU[b2]=[];b9=bQ.length;while(b9--){bU[b2][b9]=(g[b9]-b5[b2][b9])/b0}}R[b2]=g;break;default:g=[][bG](cd[b2]);bQ=[][bG](b5[b2]);bU[b2]=[];b9=E.paper.customAttributes[b2].length;while(b9--){bU[b2][b9]=((g[b9]||0)-(bQ[b9]||0))/b0}break}}}}var bZ=cd.easing,b7=aT.easing_formulas[bZ];if(!b7){b7=bJ(bZ).match(c);if(b7&&b7.length==5){var bV=b7;b7=function(ch){return a5(ch,+bV[1],+bV[2],+bV[3],+bV[4],b0)}}else{b7=bD}}S=cd.start||b6.start||+new Date;cb={anim:b6,percent:b,timestamp:S,start:S+(b6.del||0),status:0,initstatus:b4||0,stop:false,ms:b0,easing:b7,from:b5,diff:bU,to:R,el:E,callback:cd.callback,prev:bX,next:bY,repeat:bS||b6.times,origin:E.attr(),totalOrigin:bO};ad.push(cb);if(b4&&!bN&&!bR){cb.stop=true;cb.start=new Date-b0*b4;if(ad.length==1){return bE()}}if(bR){cb.start=new Date-cb.ms*b4}ad.length==1&&aP(bE)}else{bN.initstatus=b4;bN.start=new Date-bN.ms*b4}eve("raphael.anim.start."+E.id,E,b6)}aT.animation=function(S,g,bO,bN){if(S instanceof bC){return S}if(aT.is(bO,"function")||!bO){bN=bN||bO||null;bO=null}S=Object(S);g=+g||0;var R={},E,b;for(b in S){if(S[am](b)&&ap(b)!=b&&ap(b)+"%"!=b){E=true;R[b]=S[b]}}if(!E){return new bC(S,g)}else{bO&&(R.easing=bO);bN&&(R.callback=bN);return new bC({100:R},g)}};bj.animate=function(R,b,bN,S){var g=this;if(g.removed){S&&S.call(g);return g}var E=R instanceof bC?R:aT.animation(R,b,bN,S);aO(E,g,E.percents[0],null,g.attr());return g};bj.setTime=function(g,b){if(g&&b!=null){this.status(g,bo(b,g.ms)/g.ms)}return this};bj.status=function(S,R){var g=[],E=0,b,bN;if(R!=null){aO(S,this,-1,bo(R,1));return this}else{b=ad.length;for(;E<b;E++){bN=ad[E];if(bN.el.id==this.id&&(!S||bN.anim==S)){if(S){return bN.status}g.push({anim:bN.anim,status:bN.status})}}if(S){return 0}return g}};bj.pause=function(g){for(var b=0;b<ad.length;b++){if(ad[b].el.id==this.id&&(!g||ad[b].anim==g)){if(eve("raphael.anim.pause."+this.id,this,ad[b].anim)!==false){ad[b].paused=true}}}return this};bj.resume=function(g){for(var b=0;b<ad.length;b++){if(ad[b].el.id==this.id&&(!g||ad[b].anim==g)){var E=ad[b];if(eve("raphael.anim.resume."+this.id,this,E.anim)!==false){delete E.paused;this.status(E.anim,E.status)}}}return this};bj.stop=function(g){for(var b=0;b<ad.length;b++){if(ad[b].el.id==this.id&&(!g||ad[b].anim==g)){if(eve("raphael.anim.stop."+this.id,this,ad[b].anim)!==false){ad.splice(b--,1)}}}return this};function ac(g){for(var b=0;b<ad.length;b++){if(ad[b].el.paper==g){ad.splice(b--,1)}}}eve.on("raphael.remove",ac);eve.on("raphael.clear",ac);bj.toString=function(){return"Rapha\xebl\u2019s object"};var an=function(b){this.items=[];this.length=0;this.type="set";if(b){for(var g=0,E=b.length;g<E;g++){if(b[g]&&(b[g].constructor==bj.constructor||b[g].constructor==an)){this[this.items.length]=this.items[this.items.length]=b[g];this.length++}}}},be=an.prototype;be.push=function(){var R,b;for(var g=0,E=arguments.length;g<E;g++){R=arguments[g];if(R&&(R.constructor==bj.constructor||R.constructor==an)){b=this.items.length;this[b]=this.items[b]=R;this.length++}}return this};be.pop=function(){this.length&&delete this[this.length--];return this.items.pop()};be.forEach=function(R,b){for(var g=0,E=this.items.length;g<E;g++){if(R.call(b,this.items[g],g)===false){return this}}return this};for(var D in bj){if(bj[am](D)){be[D]=(function(b){return function(){var g=arguments;return this.forEach(function(E){E[b][bI](E,g)})}})(D)}}be.attr=function(g,bN){if(g&&aT.is(g,bf)&&aT.is(g[0],"object")){for(var b=0,S=g.length;b<S;b++){this.items[b].attr(g[b])}}else{for(var E=0,R=this.items.length;E<R;E++){this.items[E].attr(g,bN)}}return this};be.clear=function(){while(this.length){this.pop()}};be.splice=function(R,bO,bP){R=R<0?o(this.length+R,0):R;bO=o(0,bo(this.length-R,bO));var E=[],b=[],g=[],S;for(S=2;S<arguments.length;S++){g.push(arguments[S])}for(S=0;S<bO;S++){b.push(this[R+S])}for(;S<this.length-R;S++){E.push(this[R+S])}var bN=g.length;for(S=0;S<bN+E.length;S++){this.items[R+S]=this[R+S]=S<bN?g[S]:E[S-bN]}S=this.items.length=this.length-=bO-bN;while(this[S]){delete this[S++]}return new an(b)};be.exclude=function(E){for(var b=0,g=this.length;b<g;b++){if(this[b]==E){this.splice(b,1);return true}}};be.animate=function(E,b,bO,bQ){(aT.is(bO,"function")||!bO)&&(bQ=bO||null);var bN=this.items.length,R=bN,bR,bP=this,S;if(!bN){return this}bQ&&(S=function(){!--bN&&bQ.call(bP)});bO=aT.is(bO,al)?bO:S;var g=aT.animation(E,b,bO,S);bR=this.items[--R].animate(g);while(R--){this.items[R]&&!this.items[R].removed&&this.items[R].animateWith(bR,g,g)}return this};be.insertAfter=function(g){var b=this.items.length;while(b--){this.items[b].insertAfter(g)}return this};be.getBBox=function(){var b=[],bN=[],g=[],R=[];for(var E=this.items.length;E--;){if(!this.items[E].removed){var S=this.items[E].getBBox();b.push(S.x);bN.push(S.y);g.push(S.x+S.width);R.push(S.y+S.height)}}b=bo[bI](0,b);bN=bo[bI](0,bN);g=o[bI](0,g);R=o[bI](0,R);return{x:b,y:bN,x2:g,y2:R,width:g-b,height:R-bN}};be.clone=function(E){E=this.paper.set();for(var b=0,g=this.items.length;b<g;b++){E.push(this.items[b].clone())}return E};be.toString=function(){return"Rapha\xebl\u2018s set"};aT.registerFont=function(g){if(!g.face){return g}this.fonts=this.fonts||{};var R={w:g.w,face:{},glyphs:{}},E=g.face["font-family"];for(var bO in g.face){if(g.face[am](bO)){R.face[bO]=g.face[bO]}}if(this.fonts[E]){this.fonts[E].push(R)}else{this.fonts[E]=[R]}if(!g.svg){R.face["units-per-em"]=W(g.face["units-per-em"],10);for(var S in g.glyphs){if(g.glyphs[am](S)){var bN=g.glyphs[S];R.glyphs[S]={w:bN.w,k:{},d:bN.d&&"M"+bN.d.replace(/[mlcxtrv]/g,function(bP){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[bP]||"M"})+"z"};if(bN.k){for(var b in bN.k){if(bN[am](b)){R.glyphs[S].k[b]=bN.k[b]}}}}}}return g};a6.getFont=function(bP,bQ,g,R){R=R||"normal";g=g||"normal";bQ=+bQ||{normal:400,bold:700,lighter:300,bolder:800}[bQ]||400;if(!aT.fonts){return}var S=aT.fonts[bP];if(!S){var E=new RegExp("(^|\\s)"+bP.replace(/[^\w\d\s+!~.:_-]/g,aZ)+"(\\s|$)","i");for(var b in aT.fonts){if(aT.fonts[am](b)){if(E.test(b)){S=aT.fonts[b];break}}}}var bN;if(S){for(var bO=0,bR=S.length;bO<bR;bO++){bN=S[bO];if(bN.face["font-weight"]==bQ&&(bN.face["font-style"]==g||!bN.face["font-style"])&&bN.face["font-stretch"]==R){break}}}return bN};a6.print=function(bO,bN,b,bR,bS,b1,g){b1=b1||"middle";g=o(bo(g||0,1),-1);var b0=bJ(b)[H](aZ),bX=0,bZ=0,bV=aZ,b2;aT.is(bR,b)&&(bR=this.getFont(bR));if(bR){b2=(bS||16)/bR.face["units-per-em"];var R=bR.face.bbox[H](a),bQ=+R[0],E=R[3]-R[1],S=0,bT=+R[1]+(b1=="baseline"?E+(+bR.face.descent):E/2);for(var bW=0,bP=b0.length;bW<bP;bW++){if(b0[bW]=="\n"){bX=0;bY=0;bZ=0;S+=E}else{var bU=bZ&&bR.glyphs[b0[bW-1]]||{},bY=bR.glyphs[b0[bW]];bX+=bZ?(bU.w||bR.w)+(bU.k&&bU.k[b0[bW]]||0)+(bR.w*g):0;bZ=1}if(bY&&bY.d){bV+=aT.transformPath(bY.d,["t",bX*b2,S*b2,"s",b2,b2,bQ,bT,"t",(bO-bQ)/b2,(bN-bT)/b2])}}}return this.path(bV).attr({fill:"#000",stroke:"none"})};a6.add=function(R){if(aT.is(R,"array")){var E=this.set(),g=0,S=R.length,b;for(;g<S;g++){b=R[g]||{};by[am](b.type)&&E.push(this[b.type]().attr(b))}}return E};aT.format=function(g,E){var b=aT.is(E,bf)?[0][bG](E):arguments;g&&aT.is(g,al)&&b.length-1&&(g=g.replace(bt,function(S,R){return b[++R]==null?aZ:b[R]}));return g||aZ};aT.fullfill=(function(){var E=/\{([^\}]+)\}/g,b=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,g=function(bN,S,bO){var R=bO;S.replace(b,function(bR,bQ,bP,bT,bS){bQ=bQ||bT;if(R){if(bQ in R){R=R[bQ]}typeof R=="function"&&bS&&(R=R())}});R=(R==null||R==bO?bN:R)+"";return R};return function(S,R){return String(S).replace(E,function(bO,bN){return g(bO,bN,R)})}})();aT.ninja=function(){u.was?(aC.win.Raphael=u.is):delete Raphael;return aT};aT.st=be;(function(R,g,E){if(R.readyState==null&&R.addEventListener){R.addEventListener(g,E=function(){R.removeEventListener(g,E,false);R.readyState="complete"},false);R.readyState="loading"}function b(){(/in/).test(R.readyState)?setTimeout(b,9):aT.eve("raphael.DOMload")}b()})(document,"DOMContentLoaded");u.was?(aC.win.Raphael=aT):(Raphael=aT);eve.on("raphael.DOMload",function(){aq=true})})();window.Raphael.svg&&function(p){var e="hasOwnProperty",G=String,r=parseFloat,u=parseInt,g=Math,H=g.max,w=g.abs,l=g.pow,h=/[, ]+/,D=p.eve,v="",n=" ";var s="http://www.w3.org/1999/xlink",C={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},y={};p.toString=function(){return"Your browser supports SVG.\nYou are running Rapha\xebl "+this.version};var m=function(J,E){if(E){if(typeof J=="string"){J=m(J)}for(var I in E){if(E[e](I)){if(I.substring(0,6)=="xlink:"){J.setAttributeNS(s,I.substring(6),G(E[I]))}else{J.setAttribute(I,G(E[I]))}}}}else{J=p._g.doc.createElementNS("http://www.w3.org/2000/svg",J);J.style&&(J.style.webkitTapHighlightColor="rgba(0,0,0,0)")}return J},a=function(Q,U){var S="linear",I=Q.id+U,O=0.5,M=0.5,K=Q.node,E=Q.paper,W=K.style,J=p._g.doc.getElementById(I);if(!J){U=G(U).replace(p._radial_gradient,function(Z,X,aa){S="radial";if(X&&aa){O=r(X);M=r(aa);var Y=((M>0.5)*2-1);l(O-0.5,2)+l(M-0.5,2)>0.25&&(M=g.sqrt(0.25-l(O-0.5,2))*Y+0.5)&&M!=0.5&&(M=M.toFixed(5)-0.00001*Y)}return v});U=U.split(/\s*\-\s*/);if(S=="linear"){var N=U.shift();N=-r(N);if(isNaN(N)){return null}var L=[0,0,g.cos(p.rad(N)),g.sin(p.rad(N))],T=1/(H(w(L[2]),w(L[3]))||1);L[2]*=T;L[3]*=T;if(L[2]<0){L[0]=-L[2];L[2]=0}if(L[3]<0){L[1]=-L[3];L[3]=0}}var R=p._parseDots(U);if(!R){return null}I=I.replace(/[\(\)\s,\xb0#]/g,"_");if(Q.gradient&&I!=Q.gradient.id){E.defs.removeChild(Q.gradient);delete Q.gradient}if(!Q.gradient){J=m(S+"Gradient",{id:I});Q.gradient=J;m(J,S=="radial"?{fx:O,fy:M}:{x1:L[0],y1:L[1],x2:L[2],y2:L[3],gradientTransform:Q.matrix.invert()});E.defs.appendChild(J);for(var P=0,V=R.length;P<V;P++){J.appendChild(m("stop",{offset:R[P].offset?R[P].offset:P?"100%":"0%","stop-color":R[P].color||"#fff"}))}}}m(K,{fill:"url(#"+I+")",opacity:1,"fill-opacity":1});W.fill=v;W.opacity=1;W.fillOpacity=1;return 1},b=function(I){var E=I.getBBox(1);m(I.pattern,{patternTransform:I.matrix.invert()+" translate("+E.x+","+E.y+")"})},c=function(S,U,N){if(S.type=="path"){var E=G(U).toLowerCase().split("-"),R=S.paper,af=N?"end":"start",W=S.node,T=S.attrs,M=T["stroke-width"],aa=E.length,K="classic",Z,J,P,X,V,O=3,ab=3,Q=5;while(aa--){switch(E[aa]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":K=E[aa];break;case"wide":ab=5;break;case"narrow":ab=2;break;case"long":O=5;break;case"short":O=2;break}}if(K=="open"){O+=2;ab+=2;Q+=2;P=1;X=N?4:1;V={fill:"none",stroke:T.stroke}}else{X=P=O/2;V={fill:T.stroke,stroke:"none"}}if(S._.arrows){if(N){S._.arrows.endPath&&y[S._.arrows.endPath]--;S._.arrows.endMarker&&y[S._.arrows.endMarker]--}else{S._.arrows.startPath&&y[S._.arrows.startPath]--;S._.arrows.startMarker&&y[S._.arrows.startMarker]--}}else{S._.arrows={}}if(K!="none"){var I="raphael-marker-"+K,ae="raphael-marker-"+af+K+O+ab;if(!p._g.doc.getElementById(I)){R.defs.appendChild(m(m("path"),{"stroke-linecap":"round",d:C[K],id:I}));y[I]=1}else{y[I]++}var L=p._g.doc.getElementById(ae),Y;if(!L){L=m(m("marker"),{id:ae,markerHeight:ab,markerWidth:O,orient:"auto",refX:X,refY:ab/2});Y=m(m("use"),{"xlink:href":"#"+I,transform:(N?"rotate(180 "+O/2+" "+ab/2+") ":v)+"scale("+O/Q+","+ab/Q+")","stroke-width":(1/((O/Q+ab/Q)/2)).toFixed(4)});L.appendChild(Y);R.defs.appendChild(L);y[ae]=1}else{y[ae]++;Y=L.getElementsByTagName("use")[0]}m(Y,V);var ad=P*(K!="diamond"&&K!="oval");if(N){Z=S._.arrows.startdx*M||0;J=p.getTotalLength(T.path)-ad*M}else{Z=ad*M;J=p.getTotalLength(T.path)-(S._.arrows.enddx*M||0)}V={};V["marker-"+af]="url(#"+ae+")";if(J||Z){V.d=Raphael.getSubpath(T.path,Z,J)}m(W,V);S._.arrows[af+"Path"]=I;S._.arrows[af+"Marker"]=ae;S._.arrows[af+"dx"]=ad;S._.arrows[af+"Type"]=K;S._.arrows[af+"String"]=U}else{if(N){Z=S._.arrows.startdx*M||0;J=p.getTotalLength(T.path)-Z}else{Z=0;J=p.getTotalLength(T.path)-(S._.arrows.enddx*M||0)}S._.arrows[af+"Path"]&&m(W,{d:Raphael.getSubpath(T.path,Z,J)});delete S._.arrows[af+"Path"];delete S._.arrows[af+"Marker"];delete S._.arrows[af+"dx"];delete S._.arrows[af+"Type"];delete S._.arrows[af+"String"]}for(V in y){if(y[e](V)&&!y[V]){var ac=p._g.doc.getElementById(V);ac&&ac.parentNode.removeChild(ac)}}}},z={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},o=function(N,L,M){L=z[G(L).toLowerCase()];if(L){var J=N.attrs["stroke-width"]||"1",E={round:J,square:J,butt:0}[N.attrs["stroke-linecap"]||M["stroke-linecap"]]||0,K=[],I=L.length;while(I--){K[I]=L[I]*J+((I%2)?1:-1)*E}m(N.node,{"stroke-dasharray":K.join(",")})}},A=function(S,aa){var W=S.node,T=S.attrs,Q=W.style.visibility;W.style.visibility="hidden";for(var V in aa){if(aa[e](V)){if(!p._availableAttrs[e](V)){continue}var U=aa[V];T[V]=U;switch(V){case"blur":S.blur(U);break;case"href":case"title":case"target":var Y=W.parentNode;if(Y.tagName.toLowerCase()!="a"){var L=m("a");Y.insertBefore(L,W);L.appendChild(W);Y=L}if(V=="target"){Y.setAttributeNS(s,"show",U=="blank"?"new":U)}else{Y.setAttributeNS(s,V,U)}break;case"cursor":W.style.cursor=U;break;case"transform":S.transform(U);break;case"arrow-start":c(S,U);break;case"arrow-end":c(S,U,1);break;case"clip-rect":var I=G(U).split(h);if(I.length==4){S.clip&&S.clip.parentNode.parentNode.removeChild(S.clip.parentNode);var J=m("clipPath"),X=m("rect");J.id=p.createUUID();m(X,{x:I[0],y:I[1],width:I[2],height:I[3]});J.appendChild(X);S.paper.defs.appendChild(J);m(W,{"clip-path":"url(#"+J.id+")"});S.clip=X}if(!U){var R=W.getAttribute("clip-path");if(R){var Z=p._g.doc.getElementById(R.replace(/(^url\(#|\)$)/g,v));Z&&Z.parentNode.removeChild(Z);m(W,{"clip-path":v});delete S.clip}}break;case"path":if(S.type=="path"){m(W,{d:U?T.path=p._pathToAbsolute(U):"M0,0"});S._.dirty=1;if(S._.arrows){"startString" in S._.arrows&&c(S,S._.arrows.startString);"endString" in S._.arrows&&c(S,S._.arrows.endString,1)}}break;case"width":W.setAttribute(V,U);S._.dirty=1;if(T.fx){V="x";U=T.x}else{break}case"x":if(T.fx){U=-T.x-(T.width||0)}case"rx":if(V=="rx"&&S.type=="rect"){break}case"cx":W.setAttribute(V,U);S.pattern&&b(S);S._.dirty=1;break;case"height":W.setAttribute(V,U);S._.dirty=1;if(T.fy){V="y";U=T.y}else{break}case"y":if(T.fy){U=-T.y-(T.height||0)}case"ry":if(V=="ry"&&S.type=="rect"){break}case"cy":W.setAttribute(V,U);S.pattern&&b(S);S._.dirty=1;break;case"r":if(S.type=="rect"){m(W,{rx:U,ry:U})}else{W.setAttribute(V,U)}S._.dirty=1;break;case"src":if(S.type=="image"){W.setAttributeNS(s,"href",U)}break;case"stroke-width":if(S._.sx!=1||S._.sy!=1){U/=H(w(S._.sx),w(S._.sy))||1}if(S.paper._vbSize){U*=S.paper._vbSize}W.setAttribute(V,U);if(T["stroke-dasharray"]){o(S,T["stroke-dasharray"],aa)}if(S._.arrows){"startString" in S._.arrows&&c(S,S._.arrows.startString);"endString" in S._.arrows&&c(S,S._.arrows.endString,1)}break;case"stroke-dasharray":o(S,U,aa);break;case"fill":var M=G(U).match(p._ISURL);if(M){J=m("pattern");var P=m("image");J.id=p.createUUID();m(J,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});m(P,{x:0,y:0,"xlink:href":M[1]});J.appendChild(P);(function(ab){p._preload(M[1],function(){var ac=this.offsetWidth,ad=this.offsetHeight;m(ab,{width:ac,height:ad});m(P,{width:ac,height:ad});S.paper.safari()})})(J);S.paper.defs.appendChild(J);m(W,{fill:"url(#"+J.id+")"});S.pattern=J;S.pattern&&b(S);break}var K=p.getRGB(U);if(!K.error){delete aa.gradient;delete T.gradient;!p.is(T.opacity,"undefined")&&p.is(aa.opacity,"undefined")&&m(W,{opacity:T.opacity});!p.is(T["fill-opacity"],"undefined")&&p.is(aa["fill-opacity"],"undefined")&&m(W,{"fill-opacity":T["fill-opacity"]})}else{if((S.type=="circle"||S.type=="ellipse"||G(U).charAt()!="r")&&a(S,U)){if("opacity" in T||"fill-opacity" in T){var E=p._g.doc.getElementById(W.getAttribute("fill").replace(/^url\(#|\)$/g,v));if(E){var N=E.getElementsByTagName("stop");m(N[N.length-1],{"stop-opacity":("opacity" in T?T.opacity:1)*("fill-opacity" in T?T["fill-opacity"]:1)})}}T.gradient=U;T.fill="none";break}}K[e]("opacity")&&m(W,{"fill-opacity":K.opacity>1?K.opacity/100:K.opacity});case"stroke":K=p.getRGB(U);W.setAttribute(V,K.hex);V=="stroke"&&K[e]("opacity")&&m(W,{"stroke-opacity":K.opacity>1?K.opacity/100:K.opacity});if(V=="stroke"&&S._.arrows){"startString" in S._.arrows&&c(S,S._.arrows.startString);"endString" in S._.arrows&&c(S,S._.arrows.endString,1)}break;case"gradient":(S.type=="circle"||S.type=="ellipse"||G(U).charAt()!="r")&&a(S,U);break;case"opacity":if(T.gradient&&!T[e]("stroke-opacity")){m(W,{"stroke-opacity":U>1?U/100:U})}case"fill-opacity":if(T.gradient){E=p._g.doc.getElementById(W.getAttribute("fill").replace(/^url\(#|\)$/g,v));if(E){N=E.getElementsByTagName("stop");m(N[N.length-1],{"stop-opacity":U})}break}default:V=="font-size"&&(U=u(U,10)+"px");var O=V.replace(/(\-.)/g,function(ab){return ab.substring(1).toUpperCase()});W.style[O]=U;S._.dirty=1;W.setAttribute(V,U);break}}}t(S,aa);W.style.visibility=Q},F=1.2,t=function(E,L){if(E.type!="text"||!(L[e]("text")||L[e]("font")||L[e]("font-size")||L[e]("x")||L[e]("y"))){return}var Q=E.attrs,J=E.node,S=J.firstChild?u(p._g.doc.defaultView.getComputedStyle(J.firstChild,v).getPropertyValue("font-size"),10):10;if(L[e]("text")){Q.text=L.text;while(J.firstChild){J.removeChild(J.firstChild)}var K=G(L.text).split("\n"),I=[],O;for(var M=0,R=K.length;M<R;M++){O=m("tspan");M&&m(O,{dy:S*F,x:Q.x});O.appendChild(p._g.doc.createTextNode(K[M]));J.appendChild(O);I[M]=O}}else{I=J.getElementsByTagName("tspan");for(M=0,R=I.length;M<R;M++){if(M){m(I[M],{dy:S*F,x:Q.x})}else{m(I[0],{dy:0})}}}m(J,{x:Q.x,y:Q.y});E._.dirty=1;var N=E._getBBox(),P=Q.y-(N.y+N.height/2);P&&p.is(P,"finite")&&m(I[0],{dy:P})},x=function(I,E){var K=0,J=0;this[0]=this.node=I;I.raphael=true;this.id=p._oid++;I.raphaelid=this.id;this.matrix=p.matrix();this.realPath=null;this.paper=E;this.attrs=this.attrs||{};this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1};!E.bottom&&(E.bottom=this);this.prev=E.top;E.top&&(E.top.next=this);E.top=this;this.next=null},q=p.el;x.prototype=q;q.constructor=x;p._engine.path=function(E,K){var I=m("path");K.canvas&&K.canvas.appendChild(I);var J=new x(I,K);J.type="path";A(J,{fill:"none",stroke:"#000",path:E});return J};q.rotate=function(I,E,K){if(this.removed){return this}I=G(I).split(h);if(I.length-1){E=r(I[1]);K=r(I[2])}I=r(I[0]);(K==null)&&(E=K);if(E==null||K==null){var J=this.getBBox(1);E=J.x+J.width/2;K=J.y+J.height/2}this.transform(this._.transform.concat([["r",I,E,K]]));return this};q.scale=function(L,J,E,K){if(this.removed){return this}L=G(L).split(h);if(L.length-1){J=r(L[1]);E=r(L[2]);K=r(L[3])}L=r(L[0]);(J==null)&&(J=L);(K==null)&&(E=K);if(E==null||K==null){var I=this.getBBox(1)}E=E==null?I.x+I.width/2:E;K=K==null?I.y+I.height/2:K;this.transform(this._.transform.concat([["s",L,J,E,K]]));return this};q.translate=function(I,E){if(this.removed){return this}I=G(I).split(h);if(I.length-1){E=r(I[1])}I=r(I[0])||0;E=+E||0;this.transform(this._.transform.concat([["t",I,E]]));return this};q.transform=function(I){var J=this._;if(I==null){return J.transform}p._extractTransform(this,I);this.clip&&m(this.clip,{transform:this.matrix.invert()});this.pattern&&b(this);this.node&&m(this.node,{transform:this.matrix});if(J.sx!=1||J.sy!=1){var E=this.attrs[e]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":E})}return this};q.hide=function(){!this.removed&&this.paper.safari(this.node.style.display="none");return this};q.show=function(){!this.removed&&this.paper.safari(this.node.style.display="");return this};q.remove=function(){if(this.removed||!this.node.parentNode){return}var I=this.paper;I.__set__&&I.__set__.exclude(this);D.unbind("raphael.*.*."+this.id);if(this.gradient){I.defs.removeChild(this.gradient)}p._tear(this,I);if(this.node.parentNode.tagName.toLowerCase()=="a"){this.node.parentNode.parentNode.removeChild(this.node.parentNode)}else{this.node.parentNode.removeChild(this.node)}for(var E in this){this[E]=typeof this[E]=="function"?p._removedFactory(E):null}this.removed=true};q._getBBox=function(){if(this.node.style.display=="none"){this.show();var E=true}var J={};try{J=this.node.getBBox()}catch(I){}finally{J=J||{}}E&&this.hide();return J};q.attr=function(E,Q){if(this.removed){return this}if(E==null){var N={};for(var P in this.attrs){if(this.attrs[e](P)){N[P]=this.attrs[P]}}N.gradient&&N.fill=="none"&&(N.fill=N.gradient)&&delete N.gradient;N.transform=this._.transform;return N}if(Q==null&&p.is(E,"string")){if(E=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}if(E=="transform"){return this._.transform}var O=E.split(h),K={};for(var L=0,S=O.length;L<S;L++){E=O[L];if(E in this.attrs){K[E]=this.attrs[E]}else{if(p.is(this.paper.customAttributes[E],"function")){K[E]=this.paper.customAttributes[E].def}else{K[E]=p._availableAttrs[E]}}}return S-1?K:K[O[0]]}if(Q==null&&p.is(E,"array")){K={};for(L=0,S=E.length;L<S;L++){K[E[L]]=this.attr(E[L])}return K}if(Q!=null){var I={};I[E]=Q}else{if(E!=null&&p.is(E,"object")){I=E}}for(var R in I){D("raphael.attr."+R+"."+this.id,this,I[R])}for(R in this.paper.customAttributes){if(this.paper.customAttributes[e](R)&&I[e](R)&&p.is(this.paper.customAttributes[R],"function")){var M=this.paper.customAttributes[R].apply(this,[].concat(I[R]));this.attrs[R]=I[R];for(var J in M){if(M[e](J)){I[J]=M[J]}}}}A(this,I);return this};q.toFront=function(){if(this.removed){return this}if(this.node.parentNode.tagName.toLowerCase()=="a"){this.node.parentNode.parentNode.appendChild(this.node.parentNode)}else{this.node.parentNode.appendChild(this.node)}var E=this.paper;E.top!=this&&p._tofront(this,E);return this};q.toBack=function(){if(this.removed){return this}var I=this.node.parentNode;if(I.tagName.toLowerCase()=="a"){I.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild)}else{if(I.firstChild!=this.node){I.insertBefore(this.node,this.node.parentNode.firstChild)}}p._toback(this,this.paper);var E=this.paper;return this};q.insertAfter=function(E){if(this.removed){return this}var I=E.node||E[E.length-1].node;if(I.nextSibling){I.parentNode.insertBefore(this.node,I.nextSibling)}else{I.parentNode.appendChild(this.node)}p._insertafter(this,E,this.paper);return this};q.insertBefore=function(E){if(this.removed){return this}var I=E.node||E[0].node;I.parentNode.insertBefore(this.node,I);p._insertbefore(this,E,this.paper);return this};q.blur=function(I){var E=this;if(+I!==0){var J=m("filter"),K=m("feGaussianBlur");E.attrs.blur=I;J.id=p.createUUID();m(K,{stdDeviation:+I||1.5});J.appendChild(K);E.paper.defs.appendChild(J);E._blur=J;m(E.node,{filter:"url(#"+J.id+")"})}else{if(E._blur){E._blur.parentNode.removeChild(E._blur);delete E._blur;delete E.attrs.blur}E.node.removeAttribute("filter")}};p._engine.circle=function(I,E,M,L){var K=m("circle");I.canvas&&I.canvas.appendChild(K);var J=new x(K,I);J.attrs={cx:E,cy:M,r:L,fill:"none",stroke:"#000"};J.type="circle";m(K,J.attrs);return J};p._engine.rect=function(J,E,O,I,M,N){var L=m("rect");J.canvas&&J.canvas.appendChild(L);var K=new x(L,J);K.attrs={x:E,y:O,width:I,height:M,r:N||0,rx:N||0,ry:N||0,fill:"none",stroke:"#000"};K.type="rect";m(L,K.attrs);return K};p._engine.ellipse=function(I,E,N,M,L){var K=m("ellipse");I.canvas&&I.canvas.appendChild(K);var J=new x(K,I);J.attrs={cx:E,cy:N,rx:M,ry:L,fill:"none",stroke:"#000"};J.type="ellipse";m(K,J.attrs);return J};p._engine.image=function(J,N,E,O,I,M){var L=m("image");m(L,{x:E,y:O,width:I,height:M,preserveAspectRatio:"none"});L.setAttributeNS(s,"href",N);J.canvas&&J.canvas.appendChild(L);var K=new x(L,J);K.attrs={x:E,y:O,width:I,height:M,src:N};K.type="image";return K};p._engine.text=function(I,E,M,L){var K=m("text");I.canvas&&I.canvas.appendChild(K);var J=new x(K,I);J.attrs={x:E,y:M,"text-anchor":"middle",text:L,font:p._availableAttrs.font,stroke:"none",fill:"#000"};J.type="text";A(J,J.attrs);return J};p._engine.setSize=function(I,E){this.width=I||this.width;this.height=E||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);if(this._viewBox){this.setViewBox.apply(this,this._viewBox)}return this};p._engine.create=function(){var K=p._getContainer.apply(0,arguments),I=K&&K.container,O=K.x,N=K.y,J=K.width,P=K.height;if(!I){throw new Error("SVG container not found.")}var E=m("svg"),M="overflow:hidden;",L;O=O||0;N=N||0;J=J||512;P=P||342;m(E,{height:P,version:1.1,width:J,xmlns:"http://www.w3.org/2000/svg"});if(I==1){E.style.cssText=M+"position:absolute;left:"+O+"px;top:"+N+"px";p._g.doc.body.appendChild(E);L=1}else{E.style.cssText=M+"position:relative";if(I.firstChild){I.insertBefore(E,I.firstChild)}else{I.appendChild(E)}}I=new p._Paper;I.width=J;I.height=P;I.canvas=E;I.clear();I._left=I._top=0;L&&(I.renderfix=function(){});I.renderfix();return I};p._engine.setViewBox=function(M,K,O,E,I){D("raphael.setViewBox",this,this._viewBox,[M,K,O,E,I]);var Q=H(O/this.width,E/this.height),L=this.top,P=I?"meet":"xMinYMin",J,N;if(M==null){if(this._vbSize){Q=1}delete this._vbSize;J="0 0 "+this.width+n+this.height}else{this._vbSize=Q;J=M+n+K+n+O+n+E}m(this.canvas,{viewBox:J,preserveAspectRatio:P});while(Q&&L){N="stroke-width" in L.attrs?L.attrs["stroke-width"]:1;L.attr({"stroke-width":N});L._.dirty=1;L._.dirtyT=1;L=L.prev}this._viewBox=[M,K,O,E,!!I];return this};p.prototype.renderfix=function(){var M=this.canvas,E=M.style,L;try{L=M.getScreenCTM()||M.createSVGMatrix()}catch(K){L=M.createSVGMatrix()}var J=-L.e%1,I=-L.f%1;if(J||I){if(J){this._left=(this._left+J)%1;E.left=this._left+"px"}if(I){this._top=(this._top+I)%1;E.top=this._top+"px"}}};p.prototype.clear=function(){p.eve("raphael.clear",this);var E=this.canvas;while(E.firstChild){E.removeChild(E.firstChild)}this.bottom=this.top=null;(this.desc=m("desc")).appendChild(p._g.doc.createTextNode("Created with Rapha\xebl "+p.version));E.appendChild(this.desc);E.appendChild(this.defs=m("defs"))};p.prototype.remove=function(){D("raphael.remove",this);this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var E in this){this[E]=typeof this[E]=="function"?p._removedFactory(E):null}};var B=p.st;for(var f in q){if(q[e](f)&&!B[e](f)){B[f]=(function(E){return function(){var I=arguments;return this.forEach(function(J){J[E].apply(J,I)})}})(f)}}}(window.Raphael);window.Raphael.vml&&function(p){var f="hasOwnProperty",J=String,r=parseFloat,l=Math,G=l.round,M=l.max,H=l.min,w=l.abs,z="fill",m=/[, ]+/,F=p.eve,A=" progid:DXImageTransform.Microsoft",o=" ",u="",I={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},n=/([clmz]),?([^clmz]*)/gi,x=/ progid:\S+Blur\([^\)]+\)/g,L=/-?[^,\s-]+/g,e="position:absolute;left:0;top:0;width:1px;height:1px",b=21600,D={path:1,rect:1,image:1},v={circle:1,ellipse:1},g=function(W){var T=/[ahqstv]/ig,O=p._pathToAbsolute;J(W).match(T)&&(O=p._path2curve);T=/[clmz]/g;if(O==p._pathToAbsolute&&!J(W).match(T)){var S=J(W).replace(n,function(aa,ac,Y){var ab=[],X=ac.toLowerCase()=="m",Z=I[ac];Y.replace(L,function(ad){if(X&&ab.length==2){Z+=ab+I[ac=="m"?"l":"L"];ab=[]}ab.push(G(ad*b))});return Z+ab});return S}var U=O(W),N,E;S=[];for(var Q=0,V=U.length;Q<V;Q++){N=U[Q];E=U[Q][0].toLowerCase();E=="z"&&(E="x");for(var P=1,R=N.length;P<R;P++){E+=G(N[P]*b)+(P!=R-1?",":u)}S.push(E)}return S.join(o)},s=function(P,O,N){var E=p.matrix();E.rotate(-P,0.5,0.5);return{dx:E.x(O,N),dy:E.y(O,N)}},t=function(V,U,T,Q,P,R){var ad=V._,X=V.matrix,E=ad.fillpos,W=V.node,S=W.style,O=1,N="",Z,ab=b/U,aa=b/T;S.visibility="hidden";if(!U||!T){return}W.coordsize=w(ab)+o+w(aa);S.rotation=R*(U*T<0?-1:1);if(R){var ac=s(R,Q,P);Q=ac.dx;P=ac.dy}U<0&&(N+="x");T<0&&(N+=" y")&&(O=-1);S.flip=N;W.coordorigin=(Q*-ab)+o+(P*-aa);if(E||ad.fillsize){var Y=W.getElementsByTagName(z);Y=Y&&Y[0];W.removeChild(Y);if(E){ac=s(R,X.x(E[0],E[1]),X.y(E[0],E[1]));Y.position=ac.dx*O+o+ac.dy*O}if(ad.fillsize){Y.size=ad.fillsize[0]*w(U)+o+ad.fillsize[1]*w(T)}W.appendChild(Y)}S.visibility="visible"};p.toString=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\xebl "+this.version};var c=function(E,S,N){var U=J(S).toLowerCase().split("-"),Q=N?"end":"start",O=U.length,R="classic",T="medium",P="medium";while(O--){switch(U[O]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":R=U[O];break;case"wide":case"narrow":P=U[O];break;case"long":case"short":T=U[O];break}}var V=E.node.getElementsByTagName("stroke")[0];V[Q+"arrow"]=R;V[Q+"arrowlength"]=T;V[Q+"arrowwidth"]=P},B=function(ad,an){ad.attrs=ad.attrs||{};var ai=ad.node,ar=ad.attrs,Z=ai.style,V,al=D[ad.type]&&(an.x!=ar.x||an.y!=ar.y||an.width!=ar.width||an.height!=ar.height||an.cx!=ar.cx||an.cy!=ar.cy||an.rx!=ar.rx||an.ry!=ar.ry||an.r!=ar.r),ac=v[ad.type]&&(ar.cx!=an.cx||ar.cy!=an.cy||ar.r!=an.r||ar.rx!=an.rx||ar.ry!=an.ry),av=ad;for(var aa in an){if(an[f](aa)){ar[aa]=an[aa]}}if(al){ar.path=p._getPath[ad.type](ad);ad._.dirty=1}an.href&&(ai.href=an.href);an.title&&(ai.title=an.title);an.target&&(ai.target=an.target);an.cursor&&(Z.cursor=an.cursor);"blur" in an&&ad.blur(an.blur);if(an.path&&ad.type=="path"||al){ai.path=g(~J(ar.path).toLowerCase().indexOf("r")?p._pathToAbsolute(ar.path):ar.path);if(ad.type=="image"){ad._.fillpos=[ar.x,ar.y];ad._.fillsize=[ar.width,ar.height];t(ad,1,1,0,0,0)}}"transform" in an&&ad.transform(an.transform);if(ac){var Q=+ar.cx,O=+ar.cy,U=+ar.rx||+ar.r||0,T=+ar.ry||+ar.r||0;ai.path=p.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",G((Q-U)*b),G((O-T)*b),G((Q+U)*b),G((O+T)*b),G(Q*b))}if("clip-rect" in an){var N=J(an["clip-rect"]).split(m);if(N.length==4){N[2]=+N[2]+(+N[0]);N[3]=+N[3]+(+N[1]);var ab=ai.clipRect||p._g.doc.createElement("div"),au=ab.style;au.clip=p.format("rect({1}px {2}px {3}px {0}px)",N);if(!ai.clipRect){au.position="absolute";au.top=0;au.left=0;au.width=ad.paper.width+"px";au.height=ad.paper.height+"px";ai.parentNode.insertBefore(ab,ai);ab.appendChild(ai);ai.clipRect=ab}}if(!an["clip-rect"]){ai.clipRect&&(ai.clipRect.style.clip="auto")}}if(ad.textpath){var ap=ad.textpath.style;an.font&&(ap.font=an.font);an["font-family"]&&(ap.fontFamily='"'+an["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,u)+'"');an["font-size"]&&(ap.fontSize=an["font-size"]);an["font-weight"]&&(ap.fontWeight=an["font-weight"]);an["font-style"]&&(ap.fontStyle=an["font-style"])}if("arrow-start" in an){c(av,an["arrow-start"])}if("arrow-end" in an){c(av,an["arrow-end"],1)}if(an.opacity!=null||an["stroke-width"]!=null||an.fill!=null||an.src!=null||an.stroke!=null||an["stroke-width"]!=null||an["stroke-opacity"]!=null||an["fill-opacity"]!=null||an["stroke-dasharray"]!=null||an["stroke-miterlimit"]!=null||an["stroke-linejoin"]!=null||an["stroke-linecap"]!=null){var aj=ai.getElementsByTagName(z),aq=false;aj=aj&&aj[0];!aj&&(aq=aj=K(z));if(ad.type=="image"&&an.src){aj.src=an.src}an.fill&&(aj.on=true);if(aj.on==null||an.fill=="none"||an.fill===null){aj.on=false}if(aj.on&&an.fill){var S=J(an.fill).match(p._ISURL);if(S){aj.parentNode==ai&&ai.removeChild(aj);aj.rotate=true;aj.src=S[1];aj.type="tile";var E=ad.getBBox(1);aj.position=E.x+o+E.y;ad._.fillpos=[E.x,E.y];p._preload(S[1],function(){ad._.fillsize=[this.offsetWidth,this.offsetHeight]})}else{aj.color=p.getRGB(an.fill).hex;aj.src=u;aj.type="solid";if(p.getRGB(an.fill).error&&(av.type in {circle:1,ellipse:1}||J(an.fill).charAt()!="r")&&a(av,an.fill,aj)){ar.fill="none";ar.gradient=an.fill;aj.rotate=false}}}if("fill-opacity" in an||"opacity" in an){var R=((+ar["fill-opacity"]+1||2)-1)*((+ar.opacity+1||2)-1)*((+p.getRGB(an.fill).o+1||2)-1);R=H(M(R,0),1);aj.opacity=R;if(aj.src){aj.color="none"}}ai.appendChild(aj);var W=(ai.getElementsByTagName("stroke")&&ai.getElementsByTagName("stroke")[0]),at=false;!W&&(at=W=K("stroke"));if((an.stroke&&an.stroke!="none")||an["stroke-width"]||an["stroke-opacity"]!=null||an["stroke-dasharray"]||an["stroke-miterlimit"]||an["stroke-linejoin"]||an["stroke-linecap"]){W.on=true}(an.stroke=="none"||an.stroke===null||W.on==null||an.stroke==0||an["stroke-width"]==0)&&(W.on=false);var ah=p.getRGB(an.stroke);W.on&&an.stroke&&(W.color=ah.hex);R=((+ar["stroke-opacity"]+1||2)-1)*((+ar.opacity+1||2)-1)*((+ah.o+1||2)-1);var ae=(r(an["stroke-width"])||1)*0.75;R=H(M(R,0),1);an["stroke-width"]==null&&(ae=ar["stroke-width"]);an["stroke-width"]&&(W.weight=ae);ae&&ae<1&&(R*=ae)&&(W.weight=1);W.opacity=R;an["stroke-linejoin"]&&(W.joinstyle=an["stroke-linejoin"]||"miter");W.miterlimit=an["stroke-miterlimit"]||8;an["stroke-linecap"]&&(W.endcap=an["stroke-linecap"]=="butt"?"flat":an["stroke-linecap"]=="square"?"square":"round");if(an["stroke-dasharray"]){var ag={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};W.dashstyle=ag[f](an["stroke-dasharray"])?ag[an["stroke-dasharray"]]:u}at&&ai.appendChild(W)}if(av.type=="text"){av.paper.canvas.style.display=u;var ak=av.paper.span,af=100,P=ar.font&&ar.font.match(/\d+(?:\.\d*)?(?=px)/);Z=ak.style;ar.font&&(Z.font=ar.font);ar["font-family"]&&(Z.fontFamily=ar["font-family"]);ar["font-weight"]&&(Z.fontWeight=ar["font-weight"]);ar["font-style"]&&(Z.fontStyle=ar["font-style"]);P=r(ar["font-size"]||P&&P[0])||10;Z.fontSize=P*af+"px";av.textpath.string&&(ak.innerHTML=J(av.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var Y=ak.getBoundingClientRect();av.W=ar.w=(Y.right-Y.left)/af;av.H=ar.h=(Y.bottom-Y.top)/af;av.X=ar.x;av.Y=ar.y+av.H/2;("x" in an||"y" in an)&&(av.path.v=p.format("m{0},{1}l{2},{1}",G(ar.x*b),G(ar.y*b),G(ar.x*b)+1));var X=["x","y","text","font","font-family","font-weight","font-style","font-size"];for(var am=0,ao=X.length;am<ao;am++){if(X[am] in an){av._.dirty=1;break}}switch(ar["text-anchor"]){case"start":av.textpath.style["v-text-align"]="left";av.bbx=av.W/2;break;case"end":av.textpath.style["v-text-align"]="right";av.bbx=-av.W/2;break;default:av.textpath.style["v-text-align"]="center";av.bbx=0;break}av.textpath.style["v-text-kern"]=true}},a=function(E,V,Y){E.attrs=E.attrs||{};var W=E.attrs,P=Math.pow,Q,R,T="linear",U=".5 .5";E.attrs.gradient=V;V=J(V).replace(p._radial_gradient,function(ab,ac,aa){T="radial";if(ac&&aa){ac=r(ac);aa=r(aa);P(ac-0.5,2)+P(aa-0.5,2)>0.25&&(aa=l.sqrt(0.25-P(ac-0.5,2))*((aa>0.5)*2-1)+0.5);U=ac+o+aa}return u});V=V.split(/\s*\-\s*/);if(T=="linear"){var N=V.shift();N=-r(N);if(isNaN(N)){return null}}var S=p._parseDots(V);if(!S){return null}E=E.shape||E.node;if(S.length){E.removeChild(Y);Y.on=true;Y.method="none";Y.color=S[0].color;Y.color2=S[S.length-1].color;var Z=[];for(var O=0,X=S.length;O<X;O++){S[O].offset&&Z.push(S[O].offset+o+S[O].color)}Y.colors=Z.length?Z.join():"0% "+Y.color;if(T=="radial"){Y.type="gradientTitle";Y.focus="100%";Y.focussize="0 0";Y.focusposition=U;Y.angle=0}else{Y.type="gradient";Y.angle=(270-N)%360}E.appendChild(Y)}return 1},y=function(N,E){this[0]=this.node=N;N.raphael=true;this.id=p._oid++;N.raphaelid=this.id;this.X=0;this.Y=0;this.attrs={};this.paper=E;this.matrix=p.matrix();this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1};!E.bottom&&(E.bottom=this);this.prev=E.top;E.top&&(E.top.next=this);E.top=this;this.next=null};var q=p.el;y.prototype=q;q.constructor=y;q.transform=function(Q){if(Q==null){return this._.transform}var S=this.paper._viewBoxShift,R=S?"s"+[S.scale,S.scale]+"-1-1t"+[S.dx,S.dy]:u,V;if(S){V=Q=J(Q).replace(/\.{3}|\u2026/g,this._.transform||u)}p._extractTransform(this,R+Q);var W=this.matrix.clone(),Y=this.skew,O=this.node,U,P=~J(this.attrs.fill).indexOf("-"),E=!J(this.attrs.fill).indexOf("url(");W.translate(-0.5,-0.5);if(E||P||this.type=="image"){Y.matrix="1 0 0 1";Y.offset="0 0";U=W.split();if((P&&U.noRotation)||!U.isSimple){O.style.filter=W.toFilter();var T=this.getBBox(),N=this.getBBox(1),Z=T.x-N.x,X=T.y-N.y;O.coordorigin=(Z*-b)+o+(X*-b);t(this,1,1,Z,X,0)}else{O.style.filter=u;t(this,U.scalex,U.scaley,U.dx,U.dy,U.rotate)}}else{O.style.filter=u;Y.matrix=J(W);Y.offset=W.offset()}V&&(this._.transform=V);return this};q.rotate=function(N,E,P){if(this.removed){return this}if(N==null){return}N=J(N).split(m);if(N.length-1){E=r(N[1]);P=r(N[2])}N=r(N[0]);(P==null)&&(E=P);if(E==null||P==null){var O=this.getBBox(1);E=O.x+O.width/2;P=O.y+O.height/2}this._.dirtyT=1;this.transform(this._.transform.concat([["r",N,E,P]]));return this};q.translate=function(N,E){if(this.removed){return this}N=J(N).split(m);if(N.length-1){E=r(N[1])}N=r(N[0])||0;E=+E||0;if(this._.bbox){this._.bbox.x+=N;this._.bbox.y+=E}this.transform(this._.transform.concat([["t",N,E]]));return this};q.scale=function(Q,O,E,P){if(this.removed){return this}Q=J(Q).split(m);if(Q.length-1){O=r(Q[1]);E=r(Q[2]);P=r(Q[3]);isNaN(E)&&(E=null);isNaN(P)&&(P=null)}Q=r(Q[0]);(O==null)&&(O=Q);(P==null)&&(E=P);if(E==null||P==null){var N=this.getBBox(1)}E=E==null?N.x+N.width/2:E;P=P==null?N.y+N.height/2:P;this.transform(this._.transform.concat([["s",Q,O,E,P]]));this._.dirtyT=1;return this};q.hide=function(){!this.removed&&(this.node.style.display="none");return this};q.show=function(){!this.removed&&(this.node.style.display=u);return this};q._getBBox=function(){if(this.removed){return{}}return{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}};q.remove=function(){if(this.removed||!this.node.parentNode){return}this.paper.__set__&&this.paper.__set__.exclude(this);p.eve.unbind("raphael.*.*."+this.id);p._tear(this,this.paper);this.node.parentNode.removeChild(this.node);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var E in this){this[E]=typeof this[E]=="function"?p._removedFactory(E):null}this.removed=true};q.attr=function(E,V){if(this.removed){return this}if(E==null){var S={};for(var U in this.attrs){if(this.attrs[f](U)){S[U]=this.attrs[U]}}S.gradient&&S.fill=="none"&&(S.fill=S.gradient)&&delete S.gradient;S.transform=this._.transform;return S}if(V==null&&p.is(E,"string")){if(E==z&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}var T=E.split(m),P={};for(var Q=0,X=T.length;Q<X;Q++){E=T[Q];if(E in this.attrs){P[E]=this.attrs[E]}else{if(p.is(this.paper.customAttributes[E],"function")){P[E]=this.paper.customAttributes[E].def}else{P[E]=p._availableAttrs[E]}}}return X-1?P:P[T[0]]}if(this.attrs&&V==null&&p.is(E,"array")){P={};for(Q=0,X=E.length;Q<X;Q++){P[E[Q]]=this.attr(E[Q])}return P}var N;if(V!=null){N={};N[E]=V}V==null&&p.is(E,"object")&&(N=E);for(var W in N){F("raphael.attr."+W+"."+this.id,this,N[W])}if(N){for(W in this.paper.customAttributes){if(this.paper.customAttributes[f](W)&&N[f](W)&&p.is(this.paper.customAttributes[W],"function")){var R=this.paper.customAttributes[W].apply(this,[].concat(N[W]));this.attrs[W]=N[W];for(var O in R){if(R[f](O)){N[O]=R[O]}}}}if(N.text&&this.type=="text"){this.textpath.string=N.text}B(this,N)}return this};q.toFront=function(){!this.removed&&this.node.parentNode.appendChild(this.node);this.paper&&this.paper.top!=this&&p._tofront(this,this.paper);return this};q.toBack=function(){if(this.removed){return this}if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild);p._toback(this,this.paper)}return this};q.insertAfter=function(E){if(this.removed){return this}if(E.constructor==p.st.constructor){E=E[E.length-1]}if(E.node.nextSibling){E.node.parentNode.insertBefore(this.node,E.node.nextSibling)}else{E.node.parentNode.appendChild(this.node)}p._insertafter(this,E,this.paper);return this};q.insertBefore=function(E){if(this.removed){return this}if(E.constructor==p.st.constructor){E=E[0]}E.node.parentNode.insertBefore(this.node,E.node);p._insertbefore(this,E,this.paper);return this};q.blur=function(E){var N=this.node.runtimeStyle,O=N.filter;O=O.replace(x,u);if(+E!==0){this.attrs.blur=E;N.filter=O+o+A+".Blur(pixelradius="+(+E||1.5)+")";N.margin=p.format("-{0}px 0 0 -{0}px",G(+E||1.5))}else{N.filter=O;N.margin=0;delete this.attrs.blur}};p._engine.path=function(P,N){var Q=K("shape");Q.style.cssText=e;Q.coordsize=b+o+b;Q.coordorigin=N.coordorigin;var R=new y(Q,N),E={fill:"none",stroke:"#000"};P&&(E.path=P);R.type="path";R.path=[];R.Path=u;B(R,E);N.canvas.appendChild(Q);var O=K("skew");O.on=true;Q.appendChild(O);R.skew=O;R.transform(u);return R};p._engine.rect=function(N,S,Q,T,O,E){var U=p._rectPath(S,Q,T,O,E),P=N.path(U),R=P.attrs;P.X=R.x=S;P.Y=R.y=Q;P.W=R.width=T;P.H=R.height=O;R.r=E;R.path=U;P.type="rect";return P};p._engine.ellipse=function(N,E,S,R,Q){var P=N.path(),O=P.attrs;P.X=E-R;P.Y=S-Q;P.W=R*2;P.H=Q*2;P.type="ellipse";B(P,{cx:E,cy:S,rx:R,ry:Q});return P};p._engine.circle=function(N,E,R,Q){var P=N.path(),O=P.attrs;P.X=E-Q;P.Y=R-Q;P.W=P.H=Q*2;P.type="circle";B(P,{cx:E,cy:R,r:Q});return P};p._engine.image=function(N,E,T,R,U,P){var W=p._rectPath(T,R,U,P),Q=N.path(W).attr({stroke:"none"}),S=Q.attrs,O=Q.node,V=O.getElementsByTagName(z)[0];S.src=E;Q.X=S.x=T;Q.Y=S.y=R;Q.W=S.width=U;Q.H=S.height=P;S.path=W;Q.type="image";V.parentNode==O&&O.removeChild(V);V.rotate=true;V.src=E;V.type="tile";Q._.fillpos=[T,R];Q._.fillsize=[U,P];O.appendChild(V);t(Q,1,1,0,0,0);return Q};p._engine.text=function(E,S,R,T){var P=K("shape"),V=K("path"),O=K("textpath");S=S||0;R=R||0;T=T||"";V.v=p.format("m{0},{1}l{2},{1}",G(S*b),G(R*b),G(S*b)+1);V.textpathok=true;O.string=J(T);O.on=true;P.style.cssText=e;P.coordsize=b+o+b;P.coordorigin="0 0";var N=new y(P,E),Q={fill:"#000",stroke:"none",font:p._availableAttrs.font,text:T};N.shape=P;N.path=V;N.textpath=O;N.type="text";N.attrs.text=J(T);N.attrs.x=S;N.attrs.y=R;N.attrs.w=1;N.attrs.h=1;B(N,Q);P.appendChild(O);P.appendChild(V);E.canvas.appendChild(P);var U=K("skew");U.on=true;P.appendChild(U);N.skew=U;N.transform(u);return N};p._engine.setSize=function(O,E){var N=this.canvas.style;this.width=O;this.height=E;O==+O&&(O+="px");E==+E&&(E+="px");N.width=O;N.height=E;N.clip="rect(0 "+O+" "+E+" 0)";if(this._viewBox){p._engine.setViewBox.apply(this,this._viewBox)}return this};p._engine.setViewBox=function(R,Q,S,O,P){p.eve("raphael.setViewBox",this,this._viewBox,[R,Q,S,O,P]);var E=this.width,U=this.height,V=1/M(S/E,O/U),T,N;if(P){T=U/O;N=E/S;if(S*T<E){R-=(E-S*T)/2/T}if(O*N<U){Q-=(U-O*N)/2/N}}this._viewBox=[R,Q,S,O,!!P];this._viewBoxShift={dx:-R,dy:-Q,scale:V};this.forEach(function(W){W.transform("...")});return this};var K;p._engine.initWin=function(O){var N=O.document;N.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!N.namespaces.rvml&&N.namespaces.add("rvml","urn:schemas-microsoft-com:vml");K=function(P){return N.createElement("<rvml:"+P+' class="rvml">')}}catch(E){K=function(P){return N.createElement("<"+P+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}};p._engine.initWin(p._g.win);p._engine.create=function(){var O=p._getContainer.apply(0,arguments),E=O.container,U=O.height,V,N=O.width,T=O.x,S=O.y;if(!E){throw new Error("VML container not found.")}var Q=new p._Paper,R=Q.canvas=p._g.doc.createElement("div"),P=R.style;T=T||0;S=S||0;N=N||512;U=U||342;Q.width=N;Q.height=U;N==+N&&(N+="px");U==+U&&(U+="px");Q.coordsize=b*1000+o+b*1000;Q.coordorigin="0 0";Q.span=p._g.doc.createElement("span");Q.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;";R.appendChild(Q.span);P.cssText=p.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",N,U);if(E==1){p._g.doc.body.appendChild(R);P.left=T+"px";P.top=S+"px";P.position="absolute"}else{if(E.firstChild){E.insertBefore(R,E.firstChild)}else{E.appendChild(R)}}Q.renderfix=function(){};return Q};p.prototype.clear=function(){p.eve("raphael.clear",this);this.canvas.innerHTML=u;this.span=p._g.doc.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas.appendChild(this.span);this.bottom=this.top=null};p.prototype.remove=function(){p.eve("raphael.remove",this);this.canvas.parentNode.removeChild(this.canvas);for(var E in this){this[E]=typeof this[E]=="function"?p._removedFactory(E):null}return true};var C=p.st;for(var h in q){if(q[f](h)&&!C[f](h)){C[h]=(function(E){return function(){var N=arguments;return this.forEach(function(O){O[E].apply(O,N)})}})(h)}}}(window.Raphael);(function(){window.ScaleRaphael=function(c,f,b){var h=(typeof c=="string")?document.getElementById(c):c;if(!h.style.position){h.style.position="relative"}h.style.width=f+"px";h.style.height=b+"px";h.style.overflow="hidden";var e;if(Raphael.type=="VML"){h.innerHTML="<rvml:group style='position : absolute; width: 1000px; height: 1000px; top: 0px; left: 0px' coordsize='1000,1000' class='rvml' id='vmlgroup'></rvml:group>";e=document.getElementById("vmlgroup")}else{h.innerHTML="<div id='svggroup'></div>";e=document.getElementById("svggroup")}var g=new Raphael(e,f,b);var a;if(Raphael.type=="SVG"){g.canvas.setAttribute("viewBox","0 0 "+f+" "+b)}else{a=h.getElementsByTagName("div")[0]}g.changeSize=function(y,t,m,n){n=!n;var v=y/f;var p=t/b;var o=v<p?v:p;var l=parseInt(b*o);var s=parseInt(f*o);if(Raphael.type=="VML"){var r=document.getElementsByTagName("textpath");for(var q in r){var z=r[q];if(z.style){if(!z._fontSize){var x=z.style.font.split("px");z._fontSize=parseInt(x[0]);z._font=x[1]}z.style.font=z._fontSize*o+"px"+z._font}}var u;if(s<l){u=s*1000/f}else{u=l*1000/b}u=parseInt(u);e.style.width=u+"px";e.style.height=u+"px";if(n){e.style.left=parseInt((y-s)/2)+"px";e.style.top=parseInt((t-l)/2)+"px"}a.style.overflow="visible"}if(n){s=y;l=t}h.style.width=s+"px";h.style.height=l+"px";g.setSize(s,l);if(m){h.style.position="absolute";h.style.left=parseInt((y-s)/2)+"px";h.style.top=parseInt((t-l)/2)+"px"}};g.scaleAll=function(l){g.changeSize(f*l,b*l)};g.changeSize(f,b);g.w=f;g.h=b;return g}})();if(typeof exports==="undefined"){exports={}}if(typeof require!=="function"){require=function(a){return exports}}(function(){var F=function(aD){var aF=arguments[0],aC=1,aE=arguments[aC];while(aE){aF=aF.slice(0,-1)+aE.slice(1);aE=arguments[++aC]}return aF},v=function(aC){return"(?:"+aC+")"},c="[A-Za-z]",M="[\\x0D]",g="[0-9]",af="[\\x22]",at=F(g,"[A-Fa-f]"),ai="[\\x0A]",ac="[\\x20]",ak=v("%"+at+at),au="[\\:\\/\\?\\#\\[\\]\\@]",al="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",J=F(au,al),Q=F(c,g,"[\\-\\.\\_\\~]"),e=v(c+F(c,g,"[\\+\\-\\.]")+"*"),p=v(v(ak+"|"+F(Q,al,"[\\:]"))+"*"),U=v(v("25[0-5]")+"|"+v("2[0-4]"+g)+"|"+v("1"+g+g)+"|"+v("[1-9]"+g)+"|"+g),ar=v(U+"\\."+U+"\\."+U+"\\."+U),L=v(at+"{1,4}"),aw=v(v(L+"\\:"+L)+"|"+ar),ap=v(F(Q,al,"[\\:]")+"+"),R=v("v"+at+"+\\."+F(Q,al,"[\\:]")+"+"),aq=v("\\["+v(ap+"|"+R)+"\\]"),aB=v(v(ak+"|"+F(Q,al))+"*"),f=v(aq+"|"+ar+"|"+aB),Y=v(g+"*"),l=v(v(p+"@")+"?"+f+v("\\:"+Y)+"?"),r=v(ak+"|"+F(Q,al,"[\\:\\@]")),W=v(r+"*"),aj=v(r+"+"),ah=v(v(ak+"|"+F(Q,al,"[\\@]"))+"+"),a=v(v("\\/"+W)+"*"),q=v("\\/"+v(aj+a)+"?"),ax=v(ah+a),aA=v(aj+a),b=v(""),m=v(a+"|"+q+"|"+ax+"|"+aA+"|"+b),s=v(v(r+"|[\\/\\?]")+"*"),X=v(v(r+"|[\\/\\?]")+"*"),av=v(v("\\/\\/"+l+a)+"|"+q+"|"+aA+"|"+b),aa=v(e+"\\:"+av+v("\\?"+s)+"?"+v("\\#"+X)+"?"),P=v(v("\\/\\/"+l+a)+"|"+q+"|"+ax+"|"+b),u=v(P+v("\\?"+s)+"?"+v("\\#"+X)+"?"),w=v(aa+"|"+u),ay=v(e+"\\:"+av+v("\\?"+s)+"?"),t=new RegExp("^"+v("("+aa+")|("+u+")")+"$"),ao=new RegExp("^("+e+")\\:"+v(v("\\/\\/("+v("("+p+")@")+"?("+f+")"+v("\\:("+Y+")")+"?)")+"?("+a+"|"+q+"|"+aA+"|"+b+")")+v("\\?("+s+")")+"?"+v("\\#("+X+")")+"?$"),N=new RegExp("^(){0}"+v(v("\\/\\/("+v("("+p+")@")+"?("+f+")"+v("\\:("+Y+")")+"?)")+"?("+a+"|"+q+"|"+ax+"|"+b+")")+v("\\?("+s+")")+"?"+v("\\#("+X+")")+"?$"),G=new RegExp("^("+e+")\\:"+v(v("\\/\\/("+v("("+p+")@")+"?("+f+")"+v("\\:("+Y+")")+"?)")+"?("+a+"|"+q+"|"+aA+"|"+b+")")+v("\\?("+s+")")+"?$"),O=new RegExp("^"+v("\\#("+X+")")+"?$"),H=new RegExp("^"+v("("+p+")@")+"?("+f+")"+v("\\:("+Y+")")+"?$"),am=new RegExp(F("[^]",c,g,"[\\+\\-\\.]"),"g"),ab=new RegExp(F("[^\\%\\:]",Q,al),"g"),az=new RegExp(F("[^\\%]",Q,al),"g"),S=new RegExp(F("[^\\%\\/\\:\\@]",Q,al),"g"),Z=new RegExp(F("[^\\%\\/\\@]",Q,al),"g"),C=new RegExp(F("[^\\%]",Q,al,"[\\:\\@\\/\\?]"),"g"),K=C,V=new RegExp(F("[^]",Q,al),"g"),I=new RegExp(Q,"g"),x=new RegExp(F("[^\\%]",Q,J),"g"),T=new RegExp(ak+"+","g"),o=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?([^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/i,E=/^\.\.?\//,D=/^\/\.(\/|$)/,B=/^\/\.\.(\/|$)/,z=/^\.\.?$/,y=/^\/?.*?(?=\/|$)/,A=("").match(/(){0}/)[1]===undefined,n=function(aC){var aD=aC.charCodeAt(0);if(aD<128){return"%"+aD.toString(16).toUpperCase()}else{if((aD>127)&&(aD<2048)){return"%"+((aD>>6)|192).toString(16).toUpperCase()+"%"+((aD&63)|128).toString(16).toUpperCase()}else{return"%"+((aD>>12)|224).toString(16).toUpperCase()+"%"+(((aD>>6)&63)|128).toString(16).toUpperCase()+"%"+((aD&63)|128).toString(16).toUpperCase()}}},an=function(aF){var aC="",aD=0,aG,aE;while(aD<aF.length){aG=parseInt(aF.substr(aD+1,2),16);if(aG<128){aE=String.fromCharCode(aG);if(aE.match(I)){aC+=aE}else{aC+=aF.substr(aD,3)}aD+=3}else{if((aG>191)&&(aG<224)){aC+=aF.substr(aD,6);aD+=6}else{aC+=aF.substr(aD,9);aD+=9}}}return aC},h=function(aG){var aD="",aF=0,aH,aE,aC;while(aF<aG.length){aH=parseInt(aG.substr(aF+1,2),16);if(aH<128){aD+=String.fromCharCode(aH);aF+=3}else{if((aH>191)&&(aH<224)){aE=parseInt(aG.substr(aF+4,2),16);aD+=String.fromCharCode(((aH&31)<<6)|(aE&63));aF+=6}else{aE=parseInt(aG.substr(aF+4,2),16);aC=parseInt(aG.substr(aF+7,2),16);aD+=String.fromCharCode(((aH&15)<<12)|((aE&63)<<6)|(aC&63));aF+=9}}}return aD},ae=function(aC){return aC===undefined?"undefined":(aC===null?"null":Object.prototype.toString.call(aC).split(" ").pop().split("]").shift().toLowerCase())},ag=function(){this.errors=[]},ad=exports;ag.prototype={scheme:undefined,authority:undefined,userinfo:undefined,host:undefined,port:undefined,path:undefined,query:undefined,fragment:undefined,reference:undefined,errors:undefined};ad.SCHEMES={};ad.parse=function(aG,aC){var aF,aE=new ag(),aD;aG=aG?aG.toString():"";aC=aC||{};if(aC.reference==="suffix"){aG=(aC.scheme?aC.scheme+":":"")+"//"+aG}aF=aG.match(t);if(aF){if(aF[1]){aF=aG.match(ao)}else{aF=aG.match(N)}}if(!aF){if(!aC.tolerant){aE.errors.push("URI is not strictly valid.")}aF=aG.match(o)}if(aF){if(A){aE.scheme=aF[1];aE.authority=aF[2];aE.userinfo=aF[3];aE.host=aF[4];aE.port=parseInt(aF[5],10);aE.path=aF[6]||"";aE.query=aF[7];aE.fragment=aF[8];if(isNaN(aE.port)){aE.port=aF[5]}}else{aE.scheme=aF[1]||undefined;aE.authority=(aG.indexOf("//")!==-1?aF[2]:undefined);aE.userinfo=(aG.indexOf("@")!==-1?aF[3]:undefined);aE.host=(aG.indexOf("//")!==-1?aF[4]:undefined);aE.port=parseInt(aF[5],10);aE.path=aF[6]||"";aE.query=(aG.indexOf("?")!==-1?aF[7]:undefined);aE.fragment=(aG.indexOf("#")!==-1?aF[8]:undefined);if(isNaN(aE.port)){aE.port=(aG.match(/\/\/.*\:(?:\/|\?|\#|$)/)?aF[4]:undefined)}}if(!aE.scheme&&!aE.authority&&!aE.path&&!aE.query){aE.reference="same-document"}else{if(!aE.scheme){aE.reference="relative"}else{if(!aE.fragment){aE.reference="absolute"}else{aE.reference="uri"}}}if(aC.reference&&aC.reference!=="suffix"&&aC.reference!==aE.reference){aE.errors.push("URI is not a "+aC.reference+" reference.")}aD=ad.SCHEMES[(aE.scheme||aC.scheme||"").toLowerCase()];if(aD&&aD.parse){aD.parse(aE,aC)}}else{aE.errors.push("URI can not be parsed.")}return aE};ad._recomposeAuthority=function(aD){var aC=[];if(aD.userinfo!==undefined||aD.host!==undefined||typeof aD.port==="number"){if(aD.userinfo!==undefined){aC.push(aD.userinfo.toString().replace(ab,n));aC.push("@")}if(aD.host!==undefined){aC.push(aD.host.toString().toLowerCase().replace(az,n))}if(typeof aD.port==="number"){aC.push(":");aC.push(aD.port.toString(10))}}return aC.length?aC.join(""):undefined};ad.removeDotSegments=function(aD){var aC=[],aE;while(aD.length){if(aD.match(E)){aD=aD.replace(E,"")}else{if(aD.match(D)){aD=aD.replace(D,"/")}else{if(aD.match(B)){aD=aD.replace(B,"/");aC.pop()}else{if(aD==="."||aD===".."){aD=""}else{aE=aD.match(y)[0];aD=aD.slice(aE.length);aC.push(aE)}}}}}return aC.join("")};ad.serialize=function(aG,aC){var aE=[],aD,aF;aC=aC||{};aD=ad.SCHEMES[aG.scheme||aC.scheme];if(aD&&aD.serialize){aD.serialize(aG,aC)}if(aC.reference!=="suffix"&&aG.scheme){aE.push(aG.scheme.toString().toLowerCase().replace(am,""));aE.push(":")}aG.authority=ad._recomposeAuthority(aG);if(aG.authority!==undefined){if(aC.reference!=="suffix"){aE.push("//")}aE.push(aG.authority);if(aG.path&&aG.path.charAt(0)!=="/"){aE.push("/")}}if(aG.path){aF=ad.removeDotSegments(aG.path.toString().replace(/%2E/ig,"."));if(aG.scheme){aF=aF.replace(S,n)}else{aF=aF.replace(Z,n)}if(aG.authority===undefined){aF=aF.replace(/^\/\//,"/%2F")}aE.push(aF)}if(aG.query){aE.push("?");aE.push(aG.query.toString().replace(C,n))}if(aG.fragment){aE.push("#");aE.push(aG.fragment.toString().replace(K,n))}return aE.join("").replace(T,an).replace(/%[0-9A-Fa-f]{2}/g,function(aH){return aH.toUpperCase()})};ad.resolveComponents=function(aE,aD,aC,aG){var aF=new ag();if(!aG){aE=ad.parse(ad.serialize(aE,aC),aC);aD=ad.parse(ad.serialize(aD,aC),aC)}aC=aC||{};if(!aC.tolerant&&aD.scheme){aF.scheme=aD.scheme;aF.authority=aD.authority;aF.userinfo=aD.userinfo;aF.host=aD.host;aF.port=aD.port;aF.path=ad.removeDotSegments(aD.path);aF.query=aD.query}else{if(aD.authority!==undefined){aF.authority=aD.authority;aF.userinfo=aD.userinfo;aF.host=aD.host;aF.port=aD.port;aF.path=ad.removeDotSegments(aD.path);aF.query=aD.query}else{if(!aD.path){aF.path=aE.path;if(aD.query!==undefined){aF.query=aD.query}else{aF.query=aE.query}}else{if(aD.path.charAt(0)==="/"){aF.path=ad.removeDotSegments(aD.path)}else{if(aE.authority!==undefined&&!aE.path){aF.path="/"+aD.path}else{if(!aE.path){aF.path=aD.path}else{aF.path=aE.path.slice(0,aE.path.lastIndexOf("/")+1)+aD.path}}aF.path=ad.removeDotSegments(aF.path)}aF.query=aD.query}aF.authority=aE.authority;aF.userinfo=aE.userinfo;aF.host=aE.host;aF.port=aE.port}aF.scheme=aE.scheme}aF.fragment=aD.fragment;return aF};ad.resolve=function(aE,aD,aC){return ad.serialize(ad.resolveComponents(ad.parse(aE,aC),ad.parse(aD,aC),aC,true),aC)};ad.normalize=function(aD,aC){if(typeof aD==="string"){return ad.serialize(ad.parse(aD,aC),aC)}else{if(ae(aD)==="object"){return ad.parse(ad.serialize(aD,aC),aC)}}return aD};ad.equal=function(aE,aD,aC){if(typeof aE==="string"){aE=ad.serialize(ad.parse(aE,aC),aC)}else{if(ae(aE)==="object"){aE=ad.serialize(aE,aC)}}if(typeof aD==="string"){aD=ad.serialize(ad.parse(aD,aC),aC)}else{if(ae(aD)==="object"){aD=ad.serialize(aD,aC)}}return aE===aD};ad.escapeComponent=function(aC){return aC&&aC.toString().replace(V,n)};ad.unescapeComponent=function(aC){return aC&&aC.toString().replace(T,h)};exports.pctEncChar=n;exports.pctDecChars=h;exports.Components=ag;exports.URI=ad;exports.pctEncChar=n;exports.pctDecChars=h;exports.Components=ag;exports.URI={SCHEMES:ad.SCHEMES,parse:ad.parse,removeDotSegments:ad.removeDotSegments,serialize:ad.serialize,resolveComponents:ad.resolveComponents,resolve:ad.resolve,normalize:ad.normalize,equal:ad.equal,escapeComponent:ad.escapeComponent,unescapeComponent:ad.unescapeComponent}}());(function(){var n=require("../uri"),l=n.URI,p=n.pctEncChar,b="(?:[0-9A-Za-z][0-9A-Za-z\\-]{1,31})",e="(?:\\%[0-9A-Fa-f]{2})",f="[0-9A-Za-z\\(\\)\\+\\,\\-\\.\\:\\=\\@\\;\\$\\_\\!\\*\\'\\/\\?\\#]",a="(?:(?:"+e+"|"+f+")+)",m=new RegExp("^urn\\:("+b+")$"),g=new RegExp("^("+b+")\\:("+a+")$"),c=/^([^\:]+)\:(.*)/,h=/[\x00-\x20\\\"\&\<\>\[\]\^\`\{\|\}\~\x7F-\xFF]/g,o=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/;l.SCHEMES.urn={parse:function(t,r){var u=t.path.match(g),q,s;if(!u){if(!r.tolerant){t.errors.push("URN is not strictly valid.")}u=t.path.match(c)}if(u){q="urn:"+u[1].toLowerCase();s=l.SCHEMES[q];if(!s){s=l.SCHEMES[q]={}}if(!s.serialize){s.serialize=l.SCHEMES.urn.serialize}t.scheme=q;t.path=u[2];if(s.parse){s.parse(t,r)}}else{t.errors.push("URN can not be parsed.")}return t},serialize:function(s,r){var q=s.scheme||r.scheme,t;if(q&&q!=="urn"){var t=q.match(m);if(!t){t=["urn:"+q,q]}s.scheme="urn";s.path=t[1]+":"+(s.path?s.path.replace(h,p):"")}return s}};l.SCHEMES["urn:uuid"]={serialize:function(r,q){if(!q.tolerant&&(!r.path||!r.path.match(o))){r.scheme=undefined}return l.SCHEMES.urn.serialize(r,q)}}}());var exports=exports||this,require=require||function(){return exports};(function(){var m=require("./uri/uri").URI,f={},E="0123456789abcdef".split(""),o,s,D,h;function e(F){return F===undefined?"undefined":(F===null?"null":Object.prototype.toString.call(F).split(" ").pop().split("]").shift().toLowerCase())}function p(){}function x(F){p.prototype=F||{};return new p()}function b(J,I,H){var F={},G;for(G in J){if(J[G]!==f[G]){F[G]=I.call(H,J[G],G,J)}}return F}o=function(G,J,I){var F=0,K=G.length,H=new Array(K);for(;F<K;++F){H[F]=J.call(I,G[F],F,G)}return H};if(Array.prototype.map){o=function(F,H,G){return Array.prototype.map.call(F,H,G)}}s=function(G,J,I){var F=0,K=G.length,H=[];for(;F<K;++F){if(J.call(I,G[F],F,G)){H[H.length]=G[F]}}return H};if(Array.prototype.filter){s=function(F,H,G){return Array.prototype.filter.call(F,H,G)}}D=function(G,H){var F=0,I=G.length;for(;F<I;++F){if(G[F]===H){return F}}return -1};if(Array.prototype.indexOf){D=function(F,G){return Array.prototype.indexOf.call(F,G)}}function z(F){return F!==undefined&&F!==null?(F instanceof Array&&!F.callee?F:(typeof F.length!=="number"||F.split||F.setInterval||F.call?[F]:Array.prototype.slice.call(F))):[]}function r(H){var F=[],G;switch(e(H)){case"object":for(G in H){if(H[G]!==f[G]){F[F.length]=G}}break;case"array":for(G=H.length-1;G>=0;--G){F[G]=G}break}return F}function g(F,G){if(D(F,G)===-1){F.push(G)}return F}function t(F,H){var G=D(F,H);if(G>-1){F.splice(G,1)}return F}function y(){return[E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],"-",E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],"-4",E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],"-",E[(Math.floor(Math.random()*16)&3)|8],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],"-",E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)]].join("")}function B(F){return encodeURIComponent(F).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")}function a(F){if(typeof F==="string"&&F.indexOf("#")===-1){F+="#"}return F}function w(F){if(F instanceof A){return F.getURI()}switch(e(F)){case"undefined":case"null":case"boolean":case"number":case"string":return F;case"object":return b(F,w);case"array":return o(F,w);default:return F.toString()}}function c(G,J,F,I,H){Error.call(this,I);this.uri=G instanceof A?G.getURI():G;this.schemaUri=J instanceof A?J.getURI():J;this.attribute=F;this.message=I;this.description=I;this.details=H}c.prototype=new Error();c.prototype.constructor=c;c.prototype.name="InitializationError";function u(){this.errors=[];this.validated={}}u.prototype.addError=function(G,J,F,I,H){this.errors.push({uri:G instanceof A?G.getURI():G,schemaUri:J instanceof A?J.getURI():J,attribute:F,message:I,details:w(H)})};u.prototype.registerValidation=function(G,F){if(!this.validated[G]){this.validated[G]=[F]}else{this.validated[G].push(F)}};u.prototype.isValidatedBy=function(G,F){return !!this.validated[G]&&D(this.validated[G],F)!==-1};function A(H,G,I,F){if(G instanceof A){if(typeof F!=="string"){F=G._fd}if(typeof I!=="string"){I=G._uri}G=G._value}if(typeof I!=="string"){I="urn:uuid:"+y()+"#"}else{if(I.indexOf(":")===-1){I=a(m.resolve("urn:uuid:"+y()+"#",I))}}this._env=H;this._value=G;this._uri=I;this._fd=F||this._env._options.defaultFragmentDelimiter}A.prototype.getEnvironment=function(){return this._env};A.prototype.getType=function(){return e(this._value)};A.prototype.getValue=function(){return this._value};A.prototype.getURI=function(){return this._uri};A.prototype.resolveURI=function(F){return a(m.resolve(this._uri,F))};A.prototype.getPropertyNames=function(){return r(this._value)};A.prototype.getProperty=function(F){var G=this._value?this._value[F]:undefined;if(G instanceof A){return G}return new A(this._env,G,this._uri+this._fd+B(F),this._fd)};A.prototype.getProperties=function(){var G=e(this._value),F=this;if(G==="object"){return b(this._value,function(I,H){if(I instanceof A){return I}return new A(F._env,I,F._uri+F._fd+B(H),F._fd)})}else{if(G==="array"){return o(this._value,function(I,H){if(I instanceof A){return I}return new A(F._env,I,F._uri+F._fd+B(H),F._fd)})}}};A.prototype.getValueOfProperty=function(F){if(this._value){if(this._value[F] instanceof A){return this._value[F]._value}return this._value[F]}};A.prototype.equals=function(F){if(F instanceof A){return this._value===F._value}return this._value===F};function C(I,G){var H,F;if(I instanceof A){I=I.getValue()}switch(e(I)){case"object":if(G){H={};for(F in I){if(I[F]!==f[F]){H[F]=C(I[F],G)}}return H}else{return x(I)}break;case"array":if(G){H=new Array(I.length);F=I.length;while(--F>=0){H[F]=C(I[F],G)}return H}else{return Array.prototype.slice.call(I)}break;default:return I}}function v(H,G,J,I){var F;A.call(this,H,G,J);if(I===true){this._schema=this}else{if(G instanceof v&&!(I instanceof v)){this._schema=G._schema}else{this._schema=I instanceof v?I:this._env.getDefaultSchema()||this._env.createEmptySchema()}}F=this._schema.getValueOfProperty("fragmentResolution");if(F==="dot-delimited"){this._fd="."}else{if(F==="slash-delimited"){this._fd="/"}}return this.rebuild()}v.prototype=x(A.prototype);v.prototype.getSchema=function(){var F=this._refs&&this._refs.describedby,G;if(F){G=F&&this._env.findSchema(F);if(G){if(!G.equals(this._schema)){this._schema=G;this.rebuild()}}else{if(this._env._options.enforceReferences){throw new c(this,this._schema,"{describedby}","Unknown schema reference",F)}}}return this._schema};v.prototype.getAttribute=function(I,H){var G,L,K,F,J=this.getSchema();if(!H&&this._attributes&&this._attributes.hasOwnProperty(I)){return this._attributes[I]}G=J.getProperty("properties").getProperty(I);L=G.getValueOfProperty("parser");K=this.getProperty(I);if(typeof L==="function"){F=L(K,G,H);if(!H&&this._attributes){this._attributes[I]=F}return F}return K.getValue()};v.prototype.getAttributes=function(){var H,J,G,F,K,I=this.getSchema();if(!this._attributes&&this.getType()==="object"){H=this.getProperties();J=I.getProperty("properties");this._attributes={};for(G in H){if(H[G]!==f[G]){F=J&&J.getProperty(G);K=F&&F.getValueOfProperty("parser");if(typeof K==="function"){this._attributes[G]=K(H[G],F)}else{this._attributes[G]=H[G].getValue()}}}}return C(this._attributes,false)};v.prototype.getLink=function(G,F){var H=this.getAttribute("links",[G,F]);if(H&&H.length&&H[H.length-1]){return H[H.length-1]}};v.prototype.validate=function(F,H,K,L,I){var G=this.getSchema(),J=G.getValueOfProperty("validator");if(!(F instanceof A)){F=this.getEnvironment().createInstance(F)}if(!(H instanceof u)){H=new u()}if(this._env._options.validateReferences&&this._refs){if(this._refs.describedby&&!this._env.findSchema(this._refs.describedby)){H.addError(this,this._schema,"{describedby}","Unknown schema reference",this._refs.describedby)}if(this._refs.full&&!this._env.findSchema(this._refs.full)){H.addError(this,this._schema,"{full}","Unknown schema reference",this._refs.full)}}if(typeof J==="function"&&!H.isValidatedBy(F.getURI(),this.getURI())){H.registerValidation(F.getURI(),this.getURI());J(F,this,G,H,K,L,I)}return H};function l(G){return function F(){var I=this,H=[],K=I._refs&&I._refs.full,J;while(K){J=I._env.findSchema(K);if(J){if(J._value===I._value){break}I=J;H.push(K);K=I._refs&&I._refs.full;if(H.indexOf(K)>-1){break}}else{if(I._env._options.enforceReferences){throw new c(I,I._schema,"{full}","Unknown schema reference",K)}else{K=null}}}return G.apply(I,arguments)}}(function(){var F;for(F in v.prototype){if(v.prototype[F]!==f[F]&&e(v.prototype[F])==="function"){v.prototype[F]=l(v.prototype[F])}}}());v.prototype.rebuild=function(){var F=this,G=F.getSchema().getValueOfProperty("initializer");F._refs=null;F._attributes=null;if(typeof G==="function"){F=G(F)}F._env._schemas[F._uri]=F;F.getAttributes();return F};v.prototype.setReference=function(F,G){if(!this._refs){this._refs={}}this._refs[F]=this.resolveURI(G)};v.prototype.getReference=function(F){return this._refs&&this._refs[F]};function n(J,G,L){var I=e(J),H=e(G),K,F;if(H==="undefined"){return C(J,true)}else{if(I==="undefined"||H!==I){return C(G,true)}else{if(H==="object"){if(J instanceof v){J=J.getAttributes()}if(G instanceof v){G=G.getAttributes();if(G["extends"]&&L&&G["extends"] instanceof v){G["extends"]=[G["extends"]]}}K=C(J,true);for(F in G){if(G[F]!==f[F]){K[F]=n(J[F],G[F],L)}}return K}else{return C(G,true)}}}}function q(){this._id=y();this._schemas={};this._options={};this.createSchema({},true,"urn:jsv:empty-schema#")}q.prototype.clone=function(){var F=new q();F._schemas=x(this._schemas);F._options=x(this._options);return F};q.prototype.createInstance=function(G,F){F=a(F);if(G instanceof A&&(!F||G.getURI()===F)){return G}return new A(this,G,F)};q.prototype.createSchema=function(H,G,F){F=a(F);if(H instanceof v&&(!F||H._uri===F)&&(!G||H.getSchema().equals(G))){return H}return new v(this,H,F,G)};q.prototype.createEmptySchema=function(){return this._schemas["urn:jsv:empty-schema#"]};q.prototype.findSchema=function(F){return this._schemas[a(F)]};q.prototype.setOption=function(F,G){this._options[F]=G};q.prototype.getOption=function(F){return this._options[F]};q.prototype.setDefaultFragmentDelimiter=function(F){if(typeof F==="string"&&F.length>0){this._options.defaultFragmentDelimiter=F}};q.prototype.getDefaultFragmentDelimiter=function(){return this._options.defaultFragmentDelimiter};q.prototype.setDefaultSchemaURI=function(F){if(typeof F==="string"){this._options.defaultSchemaURI=a(F)}};q.prototype.getDefaultSchema=function(){return this.findSchema(this._options.defaultSchemaURI)};q.prototype.validate=function(M,L){var F,I,H,G=new u();try{F=this.createInstance(M);G.instance=F}catch(K){G.addError(K.uri,K.schemaUri,K.attribute,K.message,K.details)}try{I=this.createSchema(L);G.schema=I;H=I.getSchema();G.schemaSchema=H}catch(J){G.addError(J.uri,J.schemaUri,J.attribute,J.message,J.details)}if(H){H.validate(I,G)}if(G.errors.length){return G}return I.validate(F,G)};q.prototype._checkForInvalidInstances=function(L,H){var O=[],J=[[H,this._schemas[H]]],F=0,N,G,M,I,K;while(F++<L&&J.length){N=J.shift();G=N[0];M=N[1];if(M instanceof v){if(this._schemas[M._uri]!==M){O.push("Instance "+G+" does not match "+M._uri)}else{I=M.getAttributes();for(K in I){if(I[K]!==f[K]){J.push([G+"/"+B(K),I[K]])}}}}else{if(e(M)==="object"){I=M;for(K in I){if(I.hasOwnProperty(K)){J.push([G+"/"+B(K),I[K]])}}}else{if(e(M)==="array"){I=M;for(K=0;K<I.length;++K){J.push([G+"/"+B(K),I[K]])}}}}}return O.length?O:F};h={_environments:{},_defaultEnvironmentID:"",isJSONInstance:function(F){return F instanceof A},isJSONSchema:function(F){return F instanceof v},createEnvironment:function(F){F=F||this._defaultEnvironmentID;if(!this._environments[F]){throw new Error("Unknown Environment ID")}return this._environments[F].clone()},Environment:q,registerEnvironment:function(G,F){G=G||(F||0)._id;if(G&&!this._environments[G]&&F instanceof q){F._id=G;this._environments[G]=F}},setDefaultEnvironmentID:function(F){if(typeof F==="string"){if(!this._environments[F]){throw new Error("Unknown Environment ID")}this._defaultEnvironmentID=F}},getDefaultEnvironmentID:function(){return this._defaultEnvironmentID},typeOf:e,createObject:x,mapObject:b,mapArray:o,filterArray:s,searchArray:D,toArray:z,keys:r,pushUnique:g,popFirst:t,clone:C,randomUUID:y,escapeURIComponent:B,formatURI:a,inherits:n,InitializationError:c};this.JSV=h;exports.JSV=h;require("./environments")}());(function(){var n={},p=require("./jsv").JSV,G,w,l,A,m,f,c,z,o,B,q,e,b,y,r,D,s,a,F,v,t,g,x,E,C,u;G={string:function(H,I){return H.getType()==="string"},number:function(H,I){return H.getType()==="number"},integer:function(H,I){return H.getType()==="number"&&H.getValue()%1===0},"boolean":function(H,I){return H.getType()==="boolean"},object:function(H,I){return H.getType()==="object"},array:function(H,I){return H.getType()==="array"},"null":function(H,I){return H.getType()==="null"},any:function(H,I){return true}};w=new p.Environment();w.setOption("validateReferences",true);w.setOption("enforceReferences",false);w.setOption("strict",false);l={"$schema":"http://json-schema.org/draft-00/hyper-schema#",id:"http://json-schema.org/draft-00/schema#",type:"object",properties:{type:{type:["string","array"],items:{type:["string",{"$ref":"#"}]},optional:true,uniqueItems:true,"default":"any",parser:function(H,I){var J;if(H.getType()==="string"){return H.getValue()}else{if(H.getType()==="object"){return H.getEnvironment().createSchema(H,I.getEnvironment().findSchema(I.resolveURI("#")))}else{if(H.getType()==="array"){J=I.getValueOfProperty("parser");return p.mapArray(H.getProperties(),function(K){return J(K,I)})}}}return"any"},validator:function(R,K,S,M,Q,T,H){var I=p.toArray(K.getAttribute("type")),P,N,O,L,J;if(R.getType()!=="undefined"&&I&&I.length){J=S.getValueOfProperty("typeValidators")||{};for(P=0,N=I.length;P<N;++P){O=I[P];if(p.isJSONSchema(O)){L=p.createObject(M);L.errors=[];L.validated=p.clone(M.validated);if(O.validate(R,L,Q,T,H).errors.length===0){return true}}else{if(J[O]!==n[O]&&typeof J[O]==="function"){if(J[O](R,M)){return true}}else{return true}}}M.addError(R,K,"type","Instance is not a required type",I);return false}return true},typeValidators:G},properties:{type:"object",additionalProperties:{"$ref":"#"},optional:true,"default":{},parser:function(I,J,H){var K=I.getEnvironment(),L=J.getEnvironment();if(I.getType()==="object"){if(H){return K.createSchema(I.getProperty(H),L.findSchema(J.resolveURI("#")))}else{return p.mapObject(I.getProperties(),function(M){return K.createSchema(M,L.findSchema(J.resolveURI("#")))})}}return{}},validator:function(N,J,O,K,L,P,H){var I,M;if(N.getType()==="object"){I=J.getAttribute("properties");for(M in I){if(I[M]!==n[M]&&I[M]){I[M].validate(N.getProperty(M),K,N,J,M)}}}}},items:{type:[{"$ref":"#"},"array"],items:{"$ref":"#"},optional:true,"default":{},parser:function(H,I){if(H.getType()==="object"){return H.getEnvironment().createSchema(H,I.getEnvironment().findSchema(I.resolveURI("#")))}else{if(H.getType()==="array"){return p.mapArray(H.getProperties(),function(J){return J.getEnvironment().createSchema(J,I.getEnvironment().findSchema(I.resolveURI("#")))})}}return H.getEnvironment().createEmptySchema()},validator:function(R,I,S,J,Q,T,H){var N,M,P,K,O,L;if(R.getType()==="array"){N=R.getProperties();M=I.getAttribute("items");L=I.getAttribute("additionalProperties");if(p.typeOf(M)==="array"){for(P=0,K=N.length;P<K;++P){O=M[P]||L;if(O!==false){O.validate(N[P],J,R,I,P)}else{J.addError(R,I,"additionalProperties","Additional items are not allowed",O)}}}else{O=M||L;for(P=0,K=N.length;P<K;++P){O.validate(N[P],J,R,I,P)}}}}},optional:{type:"boolean",optional:true,"default":false,parser:function(H,I){return !!H.getValue()},validator:function(H,M,J,I,L,N,K){if(H.getType()==="undefined"&&!M.getAttribute("optional")){I.addError(H,M,"optional","Property is required",false)}},validationRequired:true},additionalProperties:{type:[{"$ref":"#"},"boolean"],optional:true,"default":{},parser:function(H,I){if(H.getType()==="object"){return H.getEnvironment().createSchema(H,I.getEnvironment().findSchema(I.resolveURI("#")))}else{if(H.getType()==="boolean"&&H.getValue()===false){return false}}return H.getEnvironment().createEmptySchema()},validator:function(P,J,Q,K,N,R,H){var L,I,M,O;if(P.getType()==="object"){L=J.getAttribute("additionalProperties");I=J.getAttribute("properties")||{};M=P.getProperties();for(O in M){if(M[O]!==n[O]&&M[O]&&I[O]===n[O]){if(p.isJSONSchema(L)){L.validate(M[O],K,P,J,O)}else{if(L===false){K.addError(P,J,"additionalProperties","Additional properties are not allowed",L)}}}}}}},requires:{type:["string",{"$ref":"#"}],optional:true,parser:function(H,I){if(H.getType()==="string"){return H.getValue()}else{if(H.getType()==="object"){return H.getEnvironment().createSchema(H,I.getEnvironment().findSchema(I.resolveURI("#")))}}},validator:function(H,N,J,I,M,O,K){var L;if(H.getType()!=="undefined"&&M&&M.getType()!=="undefined"){L=N.getAttribute("requires");if(typeof L==="string"){if(M.getProperty(L).getType()==="undefined"){I.addError(H,N,"requires",'Property requires sibling property "'+L+'"',L)}}else{if(p.isJSONSchema(L)){L.validate(M,I)}}}}},minimum:{type:"number",optional:true,parser:function(H,I){if(H.getType()==="number"){return H.getValue()}},validator:function(N,I,O,J,L,P,H){var K,M;if(N.getType()==="number"){K=I.getAttribute("minimum");M=I.getAttribute("minimumCanEqual");if(typeof K==="number"&&(N.getValue()<K||(M===false&&N.getValue()===K))){J.addError(N,I,"minimum","Number is less than the required minimum value",K)}}}},maximum:{type:"number",optional:true,parser:function(H,I){if(H.getType()==="number"){return H.getValue()}},validator:function(N,J,O,L,M,P,H){var I,K;if(N.getType()==="number"){I=J.getAttribute("maximum");K=J.getAttribute("maximumCanEqual");if(typeof I==="number"&&(N.getValue()>I||(K===false&&N.getValue()===I))){L.addError(N,J,"maximum","Number is greater than the required maximum value",I)}}}},minimumCanEqual:{type:"boolean",optional:true,requires:"minimum","default":true,parser:function(H,I){if(H.getType()==="boolean"){return H.getValue()}return true}},maximumCanEqual:{type:"boolean",optional:true,requires:"maximum","default":true,parser:function(H,I){if(H.getType()==="boolean"){return H.getValue()}return true}},minItems:{type:"integer",optional:true,minimum:0,"default":0,parser:function(H,I){if(H.getType()==="number"){return H.getValue()}return 0},validator:function(H,N,K,I,M,O,L){var J;if(H.getType()==="array"){J=N.getAttribute("minItems");if(typeof J==="number"&&H.getProperties().length<J){I.addError(H,N,"minItems","The number of items is less than the required minimum",J)}}}},maxItems:{type:"integer",optional:true,minimum:0,parser:function(H,I){if(H.getType()==="number"){return H.getValue()}},validator:function(H,N,J,I,M,O,L){var K;if(H.getType()==="array"){K=N.getAttribute("maxItems");if(typeof K==="number"&&H.getProperties().length>K){I.addError(H,N,"maxItems","The number of items is greater than the required maximum",K)}}}},pattern:{type:"string",optional:true,format:"regex",parser:function(H,I){if(H.getType()==="string"){return H.getValue()}},validator:function(N,I,O,J,M,P,H){var L;try{L=new RegExp(I.getAttribute("pattern"));if(N.getType()==="string"&&L&&!L.test(N.getValue())){J.addError(N,I,"pattern","String does not match pattern",L.toString())}}catch(K){J.addError(I,O,"pattern","Invalid pattern",I.getValueOfProperty("pattern"))}}},minLength:{type:"integer",optional:true,minimum:0,"default":0,parser:function(H,I){if(H.getType()==="number"){return H.getValue()}return 0},validator:function(H,N,K,I,M,O,L){var J;if(H.getType()==="string"){J=N.getAttribute("minLength");if(typeof J==="number"&&H.getValue().length<J){I.addError(H,N,"minLength","String is less than the required minimum length",J)}}}},maxLength:{type:"integer",optional:true,parser:function(H,I){if(H.getType()==="number"){return H.getValue()}},validator:function(H,N,K,J,M,O,L){var I;if(H.getType()==="string"){I=N.getAttribute("maxLength");if(typeof I==="number"&&H.getValue().length>I){J.addError(H,N,"maxLength","String is greater than the required maximum length",I)}}}},"enum":{type:"array",optional:true,minItems:1,uniqueItems:true,parser:function(H,I){if(H.getType()==="array"){return H.getValue()}},validator:function(O,J,P,K,N,Q,I){var H,M,L;if(O.getType()!=="undefined"){H=J.getAttribute("enum");if(H){for(M=0,L=H.length;M<L;++M){if(O.equals(H[M])){return true}}K.addError(O,J,"enum","Instance is not one of the possible values",H)}}}},title:{type:"string",optional:true},description:{type:"string",optional:true},format:{type:"string",optional:true,parser:function(H,I){if(H.getType()==="string"){return H.getValue()}},validator:function(N,I,O,J,L,P,H){var K,M;if(N.getType()==="string"){K=I.getAttribute("format");M=O.getValueOfProperty("formatValidators");if(typeof K==="string"&&M[K]!==n[K]&&typeof M[K]==="function"&&!M[K].call(this,N,J)){J.addError(N,I,"format","String is not in the required format",K)}}},formatValidators:{}},contentEncoding:{type:"string",optional:true},"default":{type:"any",optional:true},maxDecimal:{type:"integer",optional:true,minimum:0,parser:function(H,I){if(H.getType()==="number"){return H.getValue()}},validator:function(N,J,O,L,M,P,H){var K,I;if(N.getType()==="number"){K=J.getAttribute("maxDecimal");if(typeof K==="number"){I=N.getValue().toString(10).split(".")[1];if(I&&I.length>K){L.addError(N,J,"maxDecimal","The number of decimal places is greater than the allowed maximum",K)}}}}},disallow:{type:["string","array"],items:{type:"string"},optional:true,uniqueItems:true,parser:function(H,I){if(H.getType()==="string"||H.getType()==="array"){return H.getValue()}},validator:function(R,J,S,L,P,T,H){var N=p.toArray(J.getAttribute("disallow")),O,M,Q,I,K;if(R.getType()!=="undefined"&&N&&N.length){I=S.getValueOfProperty("typeValidators")||{};for(O=0,M=N.length;O<M;++O){Q=N[O];if(p.isJSONSchema(Q)){K=p.createObject(L);K.errors=[];K.validated=p.clone(L.validated);if(Q.validate(R,K,P,T,H).errors.length===0){L.addError(R,J,"disallow","Instance is a disallowed type",N);return false}}else{if(I[Q]!==n[Q]&&typeof I[Q]==="function"){if(I[Q](R,L)){L.addError(R,J,"disallow","Instance is a disallowed type",N);return false}}}}return true}return true},typeValidators:G},"extends":{type:[{"$ref":"#"},"array"],items:{"$ref":"#"},optional:true,"default":{},parser:function(H,I){if(H.getType()==="object"){return H.getEnvironment().createSchema(H,I.getEnvironment().findSchema(I.resolveURI("#")))}else{if(H.getType()==="array"){return p.mapArray(H.getProperties(),function(J){return J.getEnvironment().createSchema(J,I.getEnvironment().findSchema(I.resolveURI("#")))})}}},validator:function(O,I,P,J,N,Q,H){var L=I.getAttribute("extends"),M,K;if(L){if(p.isJSONSchema(L)){L.validate(O,J,N,Q,H)}else{if(p.typeOf(L)==="array"){for(M=0,K=L.length;M<K;++M){L[M].validate(O,J,N,Q,H)}}}}}}},optional:true,"default":{},fragmentResolution:"dot-delimited",parser:function(H,I){if(H.getType()==="object"){return H.getEnvironment().createSchema(H,I)}},validator:function(Q,J,R,K,P,S,I){var T=J.getPropertyNames(),O,L,M=R.getAttribute("properties"),N=Q.getEnvironment().getOption("strict"),H;for(O in M){if(M[O]!==n[O]){if(M[O].getValueOfProperty("validationRequired")){p.pushUnique(T,O)}if(N&&M[O].getValueOfProperty("deprecated")){p.popFirst(T,O)}}}for(O=0,L=T.length;O<L;++O){if(M[T[O]]!==n[T[O]]){H=M[T[O]].getValueOfProperty("validator");if(typeof H==="function"){H(Q,J,M[T[O]],K,P,S,I)}}}}};A={"$schema":"http://json-schema.org/draft-00/hyper-schema#",id:"http://json-schema.org/draft-00/hyper-schema#",properties:{links:{type:"array",items:{"$ref":"links#"},optional:true,parser:function(K,N,J){var M,I=N.getValueOfProperty("items")["$ref"],O=N.getEnvironment().findSchema(I),H=O&&O.getValueOfProperty("parser"),L;J=p.toArray(J);if(typeof H==="function"){M=p.mapArray(K.getProperties(),function(P){return H(P,O)})}else{M=p.toArray(K.getValue())}if(J[0]){M=p.filterArray(M,function(P){return P.rel===J[0]})}if(J[1]){L=N.getValueOfProperty("selfReferenceVariable");M=p.mapArray(M,function(R){var P=J[1],Q=R.href;Q=Q.replace(/\{(.+)\}/g,function(W,V,U,S){var T;if(V===L){T=P.getValue()}else{T=P.getValueOfProperty(V)}return T!==undefined?String(T):""});return Q?p.formatURI(P.resolveURI(Q)):Q})}return M},selfReferenceVariable:"-this"},fragmentResolution:{type:"string",optional:true,"default":"dot-delimited"},root:{type:"boolean",optional:true,"default":false},readonly:{type:"boolean",optional:true,"default":false},pathStart:{type:"string",optional:true,format:"uri",validator:function(H,M,J,I,L,O,K){var N;if(H.getType()!=="undefined"){N=M.getAttribute("pathStart");if(typeof N==="string"){if(H.getURI().indexOf(N)!==0){I.addError(H,M,"pathStart","Instance's URI does not start with "+N,N)}}}}},mediaType:{type:"string",optional:true,format:"media-type"},alternate:{type:"array",items:{"$ref":"#"},optional:true}},links:[{href:"{$ref}",rel:"full"},{href:"{$schema}",rel:"describedby"},{href:"{id}",rel:"self"}],initializer:function(I){var J,K,H;J=I._schema.getLink("describedby",I);if(J&&I._schema._uri!==J){I.setReference("describedby",J)}J=I._schema.getLink("self",I);if(p.typeOf(J)==="string"){I._uri=p.formatURI(J)}J=I._schema.getLink("full",I);if(J&&I._uri!==J){I.setReference("full",J)}K=I.getAttribute("extends");if(p.isJSONSchema(K)){H=p.inherits(K,I,true);I=I._env.createSchema(H,I._schema,I._uri)}return I}};m={"$schema":"http://json-schema.org/draft-00/hyper-schema#",id:"http://json-schema.org/draft-00/links#",type:"object",properties:{href:{type:"string"},rel:{type:"string"},method:{type:"string","default":"GET",optional:true},enctype:{type:"string",requires:"method",optional:true},properties:{type:"object",additionalProperties:{"$ref":"hyper-schema#"},optional:true,parser:function(J,K,I){var L=J.getEnvironment(),M=K.getEnvironment(),H=K.getValueOfProperty("additionalProperties")["$ref"];if(J.getType()==="object"){if(I){return L.createSchema(J.getProperty(I),M.findSchema(K.resolveURI(H)))}else{return p.mapObject(J.getProperties(),function(N){return L.createSchema(N,M.findSchema(K.resolveURI(H)))})}}}}},parser:function(H,J){var I=J.getProperty("properties");if(H.getType()==="object"){return p.mapObject(H.getProperties(),function(M,L){var K=I.getProperty(L),N=K&&K.getValueOfProperty("parser");if(typeof N==="function"){return N(M,K)}return M.getValue()})}return H.getValue()}};w.setOption("defaultFragmentDelimiter",".");w.setOption("defaultSchemaURI","http://json-schema.org/draft-00/schema#");f=w.createSchema(l,true,"http://json-schema.org/draft-00/schema#");c=w.createSchema(p.inherits(f,w.createSchema(A,true,"http://json-schema.org/draft-00/hyper-schema#"),true),true,"http://json-schema.org/draft-00/hyper-schema#");w.setOption("defaultSchemaURI","http://json-schema.org/draft-00/hyper-schema#");z=w.createSchema(m,c,"http://json-schema.org/draft-00/links#");o=p.inherits(l,{"$schema":"http://json-schema.org/draft-01/hyper-schema#",id:"http://json-schema.org/draft-01/schema#"});B=p.inherits(A,{"$schema":"http://json-schema.org/draft-01/hyper-schema#",id:"http://json-schema.org/draft-01/hyper-schema#"});q=p.inherits(m,{"$schema":"http://json-schema.org/draft-01/hyper-schema#",id:"http://json-schema.org/draft-01/links#"});w.setOption("defaultSchemaURI","http://json-schema.org/draft-01/schema#");e=w.createSchema(o,true,"http://json-schema.org/draft-01/schema#");b=w.createSchema(p.inherits(e,w.createSchema(B,true,"http://json-schema.org/draft-01/hyper-schema#"),true),true,"http://json-schema.org/draft-01/hyper-schema#");w.setOption("defaultSchemaURI","http://json-schema.org/draft-01/hyper-schema#");y=w.createSchema(q,b,"http://json-schema.org/draft-01/links#");r=p.inherits(o,{"$schema":"http://json-schema.org/draft-02/hyper-schema#",id:"http://json-schema.org/draft-02/schema#",properties:{uniqueItems:{type:"boolean",optional:true,"default":false,parser:function(H,I){return !!H.getValue()},validator:function(Q,J,R,K,P,S,H){var O,N,L,M,I;if(Q.getType()==="array"&&J.getAttribute("uniqueItems")){O=Q.getProperties();for(N=0,L=O.length-1;N<L;++N){for(M=N+1,I=O.length;M<I;++M){if(O[N].equals(O[M])){K.addError(Q,J,"uniqueItems","Array can only contain unique items",{x:N,y:M})}}}}}},maxDecimal:{deprecated:true},divisibleBy:{type:"number",minimum:0,minimumCanEqual:false,optional:true,parser:function(H,I){if(H.getType()==="number"){return H.getValue()}},validator:function(O,K,P,L,N,Q,H){var J,M,I;if(O.getType()==="number"){J=K.getAttribute("divisibleBy");if(J===0){L.addError(O,K,"divisibleBy","Nothing is divisible by 0",J)}else{if(J!==1){M=O.getValue();I=Math.max((M.toString().split(".")[1]||" ").length,(J.toString().split(".")[1]||" ").length);I=parseFloat(((M/J)%1).toFixed(I));if(0<I&&I<1){L.addError(O,K,"divisibleBy","Number is not divisible by "+J,J)}}}}}}},fragmentResolution:"slash-delimited"});D=p.inherits(B,{id:"http://json-schema.org/draft-02/hyper-schema#",properties:{fragmentResolution:{"default":"slash-delimited"}}});s=p.inherits(q,{"$schema":"http://json-schema.org/draft-02/hyper-schema#",id:"http://json-schema.org/draft-02/links#",properties:{targetSchema:{"$ref":"hyper-schema#",parser:b.getAttribute("parser")}}});w.setOption("defaultFragmentDelimiter","/");w.setOption("defaultSchemaURI","http://json-schema.org/draft-02/schema#");a=w.createSchema(r,true,"http://json-schema.org/draft-02/schema#");F=w.createSchema(p.inherits(a,w.createSchema(D,true,"http://json-schema.org/draft-02/hyper-schema#"),true),true,"http://json-schema.org/draft-02/hyper-schema#");w.setOption("defaultSchemaURI","http://json-schema.org/draft-02/hyper-schema#");v=w.createSchema(s,F,"http://json-schema.org/draft-02/links#");function h(Q,H,I,R){var J={},O,M,N,L,P;if(Q.getType()==="object"){O=H.getAttribute("patternProperties");L=Q.getProperties();for(M in O){if(O[M]!==n[M]){N=null;try{N=new RegExp(M)}catch(K){if(I){I.addError(H,R,"patternProperties","Invalid pattern",M)}}if(N){for(P in L){if(L[P]!==n[P]&&N.test(P)){J[P]=J[P]?p.pushUnique(J[P],O[M]):[O[M]]}}}}}}return J}t=p.inherits(r,{"$schema":"http://json-schema.org/draft-03/schema#",id:"http://json-schema.org/draft-03/schema#",properties:{patternProperties:{type:"object",additionalProperties:{"$ref":"#"},"default":{},parser:a.getValueOfProperty("properties")["properties"]["parser"],validator:function(O,I,P,J,M,Q,H){var K,N,L;if(O.getType()==="object"){K=h(O,I,J,P);for(N in K){if(K[N]!==n[N]){L=K[N].length;while(L--){K[N][L].validate(O.getProperty(N),J,O,I,N)}}}}}},additionalProperties:{validator:function(Q,J,R,K,O,S,H){var M,I,N,L,P;if(Q.getType()==="object"){M=J.getAttribute("additionalProperties");I=J.getAttribute("properties")||{};N=Q.getProperties();L=h(Q,J);for(P in N){if(N[P]!==n[P]&&N[P]&&I[P]===n[P]&&L[P]===n[P]){if(p.isJSONSchema(M)){M.validate(N[P],K,Q,J,P)}else{if(M===false){K.addError(Q,J,"additionalProperties","Additional properties are not allowed",M)}}}}}}},items:{validator:function(R,J,S,K,Q,T,I){var N,M,P,L,O,H;if(R.getType()==="array"){N=R.getProperties();M=J.getAttribute("items");H=J.getAttribute("additionalItems");if(p.typeOf(M)==="array"){for(P=0,L=N.length;P<L;++P){O=M[P]||H;if(O!==false){O.validate(N[P],K,R,J,P)}else{K.addError(R,J,"additionalItems","Additional items are not allowed",O)}}}else{O=M||H;for(P=0,L=N.length;P<L;++P){O.validate(N[P],K,R,J,P)}}}}},additionalItems:{type:[{"$ref":"#"},"boolean"],"default":{},parser:a.getValueOfProperty("properties")["additionalProperties"]["parser"],validator:function(P,J,Q,K,O,R,I){var H,M,N,L;if(P.getType()==="array"&&J.getProperty("items").getType()==="undefined"){H=J.getAttribute("additionalItems");M=P.getProperties();if(H!==false){for(N=0,L=M.length;N<L;++N){H.validate(M[N],K,P,J,N)}}else{if(M.length){K.addError(P,J,"additionalItems","Additional items are not allowed",H)}}}}},optional:{validationRequired:false,deprecated:true},required:{type:"boolean","default":false,parser:function(H,I){return !!H.getValue()},validator:function(H,M,J,I,L,N,K){if(H.getType()==="undefined"&&M.getAttribute("required")){I.addError(H,M,"required","Property is required",true)}}},requires:{deprecated:true},dependencies:{type:"object",additionalProperties:{type:["string","array",{"$ref":"#"}],items:{type:"string"}},"default":{},parser:function(I,J,H){function K(M){var L=M.getType();if(L==="string"||L==="array"){return M.getValue()}else{if(L==="object"){return M.getEnvironment().createSchema(M,J.getEnvironment().findSchema(J.resolveURI("#")))}}}if(I.getType()==="object"){if(H){return K(I.getProperty(H))}else{return p.mapObject(I.getProperties(),K)}}return{}},validator:function(R,J,S,K,P,T,H){var M,Q,I,N,O,L;if(R.getType()==="object"){M=J.getAttribute("dependencies");for(Q in M){if(M[Q]!==n[Q]&&R.getProperty(Q).getType()!=="undefined"){I=M[Q];N=p.typeOf(I);if(N==="string"){if(R.getProperty(I).getType()==="undefined"){K.addError(R,J,"dependencies",'Property "'+Q+'" requires sibling property "'+I+'"',M)}}else{if(N==="array"){for(O=0,L=I.length;O<L;++O){if(R.getProperty(I[O]).getType()==="undefined"){K.addError(R,J,"dependencies",'Property "'+Q+'" requires sibling property "'+I[O]+'"',M)}}}else{if(p.isJSONSchema(I)){I.validate(R,K)}}}}}}}},minimumCanEqual:{deprecated:true},maximumCanEqual:{deprecated:true},exclusiveMinimum:{type:"boolean","default":false,parser:function(H,I){return !!H.getValue()}},exclusiveMaximum:{type:"boolean","default":false,parser:function(H,I){return !!H.getValue()}},minimum:{validator:function(N,I,O,J,M,P,H){var K,L;if(N.getType()==="number"){K=I.getAttribute("minimum");L=I.getAttribute("exclusiveMinimum")||(!N.getEnvironment().getOption("strict")&&!I.getAttribute("minimumCanEqual"));if(typeof K==="number"&&(N.getValue()<K||(L===true&&N.getValue()===K))){J.addError(N,I,"minimum","Number is less than the required minimum value",K)}}}},maximum:{validator:function(N,J,O,K,M,P,H){var I,L;if(N.getType()==="number"){I=J.getAttribute("maximum");L=J.getAttribute("exclusiveMaximum")||(!N.getEnvironment().getOption("strict")&&!J.getAttribute("maximumCanEqual"));if(typeof I==="number"&&(N.getValue()>I||(L===true&&N.getValue()===I))){K.addError(N,J,"maximum","Number is greater than the required maximum value",I)}}}},contentEncoding:{deprecated:true},divisibleBy:{exclusiveMinimum:true},disallow:{items:{type:["string",{"$ref":"#"}]},parser:r.properties["type"]["parser"]},id:{type:"string",format:"uri"},"$ref":{type:"string",format:"uri"},"$schema":{type:"string",format:"uri"}},dependencies:{exclusiveMinimum:"minimum",exclusiveMaximum:"maximum"},initializer:function(I){var M,N,H,K=I.getValueOfProperty("$schema"),J=I.getValueOfProperty("$ref"),L=I.getValueOfProperty("id");if(K){M=I.resolveURI(K);I.setReference("describedby",M)}if(L){M=I.resolveURI(L);if(p.typeOf(M)==="string"){I._uri=p.formatURI(M)}}if(J){M=I.resolveURI(J);I.setReference("full",M)}N=I.getAttribute("extends");if(p.isJSONSchema(N)){H=p.inherits(N,I,true);I=I._env.createSchema(H,I._schema,I._uri)}return I}});g=p.inherits(D,{"$schema":"http://json-schema.org/draft-03/hyper-schema#",id:"http://json-schema.org/draft-03/hyper-schema#",properties:{links:{selfReferenceVariable:"@"},root:{deprecated:true},contentEncoding:{deprecated:false},alternate:{deprecated:true}}});x=p.inherits(s,{"$schema":"http://json-schema.org/draft-03/hyper-schema#",id:"http://json-schema.org/draft-03/links#",properties:{href:{required:true,format:"link-description-object-template"},rel:{required:true},properties:{deprecated:true},schema:{"$ref":"http://json-schema.org/draft-03/hyper-schema#"}}});w.setOption("defaultSchemaURI","http://json-schema.org/draft-03/schema#");E=w.createSchema(t,true,"http://json-schema.org/draft-03/schema#");C=w.createSchema(p.inherits(E,w.createSchema(g,true,"http://json-schema.org/draft-03/hyper-schema#"),true),true,"http://json-schema.org/draft-03/hyper-schema#");w.setOption("defaultSchemaURI","http://json-schema.org/draft-03/hyper-schema#");u=w.createSchema(x,true,"http://json-schema.org/draft-03/links#");w.setOption("latestJSONSchemaSchemaURI","http://json-schema.org/draft-03/schema#");w.setOption("latestJSONSchemaHyperSchemaURI","http://json-schema.org/draft-03/hyper-schema#");w.setOption("latestJSONSchemaLinksURI","http://json-schema.org/draft-03/links#");w._schemas["http://json-schema.org/schema#"]=E;w._schemas["http://json-schema.org/hyper-schema#"]=C;w._schemas["http://json-schema.org/links#"]=u;p.registerEnvironment("json-schema-draft-03",w);if(!p.getDefaultEnvironmentID()||p.getDefaultEnvironmentID()==="json-schema-draft-01"||p.getDefaultEnvironmentID()==="json-schema-draft-02"){p.setDefaultEnvironmentID("json-schema-draft-03")}}());(function(g){var p,C="",w=Math.PI,l=w/2,n="ontouchstart" in window,c=(n)?{start:"touchstart",move:"touchmove",end:"touchend"}:{start:"mousedown",move:"mousemove",end:"mouseup"},x={backward:["bl","tl"],forward:["br","tr"],all:["tl","bl","tr","br"]},m=["single","double"],f={page:1,gradients:true,duration:600,acceleration:true,display:"double",when:null},a={folding:null,corners:"forward",cornerSize:100,gradients:true,duration:600,acceleration:true},B=6,v={0:{top:0,left:0,right:"auto",bottom:"auto"},1:{top:0,right:0,left:"auto",bottom:"auto"}},t=function(G,F,H,E){return{css:{position:"absolute",top:G,left:F,overflow:E||"hidden","z-index":H||"auto"}}},r=function(K,J,I,H,G){var E=1-G,F=E*E*E,L=G*G*G;return h(Math.round(F*K.x+3*G*E*E*J.x+3*G*G*E*I.x+L*H.x),Math.round(F*K.y+3*G*E*E*J.y+3*G*G*E*I.y+L*H.y))},D=function(E){return E/180*w},s=function(E){return E/w*180},h=function(E,F){return{x:E,y:F}},q=function(E,G,F){return(p&&F)?" translate3d("+E+"px,"+G+"px, 0px) ":" translate("+E+"px, "+G+"px) "},z=function(E){return" rotate("+E+"deg) "},e=function(F,E){return Object.prototype.hasOwnProperty.call(E,F)},u=function(){var F=["Moz","Webkit","Khtml","O","ms"],E=F.length,G="";while(E--){if((F[E]+"Transform") in document.body.style){G="-"+F[E].toLowerCase()+"-"}}return G},b=function(Q,G,F,L,R){var U,O=[];if(C=="-webkit-"){for(U=0;U<R;U++){O.push("color-stop("+L[U][0]+", "+L[U][1]+")")}Q.css({"background-image":"-webkit-gradient(linear, "+G.x+"% "+G.y+"%,  "+F.x+"% "+F.y+"%, "+O.join(",")+" )"})}else{G={x:G.x/100*Q.width(),y:G.y/100*Q.height()};F={x:F.x/100*Q.width(),y:F.y/100*Q.height()};var P=F.x-G.x,N=F.y-G.y,V=Math.atan2(N,P),H=V-Math.PI/2,T=Math.abs(Q.width()*Math.sin(H))+Math.abs(Q.height()*Math.cos(H)),E=Math.sqrt(N*N+P*P),J=h((F.x<G.x)?Q.width():0,(F.y<G.y)?Q.height():0),K=Math.tan(V),I=-1/K,M=(I*J.x-J.y-K*G.x+G.y)/(I-K),W={x:M,y:I*M-I*J.x+J.y},S=(Math.sqrt(Math.pow(W.x-G.x,2)+Math.pow(W.y-G.y,2)));for(U=0;U<R;U++){O.push(" "+L[U][1]+" "+((S+E*L[U][0])*100/T)+"%")}Q.css({"background-image":C+"linear-gradient("+(-V)+"rad,"+O.join(",")+")"})}},A={init:function(G){if(p===undefined){p="WebKitCSSMatrix" in window||"MozPerspective" in document.body.style;C=u()}var E,H=this.data(),F=this.children();G=g.extend({width:this.width(),height:this.height()},f,G);H.opts=G;H.pageObjs={};H.pages={};H.pageWrap={};H.pagePlace={};H.pageMv=[];H.totalPages=G.pages||0;if(G.when){for(E in G.when){if(e(E,G.when)){this.bind(E,G.when[E])}}}this.css({position:"relative",width:G.width,height:G.height});this.turn("display",G.display);if(p&&!n&&G.acceleration){this.transform(q(0,0,true))}for(E=0;E<F.length;E++){this.turn("addPage",F[E],E+1)}this.turn("page",G.page);x=g.extend({},x,G.corners);g(this).bind(c.start,function(J){for(var I in H.pages){if(e(I,H.pages)&&y._eventStart.call(H.pages[I],J)===false){return false}}});g(document).bind(c.move,function(J){for(var I in H.pages){if(e(I,H.pages)){y._eventMove.call(H.pages[I],J)}}}).bind(c.end,function(J){for(var I in H.pages){if(e(I,H.pages)){y._eventEnd.call(H.pages[I],J)}}});H.done=true;return this},addPage:function(E,I){var F=false,H=this.data(),G=H.totalPages+1;if(I){if(I==G){I=G;F=true}else{if(I>G){throw new Error('It is impossible to add the page "'+I+'", the maximum value is: "'+G+'"')}}}else{I=G;F=true}if(I>=1&&I<=G){if(H.done){this.turn("stop")}if(I in H.pageObjs){A._movePages.call(this,I,1)}if(F){H.totalPages=G}H.pageObjs[I]=g(E).addClass("turn-page p"+I);A._addPage.call(this,I);if(H.done){this.turn("update")}A._removeFromDOM.call(this)}return this},_addPage:function(I){var H=this.data(),F=H.pageObjs[I];if(F){if(A._necessPage.call(this,I)){if(!H.pageWrap[I]){var E=(H.display=="double")?this.width()/2:this.width(),G=this.height();F.css({width:E,height:G});H.pagePlace[I]=I;H.pageWrap[I]=g("<div/>",{"class":"turn-page-wrapper",page:I,css:{position:"absolute",overflow:"hidden",width:E,height:G}}).css(v[(H.display=="double")?I%2:0]);this.append(H.pageWrap[I]);H.pageWrap[I].prepend(H.pageObjs[I])}if(!I||A._setPageLoc.call(this,I)==1){A._makeFlip.call(this,I)}}else{H.pagePlace[I]=0;if(H.pageObjs[I]){H.pageObjs[I].remove()}}}},hasPage:function(E){return E in this.data().pageObjs},_makeFlip:function(F){var E=this.data();if(!E.pages[F]&&E.pagePlace[F]==F){var H=E.display=="single",G=F%2;E.pages[F]=E.pageObjs[F].css({width:(H)?this.width():this.width()/2,height:this.height()}).flip({page:F,next:(H&&F===E.totalPages)?F-1:((G||H)?F+1:F-1),turn:this,duration:E.opts.duration,acceleration:E.opts.acceleration,corners:(H)?"all":((G)?"forward":"backward"),backGradient:E.opts.gradients,frontGradient:E.opts.gradients}).flip("disable",E.disabled).bind("pressed",A._pressed).bind("released",A._released).bind("start",A._start).bind("end",A._end).bind("flip",A._flip)}return E.pages[F]},_makeRange:function(){var G,F=this.data(),E=this.turn("range");for(G=E[0];G<=E[1];G++){A._addPage.call(this,G)}},range:function(I){var E,J,G,H=this.data();I=I||H.tpage||H.page;var F=A._view.call(this,I);if(I<1||I>H.totalPages){throw new Error('"'+I+'" is not a page for range')}F[1]=F[1]||F[0];if(F[0]>=1&&F[1]<=H.totalPages){E=Math.floor((B-2)/2);if(H.totalPages-F[1]>F[0]){J=Math.min(F[0]-1,E);G=2*E-J}else{G=Math.min(H.totalPages-F[1],E);J=2*E-G}}else{J=B-1;G=B-1}return[Math.max(1,F[0]-J),Math.min(H.totalPages,F[1]+G)]},_necessPage:function(F){if(F===0){return true}var E=this.turn("range");return F>=E[0]&&F<=E[1]},_removeFromDOM:function(){var F,E=this.data();for(F in E.pageWrap){if(e(F,E.pageWrap)&&!A._necessPage.call(this,F)){A._removePageFromDOM.call(this,F)}}},_removePageFromDOM:function(G){var F=this.data();if(F.pages[G]){var E=F.pages[G].data();if(E.f&&E.f.fwrapper){E.f.fwrapper.remove()}F.pages[G].remove();delete F.pages[G]}if(F.pageObjs[G]){F.pageObjs[G].remove()}if(F.pageWrap[G]){F.pageWrap[G].remove();delete F.pageWrap[G]}delete F.pagePlace[G]},removePage:function(F){var E=this.data();if(E.pageObjs[F]){this.turn("stop");A._removePageFromDOM.call(this,F);delete E.pageObjs[F];A._movePages.call(this,F,-1);E.totalPages=E.totalPages-1;A._makeRange.call(this);if(E.page>E.totalPages){this.turn("page",E.totalPages)}}return this},_movePages:function(J,I){var G,F=this.data(),H=F.display=="single",E=function(M){var K=M+I,L=K%2;if(F.pageObjs[M]){F.pageObjs[K]=F.pageObjs[M].removeClass("page"+M).addClass("page"+K)}if(F.pagePlace[M]&&F.pageWrap[M]){F.pagePlace[K]=K;F.pageWrap[K]=F.pageWrap[M].css(v[(H)?0:L]).attr("page",K);if(F.pages[M]){F.pages[K]=F.pages[M].flip("options",{page:K,next:(H||L)?K+1:K-1,corners:(H)?"all":((L)?"forward":"backward")})}if(I){delete F.pages[M];delete F.pagePlace[M];delete F.pageObjs[M];delete F.pageWrap[M];delete F.pageObjs[M]}}};if(I>0){for(G=F.totalPages;G>=J;G--){E(G)}}else{for(G=J;G<=F.totalPages;G++){E(G)}}},display:function(G){var F=this.data(),H=F.display;if(G){if(g.inArray(G,m)==-1){throw new Error('"'+G+'" is not a value for display')}if(G=="single"){if(!F.pageObjs[0]){this.turn("stop").css({overflow:"hidden"});F.pageObjs[0]=g("<div />",{"class":"turn-page p-temporal"}).css({width:this.width(),height:this.height()}).appendTo(this)}}else{if(F.pageObjs[0]){this.turn("stop").css({overflow:""});F.pageObjs[0].remove();delete F.pageObjs[0]}}F.display=G;if(H){var E=this.turn("size");A._movePages.call(this,1,0);this.turn("size",E.width,E.height).turn("update")}return this}else{return H}},animating:function(){return this.data().pageMv.length>0},disable:function(F){var H,G=this.data(),E=this.turn("view");G.disabled=F===undefined||F===true;for(H in G.pages){if(e(H,G.pages)){G.pages[H].flip("disable",F?g.inArray(H,E):false)}}return this},size:function(G,E){if(G&&E){var I=this.data(),F=(I.display=="double")?G/2:G,H;this.css({width:G,height:E});if(I.pageObjs[0]){I.pageObjs[0].css({width:F,height:E})}for(H in I.pageWrap){if(!e(H,I.pageWrap)){continue}I.pageObjs[H].css({width:F,height:E});I.pageWrap[H].css({width:F,height:E});if(I.pages[H]){I.pages[H].css({width:F,height:E})}}this.turn("resize");return this}else{return{width:this.width(),height:this.height()}}},resize:function(){var F,E=this.data();if(E.pages[0]){E.pageWrap[0].css({left:-this.width()});E.pages[0].flip("resize",true)}for(F=1;F<=E.totalPages;F++){if(E.pages[F]){E.pages[F].flip("resize",true)}}},_removeMv:function(G){var E,F=this.data();for(E=0;E<F.pageMv.length;E++){if(F.pageMv[E]==G){F.pageMv.splice(E,1);return true}}return false},_addMv:function(F){var E=this.data();A._removeMv.call(this,F);E.pageMv.push(F)},_view:function(F){var E=this.data();F=F||E.page;if(E.display=="double"){return(F%2)?[F-1,F]:[F,F+1]}else{return[F]}},view:function(G){var F=this.data(),E=A._view.call(this,G);return(F.display=="double")?[(E[0]>0)?E[0]:0,(E[1]<=F.totalPages)?E[1]:0]:[(E[0]>0&&E[0]<=F.totalPages)?E[0]:0]},stop:function(G){var F,H,I=this.data(),E=I.pageMv;I.pageMv=[];if(I.tpage){I.page=I.tpage;delete I.tpage}for(F in E){if(!e(F,E)){continue}H=I.pages[E[F]].data().f.opts;y._moveFoldingPage.call(I.pages[E[F]],null);I.pages[E[F]].flip("hideFoldedPage");I.pagePlace[H.next]=H.next;if(H.force){H.next=(H.page%2===0)?H.page-1:H.page+1;delete H.force}}this.turn("update");return this},pages:function(E){var G=this.data();if(E){if(E<G.totalPages){for(var F=E+1;F<=G.totalPages;F++){this.turn("removePage",F)}if(this.turn("page")>E){this.turn("page",E)}}G.totalPages=E;return this}else{return G.totalPages}},_fitPage:function(G,E){var F=this.data(),H=this.turn("view",G);if(F.page!=G){this.trigger("turning",[G,H]);if(g.inArray(1,H)!=-1){this.trigger("first")}if(g.inArray(F.totalPages,H)!=-1){this.trigger("last")}}if(!F.pageObjs[G]){return}F.tpage=G;this.turn("stop",E);A._removeFromDOM.call(this);A._makeRange.call(this);this.trigger("turned",[G,H])},_turnPage:function(I){var J,F,H=this.data(),E=this.turn("view"),K=this.turn("view",I);if(H.page!=I){this.trigger("turning",[I,K]);if(g.inArray(1,K)!=-1){this.trigger("first")}if(g.inArray(H.totalPages,K)!=-1){this.trigger("last")}}if(!H.pageObjs[I]){return}H.tpage=I;this.turn("stop");A._makeRange.call(this);if(H.display=="single"){J=E[0];F=K[0]}else{if(E[1]&&I>E[1]){J=E[1];F=K[0]}else{if(E[0]&&I<E[0]){J=E[0];F=K[1]}}}if(H.pages[J]){var G=H.pages[J].data().f.opts;H.tpage=F;if(G.next!=F){G.next=F;H.pagePlace[F]=G.page;G.force=true}if(H.display=="single"){H.pages[J].flip("turnPage",(K[0]>E[0])?"br":"bl")}else{H.pages[J].flip("turnPage")}}},page:function(F){F=parseInt(F,10);var E=this.data();if(F>0&&F<=E.totalPages){if(!E.done||g.inArray(F,this.turn("view"))!=-1){A._fitPage.call(this,F)}else{A._turnPage.call(this,F)}return this}else{return E.page}},next:function(){var E=this.data();return this.turn("page",A._view.call(this,E.page).pop()+1)},previous:function(){var E=this.data();return this.turn("page",A._view.call(this,E.page).shift()-1)},_addMotionPage:function(){var G=g(this).data().f.opts,F=G.turn,E=F.data();G.pageMv=G.page;A._addMv.call(F,G.pageMv);E.pagePlace[G.next]=G.page;F.turn("update")},_start:function(J,G,F){var H=G.turn.data(),E=g.Event("start");J.stopPropagation();G.turn.trigger(E,[G,F]);if(E.isDefaultPrevented()){J.preventDefault();return}if(H.display=="single"){var I=F.charAt(1)=="l";if((G.page==1&&I)||(G.page==H.totalPages&&!I)){J.preventDefault()}else{if(I){G.next=(G.next<G.page)?G.next:G.page-1;G.force=true}else{G.next=(G.next>G.page)?G.next:G.page+1}}}A._addMotionPage.call(this)},_end:function(K,I){var H=g(this),J=H.data().f,G=J.opts,F=G.turn,E=F.data();K.stopPropagation();if(I||E.tpage){if(E.tpage==G.next||E.tpage==G.page){delete E.tpage;A._fitPage.call(F,E.tpage||G.next,true)}}else{A._removeMv.call(F,G.pageMv);F.turn("update")}},_pressed:function(){var I,G=g(this),H=G.data().f,F=H.opts.turn,E=F.data().pages;for(I in E){if(I!=H.opts.page){E[I].flip("disable",true)}}return H.time=new Date().getTime()},_released:function(H,E){var F=g(this),G=F.data().f;H.stopPropagation();if((new Date().getTime())-G.time<200||E.x<0||E.x>g(this).width()){H.preventDefault();G.opts.turn.data().tpage=G.opts.next;G.opts.turn.turn("update");g(F).flip("turnPage")}},_flip:function(){var E=g(this).data().f.opts;E.turn.trigger("turn",[E.next])},calculateZ:function(P){var H,K,N,F,O,J=this,G=this.data(),M=this.turn("view"),I=M[0]||M[1],E={pageZ:{},partZ:{},pageV:{}},L=function(R){var Q=J.turn("view",R);if(Q[0]){E.pageV[Q[0]]=true}if(Q[1]){E.pageV[Q[1]]=true}};for(H=0;H<P.length;H++){K=P[H];N=G.pages[K].data().f.opts.next;F=G.pagePlace[K];L(K);L(N);O=(G.pagePlace[N]==N)?N:K;E.pageZ[O]=G.totalPages-Math.abs(I-O);E.partZ[F]=G.totalPages*2+Math.abs(I-O)}return E},update:function(){var I,H=this.data();if(H.pageMv.length&&H.pageMv[0]!==0){var G,J=this.turn("calculateZ",H.pageMv),F=this.turn("view",H.tpage);if(H.pagePlace[F[0]]==F[0]){G=F[0]}else{if(H.pagePlace[F[1]]==F[1]){G=F[1]}}for(I in H.pageWrap){if(!e(I,H.pageWrap)){continue}H.pageWrap[I].css({display:(J.pageV[I])?"":"none","z-index":J.pageZ[I]||0});if(H.pages[I]){H.pages[I].flip("z",J.partZ[I]||null);if(J.pageV[I]){H.pages[I].flip("resize")}if(H.tpage){H.pages[I].flip("disable",true)}}}}else{for(I in H.pageWrap){if(!e(I,H.pageWrap)){continue}var E=A._setPageLoc.call(this,I);if(H.pages[I]){H.pages[I].flip("disable",H.disabled||E!=1).flip("z",null)}}}},_setPageLoc:function(G){var F=this.data(),E=this.turn("view");if(G==E[0]||G==E[1]){F.pageWrap[G].css({"z-index":F.totalPages,display:""});return 1}else{if((F.display=="single"&&G==E[0]+1)||(F.display=="double"&&G==E[0]-2||G==E[1]+2)){F.pageWrap[G].css({"z-index":F.totalPages-1,display:""});return 2}else{F.pageWrap[G].css({"z-index":0,display:"none"});return 0}}}},y={init:function(E){if(E.gradients){E.frontGradient=true;E.backGradient=true}this.data({f:{}});this.flip("options",E);y._addPageWrapper.call(this);return this},setData:function(F){var E=this.data();E.f=g.extend(E.f,F);return this},options:function(E){var F=this.data().f;if(E){y.setData.call(this,{opts:g.extend({},F.opts||a,E)});return this}else{return F.opts}},z:function(F){var E=this.data().f;E.opts["z-index"]=F;E.fwrapper.css({"z-index":F||parseInt(E.parent.css("z-index"),10)||0});return this},_cAllowed:function(){return x[this.data().f.opts.corners]||this.data().f.opts.corners},_cornerActivated:function(J){if(J.originalEvent===undefined){return false}J=(n)?J.originalEvent.touches:[J];var H=this.data().f,L=H.parent.offset(),G=this.width(),F=this.height(),K={x:Math.max(0,J[0].pageX-L.left),y:Math.max(0,J[0].pageY-L.top)},I=H.opts.cornerSize,E=y._cAllowed.call(this);if(K.x<=0||K.y<=0||K.x>=G||K.y>=F){return false}if(K.y<I){K.corner="t"}else{if(K.y>=F-I){K.corner="b"}else{return false}}if(K.x<=I){K.corner+="l"}else{if(K.x>=G-I){K.corner+="r"}else{return false}}return(g.inArray(K.corner,E)==-1)?false:K},_c:function(F,E){E=E||0;return({tl:h(E,E),tr:h(this.width()-E,E),bl:h(E,this.height()-E),br:h(this.width()-E,this.height()-E)})[F]},_c2:function(E){return{tl:h(this.width()*2,0),tr:h(-this.width(),0),bl:h(this.width()*2,this.height()),br:h(-this.width(),this.height())}[E]},_foldingPage:function(F){var E=this.data().f.opts;if(E.folding){return E.folding}else{if(E.turn){var G=E.turn.data();if(G.display=="single"){return(G.pageObjs[E.next])?G.pageObjs[0]:null}else{return G.pageObjs[E.next]}}}},_backGradient:function(){var F=this.data().f,E=F.opts.turn,G=F.opts.backGradient&&(!E||E.data().display=="single"||(F.opts.page!=2&&F.opts.page!=E.data().totalPages-1));if(G&&!F.bshadow){F.bshadow=g("<div/>",t(0,0,1)).css({position:"",width:this.width(),height:this.height()}).appendTo(F.parent)}return G},resize:function(G){var I=this.data().f,H=this.width(),E=this.height(),F=Math.round(Math.sqrt(Math.pow(H,2)+Math.pow(E,2)));if(G){I.wrapper.css({width:F,height:F});I.fwrapper.css({width:F,height:F}).children(":first-child").css({width:H,height:E});I.fpage.css({width:E,height:H});if(I.opts.frontGradient){I.ashadow.css({width:E,height:H})}if(y._backGradient.call(this)){I.bshadow.css({width:H,height:E})}}if(I.parent.is(":visible")){I.fwrapper.css({top:I.parent.offset().top,left:I.parent.offset().left});if(I.opts.turn){I.fparent.css({top:-I.opts.turn.offset().top,left:-I.opts.turn.offset().left})}}this.flip("z",I.opts["z-index"])},_addPageWrapper:function(){var I,H=this.data().f,K=this.parent();if(!H.wrapper){var G=this.css("left"),J=this.css("top"),F=this.width(),L=this.height(),M=Math.round(Math.sqrt(Math.pow(F,2)+Math.pow(L,2)));H.parent=K;H.fparent=(H.opts.turn)?H.opts.turn.data().fparent:g("#turn-fwrappers");if(!H.fparent){var E=g("<div/>",{css:{"pointer-events":"none"}}).hide();E.data().flips=0;if(H.opts.turn){E.css(t(-H.opts.turn.offset().top,-H.opts.turn.offset().left,"auto","visible").css).appendTo(H.opts.turn);H.opts.turn.data().fparent=E}else{E.css(t(0,0,"auto","visible").css).attr("id","turn-fwrappers").appendTo(g("body"))}H.fparent=E}this.css({position:"absolute",top:0,left:0,bottom:"auto",right:"auto"});H.wrapper=g("<div/>",t(0,0,this.css("z-index"))).appendTo(K).prepend(this);H.fwrapper=g("<div/>",t(K.offset().top,K.offset().left)).hide().appendTo(H.fparent);H.fpage=g("<div/>",{css:{cursor:"default"}}).appendTo(g("<div/>",t(0,0,0,"visible")).appendTo(H.fwrapper));if(H.opts.frontGradient){H.ashadow=g("<div/>",t(0,0,1)).appendTo(H.fpage)}y.setData.call(this,H);y.resize.call(this,true)}},_fold:function(U){var L=this,ad=0,J=0,Z,O,I,G,F,R,K,P=h(0,0),Y=h(0,0),E=h(0,0),T=this.width(),Q=this.height(),ab=y._foldingPage.call(this),X=Math.tan(J),ae=this.data().f,aa=ae.opts.acceleration,W=ae.wrapper.height(),S=y._c.call(this,U.corner),N=U.corner.substr(0,1)=="t",H=U.corner.substr(1,1)=="l",V=function(){var ao=h((S.x)?S.x-U.x:U.x,(S.y)?S.y-U.y:U.y),al=(Math.atan2(ao.y,ao.x)),ap;J=l-al;ad=s(J);ap=h((H)?T-ao.x/2:U.x+ao.x/2,ao.y/2);var ag=J-Math.atan2(ap.y,ap.x),af=Math.max(0,Math.sin(ag)*Math.sqrt(Math.pow(ap.x,2)+Math.pow(ap.y,2)));E=h(af*Math.sin(J),af*Math.cos(J));if(J>l){E.x=E.x+Math.abs(E.y*Math.tan(al));E.y=0;if(Math.round(E.x*Math.tan(w-J))<Q){U.y=Math.sqrt(Math.pow(Q,2)+2*ap.x*ao.x);if(N){U.y=Q-U.y}return V()}}if(J>l){var am=w-J,an=W-Q/Math.sin(am);P=h(Math.round(an*Math.cos(am)),Math.round(an*Math.sin(am)));if(H){P.x=-P.x}if(N){P.y=-P.y}}O=Math.round(E.y/Math.tan(J)+E.x);var ak=T-O,ai=ak*Math.cos(J*2),ah=ak*Math.sin(J*2);Y=h(Math.round((H?ak-ai:O+ai)),Math.round((N)?ah:Q-ah));R=ak*Math.sin(J);var ac=y._c2.call(L,U.corner),aj=Math.sqrt(Math.pow(ac.x-U.x,2)+Math.pow(ac.y-U.y,2));K=(aj<T)?aj/T:1;if(ae.opts.frontGradient){F=R>100?(R-100)/R:0;I=h(R*Math.sin(l-J)/Q*100,R*Math.cos(l-J)/T*100);if(N){I.y=100-I.y}if(H){I.x=100-I.x}}if(y._backGradient.call(L)){G=h(R*Math.sin(J)/T*100,R*Math.cos(J)/Q*100);if(!H){G.x=100-G.x}if(!N){G.y=100-G.y}}E.x=Math.round(E.x);E.y=Math.round(E.y);return true},M=function(ai,ah,ak,aj){var ag=["0","auto"],al=(T-W)*ak[0]/100,af=(Q-W)*ak[1]/100,am={left:ag[ah[0]],top:ag[ah[1]],right:ag[ah[2]],bottom:ag[ah[3]]},ac=(aj!=90&&aj!=-90)?(H?-1:1):0;ak=ak[0]+"% "+ak[1]+"%";L.css(am).transform(z(aj)+q(ai.x+ac,ai.y,aa),ak);ae.fpage.parent().css(am);ae.wrapper.transform(q(-ai.x+al-ac,-ai.y+af,aa)+z(-aj),ak);ae.fwrapper.transform(q(-ai.x+P.x+al,-ai.y+P.y+af,aa)+z(-aj),ak);ae.fpage.parent().transform(z(aj)+q(ai.x+Y.x-P.x,ai.y+Y.y-P.y,aa),ak);if(ae.opts.frontGradient){b(ae.ashadow,h(H?100:0,N?100:0),h(I.x,I.y),[[F,"rgba(0,0,0,0)"],[((1-F)*0.8)+F,"rgba(0,0,0,"+(0.2*K)+")"],[1,"rgba(255,255,255,"+(0.2*K)+")"]],3,J)}if(y._backGradient.call(L)){b(ae.bshadow,h(H?0:100,N?0:100),h(G.x,G.y),[[0.8,"rgba(0,0,0,0)"],[1,"rgba(0,0,0,"+(0.3*K)+")"],[1,"rgba(0,0,0,0)"]],3)}};switch(U.corner){case"tl":U.x=Math.max(U.x,1);V();M(E,[1,0,0,1],[100,0],ad);ae.fpage.transform(q(-Q,-T,aa)+z(90-ad*2),"100% 100%");ab.transform(z(90)+q(0,-Q,aa),"0% 0%");break;case"tr":U.x=Math.min(U.x,T-1);V();M(h(-E.x,E.y),[0,0,0,1],[0,0],-ad);ae.fpage.transform(q(0,-T,aa)+z(-90+ad*2),"0% 100%");ab.transform(z(270)+q(-T,0,aa),"0% 0%");break;case"bl":U.x=Math.max(U.x,1);V();M(h(E.x,-E.y),[1,1,0,0],[100,100],-ad);ae.fpage.transform(q(-Q,0,aa)+z(-90+ad*2),"100% 0%");ab.transform(z(270)+q(-T,0,aa),"0% 0%");break;case"br":U.x=Math.min(U.x,T-1);V();M(h(-E.x,-E.y),[0,1,1,0],[0,100],ad);ae.fpage.transform(z(90-ad*2),"0% 0%");ab.transform(z(90)+q(0,-Q,aa),"0% 0%");break}ae.point=U},_moveFoldingPage:function(E){var G=this.data().f,F=y._foldingPage.call(this);if(F){if(E){if(!G.fpage.children()[G.ashadow?"1":"0"]){y.setData.call(this,{backParent:F.parent()});G.fpage.prepend(F)}}else{if(G.backParent){G.backParent.prepend(F)}}}},_showFoldedPage:function(L,G){var H=y._foldingPage.call(this),F=this.data(),K=F.f;if(!K.point||K.point.corner!=L.corner){var J=g.Event("start");this.trigger(J,[K.opts,L.corner]);if(J.isDefaultPrevented()){return false}}if(H){if(G){var I=this,E=(K.point&&K.point.corner==L.corner)?K.point:y._c.call(this,L.corner,1);this.animatef({from:[E.x,E.y],to:[L.x,L.y],duration:500,frame:function(M){L.x=Math.round(M[0]);L.y=Math.round(M[1]);y._fold.call(I,L)}})}else{y._fold.call(this,L);if(F.effect&&!F.effect.turning){this.animatef(false)}}if(!K.fwrapper.is(":visible")){K.fparent.show().data().flips++;y._moveFoldingPage.call(this,true);K.fwrapper.show();if(K.bshadow){K.bshadow.show()}}return true}return false},hide:function(){var F=this.data().f,E=y._foldingPage.call(this);if((--F.fparent.data().flips)===0){F.fparent.hide()}this.css({left:0,top:0,right:"auto",bottom:"auto"}).transform("","0% 100%");F.wrapper.transform("","0% 100%");F.fwrapper.hide();if(F.bshadow){F.bshadow.hide()}E.transform("","0% 0%");return this},hideFoldedPage:function(E){var F=this.data().f;if(!F.point){return}var H=this,N=F.point,G=function(){F.point=null;H.flip("hide");H.trigger("end",[false])};if(E){var J=y._c.call(this,N.corner),I=(N.corner.substr(0,1)=="t"),M=(I)?Math.min(0,N.y-J.y)/2:Math.max(0,N.y-J.y)/2,L=h(N.x,N.y+M),K=h(J.x,J.y-M);this.animatef({from:0,to:1,frame:function(O){var P=r(N,L,K,J,O);N.x=P.x;N.y=P.y;y._fold.call(H,N)},complete:G,duration:800,hiding:true})}else{this.animatef(false);G()}},turnPage:function(G){var F=this,H=this.data().f;G={corner:(H.corner)?H.corner.corner:G||y._cAllowed.call(this)[0]};var I=H.point||y._c.call(this,G.corner,(H.opts.turn)?H.opts.turn.data().opts.elevation:0),E=y._c2.call(this,G.corner);this.trigger("flip").animatef({from:0,to:1,frame:function(J){var K=r(I,I,E,E,J);G.x=K.x;G.y=K.y;y._showFoldedPage.call(F,G)},complete:function(){F.trigger("end",[true])},duration:H.opts.duration,turning:true});H.corner=null},moving:function(){return"effect" in this.data()},isTurning:function(){return this.flip("moving")&&this.data().effect.turning},_eventStart:function(F){var E=this.data().f;if(!E.disabled&&!this.flip("isTurning")){E.corner=y._cornerActivated.call(this,F);if(E.corner&&y._foldingPage.call(this,E.corner)){y._moveFoldingPage.call(this,true);this.trigger("pressed",[E.point]);return false}else{E.corner=null}}},_eventMove:function(H){var G=this.data().f;if(!G.disabled){H=(n)?H.originalEvent.touches:[H];if(G.corner){var I=G.parent.offset();G.corner.x=H[0].pageX-I.left;G.corner.y=H[0].pageY-I.top;y._showFoldedPage.call(this,G.corner)}else{if(!this.data().effect&&this.is(":visible")){var F=y._cornerActivated.call(this,H[0]);if(F){var E=y._c.call(this,F.corner,G.opts.cornerSize/2);F.x=E.x;F.y=E.y;y._showFoldedPage.call(this,F,true)}else{y.hideFoldedPage.call(this,true)}}}}},_eventEnd:function(){var F=this.data().f;if(!F.disabled&&F.point){var E=g.Event("released");this.trigger(E,[F.point]);if(!E.isDefaultPrevented()){y.hideFoldedPage.call(this,true)}}F.corner=null},disable:function(E){y.setData.call(this,{disabled:E});return this}},o=function(G,E,F){if(!F[0]||typeof(F[0])=="object"){return E.init.apply(G,F)}else{if(E[F[0]]&&F[0].toString().substr(0,1)!="_"){return E[F[0]].apply(G,Array.prototype.slice.call(F,1))}else{throw F[0]+" is an invalid value"}}};g.extend(g.fn,{flip:function(F,E){return o(this,y,arguments)},turn:function(E){return o(this,A,arguments)},transform:function(F,E){var G={};if(E){G[C+"transform-origin"]=E}G[C+"transform"]=F;return this.css(G)},animatef:function(M){var H=this.data();if(H.effect){clearInterval(H.effect.handle)}if(M){if(!M.to.length){M.to=[M.to]}if(!M.from.length){M.from=[M.from]}if(!M.easing){M.easing=function(O,P,N,R,Q){return R*Math.sqrt(1-(P=P/Q-1)*P)+N}}var G,L=[],K=M.to.length,J=this,E=M.fps||30,F=-E,I=function(){var O,N=[];F=Math.min(M.duration,F+E);for(O=0;O<K;O++){N.push(M.easing(1,F,M.from[O],L[O],M.duration))}M.frame((K==1)?N[0]:N);if(F==M.duration){clearInterval(H.effect.handle);delete H.effect;J.data(H);if(M.complete){M.complete()}}};for(G=0;G<K;G++){L.push(M.to[G]-M.from[G])}H.effect=M;H.effect.handle=setInterval(I,E);this.data(H);I()}else{delete H.effect}}});g.isTouch=n})(jQuery);Array.prototype.contains=function(b){var a=this.length;while(a--){if(this[a]===b){return true}}return false};Array.prototype.clear=function(){var a=this.length;while(a--){this[a]=0}};var timeDiff={start:function(){d=new Date();time=d.getTime()},end:function(){d=new Date();return(d.getTime()-time)}};function Sudoku(){this.matrix=new Array(81);this.matrix.clear();this.level=0;this.shuffle=function(q){for(var m=0;m<9;m++){for(var g=0;g<9;g++){q[m*9+g]=(m*3+Math.floor(m/3)+g)%9+1}}for(var m=0;m<42;m++){var o=Math.ceil(Math.random()*9);var n;do{n=Math.ceil(Math.random()*9)}while(o==n);for(var v=0;v<9;v++){for(var e=0;e<e;k++){if(q[v*9+e]==o){q[v*9+e]=n}else{if(q[v*9+e]==n){q[v*9+e]=o}}}}}for(var p=0;p<42;p++){var t=Math.floor(Math.random()*3);var r=Math.floor(Math.random()*3);for(var v=0;v<9;v++){var l=this.matrix[v*9+(t*3+p%3)];this.matrix[v*9+(t*3+p%3)]=this.matrix[v*9+(r*3+p%3)];this.matrix[v*9+(r*3+p%3)]=l}}for(var u=0;u<42;u++){var h=Math.floor(Math.random()*3);var f=Math.floor(Math.random()*3);for(var v=0;v<9;v++){var l=this.matrix[v*9+(u%3*3+h)];this.matrix[v*9+(u%3*3+h)]=this.matrix[v*9+(u%3*3+f)];this.matrix[v*9+(u%3*3+f)]=l}}for(var u=0;u<42;u++){var b=Math.floor(Math.random()*3);var a=Math.floor(Math.random()*3);for(var e=0;e<9;e++){var l=this.matrix[(u%3*3+b)*9+e];this.matrix[(u%3*3+b)*9+e]=this.matrix[(u%3*3+a)*9+e];this.matrix[(u%3*3+a)*9+e]=l}}};this.maskBoardEasy=function(e,a){var g,f,b;for(g=0;g<81;g++){a[g]=e[g]}for(var g=0;g<3;g++){for(var f=0;f<3;f++){for(var b=0;b<5;b++){var h;do{h=Math.floor(Math.random()*9)}while(a[(g*3+Math.floor(h/3))*9+f*3+h%3]==0);a[(g*3+Math.floor(h/3))*9+f*3+h%3]=0}}}};this.getAvailable=function(m,n,h){var f,e,o,b,a,l;var g=new Array(9);g.clear();o=Math.floor(n/9);b=n%9;for(f=0;f<9;f++){e=o*9+f;if(m[e]>0){g[m[e]-1]=1}}for(f=0;f<9;f++){e=f*9+b;if(m[e]>0){g[m[e]-1]=1}}a=o-o%3;l=b-b%3;for(f=a;f<a+3;f++){for(e=l;e<l+3;e++){if(m[f*9+e]>0){g[m[f*9+e]-1]=1}}}e=0;if(h!=null){for(f=0;f<9;f++){if(g[f]==0){h[e++]=f+1}}}else{for(f=0;f<9;f++){if(g[f]==0){e++}}return e}if(e==0){return 0}for(f=0;f<18;f++){a=Math.floor(Math.random()*e);l=Math.floor(Math.random()*e);o=h[a];h[a]=h[l];h[l]=o}return e};this.getCell=function(b){var a=-1,g=10,e,c;var f=new Array(9);f.clear();for(e=0;e<81;e++){if(b[e]==0){c=this.getAvailable(b,e,null);if(c<g){g=c;a=e}if(g==1){break}}}return a};this.solve=function(b){var f,e,c=0;var a=this.getCell(b);if(a==-1){return 1}var g=new Array(9);g.clear();e=this.getAvailable(b,a,g);for(f=0;f<e;f++){b[a]=g[f];if(this.solve(b)==1){return 1}}b[a]=0;return 0};this.enumSolutions=function(b){var f,e,c=0;var a=this.getCell(b);if(a==-1){return 1}var g=new Array(9);g.clear();e=this.getAvailable(b,a,g);for(f=0;f<e;f++){b[a]=g[f];c+=this.enumSolutions(b);if(c>1){break}}b[a]=0;return c};this.maskBoard=function(q,w){var x,s,p,l,y,m=0,A,o=0,b,B;var h=new Array(9);h.clear();var z=new Array(81);z.clear();w.clear();do{do{b=Math.floor(Math.random()*81)}while((w[b]!=0)||(z[b]!=0));B=q[b];x=this.getAvailable(w,b,null);if(x>1){var u,f=Math.floor(b/9),e=b%9;u=0;for(x=0;x<9;x++){if(x==e){continue}s=f*9+x;if(w[s]>0){continue}A=this.getAvailable(w,s,h);for(s=0;s<A;s++){if(h[s]==B){u++;break}h[s]=0}}if(u>0){u=0;for(x=0;x<9;x++){if(x==f){continue}s=x*9+e;if(w[s]>0){continue}A=this.getAvailable(w,s,h);for(s=0;s<A;s++){if(h[s]==B){u++;break}h[s]=0}}if(u>0){u=0;l=f-f%3;y=e-e%3;for(x=l;x<l+3;x++){for(s=y;s<y+3;s++){if((x==f)&&(s==e)){continue}p=x*9+s;if(w[p]>0){continue}A=this.getAvailable(w,p,h);for(p=0;p<A;p++){if(h[p]==B){u++;break}h[p]=0}}}if(u>0){w[b]=B;o++}}}}z[b]=1;m++}while(m<81);do{do{b=Math.floor(Math.random()*81)}while((w[b]==0)||(z[b]==0));B=w[b];var g=this;var v=0;w[b]=0;v=this.enumSolutions(w);if(v>1){w[b]=B}z[b]=0;o--}while(o>0)};this._checkVal=function(a,l,e,h){var f,b,g,m;for(f=0;f<9;f++){if((f!=e)&&(a[l*9+f]==h)){return false}}for(f=0;f<9;f++){if((f!=l)&&(a[f*9+e]==h)){return false}}g=l-l%3;m=e-e%3;for(f=g;f<g+3;f++){for(b=m;b<m+3;b++){if(((f!=l)||(b!=e))&&(a[f*9+b]==h)){return false}}}return true};this.checkVal=function(c,a,b){return this._checkVal(this.matrix,c,a,b)};this.setVal=function(c,a,b){this.matrix[c*9+a]=b};this.getVal=function(b,a){return this.matrix[b*9+a]};this._newGame=function(){var c,e=0;var b=new Array(81);this.matrix.clear();this.solve(this.matrix);if(this.level==0){this.maskBoardEasy(this.matrix,b)}else{this.maskBoard(this.matrix,b);if(this.level==1){for(c=0;c<4;c++){do{var a=Math.floor(Math.random()*81)}while(b[a]!=0);b[a]=this.matrix[a]}}}this.save=this.matrix;this.matrix=b;timeDiff.start()};this.done;this._doHints=function(e,b,c,g){if(g>0){do{cell=Math.floor(Math.random()*81)}while((b[cell]==0)||(c[cell]==0));val=b[cell];var f=this;var a=0;b[cell]=0;a=this.enumSolutions(b);if(a>1){b[cell]=val}c[cell]=0;g--;var f=this;setTimeout(function(){f._doHints(e,b,c,g)},50)}else{this.save=this.matrix;this.matrix=b;this.done()}};this._doMask=function(q,v){var w,s,p,l,x,m=0,z,o=0,b,A;var h=new Array(9);h.clear();var y=new Array(81);y.clear();v.clear();do{do{b=Math.floor(Math.random()*81)}while((v[b]!=0)||(y[b]!=0));A=q[b];w=this.getAvailable(v,b,null);if(w>1){var u,f=Math.floor(b/9),e=b%9;u=0;for(w=0;w<9;w++){if(w==e){continue}s=f*9+w;if(v[s]>0){continue}z=this.getAvailable(v,s,h);for(s=0;s<z;s++){if(h[s]==A){u++;break}h[s]=0}}if(u>0){u=0;for(w=0;w<9;w++){if(w==f){continue}s=w*9+e;if(v[s]>0){continue}z=this.getAvailable(v,s,h);for(s=0;s<z;s++){if(h[s]==A){u++;break}h[s]=0}}if(u>0){u=0;l=f-f%3;x=e-e%3;for(w=l;w<l+3;w++){for(s=x;s<x+3;s++){if((w==f)&&(s==e)){continue}p=w*9+s;if(v[p]>0){continue}z=this.getAvailable(v,p,h);for(p=0;p<z;p++){if(h[p]==A){u++;break}h[p]=0}}}if(u>0){v[b]=A;o++}}}}y[b]=1;m++}while(m<81);var g=this;setTimeout(function(){g._doHints(q,v,y,o)},50)};this.newGame=function(){var c,e=0;var b=new Array(81);this.matrix.clear();this.solve(this.matrix);if(this.level==0){this.maskBoardEasy(this.matrix,b);this.save=this.matrix;this.matrix=b;timeDiff.start();this.done()}else{this._doMask(this.matrix,b);if(this.level==1){for(c=0;c<4;c++){do{var a=Math.floor(Math.random()*81)}while(b[a]!=0);b[a]=this.matrix[a]}}}};this.solveGame=function(){this.matrix=this.save};this.gameFinished=function(){for(var b=0;b<9;b++){for(var a=0;a<9;a++){var c=this.matrix[b*9+a];if((c==0)||(this._checkVal(this.matrix,b,a,c)==false)){return 0}}}return timeDiff.end()}};/*!
 * jQuery TubePlayer Plugin
 * 
 * version: 1.1.0 (1-Oct-2012)
 * @requires v1.3.2 or later
 *
 * @imports SWFObject - http://code.google.com/p/swfobject/
 *	- Degrades to flash based player if not HTML5/iframe option 
 *
 * Author: Nirvana Tikku (@ntikku / ntikku@gmail.com)
 * Documentation:
 * 		http://www.tikku.com/jquery-youtube-tubeplayer-plugin
 * 
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html 
 */
;(function($){
    
    "use strict";
	
	// tubeplayer namespace
	
	var TUBEPLAYER = ".tubeplayer",
	
		TUBE_PLAYER_CLASS = "jquery-youtube-tubeplayer",
		
		OPTS = "opts"+TUBEPLAYER;
	
	//	
	//
	// TubePlayer package 
	//
	//
	var TubePlayer = {};
	
	// all the instances that exist
	TubePlayer.ytplayers = {}; 
	
	// local init functions for multiple iframe players
	TubePlayer.inits = []; 
	
	// no need to import the iframe script multiple times
	TubePlayer.iframeScriptInited = false; 
	
	// tubeplayer inited flag - for destroy/re-init
	TubePlayer.inited = false;
	
	//
	//
	// public facing defaults
	//
	//
	
	$.tubeplayer = {};
	$.tubeplayer.TubePlayer = TubePlayer;
	
	// events cache -- used by flashplayer version of video player
	$.tubeplayer.events = {};
	
	/**
	 * These are all the events that are bound to the YouTube Player
	 * the events can be overridden as they are public.
	 * 
	 * There are several functions that serve as wrappers to be utilized
	 * internally - stateChange, onError, qualityChange. Change them at your 
	 * own risk.
	 */
	$.tubeplayer.defaults = {
	
		afterReady: function($player){},
		
		stateChange: function(player){
			
			var _ret = this.onPlayer;
			
			return function(state){
			    
				if(typeof(state)==="object")
					state = state.data;
				
				switch(state){
					
					case -1: return _ret.unstarted[player]();
					
					case 0: return _ret.ended[player]();
					
					case 1: return _ret.playing[player]();
					
					case 2: return _ret.paused[player]();
					
					case 3: return _ret.buffering[player]();
					
					case 5: return _ret.cued[player]();
					
					default: return null;
					
				}
			}
			
		},
		
		onError: function(player){
			
			var _ret = this.onErr;
			
			return function(errorCode){
				
				if(typeof(errorCode)==="object")
					errorCode = errorCode.data;
					
				switch(errorCode){
					
					case 2: return _ret.invalidParameter[player]();
					
					case 100: return _ret.notFound[player]();
					
					case 101:
					case 150: return _ret.notEmbeddable[player]();
					
					default: return null;
					
				}
				
			}
			
		},
		
		qualityChange: function(player){
			
			var _this = this;
			
			return function(suggested){
				
				if(typeof(suggested)==="object")
					suggested = suggested.data;
					
				return _this.onQualityChange[player](suggested);
				
			}
			
		},
		
		onQualityChange:{},
		
		onPlayer:{unstarted:{},ended:{},playing:{},paused:{},buffering:{},cued:{}},
		
		onErr:{notFound:{},notEmbeddable:{},invalidParameter:{}}
		
	};
	
	/**
	 * These are the internal defaults for the TubePlayer
	 * plugin to work without providing any parameters. They
	 * are merged with the users options.
	 */
	var defaults = {
		
		// public facing
		width: 425,
		height: 355,
		allowFullScreen: "true",
		initialVideo: "DkoeNLuMbcI",
		start: 0,
		preferredQuality: "default",
		showControls: true,
		showRelated: false,
		annotations: true,
		autoPlay: false,
		autoHide: true,
		loop: 0,
		theme: 'dark', // 'dark' or 'light'
		color: 'red', // 'red' or 'white'
		showinfo: false,
		modestbranding: true,
		protocol: 'http', // set to 'https' for compatibility on SSL-enabled pages
		
		// with respect to [wmode] - 'transparent' maintains z-index, but disables GPU acceleration
		wmode: 'transparent', // you probably want to use 'window' when optimizing for mobile devices
		swfobjectURL: "ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js", // exclude the protocol, it will be read from the 'protocol' property
		loadSWFObject: true, // by default, we will attempt to load the swfobject script, if utilizing the flash player
		
		// privately used
		allowScriptAccess: "always",
		playerID: "tubeplayer-player-container",
		
		// html5 specific attrs
		iframed: true,
				
		// trigger fn's
		onPlay: function(id){},
		onPause: function(){},
		onStop: function(){},
		onSeek: function(time){},
		onMute: function(){},
		onUnMute: function(){},
		
		// player fn's
		onPlayerUnstarted: function(){},
		onPlayerEnded: function(){},
		onPlayerPlaying: function(){},
		onPlayerPaused: function(){},
		onPlayerBuffering: function(){},
		onPlayerCued: function(){},
		onQualityChange: function(){},
		
		// error fn's
		onErrorNotFound: function(){},
		onErrorNotEmbeddable: function(){},
		onErrorInvalidParameter: function(){}
		
	};
	
	/**
	 * The TubePlayer plugin bound to the jQuery object's prototype. 
	 * This method acts as an interface to instantiate a TubePlayer, 
	 * as well as invoke events that are attached - typically getters/setters
	 */
	$.fn.tubeplayer = function(input, xtra){
		
		var $this = $(this);
		
		var type = typeof input;
		
		if( arguments.length === 0 || type === "object" )
		
			return $this.each(function(){
				
				TubePlayer.init( $(this), input );
				
			});
			
		else if( type === "string" )
		
			return $this.triggerHandler( input+TUBEPLAYER, xtra || null );
			
	};
	
		
	/**
	 * This method is the base method for all the events
	 * that are bound to the TubePlayer. 
	 */
	var buildFN = function(fn, after){
		
		return function(evt,param){
			
			var p = TubePlayer.getPkg(evt);
			
			if(p.ytplayer) { 
				
				var ret = fn(evt, param, p);
				
				if(typeof(ret)==="undefined") 
					ret = p.$player;
					
				return ret;
				
			}
			
			return p.$player;
			
		};
		
	};
	
	/**
	 * Public method to get all the player instances
	 */
	$.tubeplayer.getPlayers = function(){
		
		return TubePlayer.ytplayers;
		
	};
	
	
	/**
	 * Initialize a YouTube player; 
	 *
	 *	First check to see if TubePlayer has been init'd
	 *	if it has then return, otherwise:
	 *		> add the tubeplayer class (used to denote a player)
	 *		> provide local data access to the options and store it
	 *		> initialize the default events on the jQuery instance
	 *		> create the container for the player
	 *		> initialize the player (iframe/HTML5 vs flash based)
	 * 
	 *	@param $player - the instance being created on
	 *	@param opts - the user's options
	 */
	TubePlayer.init = function($player, opts){
	
		if( $player.hasClass(TUBE_PLAYER_CLASS) )
			return $player;
		
		var o = $.extend({}, defaults, opts);
			
		o.playerID += "-" + guid();
			
		$player.addClass(TUBE_PLAYER_CLASS).data(OPTS, o);
		
		for(var event in PLAYER) 
			$player.bind(event+TUBEPLAYER, $player, PLAYER[event]);
			
		// initialize the default event methods
		TubePlayer.initDefaults($.tubeplayer.defaults, o);
	
		// insert the player container
		$("<div></div>").attr("id", o.playerID).appendTo($player);
		
		// append the player into the container
		TubePlayer.initPlayer($player, o);
		
		return $player; 
		
	};
	
	/**
	 * Every method needs these items
	 */
	TubePlayer.getPkg = function(evt){
		
		var $player = evt.data;
		
		var opts = $player.data(OPTS);
		
		var ytplayer = TubePlayer.ytplayers[opts.playerID];
		
		return {
			
			$player: $player,
			
			opts: opts,
			
			ytplayer: ytplayer
			
		}
		
	};
	
	/**
	 * This method handles the player init. Since 
	 * onYouTubePlayerReady is called when the script
	 * has been evaluated, we want all the instances
	 * to get init'd. For this we have a init queue.
	 * If the script has been init'd, we automatically
	 * pop the method off the queue and init the player.
	 */
	TubePlayer.iframeReady = function(o){
		
		TubePlayer.inits.push(function(){
			
			new YT.Player(o.playerID, {
				
				videoId: o.initialVideo,
				
				width: o.width,
				
				height: o.height,
				
				playerVars: { 
					
					'autoplay': (o.autoPlay?1:0), 
					
					'autohide': (o.autoHide?1:0),
					
					'controls': (o.showControls?1:0),
					
					'loop': (o.loop?1:0),
					
					'playlist': (o.loop ? o.initialVideo : ""),

					'rel': (o.showRelated?1:0),
					
					'fs': (o.allowFullScreen?1:0),
					
					'wmode': o.wmode,
					
					'showinfo': (o.showinfo?1:0),
					
					'modestbranding': (o.modestbranding?1:0),
					
					'iv_load_policy': (o.annotations?1:3),
					
					'start': o.start,
					
					'theme': o.theme,
					
					'color': o.color
					
				},
				
				events: {
					
					'onReady': function(evt){
						
						TubePlayer.ytplayers[o.playerID] = evt.target;
						
						var $player = $(evt.target).parents("."+TUBE_PLAYER_CLASS);
						
						$.tubeplayer.defaults.afterReady($player);
						
					},
					
					'onPlaybackQualityChange': $.tubeplayer.defaults.qualityChange(o.playerID),
					
					'onStateChange': $.tubeplayer.defaults.stateChange(o.playerID),
				
					'onError': $.tubeplayer.defaults.onError(o.playerID)
					
				}
				
			});
			
		});
		
		// stacked init method
		if(TubePlayer.inits.length>=1 && !TubePlayer.inited){
			
			return function(){
				
				for(var i=0; i<TubePlayer.inits.length; i++){

					TubePlayer.inits[i]();
					
				}
				
				TubePlayer.inited = true;
				
			};
			
		}
		
		// if we've inited already, just call the init fn
		if(TubePlayer.inited){
			
			( TubePlayer.inits.pop() )();
			
		}
		
		return window.onYouTubePlayerAPIReady;
		
	};
	
	/**
	 * check to see if iframe option is plausible
	 */
	TubePlayer.supportsHTML5 = function(){
		
		return !!document.createElement('video').canPlayType;
		
	};
	
	/**
	 * @param d - the defaults
	 * @param o - the options w/ methods to attach
	 */
	TubePlayer.initDefaults = function(d, o){
	
		var ID = o.playerID; 
		
		// default onPlayer events
		var dp = d.onPlayer;
		dp.unstarted[ID] = o.onPlayerUnstarted;
		dp.ended[ID] = o.onPlayerEnded;
		dp.playing[ID] = o.onPlayerPlaying;
		dp.paused[ID] = o.onPlayerPaused;
		dp.buffering[ID] = o.onPlayerBuffering;
		dp.cued[ID] = o.onPlayerCued;
		
		// default onQualityChange
		d.onQualityChange[ID] = o.onQualityChange;
		
		// default onError events
		var de = d.onErr;
		de.notFound[ID] = o.onErrorNotFound;
		de.notEmbeddable[ID] = o.onErrorNotEmbeddable;
		de.invalidParameter[ID] = o.onErrorInvalidParameter;
		
	};
	
	/**
	 * init the iframed option if its requested and supported
	 * otherwise initialize the flash based player
	 * @param $player - the player that the tubeplayer binds to
	 * @param o - the init options
	 */
	TubePlayer.initPlayer = function($player, o){
		
		if(o.iframed && TubePlayer.supportsHTML5())
		
			TubePlayer.initIframePlayer($player, o);
			
		else
		
			TubePlayer.initFlashPlayer($player, o);
			
	};
	
	/**
	 * Initialize an iframe player
	 */
	TubePlayer.initIframePlayer = function($player, o){
		
		if(!TubePlayer.iframeScriptInited){
		
			// write the api script tag
			var tag = document.createElement('script');
		
			tag.src = o.protocol + "://www.youtube.com/iframe_api";
		
			var firstScriptTag = document.getElementsByTagName('script')[0];
		
			firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
		
			TubePlayer.iframeScriptInited = true;
		
		};
		
		// init the iframe player
		window.onYouTubePlayerAPIReady = TubePlayer.iframeReady(o);
		
	};
	
	/**
	 * Flash player initialization
	 *  -> if 'loadSWFObject' is set to true, player will only be init'd
	 *      when the swfobject script request has completed successfully
	 *  -> if 'loadSWFObject' is set to false, assumes that you have 
	 *      imported your own SWFObject, prior to TubePlayer's initialization
	 * @imports swfobject automatically
	 */
	TubePlayer.initFlashPlayer = function($player, o){
		
		if(o.loadSWFObject){
		    
		    // cleanup swfobjectURL to re-apply the protocol
		    o.swfobjectURL = o.swfobjectURL.replace('http://', '');
		    o.swfobjectURL = o.swfobjectURL.replace('https://', '');
		    o.swfobjectURL = o.protocol + '://' + o.swfobjectURL;
		    
		    $.getScript(o.swfobjectURL, TubePlayer.initFlashPlayerFN(o));
		    
		} else {
		    
		    TubePlayer.initFlashPlayerFN(o)();
		    
		}
		
	};
	
	TubePlayer.initFlashPlayerFN = function(o){
	  
	    return function(){
		
			var url =  ["//www.youtube.com/v/"]
			url.push( o.initialVideo );
			url.push( "?&enablejsapi=1&version=3" );
			url.push( "&playerapiid=" + o.playerID );
			url.push( "&rel= " + (o.showRelated?1:0) );
			url.push( "&autoplay=" + (o.autoPlay?1:0) );
			url.push( "&autohide=" + (o.autoHide?1:0) );
			url.push( "&loop=" + (o.loop?1:0) );
			url.push( "&playlist=" + (o.loop ? o.initialVideo : ""));
			url.push( "&controls=" + (o.showControls?1:0) );
			url.push( "&showinfo=" + (o.showinfo?1:0) );
			url.push( "&modestbranding=" + (o.modestbranding?1:0) );
			url.push( "&iv_load_policy=" + (o.annotations?1:3) );
			url.push( "&start=" + o.start );
			url.push( "&theme=" + o.theme );
			url.push( "&color=" + o.color );
			url.push( "&fs=" + (o.allowFullScreen?1:0) );
			
			swfobject.embedSWF(url.join(""), o.playerID, 
				o.width, 
				o.height, 
				"8", null, null, 
				{ 
					allowScriptAccess: o.allowScriptAccess, 
					wmode: o.wmode, 
					allowFullScreen: o.allowFullScreen 
				}, 
				{ id: o.playerID }
			);
			
			// init the player ready fn
			window.onYouTubePlayerReady = function(playerId) { 
				
				var player = document.getElementById(playerId);
				
                var pid = playerId.replace(/-/g,'');
                
                var d = $.tubeplayer.defaults;
                $.tubeplayer.events[pid] = {
                    "stateChange": d.stateChange(playerId),
                    "error": d.onError(playerId),
                    "qualityChange": d.qualityChange(playerId)
                };
                
				player.addEventListener("onStateChange", "$.tubeplayer.events."+pid+".stateChange"); 
				player.addEventListener("onError", "$.tubeplayer.events."+pid+".error");
				player.addEventListener("onPlaybackQualityChange", "$.tubeplayer.events."+pid+".qualityChange");
				
				TubePlayer.ytplayers[playerId] = player;
				
                var $player = $(player).parents("."+TUBE_PLAYER_CLASS);
				
				$.tubeplayer.defaults.afterReady($player);
				
			};
			
		}
	    
	};
	
	// fmt: youtube.com/watch?x=[anything]&v=[desired-token]&
	TubePlayer.getVideoIDFromURL = function(sURL){
		
		sURL = sURL || ""; // make sure it's a string; sometimes the YT player API returns undefined, and then indexOf() below will fail
		
		var qryParamsStart = sURL.indexOf("?");
		
		var qryParams = sURL.substring(qryParamsStart, sURL.length);
		
		var videoStart = qryParams.indexOf("v=");
		if( videoStart > -1 ) { 
		    var videoEnd = qryParams.indexOf("&", videoStart);
		    if( videoEnd === -1 ) { 
		        videoEnd = qryParams.length;
		    }
		    return qryParams.substring(videoStart+"v=".length, videoEnd);
		}
		
		return "";
		
	};
	
	/**
	 * All the events that are bound to a TubePlayer instance
	 */
	var PLAYER = {
		
		cue: buildFN(function(evt,param,p){ 
			
			p.ytplayer.cueVideoById(param, p.opts.preferredQuality);
			
		}),
		
		play: buildFN(function(evt,param,p){
			
			if(typeof(param)==='object') 
				p.ytplayer.loadVideoById(param.id,param.time, p.opts.preferredQuality); 
		
			else if(param) 
				p.ytplayer.loadVideoById(param, 0, p.opts.preferredQuality); 
	
			else
				p.ytplayer.playVideo(); 
				
			p.opts.onPlay(param);
			
		}),
		
		pause: buildFN(function(evt,param,p){
			
			p.ytplayer.pauseVideo();
			
			p.opts.onPause(p);
			
		}),
		
		stop: buildFN(function(evt,param,p){
			
			p.ytplayer.stopVideo();
			
			p.opts.onStop(p);
			
		}),
		
		seek: buildFN(function(evt,param,p){
			
			p.ytplayer.seekTo(param, true);
			
			p.opts.onSeek(param);
			
		}),
		
		mute: buildFN(function(evt,param,p){
			
			p.$player.attr("data-prev-mute-volume", p.ytplayer.getVolume());
			
			p.ytplayer.mute(); 
			
			p.opts.onMute(p);
			
		}),
		
		unmute: buildFN(function(evt,param,p){
			
			p.ytplayer.unMute(); 
			
			p.ytplayer.setVolume( ( p.$player.attr("data-prev-mute-volume") || 50 ) );
			
			p.opts.onUnMute();
			
		}),
		
		isMuted: buildFN(function(evt,param,p){
			
			return p.ytplayer.isMuted();
			
		}),
		
		volume: buildFN(function(evt,param,p){
			
			if(param) {
				
				p.ytplayer.setVolume(param);
				
				p.$player.attr("data-prev-mute-volume", p.ytplayer.getVolume());
				
			}	else  {
				
				return p.ytplayer.getVolume() || 0; // 0 because iframe's currently in labs
				
			}
		
		}),
		
		quality: buildFN(function(evt,param,p){
			
			if(param) 
				p.ytplayer.setPlaybackQuality(param); 
				
			else 
				return p.ytplayer.getPlaybackQuality();
				
		}),
		
		data: buildFN(function(evt,param,p){
			
			var ret = {}; 
			
			var P = p.ytplayer;
			
			ret.bytesLoaded = P.getVideoBytesLoaded(); 
			
			ret.bytesTotal = P.getVideoBytesTotal();
			
			ret.startBytes= P.getVideoStartBytes();
			
			ret.state = P.getPlayerState();
			
			ret.currentTime = P.getCurrentTime();
			
			ret.duration = P.getDuration();
			
			ret.videoURL = P.getVideoUrl();
			
			ret.getVideoEmbedCode = P.getVideoEmbedCode();
			
			ret.videoID = TubePlayer.getVideoIDFromURL(ret.videoURL);
			
			ret.availableQualityLevels = P.getAvailableQualityLevels();
            
			return ret;
			
		}),
		
		videoId: buildFN(function(evt,param,p){
			
			return TubePlayer.getVideoIDFromURL( p.ytplayer.getVideoUrl() );
			
		}),
		
		size: buildFN(function(evt, param, p){
			
			if(param.width && param.height) { 
				
				p.ytplayer.setSize(param.width, param.height);
				
				$(p.ytplayer).css(param);
				
			}
			
		}),
		
		destroy: buildFN(function(evt, param, p){

			p.$player.removeClass(TUBE_PLAYER_CLASS)
				.data(OPTS, null)
				.unbind(TUBEPLAYER)
				.html("");
				
			delete TubePlayer.ytplayers[p.opts.playerID];
			
			// cleanup callback handler references..
			var d = $.tubeplayer.defaults;
			
			var events = ['unstarted','ended','playing','paused','buffering','cued'];
			for(var _event in events) 
			    delete d.onPlayer[events[_event]][p.opts.playerID];
			    
			events = ['notFound','notEmbeddable','invalidParameter'];
			for(var _event in events) 
			    delete d.onErr[events[_event]][p.opts.playerID];
			    
			delete d.onQualityChange[p.opts.playerID];
			
			delete $.tubeplayer.events[p.opts.playerID]; // flash callback ref's
			
			$(p.ytplayer).remove();
			
			return null;		
			
		}),
		
		player: buildFN(function(evt, param, p){
			
			return p.ytplayer;
			
		})
		
	};
	
	// used in case of multiple players
	function guid(){
	    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
            var r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);
            return v.toString(16);
        });;
	};
	
})(jQuery);/*!
 * jQuery Cookie Plugin v1.3.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */
(function (factory) {
	if (typeof define === 'function' && define.amd) {
		// AMD. Register as anonymous module.
		define(['jquery'], factory);
	} else {
		// Browser globals.
		factory(jQuery);
	}
}(function ($) {

	var pluses = /\+/g;

	function raw(s) {
		return s;
	}

	function decoded(s) {
		return decodeURIComponent(s.replace(pluses, ' '));
	}

	function converted(s) {
		if (s.indexOf('"') === 0) {
			// This is a quoted cookie as according to RFC2068, unescape
			s = s.slice(1, -1).replace(/\\"/g, '"').replace(/\\\\/g, '\\');
		}
		try {
			return config.json ? JSON.parse(s) : s;
		} catch(er) {}
	}

	var config = $.cookie = function (key, value, options) {

		// write
		if (value !== undefined) {
			options = $.extend({}, config.defaults, options);

			if (typeof options.expires === 'number') {
				var days = options.expires, t = options.expires = new Date();
				t.setDate(t.getDate() + days);
			}

			value = config.json ? JSON.stringify(value) : String(value);

			return (document.cookie = [
				config.raw ? key : encodeURIComponent(key),
				'=',
				config.raw ? value : encodeURIComponent(value),
				options.expires ? '; expires=' + options.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE
				options.path    ? '; path=' + options.path : '',
				options.domain  ? '; domain=' + options.domain : '',
				options.secure  ? '; secure' : ''
			].join(''));
		}

		// read
		var decode = config.raw ? raw : decoded;
		var cookies = document.cookie.split('; ');
		var result = key ? undefined : {};
		for (var i = 0, l = cookies.length; i < l; i++) {
			var parts = cookies[i].split('=');
			var name = decode(parts.shift());
			var cookie = decode(parts.join('='));

			if (key && key === name) {
				result = converted(cookie);
				break;
			}

			if (!key) {
				result[name] = converted(cookie);
			}
		}

		return result;
	};

	config.defaults = {};

	$.removeCookie = function (key, options) {
		if ($.cookie(key) !== undefined) {
			// Must not alter options, thus extending a fresh object...
			$.cookie(key, '', $.extend({}, options, { expires: -1 }));
			return true;
		}
		return false;
	};

}));
/*!
 * jQuery resize event - v1.1 - 3/14/2010
 * http://benalman.com/projects/jquery-resize-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */

// Script: jQuery resize event
//
// *Version: 1.1, Last updated: 3/14/2010*
// 
// Project Home - http://benalman.com/projects/jquery-resize-plugin/
// GitHub       - http://github.com/cowboy/jquery-resize/
// Source       - http://github.com/cowboy/jquery-resize/raw/master/jquery.ba-resize.js
// (Minified)   - http://github.com/cowboy/jquery-resize/raw/master/jquery.ba-resize.min.js (1.0kb)
// 
// About: License
// 
// Copyright (c) 2010 "Cowboy" Ben Alman,
// Dual licensed under the MIT and GPL licenses.
// http://benalman.com/about/license/
// 
// About: Examples
// 
// This working example, complete with fully commented code, illustrates a few
// ways in which this plugin can be used.
// 
// resize event - http://benalman.com/code/projects/jquery-resize/examples/resize/
// 
// About: Support and Testing
// 
// Information about what version or versions of jQuery this plugin has been
// tested with, what browsers it has been tested in, and where the unit tests
// reside (so you can test it yourself).
// 
// jQuery Versions - 1.3.2, 1.4.1, 1.4.2
// Browsers Tested - Internet Explorer 6-8, Firefox 2-3.6, Safari 3-4, Chrome, Opera 9.6-10.1.
// Unit Tests      - http://benalman.com/code/projects/jquery-resize/unit/
// 
// About: Release History
// 
// 1.1 - (3/14/2010) Fixed a minor bug that was causing the event to trigger
//       immediately after bind in some circumstances. Also changed $.fn.data
//       to $.data to improve performance.
// 1.0 - (2/10/2010) Initial release

(function($,window,undefined){
  '$:nomunge'; // Used by YUI compressor.
  
  // A jQuery object containing all non-window elements to which the resize
  // event is bound.
  var elems = $([]),
    
    // Extend $.resize if it already exists, otherwise create it.
    jq_resize = $.resize = $.extend( $.resize, {} ),
    
    timeout_id,
    
    // Reused strings.
    str_setTimeout = 'setTimeout',
    str_resize = 'resize',
    str_data = str_resize + '-special-event',
    str_delay = 'delay',
    str_throttle = 'throttleWindow';
  
  // Property: jQuery.resize.delay
  // 
  // The numeric interval (in milliseconds) at which the resize event polling
  // loop executes. Defaults to 250.
  
  jq_resize[ str_delay ] = 250;
  
  // Property: jQuery.resize.throttleWindow
  // 
  // Throttle the native window object resize event to fire no more than once
  // every <jQuery.resize.delay> milliseconds. Defaults to true.
  // 
  // Because the window object has its own resize event, it doesn't need to be
  // provided by this plugin, and its execution can be left entirely up to the
  // browser. However, since certain browsers fire the resize event continuously
  // while others do not, enabling this will throttle the window resize event,
  // making event behavior consistent across all elements in all browsers.
  // 
  // While setting this property to false will disable window object resize
  // event throttling, please note that this property must be changed before any
  // window object resize event callbacks are bound.
  
  jq_resize[ str_throttle ] = true;
  
  // Event: resize event
  // 
  // Fired when an element's width or height changes. Because browsers only
  // provide this event for the window element, for other elements a polling
  // loop is initialized, running every <jQuery.resize.delay> milliseconds
  // to see if elements' dimensions have changed. You may bind with either
  // .resize( fn ) or .bind( "resize", fn ), and unbind with .unbind( "resize" ).
  // 
  // Usage:
  // 
  // > jQuery('selector').bind( 'resize', function(e) {
  // >   // element's width or height has changed!
  // >   ...
  // > });
  // 
  // Additional Notes:
  // 
  // * The polling loop is not created until at least one callback is actually
  //   bound to the 'resize' event, and this single polling loop is shared
  //   across all elements.
  // 
  // Double firing issue in jQuery 1.3.2:
  // 
  // While this plugin works in jQuery 1.3.2, if an element's event callbacks
  // are manually triggered via .trigger( 'resize' ) or .resize() those
  // callbacks may double-fire, due to limitations in the jQuery 1.3.2 special
  // events system. This is not an issue when using jQuery 1.4+.
  // 
  // > // While this works in jQuery 1.4+
  // > $(elem).css({ width: new_w, height: new_h }).resize();
  // > 
  // > // In jQuery 1.3.2, you need to do this:
  // > var elem = $(elem);
  // > elem.css({ width: new_w, height: new_h });
  // > elem.data( 'resize-special-event', { width: elem.width(), height: elem.height() } );
  // > elem.resize();
      
  $.event.special[ str_resize ] = {
    
    // Called only when the first 'resize' event callback is bound per element.
    setup: function() {
      // Since window has its own native 'resize' event, return false so that
      // jQuery will bind the event using DOM methods. Since only 'window'
      // objects have a .setTimeout method, this should be a sufficient test.
      // Unless, of course, we're throttling the 'resize' event for window.
      if ( !jq_resize[ str_throttle ] && this[ str_setTimeout ] ) { return false; }
      
      var elem = $(this);
      
      // Add this element to the list of internal elements to monitor.
      elems = elems.add( elem );
      
      // Initialize data store on the element.
      $.data( this, str_data, { w: elem.width(), h: elem.height() } );
      
      // If this is the first element added, start the polling loop.
      if ( elems.length === 1 ) {
        loopy();
      }
    },
    
    // Called only when the last 'resize' event callback is unbound per element.
    teardown: function() {
      // Since window has its own native 'resize' event, return false so that
      // jQuery will unbind the event using DOM methods. Since only 'window'
      // objects have a .setTimeout method, this should be a sufficient test.
      // Unless, of course, we're throttling the 'resize' event for window.
      if ( !jq_resize[ str_throttle ] && this[ str_setTimeout ] ) { return false; }
      
      var elem = $(this);
      
      // Remove this element from the list of internal elements to monitor.
      elems = elems.not( elem );
      
      // Remove any data stored on the element.
      elem.removeData( str_data );
      
      // If this is the last element removed, stop the polling loop.
      if ( !elems.length ) {
        clearTimeout( timeout_id );
      }
    },
    
    // Called every time a 'resize' event callback is bound per element (new in
    // jQuery 1.4).
    add: function( handleObj ) {
      // Since window has its own native 'resize' event, return false so that
      // jQuery doesn't modify the event object. Unless, of course, we're
      // throttling the 'resize' event for window.
      if ( !jq_resize[ str_throttle ] && this[ str_setTimeout ] ) { return false; }
      
      var old_handler;
      
      // The new_handler function is executed every time the event is triggered.
      // This is used to update the internal element data store with the width
      // and height when the event is triggered manually, to avoid double-firing
      // of the event callback. See the "Double firing issue in jQuery 1.3.2"
      // comments above for more information.
      
      function new_handler( e, w, h ) {
        var elem = $(this),
          data = $.data( this, str_data );
        
        // If called from the polling loop, w and h will be passed in as
        // arguments. If called manually, via .trigger( 'resize' ) or .resize(),
        // those values will need to be computed.
        data.w = w !== undefined ? w : elem.width();
        data.h = h !== undefined ? h : elem.height();
        
        old_handler.apply( this, arguments );
      };
      
      // This may seem a little complicated, but it normalizes the special event
      // .add method between jQuery 1.4/1.4.1 and 1.4.2+
      if ( $.isFunction( handleObj ) ) {
        // 1.4, 1.4.1
        old_handler = handleObj;
        return new_handler;
      } else {
        // 1.4.2+
        old_handler = handleObj.handler;
        handleObj.handler = new_handler;
      }
    }
    
  };
  
  function loopy() {
    
    // Start the polling loop, asynchronously.
    timeout_id = window[ str_setTimeout ](function(){
      
      // Iterate over all elements to which the 'resize' event is bound.
      elems.each(function(){
        var elem = $(this),
          width = elem.width(),
          height = elem.height(),
          data = $.data( this, str_data );
        
        // If element size has changed since the last time, update the element
        // data store and trigger the 'resize' event.
        if ( width !== data.w || height !== data.h ) {
          elem.trigger( str_resize, [ data.w = width, data.h = height ] );
        }
        
      });
      
      // Loop.
      loopy();
      
    }, jq_resize[ str_delay ] );
    
  };
  
})(jQuery,this);
/*!
 * jQuery Transit - CSS3 transitions and transformations
 * (c) 2011-2012 Rico Sta. Cruz <rico@ricostacruz.com>
 * MIT Licensed.
 *
 * http://ricostacruz.com/jquery.transit
 * http://github.com/rstacruz/jquery.transit
 */

(function($) {
  $.transit = {
    version: "0.9.9",

    // Map of $.css() keys to values for 'transitionProperty'.
    // See https://developer.mozilla.org/en/CSS/CSS_transitions#Properties_that_can_be_animated
    propertyMap: {
      marginLeft    : 'margin',
      marginRight   : 'margin',
      marginBottom  : 'margin',
      marginTop     : 'margin',
      paddingLeft   : 'padding',
      paddingRight  : 'padding',
      paddingBottom : 'padding',
      paddingTop    : 'padding'
    },

    // Will simply transition "instantly" if false
    enabled: true,

    // Set this to false if you don't want to use the transition end property.
    useTransitionEnd: false
  };

  var div = document.createElement('div');
  var support = {};

  // Helper function to get the proper vendor property name.
  // (`transition` => `WebkitTransition`)
  function getVendorPropertyName(prop) {
    // Handle unprefixed versions (FF16+, for example)
    if (prop in div.style) return prop;

    var prefixes = ['Moz', 'Webkit', 'O', 'ms'];
    var prop_ = prop.charAt(0).toUpperCase() + prop.substr(1);

    if (prop in div.style) { return prop; }

    for (var i=0; i<prefixes.length; ++i) {
      var vendorProp = prefixes[i] + prop_;
      if (vendorProp in div.style) { return vendorProp; }
    }
  }

  // Helper function to check if transform3D is supported.
  // Should return true for Webkits and Firefox 10+.
  function checkTransform3dSupport() {
    div.style[support.transform] = '';
    div.style[support.transform] = 'rotateY(90deg)';
    return div.style[support.transform] !== '';
  }

  var isChrome = navigator.userAgent.toLowerCase().indexOf('chrome') > -1;

  // Check for the browser's transitions support.
  support.transition      = getVendorPropertyName('transition');
  support.transitionDelay = getVendorPropertyName('transitionDelay');
  support.transform       = getVendorPropertyName('transform');
  support.transformOrigin = getVendorPropertyName('transformOrigin');
  support.transform3d     = checkTransform3dSupport();

  var eventNames = {
    'transition':       'transitionEnd',
    'MozTransition':    'transitionend',
    'OTransition':      'oTransitionEnd',
    'WebkitTransition': 'webkitTransitionEnd',
    'msTransition':     'MSTransitionEnd'
  };

  // Detect the 'transitionend' event needed.
  var transitionEnd = support.transitionEnd = eventNames[support.transition] || null;

  // Populate jQuery's `$.support` with the vendor prefixes we know.
  // As per [jQuery's cssHooks documentation](http://api.jquery.com/jQuery.cssHooks/),
  // we set $.support.transition to a string of the actual property name used.
  for (var key in support) {
    if (support.hasOwnProperty(key) && typeof $.support[key] === 'undefined') {
      $.support[key] = support[key];
    }
  }

  // Avoid memory leak in IE.
  div = null;

  // ## $.cssEase
  // List of easing aliases that you can use with `$.fn.transition`.
  $.cssEase = {
    '_default':       'ease',
    'in':             'ease-in',
    'out':            'ease-out',
    'in-out':         'ease-in-out',
    'snap':           'cubic-bezier(0,1,.5,1)',
    // Penner equations
    'easeOutCubic':   'cubic-bezier(.215,.61,.355,1)',
    'easeInOutCubic': 'cubic-bezier(.645,.045,.355,1)',
    'easeInCirc':     'cubic-bezier(.6,.04,.98,.335)',
    'easeOutCirc':    'cubic-bezier(.075,.82,.165,1)',
    'easeInOutCirc':  'cubic-bezier(.785,.135,.15,.86)',
    'easeInExpo':     'cubic-bezier(.95,.05,.795,.035)',
    'easeOutExpo':    'cubic-bezier(.19,1,.22,1)',
    'easeInOutExpo':  'cubic-bezier(1,0,0,1)',
    'easeInQuad':     'cubic-bezier(.55,.085,.68,.53)',
    'easeOutQuad':    'cubic-bezier(.25,.46,.45,.94)',
    'easeInOutQuad':  'cubic-bezier(.455,.03,.515,.955)',
    'easeInQuart':    'cubic-bezier(.895,.03,.685,.22)',
    'easeOutQuart':   'cubic-bezier(.165,.84,.44,1)',
    'easeInOutQuart': 'cubic-bezier(.77,0,.175,1)',
    'easeInQuint':    'cubic-bezier(.755,.05,.855,.06)',
    'easeOutQuint':   'cubic-bezier(.23,1,.32,1)',
    'easeInOutQuint': 'cubic-bezier(.86,0,.07,1)',
    'easeInSine':     'cubic-bezier(.47,0,.745,.715)',
    'easeOutSine':    'cubic-bezier(.39,.575,.565,1)',
    'easeInOutSine':  'cubic-bezier(.445,.05,.55,.95)',
    'easeInBack':     'cubic-bezier(.6,-.28,.735,.045)',
    'easeOutBack':    'cubic-bezier(.175, .885,.32,1.275)',
    'easeInOutBack':  'cubic-bezier(.68,-.55,.265,1.55)'
  };

  // ## 'transform' CSS hook
  // Allows you to use the `transform` property in CSS.
  //
  //     $("#hello").css({ transform: "rotate(90deg)" });
  //
  //     $("#hello").css('transform');
  //     //=> { rotate: '90deg' }
  //
  $.cssHooks['transit:transform'] = {
    // The getter returns a `Transform` object.
    get: function(elem) {
      return $(elem).data('transform') || new Transform();
    },

    // The setter accepts a `Transform` object or a string.
    set: function(elem, v) {
      var value = v;

      if (!(value instanceof Transform)) {
        value = new Transform(value);
      }

      // We've seen the 3D version of Scale() not work in Chrome when the
      // element being scaled extends outside of the viewport.  Thus, we're
      // forcing Chrome to not use the 3d transforms as well.  Not sure if
      // translate is affectede, but not risking it.  Detection code from
      // http://davidwalsh.name/detecting-google-chrome-javascript
      if (support.transform === 'WebkitTransform' && !isChrome) {
        elem.style[support.transform] = value.toString(true);
      } else {
        elem.style[support.transform] = value.toString();
      }

      $(elem).data('transform', value);
    }
  };

  // Add a CSS hook for `.css({ transform: '...' })`.
  // In jQuery 1.8+, this will intentionally override the default `transform`
  // CSS hook so it'll play well with Transit. (see issue #62)
  $.cssHooks.transform = {
    set: $.cssHooks['transit:transform'].set
  };

  // jQuery 1.8+ supports prefix-free transitions, so these polyfills will not
  // be necessary.
  if ($.fn.jquery < "1.8") {
    // ## 'transformOrigin' CSS hook
    // Allows the use for `transformOrigin` to define where scaling and rotation
    // is pivoted.
    //
    //     $("#hello").css({ transformOrigin: '0 0' });
    //
    $.cssHooks.transformOrigin = {
      get: function(elem) {
        return elem.style[support.transformOrigin];
      },
      set: function(elem, value) {
        elem.style[support.transformOrigin] = value;
      }
    };

    // ## 'transition' CSS hook
    // Allows you to use the `transition` property in CSS.
    //
    //     $("#hello").css({ transition: 'all 0 ease 0' });
    //
    $.cssHooks.transition = {
      get: function(elem) {
        return elem.style[support.transition];
      },
      set: function(elem, value) {
        elem.style[support.transition] = value;
      }
    };
  }

  // ## Other CSS hooks
  // Allows you to rotate, scale and translate.
  registerCssHook('scale');
  registerCssHook('translate');
  registerCssHook('rotate');
  registerCssHook('rotateX');
  registerCssHook('rotateY');
  registerCssHook('rotate3d');
  registerCssHook('perspective');
  registerCssHook('skewX');
  registerCssHook('skewY');
  registerCssHook('x', true);
  registerCssHook('y', true);

  // ## Transform class
  // This is the main class of a transformation property that powers
  // `$.fn.css({ transform: '...' })`.
  //
  // This is, in essence, a dictionary object with key/values as `-transform`
  // properties.
  //
  //     var t = new Transform("rotate(90) scale(4)");
  //
  //     t.rotate             //=> "90deg"
  //     t.scale              //=> "4,4"
  //
  // Setters are accounted for.
  //
  //     t.set('rotate', 4)
  //     t.rotate             //=> "4deg"
  //
  // Convert it to a CSS string using the `toString()` and `toString(true)` (for WebKit)
  // functions.
  //
  //     t.toString()         //=> "rotate(90deg) scale(4,4)"
  //     t.toString(true)     //=> "rotate(90deg) scale3d(4,4,0)" (WebKit version)
  //
  function Transform(str) {
    if (typeof str === 'string') { this.parse(str); }
    return this;
  }

  Transform.prototype = {
    // ### setFromString()
    // Sets a property from a string.
    //
    //     t.setFromString('scale', '2,4');
    //     // Same as set('scale', '2', '4');
    //
    setFromString: function(prop, val) {
      var args =
        (typeof val === 'string')  ? val.split(',') :
        (val.constructor === Array) ? val :
        [ val ];

      args.unshift(prop);

      Transform.prototype.set.apply(this, args);
    },

    // ### set()
    // Sets a property.
    //
    //     t.set('scale', 2, 4);
    //
    set: function(prop) {
      var args = Array.prototype.slice.apply(arguments, [1]);
      if (this.setter[prop]) {
        this.setter[prop].apply(this, args);
      } else {
        this[prop] = args.join(',');
      }
    },

    get: function(prop) {
      if (this.getter[prop]) {
        return this.getter[prop].apply(this);
      } else {
        return this[prop] || 0;
      }
    },

    setter: {
      // ### rotate
      //
      //     .css({ rotate: 30 })
      //     .css({ rotate: "30" })
      //     .css({ rotate: "30deg" })
      //     .css({ rotate: "30deg" })
      //
      rotate: function(theta) {
        this.rotate = unit(theta, 'deg');
      },

      rotateX: function(theta) {
        this.rotateX = unit(theta, 'deg');
      },

      rotateY: function(theta) {
        this.rotateY = unit(theta, 'deg');
      },

      // ### scale
      //
      //     .css({ scale: 9 })      //=> "scale(9,9)"
      //     .css({ scale: '3,2' })  //=> "scale(3,2)"
      //
      scale: function(x, y) {
        if (y === undefined) { y = x; }
        this.scale = x + "," + y;
      },

      // ### skewX + skewY
      skewX: function(x) {
        this.skewX = unit(x, 'deg');
      },

      skewY: function(y) {
        this.skewY = unit(y, 'deg');
      },

      // ### perspectvie
      perspective: function(dist) {
        this.perspective = unit(dist, 'px');
      },

      // ### x / y
      // Translations. Notice how this keeps the other value.
      //
      //     .css({ x: 4 })       //=> "translate(4px, 0)"
      //     .css({ y: 10 })      //=> "translate(4px, 10px)"
      //
      x: function(x) {
        this.set('translate', x, null);
      },

      y: function(y) {
        this.set('translate', null, y);
      },

      // ### translate
      // Notice how this keeps the other value.
      //
      //     .css({ translate: '2, 5' })    //=> "translate(2px, 5px)"
      //
      translate: function(x, y) {
        if (this._translateX === undefined) { this._translateX = 0; }
        if (this._translateY === undefined) { this._translateY = 0; }

        if (x !== null && x !== undefined) { this._translateX = unit(x, 'px'); }
        if (y !== null && y !== undefined) { this._translateY = unit(y, 'px'); }

        this.translate = this._translateX + "," + this._translateY;
      }
    },

    getter: {
      x: function() {
        return this._translateX || 0;
      },

      y: function() {
        return this._translateY || 0;
      },

      scale: function() {
        var s = (this.scale || "1,1").split(',');
        if (s[0]) { s[0] = parseFloat(s[0]); }
        if (s[1]) { s[1] = parseFloat(s[1]); }

        // "2.5,2.5" => 2.5
        // "2.5,1" => [2.5,1]
        return (s[0] === s[1]) ? s[0] : s;
      },

      rotate3d: function() {
        var s = (this.rotate3d || "0,0,0,0deg").split(',');
        for (var i=0; i<=3; ++i) {
          if (s[i]) { s[i] = parseFloat(s[i]); }
        }
        if (s[3]) { s[3] = unit(s[3], 'deg'); }

        return s;
      }
    },

    // ### parse()
    // Parses from a string. Called on constructor.
    parse: function(str) {
      var self = this;
      str.replace(/([a-zA-Z0-9]+)\((.*?)\)/g, function(x, prop, val) {
        self.setFromString(prop, val);
      });
    },

    // ### toString()
    // Converts to a `transition` CSS property string. If `use3d` is given,
    // it converts to a `-webkit-transition` CSS property string instead.
    toString: function(use3d) {
      var re = [];

      for (var i in this) {
        if (this.hasOwnProperty(i)) {
          // Don't use 3D transformations if the browser can't support it.
          if ((!support.transform3d) && (
            (i === 'rotateX') ||
            (i === 'rotateY') ||
            (i === 'perspective') ||
            (i === 'transformOrigin'))) { continue; }

          if (i[0] !== '_') {
            if (use3d && (i === 'scale')) {
              re.push(i + "3d(" + this[i] + ",1)");
            } else if (use3d && (i === 'translate')) {
              re.push(i + "3d(" + this[i] + ",0)");
            } else {
              re.push(i + "(" + this[i] + ")");
            }
          }
        }
      }

      return re.join(" ");
    }
  };

  function callOrQueue(self, queue, fn) {
    if (queue === true) {
      self.queue(fn);
    } else if (queue) {
      self.queue(queue, fn);
    } else {
      fn();
    }
  }

  // ### getProperties(dict)
  // Returns properties (for `transition-property`) for dictionary `props`. The
  // value of `props` is what you would expect in `$.css(...)`.
  function getProperties(props) {
    var re = [];

    $.each(props, function(key) {
      key = $.camelCase(key); // Convert "text-align" => "textAlign"
      key = $.transit.propertyMap[key] || $.cssProps[key] || key;
      key = uncamel(key); // Convert back to dasherized

      if ($.inArray(key, re) === -1) { re.push(key); }
    });

    return re;
  }

  // ### getTransition()
  // Returns the transition string to be used for the `transition` CSS property.
  //
  // Example:
  //
  //     getTransition({ opacity: 1, rotate: 30 }, 500, 'ease');
  //     //=> 'opacity 500ms ease, -webkit-transform 500ms ease'
  //
  function getTransition(properties, duration, easing, delay) {
    // Get the CSS properties needed.
    var props = getProperties(properties);

    // Account for aliases (`in` => `ease-in`).
    if ($.cssEase[easing]) { easing = $.cssEase[easing]; }

    // Build the duration/easing/delay attributes for it.
    var attribs = '' + toMS(duration) + ' ' + easing;
    if (parseInt(delay, 10) > 0) { attribs += ' ' + toMS(delay); }

    // For more properties, add them this way:
    // "margin 200ms ease, padding 200ms ease, ..."
    var transitions = [];
    $.each(props, function(i, name) {
      transitions.push(name + ' ' + attribs);
    });

    return transitions.join(', ');
  }

  // ## $.fn.transition
  // Works like $.fn.animate(), but uses CSS transitions.
  //
  //     $("...").transition({ opacity: 0.1, scale: 0.3 });
  //
  //     // Specific duration
  //     $("...").transition({ opacity: 0.1, scale: 0.3 }, 500);
  //
  //     // With duration and easing
  //     $("...").transition({ opacity: 0.1, scale: 0.3 }, 500, 'in');
  //
  //     // With callback
  //     $("...").transition({ opacity: 0.1, scale: 0.3 }, function() { ... });
  //
  //     // With everything
  //     $("...").transition({ opacity: 0.1, scale: 0.3 }, 500, 'in', function() { ... });
  //
  //     // Alternate syntax
  //     $("...").transition({
  //       opacity: 0.1,
  //       duration: 200,
  //       delay: 40,
  //       easing: 'in',
  //       complete: function() { /* ... */ }
  //      });
  //
  $.fn.transition = $.fn.transit = function(properties, duration, easing, callback) {
    var self  = this;
    var delay = 0;
    var queue = true;

    // Account for `.transition(properties, callback)`.
    if (typeof duration === 'function') {
      callback = duration;
      duration = undefined;
    }

    // Account for `.transition(properties, duration, callback)`.
    if (typeof easing === 'function') {
      callback = easing;
      easing = undefined;
    }

    // Alternate syntax.
    if (typeof properties.easing !== 'undefined') {
      easing = properties.easing;
      delete properties.easing;
    }

    if (typeof properties.duration !== 'undefined') {
      duration = properties.duration;
      delete properties.duration;
    }

    if (typeof properties.complete !== 'undefined') {
      callback = properties.complete;
      delete properties.complete;
    }

    if (typeof properties.queue !== 'undefined') {
      queue = properties.queue;
      delete properties.queue;
    }

    if (typeof properties.delay !== 'undefined') {
      delay = properties.delay;
      delete properties.delay;
    }

    // Set defaults. (`400` duration, `ease` easing)
    if (typeof duration === 'undefined') { duration = $.fx.speeds._default; }
    if (typeof easing === 'undefined')   { easing = $.cssEase._default; }

    duration = toMS(duration);

    // Build the `transition` property.
    var transitionValue = getTransition(properties, duration, easing, delay);

    // Compute delay until callback.
    // If this becomes 0, don't bother setting the transition property.
    var work = $.transit.enabled && support.transition;
    var i = work ? (parseInt(duration, 10) + parseInt(delay, 10)) : 0;

    // If there's nothing to do...
    if (i === 0) {
      var fn = function(next) {
        self.css(properties);
        if (callback) { callback.apply(self); }
        if (next) { next(); }
      };

      callOrQueue(self, queue, fn);
      return self;
    }

    // Save the old transitions of each element so we can restore it later.
    var oldTransitions = {};

    var run = function(nextCall) {
      var bound = false;

      // Prepare the callback.
      var cb = function() {
        if (bound) { self.unbind(transitionEnd, cb); }

        if (i > 0) {
          self.each(function() {
            this.style[support.transition] = (oldTransitions[this] || null);
          });
        }

        if (typeof callback === 'function') { callback.apply(self); }
        if (typeof nextCall === 'function') { nextCall(); }
      };

      if ((i > 0) && (transitionEnd) && ($.transit.useTransitionEnd)) {
        // Use the 'transitionend' event if it's available.
        bound = true;
        self.bind(transitionEnd, cb);
      } else {
        // Fallback to timers if the 'transitionend' event isn't supported.
        window.setTimeout(cb, i);
      }

      // Apply transitions.
      self.each(function() {
        if (i > 0) {
          this.style[support.transition] = transitionValue;
        }
        $(this).css(properties);
      });
    };

    // Defer running. This allows the browser to paint any pending CSS it hasn't
    // painted yet before doing the transitions.
    var deferredRun = function(next) {
        this.offsetWidth; // force a repaint
        run(next);
    };

    // Use jQuery's fx queue.
    callOrQueue(self, queue, deferredRun);

    // Chainability.
    return this;
  };

  function registerCssHook(prop, isPixels) {
    // For certain properties, the 'px' should not be implied.
    if (!isPixels) { $.cssNumber[prop] = true; }

    $.transit.propertyMap[prop] = support.transform;

    $.cssHooks[prop] = {
      get: function(elem) {
        var t = $(elem).css('transit:transform');
        return t.get(prop);
      },

      set: function(elem, value) {
        var t = $(elem).css('transit:transform');
        t.setFromString(prop, value);

        $(elem).css({ 'transit:transform': t });
      }
    };

  }

  // ### uncamel(str)
  // Converts a camelcase string to a dasherized string.
  // (`marginLeft` => `margin-left`)
  function uncamel(str) {
    return str.replace(/([A-Z])/g, function(letter) { return '-' + letter.toLowerCase(); });
  }

  // ### unit(number, unit)
  // Ensures that number `number` has a unit. If no unit is found, assume the
  // default is `unit`.
  //
  //     unit(2, 'px')          //=> "2px"
  //     unit("30deg", 'rad')   //=> "30deg"
  //
  function unit(i, units) {
    if ((typeof i === "string") && (!i.match(/^[\-0-9\.]+$/))) {
      return i;
    } else {
      return "" + i + units;
    }
  }

  // ### toMS(duration)
  // Converts given `duration` to a millisecond string.
  //
  //     toMS('fast')   //=> '400ms'
  //     toMS(10)       //=> '10ms'
  //
  function toMS(duration) {
    var i = duration;

    // Allow for string durations like 'fast'.
    if ($.fx.speeds[i]) { i = $.fx.speeds[i]; }

    return unit(i, 'ms');
  }

  // Export some functions for testable-ness.
  $.transit.getTransitionValue = getTransition;
})(jQuery);
/*! JsRender v1.0pre: http://github.com/BorisMoore/jsrender */
/*
* Optimized version of jQuery Templates, for rendering to string.
* Does not require jQuery, or HTML DOM
* Integrates with JsViews (http://github.com/BorisMoore/jsviews)
* Copyright 2012, Boris Moore
* Released under the MIT License.
*/
// informal pre beta commit counter: 22

(function(global, jQuery, undefined) {
	// global is the this object, which is window when running in the usual browser environment.
	"use strict";

	if (jQuery && jQuery.views || global.jsviews) { return; } // JsRender is already loaded

	//========================== Top-level vars ==========================

	var versionNumber = "v1.0pre",

		$, jsvStoreName, rTag, rTmplString,
//TODO	tmplFnsCache = {},
		delimOpenChar0 = "{", delimOpenChar1 = "{", delimCloseChar0 = "}", delimCloseChar1 = "}", linkChar = "^",
		FALSE = false, TRUE = true,

		rPath = /^(?:null|true|false|\d[\d.]*|([\w$]+|\.|~([\w$]+)|#(view|([\w$]+))?)([\w$.^]*?)(?:[.[^]([\w$]+)\]?)?)$/g,
		//                                     object     helper    view  viewProperty pathTokens      leafToken

		rParams = /(\()(?=|\s*\()|(?:([([])\s*)?(?:([#~]?[\w$.^]+)?\s*((\+\+|--)|\+|-|&&|\|\||===|!==|==|!=|<=|>=|[<>%*!:?\/]|(=))\s*|([#~]?[\w$.^]+)([([])?)|(,\s*)|(\(?)\\?(?:(')|("))|(?:\s*([)\]])([([]?))|(\s+)/g,
		//          lftPrn        lftPrn2                 path    operator err                                                eq          path2       prn    comma   lftPrn2   apos quot        rtPrn   prn2   space
		// (left paren? followed by (path? followed by operator) or (path followed by paren?)) or comma or apos or quot or right paren or space

		rNewLine = /\r?\n/g,
		rUnescapeQuotes = /\\(['"])/g,
		// escape quotes and \ character
		rEscapeQuotes = /([\\'"])/g,
		rBuildHash = /\x08(~)?([^\x08]+)\x08/g,
		rTestElseIf = /^if\s/,
		rFirstElem = /<(\w+)[>\s]/,
		rPrevElem = /<(\w+)[^>\/]*>[^>]*$/,
		autoTmplName = 0,
		viewId = 0,
		escapeMapForHtml = {
			"&": "&amp;",
			"<": "&lt;",
			">": "&gt;"
		},
        attrEncodeChars = /[<"'&]/g,
		htmlEncodeChars = /[\x00<>"'&]/g,
		tmplAttr = "data-jsv-tmpl",
		fnDeclStr = "var j=j||" + (jQuery ? "jQuery." : "js") + "views,",
		slice = [].slice,

		$render = {},
		jsvStores = {
			template: {
				compile: compileTmpl
			},
			tag: {
				compile: compileTag
			},
			helper: {},
			converter: {}
		},

		// jsviews object ($.views if jQuery is loaded)
		$views = {
			jsviews: versionNumber,
			render: $render,
			View: View,
			settings: {
				delimiters: $viewsDelimiters,
				debugMode: TRUE
			},
			sub: {
				// subscription, e.g. JsViews integration
				Error: JsViewsError,
				tmplFn: tmplFn,
				parse: parseParams,
				extend: $extend,
				error: error
//TODO			invoke: $invoke
			},
			_cnvt: convertVal,
			_tag: renderTag,

			// TODO provide better debug experience - e.g. support $.views.onError callback
			_err: function(e) {
				// Place a breakpoint here to intercept template rendering errors
				return $viewsSettings.debugMode ? ("Error: " + (e.message || e)) + ". " : '';
			}
		};

		function JsViewsError(message, object) {
			// Error exception type for JsViews/JsRender
			// Override of $.views.sub.Error is possible
			if (object && object.onError) {
				if (object.onError(message) === FALSE) {
					return;
				}
			}
			this.name = "JsRender Error";
			this.message = message || "JsRender error";
		}

		function $extend(target, source) {
			var name;
			target = target || {};
			for (name in source) {
				target[name] = source[name];
			}
			return target;
		}

//TODO		function $invoke() {
//			try {
//				return arguments[1].apply(arguments[0], arguments[2]);
//			}
//			catch(e) {
//				throw new $views.sub.Error(e, arguments[0]);
//			}
//		}

		(JsViewsError.prototype = new Error()).constructor = JsViewsError;

	//========================== Top-level functions ==========================

	//===================
	// jsviews.delimiters
	//===================

	function $viewsDelimiters(openChars, closeChars, link) {
		// Set the tag opening and closing delimiters and 'link' character. Default is "{{", "}}" and "^"
		// openChars, closeChars: opening and closing strings, each with two characters

		if (!$views.rTag || arguments.length) {
			delimOpenChar0 = openChars ? openChars.charAt(0) : delimOpenChar0; // Escape the characters - since they could be regex special characters
			delimOpenChar1 = openChars ? openChars.charAt(1) : delimOpenChar1;
			delimCloseChar0 = closeChars ? closeChars.charAt(0) : delimCloseChar0;
			delimCloseChar1 = closeChars ? closeChars.charAt(1) : delimCloseChar1;
			linkChar = link || linkChar;
			openChars = "\\" + delimOpenChar0 + "(\\" + linkChar + ")?\\" + delimOpenChar1;  // Default is "{^{"
			closeChars = "\\" + delimCloseChar0 + "\\" + delimCloseChar1;                   // Default is "}}"
			// Build regex with new delimiters
			//          tag    (followed by / space or })   or cvtr+colon or html or code
			rTag = "(?:(?:(\\w+(?=[\\/\\s\\" + delimCloseChar0 + "]))|(?:(\\w+)?(:)|(>)|!--((?:[^-]|-(?!-))*)--|(\\*)))"
				+ "\\s*((?:[^\\" + delimCloseChar0 + "]|\\" + delimCloseChar0 + "(?!\\" + delimCloseChar1 + "))*?)";

			// make rTag available to JsViews (or other components) for parsing binding expressions
			$views.rTag = rTag + ")";

			rTag = new RegExp(openChars + rTag + "(\\/)?|(?:\\/(\\w+)))" + closeChars, "g");

			// Default:    bind           tag       converter colon html     comment            code      params            slash   closeBlock
			//           /{(\^)?{(?:(?:(\w+(?=[\/\s}]))|(?:(\w+)?(:)|(>)|!--((?:[^-]|-(?!-))*)--|(\*)))\s*((?:[^}]|}(?!}))*?)(\/)?|(?:\/(\w+)))}}/g

			rTmplString = new RegExp("<.*>|([^\\\\]|^)[{}]|" + openChars + ".*" + closeChars);
			// rTmplString looks for html tags or { or } char not preceded by \\, or JsRender tags {{xxx}}. Each of these strings are considered NOT to be jQuery selectors
		}
		return [delimOpenChar0, delimOpenChar1, delimCloseChar0, delimCloseChar1, linkChar];
	}

	//=========
	// View.get
	//=========

	function getView(type) {
		// TODO complete/test/provide samples for this
		// If type is undefined, returns root view (view under top view).
		var view = this,
			root = !type || type === "root";
		while (root && view.parent.parent || view && view.type !== type) {
			view = view.parent;
		}
		return view;
	}

	//==========
	// View._hlp
	//==========

	function getHelper(helper) {
		// Helper method called as view._hlp(key) from compiled template, for helper functions or template parameters ~foo
		var wrapped,
			view = this,
			viewCtx = view.ctx ||{},
			tmplHelpers = view.tmpl.helpers || {};

		helper = (
			viewCtx[helper] !== undefined
				? viewCtx
				: tmplHelpers[helper] !== undefined
					? tmplHelpers
					: $helpers[helper] !== undefined
						? $helpers
						: {}
		)[helper];

		if (helper) {
			if (typeof helper === "function") {
				wrapped = function() {
						// If it is of type function, we will wrap it so it gets called with view as 'this' context.
						// If the helper ~foo() was in a data-link expression, the view will have a 'temporary' linkCtx property too.
						// However note that helper functions on deeper paths will not have access to view and tagCtx.
						// For example, ~util.foo() will have the ~util object as 'this' pointer
						var i,
							args = arguments;

						for (i in args) {
							if (typeof args[i] === "function") {
								args[i] = args[i].call(view.data);
							}
						}
						return helper.apply(view, args);
					};
				wrapped.depends = helper.depends;
			}
		}
		return wrapped || helper;
	}

	//==============
	// jsviews._cnvt
	//==============

	function convertVal(converter, view, self, tagCtx, bindingPaths, text) {
		// self is template object or linkCtx object
		if (converter || bindingPaths) {
			var tmplConverter,
				linkCtx = !self.markup && self,
				tag = {
					tagName:  converter + ":",
					tagCtx: tagCtx
				},
				args = tagCtx.args = slice.call(arguments, 5);

			tagCtx.view = view;
			tagCtx.bind = !!(linkCtx || bindingPaths);

			if (linkCtx) {
				linkCtx.tag = tag;
				tag.linkCtx = linkCtx;
				tagCtx.ctx = extendCtx(tagCtx.ctx, linkCtx.view.ctx);
			}
			tag.ctx = tagCtx.ctx || {};
			delete tagCtx.ctx;

			if (converter) {
				// A call to {{cnvt: ... }} or {^{cnvt: ... }} or data-link="{cnvt: ... }"
				tmplConverter = view.tmpl.converters;
				tmplConverter = tmplConverter && tmplConverter[converter] || $converters[converter];
				if (tmplConverter || error("Unknown converter: {{"+ converter + ":")) {
					text = tmplConverter.apply(tag, args);
				}
			}
			if (bindingPaths) {
				// A call to {^{: ... }} or {^{cnvt: ... }}
				bindingPaths = view.tmpl.bnds[bindingPaths-1];
				linkCtx.paths = bindingPaths;
				// Consider being able to switch off binding if parent view is not currently bound.
				view._.tag = tag; // Provide this tag on view, for markerNode on bound tags, and for getting the tagCtx and linkCtx during rendering.
				// Provide this tag on view, for addMarkerNode on bound tags to add the tag to view._.bnds, associated with the tag id,
				// and so when rendering subsequent {{else}}, will be associated with this tag
				//TODO does this work with nested elses and with {^{foo:...}} which also adds tag to view, for markerNodes.
				text = view._.onRender(text, view, TRUE);
	//Example:  text = '<script type="jsv123"></script>' + text + '<script type="jsv123/"></script>';
			}
		}
		return text;
	}

	//=============
	// jsviews._tag
	//=============

	function renderTag(tagName, parentView, self, content, tagCtx, bind) {
		// Called from within compiled template function, to render a template tag
		// Returns the rendered tag

		var ret, render, ctx, elses, tag, tags,
			tmpl = self.markup && self,
			// self is either a template object (if rendering a tag) or a linkCtx object (if linking using a link tag)
			linkCtx = !tmpl && self,
			parentView_ = parentView._,
			parentTmpl = tmpl || parentView.tmpl,
			tmplTags = parentTmpl.tags,
			childTemplates = parentTmpl.templates,
			tagDef = tmplTags && tmplTags[tagName] || $tags[tagName],
			args = tagCtx.args = arguments.length > 6 ? slice.call(arguments, 6) : [],
			props = tagCtx.props || {};

		tagCtx.view = parentView;
		tagCtx.ctx = extendCtx(tagCtx.ctx, parentView.ctx); // Extend parentView.ctx
		ctx = tagCtx.ctx || {};
		delete tagCtx.ctx;

		if (!tagDef) {
			error("Unknown tag: {{"+ tagName + "}}");
			return "";
		}
		tmpl = props.tmpl;

		// Set the tmpl property to the content of the block tag, unless set as an override property on the tag
		content = content && parentTmpl.tmpls[content - 1];
		tmpl = tmpl || content || tagDef.template || undefined;
		tmpl = "" + tmpl === tmpl // if a string
			? childTemplates && childTemplates[tmpl] || $templates[tmpl] || $templates(tmpl)
			: tmpl;

		if (tagName === "else") {
			tag = parentView._.tag;
			// Switch current tagCtx of tag instance to this {{else ...}}
			elses = tag._elses = tag._elses || [];
			elses.push(tmpl);
			tagCtx.isElse = elses.length;
			render = tag.render;
		}
		if (tagDef.init) {
			// init is the constructor for the tag/control instance

			// tags hash: tag.ctx.tags, merged with parentView.ctx.tags,
			tags = ctx.tags = parentView.ctx && extendCtx(ctx.tags, parentView.ctx.tags) || {};

			tag = tag || linkCtx.tag;
			if (tag) {
				// tag has already been instantiated, so keep it, but attach the current context, which may have changed
				// Add tag to tags hash
				tags[tagName] = tag;
			} else {
				// If the tag has not already been instantiated, we will create a new instance and add to the tags hash,
				// so ~tags.tagName will access the tag, even within the rendering of the template content of this tag
//	TODO provide error handling owned by the tag - using tag.onError
//			try {
					tag = tags[tagName] = new tagDef.init(tagCtx, linkCtx, ctx);
//				}
//				catch(e) {
//					tagDef.onError(e);
//				}
				tag.tmpl = tmpl;

				if (linkCtx) {
					tag.attr =
						// Setting attr on tag so renderContent knows whether to include script node markers.
						linkCtx.attr =
							// Setting attr on self to ensure outputting to the correct target attribute.
							linkCtx.attr || tagDef.attr || "";
				}
			}
			ctx.tag = tag;
		} else {
			// This is a simple tag declared as a function. We won't instantiate a specific tag constructor - just a standard instance object.
			tag = tag || {
				// tag instance object if no init constructor
				render: tagDef.render,
				renderContent: renderContent,
				tmpl: tmpl,
				tagName: tagName
			};
		}

		// Provide tagCtx, linkCtx and ctx access from tag
		tag.tagCtx = tagCtx;
		tag.ctx = ctx;
		if (linkCtx) {
			linkCtx.tag = tag;
			tag.linkCtx = linkCtx;
		}

		tag._is = "tag";
		tag._done = tagCtx.isElse ? tag._done : FALSE; // If not an {{else}} this is a new
		tmpl = tmpl || tag.tmpl;
		elses = tag._elses;

//TODO The above works for initial rendering, but when refreshing {^{foo}} need also to associate with {{else}} tags. Use compilation to bind else content templates and expressions with the primary tag template and expression.

		parentView_.tag = tag;
		// Provide this tag on view, for addMarkerNode on bound tags to add the tag to view._.bnds, associated with the tag id,
		// for getting the tagCtx and linkCtx during rendering, and so when rendering subsequent {{else}}, will be associated with this tag
		//TODO does this work with nested elses and with {^{foo:...}} which also adds tag to view, for markerNodes.

//		while (tmpl) {
			// If tagDef has a 'render' function, call it.
			// If the return result is undefined, return "", or, if a template (or content) is provided,
			// return the rendered template(using the current data or the first parameter as data);
			if (render = render || tag.render) {
				ret = render.apply(tag, args);

//	TODO		ret = $invoke(tag, render, args);
			}
			ret = ret !== undefined
				? ret    // Return result of render function unless it is undefined, in which case return rendered template
				: tmpl
					// render template on args[0] if defined, or otherwise on the current data item
					? tag.renderContent(tagCtx.data !== undefined ? tagCtx.data : parentView.data, undefined, parentView)
					: ""; // No return value from render, and no template defined, so return ::

//			tmpl = (tag !== "else" && elses) ? (tagCtx.isElse = tagCtx.isElse || 0, elses[tagCtx.isElse++]) : undefined;
//}

		// If bind, for {^{tag ... }}, insert script marker nodes
		return bind ? parentView_.onRender(ret, parentView, bind) : ret;
	}

	//=================
	// View constructor
	//=================

	function View(context, type, parentView, data, template, key, onRender) {
		// Constructor for view object in view hierarchy. (Augmented by JsViews if JsViews is loaded)
		var views, parentView_,
			isArray = type === "array",
			self_ = {
				key: 0,
				useKey: isArray ? 0 : 1,
				id: "" + viewId++,
				onRender: onRender,
				bnd: {}
			},
			self = {
				data: data,
				tmpl: template,
				views: isArray ? [] : {},
				parent: parentView,
				ctx: context,
				type: type,
				// If the data is an array, this is an 'array view' with a views array for each child 'item view'
				// If the data is not an array, this is an 'item view' with a views 'map' object for any child nested views
				// _useKey is non zero if is not an 'array view' (owning a data array). Uuse this as next key for adding to child views map
				get: getView,
				_hlp: getHelper,
				_: self_
		};

		if (parentView) {
			views = parentView.views;
			parentView_ = parentView._;
			if (parentView_.useKey) {
				// Parent is an 'item view'. Add this view to its views object
				// self._key = is the key in the parent view map
				views[self_.key = "_" + parentView_.useKey++] = self;
			} else {
				// Parent is an 'array view'. Add this view to its views array
				views.splice(
					// self._.key = self.index - the index in the parent view array
					self_.key = self.index =
						key !== undefined
							? key
							: views.length,
				0, self);
			}
			// If no context was passed in, use parent context
			// If context was passed in, it should have been merged already with parent context
			self.ctx = context || parentView.ctx;
		}
		return self;
	}

	//=============
	// Registration
	//=============

	function compileChildResources(parentTmpl) {
		var storeName, resources, resourceName, settings, compile;
		for (storeName in jsvStores) {
			settings = jsvStores[storeName];
			if ((compile = settings.compile) && (resources = parentTmpl[storeName + "s"])) {
				for (resourceName in resources) {
					// compile child resource declarations (templates, tags, converters or helpers)
					resources[resourceName] = compile(resourceName, resources[resourceName], parentTmpl, storeName, settings);
				}
			}
		}
	}

	function compileTag(name, item, parentTmpl) {
		var init, tmpl;
		if (typeof item === "function") {
			// Simple tag declared as function. No presenter instantation.
			item = {
				tagName: name,
				render: item,
				depends: item.depends
			};
		} else {
			// Tag declared as object, used as the prototype for tag instantiation (control/presenter)
			item.tagName = name;
			if (tmpl = item.template) {
				item.template = "" + tmpl === tmpl ? ($templates[tmpl] || $templates(tmpl)) : tmpl;
			}
			if (item.init !== FALSE) {
				init = item.init = item.init || function(tagCtx) {};
				init.prototype = item;
				(init.prototype = item).constructor = init;
			}
		}
		item.renderContent = renderContent;
		item.attr = "html";
		if (parentTmpl) {
			item._parentTmpl = parentTmpl;
		}
//TODO	item.onError = function(e) {
//			var error;
//			if (error = this.prototype.onError) {
//				error.call(this, e);
//			} else {
//				throw e;
//			}
//		}
		return item;
	}

	function compileTmpl(name, tmpl, parentTmpl, storeName, storeSettings, options) {
		// tmpl is either a template object, a selector for a template script block, the name of a compiled template, or a template object

		//==== nested functions ====
		function tmplOrMarkupFromStr(value) {
			// If value is of type string - treat as selector, or name of compiled template
			// Return the template object, if already compiled, or the markup string

			if (("" + value === value) || value.nodeType > 0) {
				try {
					elem = value.nodeType > 0
					? value
					: !rTmplString.test(value)
					// If value is a string and does not contain HTML or tag content, then test as selector
						&& jQuery && jQuery(value)[0];
					// If selector is valid and returns at least one element, get first element
					// If invalid, jQuery will throw. We will stay with the original string.
				} catch (e) { }

				if (elem) {
					// Generally this is a script element.
					// However we allow it to be any element, so you can for example take the content of a div,
					// use it as a template, and replace it by the same content rendered against data.
					// e.g. for linking the content of a div to a container, and using the initial content as template:
					// $.link("#content", model, {tmpl: "#content"});

					// Create a name for compiled template if none provided
					value = $templates[elem.getAttribute(tmplAttr)];
					if (!value) {
						// Not already compiled and cached, so compile and cache the name
						name = name || "_" + autoTmplName++;
						elem.setAttribute(tmplAttr, name);
						$templates[name] = value = compileTmpl(name, elem.innerHTML, parentTmpl, storeName, storeSettings, options); // Use tmpl as options
					}
				}
				return value;
			}
			// If value is not a string, return undefined
		}

		var tmplOrMarkup, elem;

		//==== Compile the template ====
		tmpl = tmpl || "";
		tmplOrMarkup = tmplOrMarkupFromStr(tmpl);

		// If options, then this was already compiled from a (script) element template declaration.
		// If not, then if tmpl is a template object, use it for options
		options = options || (tmpl.markup ? tmpl : {});
		options.tmplName = name;
		if (parentTmpl) {
			options._parentTmpl = parentTmpl;
		}
		// If tmpl is not a markup string or a selector string, then it must be a template object
		// In that case, get it from the markup property of the object
		if (!tmplOrMarkup && tmpl.markup && (tmplOrMarkup = tmplOrMarkupFromStr(tmpl.markup))) {
			if (tmplOrMarkup.fn && (tmplOrMarkup.debug !== tmpl.debug || tmplOrMarkup.allowCode !== tmpl.allowCode)) {
				// if the string references a compiled template object, but the debug or allowCode props are different, need to recompile
				tmplOrMarkup = tmplOrMarkup.markup;
			}
		}
		if (tmplOrMarkup !== undefined) {
			if (name && !parentTmpl) {
				$render[name] = function() {
					return tmpl.render.apply(tmpl, arguments);
				};
			}
			if (tmplOrMarkup.fn || tmpl.fn) {
				// tmpl is already compiled, so use it, or if different name is provided, clone it
				if (tmplOrMarkup.fn) {
					if (name && name !== tmplOrMarkup.name) {
						tmpl = extendCtx(options, tmplOrMarkup);
					} else {
						tmpl = tmplOrMarkup;
					}
				}
			} else {
				// tmplOrMarkup is a markup string, not a compiled template
				// Create template object
				tmpl = TmplObject(tmplOrMarkup, options);
				// Compile to AST and then to compiled function
				tmplFn(tmplOrMarkup, tmpl);
			}
			compileChildResources(options);
			return tmpl;
		}
	}
	//==== /end of function compile ====

	function TmplObject(markup, options) {
		// Template object constructor
		var htmlTag,
			wrapMap = $viewsSettings.wrapMap || {},
			tmpl = $extend(
				{
					markup: markup,
					tmpls: [],
					links: {},
					bnds: [],
					render: renderContent
				},
				options
			);

		if (!options.htmlTag) {
			// Set tmpl.tag to the top-level HTML tag used in the template, if any...
			htmlTag = rFirstElem.exec(markup);
			tmpl.htmlTag = htmlTag ? htmlTag[1].toLowerCase() : "";
		}
		htmlTag = wrapMap[tmpl.htmlTag];
		if (htmlTag && htmlTag !== wrapMap.div) {
			// When using JsViews, we trim templates which are inserted into HTML contexts where text nodes are not rendered (i.e. not 'Phrasing Content').
			tmpl.markup = $.trim(tmpl.markup);
			tmpl._elCnt = TRUE; // element content model (no rendered text nodes), not phrasing content model
		}

		return tmpl;
	}

	function registerStore(storeName, storeSettings) {

		function theStore(name, item, parentTmpl) {
			// The store is also the function used to add items to the store. e.g. $.templates, or $.views.tags

			// For store of name 'thing', Call as:
			//    $.views.things(items[, parentTmpl]),
			// or $.views.things(name, item[, parentTmpl])

			var onStore, compile, items, itemName, childTemplates, childTemplate, thisStore, childStoreName;

			if (name && "" + name !== name && !name.nodeType && !name.markup) {
				// Call to $.views.things(items[, parentTmpl]),

				// Adding items to the store
				// If name is a map, then item is parentTmpl. Iterate over map and call store for key.
				for (itemName in name) {
					theStore(itemName, name[itemName], item);
				}
				return $views;
			}
			thisStore = parentTmpl ? parentTmpl[storeNames] = parentTmpl[storeNames] || {} : theStore;

			// Adding a single unnamed item to the store
			if (item === undefined) {
				item = name;
				name = undefined;
			}
			compile = storeSettings.compile;
			if (onStore = $viewsSub.onBeforeStoreItem) {
				// e.g. provide an external compiler or preprocess the item.
				compile = onStore(thisStore, name, item, compile) || compile;
			}
			if (!name) {
				item = compile(undefined, item);
			} else if ("" + name === name) { // name must be a string
				if (item === null) {
					// If item is null, delete this entry
					delete thisStore[name];
				} else {
					thisStore[name] = compile ? (item = compile(name, item, parentTmpl, storeName, storeSettings)) : item;
					if (storeName === "template" && (childTemplates = thisStore[name].templates)) {
						// This is a template which has child templates defined. We will copy child items of parent template to each
						// child template, since items registered with the parent templates must also be accessible from the child template
						for (childStoreName in jsvStores) {
							// Find child items registered for this parent template
							childStoreName += "s";
							if (items = item[childStoreName]) {
								// Copy these items to each child template
								for (childTemplate in childTemplates ) {
									childTemplate = childTemplates[childTemplate];
									// Copy parent items except if overridden by item of same name in child template
									childTemplate[childStoreName] = extendCtx(childTemplate[childStoreName], items);
								}
							}
						}
					}
				}
			}
			if (item) {
				item._is = storeName;
			}
			if (onStore = $viewsSub.onStoreItem) {
				// e.g. JsViews integration
				onStore(thisStore, name, item, compile);
			}
			return item;
		}

		var storeNames = storeName + "s";

		$views[storeNames] = theStore;
		jsvStores[storeName] = storeSettings;
	}

	//==============
	// renderContent
	//==============

	function renderContent(data, context, parentView, key, isLayout, onRender) {
		// Render template against data as a tree of subviews (nested rendered template instances), or as a string (top-level template).
		// If the data is the parent view, treat as layout template, re-render with the same data context.
		var i, l, dataItem, newView, childView, itemResult, parentContext, props, swapContent, tagCtx, isTag, outerOnRender,
			self = this,
			tmpl = self,
			allowDataLink = self.attr === undefined || self.attr === "html",
			result = "";

		if (key === TRUE) {
			swapContent = TRUE;
			key = 0;
		}
		if (isTag = self._is === "tag") {
			tagCtx = self.tagCtx;
			// This is a call from renderTag
			tmpl = tagCtx.isElse ? self._elses[tagCtx.isElse-1] : self.tmpl;
			context = extendCtx(context, self.ctx);
			props = tagCtx.props || {};
			if ( props.link === FALSE ) {
				// link=false setting on block tag
				// We will override inherited value of link by the explicit setting link=false taken from props
				// The child views of an unlinked view are also unlinked. So setting child back to true will not have any effect.
				context =  context || {};
				context.link = FALSE;
			}
			parentView = parentView || tagCtx.view;
		} else {
			tmpl = self.jquery && (self[0] || error('Unknown template: "' + self.selector + '"')) // This is a call from $(selector).render
				|| self;
		}
		if (tmpl) {
			if (parentView) {
				onRender = onRender || parentView._.onRender;
				parentContext = parentView.ctx;
				if (data === parentView) {
					// Inherit the data from the parent view.
					// This may be the contents of an {{if}} block
					// Set isLayout = true so we don't iterate the if block if the data is an array.
					data = parentView.data;
					isLayout = TRUE;
				}
			}

			// Set additional context on views created here, (as modified context inherited from the parent, and to be inherited by child views)
			// Note: If no jQuery, $extend does not support chained copies - so limit extend() to two parameters
			context = extendCtx(context, parentContext);

			if (!tmpl.fn) {
				tmpl = $templates[tmpl] || $templates(tmpl);
			}

			if (tmpl) {
				onRender = (context && context.link) !== FALSE && allowDataLink && onRender;
				// If link===false, do not call onRender, so no data-linking marker nodes
				outerOnRender = onRender;
				if (onRender === TRUE) {
					// Used by view.refresh(). Don't create a new wrapper view.
					outerOnRender = undefined;
					onRender = parentView._.onRender;
				}
				if ($.isArray(data) && !isLayout) {
					// Create a view for the array, whose child views correspond to each data item.
					// (Note: if key and parentView are passed in along with parent view, treat as
					// insert -e.g. from view.addViews - so parentView is already the view item for array)
					newView = swapContent ? parentView : (key !== undefined && parentView) || View(context, "array", parentView, data, tmpl, key, onRender);
					for (i = 0, l = data.length; i < l; i++) {
						// Create a view for each data item.
						dataItem = data[i];
						childView = View(context, "item", newView, dataItem, tmpl, (key || 0) + i, onRender);
						itemResult = tmpl.fn(dataItem, childView, $views);
						result += newView._.onRender ? newView._.onRender(itemResult, childView) : itemResult;
					}
				} else {
					// Create a view for singleton data object.
					newView = swapContent ? parentView : View(context, "data", parentView, data, tmpl, key, onRender);
					result += tmpl.fn(data, newView, $views);
				}
				return outerOnRender ? outerOnRender(result, newView) : result;
			}
		}
		return "";
	}

	//===========================
	// Build and compile template
	//===========================

	// Generate a reusable function that will serve to render a template against data
	// (Compile AST then build template function)

	function error(message) {
		if ($viewsSettings.debugMode) {
			throw new $views.sub.Error(message);
		}
	}

	function syntaxError(message) {
		error("Syntax error\n" + message);
	}

	function tmplFn(markup, tmpl, isLinkExpression) {
		// Compile markup to AST (abtract syntax tree) then build the template function code from the AST nodes
		// Used for compiling templates, and also by JsViews to build functions for data link expressions


		//==== nested functions ====
		function pushprecedingContent(shift) {
			shift -= loc;
			if (shift) {
				content.push(markup.substr(loc, shift).replace(rNewLine, "\\n"));
			}
		}

		function blockTagCheck(tagName) {
			tagName && syntaxError('Unmatched or missing tag: "{{/' + tagName + '}}" in template:\n' + markup);
		}

		function parseTag(all, bind, tagName, converter, colon, html, comment, codeTag, params, slash, closeBlock, index) {

			//    bind         tag        converter colon html     comment            code      params            slash   closeBlock
			// /{(\^)?{(?:(?:(\w+(?=[\/\s}]))|(?:(\w+)?(:)|(>)|!--((?:[^-]|-(?!-))*)--|(\*)))\s*((?:[^}]|}(?!}))*?)(\/)?|(?:\/(\w+)))}}/g

			// Build abstract syntax tree (AST): [ tagName, converter, params, content, hash, bindings, contentMarkup ]
			if (html) {
				colon = ":";
				converter = "html";
			}
			var current0,
				pathBindings = [],
				code = "",
				hash = "",
				passedCtx = "",
				// Block tag if not self-closing and not {{:}} or {{>}} (special case) and not a data-link expression
				block = !slash && !colon && !comment && !isLinkExpression;

			//==== nested helper function ====
			tagName = tagName || colon;
			pushprecedingContent(index);
			loc = index + all.length; // location marker - parsed up to here
			if (codeTag) {
				if (allowCode) {
					content.push(["*", "\n" + params.replace(rUnescapeQuotes, "$1") + "\n"]);
				}
			} else if (tagName) {
				if (tagName === "else") {
					if (rTestElseIf.test(params)) {
						syntaxError('for "{{else if expr}}" use "{{else expr}}"');
					}
					current[6] = markup.substring(current[6], index); // contentMarkup for block tag
					current = stack.pop();
					content = current[3];
					block = TRUE;
				}
				if (params) {
					code = parseParams(params, pathBindings)
						.replace(rBuildHash, function(all, isCtx, keyValue) {
							if (isCtx) {
								passedCtx += keyValue + ",";
							} else {
								hash += keyValue + ",";
							}
							return "";
						});
				}
				hash = hash.slice(0, -1);
				code = code.slice(0, -1);
				newNode = [
						tagName,
						converter || "",
						code,
						block && [],
						"{" + (hash ? ("props:{" + hash + "},") : "") + 'params:"' + params + '"' + (passedCtx ? ",ctx:{" + passedCtx.slice(0, -1) + "}" : "") + "},",
						bind && pathBindings || 0
					];
				content.push(newNode);
				if (block) {
					stack.push(current);
					current = newNode;
					current[6] = loc; // Store current location of open tag, to be able to add contentMarkup when we reach closing tag
				}
			} else if (closeBlock) {
				current0 = current[0];
				blockTagCheck(closeBlock !== current0 && current0 && current0 !== "else");
				current[6] = markup.substring(current[6], index); // contentMarkup for block tag
				current = stack.pop();
			}
			blockTagCheck(!current && closeBlock);
			content = current[3];
		}
		//==== /end of nested functions ====

		var newNode,
			allowCode = tmpl && tmpl.allowCode,
			astTop = [],
			loc = 0,
			stack = [],
			content = astTop,
			current = [, , , astTop];

		markup = markup.replace(rEscapeQuotes, "\\$1");

//TODO	result = tmplFnsCache[markup];  // Only cache if template is not named and markup length < ..., and there are no bindings or subtemplates?? Consider standard optimization for data-link="a.b.c"
//		if (result) {
//			tmpl.fn = result;
//		} else {

//		result = markup;

		blockTagCheck(stack[0] && stack[0][3].pop()[0]);

		// Build the AST (abstract syntax tree) under astTop
		markup.replace(rTag, parseTag);

		pushprecedingContent(markup.length);

		if (loc = astTop[astTop.length-1]) {
			blockTagCheck("" + loc !== loc && (+loc[6] === loc[6]) && loc[0]);
		}
//			result = tmplFnsCache[markup] = buildCode(astTop, tmpl);
//		}
		return buildCode(astTop, tmpl);
	}

	function buildCode(ast, tmpl) {
		// Build the template function code from the AST nodes, and set as property on the passed-in template object
		// Used for compiling templates, and also by JsViews to build functions for data link expressions
		var i, node, hasTag, hasEncoder, getsValue, hasConverter, hasViewPath, tagName, converter, params, hash, bindings, bindingPaths, nestedTmpls, nestedTmpl, allowCode, content, markup,
			code = "",
			tmplOptions = {},
			l = ast.length;

		if (tmpl) {
			if (allowCode = tmpl.allowCode) {
				tmplOptions.allowCode = TRUE;
			}
			if (tmpl.debug) {
				tmplOptions.debug = TRUE;
			}
			bindings = tmpl.bnds;
			nestedTmpls = tmpl.tmpls;
		}

		for (i = 0; i < l; i++) {
			// AST nodes: [ tagName, converter, params, content, hash, bindings, contentMarkup, link ]
			node = ast[i];

			// Add newline for each callout to t() c() etc. and each markup string
			//TODO consider changing to ret += t()...; so debug break points can be inserted on each callout.
			code += "\nret+=";
			if ("" + node === node) {
				// a markup string to be inserted
				code += '"' + node + '";';
			} else {
				// a compiled tag expression to be inserted
				tagName = node[0];
				if (tagName === "*") {
					// If this {{* }} tag is at the beginning of the template, start with var ret="";
					// Otherwise remove the last "+\n" characters and replace with ";" to complete the ret += ...; statement, prior to inserted user code,
					code = (i ? code.slice(0, -5) : "") + node[1];
				} else {
					converter = node[1];
					params = node[2];
					content = node[3];
					hash = node[4];
					bindingPaths = node[5];
					markup = node[6];

					if (content) {
						// Create template object for nested template
						nestedTmpl = TmplObject(markup, tmplOptions);
						// Compile to AST and then to compiled function
						buildCode(content, nestedTmpl);
						nestedTmpls.push(nestedTmpl);
					}
					if (bindingPaths) {
						// Add leaf binding paths to template
						bindings.push(bindingPaths);
						bindingPaths = bindings.length;
					}
					hasViewPath = hasViewPath || hash.indexOf("view") > -1;
					// Add newline for each callout to t() c() etc.

					//TODO consider changing to ret += t()...; so debug break points can be inserted on each callout. At the same time, pass in ret to c() and t()
					// so they can look at the previous ret, and detect whether this is a jsrender tag within an HTML element tag. If so, don't insert marker nodes,
					// and make the databinding trigger view refresh on parent view... No need for people to set link=false.
					code += tagName === ":"
					? (converter === "html" && !bindingPaths
						? (hasEncoder = TRUE, "h(" + params+ ");")
						: converter || bindingPaths // Call _cnvt if there is a converter, or binding: {{cnvt: ... }}, {^{: ... }} or {^{cnvt: ... }}
							? (hasConverter = TRUE, 'c("' + converter + '",view,this,' + hash + bindingPaths + "," + params + ");")
							: (getsValue = TRUE, "(v=" + params + ')!=u?v:"";')
					)
					: (hasTag = TRUE, 't("' + tagName + '",view,this,'
						+ (content ? nestedTmpls.length : '""') // For block tags, pass in the key (nestedTmpls.length) to the nested content template
						+ "," + hash + bindingPaths + (params ? "," : "") + params) + ");";
				}
			}
		}

		// Include only the var references that are needed in the code
		code = fnDeclStr
		+ (getsValue ? "v," : "")
		+ (hasTag ? "t=j._tag," : "")
		+ (hasConverter ? "c=j._cnvt," : "")
		+ (hasEncoder ? "h=j.converters.html," : "")
		+ 'ret=""; try{\n'
		+ (tmplOptions.debug ? "debugger;" : "")
		+ code + "\nreturn ret;\n\n}catch(e){return j._err(e);}";

		try {
			code = new Function("data, view, j, u", code);
		} catch (e) {
			syntaxError("Compiled template code:\n\n" + code, e);
		}

		if (tmpl) {
			tmpl.fn = code;
		}
		return code;
	}

	function parseParams(params, bindings) {

		function parseTokens(all, lftPrn0, lftPrn, path, operator, err, eq, path2, prn, comma, lftPrn2, apos, quot, rtPrn, prn2, space) {
			// rParams = /(\()(?=|\s*\()|(?:([([])\s*)?(?:([#~]?[\w$^.]+)?\s*((\+\+|--)|\+|-|&&|\|\||===|!==|==|!=|<=|>=|[<>%*!:?\/]|(=))\s*|([#~]?[\w$^.]+)([([])?)|(,\s*)|(\(?)\\?(?:(')|("))|(?:\s*([)\]])([([]?))|(\s+)
			//          lftPrn0-flwed by (- lftPrn               path    operator err                                                eq         path2       prn    comma   lftPrn3   apos quot        rtPrn   prn2   space
			// (left paren? followed by (path? followed by operator) or (path followed by paren?)) or comma or apos or quot or right paren or space
			operator = operator || "";
			lftPrn = lftPrn || lftPrn0 || lftPrn2;
			path = path || path2;
			prn = prn || prn2 || "";

			function parsePath(all, object, helper, view, viewProperty, pathTokens, leafToken) {
				// rPath = /^(?:null|true|false|\d[\d.]*|([\w$]+|~([\w$]+)|#(view|([\w$]+))?)([\w$.^]*?)(?:[.[^]([\w$]+)\]?)?)$/g,
				//                                        object   helper    view  viewProperty pathTokens       leafToken

				if (object) {
					bindings.push(path);
					if (object !== ".") {
						var leaf,
							ret = (helper
								? 'view._hlp("' + helper + '")'
								: view
									? "view"
									: "data")
							+ (leafToken
								? (viewProperty
									? "." + viewProperty
									: helper
										? ""
										: (view ? "" : "." + object)
									) + (pathTokens || "")
								: (leafToken = helper ? "" : view ? viewProperty || "" : object, ""));

						leaf = (leafToken ? "." + leafToken : "");
						ret = ret + leaf;
						ret = ret.slice(0, 9) === "view.data"
						? ret.slice(5) // convert #view.data... to data...
						: ret;
						return ret;
					}
				}
				return all;
			}

			if (err) {
				syntaxError(params);
			} else {
				return (aposed
					// within single-quoted string
					? (aposed = !apos, (aposed ? all : '"'))
					: quoted
					// within double-quoted string
						? (quoted = !quot, (quoted ? all : '"'))
						:
					(
						(lftPrn
								? (parenDepth++, lftPrn)
								: "")
						+ (space
							? (parenDepth
								? ""
								: named
									? (named = FALSE, "\b")
									: ","
							)
							: eq
					// named param
								? (parenDepth && syntaxError(params), named = TRUE, '\b' + path + ':')
								: path
					// path
									? (path.split("^").join(".").replace(rPath, parsePath)
										+ (prn
											? (fnCall[++parenDepth] = TRUE, prn)
											: operator)
									)
									: operator
										? operator
										: rtPrn
					// function
											? ((fnCall[parenDepth--] = FALSE, rtPrn)
												+ (prn
													? (fnCall[++parenDepth] = TRUE, prn)
													: "")
											)
											: comma
												? (fnCall[parenDepth] || syntaxError(params), ",") // We don't allow top-level literal arrays or objects
												: lftPrn0
													? ""
													: (aposed = apos, quoted = quot, '"')
					))
				);
			}
		}
		var named,
			fnCall = {},
			parenDepth = 0,
			quoted = FALSE, // boolean for string content in double quotes
			aposed = FALSE; // or in single quotes

		bindings.expr = params.replace(rUnescapeQuotes, "$1");
		return (params + " ").replace(rParams, parseTokens);
	}

	//==========
	// Utilities
	//==========

	// HTML encoding helper
	function replacerForHtml(ch) {
		// Original code from Mike Samuel <msamuel@google.com>
		return escapeMapForHtml[ch]
			// Intentional assignment that caches the result of encoding ch.
			|| (escapeMapForHtml[ch] = "&#" + ch.charCodeAt(0) + ";");
	}

	// Merge objects, in particular contexts which inherit from parent contexts
	function extendCtx(context, parentContext) {
		// Return copy of parentContext, unless context is defined and is different, in which case return a new merged context
		// If neither context nor parentContext are undefined, return undefined
		return context && context !== parentContext
			? (parentContext
				? $extend($extend({}, parentContext), context)
				: context)
			: parentContext && $extend({}, parentContext);
	}

	//========================== Initialize ==========================

	for (jsvStoreName in jsvStores) {
		registerStore(jsvStoreName, jsvStores[jsvStoreName]);
	}

	var $templates = $views.templates,
		$converters = $views.converters,
		$helpers = $views.helpers,
		$tags = $views.tags,
		$viewsSub = $views.sub,
		$viewsSettings = $views.settings;

	if (jQuery) {
		////////////////////////////////////////////////////////////////////////////////////////////////
		// jQuery is loaded, so make $ the jQuery object
		$ = jQuery;
		$.render = $render;
		$.views = $views;
		$.templates = $templates = $views.templates;
		$.fn.render = renderContent;

	} else {
		////////////////////////////////////////////////////////////////////////////////////////////////
		// jQuery is not loaded.

		$ = global.jsviews = $views;

		$.isArray = Array && Array.isArray || function(obj) {
			return Object.prototype.toString.call(obj) === "[object Array]";
		};
	}

	//========================== Register tags ==========================

	$tags({
		"if": function(val) {
			var self = this;
				// If not done and val is truey, set done=true on tag instance and render content. Otherwise return ""
				// On else will call this function again on the same tag instance.
			return (self._done || arguments.length && !val)
				? ""
				: (self._done = true,
					// Test is satisfied, so render content on current context. Rather than return undefined
					// (which will render the tmpl/content on the current context but will iterate if it is an array),
					// we pass in the view. This ensures treating as a layout template - with no iteration
					self.renderContent(self.tagCtx.view));
		},
// Temporary fix for binding to {{if}}
//	"if": {
//		render: function(val) {
//			var self = this;
//			return (self._done || arguments.length && !val) ? "" : (self._done = true, self.renderContent(self.tagCtx.view));
//		}
//	},
		"else": function() {}, // Does nothing but ensures {{else}} tags are recognized as valid
		"for": function() {
			var i, arg, undef,
				self = this,
				tagCtx = self.tagCtx,
				result = "",
				args = arguments,
				done = 0,
				l = args.length;

			if (!l) {
				return tagCtx.done
					? ""
					: (tagCtx.done = TRUE,
						// Test is satisfied, so render content on current context. Rather than return undefined
						// (which will render the tmpl/content on the current context but will iterate if it is an array),
						// we pass in the view. This ensures treating as a layout template - with no iteration
						self.renderContent(tagCtx.view));
			}
			for (i = 0; i < l; i++) {
				arg = args[i];
				undef = arg === undefined;
				if (!undef) {
					done += $.isArray(arg) ? arg.length : 1;
					result += self.renderContent(arg);
				} else {
					return "";
				}
			}
			tagCtx.done = done;
			return result;
		},
		"*": function(value) {
			return value;
		}
	});

	//========================== Register global helpers ==========================

	//	$helpers({ // Global helper functions
	//		// TODO add any useful built-in helper functions
	//	});

	//========================== Register converters ==========================

	$converters({
		html: function(text) {
			// HTML encoding helper: Replace < > & and ' and " by corresponding entities.
			return text != undefined ? String(text).replace(htmlEncodeChars, replacerForHtml) : "";
		},
		attr: function(text) {
			// Attribute encoding helper: Replace < & ' and " by corresponding entities.
			return text != undefined ? String(text).replace(attrEncodeChars, replacerForHtml) : "";
		},
		url: function(text) {
			// TODO - support chaining {{attr|url:....}} to protect against injection attacks from url parameters containing " or '.
			// URL encoding helper.
			return text != undefined ? encodeURI(String(text)) : "";
		}
	});

	//========================== Define default delimiters ==========================
	$viewsDelimiters();

})(this, this.jQuery);
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_Takova_normalni_rodinka\js\mykkro-viewer.js
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_Takova_normalni_rodinka\js\mykkro-viewer.js
VELIKOST: 207477 B (202.61 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
// configuration file
var DEBUG = false;

var Config = {
};
var __ = function(arg) {
    return LocaleStrings[arg] || arg;
}

/*
	Base.js, version 1.1
	Copyright 2006-2007, Dean Edwards
	License: http://www.opensource.org/licenses/mit-license.php
*/

var Base = function() {
	// dummy
};

Base.extend = function(_instance, _static) { // subclass
	var extend = Base.prototype.extend;
	
	// build the prototype
	Base._prototyping = true;
	var proto = new this;
	extend.call(proto, _instance);
	delete Base._prototyping;
	
	// create the wrapper for the constructor function
	//var constructor = proto.constructor.valueOf(); //-dean
	var constructor = proto.constructor;
	var klass = proto.constructor = function() {
		if (!Base._prototyping) {
			if (this._constructing || this.constructor == klass) { // instantiation
				this._constructing = true;
				constructor.apply(this, arguments);
				delete this._constructing;
			} else if (arguments[0] != null) { // casting
				return (arguments[0].extend || extend).call(arguments[0], proto);
			}
		}
	};
	
	// build the class interface
	klass.ancestor = this;
	klass.extend = this.extend;
	klass.forEach = this.forEach;
	klass.implement = this.implement;
	klass.prototype = proto;
	klass.toString = this.toString;
	klass.valueOf = function(type) {
		//return (type == "object") ? klass : constructor; //-dean
		return (type == "object") ? klass : constructor.valueOf();
	};
	extend.call(klass, _static);
	// class initialisation
	if (typeof klass.init == "function") klass.init();
	return klass;
};

Base.prototype = {	
	extend: function(source, value) {
		if (arguments.length > 1) { // extending with a name/value pair
			var ancestor = this[source];
			if (ancestor && (typeof value == "function") && // overriding a method?
				// the valueOf() comparison is to avoid circular references
				(!ancestor.valueOf || ancestor.valueOf() != value.valueOf()) &&
				/\bbase\b/.test(value)) {
				// get the underlying method
				var method = value.valueOf();
				// override
				value = function() {
					var previous = this.base || Base.prototype.base;
					this.base = ancestor;
					var returnValue = method.apply(this, arguments);
					this.base = previous;
					return returnValue;
				};
				// point to the underlying method
				value.valueOf = function(type) {
					return (type == "object") ? value : method;
				};
				value.toString = Base.toString;
			}
			this[source] = value;
		} else if (source) { // extending with an object literal
			var extend = Base.prototype.extend;
			// if this object has a customised extend method then use it
			if (!Base._prototyping && typeof this != "function") {
				extend = this.extend || extend;
			}
			var proto = {toSource: null};
			// do the "toString" and other methods manually
			var hidden = ["constructor", "toString", "valueOf"];
			// if we are prototyping then include the constructor
			var i = Base._prototyping ? 0 : 1;
			while (key = hidden[i++]) {
				if (source[key] != proto[key]) {
					extend.call(this, key, source[key]);

				}
			}
			// copy each of the source object's properties to this object
			for (var key in source) {
				if (!proto[key]) extend.call(this, key, source[key]);
			}
		}
		return this;
	},

	base: function() {
		// call this method from any other method to invoke that method's ancestor
	}
};

// initialise
Base = Base.extend({
	constructor: function() {
		this.extend(arguments[0]);
	}
}, {
	ancestor: Object,
	version: "1.1",
	
	forEach: function(object, block, context) {
		for (var key in object) {
			if (this.prototype[key] === undefined) {
				block.call(context, object[key], key, object);
			}
		}
	},
		
	implement: function() {
		for (var i = 0; i < arguments.length; i++) {
			if (typeof arguments[i] == "function") {
				// if it's a function, call it
				arguments[i](this.prototype);
			} else {
				// add the interface using the extend method
				this.prototype.extend(arguments[i]);
			}
		}
		return this;
	},
	
	toString: function() {
		return String(this.valueOf());
	}
});

// requires: jquery

var log = function(what) {
    $("body").prepend($("<pre>").text(what));
}

var ajaxify = function(sel) {
    $(sel || ".ajaxify").each(function() {
        $(this).load($(this).data("target"));
    })
}

// From http://www.terrainformatica.com/?p=13
var delegate = function( that, thatMethod )
{
    if(arguments.length > 2)
    {
        var _params = [];
        for(var n = 2; n < arguments.length; ++n) _params.push(arguments[n]);
        return function() { return thatMethod.apply(that,_params); };
    }
    else
      return function() { return thatMethod.call(that); };
}

var delegate_cp = function( that, thatMethod ) {
    return function() { return thatMethod.apply(that,arguments); }
};

function utf8_encode( s ) {
  return unescape( encodeURIComponent( s ) );
}

function utf8_decode( s ) {
  return decodeURIComponent( escape( s ) );
}

function html_encode( input ) {
    return String(input)
        .replace(/&/g, '&amp;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '\'')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;');
}

function html_decode( input ) {
    return String(input)
        .replace(/&amp;/g, '&')
        .replace(/&quot;/g, '\"')
        .replace(/'/g, '\'')
        .replace(/&lt;/g, '<')
        .replace(/&gt;/g, '>');
}

function base64_decode (data) {
  // http://kevin.vanzonneveld.net
  // +   original by: Tyler Akins (http://rumkin.com)
  // +   improved by: Thunder.m
  // +      input by: Aman Gupta
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +   bugfixed by: Onno Marsman
  // +   bugfixed by: Pellentesque Malesuada
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +      input by: Brett Zamir (http://brett-zamir.me)
  // +   bugfixed by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // *     example 1: base64_decode('S2V2aW4gdmFuIFpvbm5ldmVsZA==');
  // *     returns 1: 'Kevin van Zonneveld'
  // mozilla has this native
  // - but breaks in 2.0.0.12!
  //if (typeof this.window['atob'] == 'function') {
  //    return atob(data);
  //}
  var b64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
  var o1, o2, o3, h1, h2, h3, h4, bits, i = 0,
    ac = 0,
    dec = "",
    tmp_arr = [];

  if (!data) {
    return data;
  }

  data += '';

  do { // unpack four hexets into three octets using index points in b64
    h1 = b64.indexOf(data.charAt(i++));
    h2 = b64.indexOf(data.charAt(i++));
    h3 = b64.indexOf(data.charAt(i++));
    h4 = b64.indexOf(data.charAt(i++));

    bits = h1 << 18 | h2 << 12 | h3 << 6 | h4;

    o1 = bits >> 16 & 0xff;
    o2 = bits >> 8 & 0xff;
    o3 = bits & 0xff;

    if (h3 == 64) {
      tmp_arr[ac++] = String.fromCharCode(o1);
    } else if (h4 == 64) {
      tmp_arr[ac++] = String.fromCharCode(o1, o2);
    } else {
      tmp_arr[ac++] = String.fromCharCode(o1, o2, o3);
    }
  } while (i < data.length);

  dec = tmp_arr.join('');

  return dec;
}



function base64_encode (data) {
  // http://kevin.vanzonneveld.net
  // +   original by: Tyler Akins (http://rumkin.com)
  // +   improved by: Bayron Guevara
  // +   improved by: Thunder.m
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +   bugfixed by: Pellentesque Malesuada
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +   improved by: Rafał Kukawski (http://kukawski.pl)
  // *     example 1: base64_encode('Kevin van Zonneveld');
  // *     returns 1: 'S2V2aW4gdmFuIFpvbm5ldmVsZA=='
  // mozilla has this native
  // - but breaks in 2.0.0.12!
  //if (typeof this.window['btoa'] == 'function') {
  //    return btoa(data);
  //}
  var b64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
  var o1, o2, o3, h1, h2, h3, h4, bits, i = 0,
    ac = 0,
    enc = "",
    tmp_arr = [];

  if (!data) {
    return data;
  }

  do { // pack three octets into four hexets
    o1 = data.charCodeAt(i++);
    o2 = data.charCodeAt(i++);
    o3 = data.charCodeAt(i++);

    bits = o1 << 16 | o2 << 8 | o3;

    h1 = bits >> 18 & 0x3f;
    h2 = bits >> 12 & 0x3f;
    h3 = bits >> 6 & 0x3f;
    h4 = bits & 0x3f;

    // use hexets to index into b64, and append result to encoded string
    tmp_arr[ac++] = b64.charAt(h1) + b64.charAt(h2) + b64.charAt(h3) + b64.charAt(h4);
  } while (i < data.length);

  enc = tmp_arr.join('');

  var r = data.length % 3;

  return (r ? enc.slice(0, r - 3) : enc) + '==='.slice(r || 3);

}

/**
 * Returns the first data element of an object, regardless on its key name.
 */
var extractRoot = function(data) {
  for(var key in data) {
    return data[key];
  }
}


Array.prototype.toObject = function() {
    var out = {};
    for(var i=0; i<this.length; i++) {
        out[i] = this[i];
    }
    return out;
}

// Array.copy() - Copy an array
if( typeof Array.prototype.copy==='undefined' ) {
 Array.prototype.copy = function() {
  var a = [], i = this.length;
  while( i-- ) {
   a[i] = typeof this[i].copy!=='undefined' ? this[i].copy() : this[i];
  }
  return a;
 };
}

// Array.insert( index, value ) - Insert value at index, without overwriting existing keys
Array.prototype.insert = function( i, v ) {
 if( i>=0 ) {
  var a = this.slice(), b = a.splice( i );
  a[i] = v;
  return a.concat( b );
 }
};

// Array Remove - By John Resig (MIT Licensed)
Array.prototype.remove = function(from, to) {
  var rest = this.slice((to || from) + 1 || this.length);
  this.length = from < 0 ? this.length + from : from;
  return this.push.apply(this, rest);
};

// Array.random( range ) - Return a random element, optionally up to or from range
Array.prototype.random = function( r ) {
 var i = 0, l = this.length;
 if( !r ) { r = this.length; }
 else if( r > 0 ) { r = r % l; }
 else { i = r; r = l + r % l; }
 return this[ Math.floor( r * Math.random() - i ) ];
};

// Array.shuffle( deep ) - Randomly interchange elements
Array.prototype.shuffle = function( b ) {
 var i = this.length, j, t;
 while( i ) {
  j = Math.floor( ( i-- ) * Math.random() );
  t = b && typeof this[i].shuffle!=='undefined' ? this[i].shuffle() : this[i];
  this[i] = this[j];
  this[j] = t;
 }
 return this;
};

// Array.unique( strict ) - Remove duplicate values
Array.prototype.unique = function( b ) {
 var a = [], i, l = this.length;
 for( i=0; i<l; i++ ) {
  if( a.indexOf( this[i], 0, b ) < 0 ) { a.push( this[i] ); }
 }
 return a;
};

// Array.walk() - Change each value according to a callback function
Array.prototype.walk = function( f ) {
 var a = [], i = this.length;
 while(i--) { a.push( f( this[i] ) ); }
 return a.reverse();
};

String.prototype.capitalize = function() {
    return this.charAt(0).toUpperCase() + this.slice(1);
}

//String.prototype.trim=function(){return this.replace(/^\s\s*/, '').replace(/\s\s*$/, '');};

// deprecated: use trimLeft, trimRight
/*
String.prototype.ltrim=function(){return this.replace(/^\s+/,'');}

String.prototype.rtrim=function(){return this.replace(/\s+$/,'');}
*/
String.prototype.fulltrim=function(){return this.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,'').replace(/\s+/g,' ');}

String.prototype.camelCase = function() { 
    var s = this.trim();
    return ( /\S[A-Z]/.test( s ) ) ?
        s.replace( /(.)([A-Z])/g, function(t,a,b) { return a + ' ' + b.toLowerCase(); } ) :
        s.replace( /( )([a-z])/g, function(t,a,b) { return b.toUpperCase(); } );
}

// code generation utilities

var CodeGenUtils = {
    getSetterName: function(name) {
        return "set" + name.capitalize();
    },
    getGetterName: function(name, isBoolean) {
        return (isBoolean ? "is" : "get") + name.capitalize();
    }
}



String.prototype.endsWith = function(suffix) {
    return this.indexOf(suffix, this.length - suffix.length) !== -1;
};

String.prototype.startsWith = function (str){
    return this.slice(0, str.length) == str;
};


jQuery.fn.swap = function(b) {
    b = jQuery(b)[0];
    var a = this[0];

    var t = a.parentNode.insertBefore(document.createTextNode(''), a);
    b.parentNode.insertBefore(a, b);
    t.parentNode.insertBefore(b, t);
    t.parentNode.removeChild(t);

    return this;
};


// smallest jQuery plugin :)
jQuery.fn.reverse = [].reverse;


$.extend({
  jYoutube: function( url, size ){
    if(url === null){ return ""; }

    size = (size === null) ? "big" : size;
    var vid;
    var results;

    results = url.match("[\\?&amp;]v=([^&amp;#]*)");

    vid = ( results === null ) ? url : results[1];

    if(size == "small"){
      return "http://img.youtube.com/vi/"+vid+"/2.jpg";
    }else {
      return "http://img.youtube.com/vi/"+vid+"/0.jpg";
    }
  }
});

var makeSvgScalable = function(svg) {
    var el = svg[0];
    var ww = el.getAttribute("width");
    var hh = el.getAttribute("height");
    el.setAttribute('width', '100%');
    el.setAttribute('height', '100%');
    el.setAttribute('viewBox', '0 0 '+ww+' '+hh);
    el.setAttribute('preserveAspectRatio', 'xMidyMid meet');
};

var Common = {
    postJsonData: function(url, data, success, error) {
        $.ajax({
            type: "post",       // Request method: post, get
            url: url,
            data: JSON.stringify(data), 
            dataType: "json",    // Expected response type
            contentType: "application/json",
            cache: false,
            success: success || $.noop,
            error: error || $.noop
        });
    },
    isValidUrl: function(str) {
      var pattern = new RegExp('^(https?:\\/\\/)?'+ // protocol
      '((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|'+ // domain name
      '((\\d{1,3}\\.){3}\\d{1,3}))'+ // OR ip (v4) address
      '(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*'+ // port and path
      '(\\?[;&a-z\\d%_.~+=-]*)?'+ // query string
      '(\\#[-a-z\\d_]*)?$','i'); // fragment locator
      if(!pattern.test(str)) {
        return false;
      } else {
        return true;
      }
    }
};

var JQ = {
    button: function(caption, click, parent) {
        var btn = $("<button>").text(caption);
        if(click) btn.click(click);
        if(parent) btn.appendTo(parent);
        return btn;
    },
    linkButton: function(content, click, parent) {
        var btn = JQ.put($("<a>"), content);
        if(click) btn.click(click);
        if(parent) btn.appendTo(parent);
        return btn;
    },
    link: function(content, href, tooltip, parent) {
        var link = JQ.put($("<a>"), content).attr({"title":tooltip, "href":href});
        if(parent) link.appendTo(parent);
        return link;
    },
    ul: function(parent) {
        var ul = $("<ul>");
        if(parent) ul.appendTo(parent);
        return ul;
    },
    li: function(klass, parent) {
        var li = $("<li>").addClass(klass);
        if(parent) li.appendTo(parent);
        return li;
    },
    checkbox: function(name, checked, parent) {
        var input = $("<input>").attr({'type':'checkbox', 'name':name}).prop("checked", checked);
        if(parent) input.appendTo(parent);
        return input;
    },
    textfield: function(name, value, parent) {
        var input = $("<input>").attr({'type':'text', 'name':name, "value":value});
        if(parent) input.appendTo(parent);
        return input;
    },
    span: function(content, klass, parent) {
        var span = JQ.put("span", content).addClass(klass);
        if(parent) span.appendTo(parent);
        return span;
    },
    div: function(content, klass, parent) {
        var div = JQ.put("div", content).addClass(klass);
        if(parent) div.appendTo(parent);
        return div;
    },
    p: function(content, klass, parent) {
        var p = JQ.put("p", content).addClass(klass);
        if(parent) p.appendTo(parent);
        return p;
    },
    h1: function(content, klass, parent) {
        return JQ.hN(1, content, klass, parent);
    },
    h2: function(content, klass, parent) {
        return JQ.hN(2, content, klass, parent);
    },
    h3: function(content, klass, parent) {
        return JQ.hN(3, content, klass, parent);
    },
    h4: function(content, klass, parent) {
        return JQ.hN(4, content, klass, parent);
    },
    h5: function(content, klass, parent) {
        return JQ.hN(5, content, klass, parent);
    },
    h6: function(content, klass, parent) {
        return JQ.hN(6, content, klass, parent);
    },
    hN: function(level, content, klass, parent) {
        var heading = JQ.put("h"+level, content).addClass(klass);
        if(parent) heading.appendTo(parent);
        return heading;
    },
    label: function(content, klass, parent) {
        var label = JQ.put("label", content).addClass(klass);
        if(parent) label.appendTo(parent);
        return label;
    },
    clear: function(parent) {
        var clr = $("<div>").addClass("clear");
        if(parent) clr.appendTo(parent);
        return clr;
    },
    show: function(elem, enabled) {
        if(enabled) elem.show(); else elem.hide();
    },
    form: function(klass, parent) {
        var div = $("<form>").addClass(klass);
        if(parent) div.appendTo(parent);
        return div;
    },
    fieldset: function(klass, parent) {
        var div = $("<fieldset>").addClass(klass);
        if(parent) div.appendTo(parent);
        return div;
    },
    toggleLink: function(captionOn, captionOff, target, parent) {
        var visible = target.is(":visible");
        var btn = JQ.put("a", visible ? captionOn : captionOff).click(function() {
            var visible = target.is(":visible");
            if(visible) {
                target.hide();
                btn.text(captionOff);
            } else {
                target.show();
                btn.text(captionOn);
            }
        });
        if(parent) btn.appendTo(parent);
        return btn;
    },
    linkExt: function(caption, href, tooltip, parent) {
        return JQ.link(caption, href, tooltip, parent).attr("target","_blank");
    },
    put: function(where, what) {
        if(typeof(where) == "string") {
            where = $("<"+where+">");
        }
        if(what) {
            if(typeof(what) == "string") {
                where.text(what);
            } else {
                where.append(what);
            }
        }
        return where;
    }
};

// kazda 'vec' ma options (s defaultni hodnotou) a slots
var Thing = Base.extend({
    constructor: function(options, slots) {
        this.options = $.extend({}, this.defaults(), options);        
        this.tid = Thing.tid++;
        Thing.things[this.tid] = this;
        this.element = $("<div>").addClass(this.getClass()).attr("data-tid", this.tid);
        if(DEBUG) {
            this.element.css("background-color", '#'+Math.floor(Math.random()*16777215).toString(16));
        }
        this.slots = {};
        this.parent = null;
        this.name = null;
        // initializing...
	    this.slotChanged($.noop);
        this.init();
        this.setSlots(slots);
        // display update
        this.refresh();
    },
    copy: function() {
        return Thing.create(this.serialize());
    },
    remove: function() {
        this.replaceWith(Thing.empty());        
    },
    replaceWith: function(thing) {
        if(this.parent) {
            this.parent.setSlot(this.name, thing);
            this.parent = null;
            this.name = null;           
            Thing.things[this.tid] = null;
        }
    },
    // obali this dekoratorem
    decorate: function(deco) {
        if(this.parent) {
            var par = this.parent;
            var slot = this.name;
            deco.setSlot('content', this);
            par.setSlot(slot, deco);
            return deco;
        }
    },
    serialize: function() {
        var slots = {};
        var numslots = 0;
        for(var key in this.slots) {
            slots[key] = this.slots[key].serialize();
            numslots++;
        }
        var obj = {
            type: this.getType(),
            options: this.options
        };
        if(numslots) obj.slots = slots
        return obj;
    },
    getType: function() {
        return this._type;
    },
    getClass: function() {
        return this._klass.split(" ").map(function(a){return "mykkro-"+a;}).join(" ");
    },
    init: function() {
        // create structure and variables
    },
    refresh: function() {
        // options changed...
        this.element.attr('class','');
        this.element.addClass(this.getClass());
        this.element.addClass(this.options.css);
    },
    get: function() {
        return this.element;
    },
    defaults: function() {
        return this._defaults;
    },
    // muzeme se dostat takhle i ke slotu ve slotu
    content: function(key, value) {
        var ndx = key.indexOf(".");
        if(ndx>=0) {
            // odkazujeme se na slot ve slotu
            var newKey = key.substring(0,ndx);
            var rest = key.substring(ndx+1);
            return this.getSlot(newKey).content(rest, value);
        }
        if(this.hasSlot(key)) {
            if(value) {
                // setter
                this.setSlot(key, value);
                return this;
            } else {
                // getter
                return this.getSlot(key);
            }
        } else {
            // unknown slot!
            return null;
        }
    },
    hasSlot: function(key) {
        return !!this.slots[key];
    },
    getSlot: function(key) {
        return this.slots[key];
    },
    setSlot: function(key, thing) {
        this.slots[key] = thing;
        thing._setParent(this, key);
        // DOM manipulation - to be overridden
	    this.slotChanged(key);
        return this;
    },
    removeSlot: function(key) {
        delete this.slots[key]
    },
    clearSlots: function() {
        for(var key in this.slots) {
            this.setSlot(key, Thing.empty());
        }
    },
    setOptions: function(opts) {
        this.options = $.extend(this.options, opts);
        this.refresh();
	    this.slotChanged('options');
    },
    setSlots: function(slots) {
        if(slots) {
            // pokud je parametr pole, udelat z nej objekt
            if($.isArray(slots)) slots = slots.toObject();
            for(var key in slots) {
                this.setSlot(key, slots[key]);
            }
        }
    },
    _setParent: function(parent, key) {
        this.parent = parent;
        this.name = key;
    },
    isEmpty: function() {
        return this.getType() == "empty";
    },
    slotChanged: function(arg) {
        if(typeof arg == "function") {
            this.onslotchanged = arg;
        } else {
            return this.onslotchanged(this, arg);
        }
    },    
    // bez parametru vraci rekurzivne vsechny sloty
    findSlots: function(predicate, out) {
        if(!predicate) predicate = function() { return true; };
        if(!out) out = [];
        if(predicate(this)) out.push(this);
        for(var key in this.slots) {
            this.slots[key].findSlots(predicate, out);
        }
        return out;
    },
    findEmptySlots: function(out) {
        return this.findSlots(function(thing) { return thing.isEmpty(); }, out)
    },
    findSlotsByType: function(type, out) {
        return this.findSlots(function(thing) { return thing.getType() == type; }, out)
    },
    getTree: function() {
        var node = { type: this.getType(), children: {} };
        for(var key in this.slots) {
            node.children[key] = this.slots[key].getTree();
        }
        return node;
    },
    _toggleTreeView: function(node) {
        node.children(".slots").toggleClass('collapsed');
    },
    // TODO mohlo by si to pamatovat expands/collapse mezi updaty
    /* example decorator:
        decorator = function(thing, node) {
            $("<div>").addClass("toolz").insertAfter(node.find(">h2"));
        };
    */
    getTreeView: function(decorator) {
        var self = this;
        var node = $("<div>").addClass('node').attr('data-type', this.getType()).attr('data-tid', this.tid);
        var hdr = $("<h2>").text(this.getType()).appendTo(node);
        var slots = $("<div>").addClass('slots').appendTo(node);
        hdr.click(function() {
            self._toggleTreeView(node);
        });
        for(var key in this.slots) {
            (function(){
                var subtree = self.slots[key].getTreeView(decorator);
                var subheading = $("<h3>").text(key).click(function() {
                    $(this).toggleClass('collapsed');
                    self._toggleTreeView(subtree);
                });
                slots.append(subheading);
                slots.append(subtree);
            })();
        }
        node.append($("<div>").addClass('clear'));
        if(decorator) decorator(this, node);
        return node;
    },
    _type: "thing",
    _defaults: {
        "css": ""
    },
    _klass: "thing",
    _schema: {
       "type":"object",
       "properties":{
       },
       "additionalProperties":true
    }

},{    
    tid: 0,
    things: {},
    create: function(def, opts) {
        if(!def) {
            return Thing.empty();
        }
        // udelat deserializaci
        // { type, options, slots }
        var klassName = def.type.replace(/-([a-z])/g, function (g) { return g[1].toUpperCase() });
        klassName = klassName.capitalize();
        var klazz = window[klassName];
        var slots = def.slots;
        var oid = def.id;
        if($.isArray(slots)) slots = slots.toObject();
        for(var key in slots) {
            slots[key] = Thing.create(slots[key]);
        }
        var thing = new klazz($.extend(def.options, opts), slots);
        thing.oid = oid
        return thing
    },
    empty: function(options) {
        return new Empty(options);
    }
});



var Empty = Thing.extend({
    refresh: function() {
        this.element.empty();
        /*
        if(this.parent) this.element.html(
            $("<div>").text(this.parent.getType()+"#"+this.name)
        );
        */
    },
    _setParent: function(parent, key) {
        this.base(parent, key);
        this.refresh();
    },
    _klass: "empty thing",
    _type: "empty"
});


var Imager = Thing.extend({
    refresh: function() {
        var img = $("<div>")
            .css("background-image",'url("'+this.options.url+'")')
            .css('background-position',this.options['position'])
            .css('background-repeat',this.options['repeat'])
            .css('background-color',this.options['color'])
            .css('background-size',this.options['size'])
            .css('-moz-background-size',this.options['size'])
            .css('-webkit-background-size',this.options['size']);
        this.element.html(img);
    },
    _klass: "imager thing",
    _type: "imager",
    _defaults: {
        "url": "images/demo/australie1.jpg",
        "repeat": "no-repeat",
        "position": "center center",
        "color": "white",
        "size": "cover" 
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "color": {
			    "type":"string",
			    "id": "color",
			    "required":true,
                "format": "color"
		    },
		    "position": {
			    "type":"string",
			    "id": "position",
			    "required":true
		    },
		    "repeat": {
			    "type":"string",
			    "id": "repeat",
			    "required":true
		    },
		    "size": {
			    "type":"string",
			    "id": "size",
                "enum":["cover","contain"],
			    "required":true
		    },
		    "url": {
			    "type":"string",
			    "id": "url",
                "format": "my-image-uri",
			    "required":true
		    }
	    }
    }

});


var RaphaelThing = Thing.extend({
    refresh: function() {
        var o = this.options;
        var div = $("<div>");
        this.element.html(div);
        var paper = Raphael(div.get(0), "100%","100%");
        paper.setViewBox(0, 0, o.width, o.height, true);
        this.canvas = paper;
    },
    _klass: "raphael-thing thing",
    _type: "raphael-thing",
    _defaults: {
        width: 100,
        height: 100
    },
    _schema: {
       "type":"object",
       "description":"RaphaelThing properties",
       "properties":{
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }

});


var CanvasThing = Thing.extend({
    init: function() {
        var o = this.options;
        var self = this;
        this.canvas = $("<canvas>").appendTo(this.element).attr({width:o.width, height:o.height});
        // pouziva CSS transformaci, rastr je porad stejne velky
        if(o.autoscale) {
            this.element.resize(function() {
                var el = $(this);
                var o = self.options;
                var zoom = Math.min(el.width()/o.width, el.height()/o.height);
                el.css({
                    "-moz-transform": "scale("+zoom+")", 
                    "-webkit-transform": "scale("+zoom+")", 
                    "-moz-transform-origin":"0px 0px", 
                    "-webkit-transform-origin":"0px 0px"
                });
            });
        }
        // zvetsuje fyzicky pocet pixelu rastru
        if(o.autoresize) {
            this.element.resize(function() {
                var el = $(this);
                var ww = el.width();
                var hh = el.height();
                if(o.keepaspectratio) { var asp = o.width/o.height; if(ww/hh > asp) ww = hh*asp; else hh = ww/asp; }
                self.canvas.attr({
                    "width": ww, 
                    "height": hh
                });
                self.refresh();
            });
            var el = this.element;
            var ww = el.width();
            var hh = el.height();
            if(o.keepaspectratio) { var asp = o.width/o.height; if(ww/hh > asp) ww = hh*asp; else hh = ww/asp; }
            this.canvas.attr({
                "width": ww, 
                "height": hh
            });            
        }
    },
    refresh: function() {
        var context = this.canvas.get(0).getContext('2d');
        if (context) {
            this.draw(context, this.canvas.width() || this.options.width, this.canvas.height() || this.options.height);
        }
    },
    draw: function(g, w, h) {
        /* by default, draws only rectangle... */
        g.strokeRect(0,  0, w, h);
    },
    _klass: "canvas-thing thing",
    _type: "canvas-thing",
    _defaults: {
        width: 100,
        height: 100,
        autoscale: false,
        autoresize: true,
        keepaspectratio: true
    },
    _schema: {
       "type":"object",
       "description":"CanvasThing properties",
       "properties":{
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          },
          "autoscale":{
             "type":"boolean",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


// http://www.nihilogic.dk/labs/javascript_canvas_fractals/
var Fractal = CanvasThing.extend({
    draw: function(ctx, w, h) {
        var smoothColors = this.options.smoothcolors;
        var vx = this.options.vx;
        var vy = this.options.vy;
        var zoom = this.options.zoom;

        var imageData = !!ctx.getImageData;
        var startit = 30;
        var xmin, xmax, ymin, ymax, dx, dy;
        var er = 2;

        var colors = {
	        red : [[0,0,1],[0,1,0],[0,1,0]],
	        blue : [[0,0,0],[0,1,0],[0,1,1]],
	        green : [[0,1,0],[0,0,1],[0,1,0]],
	        orange : [[1,1,1],[0,1,0],[0,0,0]],
	        magenta : [[0,0,1],[0,0.1,0.5],[0,0,1]],
	        yellow : [[0.2,0.2,1],[0.2,0.2,1],[0,0,0.2]],

        };

        var log2 = 1 / Math.log(2.0);
        var sin = Math.sin;
        var cos = Math.cos;
        var exp = Math.exp;
        var phi = 1.6180339887;
        function cosh(a) {
            return (exp(a) + exp(-a))/2;
        }
        function sinh(a) {
            return (exp(a) - exp(-a))/2;
        }
        function csin(x,y) {
	        return [sin(x) * cosh(y), cos(x) * sinh(y)];
        }
        function ccos(x,y) {
	        return [cos(x)*cosh(y), -sin(x)*sinh(y)];
        }
        function cexp(x,y) {
	        return [exp(x)*cos(y), exp(x)*sin(y)];
        }
        function cmul(c1,c2) {
	        return [
		        c1[0]*c2[0]-c1[1]*c2[1],
		        c1[0]*c2[1]+c1[1]*c2[0]
	        ];
        }

        var fractals = {

	        mandelbrot : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        var lastxx, lastyy;
		        do {
			        y = (x+x)*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2) {

				        y = (x+x)*y + y0; // iterate once for more for smoother colors
				        x = xx - yy + x0;
				        yy = y*y;
				        xx = x*x;

				        break;
			        }
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliacubed : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {

			        tx = x;
			        ty = y;

			        tx2 = x*x-y*y;
			        ty2 = 2*x*y;

			        x = tx2*tx-ty2*ty + 1-phi;
			        y = tx2*ty+ty2*tx + 0.3;

			        xx = x*x;
			        yy = y*y;

			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        multibrot3 : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var tx, ty, tx2, ty2;
		        var xx = x*x, yy = y*y;
		        do {
			        tx = x;
			        ty = y;
			        tx2 = xx-yy;
			        ty2 = 2*x*y;
			        x = tx2*tx-ty2*ty + x0;
			        y = tx2*ty+ty2*tx + y0;
			        xx = x*x;
			        yy = y*y;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        multibrot4 : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = 2*x*y;
			        x = xx - yy;
			        yy = y*y;
			        xx = x*x;
			        y = 2*x*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        multibrot8 : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = 2*x*y;
			        x = xx - yy;
			        yy = y*y;
			        xx = x*x;
			        y = 2*x*y;
			        x = xx - yy;
			        yy = y*y;
			        xx = x*x;
			        y = 2*x*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        burningship : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = 2*Math.abs(x*y) - y0;
			        x = xx - yy - x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        tricorn : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = -y;

			        y = (x+x)*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        julia_base : function(x, y, it, er2, cr, ci) {
		        var xx = x*x, yy = y*y;
		        do {
			        y = (x+x)*y + ci;
			        x = xx - yy + cr;
			        yy = y*y;
			        xx = x*x;

			        if (xx+yy > er2) {
				        y = (x+x)*y + ci;
				        x = xx - yy + cr;
				        yy = y*y;
				        xx = x*x;

				        break;
			        }
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        julia1 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, phi - 2, phi - 1);
	        },

	        julia2 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 1-phi, 0);
	        },

	        julia3 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 0.285, 0);
	        },

	        julia4 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 0.285, 0.01);
	        },

	        julia5 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.835, -0.2321);
	        },

	        julia6 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.7, -0.3);
	        },

	        julia7 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 0, 1);
	        },

	        julia8 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.391, -0.587);
	        },

	        julia9 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.123, 0.745);
	        },

	        julia10 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.75, 0);
	        },

	        julia11 : function(x, y, it, er2) {
		        var zr, zi;
		        var cr = 0.6;
		        var ci = 1.1;
		        var xx = x*x, yy = y*y;
		        do {
			        zr = x - (x?(x<0?-1:1):0);
			        zi = y;
			        x = cr*zr-ci*zi;
			        y = cr*zi+ci*zr;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliasine_base : function(x, y, it, er2, cr, ci) {
		        var xx = x*x, yy = y*y;
		        var z, expy, expmy;
		        var c = [cr, ci];
		        do {
			        //z = csin(x,y);
			        expy = exp(y);
			        expmy = exp(-y);
			        z = [sin(x) * (expy + expmy)/2, cos(x) * (expy - expmy)/2];

			        x = c[0]*z[0]-c[1]*z[1];
			        y = c[0]*z[1]+c[1]*z[0];

			        yy = y*y, xx = x*x;
			        if (xx+yy > 500)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliasine : function(x, y, it, er2) {
		        return fractals["juliasine_base"](x, y, it, er2, 1, 0.1);
	        },

	        juliasine2 : function(x, y, it, er2) {
		        return fractals["juliasine_base"](x, y, it, er2, 1, 0.3);
	        },

	        juliacosine_base : function(x, y, it, er2, cr, ci) {
		        var xx = x*x, yy = y*y;
		        var z, expy, expmy;
		        var c = [cr, ci];
		        do {
			        //z = ccos(x,y);
			        expy = exp(y);
			        expmy = exp(-y);
			        z = [cos(x) * (expy + expmy)/2, -sin(x) * (expy - expmy)/2];

			        x = c[0]*z[0]-c[1]*z[1];
			        y = c[0]*z[1]+c[1]*z[0];

			        yy = y*y, xx = x*x;
			        if (xx+yy > 500)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliacosine : function(x, y, it, er2) {
		        return fractals["juliacosine_base"](x, y, it, er2, 1, 0.6);
	        },

	        juliacosine2 : function(x, y, it, er2) {
		        return fractals["juliacosine_base"](x, y, it, er2, Math.PI/2 * 1.5, Math.PI/2 * 0.05);
	        },

	        juliacosine3 : function(x, y, it, er2) {
		        var xx = x*x, yy = y*y;
		        var z, expy, expmy;
		        var c = [1, 0.1];
		        do {
			        //z = ccos(x,y);
			        expy = exp(y);
			        expmy = exp(-y);
			        z = [cos(x) * (expy + expmy)/2, -sin(x) * (expy - expmy)/2];

			        x = c[0]*z[0]-c[1]*z[1];
			        y = c[0]*z[1]+c[1]*z[0];

			        tx = x;
			        x = -y;
			        y = tx;

			        yy = y*y, xx = x*x;
			        if (xx+yy > 500)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

        };

        // from http://www.nihilogic.dk/labs/javascript_canvas_fractals/
        function render(fncFrac, colWeights) {
	        var time = new Date().getTime();

	        ctx.fillStyle = "#000000";
	        ctx.fillRect(0,0,w,h);

	        if (imageData) {
		        var data = ctx.getImageData(0,0,w,h);
		        var pixels = data.data;
	        }

	        var mi = Math.max(startit, Math.round(Math.max(Math.log(zoom),1) * startit));
	        var itfac = 1/mi*startit

	        xmin = vx - 2/zoom;
	        xmax = vx + 2/zoom;
	        ymin = vy - 2/zoom;
	        ymax = vy + 2/zoom;

	        dx = xmax-xmin;
	        dy = ymax-ymin;

	        var px, py, it;

	        var er2 = er*er;

	        var c1, c2, c3, m;
	        var col1, col2, col3;
	        var cw0 = colWeights[0], cw1 = colWeights[1], cw2 = colWeights[2];

	        var i = (w*h)-1;
	        do {
		        var offset = i*4;

		        px = (i%w);
		        py = h-((i/w)|0);

		        var res = fncFrac(
			        xmin + px/w * dx, 
			        ymin + py/h * dy, 
			        mi, er2
		        )

		        it = mi - res.it;

		        var mag = smoothColors ? 
				        (it * itfac) - (Math.log(Math.log(res.xx+res.yy))) * log2
				        : it * itfac;

		        //if (color == "bw") {
			    //    c1 = c2 = c3 = 
				//        (res.it==mi) ? 255 : 255 - mag/startit * 255;
		        //} else {
			        if (res.it == 0)
				        continue;

			        if (mag < startit/3) {
				        m = (mag*3);
				        col1 = m * 4;
				        col2 = m * 4;
				        col3 = m * 10;
			        } else if (mag < startit/1.5) {
				        m = (mag-startit/3)*3;
				        col1 = 80 + m * 8;
				        col2 = 80 + m * 8;
				        col3 = 200 + m * 2.5;
			        } else {
				        m = (mag-2*startit/3)*3
				        col1 = 220 + m * 1.5;
				        col2 = 220 + m * 1.5;
				        col3 = 255;
			        }

			        c1 = col1*cw0[0] + col2*cw0[1] + col3*cw0[2];
			        c2 = col1*cw1[0] + col2*cw1[1] + col3*cw1[2];
			        c3 = col1*cw2[0] + col2*cw2[1] + col3*cw2[2];
		        //}

		        c1 = c1 < 0 ? 0 : c1;
		        c2 = c2 < 0 ? 0 : c2;
		        c3 = c3 < 0 ? 0 : c3;

		        c1 = c1 > 255 ? 255 : c1;
		        c2 = c2 > 255 ? 255 : c2;
		        c3 = c3 > 255 ? 255 : c3;

		        if (!imageData) {
			        ctx.fillStyle = "rgb(" + (c1|0) + "," + (c2|0) + "," + (c3|0) + ")";
			        ctx.fillRect((px|0), h-((py|0)), 1, 1);
		        } else {
			        pixels[offset] = c1;
			        pixels[offset+1] = c2;
			        pixels[offset+2] = c3;
		        }

	        } while(--i);

	        if (imageData) {
		        ctx.putImageData(data,0,0);
		        ctx.fillRect(0,0,0,0);
	        }
        };

        render(fractals[this.options.algorithm], colors[this.options.color]);
    },
    _klass: "fractal thing",
    _type: "fractal",
    _defaults: {
        width: 300,
        height: 300,
        autoscale: false,
        autoresize: true,
        keepaspectratio: true,
        algorithm: "mandelbrot",
        color: "yellow",
        smoothcolors: true,
        vx: 0.3,
        vy: 0,
        zoom: 10
    },
    _schema: {
       "type":"object",
       "description":"Fractal properties",
       "properties":{
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          },
          "autoscale":{
             "type":"boolean",
             "required":false
          }
       },
       "additionalProperties":true
    }
});


var Html = Thing.extend({
    init: function() {
        this.inner = $("<div>");
        this.element.html(this.inner);
    },
    refresh: function() {
        this.base();
        this.inner.html(this.options.html).attr('class',this.options.innerCss);
    },
    _klass: "html thing",
    _type: "html",
    _defaults: {
        html: ""
    },
    _schema: {
       "type":"object",
       "description":"Html properties",
       "properties":{
          "html":{
             "type":"string",
             "required":true
          },
          "css":{
             "type":"string",
             "required":false
          },
          "innerCss":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


var Svg = Thing.extend({
    init: function() {
    },
    refresh: function() {
        this.base();
        this.element.html(this.options.svg);
    },
    _klass: "svg thing",
    _type: "svg",
    _defaults: {
        svg: '<svg xmlns="http://www.w3.org/2000/svg" version="1.1">'
    },
    _schema: {
       "type":"object",
       "description":"Svg properties",
       "properties":{
          "svg":{
             "type":"string",
             "required":true
          },
          "width":{
             "type":"string",
             "required":false
          },
          "height":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


var SvgEditor = Thing.extend({
    change: function(arg) {
        if(typeof arg == 'function') {
            this.onchange = arg;
        } else {
            this.onchange(arg);
        }
    },
    init: function() {
        var self = this;
        self.onchange = $.noop;
        self.frame = $('<iframe src="'+baseUrl+'testing/svgedit">').attr('width',self.options.width).attr('height', self.options.height);
        self.frame.ready(function() {
            // http://code.google.com/p/svg-edit/wiki/TipsAndTricks
            // waiting for real load
            (function(){
                try {
                    var cw = self.frame[0].contentWindow;
                    var md = cw.methodDraw;
                    md.ready(function() {     
                        cw.svgCanvas.setSvgString(self.options.svg);
                    });        
                    md.addExtension("server_opensave", {
                        callback: function() {
                            md.setCustomHandlers({
	                            save: function(win, data) {
		                            self.options.svg = data;
                                    self.onchange(data);
	                            }
                            });
                        }
                    });
                }
                catch (Ex){
                    setTimeout(arguments.callee, 1000);
                }
            })();
        });
        self.frame.appendTo(self.element);
    },
    refresh: function() {
        this.base();
    },
    _klass: "svg-editor thing",
    _type: "svg-editor",
    _defaults: {
        svg: '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100" height="100"></svg>',
        width: "800px",
        height: "600px"
    },
    _schema: {
       "type":"object",
       "description":"SvgEditor properties",
       "properties":{
          "svg":{
             "type":"string",
             "required":true
          },
          "width":{
             "type":"string",
             "required":false
          },
          "height":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


var TextThing = Html.extend({
    refresh: function() {
        this.base();
        var o = this.options;
        if(o['h-align'] && o['h-align'] != 'center') this.inner.addClass(o['h-align']);
        if(o['v-align'] && o['v-align'] != 'center') this.inner.addClass(o['v-align']);
        this.inner.css('font-size', o['font-size']);
        this.inner.css('font-family', o['font-family']);
    },
    _klass: "text-thing html thing",
    _type: "text-thing",
    _defaults: {
        "html": "",
        "css": "",
        "h-align": "center",
        "v-align": "center",
        "font-size": "20px",
        "font-family": "Georgia, serif"
    },
    _schema: {
       "type":"object",
       "properties":{
          "html":{
             "type":"string",
	     "format":"richtext",
             "required":true
          },
          "h-align":{
             "type":"string",
             "enum":["left","center","right"],
             "required":false
          },
          "v-align":{
             "type":"string",
             "enum":["top","center","bottom"],
             "required":false
          },
          "font-size":{
             "type":"string",
             "enum":["50%","60%","75%", "85%", "100%", "120%", "150%", "175%", "200%", "250%"],
             "required":false
          },
          "font-family":{
             "type":"string",
             "enum":[
'Arial,Arial,Helvetica,sans-serif',
'Arial Black,Arial Black,Gadget,sans-serif',
'Comic Sans MS,Comic Sans MS,cursive',
'Courier New,Courier New,Courier,monospace',
'Georgia,Georgia,serif',
'Impact,Charcoal,sans-serif',
'Lucida Console,Monaco,monospace',
'Lucida Sans Unicode,Lucida Grande,sans-serif',
'Palatino Linotype,Book Antiqua,Palatino,serif',
'Tahoma,Geneva,sans-serif',
'Times New Roman,Times,serif',
'Trebuchet MS,Helvetica,sans-serif',
'Verdana,Geneva,sans-serif' 
],
             /*"format":"font",*/
             "required":false
          }
       },
       "additionalProperties":true
    }
});


var Templated = Thing.extend({
    refresh: function() {
        var tmpl = $.templates( "#"+this.options.template+"Template" );
        var html = tmpl.render(this.options);
        this.element.html(html);
        this.element.find("[data-slot]").each(function() { 
            $(this).html(Thing.empty().get()); 
        });
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.find("[data-slot='"+key+"']").html(value.get());
        return this;
    },
    _klass: "templated thing",
    _type: "templated",
    _defaults: {
        template: "demo",
        name: "Myrousz"
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "template": {
			    "type":"string",
			    "required":true
		    },
		    "name": {
			    "type":"string",
			    "required":true
		    }
	    }
    }
});


var Snippet = Thing.extend({
    refresh: function() {
        var o = this.options;
        var code = $("<pre>").text(o.code);
        this.element.html(code);
        SyntaxHighlighter.highlight({title: o.title, 'brush':o.lang}, code.get(0));        
    },
    _klass: "snippet thing",
    _type: "snippet",
    _defaults: {
        "title": "",
        "lang": "js",
        "code": ""
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "title": {
			    "type":"string",
			    "required":false
		    },
		    "lang": {
			    "type":"string",
                "enum":["js","php","plain"],
			    "required":true
		    },
		    "code": {
			    "type":"string",
			    "required":true
		    }
	    }
    }
});


var SoftKeyboard = Thing.extend({
    init: function() {
        this.keys = {};
        this.onkeypress = $.noop;
    },
    refresh: function() {
        var kbd = $("<div>");
        var rows = this.options.rows;
        var cols = this.options.rows;
        for(var key in this.options.keys) {
            var k = this.options.keys[key];
            var kk = this._makeKey(key, k).appendTo(kbd);
            this.keys[key] = kk;
        }
        this.element.html(kbd);
    },
    getKeyButton: function(key) {
        return {"name":key, "button":this.keys[key], "key":this.options.keys[key]};
    },
    _makeKey: function(name, k) {
        var self = this;
        var o = this.options;
        var top = Math.floor(100*k.top/o.rows) + "%";
        var left = Math.floor(100*k.left/o.columns) + "%";
        var ww = k.size || k.width;
        var hh = k.size || k.height;
        var mm = 2;
        var width = Math.floor(100*ww/o.columns) + "%";
        var height = Math.floor(100*hh/o.rows) + "%";
        var div = $("<button>").addClass("key key-"+name).css({'top':top, 'left':left, 'width':width, 'height':height}).append($("<div>").text(k.label));
        div.click(function() {
            if(k['switch']) {
                div.toggleClass("active");
            }
            self.keyPressed(self.getKeyButton(name));
        });
        return div;
    },
    keyPressed: function(kb) {
        if(typeof kb == 'function') {
            this.onkeypress = kb;
        } else {
            this.onkeypress(kb);
        }
    },
    getSwitchState: function(name) {
        if(this.options.keys[name] && this.options.keys[name]['switch']) {
            return this.keys[name].hasClass("active");
        } else {
            return false;
        }
    },    
    _klass: "soft-keyboard thing",
    _type: "soft-keyboard",
    _defaults: {
        "rows": 8,
        "columns": 20,
        "keys": {
            "q" : { "left":0, "top":0, "size":2, "label":"Q"},
            "w" : { "left":2, "top":0, "size":2, "label":"W"},
            "e" : { "left":4, "top":0, "size":2, "label":"E"},
            "r" : { "left":6, "top":0, "size":2, "label":"R"},
            "t" : { "left":8, "top":0, "size":2, "label":"T"},
            "y" : { "left":10, "top":0, "size":2, "label":"Y"},
            "u" : { "left":12, "top":0, "size":2, "label":"U"},
            "i" : { "left":14, "top":0, "size":2, "label":"I"},
            "o" : { "left":16, "top":0, "size":2, "label":"O"},
            "p" : { "left":18, "top":0, "size":2, "label":"P"},
            "a" : { "left":1, "top":2, "size":2, "label":"A"},
            "s" : { "left":3, "top":2, "size":2, "label":"S"},
            "d" : { "left":5, "top":2, "size":2, "label":"D"},
            "f" : { "left":7, "top":2, "size":2, "label":"F"},
            "g" : { "left":9, "top":2, "size":2, "label":"G"},
            "h" : { "left":11, "top":2, "size":2, "label":"H"},
            "j" : { "left":13, "top":2, "size":2, "label":"J"},
            "k" : { "left":15, "top":2, "size":2, "label":"K"},
            "l" : { "left":17, "top":2, "size":2, "label":"L"},
            "caps" : { "left":0, "top":4, "width":3, "height":2, "label":__("caps"), "switch":true},
            "z" : { "left":3, "top":4, "size":2, "label":"Z"},
            "x" : { "left":5, "top":4, "size":2, "label":"X"},
            "c" : { "left":7, "top":4, "size":2, "label":"C"},
            "v" : { "left":9, "top":4, "size":2, "label":"V"},
            "b" : { "left":11, "top":4, "size":2, "label":"B"},
            "n" : { "left":13, "top":4, "size":2, "label":"N"},
            "m" : { "left":15, "top":4, "size":2, "label":"M"},
            "del" : { "left":17, "top":4, "width":3, "height":2, "label":__("del")},
            "nums" : { "left":0, "top":6, "width":4, "height":2, "label":__("?123")},
            "comma" : { "left":4, "top":6, "width":3, "height":2, "label":","},
            "space" : { "left":7, "top":6, "width":6, "height":2, "label":__("space")},
            "dot" : { "left":13, "top":6, "width":3, "height":2, "label":"."},
            "enter" : { "left":16, "top":6, "width":4, "height":2, "label":__("enter")}
        }
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "rows": {
			    "type":"integer",
			    "required":true
		    },
		    "columns": {
			    "type":"integer",
			    "required":true
		    }
	    }
    }
});


var SoftTextEditor = Thing.extend({
    init: function() {
        var self = this;
        this.onchange = $.noop;
        this.keyboard = new SoftKeyboard();
        this.keyboard.keyPressed(function(kb) {
            self._keyPressed(kb);
        });
        this.textfield = $("<textarea>").val(this.options.value).change(function() {
            self.options.value = $(this).val();
        });
        this.buttonOk = $("<button>").addClass('done').text(__("Done")).click(function() {
            self.change(self.textfield.val());
        });
        this.element
            .append($("<div>").addClass("textfield").append(this.textfield))
            .append($("<div>").addClass("btn").append(this.buttonOk))            
            .append(this.keyboard.get());
    },
    refresh: function() {
        this.textfield.val(this.options.value);
    },
    // TODO napojit
    change: function(arg) {
        if(typeof arg == 'function') {
            this.onchange = arg;
        } else {
            this.onchange(arg);
        }
    },
    _keyPressed: function(kb) {
        var cc = kb.name;
        switch(cc) {
            case 'caps': 
                this.capsLock = this.keyboard.getSwitchState('caps');
                break;
            case 'del':
                // delete last character
                this.options.value = this.options.value.slice(0, -1);
                this.refresh();
                break;
            case 'nums': 
                break;
            case 'enter':
                this.options.value += "\n";
                this.refresh();
                break;
            case 'comma':
                this.options.value += ",";
                this.refresh();
                break;
            case 'space':
                this.options.value += " ";
                this.refresh();
                break;
            case 'dot':
                this.options.value += ".";
                this.refresh();
                break;
            default:
                if(this.capsLock) {
                    // invert case...
                    cc = ( cc >= 'A' && cc <= 'Z' ) ? cc.toLowerCase() : cc.toUpperCase();
                }
                this.options.value += cc;
                this.refresh();
        }
    },
    _klass: "soft-text-editor thing",
    _type: "soft-text-editor",
    _defaults: {
        "value": ""
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "value": {
			    "type":"string",
			    "required":true
		    }
	    }
    }
});



var HolidayCalendar = {
    // kdy je velikonocni nedele - bozi hod velikonocni?
    easter: {
        "2012": {month: 4, day: 8},
        "2013": {month: 3, day: 31},
        "2014": {month: 4, day: 20},
        "2015": {month: 4, day: 5}
    },
    data: 
// BEGIN JSON DATA
[
    {
        "month": "Leden",
        "days": [
            {
                "number": "1",
                "names": [
                    "Nový rok"/*,
                    "Den obnovy samostatného českého státu"*/
                ],
                "holiday": true
            },
            {
                "number": "2",
                "names": [
                    "Karina"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Radmila"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Diana"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Dalimil"
                ]
            },
            {
                "number": "6",
                "names": [
                    /*"Kašpar",
                    "Melichar",
                    "Baltazar"*/"Tři králové"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Vilma"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Čestmír"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Vladan"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Břetislav"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Bohdana"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Pravoslav"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Edita"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Radovan"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Alice"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Ctirad"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Drahoslav"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Vladislav"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Sára/Doubravka"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Ilona"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Běla"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Slavomír"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Zdeněk"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Milena"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Miloš"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Zora"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Ingrid"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Otýlie"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Zdislava"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Robin"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Marika"
                ]
            }
        ]
    },
    {
        "month": "Únor",
        "days": [
            {
                "number": "1",
                "names": [
                    "Hynek"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Nela"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Blažej"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Jarmila"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Dobromila"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Vanda"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Veronika"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Milada"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Apolena"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Mojmír"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Božena"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Slavěna"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Věnceslav"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Valentýn"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Jiřina"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Ljuba"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Miloslava"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Gizela"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Patrik"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Oldřich"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Lenka"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Petr"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Svatopluk"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Matěj"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Liliana"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Dorota"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Alexandr"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Lumír"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Horymír"
                ]
            }
        ]
    },
    {
        "month": "Březen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Bedřich"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Anežka"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Kamil"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Stela"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Kazimír"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Miroslav"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Tomáš"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Gabriela"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Františka"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Viktorie"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Anděla"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Řehoř"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Růžena"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Matylda/Rút"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Ida"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Herbert/Elena"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Vlastimil"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Eduard"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Josef"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Světlana"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Radek"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Leona"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Ivona"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Gabriel"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Marian"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Emanuel"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Dita"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Soňa"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Taťána"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Arnošt"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Kvido"
                ]
            }
        ]
    },
    {
        "month": "Duben",
        "days": [
            {
                "number": "1",
                "names": [
                    "Hugo"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Erika"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Richard"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Ivana"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Miroslava"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Vendula"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Hermína/Herman"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Ema"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Dušan"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Darja"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Izabela"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Július"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Aleš"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Vincenc"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Anastázie"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Irena"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Rudolf"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Valérie"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Rostislav"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Marcela"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Alexandra"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Evženie"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Vojtěch"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jiří"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Marek"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Oto"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Jaroslav"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Vlastislav"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Robert"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Blahoslav"
                ]
            }
        ]
    },
    {
        "month": "Květen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Svátek práce"
                ],
                "holiday": true
            },
            {
                "number": "2",
                "names": [
                    "Zikmund"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Alexej"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Květoslav"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Klaudie"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Radoslav"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Stanislav"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Den vítězství"
                ],
                "holiday": true
            },
            {
                "number": "9",
                "names": [
                    "Ctibor"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Blažena"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Svatava"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Pankrác"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Servác"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Bonifác"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Žofie"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Přemysl"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Aneta"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Nataša"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Ivo"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Zbyšek"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Monika"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Emil"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Vladimír"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jana"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Viola"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Filip"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Valdemar"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Vilém"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Maxmilián"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Ferdinand"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Kamila"
                ]
            }
        ]
    },
    {
        "month": "Červen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Laura"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Jarmil"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Tamara"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Dalibor"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Dobroslav"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Norbert"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Iveta"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Medard"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Stanislava"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Gita"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Bruno"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Antonie"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Antonín"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Roland"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Vít"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Zbyněk"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Adolf"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Milan"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Leoš"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Květa"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Alois"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Pavla"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Zdeňka"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jan"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Ivan"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Adriana"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Ladislav"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Lubomír"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Petr a Pavel"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Šárka"
                ]
            }
        ]
    },
    {
        "month": "Červenec",
        "days": [
            {
                "number": "1",
                "names": [
                    "Jaroslava"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Patricie"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Radomír"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Prokop"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Cyril a Metoděj"
                ],
                "holiday": true
            },
            {
                "number": "6",
                "names": [
                    /*"Den upálení Mistra Jana Husa"*/"Jan Hus"
                ],
                "holiday": true
            },
            {
                "number": "7",
                "names": [
                    "Bohuslava"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Nora"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Drahoslava"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Libuše/Amálie"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Olga"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Bořek"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Markéta"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Karolína"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Jindřich"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Luboš"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Martina"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Drahomíra"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Čeněk"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Ilja/Eliáš"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Vítězslav"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Magdalena"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Libor"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Kristýna"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Jakub"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Anna"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Věroslav"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Viktor"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Marta"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Bořivoj"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Ignác"
                ]
            }
        ]
    },
    {
        "month": "Srpen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Oskar"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Gustav"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Miluše"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Dominik"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Kristián"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Oldřiška"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Lada"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Soběslav"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Roman"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Vavřinec"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Zuzana"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Klára"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Alena"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Alan"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Hana"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Jáchym"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Petra"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Helena"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Ludvík"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Bernard"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Johana"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Bohuslav"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Sandra"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Bartoloměj"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Radim"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Luděk"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Otakar"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Augustýn"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Evelína"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Vladěna"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Pavlína"
                ]
            }
        ]
    },
    {
        "month": "Září",
        "days": [
            {
                "number": "1",
                "names": [
                    "Linda/Samuel"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Adéla"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Bronislav"
                    /* /Bronislava"*/
                ]
            },
            {
                "number": "4",
                "names": [
                    "Jindřiška"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Boris"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Boleslav"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Regina"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Mariana"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Daniela"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Irma"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Denisa"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Marie"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Lubor"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Radka"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Jolana"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Ludmila"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Naděžda"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Kryštof"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Zita"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Oleg"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Matouš"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Darina"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Berta"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jaromír"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Zlata"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Andrea"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Jonáš"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Václav"/*,
                    "Den české státnosti"*/
                ],
                "holiday": true
            },
            {
                "number": "29",
                "names": [
                    "Michal"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Jeroným"
                ]
            }
        ]
    },
    {
        "month": "Říjen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Igor"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Olivie/Oliver"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Bohumil"
                ]
            },
            {
                "number": "4",
                "names": [
                    "František"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Eliška"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Hanuš"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Justýna"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Věra"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Štefan/Sára"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Marina"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Andrej"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Marcel"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Renáta"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Agáta"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Tereza"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Havel"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Hedvika"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Lukáš"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Michaela"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Vendelín"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Brigita"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Sabina"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Teodor"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Nina"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Beáta"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Erik"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Šarlota/Zoe"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Státní svátek"/*,
                    "Den vzniku samostatného československého státu"*/
                ],
                "holiday": true
            },
            {
                "number": "29",
                "names": [
                    "Silvie"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Tadeáš"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Štěpánka"
                ]
            }
        ]
    },
    {
        "month": "Listopad",
        "days": [
            {
                "number": "1",
                "names": [
                    "Felix"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Památka zesnulých"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Hubert"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Karel"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Miriam"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Liběna"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Saskie"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Bohumír"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Bohdan"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Evžen"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Martin"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Benedikt"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Tibor"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Sáva"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Leopold"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Otmar"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Mahulena"/*,
                    "Den boje za svobodu a demokracii"*/
                ],
                "holiday": true
            },
            {
                "number": "18",
                "names": [
                    "Romana"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Alžběta"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Nikola"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Albert"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Cecílie"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Klement"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Emílie"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Kateřina"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Artur"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Xenie"
                ]
            },
            {
                "number": "28",
                "names": [
                    "René"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Zina"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Ondřej"
                ]
            }
        ]
    },
    {
        "month": "Prosinec",
        "days": [
            {
                "number": "1",
                "names": [
                    "Iva"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Blanka"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Svatoslav"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Barbora"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Jitka"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Mikuláš"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Ambrož/Benjamín"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Květoslava"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Vratislav"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Julie"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Dana"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Simona"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Lucie"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Lydie"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Radana"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Albína"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Daniel"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Miloslav"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Ester"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Dagmar"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Natálie"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Šimon"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Vlasta"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Adam a Eva"/*,
                    "Štědrý den"*/
                ],
                "holiday": true
            },
            {
                "number": "25",
                "names": [
                    "Boží hod vánoční"
                ],
                "holiday": true
            },
            {
                "number": "26",
                "names": [
                    "Štěpán"/*,
                    "Druhý svátek vánoční"*/
                ],
                "holiday": true
            },
            {
                "number": "27",
                "names": [
                    "Žaneta"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Bohumila"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Judita"
                ]
            },
            {
                "number": "30",
                "names": [
                    "David"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Silvestr"
                ]
            }
        ]
    }
]
// END JSON DATA
};

var Calendar = RaphaelThing.extend({
    /* canvas size: 1000x1000 */
    refresh: function() { 
        this.base();   
        var d = this.options;
        this.paper = this.canvas;
        this.paper.clear();
        this.lineAttr = { "fill": "none", "stroke": d.lineColor};
        this.monthNameAttr = { "stroke": "none", "fill": d.fontColor, "font-family":d.fontFamily, "font-size":d.titleFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.monthCapAttr = { "fill": d.fontColor, "stroke": "none", "font-family":d.fontFamily, "font-size":d.dayCapFontSize, "font-style":d.fontStyle};
        this.dayNumAttr = { "stroke": "none", "fill":d.fontColor, "font-family":d.fontFamily, "font-weight":"bold", "font-size":d.numbersFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.dayNameAttr = { "stroke": "none", "fill": d.fontColor, "font-family":d.fontFamily, "font-size":d.namesFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.dayNumAttrHigh = { "stroke": "none", "fill": d.fontColorHigh, "font-family":d.fontFamily, "font-weight":"bold", "font-size":d.numbersFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.dayNameAttrHigh = { "stroke": "none", "fill": d.fontColorHigh, "font-family":d.fontFamily, "font-size":d.namesFontSize, "font-style":d.fontStyle, "text-anchor":"end"};

        this.monthCapOffset = 12;
        this.boxWidth = 142;
        this.boxHeight = 142;
        this.drawMonth(d.year, d.month);
        // HACK: https://github.com/DmitryBaranovskiy/raphael/issues/491
        this.element.find("tspan").attr("dy", 0);
    },

    drawMonthGrid: function(rows, x, y) {
        // draws grid 7x5 with day captions
        for(var i=0; i<=7; i++) {
            // draw captions
            // draw vertical lines
            var xx = x + i*this.boxWidth;
            var str = "M"+xx+","+y+"l0,"+rows*this.boxHeight;
            this.paper.path(str).attr(this.lineAttr); 
            if(i<7) this.paper.text(xx+this.boxWidth/2, y-this.monthCapOffset, this.locale[this.currentLocale].daysOfWeek[i]).attr(this.monthCapAttr);
        }
        for(var j=0; j<=rows; j++) {
            // draw horizontal lines
            var yy = y + j*this.boxHeight;
            var str = "M"+x+","+yy+"l"+7*this.boxWidth+",0";
            this.paper.path(str).attr(this.lineAttr);            
        }                    
    },

    drawDayBox: function(row, column, year, month, day, x, y) {
        // is day sunday?
        var sunday = this.getDayOfWeek(year, month, day) == 0;
        // is day holiday?
        var holiday = HolidayCalendar.data[month-1].days[day-1].holiday;

        var xx = x + (column+1)*this.boxWidth - 5;
        // print number...
        var yy = y + (row+1-0.45)*this.boxHeight - 5;
        this.paper.text(xx, yy, day).attr((sunday || holiday) ? this.dayNumAttrHigh : this.dayNumAttr);
        // print name
        var yy = y + (row+1-0.1)*this.boxHeight - 5;
        this.paper.text(xx, yy, HolidayCalendar.data[month-1].days[day-1].names[0]).attr(holiday ? this.dayNameAttrHigh : this.dayNameAttr);
    },

    drawMonth: function(year, month) {
        var x = 0;
        var column = this.getDayOfWeek(year, month, 1);
        // nedele = 0! pondeli 1...
        column = (column==0) ? 6 : column-1;
        // how many total rows?
        lastColumn = column+HolidayCalendar.data[month-1].days.length;
        var totalRows = Math.floor((lastColumn+6)/7);
        var y = 7*this.boxHeight - totalRows*this.boxHeight;
        // draw month name
        var mn = this.locale[this.currentLocale].months[month-1] + " "+year;
        this.drawMonthGrid(totalRows, x, y);
        this.paper.text(x+7*this.boxWidth, y-0.7*this.boxHeight, mn).attr(this.monthNameAttr);
        var row = 0;
        for(var i=0; i<HolidayCalendar.data[month-1].days.length; i++) {
            this.drawDayBox(row, column, year, month, i+1, x, y);
            column++;
            if(column == 7) {
                column = 0;
                row++;
            }
        }

    },
    locale: {
        "en": {
            "months": [
                "January","February","March","April","May","June","July","August","September","October","November","December"
            ],
            "daysOfWeek": [
                "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"
            ]
        },
        "cz": {
            "months": [
                "Leden","Únor","Březen","Duben","Květen","Červen","Červenec","Srpen","Září","Říjen","Listopad","Prosinec"
            ],
            "daysOfWeek": [
                "Pondělí", "Úterý", "Středa", "Čtvrtek", "Pátek", "Sobota", "Neděle"
            ]
        }
    },
    currentLocale: 'cz',
    getDayOfWeek: function(year, month, day) {
        var d = new Date(year, month-1, day, 0, 0, 0, 0);
        return d.getDay();
    },
    isLeapYear: function(yr) {
        return new Date(yr,2-1,29).getDate()==29;
    },

    _klass: "calendar raphael-thing thing",
    _type: "calendar",
    _defaults: {
        width: 1000,
        height: 1000,
        year: 2012,
        month: 12,
        fontFamily: "Arial", 
        fontStyle: "italic", 
        lineColor: "black",
        fontColor: "black",
        fontColorHigh: "red",
        titleFontSize: "40",
        dayCapFontSize: "20",
        numbersFontSize: "60",
        namesFontSize: "16"
    },
    _schema: {
       "type":"object",
       "description":"Calendar properties",
       "properties":{
          "year":{
             "type":"string",
             "enum":["2012", "2013","2014","2015"],
             "required":true
          },
          "month":{
             "type":"string",
             "enum":["1", "2","3","4","5","6","7","8","9","10","11","12"],
             "required":true
          },
            // .....
          "titleFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "dayCapFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "numbersFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "namesFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "fontFamily":{
             "type":"string",
             "enum":["Georgia, serif","Arial, Helvetica, sans-serif","Impact, Charcoal, sans-serif", "Tahoma, Geneva, sans-serif", "Verdana, Geneva, sans-serif", "Monaco, monospace"],
             "required":true
          },
          "fontStyle":{
             "type":"string",
             "enum":["regular","italic","monospace"],
             "required":true
          }
       },
       "additionalProperties":true
    }
});



// TODO kdyz zmenim parametry hodin a ulozim, nepromitne se to do inputu

var Clock = RaphaelThing.extend({
    refresh: function() {
        this.base();
        var 
            o = this.options,
            size = o.size,
            canvas = this.canvas,
            clock = canvas.circle(size*.5,size*.5, size * .475);
        clock.attr({"fill":o.fillColor,"stroke":o.strokeColor,"stroke-width":(size*.025)})
        var hour_sign;
        for(i=0;i<12;i++){
            var start_x = size*.5+Math.round((size*.4)*Math.cos(30*i*Math.PI/180));
            var start_y = size*.5+Math.round((size*.4)*Math.sin(30*i*Math.PI/180));
            var end_x = size*.5+Math.round((size*.45)*Math.cos(30*i*Math.PI/180));
            var end_y = size*.5+Math.round((size*.45)*Math.sin(30*i*Math.PI/180));
            hour_sign = canvas.path("M"+start_x+" "+start_y+"L"+end_x+" "+end_y);
        }
        this.hour_hand = canvas.path("M" + size*.5 + " " + size*.5 + "L" + size*.5 + " " + (size*.25) + "");
        this.hour_hand.attr({stroke: o.hourHandColor, "stroke-width": size*.03});
        this.minute_hand = canvas.path("M" + size*.5 + " " + size*.5 + "L" + size*.5 + " " + (size*.2) + "");
        this.minute_hand.attr({stroke: o.minuteHandColor, "stroke-width": size*.02});
        this.second_hand = canvas.path("M" + size*.5 + " " + (size*.55) + "L" + size*.5 + " " + (size*.125) + "");
        this.second_hand.attr({stroke: o.secondHandColor, "stroke-width": size*.01});
        var pin = canvas.circle(size*.5, size*.5, size*.025);
        pin.attr("fill", o.pinColor);

        var self = this;
        var updater = function() {
            self.update();
        };
        updater();
        setInterval(updater,1000); 
    },
    update: function() {
        var self = this,
            size = this.options.size,
            now = new Date(),
            hours = now.getHours(),
            minutes = now.getMinutes(),
            seconds = now.getSeconds(),
            cc = ","+(size*.5)+","+(size*.5);
        self.hour_hand.transform('r'+(30*hours+(minutes/2.5))+cc);
        self.minute_hand.transform('r'+(6*minutes)+cc);
        self.second_hand.transform('r'+(6*seconds)+cc);
    },
    _klass: "clock raphael-thing thing",
    _type: "clock",
    _defaults: {
        width: 100,
        height: 100,
        size: 100,
        fillColor: "white", 
        strokeColor: "black", 
        pinColor: "gray",
        hourHandColor:"black", 
        minuteHandColor:"black",
        secondHandColor:"black"
    },
    _schema: {
       "type":"object",
       "description":"Clock properties",
       "properties":{
          "size":{
             "type":"integer",
             "required":true
          },
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          },
          "fillColor":{
             "type":"string",
             "format": "color",
             "required":true
          },
          "strokeColor": { "type": "string", "required": true, "format": "color" },
          "pinColor": { "type": "string", "required": true, "format": "color" },
          "hourHandColor": { "type": "string", "required": true, "format": "color" },
          "minuteHandColor": { "type": "string", "required": true, "format": "color" },
          "secondHandColor": { "type": "string", "required": true, "format": "color" }
       },
       "additionalProperties":true
    }
});


var Modal = Thing.extend({
    init: function() {
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.html($("<p>").html(value.get()));
        this.refresh();
        return this;
    },
    _fullOpts: function() {
      return $.extend({modal: true}, this.options)
    },
    show: function() {
        var self = this;
	    $(self.element).dialog(this._fullOpts());
	    $(self.element).dialog('open');
    },
    close: function() {
	    $(this.element).dialog('close');
    },
    refresh: function() {
    	$(this.element).dialog(this._fullOpts());
    },
    _klass: "modal thing",
    _type: "modal",
    _defaults: {
        autoOpen: false,
        minHeight: 608, // 560,  
        minWidth: 760, //740
        title: 'Dialog',
        closeOnEscape: true
    },
    _schema: {
       "type":"object",
       "properties":{
          "title": {
             "type": "string",
             "required": false
          },
          "autoOpen":{
             "type":"boolean",
             "required":true
          },
          "minHeight":{
             "type":"string",
             "required":true
          },
          "minWidth":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }

}, {
    show: function(thing, opts) {
        var modal = new Modal(opts);
        modal.content('content',thing);
        modal.show();
        return modal;
    }
});


var Dummy = Html.extend({
    refresh: function() {
        this.base();
        this.element.css('width', this.options['width']);
        this.element.css('height',this.options['height']);
        this.element.css('color',this.options['color']);
        this.element.css('background-color',this.options['background-color']);
    },
    _klass: "dummy html thing",
    _type: "dummy",
    _defaults: {
        html: "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla sed dolor nisl, in suscipit justo. Donec a enim et est porttitor semper at vitae augue. Proin at nulla at dui mattis mattis. Nam a volutpat ante. Aliquam consequat dui eu sem convallis ullamcorper. Nulla suscipit, massa vitae suscipit ornare, tellus est consequat nunc, quis blandit elit odio eu arcu. Nam a urna nec nisl varius sodales. Mauris iaculis tincidunt orci id commodo. Aliquam non magna quis tortor malesuada aliquam eget ut lacus. Nam ut vestibulum est. Praesent volutpat tellus in eros dapibus elementum. Nam laoreet risus non nulla mollis ac luctus felis dapibus. Pellentesque mattis elementum augue non sollicitudin. Nullam lobortis fermentum elit ac mollis. Nam ac varius risus. Cras faucibus euismod nulla, ac auctor diam rutrum sit amet. Nulla vel odio erat, ac mattis enim.",
        'width': "",
        'height': '',
        'color': '',
        'background-color': ''
    },
    _schema: {
       "type":"object",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "height":{
             "type":"string",
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          },
          "background-color":{
             "type":"string",
             "format": "color",
             "required":true
          }
       },
       "additionalProperties":true
    }
});

// decorator = thing with a single slot named 'content'

// TODO podedit toto vsechno od 'Decorator'
// kvuli reverzibilite dekoratoru by bylo dobre kdyby kazdy menil css properties 'wrapper' divu
var Decorator = Thing.extend({
    init: function() {
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.html(value.get());
        return this;
    },
    unwrap: function() {
        this.replaceWith(this.getSlot('content'));
    },
    _klass: "decorator thing",
    _type: "decorator"
});


















var Clickable = Thing.extend({
    init: function() {
        this.pane = $("<div>").addClass("clickable-pane");
        this.setSlot('content', Thing.empty());
        this.click($.noop);
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.empty()
            .append(value.get())
            .append(this.pane);
        return this;
    },
    refresh: function() {
      this.base();
      this.pane.attr('title', this.options.tooltip);
    },
    click: function(arg) {
        if(arg) {
            this.onclick = arg;
            this.pane.click(this.onclick);
        } else {
            return this.onclick();
        }
    },
    _klass: "clickable thing",
    _type: "clickable",
    _defaults: {
      "tooltip": ""
    }
});


var Editable = Thing.extend({
    init: function() {
        this.onchanged = $.noop;
        this.editor = $("<div>").addClass("editable-editor");
        this.pane = $("<div>").addClass("editable-pane");
        this.element.append(this.pane).append(this.editor);
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        var self = this;
        var schema = value._schema;
        this.editor.empty();
        if(!schema) {
            // pouzit radsi json editor
        } else {
            this.editor.jsonform({schema: value._schema, value: value.options, name: __("Properties")+" - "+value._type});
            this.editor.jsonform('change', function() {
                self._save(true);
            });
            this.editor.jsonform('save', function() {
                self._save();
            });
        }
        this.pane.html(value.get());
        return this;
    },
    _save: function(stay) {
        var self = this;
        // value changed in editor...
        var newVal = self.editor.jsonform('value');
        self.getSlot('content').setOptions(newVal);
        if(!stay) self.onchanged(newVal);
    },
    _klass: "editable thing",
    _type: "editable",
    _defaults: {}
}, {
    edit: function(thing, changed) {
        var edt = new Editable();
        edt.setSlot('content', thing.copy());
        var modal = Modal.show(edt, {height: 630, minHeight: 630, width: 840, minWidth: 840, resizable: false, draggable: true, title:__('Properties')});
        edt.onchanged = function(newVal) {
            modal.close();
            if(changed) changed(newVal);
        };
    }
});



var ToolbarDecorator = Thing.extend({
    init: function() {
        this._content = $("<div>")
            .addClass("mykkro-toolbar-decorator-content")
            .appendTo(this.element);
        this.setSlot('content', Thing.empty());
    },
    refresh: function() {
	    this.base();
        if(this.options.hidden) {
            this.element.toolbar({tools:{}});
        } else {
            this.element.toolbar({tools:this.options.tools});
        }
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this._content.html(value.get());
        return this;
    },
    showToolbar: function() {
        this.options.hidden = false;
        this.refresh();
    },
    hideToolbar: function() {
        this.options.hidden = true;
        this.refresh();
    },
    serialize: function() {
        // toolbar decorator se nebude serializovat (aspon automaticky ne)
        return this.getSlot('content').serialize();
    },
    getTree: function() {
        // skip the outer layer...
        return this.getSlot('content').getTree();
    },
    getTreeView: function(decorator) {
        // skip the outer layer...
        return this.getSlot('content').getTreeView(decorator);
    },
    _klass: "toolbar-decorator thing",
    _type: "toolbar-decorator",
    _defaults: {
        tools: {}
    } 
});


var ContextmenuDecorator = Thing.extend({
    init: function() {
        this._content = $("<div>")
            .addClass("mykkro-contextmenu-decorator-content")
            .appendTo(this.element);
        this.setSlot('content', Thing.empty());
    },
    refresh: function() {
	    this.base();
        if(this.options.hidden) {
            this.element.toolbar({tools:{}});
        } else {
            this.element.toolbar({tools:this.options.tools});
        }
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this._content.html(value.get());
        return this;
    },
    showToolbar: function() {
        this.options.hidden = false;
        this.refresh();
    },
    hideToolbar: function() {
        this.options.hidden = true;
        this.refresh();
    },
    serialize: function() {
        // toolbar decorator se nebude serializovat (aspon automaticky ne)
        return this.getSlot('content').serialize();
    },
    getTree: function() {
        // skip the outer layer...
        return this.getSlot('content').getTree();
    },
    getTreeView: function(decorator) {
        // skip the outer layer...
        return this.getSlot('content').getTreeView(decorator);
    },
    _klass: "contextmenu-decorator thing",
    _type: "contextmenu-decorator",
    _defaults: {
        tools: {}
    } 
});


var Page = Decorator.extend({
    // options changed...
    refresh: function() {
        this.element.css({
          'width': this.options['width'],
          'height': this.options['height'],
          'background-size': 'cover',
          'background-image': 'url('+this.options['background_url']+')'
        })
    },
    _klass: "page decorator thing",
    _type: "page",
    _defaults: {
        'width': '500px',
        'height': '700px',
        'background_url': ''
    },
    _schema: {
       "type":"object",
       "description":"Page properties",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "height":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var Preview = Decorator.extend({
    // options changed...
    refresh: function() {
        this.element.css('width',this.options['width']);
        this.element.css('height',this.options['height']);
    },
    _klass: "preview decorator thing",
    _type: "preview",
    _defaults: {
        'width': '80px',
        'height': '110px',
        'label': 'preview',
        'description': ''
    },
    _schema: {
       "type":"object",
       "description":"Clock properties",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "height":{
             "type":"string",
             "required":true
          },
          "label":{
             "type":"string",
             "required":false
          },
          "description":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }
});


var OpacityDecorator = Decorator.extend({
    refresh: function() {
      this.base();
      this.element.css('opacity',this.options.opacity);
    },
    _klass: "opacity-decorator decorator thing",
    _type: "opacity-decorator",
    _defaults: {
        opacity: 0.8
    },
    _schema: {
       "type":"object",
       "description":"Clock properties",
       "properties":{
          "opacity":{
             "type":"number",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var InsetDecorator = Decorator.extend({
    refresh: function() {
	this.base();
        this.element.css('padding',this.options.top+'% '+this.options.right+"% "+this.options.bottom+"% "+this.options.left+"%");
    },
    _klass: "inset-decorator decorator thing",
    _type: "inset-decorator",
    _defaults: {
        top: 2,
        left: 2,
        right: 2,
        bottom: 2
    },
    _schema: {
	"type":"object",
	"$schema": "http://json-schema.org/draft-03/schema",
	"properties":{
		"bottom": {
			"type":"number",
			"id": "bottom",
			"required":true
		},
		"left": {
			"type":"number",
			"id": "left",
			"required":true
		},
		"right": {
			"type":"number",
			"id": "right",
			"required":true
		},
		"top": {
			"type":"number",
			"id": "top",
			"required":true
		}
	},
       "additionalProperties":true
    }

});



var ShadowDecorator = Decorator.extend({
    // options changed...
    refresh: function() {
	this.base();
        var br = this.options['h-shadow']+" "+this.options['v-shadow']+" "+this.options.blur+" "+this.options.spread+" "+this.options.color;
        this.element.css('box-shadow',br);
        this.element.css('-webkit-box-shadow',br);
    },
    _klass: "shadow-decorator decorator thing",
    _type: "shadow-decorator",
    _defaults: {
        'h-shadow': "5px",
        'v-shadow': "5px",
        blur: "5px",
        spread: "5px",
        color: "#666"
    },
    _schema: {
       "type":"object",
       "properties":{
          "h-shadow":{
             "type":"string",
             "required":true
          },
          "v-shadow":{
             "type":"string",
             "required":true
          },
          "blur":{
             "type":"string",
             "required":true
          },
          "spread":{
             "type":"string",
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          }
       },
       "additionalProperties":true
    }
});





var BackgroundDecorator = Decorator.extend({
    // options changed...
    refresh: function() {
        this.base();
        if(this.options['image']) 
            this.element.css('background-image','url("'+this.options['image']+'")');
        else 
            this.element.css('background-image','');
        this.element.css('background-position',this.options['position']);
        this.element.css('background-repeat',this.options['repeat']);
        this.element.css('background-color',this.options['color']);
        this.element.css('background-size',this.options['size']);
    },
    _klass: "background-decorator decorator thing",
    _type: "background-decorator",
    _defaults: {
        'image': "",
        'repeat': 'no-repeat',
        'position': 'center center',
        'color': 'white',
        'size': 'cover'
    },
    _schema: {
       "type":"object",
       "properties":{
          "image":{
             "type":"string",
             "format": "my-image-uri",
            // TODO vadi mu kdyz je to false - option se neda rozkliknout
             "required":true
          },
          "repeat":{
             "enum": ["repeat","no-repeat","repeat-x","repeat-y"],
             "type":"string",
             "required":true // TODO
          },
          "position":{
             "type":"string",
             "required":true // TODO
          },
          "size":{
             "type":"string",
             "enum": ["cover","contain"],
             "required":true // TODO
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true // TODO
          }
       },
       "additionalProperties":true
    }
});



// TODO sloucit nejak s rounded decoratorem
var BorderDecorator = Decorator.extend({
    // options changed...
    refresh: function() {
        this.base();
        this.element.css('border-width', this.options['width']);
        this.element.css('border-style',this.options['style']);
        this.element.css('border-color',this.options['color']);
    },
    _klass: "border-decorator decorator thing",
    _type: "border-decorator",
    _defaults: {
        'width': "1px",
        'style': 'solid',
        'color': 'black'
    },
    _schema: {
       "type":"object",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "style":{
             "type":"string",
             "enum": ["none","solid","dotted","dashed","double","groove","ridge","inset","outset"],
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var RoundedDecorator = BorderDecorator.extend({
    refresh: function() {
        this.base();
        var br = this.options.radius;
        // TODO individualne vsechny 4 rohy
        this.element.css('border-radius',br);
        this.element.css('-webkit-border-radius',br);
        this.element.css('-moz-border-radius',br);
    },
    _klass: "rounded-decorator decorator thing",
    _type: "rounded-decorator",
    _defaults: {
        'width': "1px",
        'style': 'solid',
        'color': 'black',
        radius: "5%"
    },
    _schema: {
       "type":"object",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "style":{
             "type":"string",
             "enum": ["none","solid","dotted","dashed","double","groove","ridge","inset","outset"],
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          },
          "radius":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }
});



var PageDecorator = Thing.extend({
    init: function() {
        this.base();
        this.pageContent = $("<div>").addClass("page-content").appendTo(this.element);
        this.pageInfo = $("<div>").addClass('page-info').appendTo(this.element);
        this.setSlot('content', Thing.empty());
    },
    // options changed...
    refresh: function() {
        // TODO text mask?
        this.base();
        if(this.options.showInfo) this.pageInfo.show(); else this.pageInfo.hide();
        this.pageInfo.text("Page "+this.options.pageNumber);
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.pageContent.html(value.get());
        return this;
    },
    _klass: "page-decorator thing",
    _type: "page-decorator",
    _defaults: {
        'showInfo' : false,
        'pageNumber': 2,
        'pagesTotal' : 3,
        'recordsTotal' : 10
    },
    _schema: {
       "type":"object",
       "properties":{
          "showInfo":{
             "type":"boolean",
             "required":true
          },
          "pageNumber":{
             "type":"integer",
             "required":true
          },
          "pagesTotal":{
             "type":"integer",
             "required":true
          },
          "recordsTotal":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var CenteringDecorator = Thing.extend({
    init: function() {
        this.inner = $("<div>").addClass('content-inner').appendTo(
            $("<div>").addClass('center3').appendTo(
                $("<div>").addClass('center2').appendTo(
                    this.element
                )
            )
        );
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.inner.html(value.get());
        return this;
    },
    // options changed...
    refresh: function() {
        this.base();
        this.element.css('text-align',this.options['x-align']);
        this.element.children(".center2").css('vertical-align',this.options['y-align']);
        this.inner.css('width',this.options['content-width']);
        this.inner.css('height',this.options['content-height']);
    },
    _klass: "centering-decorator decorator thing",
    _type: "centering-decorator",
    _defaults: {
        'x-align': "center",
        'y-align': 'center',
        'content-width': '',
        'content-height': ''
    },
    _schema: {
       "type":"object",
       "properties":{
          "x-align":{
             "enum": ["left","center","right"],
             "type":"string",
             "required":true // TODO
          },
          "y-align":{
             "enum": ["top","middle","bottom"],
             "type":"string",
             "required":true // TODO
          },
          "content-width":{
             "type":"string",
             "required":true // TODO
          },
          "content-height":{
             "type":"string",
             "required":true // TODO
          }
       },
       "additionalProperties":true
    }
});



var RefDecorator = Thing.extend({
    init: function() {
        this._content = $("<div>").addClass("mykkro-ref-decorator-content")
        this._control = $("<a>").addClass('ref-link mykkro-ref-decorator-control')
        this._tooltip = $("<div>").addClass("hidden ref-tooltip")
        this.element.append(
            this._content,
            this._tooltip,
            this._control
        )
        this._control.qtip({content: { text: this._tooltip } })
        this.setSlot('content', Thing.empty())
    },
    refresh: function() {
        this.base()
        var label = this.options.label || "?"
        var src = this.options.source
        this._tooltip.empty().append($("<p>").text(__("Originally from:")))
        // TODO tohle nejak blbne...
        //if(Common.isValidUrl(src)) {
        if(src.startsWith("http")) {
            this._tooltip.append(
                $("<p>").append($("<a>").attr("href", src).text(src))
            )
            this._control.text(label).attr("href", src)
        } else {
            this._tooltip.append(
                $("<p>").text(src)
            )
            this._control.text(label).attr("href", "#").click(function() { return false;})
        }
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this._content.html(value.get());
        return this;
    },
    showToolbar: function() {
        this.options.hidden = false;
        this.refresh();
    },
    hideToolbar: function() {
        this.options.hidden = true;
        this.refresh();
    },
    /*
    serialize: function() {
        return this.getSlot('content').serialize();
    },
    */
    // pouziva se toto nekde?
    getTree: function() {
        // skip the outer layer...
        return this.getSlot('content').getTree();
    },
    /* ref decorator won't be editable */
    getTreeView: function(decorator) {
        // skip the outer layer...
        return this.getSlot('content').getTreeView(decorator);
    },
    _klass: "ref-decorator thing",
    _type: "ref-decorator",
    _defaults: {
        label: null,
        source: "http://www.google.com"
    },
    _schema: {
       "type":"object",
       "properties":{
          "label":{
             "type":"string",
             "required":false
          },
          "source":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }

});


var RefList = Thing.extend({
    init: function() {
      this.element.empty()
      this.element.append($("<p>").text(__("References")))
    },
    refresh: function() {
        this.base();
    },
    // refs = array of ref decorator objects
    setReferences: function(refs) {
      this.element.empty()
      this.element.append($("<p>").text(__("References")))
      var list = $("<ul>").appendTo(this.element)
      if(refs) {
        for(var i=0; i<refs.length; i++) {
          list.append(this.makeReference(refs[i], i))
        }
      } else {
        this.element.append($("<p>").text(__("No references found.")))
      }
    },
    makeReference: function(ref, index) {
      return $("<li>").append(
        $("<span>").addClass("ref-link").text(index+1),
        $("<span>").addClass("ref-label").text(ref.options.source)
      )
    },
    _klass: "ref-list thing",
    _type: "ref-list",
    _defaults: {
    },
    _schema: {
       "type":"object",
       "description":"References List properties",
       "properties":{
       },
       "additionalProperties":true
    }

});


var Ajax = Decorator.extend({
    init: function() {
        this.loaded($.noop);
        this.received(function(data) { return data; });
        this.transform(function(data) { return Thing.create(data); })
        this.base();
        this.reload();
    },
    reload: function() {
        var url = this.options.url;
        var self = this;
        if(url) {
            $.ajax({
              url: url,
              dataType: 'json',
              //data: data,
              success: function(data) {
                var thing = self.transform(self.received(data));
                self.setSlot('content', thing);
                self.loaded(thing);
              },
              error: function(jqXHR, textStatus, errorThrown) {
                // TODO dat tam misto toho chyb. panel
                alert("AJAX failed! "+textStatus);
              }
            });
        }
        if(this.options.reloadInterval) {
            var fun = function() { self.reload(); };
            setTimeout(fun, 1000*this.options.reloadInterval);
        }
    },
    loaded: function(arg) {
        if(typeof arg == 'function') {
            this.onloaded = arg;
        } else {
            return this.onloaded(arg);
        }
    },
    received: function(arg) {
        if(typeof arg == 'function') {
            this.onreceive = arg;
        } else {
            return this.onreceive(arg);
        }
    },
    transform: function(arg) {
        if(typeof arg == 'function') {
            this.ontransform = arg;
        } else {
            return this.ontransform(arg);
        }
    },
    _klass: "ajax thing",
    _type: "ajax",
    _defaults: {
        url: '', //"testing/thing.json",
        reloadInterval: 0 //60 // in seconds
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "reloadInterval": {
			    "type":"integer",
			    "required":true
		    },
		    "url": {
			    "type":"string",
			    "id": "url",
                "format": "uri",
			    "required":true
		    }
	    }
    }
});




var AjaxPager = Thing.extend({
    init: function() {
        var self = this;
        this.base();
        this.page = new Ajax();
        this.page.received(function(data) { return self._dataReceived(data);});
        this.page.transform(function(data) { return self._dataTransform(data);});
        this.page.loaded(function(ajax) {self._pageLoaded(ajax);});
        this.page.get().appendTo(this.element);
        this.createControls();
        this.setPage(this.options.page);
    },
    createControls: function() {
        this.pagerControls = $("<div>").addClass('pager-controls');
        if(!this.options.disablePagerControl) this.pagerControls.appendTo(this.element);
    },
    refreshView: function() {
        this.setPage(this.options.page);
    },
    setPage: function(num) {
        this.options.page = num;
        var url = null;
        if(this.options.page && this.options.baseUrl) {
            url = this.getPageUrl(this.options.page);
            this.page.options.url = url;
            this.page.reload();
        } else {
            // signal error
        }
    },
    getPageUrl: function(page) {
        return this.options.baseUrl + page + ".json";
    },
    // muzeme podedit pokud potrebujeme jine chovani, transformaci dat aj.
    _dataReceived: function(data) {
        return data;
    },
    _dataTransform: function(data) {
        return Thing.create(data);
    },
    _pageLoaded: function(ajax) {
        this.pagerControls.empty();
        if(ajax instanceof PageDecorator) {
            // rebuild page controls
            this._buildPageControls(ajax);
        }
    },
    _buildPageControls: function(paged) {
        // TODO udelat PagerControls jako Thing
        // stranky jsou cislovany od jedne, nejmensi cislo je 1
        var o = paged.options;
        if(o.pageNumber>1) {
            // add first link
            this.pagerControls.append(this._makePageLink(1, "first"));
        }
        if(o.pageNumber>1) {
            // add previous link
            this.pagerControls.append(this._makePageLink(o.pageNumber-1, "previous"));
        }
        this.pagerControls
            .append($("<span>").text(__("Page")+" "+o.pageNumber+" "+__("from")+" "+o.pagesTotal));        
        if(o.pageNumber<o.pagesTotal) {
            // add previous link
            this.pagerControls.append(this._makePageLink(o.pageNumber+1, "next"));
        }
        if(o.pageNumber<o.pagesTotal) {
            // add first link
            this.pagerControls.append(this._makePageLink(o.pagesTotal, "last"));
        }
    },
    _makePageLink: function(pageno, type) {
        var self = this;
        return $('<a href="#">').text(type).click(function() {
            self.setPage(pageno);
            return false;
        });
    },
    _klass: "ajax-pager thing",
    _type: "ajax-pager",
    _defaults: {
        baseUrl: '',// 'testing/multi/',
        page: 1,
        disablePagerControl: false
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "page": {
			    "type":"integer",
			    "required":true
		    },
		    "url": {
			    "type":"string",
			    "id": "url",
                "format": "uri",
			    "required":true
		    }
	    }
    }
});


var Layout = Thing.extend({
    _klass: "layout thing",
    _type: "layout"
});









var Slot = Base.extend({
    constructor: function(parent, name) {
        this.name = name;
        this.parent = parent;
        this.element = $("<div>").addClass("mykkro-slot").attr('data-name', name);
        this.thing = null;
    },
    empty: function() {
        this.element.empty();
        this.thing = null;
    },
    set: function(thing) {
        this.element.empty().append(thing.get());
        this.thing = thing;
    },
    get: function() {
        return this.thing;
    }
});


// TODO metody na prohazovani elementu - move to front/back, move up, move down
// TODO metody insert/delete?
// TODO -> DynamicLayout
var GrowableLayout = Layout.extend({
    init: function() {
        this.cells = []; // v tomto poradi budou v this.element!
        this.cellMap = {}; 
    },
    // remove all slots
    // TODO obsolete, use removeSlots instead
    clear: function() {
        this.element.empty();
        this.cells = [];
        this.cellMap = {};
    },
    length: function() {
        return this.cells.length;
    },
    first: function() {
        return this.cells.length ? this.cells[0] : undefined;
    },
    last: function() {
        return this.cells.length ? this.cells[this.cells.length-1] : undefined;
    },
    nth: function(ndx) {
        return (ndx>=0 && ndx<this.cells.length) ? this.cells[ndx] : undefined;
    },
    isEmpty: function() {
        return this.cells.length;
    },
    // dynamically add slot
    add: function(thing) {        
        var ndx = this.cells.length;
        var slot = new Slot(this, ndx);
        slot.element.appendTo(this.element);
        this.cells.push(slot);
        this.cellMap[ndx] = slot;
        this.setSlot(ndx, thing);
        return slot;
    },
    setSlot: function(key, value) {
        // TODO implement hasSlot
        this.base(key, value);
        this.cellMap[key].set(value);
        return this;
    },
    removeSlots: function() {
        // remove slot content...
        this.clearSlots(); 
        // remove slots proper...
        this.element.empty();
        this.slots = {};
        this.cells = [];
        this.cellMap = {};
    },
    setSlots: function(slots) {
        // remove existing slots...
        this.removeSlots();
        if(slots) {
            // pokud je parametr pole, udelat z nej objekt
            if($.isArray(slots)) slots = slots.toObject();
            for(var key in slots) {
                this.add(slots[key]);
            }
        }
    },
    _klass: "growable-layout layout thing",
    _type: "growable-layout",
    _defaults: {
        "css": "" //"mykkro-flow-layout"
    },
    _schema: {
       "type":"object",
       "properties":{
          "css":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }
});



// TODO metody na prohazovani elementu - move to front/back, move up, move down
// TODO metody insert/delete?
// TODO -> DynamicLayout
// TODO ze by se to poradi slotu dalo ulozit?
var OrderableLayout = GrowableLayout.extend({
    init: function() {
        this.cells = []; // v tomto poradi budou v this.element!
        this.cellMap = {}; 
    },
    // what muze byt Slot nebo Thing
    getSlotIndex: function(what) {
        if(what && typeof what === 'object') {
            for(var i=0; i<this.cells.length; i++) {
                if(this.cells[i] == what || this.cells[i].get() == what) return i;
            }
            return -1;
        } else {
            if(what>=0 && what < this.cells.length) return what;
            return -1;
        }
    },
    moveSlotUp: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>0) {
            // swap slots 'i-1' and 'i'
            this.swapSlots(slot-1, slot);
        }
    },
    moveSlotDown: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>=0 && slot<this.cells.length-1) {
            // swap slots 'i' and 'i+1'
            this.swapSlots(slot, slot+1);
        }
    },
    moveSlotToTop: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>0) {
            this.swapSlots(0, slot);
        }
    },
    moveSlotToBottom: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>=0 && slot<this.cells.length-1) {
            this.swapSlots(slot, this.cells.length-1);
        }
    },
    swapSlots: function(slot1, slot2) {
        slot1 = this.getSlotIndex(slot1);
        slot2 = this.getSlotIndex(slot2);
        if(slot1 != slot2) {
            // prohodit to v DOM...
            this.cells[slot1].element.swap(this.cells[slot2].element);
            var tmp = this.cells[slot1];
            this.cells[slot1] = this.cells[slot2];
            this.cells[slot2] = tmp;
        }
    },
    shuffle: function() {
        var len = this.cells.length;
        for (var i = len-1; i >=0; i--) {
            var randomIndex = Math.floor(Math.random()*(i+1)); 
            this.swapSlots(randomIndex, i);
        }
    },
    remove: function(what) {        
        var ndx = this.getSlotIndex(what);
        if(ndx>=0) {
            var slot = this.cells[ndx];
            this.cellMap[slot.name] = null;
            // remove from array
            this.cells.remove(ndx);
            // remove from DOM
            slot.element.remove();
            this.refresh();
        }
    },
    _klass: "orderable-layout growable-layout layout thing",
    _type: "orderable-layout",
    _defaults: {
        "css": "" //"mykkro-flow-layout"
    },
    _schema: {
       "type":"object",
       "properties":{
          "css":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }
});



var PreviewPager = AjaxPager.extend({
    constructor: function(options, callback) {
        this.base(options); // baseUrl, query, includePublic, allTags, disableSearchBox
        this.onselected = callback || $.noop;
    },
    createControls: function() {
        this.base();
        var self = this
        var changer = function() {
            self.refreshView()
        }
        this.searchBox = $('<input type="text" name="sf-text" class="search rounded" placeholder="Search...">').attr("value", this.options.query).on("change keyup paste", changer)
        this.publicCBox = $('<input type="checkbox" name="sf-public">').prop('checked', this.options.includePublic).change(changer)
        this.allCBox = $('<input type="checkbox" name="sf-all">').prop("checked", this.options.allTags).change(changer)
        if(!this.options.disableSearchBox) {
            var sc = $("<div>")
                .addClass('search-controls')
                .appendTo(this.element)
                .append(
                    $('<label>').append(this.searchBox), 
                    $('<label>').append(this.publicCBox, $('<span>Include public content</span>')),
                    $('<label>').append(this.allCBox, $('<span>Use all tags</span>'))
                );
        }
    },
    getPageUrl: function(page) {
        var text = encodeURIComponent(this.searchBox.val())
        var publ = this.publicCBox.is(':checked') ? 'true' : 'false'
        var all = this.allCBox.is(':checked') ? 'true' : 'false'
        return this.base(page) + "?public="+publ+"&text="+text+"&all="+all
    },
    _dataReceived: function(data) {
        return data;
    },
    _dataTransform: function(data) {
        var self = this;
        var ol = new OrderableLayout({"css":"mykkro-flow-layout"});
        for(var i=0; i<data.items.length; i++) {
            var thing = Thing.create(data.items[i].preview);
            var clickable = new Clickable({tooltip: data.items[i].title});
            clickable.setSlot('content', thing);
            (function() {
                var url = data.items[i].url;
                clickable.click(function() {
                    self._selected(url);
                });
/*
                // TODO settings - otevre formular
                // Thing ma definovane schema pro validaci options
                var st = makeSettingsToolbar(function(){
                    // change thing's settings
                    self._selected(url, true);
                });
                st.setSlot('content', clickable);
                ol.add(st);
*/
                ol.add(clickable);
            })();
        }
        var pd = new PageDecorator({
            'pageNumber': data.page,
            'pagesTotal' : data.pagesTotal,
            'recordsTotal' : data.itemsTotal            
        });
        pd.setSlot('content', ol);
        return pd;
    },
    _selected: function(url, editSettings) {
        var self = this;
         $.ajax({
              url: url,
              dataType: 'json',
              //data: data,
              success: function(data) {
                   console.log("Selected:")
                   console.log(data)
                  if(editSettings) {
                     // ziskat schema, zobrazit formular, nastavit data.options                    
                  }
                  var thing = Thing.create(data);
                  self.onselected(thing);
              }
          });
    },
    _type: "preview-pager"
}, {
    choose: function(type, callback, options) {
        options = options || {}
	    var mm = {};
        var url = baseUrl+'api/pagedpreviews/'+type+'/';
        var ap = new PreviewPager($.extend({baseUrl:url}, options), function(thing) { 
            mm.modal.close();
            if(callback) callback(thing);
        });
        /**/options.resizable = false/**/
        mm.modal = Modal.show(ap, options);
    }
});


// TODO vertical split
var SplitLayout = Layout.extend({
    init: function() {
        this.first = $("<div>");
        this.second = $("<div>");
        this.element.append(this.first).append(this.second);
        this.setSlot('first', Thing.empty());
        this.setSlot('second', Thing.empty());
    },
    // options changed...
    refresh: function() {
        this.base();
        var first = this.options.ratio + "%";
        var gap = this.options.gap + "%";
        var xx = (this.options.ratio + this.options.gap) + "%";
        var second = (100 - this.options.ratio - this.options.gap) + "%";
        if(this.options.horizontal) {
            this.first.css("left","0px").css("top","0px").css("width",first).css('height','100%');
            this.second.css("left",xx).css("top","0px").css("width",second).css('height','100%');
        } else {
            this.first.css("left","0px").css("top","0px").css("height",first).css('width','100%');
            this.second.css("left","0px").css("top",xx).css("height",second).css('width','100%');
        }
    },
    setSlot: function(key, value) {
        // TODO implement hasSlot
        this.base(key, value);
        if(key=='first') {
            this.first.empty().append(value.get());
        }
        if(key=='second') {
            this.second.empty().append(value.get());
        }
        return this;
    },
    _klass: "split-layout layout thing",
    _type: "split-layout",
    _defaults: {
        ratio: 70, // v %
        gap: 2, // v %
        horizontal: false
    },
    _schema: {
       "type":"object",
       "properties":{
          "horizontal":{
             "type":"boolean",
             "required":true
          },
          "ratio":{
             "type":"integer",
             "required":true
          },
          "gap":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});



var GridLayout = Layout.extend({
    init: function() {
        // TODO create grid and slots
        this.cellCount = 0;
        this.cells = {};
        for(var i=0; i<this.options.rows; i++) {
            for(var j=0; j<this.options.columns; j++) {
                // create slot
                this.cells[this.cellCount] = $("<div>").appendTo(this.element);                
                // set slot value
                this.setSlot(this.cellCount, Thing.empty());
                this.cellCount++;
            }
        }
    },
    // options changed...
    refresh: function() {
        this.base();
        var gap = this.options.gap;
        var cols = this.options.columns;
        var rows = this.options.rows;
        if(cols*rows != this.cellCount) {
          // resize grid...
          if(cols*rows < this.cellCount) {
            // truncate array...
            while(this.cellCount > rows*cols) {
                this.cellCount--;
                this.removeSlot(this.cellCount)
            }
          } else {
            // expand array by adding new elements
            while(this.cellCount<rows*cols) {
                // create slot
                this.cells[this.cellCount] = $("<div>").appendTo(this.element);                
                // set slot value
                this.setSlot(this.cellCount, Thing.empty());
                this.cellCount++;
            }
          }          
        }
        var ww = Math.round(10*(100 - (cols-1)*gap)/cols)/10;
        var hh = Math.round(10*(100 - (rows-1)*gap)/rows)/10;
        var xx = 0;
        var yy = 0;
        var ndx = 0;
        for(var i=0; i<rows; i++) {
            for(var j=0; j<cols; j++) {
                this.cells[ndx].css({
                    "width": ww+"%",
                    "height": hh+"%",
                    "left": xx+"%",
                    "top": yy+"%"
                });
                ndx++;
                xx += ww + gap;
            }
            xx = 0;
            yy += hh + gap;
        }
    },
    setSlot: function(key, value) {
        if(!!this.cells[key]) {
          this.base(key, value);
          this.cells[key].empty().append(value.get());
        }
        return this;
    },
    removeSlot: function(key) {
        if(this.hasSlot(key)) {
          this.cells[key].remove()
          delete this.cells[key]                
          this.base(key);
        }
    },
    _klass: "grid-layout layout thing",
    _type: "grid-layout",
    _defaults: {
        rows: 3, // nemelo by se menit za behu
        columns: 3, // nemelo by se menit za behu
        gap: 2 // v procentech
    },
    _schema: {
       "type":"object",
       "properties":{
          "rows":{
             "type":"integer",
             "required":true
          },
          "columns":{
             "type":"integer",
             "required":true
          },
          "gap":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});



var SwitchLayout = GrowableLayout.extend({
    refresh: function() {
        this.base();
        var index = parseInt(this.options.index)+1;
        this.element.children().hide();
        this.element.find("div:nth-child("+index+")").show();
    },
    setIndex: function(ndx) {
        this.options.index = ndx;
        this.refresh();
    },
    add: function(thing) {
        var slot = this.base(thing);
        this.refresh();
        return slot;
    },
    _klass: "switch-layout growable-layout layout thing",
    _type: "switch-layout",
    _defaults: {
        "css": "", //"mykkro-flow-layout"
        index: 0
    },
    _schema: {
       "type":"object",
       "properties":{
          "css":{
             "type":"string",
             "required":false
          },
          "index":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var Book = GrowableLayout.extend({
    currentPage: 0,
    init: function() {
        this.base();
        console.log("Book created")
        console.log(this)
    },
    refresh: function() {
        this.base();
    },
    // TODO tohle se muze zavolat jen pokud jsou stranky uz vlozena do DOMu
    makeDisplay: function() {
        var self = this;
	    // kniha = <div class="mykkro-book> <div class="mykkro-slot"> .. </div>
	    this.element.addClass(this.options.display);
	    switch(this.options.display) {
	      case 'basic':
	        // add page numbers...
	        break;
	      case "turnable":
	        this.element.turn({gradients: true, acceleration: true});
            this.element.bind("start", function(ev, pageObject, corner) { 
                self.onTurnStart(ev, pageObject, corner); })
            this.element.bind("turning", function(ev, page, pageObject) { 
                self.onTurning(ev, page, pageObject); })
            this.element.bind("turned", function(ev, page, view) { 
                self.onTurned(ev, page, view); })
            this.element.bind("end", function(ev, pageObject, turned) { 
                self.onTurnEnd(ev, pageObject, turned); })
	        break;
	    }
    },
    _setPage: function(page) {
        if(!this.currentPage) {
            // page 1 became visible
            this.onPageVisibilityChange(page, true);
        }
        else if(this.currentPage>>1 == page>>1) {
            // je videt porad stejna dvoustrana
        } else {            
            // visibility changed
            var oldPages = 2*(Math.floor(this.currentPage / 2));
            var newPages = 2*(Math.floor(page / 2));
            this.onPageVisibilityChange(oldPages, false);
            this.onPageVisibilityChange(oldPages+1, false);
            this.onPageVisibilityChange(newPages, true);
            this.onPageVisibilityChange(newPages+1, true);
        }
        this.currentPage = page;
        // notifikovat stranky pokud se jejich viditelnost zmenila
        this.onPageChange(page);
    },
    // TODO udelat si na to taky bind funkci
    onPageVisibilityChange: function(page, visible) {
        if(typeof(page)=='function') this._onPageVisibilityChange = page;  
        else {
            // mame takovou stranku?
            var name = page-1;
            if(this.slots[name]) {
                this._updatePageVisibility(page, visible);
                if(this._onPageVisibilityChange) this._onPageVisibilityChange(page, visible);
            }
        }
    },
    _updatePageVisibility: function(page, visible) {
        // pri zviditelneni musim refereshnout vsechny audio-decoratory a video-thingy
        // pri zneviditelneni vypnout jejich playback
        //log("Page: "+page+" visibility: "+visible);
        var name = page-1;
        var thing = this.slots[name];
        var media = [];
        thing.findSlotsByType('audio-decorator', media);
        thing.findSlotsByType('video-thing', media)
        //log(audio.length+","+video.length);
        if(visible) {
            // page became visible...
            for(var i=0; i<media.length; i++) {
                media[i].refresh();
                if(media[i].options['autoplay']) {
                    media[i].play();
                }
            }
        } else {
            // TODO stop only if playing...
            for(var i=0; i<media.length; i++) media[i]._kill();
        }
    },
    onPageChange: function(ev) {
        if(typeof(ev)=='function') this._onPageChange = ev;  
        else {
            if(this._onPageChange) this._onPageChange(ev);
        }
    },
    onInit: function(ev) {
        if(typeof(ev)=='function') this._onInit = ev;  
        else {
            this._setPage(1);
            if(this._onInit) this._onInit();
        }
    },
    onExit: function(ev) {
        if(typeof(ev)=='function') this._onExit = ev;  
        else {
            if(this._onExit) this._onExit();
        }
    },
    onTurnStart: function(ev, pageObject, corner) {
        if(typeof(ev)=='function') this._onTurnStart = ev;  
        else {
            if(this._onTurnStart) this._onTurnStart(ev, pageObject, corner);
        }
    }, 
    onTurning: function(ev, page, pageObject) {
        if(typeof(ev)=='function') this._onTurning = ev;  
        else {
            if(this._onTurning) this._onTurning(ev, page, pageObject);
        }
    }, 
    onTurned: function(ev, page, view) { 
        if(typeof(ev)=='function') this._onTurned = ev;  
        else {
            this._setPage(page);
            if(this._onTurned) this._onTurned(ev, page, view);
        }
    }, 
    onTurnEnd: function(ev, pageObject, turned) { // nefunguje
        if(typeof(ev)=='function') this._onTurnEnd = ev;  
        else {
            if(this._onTurnEnd) this._onTurnEnd(ev, pageObject, corner);
        }
    }, 
    _klass: "book growable-layout layout thing",
    _type: "book",
    _defaults: {
        "title": "My Book",
	    "display": "basic"
    },
    _schema: {
       "type":"object",
       "properties":{
          "title":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var Quest = Thing.extend({
    init: function() {
        this.status = 'active';
        this.finished($.noop);
    },
    refresh: function() {
        this.base();
        //this.inner.html(this.options.html).attr('class',this.options.innerCss);
    },
    finished: function(arg) {
        if(typeof arg == 'function') {
            this.onfinished = arg;
        } else {
            return this.onfinished(arg);
        }
    },
    pass: function() {
        this.status = 'passed';
        this.finished({'quest':this, 'status':this.status});
    },
    fail: function() {
        this.status = 'failed';
        this.finished({'quest':this, 'status':this.status});
    },
    _klass: "quest thing",
    _type: "quest",
    _defaults: {
        //html: ""
    },
    _schema: {
       "type":"object",
       "description":"Quest properties",
       "properties":{
/*
          "html":{
             "type":"string",
             "required":true
          },
          "css":{
             "type":"string",
             "required":false
          },
          "innerCss":{
             "type":"string",
             "required":false
          }
*/
       },
       "additionalProperties":true
    }

});

var DemoQuest = Quest.extend({
    init: function() {
        this.base();
        var self = this;
        this.passButton = $("<button>").text("Pass").click(function() { self.pass(); }).appendTo(this.element);
        this.failButton = $("<button>").text("Fail").click(function() { self.fail(); }).appendTo(this.element);
        this.statusBar = $("<span>").appendTo(this.element);
        this.statusBar.text('active');
    },
    pass: function() {
        this.statusBar.text('passed');
        this.passButton.prop('disabled', true);
        this.failButton.prop('disabled', true);
        this.base();
    },
    fail: function() {
        this.statusBar.text('failed');
        this.passButton.prop('disabled', true);
        this.failButton.prop('disabled', true);
        this.base();
    },
    _klass: "demo-quest quest thing",
    _type: "demo-quest",
    _defaults: {
        //html: ""
    },
    _schema: {
       "type":"object",
       "description":"Demo Quest properties",
       "properties":{
/*
          "html":{
             "type":"string",
             "required":true
          },
          "css":{
             "type":"string",
             "required":false
          },
          "innerCss":{
             "type":"string",
             "required":false
          }
*/
       },
       "additionalProperties":true
    }

});

var PlayerControls = Thing.extend({
    _onplay: $.noop,
    _onpause: $.noop,
    _onstop: $.noop,
    init: function() {
        var self = this;
        var cont = $("<div>").addClass('controls').appendTo(this.element);
        this._playBtn = $("<button>")
            .addClass("play").append($("<span>").text("Play"))
            .appendTo(cont).click(function() { self.onPlay(); });
        this._pauseBtn = $("<button>")
            .addClass("pause").append($("<span>").text("Pause"))
            .appendTo(cont).click(function() { self.onPause(); });
        this._stopBtn = $("<button>")
            .addClass("stop").append($("<span>").text("Stop"))
            .appendTo(cont).click(function() { self.onStop(); });
        this.controls = cont;
        this.playing = false;
        this.paused = false;
    },
    refresh: function() {
        this.base();
        this.controls.toggleClass('playing', this.playing);
        this._playBtn.prop('disabled', this.playing);
        this._pauseBtn.prop('disabled', !this.playing);
        this._stopBtn.prop('disabled', !(this.playing/* || this.paused*/));    
        if(this.playing) {
            this._playBtn.hide();
            this._pauseBtn.show();
        } else {
            this._playBtn.show();
            this._pauseBtn.hide();
        }        
        if(this.playing/* || this.paused*/) {
            this._stopBtn.show();
        } else {
            this._stopBtn.hide();
        }
    },
    updateGui: function(playing, paused) {
        this.playing = playing;
        this.paused = paused;
        this.refresh();
    },
    onPlay: function(kb) {
        if(typeof kb == 'function') {
            this._onplay = kb;
        } else {
            this.updateGui(true, false);
            this._onplay(kb);
        }
    },
    onPause: function(kb) {
        if(typeof kb == 'function') {
            this._onpause = kb;
        } else {
            this.updateGui(false, true);
            this._onpause(kb);
        }
    },
    onStop: function(kb) {
        if(typeof kb == 'function') {
            this._onstop = kb;
        } else {
            this.updateGui(false, false);
            this._onstop(kb);
        }
    },
    _klass: "player-controls thing",
    _type: "player-controls",
    _defaults: {
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
	    }
    }
});


var AudioDecorator = Thing.extend({
    _onplay: $.noop,
    _onpause: $.noop,
    _onstop: $.noop,
    _onkill: $.noop,
    onPlay: function(kb) {
        if(typeof kb == 'function') {
            this._onplay = kb;
        } else {
            this._onplay(kb);
        }
    },
    onPause: function(kb) {
        if(typeof kb == 'function') {
            this._onpause = kb;
        } else {
            this._onpause(kb);
        }
    },
    onStop: function(kb) {
        if(typeof kb == 'function') {
            this._onstop = kb;
        } else {
            this._onstop(kb);
        }
    },
    onKill: function(kb) {
        if(typeof kb == 'function') {
            this._onkill = kb;
        } else {
            this._onkill(kb);
        }
    },
    init: function() {
        this.slot = $("<div>").addClass("slot");
        this.setSlot('content', Thing.empty());
    },
    play: function() {
        this._play();
        this.player.updateGui(true, false);
    },
    _play: function() {
        this.audio.get(0).play();
        this.onPlay();
    },
    _pause: function() {
        this.audio.get(0).pause();
        this.onPause();
    },
    _stop: function() {
        // regenerate player...
        this.refresh();
        this.onStop();
    },
    _kill: function() {
        this.audio.get(0).pause();
        this.audio.get(0).src = "";
        this.onKill();
    },
    _setVolume: function(vol) {
        // HTML5 volume is between 0 and 1
        this.audio.get(0).volume = vol / 100.0;
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.slot.html(value.get());
        return this;
    },
    _addSource: function(uri, type) {
        if(uri) $("<source>").attr({src:uri, type: type, preload: false/**/}).appendTo(this.audio);
    },
    refresh: function() {
        this.base();
        var self = this;
        this.audio = $("<audio>");
        this.player = new PlayerControls();  
        this.player.onPlay(function() { self._play(); });
        this.player.onPause(function() { self._pause(); });
        this.player.onStop(function() { self._stop(); });
        var cc = new CenteringDecorator({},{content: this.player});
        this.pane = cc.get();
        this.pane.addClass("player");
        this.element.empty()
            .append(this.slot)
            .append(this.pane)
            .append(this.audio);

        // incorrect... and unnecessary: this.audio.remove("source");
        this.audio.prop('loop', this.options.loop);
        if(this.options.uri) {            
            var ext = this.options.uri.split('.').pop();
            this.options.ogg = (ext == 'ogg') ? this.options.uri : '';
            this.options.mp3 = (ext == 'mp3') ? this.options.uri : '';
        }
        this._addSource(this.options.ogg, 'audio/ogg; codecs="vorbis"');
        this._addSource(this.options.mp3, 'audio/mpeg; codecs="mp3"');
        // HTML5 volume is between 0 and 1
        this._setVolume(this.options.volume);
    },
    _klass: "audio-decorator decorator thing",
    _type: "audio-decorator",
    _defaults: {
        'ogg': "",
        'mp3': "",
        'uri': "",
        'autoplay': false,
        'loop': false,
        'volume': 50
    },
    _schema: {
       "type":"object",
       "properties":{
          "uri":{
             "type":"string",
             "format": "my-voice-uri",
            // TODO vadi mu kdyz je to false - option se neda rozkliknout
             "required":true
          },
          "volume":{
             "type":"integer",
             "required":true // TODO
          },
          "autoplay":{
             "type":"boolean",
             "required":true // TODO
          },
          "loop":{
             "type":"boolean",
             "required":true // TODO
          }
       },
       "additionalProperties":true
    }
});



var VideoThing = Thing.extend({
    _onplay: $.noop,
    _onpause: $.noop,
    _onstop: $.noop,
    _onkill: $.noop,
    onPlay: function(kb) {
        if(typeof kb == 'function') {
            this._onplay = kb;
        } else {
            this._onplay(kb);
        }
    },
    onPause: function(kb) {
        if(typeof kb == 'function') {
            this._onpause = kb;
        } else {
            this._onpause(kb);
        }
    },
    onStop: function(kb) {
        if(typeof kb == 'function') {
            this._onstop = kb;
        } else {
            this._onstop(kb);
        }
    },
    onKill: function(kb) {
        if(typeof kb == 'function') {
            this._onkill = kb;
        } else {
            this._onkill(kb);
        }
    },
    init: function() {
    },
    play: function() {
        this._play();
        this.player.updateGui(true, false);
    },
    _play: function() {
        this.video.get(0).play();
        this.onPlay();
    },
    _pause: function() {
        this.video.get(0).pause();
        this.onPause();
    },
    _stop: function() {
        //this.video.get(0).pause();
        //this.video.get(0).currentTime = 0;
        // regenerate player...
        this.refresh();  // TODO udelat to lepe
        this.onStop();
    },
    _kill: function() {
        this.video.get(0).pause();
        this.video.get(0).src = "";
        this.onKill();
    },
    _setVolume: function(vol) {
        // HTML5 volume is between 0 and 1
        this.video.get(0).volume = vol / 100.0;
    },
    _addSource: function(uri, type) {
        if(uri) {
            $("<source>").attr({src:uri, type: type, preload: false/**/}).appendTo(this.video);
        }
    },
    refresh: function() {
        this.base();
        var self = this;
        this.video = $("<video>");
        this.player = new PlayerControls();  
        this.player.onPlay(function() { self._play(); });
        this.player.onPause(function() { self._pause(); });
        this.player.onStop(function() { self._stop(); });
        var cc = new CenteringDecorator({},{content: this.player});
        this.pane = cc.get();
        this.pane.addClass("player");
        this.element.empty()
            .append(this.video)
            .append(this.pane);

        this.video.prop('loop', this.options.loop);
        if(this.options.uri) {            
            var ext = this.options.uri.split('.').pop();
            this.options.ogg = (ext == 'ogg' || ext == 'ogv') ? this.options.uri : '';
            this.options.mp4 = (ext == 'mp4') ? this.options.uri : '';
            this.options.webm = (ext == 'webm') ? this.options.uri : '';
        }
        this._addSource(this.options.ogg, 'video/ogg; codecs="theora, vorbis"');
        this._addSource(this.options.mp4, 'video/mp4; codecs="avc1.42E01E, mp4a.40.2"');
        this._addSource(this.options.webm, 'video/webm; codecs="vp8, vorbis"');
        ////this.video.get(0).src = this.options.uri;
        // TODO tohle nejak zlobi v Chrome, pri znovuvytvareni videi... ale ve FF to zda se funguje

        // HTML5 volume is between 0 and 1
        this._setVolume(this.options.volume);
        this.video.on('canplay canplaythrough', function(){
            console.log('canplay event fired');
        });
    },
    _klass: "video-thing thing",
    _type: "video-thing",
    _defaults: {
        "uri": "",
        'ogg': "",
        'mp4': "",
        'webm': "",
        'autoplay': false,
        'loop': false,
        'volume': 50
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "uri": {
			    "type":"string",
                "format": "my-video-uri",
			    "required":true
    	    },
            "volume":{
                "type":"integer",
                "required":true // TODO
            },
            "autoplay":{
                "type":"boolean",
                "required":true // TODO
            },
            "loop":{
                "type":"boolean",
                "required":true // TODO
            }
	    }
    }

});


/*

document.addEventListener('DOMContentLoaded', function(){
    var v = document.getElementById('vid');
    var canvas = document.getElementById('canvas');
    var context = canvas.getContext('2d');

    var cw = canvas.clientWidth;
    var ch = canvas.clientHeight;
    canvas.width = cw;
    canvas.height = ch;

    v.addEventListener('play', function(){
        draw(this,context);
    },false);

},false);

var mode = 'stretch';
function draw(v,c) {
    var canvas = document.getElementById('canvas');
    var w = canvas.clientWidth;
    var h = canvas.clientHeight;
    if(v.paused || v.ended) return false;
    if(mode == 'stretch') {
        c.drawImage(v,0,0,w,h); //-> stretch
    } else if(mode == 'cover') {
        // TODO tady je neco spatne
        var sx=0, sy=0, sw=v.width, sh=v.height;
        if(sw/sh < w/h) {
            sy = (sh - h*sw/w)/2;
            sh = h*sw/w;
        } else {
            sx = (sw - w*sh/h)/2;
            sw = w*sh/h;
        }
        c.drawImage(v,sx,sy,sw,sh,0,0,w,h); 
    } else { // contain
        var ww = v.width;
        var hh = v.height;
        var x = y = 0;
        if(ww/hh < w/h) {
            x = (w-ww*h/hh)/2;
            c.drawImage(v,x,0,ww*h/hh,h); 
        } else {
            y = (h-hh*w/ww)/2;
            c.drawImage(v,0,y,w,hh*w/ww); 
        }
    }
    setTimeout(draw,20,v,c);
}

<canvas id="canvas"></canvas>

*/

// TODO udelat z toho Thing
// TODO k ikonam pridat tooltipy

var BookViewer = Base.extend({
    constructor: function(options) {
        this.bookData = options.data;
        this.bookUrl = options.url;
        this.eventUrl = options.eventUrl;
        this.fullscreen = options.fullscreen;
        this.logger = options.logger;
        this.defaultWidth = 920;
        this.defaultHeight = 600;
        this.tools = {};
        this.bookContent = null;
        this.eventHistory = [];
        this.targetDiv = "#content"
    },
    makeIcon: function(icon, title) {
        return $("<div>").addClass('icon icon-48 icon-'+icon).css('display','inline-block').attr("title", title);
    },
    makeTool: function(icon, label, left/*bool*/, top, click) {
        this.tools[icon] = this.makeIcon(icon, label).css({position:'absolute', top: top}).css(left ? {'left':'6px'}:{'right':'6px'}).click(click).appendTo($("#book-wrapper"));
        return this.tools[icon];
    },
    showIcon: function(icon, enable) {
        if(enable) this.tools[icon].show() ; else this.tools[icon].hide();
    },
    turnNext: function() {
        this.bookContent.get().turn("next");
    },
    turnPrevious: function() {
        this.bookContent.get().turn("previous");
    },
    turnFirst: function() {
        this.bookContent.get().turn("page", 1);
    },
    goHome: function() {
        this.logEvent('book_close', this.bookUrl);
        window.location.href = this.bookUrl;
    },
    // v Chrome to nejak nefunguje...
    close: function() {
        this.logEvent('book_close', this.bookUrl);
        window.open('','_self','');
        window.close();
    },
    closeBook: function() {
        // normal viewer only turns to page 1
        this.turnFirst()
    },
    _setPageBackgrounds: function(bookContent, o) {
        var totalPages = bookContent.length()
        for(var i=0; i<totalPages; i++) {
            var slot = bookContent.nth(i)
            var elem = slot.element
            var css = { "background-size": "cover", "background-color": "white"}
            if(i==0) {
                // first page
                css["background-image"] = 'url('+o.frontpage_image_url+')'
            } else if(i == totalPages-1 && i%2!=0) {
                // last page, must be odd
                css["background-image"] = 'url('+o.backpage_image_url+')'
            } else if(i%2==0) {
                // even page
                css["background-image"] = 'url('+o.evenpage_image_url+')'
            } else {
                // odd page
                css["background-image"] = 'url('+o.oddpage_image_url+')'
            }
            elem.css(css)
        }
    },
    _makeWrapper: function(o) {
        return $("<div>")
            .attr("id", "book-wrapper")
            .css('position','relative')
            .css("background-image", 'url('+o.background_image_url+')')
    },
    _makeReferences: function(bookContent) {
        // gather references...
        var refs = [];
        bookContent.findSlotsByType('ref-decorator', refs);
        for(var i=0; i<refs.length; i++) {
            refs[i].options.label = (i+1)+""
            refs[i].refresh()
        }
        // TODO find reference-page layout and fill it by reference info...
        var reflists = [];
        bookContent.findSlotsByType('ref-list', reflists);
        // only the first will be used; later: we can split reference items into multiple ref lists
        if(reflists.length>0) {
            reflists[0].setReferences(refs);
        }
    },
    _monitorMediaEvents: function(bookContent) {
        // find audio and video Things and monitor their play, stop, pause, kill events
        var media = [];
        var self = this;
        bookContent.findSlotsByType('audio-decorator', media);
        bookContent.findSlotsByType('video-thing', media);
        for(var i=0; i<media.length; i++) {
            var m = media[i]; 
            var src = m.options.uri;           
            (function(){
                m.onPlay(function() { self.logEvent('book_media_play', src); });
                m.onPause(function() { self.logEvent('book_media_pause', src); });
                m.onStop(function() { self.logEvent('book_media_stop', src); });
                m.onKill(function() { self.logEvent('book_media_kill', src); });
            })();
        }
    },
    init: function() {
        /* display book... */
        var self = this;
        var width = this.defaultWidth;
        var height = this.defaultHeight;
        var o = this.bookData.options      
        // create wrapper...
        var wrapper = this._makeWrapper(o);
        wrapper.appendTo(this.targetDiv);
        this.bookContent = Thing.create(this.bookData, {"display":"turnable"});

        this._setPageBackgrounds(this.bookContent, o)
        this._makeReferences(this.bookContent)
        this._monitorMediaEvents(this.bookContent)
        
        // init book...
        this.bookContent.onInit();
        $("#book-wrapper").css({width:width+"px", height:height+"px"}).html(this.bookContent.get());
        this.bookContent.makeDisplay();

        // events...
        $(window).unload(function() {
            self.bookContent.onExit(); // TODO tohle mi nejak nefunguje...
        });
        $(window).resize(function() {
            if(self.fullscreen) {
                self.updateToolbar(self.recreate());
            }
        });
        $(window).bind("fullscreen-toggle", function(e, state) {
            self.setFullscreen(state);
        });
        this.bookContent.get().bind("turned", function(event, page, view) {
            self.updateToolbar();
            self.logEvent('book_page_turn', self.bookUrl, self.bookContent.get().turn("page"));
        });
        this.makeTool('turn-right', __('Previous page'), true, '50%', function() { self.turnPrevious();});
        this.makeTool('turn-left', __('Next page'), false, '50%', function() { self.turnNext();});
        this.makeTool('closebook', __('Close book'), false, '16px', function() { self.closeBook();});
        // reduce close icon in size...
        this.tools['closebook'].css({top: '16px', width: "24px", height: "24px"});

        // update icons...
        //$("#book-wrapper >.icon-turn-left").css("background-image", 'url('+o.turnleft_image_url+')')
        //$("#book-wrapper >.icon-turn-right").css("background-image", 'url('+o.turnright_image_url+')')

        this.updateToolbar();
        this.logEvent('book_open', this.bookUrl);
    },
    logEvent: function(type, src, data) {
        var timestamp = Math.floor(new Date().getTime() / 1000);
        this.logSingleEvent({"type":type,"src":src,"data":data,"timestamp":timestamp});
        if(type == 'book_close') {  
            // flush events...
            this.flushEventLog();
        }
    },
    logSingleEvent: function(evt) {
        if(this.logger) {
            this.logger(evt)
        }
        this.eventHistory.push(evt);
        if(this.eventUrl) {
            Common.postJsonData(this.eventUrl+".json", evt);
        }
    },
    flushEventLog: function() {
        // TODO odesilat eventy pres AJAX
        console.log(JSON.stringify(this.eventHistory, null, 4));
    },
    setFullscreen: function(full) {
        this.fullscreen = full;
        this.bookContent.get().turn('disable', true);
        if(this.fullscreen) {
            $("#book-wrapper").appendTo($("#fullscreen"));
            $("#container").hide();
            $("#fullscreen").show();            
        } else {
            $("#book-wrapper").appendTo($("#content"));
            $("#container").show();
            $("#fullscreen").hide();

        }
        this.bookContent.get().turn('disable', false);
        this.updateToolbar(this.recreate());
        this.logEvent('book_fullscreen', this.bookUrl, full);
        return full;    
    },
    recreate: function() {
        var width = this.defaultWidth;
        var height = this.defaultHeight;
        // kniha je velka 800x560 - pomer stran cca 1:sqrt(2) ~ 1:1.428
        if(this.fullscreen) {
            var ww = $(window).width();
            var hh = $(window).height();
            var scaleFactor = ww/width;
            var scaleFactor2 = hh/height;
            var scale = Math.min(scaleFactor, scaleFactor2);
            width = /*Math.floor(width*scale);*/ww;
            height = /*Math.floor(height*scale);*/hh;
        } 
        // resize wrapper and pages...
        $("#book-wrapper").css({width:width+"px", height:height+"px"});
        if(this.fullscreen) {
            // na okrajich musi zbyt 8% mista; to odpovida 60px 
            var sidex = Math.max(Math.floor(width*0.08), 60);
            var newWidth = width - 2*sidex;
            var newHeight = Math.floor(newWidth/1.428);
            var maxHeight = height-40;
            if(newHeight > maxHeight) {
                newWidth = Math.floor(newWidth*maxHeight/newHeight);
                newHeight = maxHeight;
            }
        } else {
            var newWidth = width - 120;
            var newHeight = height - 40;
        }
        this.bookContent.get().turn('size', newWidth, newHeight);
        return newWidth;
    },
    updateToolbar: function(gapWidth) {
        var page = this.bookContent.get().turn("page");
        var pages = this.bookContent.get().turn("pages");
        this.showIcon('turn-right', page>1);
        this.showIcon('turn-left', page<(pages-pages%2)); // kdyz ma kniha 3 strany, uz nejde druha otocit
        //this.showIcon('fullscreen-on', !this.fullscreen);
        //this.showIcon('fullscreen-off', this.fullscreen);
        
        if(gapWidth) {
            var gapSize = 60;
            if(this.fullscreen) {
                gapSize += Math.floor(($("#book-wrapper").width() - gapWidth)/2);
            }
            var hh = this.bookContent.get().height();
            var iconSize = Math.min(gapSize - 12, 240);
            var iconSizeHalf = Math.floor(iconSize/2);
            var hh2 = Math.max(Math.floor(hh/2-iconSize/2), 28+3*iconSize);
            this.tools['turn-right'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['turn-left'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            //this.tools['fullscreen-on'].css({top: (20+iconSize)+'px', width: iconSize+"px", height: iconSize+"px"});
            //this.tools['fullscreen-off'].css({top: (20+iconSize)+'px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['closebook'].css({top: '16px', width: iconSizeHalf+"px", height: iconSizeHalf+"px"});
            //if(this.bookUrl) this.tools['home'].css({top: '16px', width: iconSize+"px", height: iconSize+"px"});
        }
    }
});

var ExportBookViewer = BookViewer.extend({
    constructor: function(options) {
        this.base(options);
        this.targetDiv = "#fullscreen"
    },
    init: function() {
        this.base()
        this.setFullscreen(true);
    },
    closeBook: function() {
        // export viewer closes the book
        this.close()
    },
    updateToolbar: function(gapWidth) {
        var page = this.bookContent.get().turn("page");
        var pages = this.bookContent.get().turn("pages");
        this.showIcon('turn-right', page>1);
        this.showIcon('turn-left', page<(pages-pages%2)); // kdyz ma kniha 3 strany, uz nejde druha otocit

        if(gapWidth) {
            var gapSize = 60;
            if(this.fullscreen) {
                gapSize += Math.floor(($("#book-wrapper").width() - gapWidth)/2);
            }
            var hh = this.bookContent.get().height();
            var iconSize = Math.min(gapSize - 12, 240);
            var iconSizeHalf = Math.floor(iconSize/2);
            var hh2 = Math.max(Math.floor(hh/2-iconSize/2), 28+2*iconSize);
            this.tools['turn-right'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['turn-left'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['closebook'].css({top: '16px', width: iconSizeHalf+"px", height: iconSizeHalf+"px"});
        }
    },
    setFullscreen: function(full) {
        this.fullscreen = full;
        this.updateToolbar(this.recreate());
        this.logEvent('book_fullscreen', this.bookUrl, full);
        return full;    
    }
});



$.tubeplayer.defaults.afterReady = function($player) {
    console.log($player)
    // TODO resize only single player
	$(".tubeplayer-wrapper").resize()
}

var TubeplayerThing = Thing.extend({
    _onplay: $.noop,
    _onpause: $.noop,
    _onstop: $.noop,
    _onkill: $.noop,
    onPlay: function(kb) {
        if(typeof kb == 'function') {
            this._onplay = kb;
        } else {
            this._onplay(kb);
        }
    },
    onPause: function(kb) {
        if(typeof kb == 'function') {
            this._onpause = kb;
        } else {
            this._onpause(kb);
        }
    },
    onStop: function(kb) {
        if(typeof kb == 'function') {
            this._onstop = kb;
        } else {
            this._onstop(kb);
        }
    },
    onKill: function(kb) {
        if(typeof kb == 'function') {
            this._onkill = kb;
        } else {
            this._onkill(kb);
        }
    },
    thumbnailUrl: function() {
        return $.jYoutube(this.options.name, 'small');
    },
    init: function() {
    	this.wrapper = $("<div>").addClass("tubeplayer-wrapper")
        this.glasspane = $("<div>").addClass("tubeplayer-glasspane")        
        var self = this
		self.wrapper.resize(function(e) {
			console.log("Resizing! width="+self.wrapper.width()+", height="+self.wrapper.height())
			self.adjustPlayerSize()
		})        
		console.log("Initialized!")
    },
    play: function() {
        this._play();
    },
    _play: function() {
        this.player.tubeplayer("play")
        this.onPlay();
    },
    _pause: function() {
        this.player.tubeplayer("pause")
        this.onPause();
    },
    _stop: function() {
        this.player.tubeplayer("stop")
        this.onStop();
    },
    _kill: function() {
        this.player.tubeplayer("destroy")
        this.player.remove()
        this.player = null
        this.onKill();
    },
    _setVolume: function(vol) {
        this.player.tubeplayer("volume", vol)
    },
    adjustPlayerSize: function() {
    	var self = this    	
    	console.log("Adjusting player size! width="+self.wrapper.width()+", height="+self.wrapper.height())
        self.player.tubeplayer("size", {
			width: self.wrapper.width(), 
			height: self.wrapper.height()
		})
    },
    refresh: function() {
        this.base();
        if(this.player) {
            //this.player.tubeplayer("destroy")
            this.player.remove()
            this.player = null
        }
        this.player = $("<div>").addClass("tubeplayer-container")
        this.element.html(this.wrapper.empty().append(
            this.player
            // this.glasspane
        ))
        var self = this;
        var o = self.options
		self.player.tubeplayer({
			allowFullScreen: false,
			autoPlay: false,
			showControls: 0,
            initialVideo: o.name,
            preferredQuality: o.quality,
            autoPlay: o.autoplay,
            onPlayerUnstarted: function(){},
			onPlay: function(id){}, // after the play method is called
			onPause: function(){}, // after the pause method is called
			onStop: function(){}, // after the player is stopped
			onSeek: function(time){}, // after the video has been seeked to a defined point
			onMute: function(){}, // after the player is muted
			onUnMute: function(){} // after the player is unmuted
		})		
        // console.log(self.player.tubeplayer("player"))
        self._setVolume(o.volume)
    },
    _klass: "tubeplayer-thing thing",
    _type: "tubeplayer-thing",
    _defaults: {
        "name": "ydRAb9cwHnA",
        'quality': "default",
        'autoplay': false,
        'loop': false,
        'volume': 50
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "name": {
			    "type":"string",
                "format": "string",
			    "required":true
    	    },
		    "quality": {
			    "type":"string",
                "format": "string",
			    "required":true
    	    },
            "volume":{
                "type":"integer",
                "required":true // TODO
            },
            "autoplay":{
                "type":"boolean",
                "required":true // TODO
            },
            "loop":{
                "type":"boolean",
                "required":true // TODO
            }
	    }
    }

});

// uses: jquery, common, base

// tohle projde markup a vytvori widgety tam kde jsou na to pripravena data
// widget ma serverovou cast/sablonu a JS na klientovi ktery z toho muze vyrobit
// treba graficky editor nebo embedded SVG

function valueDecode(value) {
    if((/^!/).test(value)) {
        // je to bud base64 nebo to zacina vykricnikem
        value = value.substring(1);
        if(!(/^!/).test(value)) {
            // je to base64
            value = JSON.parse(utf8_decode(base64_decode(value)));
        } else {
            value = html_decode(value);
        }
    } else {
        value = html_decode(value);
    }
    return value;
}

function valueEncode(value) {
    if(jQuery.isPlainObject(value)) {
        return '!' + base64_encode(utf8_encode(JSON.stringify(value)));
    } else {
        var out = html_encode(value);
        if(out.startsWith('!')) out = "!" + out;
    }
    return out;
}

function widgetize(what) {
    what.reverse().each(function() {
        var self = $(this);        
        // find the widget class...
        var csss = self.attr("class").split(" ");
        for(var i=0; i<csss.length; i++) {
            // je to widget?
            if(csss[i].endsWith("-widget")) {
                var widgetClass = csss[i].replace(/-widget$/, "");
                // gather all data-attributes
                var data = self.data();        
                for(var key in data) {
                    var value = data[key];
                    data[key] = valueDecode(data[key]);
                    self.data(key, data[key]);
                }
                // vytvorime widget - zavolame JS/jQuery plugin a predame mu parametry v data
                console.log(data)
                self[widgetClass](data);
                break;
            }
        }
    });
}


var Widget = Base.extend({
    constructor: function(element, options) {
        this.element = element;
        this.options = $.extend({}, options);
        // promenne widgetu...
        this.wid = Widget.getUniqueId();
        this.element.data('wid', this.wid);
        Widget.cache[this.wid] = this;
    },
    init: function() {
        // inicializace ramce pro widget (toho co se nemeni)
    },
    refresh: function() {
        // volat pokazde pokud se zmeni data
    },
    destroy: function() {
        // uvedeni widgetu do puvodniho stavu
    }
},{
    wid: 1,
    getUniqueId: function() {
        return 'widget'+Widget.wid++;
    },
    cache: {}
});







var ThingWidget = Widget.extend({
    init: function() {
        var self = this;
        var def = this.options.def;
        if(def) {
            var thing = Thing.create(def);
            this.element.empty().append(thing.get());
        }
        self.refresh();
    },
    refresh: function() {
    }
});

// widgety...
(function($){

    var defaultOptions = { def: { type: "empty" } };

    var methods = {
        init : function(options) {
            var settings = $.extend({}, defaultOptions, options);
            return this.each(function() {
                var $this = $(this);
                var widget = new ThingWidget($this, settings);
                widget.init();
            });
        }
    };

    $.fn.thing = function(methodOrOptions) {
        if ( methods[methodOrOptions] ) {
            return methods[ methodOrOptions ].apply( this, Array.prototype.slice.call( arguments, 1 ));
        } else if ( typeof methodOrOptions === 'object' || ! methodOrOptions ) {
            // Default to "init"
            return methods.init.apply( this, arguments );
        } else {
            $.error( 'Method ' +  method + ' does not exist on jQuery.thing' );
        }    
    };

})(jQuery);


// TODO rozeznavani 'media' podle pripony

var _audioPlayerIndex = 1;
var makeAudioPlayer = function(parent, media) {
    var id = _audioPlayerIndex++;
    var playerId = 'jquery_cplayer_'+id;
    var containerId = 'cp_container_'+id;
    var html = $.render.circlePlayer({playerId: playerId, containerId: containerId});
    var div = $("<div>").html(html);
    parent.append(div);
    // ensure that player div is at the root of body
    $("#"+playerId).appendTo($("body"));

	var myCirclePlayer = new CirclePlayer("#"+playerId, media, {
		cssSelectorAncestor: "#"+containerId
	});
    return div;
};

var _videoPlayerIndex = 1;
var makeVideoPlayer = function(parent, media) {
    var id = _videoPlayerIndex++;
    var playerId = 'jquery_jplayer_'+id;
    var containerId = 'jp_container_'+id;
    var html = $.render.videoPlayer({playerId: playerId, containerId: containerId});
    var div = $("<div>").html(html).appendTo(parent);
    $("#"+playerId).jPlayer({
        ready: function () {
          $(this).jPlayer("setMedia", media);
        },
        swfPath: "/js",
        supplied: "m4v, ogv",
        cssSelectorAncestor: "#"+containerId
    });    
    return div;
};

// initialization...
$(document).ready(function() {

    // widgetizer...
    widgetize($(".widget"));

});
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: eScrapBook_Takova_normalni_rodinka\js\mykkro-viewerOld.js
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\eScrapBook_Takova_normalni_rodinka\js\mykkro-viewerOld.js
VELIKOST: 207473 B (202.61 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
// configuration file
var DEBUG = false;

var Config = {
};
var __ = function(arg) {
    return LocaleStrings[arg] || arg;
}

/*
	Base.js, version 1.1
	Copyright 2006-2007, Dean Edwards
	License: http://www.opensource.org/licenses/mit-license.php
*/

var Base = function() {
	// dummy
};

Base.extend = function(_instance, _static) { // subclass
	var extend = Base.prototype.extend;
	
	// build the prototype
	Base._prototyping = true;
	var proto = new this;
	extend.call(proto, _instance);
	delete Base._prototyping;
	
	// create the wrapper for the constructor function
	//var constructor = proto.constructor.valueOf(); //-dean
	var constructor = proto.constructor;
	var klass = proto.constructor = function() {
		if (!Base._prototyping) {
			if (this._constructing || this.constructor == klass) { // instantiation
				this._constructing = true;
				constructor.apply(this, arguments);
				delete this._constructing;
			} else if (arguments[0] != null) { // casting
				return (arguments[0].extend || extend).call(arguments[0], proto);
			}
		}
	};
	
	// build the class interface
	klass.ancestor = this;
	klass.extend = this.extend;
	klass.forEach = this.forEach;
	klass.implement = this.implement;
	klass.prototype = proto;
	klass.toString = this.toString;
	klass.valueOf = function(type) {
		//return (type == "object") ? klass : constructor; //-dean
		return (type == "object") ? klass : constructor.valueOf();
	};
	extend.call(klass, _static);
	// class initialisation
	if (typeof klass.init == "function") klass.init();
	return klass;
};

Base.prototype = {	
	extend: function(source, value) {
		if (arguments.length > 1) { // extending with a name/value pair
			var ancestor = this[source];
			if (ancestor && (typeof value == "function") && // overriding a method?
				// the valueOf() comparison is to avoid circular references
				(!ancestor.valueOf || ancestor.valueOf() != value.valueOf()) &&
				/\bbase\b/.test(value)) {
				// get the underlying method
				var method = value.valueOf();
				// override
				value = function() {
					var previous = this.base || Base.prototype.base;
					this.base = ancestor;
					var returnValue = method.apply(this, arguments);
					this.base = previous;
					return returnValue;
				};
				// point to the underlying method
				value.valueOf = function(type) {
					return (type == "object") ? value : method;
				};
				value.toString = Base.toString;
			}
			this[source] = value;
		} else if (source) { // extending with an object literal
			var extend = Base.prototype.extend;
			// if this object has a customised extend method then use it
			if (!Base._prototyping && typeof this != "function") {
				extend = this.extend || extend;
			}
			var proto = {toSource: null};
			// do the "toString" and other methods manually
			var hidden = ["constructor", "toString", "valueOf"];
			// if we are prototyping then include the constructor
			var i = Base._prototyping ? 0 : 1;
			while (key = hidden[i++]) {
				if (source[key] != proto[key]) {
					extend.call(this, key, source[key]);

				}
			}
			// copy each of the source object's properties to this object
			for (var key in source) {
				if (!proto[key]) extend.call(this, key, source[key]);
			}
		}
		return this;
	},

	base: function() {
		// call this method from any other method to invoke that method's ancestor
	}
};

// initialise
Base = Base.extend({
	constructor: function() {
		this.extend(arguments[0]);
	}
}, {
	ancestor: Object,
	version: "1.1",
	
	forEach: function(object, block, context) {
		for (var key in object) {
			if (this.prototype[key] === undefined) {
				block.call(context, object[key], key, object);
			}
		}
	},
		
	implement: function() {
		for (var i = 0; i < arguments.length; i++) {
			if (typeof arguments[i] == "function") {
				// if it's a function, call it
				arguments[i](this.prototype);
			} else {
				// add the interface using the extend method
				this.prototype.extend(arguments[i]);
			}
		}
		return this;
	},
	
	toString: function() {
		return String(this.valueOf());
	}
});

// requires: jquery

var log = function(what) {
    $("body").prepend($("<pre>").text(what));
}

var ajaxify = function(sel) {
    $(sel || ".ajaxify").each(function() {
        $(this).load($(this).data("target"));
    })
}

// From http://www.terrainformatica.com/?p=13
var delegate = function( that, thatMethod )
{
    if(arguments.length > 2)
    {
        var _params = [];
        for(var n = 2; n < arguments.length; ++n) _params.push(arguments[n]);
        return function() { return thatMethod.apply(that,_params); };
    }
    else
      return function() { return thatMethod.call(that); };
}

var delegate_cp = function( that, thatMethod ) {
    return function() { return thatMethod.apply(that,arguments); }
};

function utf8_encode( s ) {
  return unescape( encodeURIComponent( s ) );
}

function utf8_decode( s ) {
  return decodeURIComponent( escape( s ) );
}

function html_encode( input ) {
    return String(input)
        .replace(/&/g, '&amp;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '\'')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;');
}

function html_decode( input ) {
    return String(input)
        .replace(/&amp;/g, '&')
        .replace(/&quot;/g, '\"')
        .replace(/'/g, '\'')
        .replace(/&lt;/g, '<')
        .replace(/&gt;/g, '>');
}

function base64_decode (data) {
  // http://kevin.vanzonneveld.net
  // +   original by: Tyler Akins (http://rumkin.com)
  // +   improved by: Thunder.m
  // +      input by: Aman Gupta
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +   bugfixed by: Onno Marsman
  // +   bugfixed by: Pellentesque Malesuada
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +      input by: Brett Zamir (http://brett-zamir.me)
  // +   bugfixed by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // *     example 1: base64_decode('S2V2aW4gdmFuIFpvbm5ldmVsZA==');
  // *     returns 1: 'Kevin van Zonneveld'
  // mozilla has this native
  // - but breaks in 2.0.0.12!
  //if (typeof this.window['atob'] == 'function') {
  //    return atob(data);
  //}
  var b64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
  var o1, o2, o3, h1, h2, h3, h4, bits, i = 0,
    ac = 0,
    dec = "",
    tmp_arr = [];

  if (!data) {
    return data;
  }

  data += '';

  do { // unpack four hexets into three octets using index points in b64
    h1 = b64.indexOf(data.charAt(i++));
    h2 = b64.indexOf(data.charAt(i++));
    h3 = b64.indexOf(data.charAt(i++));
    h4 = b64.indexOf(data.charAt(i++));

    bits = h1 << 18 | h2 << 12 | h3 << 6 | h4;

    o1 = bits >> 16 & 0xff;
    o2 = bits >> 8 & 0xff;
    o3 = bits & 0xff;

    if (h3 == 64) {
      tmp_arr[ac++] = String.fromCharCode(o1);
    } else if (h4 == 64) {
      tmp_arr[ac++] = String.fromCharCode(o1, o2);
    } else {
      tmp_arr[ac++] = String.fromCharCode(o1, o2, o3);
    }
  } while (i < data.length);

  dec = tmp_arr.join('');

  return dec;
}



function base64_encode (data) {
  // http://kevin.vanzonneveld.net
  // +   original by: Tyler Akins (http://rumkin.com)
  // +   improved by: Bayron Guevara
  // +   improved by: Thunder.m
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +   bugfixed by: Pellentesque Malesuada
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +   improved by: Rafał Kukawski (http://kukawski.pl)
  // *     example 1: base64_encode('Kevin van Zonneveld');
  // *     returns 1: 'S2V2aW4gdmFuIFpvbm5ldmVsZA=='
  // mozilla has this native
  // - but breaks in 2.0.0.12!
  //if (typeof this.window['btoa'] == 'function') {
  //    return btoa(data);
  //}
  var b64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
  var o1, o2, o3, h1, h2, h3, h4, bits, i = 0,
    ac = 0,
    enc = "",
    tmp_arr = [];

  if (!data) {
    return data;
  }

  do { // pack three octets into four hexets
    o1 = data.charCodeAt(i++);
    o2 = data.charCodeAt(i++);
    o3 = data.charCodeAt(i++);

    bits = o1 << 16 | o2 << 8 | o3;

    h1 = bits >> 18 & 0x3f;
    h2 = bits >> 12 & 0x3f;
    h3 = bits >> 6 & 0x3f;
    h4 = bits & 0x3f;

    // use hexets to index into b64, and append result to encoded string
    tmp_arr[ac++] = b64.charAt(h1) + b64.charAt(h2) + b64.charAt(h3) + b64.charAt(h4);
  } while (i < data.length);

  enc = tmp_arr.join('');

  var r = data.length % 3;

  return (r ? enc.slice(0, r - 3) : enc) + '==='.slice(r || 3);

}

/**
 * Returns the first data element of an object, regardless on its key name.
 */
var extractRoot = function(data) {
  for(var key in data) {
    return data[key];
  }
}


Array.prototype.toObject = function() {
    var out = {};
    for(var i=0; i<this.length; i++) {
        out[i] = this[i];
    }
    return out;
}

// Array.copy() - Copy an array
if( typeof Array.prototype.copy==='undefined' ) {
 Array.prototype.copy = function() {
  var a = [], i = this.length;
  while( i-- ) {
   a[i] = typeof this[i].copy!=='undefined' ? this[i].copy() : this[i];
  }
  return a;
 };
}

// Array.insert( index, value ) - Insert value at index, without overwriting existing keys
Array.prototype.insert = function( i, v ) {
 if( i>=0 ) {
  var a = this.slice(), b = a.splice( i );
  a[i] = v;
  return a.concat( b );
 }
};

// Array Remove - By John Resig (MIT Licensed)
Array.prototype.remove = function(from, to) {
  var rest = this.slice((to || from) + 1 || this.length);
  this.length = from < 0 ? this.length + from : from;
  return this.push.apply(this, rest);
};

// Array.random( range ) - Return a random element, optionally up to or from range
Array.prototype.random = function( r ) {
 var i = 0, l = this.length;
 if( !r ) { r = this.length; }
 else if( r > 0 ) { r = r % l; }
 else { i = r; r = l + r % l; }
 return this[ Math.floor( r * Math.random() - i ) ];
};

// Array.shuffle( deep ) - Randomly interchange elements
Array.prototype.shuffle = function( b ) {
 var i = this.length, j, t;
 while( i ) {
  j = Math.floor( ( i-- ) * Math.random() );
  t = b && typeof this[i].shuffle!=='undefined' ? this[i].shuffle() : this[i];
  this[i] = this[j];
  this[j] = t;
 }
 return this;
};

// Array.unique( strict ) - Remove duplicate values
Array.prototype.unique = function( b ) {
 var a = [], i, l = this.length;
 for( i=0; i<l; i++ ) {
  if( a.indexOf( this[i], 0, b ) < 0 ) { a.push( this[i] ); }
 }
 return a;
};

// Array.walk() - Change each value according to a callback function
Array.prototype.walk = function( f ) {
 var a = [], i = this.length;
 while(i--) { a.push( f( this[i] ) ); }
 return a.reverse();
};

String.prototype.capitalize = function() {
    return this.charAt(0).toUpperCase() + this.slice(1);
}

//String.prototype.trim=function(){return this.replace(/^\s\s*/, '').replace(/\s\s*$/, '');};

// deprecated: use trimLeft, trimRight
/*
String.prototype.ltrim=function(){return this.replace(/^\s+/,'');}

String.prototype.rtrim=function(){return this.replace(/\s+$/,'');}
*/
String.prototype.fulltrim=function(){return this.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,'').replace(/\s+/g,' ');}

String.prototype.camelCase = function() { 
    var s = this.trim();
    return ( /\S[A-Z]/.test( s ) ) ?
        s.replace( /(.)([A-Z])/g, function(t,a,b) { return a + ' ' + b.toLowerCase(); } ) :
        s.replace( /( )([a-z])/g, function(t,a,b) { return b.toUpperCase(); } );
}

// code generation utilities

var CodeGenUtils = {
    getSetterName: function(name) {
        return "set" + name.capitalize();
    },
    getGetterName: function(name, isBoolean) {
        return (isBoolean ? "is" : "get") + name.capitalize();
    }
}



String.prototype.endsWith = function(suffix) {
    return this.indexOf(suffix, this.length - suffix.length) !== -1;
};

String.prototype.startsWith = function (str){
    return this.slice(0, str.length) == str;
};


jQuery.fn.swap = function(b) {
    b = jQuery(b)[0];
    var a = this[0];

    var t = a.parentNode.insertBefore(document.createTextNode(''), a);
    b.parentNode.insertBefore(a, b);
    t.parentNode.insertBefore(b, t);
    t.parentNode.removeChild(t);

    return this;
};


// smallest jQuery plugin :)
jQuery.fn.reverse = [].reverse;


$.extend({
  jYoutube: function( url, size ){
    if(url === null){ return ""; }

    size = (size === null) ? "big" : size;
    var vid;
    var results;

    results = url.match("[\\?&amp;]v=([^&amp;#]*)");

    vid = ( results === null ) ? url : results[1];

    if(size == "small"){
      return "http://img.youtube.com/vi/"+vid+"/2.jpg";
    }else {
      return "http://img.youtube.com/vi/"+vid+"/0.jpg";
    }
  }
});

var makeSvgScalable = function(svg) {
    var el = svg[0];
    var ww = el.getAttribute("width");
    var hh = el.getAttribute("height");
    el.setAttribute('width', '100%');
    el.setAttribute('height', '100%');
    el.setAttribute('viewBox', '0 0 '+ww+' '+hh);
    el.setAttribute('preserveAspectRatio', 'xMidyMid meet');
};

var Common = {
    postJsonData: function(url, data, success, error) {
        $.ajax({
            type: "post",       // Request method: post, get
            url: url,
            data: JSON.stringify(data), 
            dataType: "json",    // Expected response type
            contentType: "application/json",
            cache: false,
            success: success || $.noop,
            error: error || $.noop
        });
    },
    isValidUrl: function(str) {
      var pattern = new RegExp('^(https?:\\/\\/)?'+ // protocol
      '((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|'+ // domain name
      '((\\d{1,3}\\.){3}\\d{1,3}))'+ // OR ip (v4) address
      '(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*'+ // port and path
      '(\\?[;&a-z\\d%_.~+=-]*)?'+ // query string
      '(\\#[-a-z\\d_]*)?$','i'); // fragment locator
      if(!pattern.test(str)) {
        return false;
      } else {
        return true;
      }
    }
};

var JQ = {
    button: function(caption, click, parent) {
        var btn = $("<button>").text(caption);
        if(click) btn.click(click);
        if(parent) btn.appendTo(parent);
        return btn;
    },
    linkButton: function(content, click, parent) {
        var btn = JQ.put($("<a>"), content);
        if(click) btn.click(click);
        if(parent) btn.appendTo(parent);
        return btn;
    },
    link: function(content, href, tooltip, parent) {
        var link = JQ.put($("<a>"), content).attr({"title":tooltip, "href":href});
        if(parent) link.appendTo(parent);
        return link;
    },
    ul: function(parent) {
        var ul = $("<ul>");
        if(parent) ul.appendTo(parent);
        return ul;
    },
    li: function(klass, parent) {
        var li = $("<li>").addClass(klass);
        if(parent) li.appendTo(parent);
        return li;
    },
    checkbox: function(name, checked, parent) {
        var input = $("<input>").attr({'type':'checkbox', 'name':name}).prop("checked", checked);
        if(parent) input.appendTo(parent);
        return input;
    },
    textfield: function(name, value, parent) {
        var input = $("<input>").attr({'type':'text', 'name':name, "value":value});
        if(parent) input.appendTo(parent);
        return input;
    },
    span: function(content, klass, parent) {
        var span = JQ.put("span", content).addClass(klass);
        if(parent) span.appendTo(parent);
        return span;
    },
    div: function(content, klass, parent) {
        var div = JQ.put("div", content).addClass(klass);
        if(parent) div.appendTo(parent);
        return div;
    },
    p: function(content, klass, parent) {
        var p = JQ.put("p", content).addClass(klass);
        if(parent) p.appendTo(parent);
        return p;
    },
    h1: function(content, klass, parent) {
        return JQ.hN(1, content, klass, parent);
    },
    h2: function(content, klass, parent) {
        return JQ.hN(2, content, klass, parent);
    },
    h3: function(content, klass, parent) {
        return JQ.hN(3, content, klass, parent);
    },
    h4: function(content, klass, parent) {
        return JQ.hN(4, content, klass, parent);
    },
    h5: function(content, klass, parent) {
        return JQ.hN(5, content, klass, parent);
    },
    h6: function(content, klass, parent) {
        return JQ.hN(6, content, klass, parent);
    },
    hN: function(level, content, klass, parent) {
        var heading = JQ.put("h"+level, content).addClass(klass);
        if(parent) heading.appendTo(parent);
        return heading;
    },
    label: function(content, klass, parent) {
        var label = JQ.put("label", content).addClass(klass);
        if(parent) label.appendTo(parent);
        return label;
    },
    clear: function(parent) {
        var clr = $("<div>").addClass("clear");
        if(parent) clr.appendTo(parent);
        return clr;
    },
    show: function(elem, enabled) {
        if(enabled) elem.show(); else elem.hide();
    },
    form: function(klass, parent) {
        var div = $("<form>").addClass(klass);
        if(parent) div.appendTo(parent);
        return div;
    },
    fieldset: function(klass, parent) {
        var div = $("<fieldset>").addClass(klass);
        if(parent) div.appendTo(parent);
        return div;
    },
    toggleLink: function(captionOn, captionOff, target, parent) {
        var visible = target.is(":visible");
        var btn = JQ.put("a", visible ? captionOn : captionOff).click(function() {
            var visible = target.is(":visible");
            if(visible) {
                target.hide();
                btn.text(captionOff);
            } else {
                target.show();
                btn.text(captionOn);
            }
        });
        if(parent) btn.appendTo(parent);
        return btn;
    },
    linkExt: function(caption, href, tooltip, parent) {
        return JQ.link(caption, href, tooltip, parent).attr("target","_blank");
    },
    put: function(where, what) {
        if(typeof(where) == "string") {
            where = $("<"+where+">");
        }
        if(what) {
            if(typeof(what) == "string") {
                where.text(what);
            } else {
                where.append(what);
            }
        }
        return where;
    }
};

// kazda 'vec' ma options (s defaultni hodnotou) a slots
var Thing = Base.extend({
    constructor: function(options, slots) {
        this.options = $.extend({}, this.defaults(), options);        
        this.tid = Thing.tid++;
        Thing.things[this.tid] = this;
        this.element = $("<div>").addClass(this.getClass()).attr("data-tid", this.tid);
        if(DEBUG) {
            this.element.css("background-color", '#'+Math.floor(Math.random()*16777215).toString(16));
        }
        this.slots = {};
        this.parent = null;
        this.name = null;
        // initializing...
	    this.slotChanged($.noop);
        this.init();
        this.setSlots(slots);
        // display update
        this.refresh();
    },
    copy: function() {
        return Thing.create(this.serialize());
    },
    remove: function() {
        this.replaceWith(Thing.empty());        
    },
    replaceWith: function(thing) {
        if(this.parent) {
            this.parent.setSlot(this.name, thing);
            this.parent = null;
            this.name = null;           
            Thing.things[this.tid] = null;
        }
    },
    // obali this dekoratorem
    decorate: function(deco) {
        if(this.parent) {
            var par = this.parent;
            var slot = this.name;
            deco.setSlot('content', this);
            par.setSlot(slot, deco);
            return deco;
        }
    },
    serialize: function() {
        var slots = {};
        var numslots = 0;
        for(var key in this.slots) {
            slots[key] = this.slots[key].serialize();
            numslots++;
        }
        var obj = {
            type: this.getType(),
            options: this.options
        };
        if(numslots) obj.slots = slots
        return obj;
    },
    getType: function() {
        return this._type;
    },
    getClass: function() {
        return this._klass.split(" ").map(function(a){return "mykkro-"+a;}).join(" ");
    },
    init: function() {
        // create structure and variables
    },
    refresh: function() {
        // options changed...
        this.element.attr('class','');
        this.element.addClass(this.getClass());
        this.element.addClass(this.options.css);
    },
    get: function() {
        return this.element;
    },
    defaults: function() {
        return this._defaults;
    },
    // muzeme se dostat takhle i ke slotu ve slotu
    content: function(key, value) {
        var ndx = key.indexOf(".");
        if(ndx>=0) {
            // odkazujeme se na slot ve slotu
            var newKey = key.substring(0,ndx);
            var rest = key.substring(ndx+1);
            return this.getSlot(newKey).content(rest, value);
        }
        if(this.hasSlot(key)) {
            if(value) {
                // setter
                this.setSlot(key, value);
                return this;
            } else {
                // getter
                return this.getSlot(key);
            }
        } else {
            // unknown slot!
            return null;
        }
    },
    hasSlot: function(key) {
        return !!this.slots[key];
    },
    getSlot: function(key) {
        return this.slots[key];
    },
    setSlot: function(key, thing) {
        this.slots[key] = thing;
        thing._setParent(this, key);
        // DOM manipulation - to be overridden
	    this.slotChanged(key);
        return this;
    },
    removeSlot: function(key) {
        delete this.slots[key]
    },
    clearSlots: function() {
        for(var key in this.slots) {
            this.setSlot(key, Thing.empty());
        }
    },
    setOptions: function(opts) {
        this.options = $.extend(this.options, opts);
        this.refresh();
	    this.slotChanged('options');
    },
    setSlots: function(slots) {
        if(slots) {
            // pokud je parametr pole, udelat z nej objekt
            if($.isArray(slots)) slots = slots.toObject();
            for(var key in slots) {
                this.setSlot(key, slots[key]);
            }
        }
    },
    _setParent: function(parent, key) {
        this.parent = parent;
        this.name = key;
    },
    isEmpty: function() {
        return this.getType() == "empty";
    },
    slotChanged: function(arg) {
        if(typeof arg == "function") {
            this.onslotchanged = arg;
        } else {
            return this.onslotchanged(this, arg);
        }
    },    
    // bez parametru vraci rekurzivne vsechny sloty
    findSlots: function(predicate, out) {
        if(!predicate) predicate = function() { return true; };
        if(!out) out = [];
        if(predicate(this)) out.push(this);
        for(var key in this.slots) {
            this.slots[key].findSlots(predicate, out);
        }
        return out;
    },
    findEmptySlots: function(out) {
        return this.findSlots(function(thing) { return thing.isEmpty(); }, out)
    },
    findSlotsByType: function(type, out) {
        return this.findSlots(function(thing) { return thing.getType() == type; }, out)
    },
    getTree: function() {
        var node = { type: this.getType(), children: {} };
        for(var key in this.slots) {
            node.children[key] = this.slots[key].getTree();
        }
        return node;
    },
    _toggleTreeView: function(node) {
        node.children(".slots").toggleClass('collapsed');
    },
    // TODO mohlo by si to pamatovat expands/collapse mezi updaty
    /* example decorator:
        decorator = function(thing, node) {
            $("<div>").addClass("toolz").insertAfter(node.find(">h2"));
        };
    */
    getTreeView: function(decorator) {
        var self = this;
        var node = $("<div>").addClass('node').attr('data-type', this.getType()).attr('data-tid', this.tid);
        var hdr = $("<h2>").text(this.getType()).appendTo(node);
        var slots = $("<div>").addClass('slots').appendTo(node);
        hdr.click(function() {
            self._toggleTreeView(node);
        });
        for(var key in this.slots) {
            (function(){
                var subtree = self.slots[key].getTreeView(decorator);
                var subheading = $("<h3>").text(key).click(function() {
                    $(this).toggleClass('collapsed');
                    self._toggleTreeView(subtree);
                });
                slots.append(subheading);
                slots.append(subtree);
            })();
        }
        node.append($("<div>").addClass('clear'));
        if(decorator) decorator(this, node);
        return node;
    },
    _type: "thing",
    _defaults: {
        "css": ""
    },
    _klass: "thing",
    _schema: {
       "type":"object",
       "properties":{
       },
       "additionalProperties":true
    }

},{    
    tid: 0,
    things: {},
    create: function(def, opts) {
        if(!def) {
            return Thing.empty();
        }
        // udelat deserializaci
        // { type, options, slots }
        var klassName = def.type.replace(/-([a-z])/g, function (g) { return g[1].toUpperCase() });
        klassName = klassName.capitalize();
        var klazz = window[klassName];
        var slots = def.slots;
        var oid = def.id;
        if($.isArray(slots)) slots = slots.toObject();
        for(var key in slots) {
            slots[key] = Thing.create(slots[key]);
        }
        var thing = new klazz($.extend(def.options, opts), slots);
        thing.oid = oid
        return thing
    },
    empty: function(options) {
        return new Empty(options);
    }
});



var Empty = Thing.extend({
    refresh: function() {
        this.element.empty();
        /*
        if(this.parent) this.element.html(
            $("<div>").text(this.parent.getType()+"#"+this.name)
        );
        */
    },
    _setParent: function(parent, key) {
        this.base(parent, key);
        this.refresh();
    },
    _klass: "empty thing",
    _type: "empty"
});


var Imager = Thing.extend({
    refresh: function() {
        var img = $("<div>")
            .css("background-image",'url("'+this.options.url+'")')
            .css('background-position',this.options['position'])
            .css('background-repeat',this.options['repeat'])
            .css('background-color',this.options['color'])
            .css('background-size',this.options['size'])
            .css('-moz-background-size',this.options['size'])
            .css('-webkit-background-size',this.options['size']);
        this.element.html(img);
    },
    _klass: "imager thing",
    _type: "imager",
    _defaults: {
        "url": "images/demo/australie1.jpg",
        "repeat": "no-repeat",
        "position": "center center",
        "color": "white",
        "size": "cover" 
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "color": {
			    "type":"string",
			    "id": "color",
			    "required":true,
                "format": "color"
		    },
		    "position": {
			    "type":"string",
			    "id": "position",
			    "required":true
		    },
		    "repeat": {
			    "type":"string",
			    "id": "repeat",
			    "required":true
		    },
		    "size": {
			    "type":"string",
			    "id": "size",
                "enum":["cover","contain"],
			    "required":true
		    },
		    "url": {
			    "type":"string",
			    "id": "url",
                "format": "my-image-uri",
			    "required":true
		    }
	    }
    }

});


var RaphaelThing = Thing.extend({
    refresh: function() {
        var o = this.options;
        var div = $("<div>");
        this.element.html(div);
        var paper = Raphael(div.get(0), "100%","100%");
        paper.setViewBox(0, 0, o.width, o.height, true);
        this.canvas = paper;
    },
    _klass: "raphael-thing thing",
    _type: "raphael-thing",
    _defaults: {
        width: 100,
        height: 100
    },
    _schema: {
       "type":"object",
       "description":"RaphaelThing properties",
       "properties":{
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }

});


var CanvasThing = Thing.extend({
    init: function() {
        var o = this.options;
        var self = this;
        this.canvas = $("<canvas>").appendTo(this.element).attr({width:o.width, height:o.height});
        // pouziva CSS transformaci, rastr je porad stejne velky
        if(o.autoscale) {
            this.element.resize(function() {
                var el = $(this);
                var o = self.options;
                var zoom = Math.min(el.width()/o.width, el.height()/o.height);
                el.css({
                    "-moz-transform": "scale("+zoom+")", 
                    "-webkit-transform": "scale("+zoom+")", 
                    "-moz-transform-origin":"0px 0px", 
                    "-webkit-transform-origin":"0px 0px"
                });
            });
        }
        // zvetsuje fyzicky pocet pixelu rastru
        if(o.autoresize) {
            this.element.resize(function() {
                var el = $(this);
                var ww = el.width();
                var hh = el.height();
                if(o.keepaspectratio) { var asp = o.width/o.height; if(ww/hh > asp) ww = hh*asp; else hh = ww/asp; }
                self.canvas.attr({
                    "width": ww, 
                    "height": hh
                });
                self.refresh();
            });
            var el = this.element;
            var ww = el.width();
            var hh = el.height();
            if(o.keepaspectratio) { var asp = o.width/o.height; if(ww/hh > asp) ww = hh*asp; else hh = ww/asp; }
            this.canvas.attr({
                "width": ww, 
                "height": hh
            });            
        }
    },
    refresh: function() {
        var context = this.canvas.get(0).getContext('2d');
        if (context) {
            this.draw(context, this.canvas.width() || this.options.width, this.canvas.height() || this.options.height);
        }
    },
    draw: function(g, w, h) {
        /* by default, draws only rectangle... */
        g.strokeRect(0,  0, w, h);
    },
    _klass: "canvas-thing thing",
    _type: "canvas-thing",
    _defaults: {
        width: 100,
        height: 100,
        autoscale: false,
        autoresize: true,
        keepaspectratio: true
    },
    _schema: {
       "type":"object",
       "description":"CanvasThing properties",
       "properties":{
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          },
          "autoscale":{
             "type":"boolean",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


// http://www.nihilogic.dk/labs/javascript_canvas_fractals/
var Fractal = CanvasThing.extend({
    draw: function(ctx, w, h) {
        var smoothColors = this.options.smoothcolors;
        var vx = this.options.vx;
        var vy = this.options.vy;
        var zoom = this.options.zoom;

        var imageData = !!ctx.getImageData;
        var startit = 30;
        var xmin, xmax, ymin, ymax, dx, dy;
        var er = 2;

        var colors = {
	        red : [[0,0,1],[0,1,0],[0,1,0]],
	        blue : [[0,0,0],[0,1,0],[0,1,1]],
	        green : [[0,1,0],[0,0,1],[0,1,0]],
	        orange : [[1,1,1],[0,1,0],[0,0,0]],
	        magenta : [[0,0,1],[0,0.1,0.5],[0,0,1]],
	        yellow : [[0.2,0.2,1],[0.2,0.2,1],[0,0,0.2]],

        };

        var log2 = 1 / Math.log(2.0);
        var sin = Math.sin;
        var cos = Math.cos;
        var exp = Math.exp;
        var phi = 1.6180339887;
        function cosh(a) {
            return (exp(a) + exp(-a))/2;
        }
        function sinh(a) {
            return (exp(a) - exp(-a))/2;
        }
        function csin(x,y) {
	        return [sin(x) * cosh(y), cos(x) * sinh(y)];
        }
        function ccos(x,y) {
	        return [cos(x)*cosh(y), -sin(x)*sinh(y)];
        }
        function cexp(x,y) {
	        return [exp(x)*cos(y), exp(x)*sin(y)];
        }
        function cmul(c1,c2) {
	        return [
		        c1[0]*c2[0]-c1[1]*c2[1],
		        c1[0]*c2[1]+c1[1]*c2[0]
	        ];
        }

        var fractals = {

	        mandelbrot : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        var lastxx, lastyy;
		        do {
			        y = (x+x)*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2) {

				        y = (x+x)*y + y0; // iterate once for more for smoother colors
				        x = xx - yy + x0;
				        yy = y*y;
				        xx = x*x;

				        break;
			        }
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliacubed : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {

			        tx = x;
			        ty = y;

			        tx2 = x*x-y*y;
			        ty2 = 2*x*y;

			        x = tx2*tx-ty2*ty + 1-phi;
			        y = tx2*ty+ty2*tx + 0.3;

			        xx = x*x;
			        yy = y*y;

			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        multibrot3 : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var tx, ty, tx2, ty2;
		        var xx = x*x, yy = y*y;
		        do {
			        tx = x;
			        ty = y;
			        tx2 = xx-yy;
			        ty2 = 2*x*y;
			        x = tx2*tx-ty2*ty + x0;
			        y = tx2*ty+ty2*tx + y0;
			        xx = x*x;
			        yy = y*y;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        multibrot4 : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = 2*x*y;
			        x = xx - yy;
			        yy = y*y;
			        xx = x*x;
			        y = 2*x*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        multibrot8 : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = 2*x*y;
			        x = xx - yy;
			        yy = y*y;
			        xx = x*x;
			        y = 2*x*y;
			        x = xx - yy;
			        yy = y*y;
			        xx = x*x;
			        y = 2*x*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        burningship : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = 2*Math.abs(x*y) - y0;
			        x = xx - yy - x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        tricorn : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = -y;

			        y = (x+x)*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        julia_base : function(x, y, it, er2, cr, ci) {
		        var xx = x*x, yy = y*y;
		        do {
			        y = (x+x)*y + ci;
			        x = xx - yy + cr;
			        yy = y*y;
			        xx = x*x;

			        if (xx+yy > er2) {
				        y = (x+x)*y + ci;
				        x = xx - yy + cr;
				        yy = y*y;
				        xx = x*x;

				        break;
			        }
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        julia1 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, phi - 2, phi - 1);
	        },

	        julia2 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 1-phi, 0);
	        },

	        julia3 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 0.285, 0);
	        },

	        julia4 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 0.285, 0.01);
	        },

	        julia5 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.835, -0.2321);
	        },

	        julia6 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.7, -0.3);
	        },

	        julia7 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 0, 1);
	        },

	        julia8 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.391, -0.587);
	        },

	        julia9 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.123, 0.745);
	        },

	        julia10 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.75, 0);
	        },

	        julia11 : function(x, y, it, er2) {
		        var zr, zi;
		        var cr = 0.6;
		        var ci = 1.1;
		        var xx = x*x, yy = y*y;
		        do {
			        zr = x - (x?(x<0?-1:1):0);
			        zi = y;
			        x = cr*zr-ci*zi;
			        y = cr*zi+ci*zr;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliasine_base : function(x, y, it, er2, cr, ci) {
		        var xx = x*x, yy = y*y;
		        var z, expy, expmy;
		        var c = [cr, ci];
		        do {
			        //z = csin(x,y);
			        expy = exp(y);
			        expmy = exp(-y);
			        z = [sin(x) * (expy + expmy)/2, cos(x) * (expy - expmy)/2];

			        x = c[0]*z[0]-c[1]*z[1];
			        y = c[0]*z[1]+c[1]*z[0];

			        yy = y*y, xx = x*x;
			        if (xx+yy > 500)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliasine : function(x, y, it, er2) {
		        return fractals["juliasine_base"](x, y, it, er2, 1, 0.1);
	        },

	        juliasine2 : function(x, y, it, er2) {
		        return fractals["juliasine_base"](x, y, it, er2, 1, 0.3);
	        },

	        juliacosine_base : function(x, y, it, er2, cr, ci) {
		        var xx = x*x, yy = y*y;
		        var z, expy, expmy;
		        var c = [cr, ci];
		        do {
			        //z = ccos(x,y);
			        expy = exp(y);
			        expmy = exp(-y);
			        z = [cos(x) * (expy + expmy)/2, -sin(x) * (expy - expmy)/2];

			        x = c[0]*z[0]-c[1]*z[1];
			        y = c[0]*z[1]+c[1]*z[0];

			        yy = y*y, xx = x*x;
			        if (xx+yy > 500)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliacosine : function(x, y, it, er2) {
		        return fractals["juliacosine_base"](x, y, it, er2, 1, 0.6);
	        },

	        juliacosine2 : function(x, y, it, er2) {
		        return fractals["juliacosine_base"](x, y, it, er2, Math.PI/2 * 1.5, Math.PI/2 * 0.05);
	        },

	        juliacosine3 : function(x, y, it, er2) {
		        var xx = x*x, yy = y*y;
		        var z, expy, expmy;
		        var c = [1, 0.1];
		        do {
			        //z = ccos(x,y);
			        expy = exp(y);
			        expmy = exp(-y);
			        z = [cos(x) * (expy + expmy)/2, -sin(x) * (expy - expmy)/2];

			        x = c[0]*z[0]-c[1]*z[1];
			        y = c[0]*z[1]+c[1]*z[0];

			        tx = x;
			        x = -y;
			        y = tx;

			        yy = y*y, xx = x*x;
			        if (xx+yy > 500)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

        };

        // from http://www.nihilogic.dk/labs/javascript_canvas_fractals/
        function render(fncFrac, colWeights) {
	        var time = new Date().getTime();

	        ctx.fillStyle = "#000000";
	        ctx.fillRect(0,0,w,h);

	        if (imageData) {
		        var data = ctx.getImageData(0,0,w,h);
		        var pixels = data.data;
	        }

	        var mi = Math.max(startit, Math.round(Math.max(Math.log(zoom),1) * startit));
	        var itfac = 1/mi*startit

	        xmin = vx - 2/zoom;
	        xmax = vx + 2/zoom;
	        ymin = vy - 2/zoom;
	        ymax = vy + 2/zoom;

	        dx = xmax-xmin;
	        dy = ymax-ymin;

	        var px, py, it;

	        var er2 = er*er;

	        var c1, c2, c3, m;
	        var col1, col2, col3;
	        var cw0 = colWeights[0], cw1 = colWeights[1], cw2 = colWeights[2];

	        var i = (w*h)-1;
	        do {
		        var offset = i*4;

		        px = (i%w);
		        py = h-((i/w)|0);

		        var res = fncFrac(
			        xmin + px/w * dx, 
			        ymin + py/h * dy, 
			        mi, er2
		        )

		        it = mi - res.it;

		        var mag = smoothColors ? 
				        (it * itfac) - (Math.log(Math.log(res.xx+res.yy))) * log2
				        : it * itfac;

		        //if (color == "bw") {
			    //    c1 = c2 = c3 = 
				//        (res.it==mi) ? 255 : 255 - mag/startit * 255;
		        //} else {
			        if (res.it == 0)
				        continue;

			        if (mag < startit/3) {
				        m = (mag*3);
				        col1 = m * 4;
				        col2 = m * 4;
				        col3 = m * 10;
			        } else if (mag < startit/1.5) {
				        m = (mag-startit/3)*3;
				        col1 = 80 + m * 8;
				        col2 = 80 + m * 8;
				        col3 = 200 + m * 2.5;
			        } else {
				        m = (mag-2*startit/3)*3
				        col1 = 220 + m * 1.5;
				        col2 = 220 + m * 1.5;
				        col3 = 255;
			        }

			        c1 = col1*cw0[0] + col2*cw0[1] + col3*cw0[2];
			        c2 = col1*cw1[0] + col2*cw1[1] + col3*cw1[2];
			        c3 = col1*cw2[0] + col2*cw2[1] + col3*cw2[2];
		        //}

		        c1 = c1 < 0 ? 0 : c1;
		        c2 = c2 < 0 ? 0 : c2;
		        c3 = c3 < 0 ? 0 : c3;

		        c1 = c1 > 255 ? 255 : c1;
		        c2 = c2 > 255 ? 255 : c2;
		        c3 = c3 > 255 ? 255 : c3;

		        if (!imageData) {
			        ctx.fillStyle = "rgb(" + (c1|0) + "," + (c2|0) + "," + (c3|0) + ")";
			        ctx.fillRect((px|0), h-((py|0)), 1, 1);
		        } else {
			        pixels[offset] = c1;
			        pixels[offset+1] = c2;
			        pixels[offset+2] = c3;
		        }

	        } while(--i);

	        if (imageData) {
		        ctx.putImageData(data,0,0);
		        ctx.fillRect(0,0,0,0);
	        }
        };

        render(fractals[this.options.algorithm], colors[this.options.color]);
    },
    _klass: "fractal thing",
    _type: "fractal",
    _defaults: {
        width: 300,
        height: 300,
        autoscale: false,
        autoresize: true,
        keepaspectratio: true,
        algorithm: "mandelbrot",
        color: "yellow",
        smoothcolors: true,
        vx: 0.3,
        vy: 0,
        zoom: 10
    },
    _schema: {
       "type":"object",
       "description":"Fractal properties",
       "properties":{
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          },
          "autoscale":{
             "type":"boolean",
             "required":false
          }
       },
       "additionalProperties":true
    }
});


var Html = Thing.extend({
    init: function() {
        this.inner = $("<div>");
        this.element.html(this.inner);
    },
    refresh: function() {
        this.base();
        this.inner.html(this.options.html).attr('class',this.options.innerCss);
    },
    _klass: "html thing",
    _type: "html",
    _defaults: {
        html: ""
    },
    _schema: {
       "type":"object",
       "description":"Html properties",
       "properties":{
          "html":{
             "type":"string",
             "required":true
          },
          "css":{
             "type":"string",
             "required":false
          },
          "innerCss":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


var Svg = Thing.extend({
    init: function() {
    },
    refresh: function() {
        this.base();
        this.element.html(this.options.svg);
    },
    _klass: "svg thing",
    _type: "svg",
    _defaults: {
        svg: '<svg xmlns="http://www.w3.org/2000/svg" version="1.1">'
    },
    _schema: {
       "type":"object",
       "description":"Svg properties",
       "properties":{
          "svg":{
             "type":"string",
             "required":true
          },
          "width":{
             "type":"string",
             "required":false
          },
          "height":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


var SvgEditor = Thing.extend({
    change: function(arg) {
        if(typeof arg == 'function') {
            this.onchange = arg;
        } else {
            this.onchange(arg);
        }
    },
    init: function() {
        var self = this;
        self.onchange = $.noop;
        self.frame = $('<iframe src="'+baseUrl+'testing/svgedit">').attr('width',self.options.width).attr('height', self.options.height);
        self.frame.ready(function() {
            // http://code.google.com/p/svg-edit/wiki/TipsAndTricks
            // waiting for real load
            (function(){
                try {
                    var cw = self.frame[0].contentWindow;
                    var md = cw.methodDraw;
                    md.ready(function() {     
                        cw.svgCanvas.setSvgString(self.options.svg);
                    });        
                    md.addExtension("server_opensave", {
                        callback: function() {
                            md.setCustomHandlers({
	                            save: function(win, data) {
		                            self.options.svg = data;
                                    self.onchange(data);
	                            }
                            });
                        }
                    });
                }
                catch (Ex){
                    setTimeout(arguments.callee, 1000);
                }
            })();
        });
        self.frame.appendTo(self.element);
    },
    refresh: function() {
        this.base();
    },
    _klass: "svg-editor thing",
    _type: "svg-editor",
    _defaults: {
        svg: '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100" height="100"></svg>',
        width: "800px",
        height: "600px"
    },
    _schema: {
       "type":"object",
       "description":"SvgEditor properties",
       "properties":{
          "svg":{
             "type":"string",
             "required":true
          },
          "width":{
             "type":"string",
             "required":false
          },
          "height":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


var TextThing = Html.extend({
    refresh: function() {
        this.base();
        var o = this.options;
        if(o['h-align'] && o['h-align'] != 'center') this.inner.addClass(o['h-align']);
        if(o['v-align'] && o['v-align'] != 'center') this.inner.addClass(o['v-align']);
        this.inner.css('font-size', o['font-size']);
        this.inner.css('font-family', o['font-family']);
    },
    _klass: "text-thing html thing",
    _type: "text-thing",
    _defaults: {
        "html": "",
        "css": "",
        "h-align": "center",
        "v-align": "center",
        "font-size": "20px",
        "font-family": "Georgia, serif"
    },
    _schema: {
       "type":"object",
       "properties":{
          "html":{
             "type":"string",
	     "format":"richtext",
             "required":true
          },
          "h-align":{
             "type":"string",
             "enum":["left","center","right"],
             "required":false
          },
          "v-align":{
             "type":"string",
             "enum":["top","center","bottom"],
             "required":false
          },
          "font-size":{
             "type":"string",
             "enum":["50%","60%","75%", "85%", "100%", "120%", "150%", "175%", "200%", "250%"],
             "required":false
          },
          "font-family":{
             "type":"string",
             "enum":[
'Arial,Arial,Helvetica,sans-serif',
'Arial Black,Arial Black,Gadget,sans-serif',
'Comic Sans MS,Comic Sans MS,cursive',
'Courier New,Courier New,Courier,monospace',
'Georgia,Georgia,serif',
'Impact,Charcoal,sans-serif',
'Lucida Console,Monaco,monospace',
'Lucida Sans Unicode,Lucida Grande,sans-serif',
'Palatino Linotype,Book Antiqua,Palatino,serif',
'Tahoma,Geneva,sans-serif',
'Times New Roman,Times,serif',
'Trebuchet MS,Helvetica,sans-serif',
'Verdana,Geneva,sans-serif' 
],
             /*"format":"font",*/
             "required":false
          }
       },
       "additionalProperties":true
    }
});


var Templated = Thing.extend({
    refresh: function() {
        var tmpl = $.templates( "#"+this.options.template+"Template" );
        var html = tmpl.render(this.options);
        this.element.html(html);
        this.element.find("[data-slot]").each(function() { 
            $(this).html(Thing.empty().get()); 
        });
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.find("[data-slot='"+key+"']").html(value.get());
        return this;
    },
    _klass: "templated thing",
    _type: "templated",
    _defaults: {
        template: "demo",
        name: "Myrousz"
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "template": {
			    "type":"string",
			    "required":true
		    },
		    "name": {
			    "type":"string",
			    "required":true
		    }
	    }
    }
});


var Snippet = Thing.extend({
    refresh: function() {
        var o = this.options;
        var code = $("<pre>").text(o.code);
        this.element.html(code);
        SyntaxHighlighter.highlight({title: o.title, 'brush':o.lang}, code.get(0));        
    },
    _klass: "snippet thing",
    _type: "snippet",
    _defaults: {
        "title": "",
        "lang": "js",
        "code": ""
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "title": {
			    "type":"string",
			    "required":false
		    },
		    "lang": {
			    "type":"string",
                "enum":["js","php","plain"],
			    "required":true
		    },
		    "code": {
			    "type":"string",
			    "required":true
		    }
	    }
    }
});


var SoftKeyboard = Thing.extend({
    init: function() {
        this.keys = {};
        this.onkeypress = $.noop;
    },
    refresh: function() {
        var kbd = $("<div>");
        var rows = this.options.rows;
        var cols = this.options.rows;
        for(var key in this.options.keys) {
            var k = this.options.keys[key];
            var kk = this._makeKey(key, k).appendTo(kbd);
            this.keys[key] = kk;
        }
        this.element.html(kbd);
    },
    getKeyButton: function(key) {
        return {"name":key, "button":this.keys[key], "key":this.options.keys[key]};
    },
    _makeKey: function(name, k) {
        var self = this;
        var o = this.options;
        var top = Math.floor(100*k.top/o.rows) + "%";
        var left = Math.floor(100*k.left/o.columns) + "%";
        var ww = k.size || k.width;
        var hh = k.size || k.height;
        var mm = 2;
        var width = Math.floor(100*ww/o.columns) + "%";
        var height = Math.floor(100*hh/o.rows) + "%";
        var div = $("<button>").addClass("key key-"+name).css({'top':top, 'left':left, 'width':width, 'height':height}).append($("<div>").text(k.label));
        div.click(function() {
            if(k['switch']) {
                div.toggleClass("active");
            }
            self.keyPressed(self.getKeyButton(name));
        });
        return div;
    },
    keyPressed: function(kb) {
        if(typeof kb == 'function') {
            this.onkeypress = kb;
        } else {
            this.onkeypress(kb);
        }
    },
    getSwitchState: function(name) {
        if(this.options.keys[name] && this.options.keys[name]['switch']) {
            return this.keys[name].hasClass("active");
        } else {
            return false;
        }
    },    
    _klass: "soft-keyboard thing",
    _type: "soft-keyboard",
    _defaults: {
        "rows": 8,
        "columns": 20,
        "keys": {
            "q" : { "left":0, "top":0, "size":2, "label":"Q"},
            "w" : { "left":2, "top":0, "size":2, "label":"W"},
            "e" : { "left":4, "top":0, "size":2, "label":"E"},
            "r" : { "left":6, "top":0, "size":2, "label":"R"},
            "t" : { "left":8, "top":0, "size":2, "label":"T"},
            "y" : { "left":10, "top":0, "size":2, "label":"Y"},
            "u" : { "left":12, "top":0, "size":2, "label":"U"},
            "i" : { "left":14, "top":0, "size":2, "label":"I"},
            "o" : { "left":16, "top":0, "size":2, "label":"O"},
            "p" : { "left":18, "top":0, "size":2, "label":"P"},
            "a" : { "left":1, "top":2, "size":2, "label":"A"},
            "s" : { "left":3, "top":2, "size":2, "label":"S"},
            "d" : { "left":5, "top":2, "size":2, "label":"D"},
            "f" : { "left":7, "top":2, "size":2, "label":"F"},
            "g" : { "left":9, "top":2, "size":2, "label":"G"},
            "h" : { "left":11, "top":2, "size":2, "label":"H"},
            "j" : { "left":13, "top":2, "size":2, "label":"J"},
            "k" : { "left":15, "top":2, "size":2, "label":"K"},
            "l" : { "left":17, "top":2, "size":2, "label":"L"},
            "caps" : { "left":0, "top":4, "width":3, "height":2, "label":__("caps"), "switch":true},
            "z" : { "left":3, "top":4, "size":2, "label":"Z"},
            "x" : { "left":5, "top":4, "size":2, "label":"X"},
            "c" : { "left":7, "top":4, "size":2, "label":"C"},
            "v" : { "left":9, "top":4, "size":2, "label":"V"},
            "b" : { "left":11, "top":4, "size":2, "label":"B"},
            "n" : { "left":13, "top":4, "size":2, "label":"N"},
            "m" : { "left":15, "top":4, "size":2, "label":"M"},
            "del" : { "left":17, "top":4, "width":3, "height":2, "label":__("del")},
            "nums" : { "left":0, "top":6, "width":4, "height":2, "label":__("?123")},
            "comma" : { "left":4, "top":6, "width":3, "height":2, "label":","},
            "space" : { "left":7, "top":6, "width":6, "height":2, "label":__("space")},
            "dot" : { "left":13, "top":6, "width":3, "height":2, "label":"."},
            "enter" : { "left":16, "top":6, "width":4, "height":2, "label":__("enter")}
        }
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "rows": {
			    "type":"integer",
			    "required":true
		    },
		    "columns": {
			    "type":"integer",
			    "required":true
		    }
	    }
    }
});


var SoftTextEditor = Thing.extend({
    init: function() {
        var self = this;
        this.onchange = $.noop;
        this.keyboard = new SoftKeyboard();
        this.keyboard.keyPressed(function(kb) {
            self._keyPressed(kb);
        });
        this.textfield = $("<textarea>").val(this.options.value).change(function() {
            self.options.value = $(this).val();
        });
        this.buttonOk = $("<button>").addClass('done').text(__("Done")).click(function() {
            self.change(self.textfield.val());
        });
        this.element
            .append($("<div>").addClass("textfield").append(this.textfield))
            .append($("<div>").addClass("btn").append(this.buttonOk))            
            .append(this.keyboard.get());
    },
    refresh: function() {
        this.textfield.val(this.options.value);
    },
    // TODO napojit
    change: function(arg) {
        if(typeof arg == 'function') {
            this.onchange = arg;
        } else {
            this.onchange(arg);
        }
    },
    _keyPressed: function(kb) {
        var cc = kb.name;
        switch(cc) {
            case 'caps': 
                this.capsLock = this.keyboard.getSwitchState('caps');
                break;
            case 'del':
                // delete last character
                this.options.value = this.options.value.slice(0, -1);
                this.refresh();
                break;
            case 'nums': 
                break;
            case 'enter':
                this.options.value += "\n";
                this.refresh();
                break;
            case 'comma':
                this.options.value += ",";
                this.refresh();
                break;
            case 'space':
                this.options.value += " ";
                this.refresh();
                break;
            case 'dot':
                this.options.value += ".";
                this.refresh();
                break;
            default:
                if(this.capsLock) {
                    // invert case...
                    cc = ( cc >= 'A' && cc <= 'Z' ) ? cc.toLowerCase() : cc.toUpperCase();
                }
                this.options.value += cc;
                this.refresh();
        }
    },
    _klass: "soft-text-editor thing",
    _type: "soft-text-editor",
    _defaults: {
        "value": ""
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "value": {
			    "type":"string",
			    "required":true
		    }
	    }
    }
});



var HolidayCalendar = {
    // kdy je velikonocni nedele - bozi hod velikonocni?
    easter: {
        "2012": {month: 4, day: 8},
        "2013": {month: 3, day: 31},
        "2014": {month: 4, day: 20},
        "2015": {month: 4, day: 5}
    },
    data: 
// BEGIN JSON DATA
[
    {
        "month": "Leden",
        "days": [
            {
                "number": "1",
                "names": [
                    "Nový rok"/*,
                    "Den obnovy samostatného českého státu"*/
                ],
                "holiday": true
            },
            {
                "number": "2",
                "names": [
                    "Karina"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Radmila"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Diana"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Dalimil"
                ]
            },
            {
                "number": "6",
                "names": [
                    /*"Kašpar",
                    "Melichar",
                    "Baltazar"*/"Tři králové"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Vilma"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Čestmír"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Vladan"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Břetislav"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Bohdana"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Pravoslav"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Edita"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Radovan"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Alice"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Ctirad"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Drahoslav"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Vladislav"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Sára/Doubravka"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Ilona"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Běla"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Slavomír"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Zdeněk"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Milena"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Miloš"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Zora"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Ingrid"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Otýlie"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Zdislava"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Robin"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Marika"
                ]
            }
        ]
    },
    {
        "month": "Únor",
        "days": [
            {
                "number": "1",
                "names": [
                    "Hynek"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Nela"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Blažej"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Jarmila"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Dobromila"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Vanda"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Veronika"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Milada"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Apolena"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Mojmír"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Božena"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Slavěna"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Věnceslav"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Valentýn"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Jiřina"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Ljuba"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Miloslava"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Gizela"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Patrik"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Oldřich"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Lenka"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Petr"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Svatopluk"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Matěj"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Liliana"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Dorota"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Alexandr"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Lumír"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Horymír"
                ]
            }
        ]
    },
    {
        "month": "Březen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Bedřich"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Anežka"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Kamil"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Stela"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Kazimír"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Miroslav"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Tomáš"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Gabriela"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Františka"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Viktorie"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Anděla"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Řehoř"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Růžena"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Matylda/Rút"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Ida"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Herbert/Elena"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Vlastimil"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Eduard"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Josef"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Světlana"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Radek"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Leona"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Ivona"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Gabriel"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Marian"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Emanuel"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Dita"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Soňa"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Taťána"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Arnošt"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Kvido"
                ]
            }
        ]
    },
    {
        "month": "Duben",
        "days": [
            {
                "number": "1",
                "names": [
                    "Hugo"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Erika"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Richard"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Ivana"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Miroslava"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Vendula"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Hermína/Herman"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Ema"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Dušan"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Darja"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Izabela"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Július"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Aleš"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Vincenc"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Anastázie"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Irena"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Rudolf"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Valérie"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Rostislav"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Marcela"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Alexandra"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Evženie"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Vojtěch"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jiří"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Marek"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Oto"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Jaroslav"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Vlastislav"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Robert"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Blahoslav"
                ]
            }
        ]
    },
    {
        "month": "Květen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Svátek práce"
                ],
                "holiday": true
            },
            {
                "number": "2",
                "names": [
                    "Zikmund"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Alexej"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Květoslav"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Klaudie"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Radoslav"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Stanislav"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Den vítězství"
                ],
                "holiday": true
            },
            {
                "number": "9",
                "names": [
                    "Ctibor"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Blažena"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Svatava"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Pankrác"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Servác"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Bonifác"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Žofie"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Přemysl"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Aneta"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Nataša"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Ivo"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Zbyšek"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Monika"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Emil"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Vladimír"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jana"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Viola"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Filip"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Valdemar"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Vilém"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Maxmilián"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Ferdinand"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Kamila"
                ]
            }
        ]
    },
    {
        "month": "Červen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Laura"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Jarmil"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Tamara"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Dalibor"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Dobroslav"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Norbert"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Iveta"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Medard"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Stanislava"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Gita"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Bruno"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Antonie"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Antonín"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Roland"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Vít"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Zbyněk"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Adolf"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Milan"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Leoš"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Květa"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Alois"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Pavla"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Zdeňka"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jan"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Ivan"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Adriana"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Ladislav"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Lubomír"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Petr a Pavel"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Šárka"
                ]
            }
        ]
    },
    {
        "month": "Červenec",
        "days": [
            {
                "number": "1",
                "names": [
                    "Jaroslava"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Patricie"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Radomír"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Prokop"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Cyril a Metoděj"
                ],
                "holiday": true
            },
            {
                "number": "6",
                "names": [
                    /*"Den upálení Mistra Jana Husa"*/"Jan Hus"
                ],
                "holiday": true
            },
            {
                "number": "7",
                "names": [
                    "Bohuslava"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Nora"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Drahoslava"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Libuše/Amálie"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Olga"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Bořek"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Markéta"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Karolína"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Jindřich"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Luboš"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Martina"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Drahomíra"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Čeněk"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Ilja/Eliáš"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Vítězslav"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Magdalena"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Libor"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Kristýna"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Jakub"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Anna"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Věroslav"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Viktor"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Marta"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Bořivoj"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Ignác"
                ]
            }
        ]
    },
    {
        "month": "Srpen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Oskar"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Gustav"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Miluše"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Dominik"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Kristián"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Oldřiška"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Lada"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Soběslav"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Roman"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Vavřinec"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Zuzana"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Klára"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Alena"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Alan"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Hana"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Jáchym"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Petra"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Helena"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Ludvík"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Bernard"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Johana"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Bohuslav"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Sandra"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Bartoloměj"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Radim"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Luděk"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Otakar"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Augustýn"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Evelína"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Vladěna"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Pavlína"
                ]
            }
        ]
    },
    {
        "month": "Září",
        "days": [
            {
                "number": "1",
                "names": [
                    "Linda/Samuel"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Adéla"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Bronislav"
                    /* /Bronislava"*/
                ]
            },
            {
                "number": "4",
                "names": [
                    "Jindřiška"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Boris"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Boleslav"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Regina"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Mariana"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Daniela"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Irma"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Denisa"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Marie"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Lubor"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Radka"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Jolana"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Ludmila"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Naděžda"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Kryštof"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Zita"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Oleg"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Matouš"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Darina"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Berta"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jaromír"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Zlata"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Andrea"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Jonáš"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Václav"/*,
                    "Den české státnosti"*/
                ],
                "holiday": true
            },
            {
                "number": "29",
                "names": [
                    "Michal"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Jeroným"
                ]
            }
        ]
    },
    {
        "month": "Říjen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Igor"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Olivie/Oliver"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Bohumil"
                ]
            },
            {
                "number": "4",
                "names": [
                    "František"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Eliška"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Hanuš"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Justýna"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Věra"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Štefan/Sára"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Marina"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Andrej"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Marcel"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Renáta"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Agáta"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Tereza"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Havel"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Hedvika"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Lukáš"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Michaela"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Vendelín"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Brigita"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Sabina"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Teodor"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Nina"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Beáta"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Erik"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Šarlota/Zoe"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Státní svátek"/*,
                    "Den vzniku samostatného československého státu"*/
                ],
                "holiday": true
            },
            {
                "number": "29",
                "names": [
                    "Silvie"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Tadeáš"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Štěpánka"
                ]
            }
        ]
    },
    {
        "month": "Listopad",
        "days": [
            {
                "number": "1",
                "names": [
                    "Felix"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Památka zesnulých"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Hubert"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Karel"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Miriam"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Liběna"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Saskie"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Bohumír"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Bohdan"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Evžen"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Martin"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Benedikt"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Tibor"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Sáva"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Leopold"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Otmar"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Mahulena"/*,
                    "Den boje za svobodu a demokracii"*/
                ],
                "holiday": true
            },
            {
                "number": "18",
                "names": [
                    "Romana"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Alžběta"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Nikola"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Albert"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Cecílie"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Klement"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Emílie"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Kateřina"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Artur"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Xenie"
                ]
            },
            {
                "number": "28",
                "names": [
                    "René"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Zina"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Ondřej"
                ]
            }
        ]
    },
    {
        "month": "Prosinec",
        "days": [
            {
                "number": "1",
                "names": [
                    "Iva"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Blanka"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Svatoslav"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Barbora"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Jitka"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Mikuláš"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Ambrož/Benjamín"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Květoslava"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Vratislav"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Julie"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Dana"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Simona"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Lucie"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Lydie"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Radana"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Albína"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Daniel"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Miloslav"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Ester"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Dagmar"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Natálie"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Šimon"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Vlasta"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Adam a Eva"/*,
                    "Štědrý den"*/
                ],
                "holiday": true
            },
            {
                "number": "25",
                "names": [
                    "Boží hod vánoční"
                ],
                "holiday": true
            },
            {
                "number": "26",
                "names": [
                    "Štěpán"/*,
                    "Druhý svátek vánoční"*/
                ],
                "holiday": true
            },
            {
                "number": "27",
                "names": [
                    "Žaneta"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Bohumila"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Judita"
                ]
            },
            {
                "number": "30",
                "names": [
                    "David"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Silvestr"
                ]
            }
        ]
    }
]
// END JSON DATA
};

var Calendar = RaphaelThing.extend({
    /* canvas size: 1000x1000 */
    refresh: function() { 
        this.base();   
        var d = this.options;
        this.paper = this.canvas;
        this.paper.clear();
        this.lineAttr = { "fill": "none", "stroke": d.lineColor};
        this.monthNameAttr = { "stroke": "none", "fill": d.fontColor, "font-family":d.fontFamily, "font-size":d.titleFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.monthCapAttr = { "fill": d.fontColor, "stroke": "none", "font-family":d.fontFamily, "font-size":d.dayCapFontSize, "font-style":d.fontStyle};
        this.dayNumAttr = { "stroke": "none", "fill":d.fontColor, "font-family":d.fontFamily, "font-weight":"bold", "font-size":d.numbersFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.dayNameAttr = { "stroke": "none", "fill": d.fontColor, "font-family":d.fontFamily, "font-size":d.namesFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.dayNumAttrHigh = { "stroke": "none", "fill": d.fontColorHigh, "font-family":d.fontFamily, "font-weight":"bold", "font-size":d.numbersFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.dayNameAttrHigh = { "stroke": "none", "fill": d.fontColorHigh, "font-family":d.fontFamily, "font-size":d.namesFontSize, "font-style":d.fontStyle, "text-anchor":"end"};

        this.monthCapOffset = 12;
        this.boxWidth = 142;
        this.boxHeight = 142;
        this.drawMonth(d.year, d.month);
        // HACK: https://github.com/DmitryBaranovskiy/raphael/issues/491
        this.element.find("tspan").attr("dy", 0);
    },

    drawMonthGrid: function(rows, x, y) {
        // draws grid 7x5 with day captions
        for(var i=0; i<=7; i++) {
            // draw captions
            // draw vertical lines
            var xx = x + i*this.boxWidth;
            var str = "M"+xx+","+y+"l0,"+rows*this.boxHeight;
            this.paper.path(str).attr(this.lineAttr); 
            if(i<7) this.paper.text(xx+this.boxWidth/2, y-this.monthCapOffset, this.locale[this.currentLocale].daysOfWeek[i]).attr(this.monthCapAttr);
        }
        for(var j=0; j<=rows; j++) {
            // draw horizontal lines
            var yy = y + j*this.boxHeight;
            var str = "M"+x+","+yy+"l"+7*this.boxWidth+",0";
            this.paper.path(str).attr(this.lineAttr);            
        }                    
    },

    drawDayBox: function(row, column, year, month, day, x, y) {
        // is day sunday?
        var sunday = this.getDayOfWeek(year, month, day) == 0;
        // is day holiday?
        var holiday = HolidayCalendar.data[month-1].days[day-1].holiday;

        var xx = x + (column+1)*this.boxWidth - 5;
        // print number...
        var yy = y + (row+1-0.45)*this.boxHeight - 5;
        this.paper.text(xx, yy, day).attr((sunday || holiday) ? this.dayNumAttrHigh : this.dayNumAttr);
        // print name
        var yy = y + (row+1-0.1)*this.boxHeight - 5;
        this.paper.text(xx, yy, HolidayCalendar.data[month-1].days[day-1].names[0]).attr(holiday ? this.dayNameAttrHigh : this.dayNameAttr);
    },

    drawMonth: function(year, month) {
        var x = 0;
        var column = this.getDayOfWeek(year, month, 1);
        // nedele = 0! pondeli 1...
        column = (column==0) ? 6 : column-1;
        // how many total rows?
        lastColumn = column+HolidayCalendar.data[month-1].days.length;
        var totalRows = Math.floor((lastColumn+6)/7);
        var y = 7*this.boxHeight - totalRows*this.boxHeight;
        // draw month name
        var mn = this.locale[this.currentLocale].months[month-1] + " "+year;
        this.drawMonthGrid(totalRows, x, y);
        this.paper.text(x+7*this.boxWidth, y-0.7*this.boxHeight, mn).attr(this.monthNameAttr);
        var row = 0;
        for(var i=0; i<HolidayCalendar.data[month-1].days.length; i++) {
            this.drawDayBox(row, column, year, month, i+1, x, y);
            column++;
            if(column == 7) {
                column = 0;
                row++;
            }
        }

    },
    locale: {
        "en": {
            "months": [
                "January","February","March","April","May","June","July","August","September","October","November","December"
            ],
            "daysOfWeek": [
                "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"
            ]
        },
        "cz": {
            "months": [
                "Leden","Únor","Březen","Duben","Květen","Červen","Červenec","Srpen","Září","Říjen","Listopad","Prosinec"
            ],
            "daysOfWeek": [
                "Pondělí", "Úterý", "Středa", "Čtvrtek", "Pátek", "Sobota", "Neděle"
            ]
        }
    },
    currentLocale: 'cz',
    getDayOfWeek: function(year, month, day) {
        var d = new Date(year, month-1, day, 0, 0, 0, 0);
        return d.getDay();
    },
    isLeapYear: function(yr) {
        return new Date(yr,2-1,29).getDate()==29;
    },

    _klass: "calendar raphael-thing thing",
    _type: "calendar",
    _defaults: {
        width: 1000,
        height: 1000,
        year: 2012,
        month: 12,
        fontFamily: "Arial", 
        fontStyle: "italic", 
        lineColor: "black",
        fontColor: "black",
        fontColorHigh: "red",
        titleFontSize: "40",
        dayCapFontSize: "20",
        numbersFontSize: "60",
        namesFontSize: "16"
    },
    _schema: {
       "type":"object",
       "description":"Calendar properties",
       "properties":{
          "year":{
             "type":"string",
             "enum":["2012", "2013","2014","2015"],
             "required":true
          },
          "month":{
             "type":"string",
             "enum":["1", "2","3","4","5","6","7","8","9","10","11","12"],
             "required":true
          },
            // .....
          "titleFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "dayCapFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "numbersFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "namesFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "fontFamily":{
             "type":"string",
             "enum":["Georgia, serif","Arial, Helvetica, sans-serif","Impact, Charcoal, sans-serif", "Tahoma, Geneva, sans-serif", "Verdana, Geneva, sans-serif", "Monaco, monospace"],
             "required":true
          },
          "fontStyle":{
             "type":"string",
             "enum":["regular","italic","monospace"],
             "required":true
          }
       },
       "additionalProperties":true
    }
});



// TODO kdyz zmenim parametry hodin a ulozim, nepromitne se to do inputu

var Clock = RaphaelThing.extend({
    refresh: function() {
        this.base();
        var 
            o = this.options,
            size = o.size,
            canvas = this.canvas,
            clock = canvas.circle(size*.5,size*.5, size * .475);
        clock.attr({"fill":o.fillColor,"stroke":o.strokeColor,"stroke-width":(size*.025)})
        var hour_sign;
        for(i=0;i<12;i++){
            var start_x = size*.5+Math.round((size*.4)*Math.cos(30*i*Math.PI/180));
            var start_y = size*.5+Math.round((size*.4)*Math.sin(30*i*Math.PI/180));
            var end_x = size*.5+Math.round((size*.45)*Math.cos(30*i*Math.PI/180));
            var end_y = size*.5+Math.round((size*.45)*Math.sin(30*i*Math.PI/180));
            hour_sign = canvas.path("M"+start_x+" "+start_y+"L"+end_x+" "+end_y);
        }
        this.hour_hand = canvas.path("M" + size*.5 + " " + size*.5 + "L" + size*.5 + " " + (size*.25) + "");
        this.hour_hand.attr({stroke: o.hourHandColor, "stroke-width": size*.03});
        this.minute_hand = canvas.path("M" + size*.5 + " " + size*.5 + "L" + size*.5 + " " + (size*.2) + "");
        this.minute_hand.attr({stroke: o.minuteHandColor, "stroke-width": size*.02});
        this.second_hand = canvas.path("M" + size*.5 + " " + (size*.55) + "L" + size*.5 + " " + (size*.125) + "");
        this.second_hand.attr({stroke: o.secondHandColor, "stroke-width": size*.01});
        var pin = canvas.circle(size*.5, size*.5, size*.025);
        pin.attr("fill", o.pinColor);

        var self = this;
        var updater = function() {
            self.update();
        };
        updater();
        setInterval(updater,1000); 
    },
    update: function() {
        var self = this,
            size = this.options.size,
            now = new Date(),
            hours = now.getHours(),
            minutes = now.getMinutes(),
            seconds = now.getSeconds(),
            cc = ","+(size*.5)+","+(size*.5);
        self.hour_hand.transform('r'+(30*hours+(minutes/2.5))+cc);
        self.minute_hand.transform('r'+(6*minutes)+cc);
        self.second_hand.transform('r'+(6*seconds)+cc);
    },
    _klass: "clock raphael-thing thing",
    _type: "clock",
    _defaults: {
        width: 100,
        height: 100,
        size: 100,
        fillColor: "white", 
        strokeColor: "black", 
        pinColor: "gray",
        hourHandColor:"black", 
        minuteHandColor:"black",
        secondHandColor:"black"
    },
    _schema: {
       "type":"object",
       "description":"Clock properties",
       "properties":{
          "size":{
             "type":"integer",
             "required":true
          },
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          },
          "fillColor":{
             "type":"string",
             "format": "color",
             "required":true
          },
          "strokeColor": { "type": "string", "required": true, "format": "color" },
          "pinColor": { "type": "string", "required": true, "format": "color" },
          "hourHandColor": { "type": "string", "required": true, "format": "color" },
          "minuteHandColor": { "type": "string", "required": true, "format": "color" },
          "secondHandColor": { "type": "string", "required": true, "format": "color" }
       },
       "additionalProperties":true
    }
});


var Modal = Thing.extend({
    init: function() {
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.html($("<p>").html(value.get()));
        this.refresh();
        return this;
    },
    _fullOpts: function() {
      return $.extend({modal: true}, this.options)
    },
    show: function() {
        var self = this;
	    $(self.element).dialog(this._fullOpts());
	    $(self.element).dialog('open');
    },
    close: function() {
	    $(this.element).dialog('close');
    },
    refresh: function() {
    	$(this.element).dialog(this._fullOpts());
    },
    _klass: "modal thing",
    _type: "modal",
    _defaults: {
        autoOpen: false,
        minHeight: 608, // 560,  
        minWidth: 760, //740
        title: 'Dialog',
        closeOnEscape: true
    },
    _schema: {
       "type":"object",
       "properties":{
          "title": {
             "type": "string",
             "required": false
          },
          "autoOpen":{
             "type":"boolean",
             "required":true
          },
          "minHeight":{
             "type":"string",
             "required":true
          },
          "minWidth":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }

}, {
    show: function(thing, opts) {
        var modal = new Modal(opts);
        modal.content('content',thing);
        modal.show();
        return modal;
    }
});


var Dummy = Html.extend({
    refresh: function() {
        this.base();
        this.element.css('width', this.options['width']);
        this.element.css('height',this.options['height']);
        this.element.css('color',this.options['color']);
        this.element.css('background-color',this.options['background-color']);
    },
    _klass: "dummy html thing",
    _type: "dummy",
    _defaults: {
        html: "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla sed dolor nisl, in suscipit justo. Donec a enim et est porttitor semper at vitae augue. Proin at nulla at dui mattis mattis. Nam a volutpat ante. Aliquam consequat dui eu sem convallis ullamcorper. Nulla suscipit, massa vitae suscipit ornare, tellus est consequat nunc, quis blandit elit odio eu arcu. Nam a urna nec nisl varius sodales. Mauris iaculis tincidunt orci id commodo. Aliquam non magna quis tortor malesuada aliquam eget ut lacus. Nam ut vestibulum est. Praesent volutpat tellus in eros dapibus elementum. Nam laoreet risus non nulla mollis ac luctus felis dapibus. Pellentesque mattis elementum augue non sollicitudin. Nullam lobortis fermentum elit ac mollis. Nam ac varius risus. Cras faucibus euismod nulla, ac auctor diam rutrum sit amet. Nulla vel odio erat, ac mattis enim.",
        'width': "",
        'height': '',
        'color': '',
        'background-color': ''
    },
    _schema: {
       "type":"object",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "height":{
             "type":"string",
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          },
          "background-color":{
             "type":"string",
             "format": "color",
             "required":true
          }
       },
       "additionalProperties":true
    }
});

// decorator = thing with a single slot named 'content'

// TODO podedit toto vsechno od 'Decorator'
// kvuli reverzibilite dekoratoru by bylo dobre kdyby kazdy menil css properties 'wrapper' divu
var Decorator = Thing.extend({
    init: function() {
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.html(value.get());
        return this;
    },
    unwrap: function() {
        this.replaceWith(this.getSlot('content'));
    },
    _klass: "decorator thing",
    _type: "decorator"
});


















var Clickable = Thing.extend({
    init: function() {
        this.pane = $("<div>").addClass("clickable-pane");
        this.setSlot('content', Thing.empty());
        this.click($.noop);
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.empty()
            .append(value.get())
            .append(this.pane);
        return this;
    },
    refresh: function() {
      this.base();
      this.pane.attr('title', this.options.tooltip);
    },
    click: function(arg) {
        if(arg) {
            this.onclick = arg;
            this.pane.click(this.onclick);
        } else {
            return this.onclick();
        }
    },
    _klass: "clickable thing",
    _type: "clickable",
    _defaults: {
      "tooltip": ""
    }
});


var Editable = Thing.extend({
    init: function() {
        this.onchanged = $.noop;
        this.editor = $("<div>").addClass("editable-editor");
        this.pane = $("<div>").addClass("editable-pane");
        this.element.append(this.pane).append(this.editor);
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        var self = this;
        var schema = value._schema;
        this.editor.empty();
        if(!schema) {
            // pouzit radsi json editor
        } else {
            this.editor.jsonform({schema: value._schema, value: value.options, name: __("Properties")+" - "+value._type});
            this.editor.jsonform('change', function() {
                self._save(true);
            });
            this.editor.jsonform('save', function() {
                self._save();
            });
        }
        this.pane.html(value.get());
        return this;
    },
    _save: function(stay) {
        var self = this;
        // value changed in editor...
        var newVal = self.editor.jsonform('value');
        self.getSlot('content').setOptions(newVal);
        if(!stay) self.onchanged(newVal);
    },
    _klass: "editable thing",
    _type: "editable",
    _defaults: {}
}, {
    edit: function(thing, changed) {
        var edt = new Editable();
        edt.setSlot('content', thing.copy());
        var modal = Modal.show(edt, {height: 630, minHeight: 630, width: 840, minWidth: 840, resizable: false, draggable: true, title:__('Properties')});
        edt.onchanged = function(newVal) {
            modal.close();
            if(changed) changed(newVal);
        };
    }
});



var ToolbarDecorator = Thing.extend({
    init: function() {
        this._content = $("<div>")
            .addClass("mykkro-toolbar-decorator-content")
            .appendTo(this.element);
        this.setSlot('content', Thing.empty());
    },
    refresh: function() {
	    this.base();
        if(this.options.hidden) {
            this.element.toolbar({tools:{}});
        } else {
            this.element.toolbar({tools:this.options.tools});
        }
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this._content.html(value.get());
        return this;
    },
    showToolbar: function() {
        this.options.hidden = false;
        this.refresh();
    },
    hideToolbar: function() {
        this.options.hidden = true;
        this.refresh();
    },
    serialize: function() {
        // toolbar decorator se nebude serializovat (aspon automaticky ne)
        return this.getSlot('content').serialize();
    },
    getTree: function() {
        // skip the outer layer...
        return this.getSlot('content').getTree();
    },
    getTreeView: function(decorator) {
        // skip the outer layer...
        return this.getSlot('content').getTreeView(decorator);
    },
    _klass: "toolbar-decorator thing",
    _type: "toolbar-decorator",
    _defaults: {
        tools: {}
    } 
});


var ContextmenuDecorator = Thing.extend({
    init: function() {
        this._content = $("<div>")
            .addClass("mykkro-contextmenu-decorator-content")
            .appendTo(this.element);
        this.setSlot('content', Thing.empty());
    },
    refresh: function() {
	    this.base();
        if(this.options.hidden) {
            this.element.toolbar({tools:{}});
        } else {
            this.element.toolbar({tools:this.options.tools});
        }
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this._content.html(value.get());
        return this;
    },
    showToolbar: function() {
        this.options.hidden = false;
        this.refresh();
    },
    hideToolbar: function() {
        this.options.hidden = true;
        this.refresh();
    },
    serialize: function() {
        // toolbar decorator se nebude serializovat (aspon automaticky ne)
        return this.getSlot('content').serialize();
    },
    getTree: function() {
        // skip the outer layer...
        return this.getSlot('content').getTree();
    },
    getTreeView: function(decorator) {
        // skip the outer layer...
        return this.getSlot('content').getTreeView(decorator);
    },
    _klass: "contextmenu-decorator thing",
    _type: "contextmenu-decorator",
    _defaults: {
        tools: {}
    } 
});


var Page = Decorator.extend({
    // options changed...
    refresh: function() {
        this.element.css({
          'width': this.options['width'],
          'height': this.options['height'],
          'background-size': 'cover',
          'background-image': 'url('+this.options['background_url']+')'
        })
    },
    _klass: "page decorator thing",
    _type: "page",
    _defaults: {
        'width': '500px',
        'height': '700px',
        'background_url': ''
    },
    _schema: {
       "type":"object",
       "description":"Page properties",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "height":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var Preview = Decorator.extend({
    // options changed...
    refresh: function() {
        this.element.css('width',this.options['width']);
        this.element.css('height',this.options['height']);
    },
    _klass: "preview decorator thing",
    _type: "preview",
    _defaults: {
        'width': '80px',
        'height': '110px',
        'label': 'preview',
        'description': ''
    },
    _schema: {
       "type":"object",
       "description":"Clock properties",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "height":{
             "type":"string",
             "required":true
          },
          "label":{
             "type":"string",
             "required":false
          },
          "description":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }
});


var OpacityDecorator = Decorator.extend({
    refresh: function() {
      this.base();
      this.element.css('opacity',this.options.opacity);
    },
    _klass: "opacity-decorator decorator thing",
    _type: "opacity-decorator",
    _defaults: {
        opacity: 0.8
    },
    _schema: {
       "type":"object",
       "description":"Clock properties",
       "properties":{
          "opacity":{
             "type":"number",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var InsetDecorator = Decorator.extend({
    refresh: function() {
	this.base();
        this.element.css('padding',this.options.top+'% '+this.options.right+"% "+this.options.bottom+"% "+this.options.left+"%");
    },
    _klass: "inset-decorator decorator thing",
    _type: "inset-decorator",
    _defaults: {
        top: 2,
        left: 2,
        right: 2,
        bottom: 2
    },
    _schema: {
	"type":"object",
	"$schema": "http://json-schema.org/draft-03/schema",
	"properties":{
		"bottom": {
			"type":"number",
			"id": "bottom",
			"required":true
		},
		"left": {
			"type":"number",
			"id": "left",
			"required":true
		},
		"right": {
			"type":"number",
			"id": "right",
			"required":true
		},
		"top": {
			"type":"number",
			"id": "top",
			"required":true
		}
	},
       "additionalProperties":true
    }

});



var ShadowDecorator = Decorator.extend({
    // options changed...
    refresh: function() {
	this.base();
        var br = this.options['h-shadow']+" "+this.options['v-shadow']+" "+this.options.blur+" "+this.options.spread+" "+this.options.color;
        this.element.css('box-shadow',br);
        this.element.css('-webkit-box-shadow',br);
    },
    _klass: "shadow-decorator decorator thing",
    _type: "shadow-decorator",
    _defaults: {
        'h-shadow': "5px",
        'v-shadow': "5px",
        blur: "5px",
        spread: "5px",
        color: "#666"
    },
    _schema: {
       "type":"object",
       "properties":{
          "h-shadow":{
             "type":"string",
             "required":true
          },
          "v-shadow":{
             "type":"string",
             "required":true
          },
          "blur":{
             "type":"string",
             "required":true
          },
          "spread":{
             "type":"string",
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          }
       },
       "additionalProperties":true
    }
});





var BackgroundDecorator = Decorator.extend({
    // options changed...
    refresh: function() {
        this.base();
        if(this.options['image']) 
            this.element.css('background-image','url("'+this.options['image']+'")');
        else 
            this.element.css('background-image','');
        this.element.css('background-position',this.options['position']);
        this.element.css('background-repeat',this.options['repeat']);
        this.element.css('background-color',this.options['color']);
        this.element.css('background-size',this.options['size']);
    },
    _klass: "background-decorator decorator thing",
    _type: "background-decorator",
    _defaults: {
        'image': "",
        'repeat': 'no-repeat',
        'position': 'center center',
        'color': 'white',
        'size': 'cover'
    },
    _schema: {
       "type":"object",
       "properties":{
          "image":{
             "type":"string",
             "format": "my-image-uri",
            // TODO vadi mu kdyz je to false - option se neda rozkliknout
             "required":true
          },
          "repeat":{
             "enum": ["repeat","no-repeat","repeat-x","repeat-y"],
             "type":"string",
             "required":true // TODO
          },
          "position":{
             "type":"string",
             "required":true // TODO
          },
          "size":{
             "type":"string",
             "enum": ["cover","contain"],
             "required":true // TODO
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true // TODO
          }
       },
       "additionalProperties":true
    }
});



// TODO sloucit nejak s rounded decoratorem
var BorderDecorator = Decorator.extend({
    // options changed...
    refresh: function() {
        this.base();
        this.element.css('border-width', this.options['width']);
        this.element.css('border-style',this.options['style']);
        this.element.css('border-color',this.options['color']);
    },
    _klass: "border-decorator decorator thing",
    _type: "border-decorator",
    _defaults: {
        'width': "1px",
        'style': 'solid',
        'color': 'black'
    },
    _schema: {
       "type":"object",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "style":{
             "type":"string",
             "enum": ["none","solid","dotted","dashed","double","groove","ridge","inset","outset"],
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var RoundedDecorator = BorderDecorator.extend({
    refresh: function() {
        this.base();
        var br = this.options.radius;
        // TODO individualne vsechny 4 rohy
        this.element.css('border-radius',br);
        this.element.css('-webkit-border-radius',br);
        this.element.css('-moz-border-radius',br);
    },
    _klass: "rounded-decorator decorator thing",
    _type: "rounded-decorator",
    _defaults: {
        'width': "1px",
        'style': 'solid',
        'color': 'black',
        radius: "5%"
    },
    _schema: {
       "type":"object",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "style":{
             "type":"string",
             "enum": ["none","solid","dotted","dashed","double","groove","ridge","inset","outset"],
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          },
          "radius":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }
});



var PageDecorator = Thing.extend({
    init: function() {
        this.base();
        this.pageContent = $("<div>").addClass("page-content").appendTo(this.element);
        this.pageInfo = $("<div>").addClass('page-info').appendTo(this.element);
        this.setSlot('content', Thing.empty());
    },
    // options changed...
    refresh: function() {
        // TODO text mask?
        this.base();
        if(this.options.showInfo) this.pageInfo.show(); else this.pageInfo.hide();
        this.pageInfo.text("Page "+this.options.pageNumber);
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.pageContent.html(value.get());
        return this;
    },
    _klass: "page-decorator thing",
    _type: "page-decorator",
    _defaults: {
        'showInfo' : false,
        'pageNumber': 2,
        'pagesTotal' : 3,
        'recordsTotal' : 10
    },
    _schema: {
       "type":"object",
       "properties":{
          "showInfo":{
             "type":"boolean",
             "required":true
          },
          "pageNumber":{
             "type":"integer",
             "required":true
          },
          "pagesTotal":{
             "type":"integer",
             "required":true
          },
          "recordsTotal":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var CenteringDecorator = Thing.extend({
    init: function() {
        this.inner = $("<div>").addClass('content-inner').appendTo(
            $("<div>").addClass('center3').appendTo(
                $("<div>").addClass('center2').appendTo(
                    this.element
                )
            )
        );
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.inner.html(value.get());
        return this;
    },
    // options changed...
    refresh: function() {
        this.base();
        this.element.css('text-align',this.options['x-align']);
        this.element.children(".center2").css('vertical-align',this.options['y-align']);
        this.inner.css('width',this.options['content-width']);
        this.inner.css('height',this.options['content-height']);
    },
    _klass: "centering-decorator decorator thing",
    _type: "centering-decorator",
    _defaults: {
        'x-align': "center",
        'y-align': 'center',
        'content-width': '',
        'content-height': ''
    },
    _schema: {
       "type":"object",
       "properties":{
          "x-align":{
             "enum": ["left","center","right"],
             "type":"string",
             "required":true // TODO
          },
          "y-align":{
             "enum": ["top","middle","bottom"],
             "type":"string",
             "required":true // TODO
          },
          "content-width":{
             "type":"string",
             "required":true // TODO
          },
          "content-height":{
             "type":"string",
             "required":true // TODO
          }
       },
       "additionalProperties":true
    }
});



var RefDecorator = Thing.extend({
    init: function() {
        this._content = $("<div>").addClass("mykkro-ref-decorator-content")
        this._control = $("<a>").addClass('ref-link mykkro-ref-decorator-control')
        this._tooltip = $("<div>").addClass("hidden ref-tooltip")
        this.element.append(
            this._content,
            this._tooltip,
            this._control
        )
        this._control.qtip({content: { text: this._tooltip } })
        this.setSlot('content', Thing.empty())
    },
    refresh: function() {
        this.base()
        var label = this.options.label || "?"
        var src = this.options.source
        this._tooltip.empty().append($("<p>").text(__("Originally from:")))
        // TODO tohle nejak blbne...
        //if(Common.isValidUrl(src)) {
        if(src.startsWith("http")) {
            this._tooltip.append(
                $("<p>").append($("<a>").attr("href", src).text(src))
            )
            this._control.text(label).attr("href", src)
        } else {
            this._tooltip.append(
                $("<p>").text(src)
            )
            this._control.text(label).attr("href", "#").click(function() { return false;})
        }
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this._content.html(value.get());
        return this;
    },
    showToolbar: function() {
        this.options.hidden = false;
        this.refresh();
    },
    hideToolbar: function() {
        this.options.hidden = true;
        this.refresh();
    },
    /*
    serialize: function() {
        return this.getSlot('content').serialize();
    },
    */
    // pouziva se toto nekde?
    getTree: function() {
        // skip the outer layer...
        return this.getSlot('content').getTree();
    },
    /* ref decorator won't be editable */
    getTreeView: function(decorator) {
        // skip the outer layer...
        return this.getSlot('content').getTreeView(decorator);
    },
    _klass: "ref-decorator thing",
    _type: "ref-decorator",
    _defaults: {
        label: null,
        source: "http://www.google.com"
    },
    _schema: {
       "type":"object",
       "properties":{
          "label":{
             "type":"string",
             "required":false
          },
          "source":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }

});


var RefList = Thing.extend({
    init: function() {
      this.element.empty()
      this.element.append($("<p>").text(__("References")))
    },
    refresh: function() {
        this.base();
    },
    // refs = array of ref decorator objects
    setReferences: function(refs) {
      this.element.empty()
      this.element.append($("<p>").text(__("References")))
      var list = $("<ul>").appendTo(this.element)
      if(refs) {
        for(var i=0; i<refs.length; i++) {
          list.append(this.makeReference(refs[i], i))
        }
      } else {
        this.element.append($("<p>").text(__("No references found.")))
      }
    },
    makeReference: function(ref, index) {
      return $("<li>").append(
        $("<span>").addClass("ref-link").text(index+1),
        $("<span>").addClass("ref-label").text(ref.options.source)
      )
    },
    _klass: "ref-list thing",
    _type: "ref-list",
    _defaults: {
    },
    _schema: {
       "type":"object",
       "description":"References List properties",
       "properties":{
       },
       "additionalProperties":true
    }

});


var Ajax = Decorator.extend({
    init: function() {
        this.loaded($.noop);
        this.received(function(data) { return data; });
        this.transform(function(data) { return Thing.create(data); })
        this.base();
        this.reload();
    },
    reload: function() {
        var url = this.options.url;
        var self = this;
        if(url) {
            $.ajax({
              url: url,
              dataType: 'json',
              //data: data,
              success: function(data) {
                var thing = self.transform(self.received(data));
                self.setSlot('content', thing);
                self.loaded(thing);
              },
              error: function(jqXHR, textStatus, errorThrown) {
                // TODO dat tam misto toho chyb. panel
                alert("AJAX failed! "+textStatus);
              }
            });
        }
        if(this.options.reloadInterval) {
            var fun = function() { self.reload(); };
            setTimeout(fun, 1000*this.options.reloadInterval);
        }
    },
    loaded: function(arg) {
        if(typeof arg == 'function') {
            this.onloaded = arg;
        } else {
            return this.onloaded(arg);
        }
    },
    received: function(arg) {
        if(typeof arg == 'function') {
            this.onreceive = arg;
        } else {
            return this.onreceive(arg);
        }
    },
    transform: function(arg) {
        if(typeof arg == 'function') {
            this.ontransform = arg;
        } else {
            return this.ontransform(arg);
        }
    },
    _klass: "ajax thing",
    _type: "ajax",
    _defaults: {
        url: '', //"testing/thing.json",
        reloadInterval: 0 //60 // in seconds
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "reloadInterval": {
			    "type":"integer",
			    "required":true
		    },
		    "url": {
			    "type":"string",
			    "id": "url",
                "format": "uri",
			    "required":true
		    }
	    }
    }
});




var AjaxPager = Thing.extend({
    init: function() {
        var self = this;
        this.base();
        this.page = new Ajax();
        this.page.received(function(data) { return self._dataReceived(data);});
        this.page.transform(function(data) { return self._dataTransform(data);});
        this.page.loaded(function(ajax) {self._pageLoaded(ajax);});
        this.page.get().appendTo(this.element);
        this.createControls();
        this.setPage(this.options.page);
    },
    createControls: function() {
        this.pagerControls = $("<div>").addClass('pager-controls');
        if(!this.options.disablePagerControl) this.pagerControls.appendTo(this.element);
    },
    refreshView: function() {
        this.setPage(this.options.page);
    },
    setPage: function(num) {
        this.options.page = num;
        var url = null;
        if(this.options.page && this.options.baseUrl) {
            url = this.getPageUrl(this.options.page);
            this.page.options.url = url;
            this.page.reload();
        } else {
            // signal error
        }
    },
    getPageUrl: function(page) {
        return this.options.baseUrl + page + ".json";
    },
    // muzeme podedit pokud potrebujeme jine chovani, transformaci dat aj.
    _dataReceived: function(data) {
        return data;
    },
    _dataTransform: function(data) {
        return Thing.create(data);
    },
    _pageLoaded: function(ajax) {
        this.pagerControls.empty();
        if(ajax instanceof PageDecorator) {
            // rebuild page controls
            this._buildPageControls(ajax);
        }
    },
    _buildPageControls: function(paged) {
        // TODO udelat PagerControls jako Thing
        // stranky jsou cislovany od jedne, nejmensi cislo je 1
        var o = paged.options;
        if(o.pageNumber>1) {
            // add first link
            this.pagerControls.append(this._makePageLink(1, "first"));
        }
        if(o.pageNumber>1) {
            // add previous link
            this.pagerControls.append(this._makePageLink(o.pageNumber-1, "previous"));
        }
        this.pagerControls
            .append($("<span>").text(__("Page")+" "+o.pageNumber+" "+__("from")+" "+o.pagesTotal));        
        if(o.pageNumber<o.pagesTotal) {
            // add previous link
            this.pagerControls.append(this._makePageLink(o.pageNumber+1, "next"));
        }
        if(o.pageNumber<o.pagesTotal) {
            // add first link
            this.pagerControls.append(this._makePageLink(o.pagesTotal, "last"));
        }
    },
    _makePageLink: function(pageno, type) {
        var self = this;
        return $('<a href="#">').text(type).click(function() {
            self.setPage(pageno);
            return false;
        });
    },
    _klass: "ajax-pager thing",
    _type: "ajax-pager",
    _defaults: {
        baseUrl: '',// 'testing/multi/',
        page: 1,
        disablePagerControl: false
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "page": {
			    "type":"integer",
			    "required":true
		    },
		    "url": {
			    "type":"string",
			    "id": "url",
                "format": "uri",
			    "required":true
		    }
	    }
    }
});


var Layout = Thing.extend({
    _klass: "layout thing",
    _type: "layout"
});









var Slot = Base.extend({
    constructor: function(parent, name) {
        this.name = name;
        this.parent = parent;
        this.element = $("<div>").addClass("mykkro-slot").attr('data-name', name);
        this.thing = null;
    },
    empty: function() {
        this.element.empty();
        this.thing = null;
    },
    set: function(thing) {
        this.element.empty().append(thing.get());
        this.thing = thing;
    },
    get: function() {
        return this.thing;
    }
});


// TODO metody na prohazovani elementu - move to front/back, move up, move down
// TODO metody insert/delete?
// TODO -> DynamicLayout
var GrowableLayout = Layout.extend({
    init: function() {
        this.cells = []; // v tomto poradi budou v this.element!
        this.cellMap = {}; 
    },
    // remove all slots
    // TODO obsolete, use removeSlots instead
    clear: function() {
        this.element.empty();
        this.cells = [];
        this.cellMap = {};
    },
    length: function() {
        return this.cells.length;
    },
    first: function() {
        return this.cells.length ? this.cells[0] : undefined;
    },
    last: function() {
        return this.cells.length ? this.cells[this.cells.length-1] : undefined;
    },
    nth: function(ndx) {
        return (ndx>=0 && ndx<this.cells.length) ? this.cells[ndx] : undefined;
    },
    isEmpty: function() {
        return this.cells.length;
    },
    // dynamically add slot
    add: function(thing) {        
        var ndx = this.cells.length;
        var slot = new Slot(this, ndx);
        slot.element.appendTo(this.element);
        this.cells.push(slot);
        this.cellMap[ndx] = slot;
        this.setSlot(ndx, thing);
        return slot;
    },
    setSlot: function(key, value) {
        // TODO implement hasSlot
        this.base(key, value);
        this.cellMap[key].set(value);
        return this;
    },
    removeSlots: function() {
        // remove slot content...
        this.clearSlots(); 
        // remove slots proper...
        this.element.empty();
        this.slots = {};
        this.cells = [];
        this.cellMap = {};
    },
    setSlots: function(slots) {
        // remove existing slots...
        this.removeSlots();
        if(slots) {
            // pokud je parametr pole, udelat z nej objekt
            if($.isArray(slots)) slots = slots.toObject();
            for(var key in slots) {
                this.add(slots[key]);
            }
        }
    },
    _klass: "growable-layout layout thing",
    _type: "growable-layout",
    _defaults: {
        "css": "" //"mykkro-flow-layout"
    },
    _schema: {
       "type":"object",
       "properties":{
          "css":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }
});



// TODO metody na prohazovani elementu - move to front/back, move up, move down
// TODO metody insert/delete?
// TODO -> DynamicLayout
// TODO ze by se to poradi slotu dalo ulozit?
var OrderableLayout = GrowableLayout.extend({
    init: function() {
        this.cells = []; // v tomto poradi budou v this.element!
        this.cellMap = {}; 
    },
    // what muze byt Slot nebo Thing
    getSlotIndex: function(what) {
        if(what && typeof what === 'object') {
            for(var i=0; i<this.cells.length; i++) {
                if(this.cells[i] == what || this.cells[i].get() == what) return i;
            }
            return -1;
        } else {
            if(what>=0 && what < this.cells.length) return what;
            return -1;
        }
    },
    moveSlotUp: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>0) {
            // swap slots 'i-1' and 'i'
            this.swapSlots(slot-1, slot);
        }
    },
    moveSlotDown: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>=0 && slot<this.cells.length-1) {
            // swap slots 'i' and 'i+1'
            this.swapSlots(slot, slot+1);
        }
    },
    moveSlotToTop: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>0) {
            this.swapSlots(0, slot);
        }
    },
    moveSlotToBottom: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>=0 && slot<this.cells.length-1) {
            this.swapSlots(slot, this.cells.length-1);
        }
    },
    swapSlots: function(slot1, slot2) {
        slot1 = this.getSlotIndex(slot1);
        slot2 = this.getSlotIndex(slot2);
        if(slot1 != slot2) {
            // prohodit to v DOM...
            this.cells[slot1].element.swap(this.cells[slot2].element);
            var tmp = this.cells[slot1];
            this.cells[slot1] = this.cells[slot2];
            this.cells[slot2] = tmp;
        }
    },
    shuffle: function() {
        var len = this.cells.length;
        for (var i = len-1; i >=0; i--) {
            var randomIndex = Math.floor(Math.random()*(i+1)); 
            this.swapSlots(randomIndex, i);
        }
    },
    remove: function(what) {        
        var ndx = this.getSlotIndex(what);
        if(ndx>=0) {
            var slot = this.cells[ndx];
            this.cellMap[slot.name] = null;
            // remove from array
            this.cells.remove(ndx);
            // remove from DOM
            slot.element.remove();
            this.refresh();
        }
    },
    _klass: "orderable-layout growable-layout layout thing",
    _type: "orderable-layout",
    _defaults: {
        "css": "" //"mykkro-flow-layout"
    },
    _schema: {
       "type":"object",
       "properties":{
          "css":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }
});



var PreviewPager = AjaxPager.extend({
    constructor: function(options, callback) {
        this.base(options); // baseUrl, query, includePublic, allTags, disableSearchBox
        this.onselected = callback || $.noop;
    },
    createControls: function() {
        this.base();
        var self = this
        var changer = function() {
            self.refreshView()
        }
        this.searchBox = $('<input type="text" name="sf-text" class="search rounded" placeholder="Search...">').attr("value", this.options.query).on("change keyup paste", changer)
        this.publicCBox = $('<input type="checkbox" name="sf-public">').prop('checked', this.options.includePublic).change(changer)
        this.allCBox = $('<input type="checkbox" name="sf-all">').prop("checked", this.options.allTags).change(changer)
        if(!this.options.disableSearchBox) {
            var sc = $("<div>")
                .addClass('search-controls')
                .appendTo(this.element)
                .append(
                    $('<label>').append(this.searchBox), 
                    $('<label>').append(this.publicCBox, $('<span>Include public content</span>')),
                    $('<label>').append(this.allCBox, $('<span>Use all tags</span>'))
                );
        }
    },
    getPageUrl: function(page) {
        var text = encodeURIComponent(this.searchBox.val())
        var publ = this.publicCBox.is(':checked') ? 'true' : 'false'
        var all = this.allCBox.is(':checked') ? 'true' : 'false'
        return this.base(page) + "?public="+publ+"&text="+text+"&all="+all
    },
    _dataReceived: function(data) {
        return data;
    },
    _dataTransform: function(data) {
        var self = this;
        var ol = new OrderableLayout({"css":"mykkro-flow-layout"});
        for(var i=0; i<data.items.length; i++) {
            var thing = Thing.create(data.items[i].preview);
            var clickable = new Clickable({tooltip: data.items[i].title});
            clickable.setSlot('content', thing);
            (function() {
                var url = data.items[i].url;
                clickable.click(function() {
                    self._selected(url);
                });
/*
                // TODO settings - otevre formular
                // Thing ma definovane schema pro validaci options
                var st = makeSettingsToolbar(function(){
                    // change thing's settings
                    self._selected(url, true);
                });
                st.setSlot('content', clickable);
                ol.add(st);
*/
                ol.add(clickable);
            })();
        }
        var pd = new PageDecorator({
            'pageNumber': data.page,
            'pagesTotal' : data.pagesTotal,
            'recordsTotal' : data.itemsTotal            
        });
        pd.setSlot('content', ol);
        return pd;
    },
    _selected: function(url, editSettings) {
        var self = this;
         $.ajax({
              url: url,
              dataType: 'json',
              //data: data,
              success: function(data) {
                   console.log("Selected:")
                   console.log(data)
                  if(editSettings) {
                     // ziskat schema, zobrazit formular, nastavit data.options                    
                  }
                  var thing = Thing.create(data);
                  self.onselected(thing);
              }
          });
    },
    _type: "preview-pager"
}, {
    choose: function(type, callback, options) {
        options = options || {}
	    var mm = {};
        var url = baseUrl+'api/pagedpreviews/'+type+'/';
        var ap = new PreviewPager($.extend({baseUrl:url}, options), function(thing) { 
            mm.modal.close();
            if(callback) callback(thing);
        });
        /**/options.resizable = false/**/
        mm.modal = Modal.show(ap, options);
    }
});


// TODO vertical split
var SplitLayout = Layout.extend({
    init: function() {
        this.first = $("<div>");
        this.second = $("<div>");
        this.element.append(this.first).append(this.second);
        this.setSlot('first', Thing.empty());
        this.setSlot('second', Thing.empty());
    },
    // options changed...
    refresh: function() {
        this.base();
        var first = this.options.ratio + "%";
        var gap = this.options.gap + "%";
        var xx = (this.options.ratio + this.options.gap) + "%";
        var second = (100 - this.options.ratio - this.options.gap) + "%";
        if(this.options.horizontal) {
            this.first.css("left","0px").css("top","0px").css("width",first).css('height','100%');
            this.second.css("left",xx).css("top","0px").css("width",second).css('height','100%');
        } else {
            this.first.css("left","0px").css("top","0px").css("height",first).css('width','100%');
            this.second.css("left","0px").css("top",xx).css("height",second).css('width','100%');
        }
    },
    setSlot: function(key, value) {
        // TODO implement hasSlot
        this.base(key, value);
        if(key=='first') {
            this.first.empty().append(value.get());
        }
        if(key=='second') {
            this.second.empty().append(value.get());
        }
        return this;
    },
    _klass: "split-layout layout thing",
    _type: "split-layout",
    _defaults: {
        ratio: 70, // v %
        gap: 2, // v %
        horizontal: false
    },
    _schema: {
       "type":"object",
       "properties":{
          "horizontal":{
             "type":"boolean",
             "required":true
          },
          "ratio":{
             "type":"integer",
             "required":true
          },
          "gap":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});



var GridLayout = Layout.extend({
    init: function() {
        // TODO create grid and slots
        this.cellCount = 0;
        this.cells = {};
        for(var i=0; i<this.options.rows; i++) {
            for(var j=0; j<this.options.columns; j++) {
                // create slot
                this.cells[this.cellCount] = $("<div>").appendTo(this.element);                
                // set slot value
                this.setSlot(this.cellCount, Thing.empty());
                this.cellCount++;
            }
        }
    },
    // options changed...
    refresh: function() {
        this.base();
        var gap = this.options.gap;
        var cols = this.options.columns;
        var rows = this.options.rows;
        if(cols*rows != this.cellCount) {
          // resize grid...
          if(cols*rows < this.cellCount) {
            // truncate array...
            while(this.cellCount > rows*cols) {
                this.cellCount--;
                this.removeSlot(this.cellCount)
            }
          } else {
            // expand array by adding new elements
            while(this.cellCount<rows*cols) {
                // create slot
                this.cells[this.cellCount] = $("<div>").appendTo(this.element);                
                // set slot value
                this.setSlot(this.cellCount, Thing.empty());
                this.cellCount++;
            }
          }          
        }
        var ww = Math.round(10*(100 - (cols-1)*gap)/cols)/10;
        var hh = Math.round(10*(100 - (rows-1)*gap)/rows)/10;
        var xx = 0;
        var yy = 0;
        var ndx = 0;
        for(var i=0; i<rows; i++) {
            for(var j=0; j<cols; j++) {
                this.cells[ndx].css({
                    "width": ww+"%",
                    "height": hh+"%",
                    "left": xx+"%",
                    "top": yy+"%"
                });
                ndx++;
                xx += ww + gap;
            }
            xx = 0;
            yy += hh + gap;
        }
    },
    setSlot: function(key, value) {
        if(!!this.cells[key]) {
          this.base(key, value);
          this.cells[key].empty().append(value.get());
        }
        return this;
    },
    removeSlot: function(key) {
        if(this.hasSlot(key)) {
          this.cells[key].remove()
          delete this.cells[key]                
          this.base(key);
        }
    },
    _klass: "grid-layout layout thing",
    _type: "grid-layout",
    _defaults: {
        rows: 3, // nemelo by se menit za behu
        columns: 3, // nemelo by se menit za behu
        gap: 2 // v procentech
    },
    _schema: {
       "type":"object",
       "properties":{
          "rows":{
             "type":"integer",
             "required":true
          },
          "columns":{
             "type":"integer",
             "required":true
          },
          "gap":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});



var SwitchLayout = GrowableLayout.extend({
    refresh: function() {
        this.base();
        var index = parseInt(this.options.index)+1;
        this.element.children().hide();
        this.element.find("div:nth-child("+index+")").show();
    },
    setIndex: function(ndx) {
        this.options.index = ndx;
        this.refresh();
    },
    add: function(thing) {
        var slot = this.base(thing);
        this.refresh();
        return slot;
    },
    _klass: "switch-layout growable-layout layout thing",
    _type: "switch-layout",
    _defaults: {
        "css": "", //"mykkro-flow-layout"
        index: 0
    },
    _schema: {
       "type":"object",
       "properties":{
          "css":{
             "type":"string",
             "required":false
          },
          "index":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var Book = GrowableLayout.extend({
    currentPage: 0,
    init: function() {
        this.base();
        console.log("Book created")
        console.log(this)
    },
    refresh: function() {
        this.base();
    },
    // TODO tohle se muze zavolat jen pokud jsou stranky uz vlozena do DOMu
    makeDisplay: function() {
        var self = this;
	    // kniha = <div class="mykkro-book> <div class="mykkro-slot"> .. </div>
	    this.element.addClass(this.options.display);
	    switch(this.options.display) {
	      case 'basic':
	        // add page numbers...
	        break;
	      case "turnable":
	        this.element.turn({gradients: true, acceleration: true});
            this.element.bind("start", function(ev, pageObject, corner) { 
                self.onTurnStart(ev, pageObject, corner); })
            this.element.bind("turning", function(ev, page, pageObject) { 
                self.onTurning(ev, page, pageObject); })
            this.element.bind("turned", function(ev, page, view) { 
                self.onTurned(ev, page, view); })
            this.element.bind("end", function(ev, pageObject, turned) { 
                self.onTurnEnd(ev, pageObject, turned); })
	        break;
	    }
    },
    _setPage: function(page) {
        if(!this.currentPage) {
            // page 1 became visible
            this.onPageVisibilityChange(page, true);
        }
        else if(this.currentPage>>1 == page>>1) {
            // je videt porad stejna dvoustrana
        } else {            
            // visibility changed
            var oldPages = 2*(Math.floor(this.currentPage / 2));
            var newPages = 2*(Math.floor(page / 2));
            this.onPageVisibilityChange(oldPages, false);
            this.onPageVisibilityChange(oldPages+1, false);
            this.onPageVisibilityChange(newPages, true);
            this.onPageVisibilityChange(newPages+1, true);
        }
        this.currentPage = page;
        // notifikovat stranky pokud se jejich viditelnost zmenila
        this.onPageChange(page);
    },
    // TODO udelat si na to taky bind funkci
    onPageVisibilityChange: function(page, visible) {
        if(typeof(page)=='function') this._onPageVisibilityChange = page;  
        else {
            // mame takovou stranku?
            var name = page-1;
            if(this.slots[name]) {
                this._updatePageVisibility(page, visible);
                if(this._onPageVisibilityChange) this._onPageVisibilityChange(page, visible);
            }
        }
    },
    _updatePageVisibility: function(page, visible) {
        // pri zviditelneni musim refereshnout vsechny audio-decoratory a video-thingy
        // pri zneviditelneni vypnout jejich playback
        //log("Page: "+page+" visibility: "+visible);
        var name = page-1;
        var thing = this.slots[name];
        var media = [];
        thing.findSlotsByType('audio-decorator', media);
        thing.findSlotsByType('video-thing', media)
        //log(audio.length+","+video.length);
        if(visible) {
            // page became visible...
            for(var i=0; i<media.length; i++) {
                media[i].refresh();
                if(media[i].options['autoplay']) {
                    media[i].play();
                }
            }
        } else {
            // TODO stop only if playing...
            for(var i=0; i<media.length; i++) media[i]._kill();
        }
    },
    onPageChange: function(ev) {
        if(typeof(ev)=='function') this._onPageChange = ev;  
        else {
            if(this._onPageChange) this._onPageChange(ev);
        }
    },
    onInit: function(ev) {
        if(typeof(ev)=='function') this._onInit = ev;  
        else {
            this._setPage(1);
            if(this._onInit) this._onInit();
        }
    },
    onExit: function(ev) {
        if(typeof(ev)=='function') this._onExit = ev;  
        else {
            if(this._onExit) this._onExit();
        }
    },
    onTurnStart: function(ev, pageObject, corner) {
        if(typeof(ev)=='function') this._onTurnStart = ev;  
        else {
            if(this._onTurnStart) this._onTurnStart(ev, pageObject, corner);
        }
    }, 
    onTurning: function(ev, page, pageObject) {
        if(typeof(ev)=='function') this._onTurning = ev;  
        else {
            if(this._onTurning) this._onTurning(ev, page, pageObject);
        }
    }, 
    onTurned: function(ev, page, view) { 
        if(typeof(ev)=='function') this._onTurned = ev;  
        else {
            this._setPage(page);
            if(this._onTurned) this._onTurned(ev, page, view);
        }
    }, 
    onTurnEnd: function(ev, pageObject, turned) { // nefunguje
        if(typeof(ev)=='function') this._onTurnEnd = ev;  
        else {
            if(this._onTurnEnd) this._onTurnEnd(ev, pageObject, corner);
        }
    }, 
    _klass: "book growable-layout layout thing",
    _type: "book",
    _defaults: {
        "title": "My Book",
	    "display": "basic"
    },
    _schema: {
       "type":"object",
       "properties":{
          "title":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var Quest = Thing.extend({
    init: function() {
        this.status = 'active';
        this.finished($.noop);
    },
    refresh: function() {
        this.base();
        //this.inner.html(this.options.html).attr('class',this.options.innerCss);
    },
    finished: function(arg) {
        if(typeof arg == 'function') {
            this.onfinished = arg;
        } else {
            return this.onfinished(arg);
        }
    },
    pass: function() {
        this.status = 'passed';
        this.finished({'quest':this, 'status':this.status});
    },
    fail: function() {
        this.status = 'failed';
        this.finished({'quest':this, 'status':this.status});
    },
    _klass: "quest thing",
    _type: "quest",
    _defaults: {
        //html: ""
    },
    _schema: {
       "type":"object",
       "description":"Quest properties",
       "properties":{
/*
          "html":{
             "type":"string",
             "required":true
          },
          "css":{
             "type":"string",
             "required":false
          },
          "innerCss":{
             "type":"string",
             "required":false
          }
*/
       },
       "additionalProperties":true
    }

});

var DemoQuest = Quest.extend({
    init: function() {
        this.base();
        var self = this;
        this.passButton = $("<button>").text("Pass").click(function() { self.pass(); }).appendTo(this.element);
        this.failButton = $("<button>").text("Fail").click(function() { self.fail(); }).appendTo(this.element);
        this.statusBar = $("<span>").appendTo(this.element);
        this.statusBar.text('active');
    },
    pass: function() {
        this.statusBar.text('passed');
        this.passButton.prop('disabled', true);
        this.failButton.prop('disabled', true);
        this.base();
    },
    fail: function() {
        this.statusBar.text('failed');
        this.passButton.prop('disabled', true);
        this.failButton.prop('disabled', true);
        this.base();
    },
    _klass: "demo-quest quest thing",
    _type: "demo-quest",
    _defaults: {
        //html: ""
    },
    _schema: {
       "type":"object",
       "description":"Demo Quest properties",
       "properties":{
/*
          "html":{
             "type":"string",
             "required":true
          },
          "css":{
             "type":"string",
             "required":false
          },
          "innerCss":{
             "type":"string",
             "required":false
          }
*/
       },
       "additionalProperties":true
    }

});

var PlayerControls = Thing.extend({
    _onplay: $.noop,
    _onpause: $.noop,
    _onstop: $.noop,
    init: function() {
        var self = this;
        var cont = $("<div>").addClass('controls').appendTo(this.element);
        this._playBtn = $("<button>")
            .addClass("play").append($("<span>").text("Play"))
            .appendTo(cont).click(function() { self.onPlay(); });
        this._pauseBtn = $("<button>")
            .addClass("pause").append($("<span>").text("Pause"))
            .appendTo(cont).click(function() { self.onPause(); });
        this._stopBtn = $("<button>")
            .addClass("stop").append($("<span>").text("Stop"))
            .appendTo(cont).click(function() { self.onStop(); });
        this.controls = cont;
        this.playing = false;
        this.paused = false;
    },
    refresh: function() {
        this.base();
        this.controls.toggleClass('playing', this.playing);
        this._playBtn.prop('disabled', this.playing);
        this._pauseBtn.prop('disabled', !this.playing);
        this._stopBtn.prop('disabled', !(this.playing/* || this.paused*/));    
        if(this.playing) {
            this._playBtn.hide();
            this._pauseBtn.show();
        } else {
            this._playBtn.show();
            this._pauseBtn.hide();
        }        
        if(this.playing/* || this.paused*/) {
            this._stopBtn.show();
        } else {
            this._stopBtn.hide();
        }
    },
    updateGui: function(playing, paused) {
        this.playing = playing;
        this.paused = paused;
        this.refresh();
    },
    onPlay: function(kb) {
        if(typeof kb == 'function') {
            this._onplay = kb;
        } else {
            this.updateGui(true, false);
            this._onplay(kb);
        }
    },
    onPause: function(kb) {
        if(typeof kb == 'function') {
            this._onpause = kb;
        } else {
            this.updateGui(false, true);
            this._onpause(kb);
        }
    },
    onStop: function(kb) {
        if(typeof kb == 'function') {
            this._onstop = kb;
        } else {
            this.updateGui(false, false);
            this._onstop(kb);
        }
    },
    _klass: "player-controls thing",
    _type: "player-controls",
    _defaults: {
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
	    }
    }
});


var AudioDecorator = Thing.extend({
    _onplay: $.noop,
    _onpause: $.noop,
    _onstop: $.noop,
    _onkill: $.noop,
    onPlay: function(kb) {
        if(typeof kb == 'function') {
            this._onplay = kb;
        } else {
            this._onplay(kb);
        }
    },
    onPause: function(kb) {
        if(typeof kb == 'function') {
            this._onpause = kb;
        } else {
            this._onpause(kb);
        }
    },
    onStop: function(kb) {
        if(typeof kb == 'function') {
            this._onstop = kb;
        } else {
            this._onstop(kb);
        }
    },
    onKill: function(kb) {
        if(typeof kb == 'function') {
            this._onkill = kb;
        } else {
            this._onkill(kb);
        }
    },
    init: function() {
        this.slot = $("<div>").addClass("slot");
        this.setSlot('content', Thing.empty());
    },
    play: function() {
        this._play();
        this.player.updateGui(true, false);
    },
    _play: function() {
        this.audio.get(0).play();
        this.onPlay();
    },
    _pause: function() {
        this.audio.get(0).pause();
        this.onPause();
    },
    _stop: function() {
        // regenerate player...
        this.refresh();
        this.onStop();
    },
    _kill: function() {
        this.audio.get(0).pause();
        this.audio.get(0).src = "";
        this.onKill();
    },
    _setVolume: function(vol) {
        // HTML5 volume is between 0 and 1
        this.audio.get(0).volume = vol / 100.0;
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.slot.html(value.get());
        return this;
    },
    _addSource: function(uri, type) {
        if(uri) $("<source>").attr({src:uri, type: type, preload: false/**/}).appendTo(this.audio);
    },
    refresh: function() {
        this.base();
        var self = this;
        this.audio = $("<audio>");
        this.player = new PlayerControls();  
        this.player.onPlay(function() { self._play(); });
        this.player.onPause(function() { self._pause(); });
        this.player.onStop(function() { self._stop(); });
        var cc = new CenteringDecorator({},{content: this.player});
        this.pane = cc.get();
        this.pane.addClass("player");
        this.element.empty()
            .append(this.slot)
            .append(this.pane)
            .append(this.audio);

        // incorrect... and unnecessary: this.audio.remove("source");
        this.audio.prop('loop', this.options.loop);
        if(this.options.uri) {            
            var ext = this.options.uri.split('.').pop();
            this.options.ogg = (ext == 'ogg') ? this.options.uri : '';
            this.options.mp3 = (ext == 'mp3') ? this.options.uri : '';
        }
        this._addSource(this.options.ogg, 'audio/ogg; codecs="vorbis"');
        this._addSource(this.options.mp3, 'audio/mpeg; codecs="mp3"');
        // HTML5 volume is between 0 and 1
        this._setVolume(this.options.volume);
    },
    _klass: "audio-decorator decorator thing",
    _type: "audio-decorator",
    _defaults: {
        'ogg': "",
        'mp3': "",
        'uri': "",
        'autoplay': false,
        'loop': false,
        'volume': 50
    },
    _schema: {
       "type":"object",
       "properties":{
          "uri":{
             "type":"string",
             "format": "my-voice-uri",
            // TODO vadi mu kdyz je to false - option se neda rozkliknout
             "required":true
          },
          "volume":{
             "type":"integer",
             "required":true // TODO
          },
          "autoplay":{
             "type":"boolean",
             "required":true // TODO
          },
          "loop":{
             "type":"boolean",
             "required":true // TODO
          }
       },
       "additionalProperties":true
    }
});



var VideoThing = Thing.extend({
    _onplay: $.noop,
    _onpause: $.noop,
    _onstop: $.noop,
    _onkill: $.noop,
    onPlay: function(kb) {
        if(typeof kb == 'function') {
            this._onplay = kb;
        } else {
            this._onplay(kb);
        }
    },
    onPause: function(kb) {
        if(typeof kb == 'function') {
            this._onpause = kb;
        } else {
            this._onpause(kb);
        }
    },
    onStop: function(kb) {
        if(typeof kb == 'function') {
            this._onstop = kb;
        } else {
            this._onstop(kb);
        }
    },
    onKill: function(kb) {
        if(typeof kb == 'function') {
            this._onkill = kb;
        } else {
            this._onkill(kb);
        }
    },
    init: function() {
    },
    play: function() {
        this._play();
        this.player.updateGui(true, false);
    },
    _play: function() {
        this.video.get(0).play();
        this.onPlay();
    },
    _pause: function() {
        this.video.get(0).pause();
        this.onPause();
    },
    _stop: function() {
        //this.video.get(0).pause();
        //this.video.get(0).currentTime = 0;
        // regenerate player...
        this.refresh();  // TODO udelat to lepe
        this.onStop();
    },
    _kill: function() {
        this.video.get(0).pause();
        this.video.get(0).src = "";
        this.onKill();
    },
    _setVolume: function(vol) {
        // HTML5 volume is between 0 and 1
        this.video.get(0).volume = vol / 100.0;
    },
    _addSource: function(uri, type) {
        if(uri) {
            $("<source>").attr({src:uri, type: type, preload: false/**/}).appendTo(this.video);
        }
    },
    refresh: function() {
        this.base();
        var self = this;
        this.video = $("<video>");
        this.player = new PlayerControls();  
        this.player.onPlay(function() { self._play(); });
        this.player.onPause(function() { self._pause(); });
        this.player.onStop(function() { self._stop(); });
        var cc = new CenteringDecorator({},{content: this.player});
        this.pane = cc.get();
        this.pane.addClass("player");
        this.element.empty()
            .append(this.video)
            .append(this.pane);

        this.video.prop('loop', this.options.loop);
        if(this.options.uri) {            
            var ext = this.options.uri.split('.').pop();
            this.options.ogg = (ext == 'ogg' || ext == 'ogv') ? this.options.uri : '';
            this.options.mp4 = (ext == 'mp4') ? this.options.uri : '';
            this.options.webm = (ext == 'webm') ? this.options.uri : '';
        }
        this._addSource(this.options.ogg, 'video/ogg; codecs="theora, vorbis"');
        this._addSource(this.options.mp4, 'video/mp4; codecs="avc1.42E01E, mp4a.40.2"');
        this._addSource(this.options.webm, 'video/webm; codecs="vp8, vorbis"');
        ////this.video.get(0).src = this.options.uri;
        // TODO tohle nejak zlobi v Chrome, pri znovuvytvareni videi... ale ve FF to zda se funguje

        // HTML5 volume is between 0 and 1
        this._setVolume(this.options.volume);
        this.video.on('canplay canplaythrough', function(){
            console.log('canplay event fired');
        });
    },
    _klass: "video-thing thing",
    _type: "video-thing",
    _defaults: {
        "uri": "",
        'ogg': "",
        'mp4': "",
        'webm': "",
        'autoplay': false,
        'loop': false,
        'volume': 50
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "uri": {
			    "type":"string",
                "format": "my-video-uri",
			    "required":true
    	    },
            "volume":{
                "type":"integer",
                "required":true // TODO
            },
            "autoplay":{
                "type":"boolean",
                "required":true // TODO
            },
            "loop":{
                "type":"boolean",
                "required":true // TODO
            }
	    }
    }

});


/*

document.addEventListener('DOMContentLoaded', function(){
    var v = document.getElementById('vid');
    var canvas = document.getElementById('canvas');
    var context = canvas.getContext('2d');

    var cw = canvas.clientWidth;
    var ch = canvas.clientHeight;
    canvas.width = cw;
    canvas.height = ch;

    v.addEventListener('play', function(){
        draw(this,context);
    },false);

},false);

var mode = 'stretch';
function draw(v,c) {
    var canvas = document.getElementById('canvas');
    var w = canvas.clientWidth;
    var h = canvas.clientHeight;
    if(v.paused || v.ended) return false;
    if(mode == 'stretch') {
        c.drawImage(v,0,0,w,h); //-> stretch
    } else if(mode == 'cover') {
        // TODO tady je neco spatne
        var sx=0, sy=0, sw=v.width, sh=v.height;
        if(sw/sh < w/h) {
            sy = (sh - h*sw/w)/2;
            sh = h*sw/w;
        } else {
            sx = (sw - w*sh/h)/2;
            sw = w*sh/h;
        }
        c.drawImage(v,sx,sy,sw,sh,0,0,w,h); 
    } else { // contain
        var ww = v.width;
        var hh = v.height;
        var x = y = 0;
        if(ww/hh < w/h) {
            x = (w-ww*h/hh)/2;
            c.drawImage(v,x,0,ww*h/hh,h); 
        } else {
            y = (h-hh*w/ww)/2;
            c.drawImage(v,0,y,w,hh*w/ww); 
        }
    }
    setTimeout(draw,20,v,c);
}

<canvas id="canvas"></canvas>

*/

// TODO udelat z toho Thing
// TODO k ikonam pridat tooltipy

var BookViewer = Base.extend({
    constructor: function(options) {
        this.bookData = options.data;
        this.bookUrl = options.url;
        this.eventUrl = options.eventUrl;
        this.fullscreen = options.fullscreen;
        this.logger = options.logger;
        this.defaultWidth = 920;
        this.defaultHeight = 600;
        this.tools = {};
        this.bookContent = null;
        this.eventHistory = [];
        this.targetDiv = "#content"
    },
    makeIcon: function(icon, title) {
        return $("<div>").addClass('icon icon-48 icon-'+icon).css('display','inline-block').attr("title", title);
    },
    makeTool: function(icon, label, left/*bool*/, top, click) {
        this.tools[icon] = this.makeIcon(icon, label).css({position:'absolute', top: top}).css(left ? {'left':'6px'}:{'right':'6px'}).click(click).appendTo($("#book-wrapper"));
        return this.tools[icon];
    },
    showIcon: function(icon, enable) {
        if(enable) this.tools[icon].show() ; else this.tools[icon].hide();
    },
    turnNext: function() {
        this.bookContent.get().turn("next");
    },
    turnPrevious: function() {
        this.bookContent.get().turn("previous");
    },
    turnFirst: function() {
        this.bookContent.get().turn("page", 1);
    },
    goHome: function() {
        this.logEvent('book_close', this.bookUrl);
        window.location.href = this.bookUrl;
    },
    // v Chrome to nejak nefunguje...
    close: function() {
        this.logEvent('book_close', this.bookUrl);
        window.open('','_self','');
        window.close();
    },
    closeBook: function() {
        // normal viewer only turns to page 1
        this.turnFirst()
    },
    _setPageBackgrounds: function(bookContent, o) {
        var totalPages = bookContent.length()
        for(var i=0; i<totalPages; i++) {
            var slot = bookContent.nth(i)
            var elem = slot.element
            var css = { "background-size": "cover", "background-color": "white"}
            if(i==0) {
                // first page
                css["background-image"] = 'url('+o.frontpage_image_url+')'
            } else if(i == totalPages-1 && i%2!=0) {
                // last page, must be odd
                css["background-image"] = 'url('+o.backpage_image_url+')'
            } else if(i%2==0) {
                // even page
                css["background-image"] = 'url('+o.evenpage_image_url+')'
            } else {
                // odd page
                css["background-image"] = 'url('+o.oddpage_image_url+')'
            }
            elem.css(css)
        }
    },
    _makeWrapper: function(o) {
        return $("<div>")
            .attr("id", "book-wrapper")
            .css('position','relative')
            .css("background-image", 'url('+o.background_image_url+')')
    },
    _makeReferences: function(bookContent) {
        // gather references...
        var refs = [];
        bookContent.findSlotsByType('ref-decorator', refs);
        for(var i=0; i<refs.length; i++) {
            refs[i].options.label = (i+1)+""
            refs[i].refresh()
        }
        // TODO find reference-page layout and fill it by reference info...
        var reflists = [];
        bookContent.findSlotsByType('ref-list', reflists);
        // only the first will be used; later: we can split reference items into multiple ref lists
        if(reflists.length>0) {
            reflists[0].setReferences(refs);
        }
    },
    _monitorMediaEvents: function(bookContent) {
        // find audio and video Things and monitor their play, stop, pause, kill events
        var media = [];
        var self = this;
        bookContent.findSlotsByType('audio-decorator', media);
        bookContent.findSlotsByType('video-thing', media);
        for(var i=0; i<media.length; i++) {
            var m = media[i]; 
            var src = m.options.uri;           
            (function(){
                m.onPlay(function() { self.logEvent('book_media_play', src); });
                m.onPause(function() { self.logEvent('book_media_pause', src); });
                m.onStop(function() { self.logEvent('book_media_stop', src); });
                m.onKill(function() { self.logEvent('book_media_kill', src); });
            })();
        }
    },
    init: function() {
        /* display book... */
        var self = this;
        var width = this.defaultWidth;
        var height = this.defaultHeight;
        var o = this.bookData.options      
        // create wrapper...
        var wrapper = this._makeWrapper(o);
        wrapper.appendTo(this.targetDiv);
        this.bookContent = Thing.create(this.bookData, {"display":"turnable"});

        this._setPageBackgrounds(this.bookContent, o)
        this._makeReferences(this.bookContent)
        this._monitorMediaEvents(this.bookContent)
        
        // init book...
        this.bookContent.onInit();
        $("#book-wrapper").css({width:width+"px", height:height+"px"}).html(this.bookContent.get());
        this.bookContent.makeDisplay();

        // events...
        $(window).unload(function() {
            self.bookContent.onExit(); // TODO tohle mi nejak nefunguje...
        });
        $(window).resize(function() {
            if(self.fullscreen) {
                self.updateToolbar(self.recreate());
            }
        });
        $(window).bind("fullscreen-toggle", function(e, state) {
            self.setFullscreen(state);
        });
        this.bookContent.get().bind("turned", function(event, page, view) {
            self.updateToolbar();
            self.logEvent('book_page_turn', self.bookUrl, self.bookContent.get().turn("page"));
        });
        this.makeTool('turn-right', __('Previous page'), true, '50%', function() { self.turnPrevious();});
        this.makeTool('turn-left', __('Next page'), false, '50%', function() { self.turnNext();});
        this.makeTool('closebook', __('Close book'), false, '16px', function() { self.closeBook();});
        // reduce close icon in size...
        this.tools['closebook'].css({top: '16px', width: "24px", height: "24px"});

        // update icons...
        $("#book-wrapper >.icon-turn-left").css("background-image", 'url('+o.turnleft_image_url+')')
        $("#book-wrapper >.icon-turn-right").css("background-image", 'url('+o.turnright_image_url+')')

        this.updateToolbar();
        this.logEvent('book_open', this.bookUrl);
    },
    logEvent: function(type, src, data) {
        var timestamp = Math.floor(new Date().getTime() / 1000);
        this.logSingleEvent({"type":type,"src":src,"data":data,"timestamp":timestamp});
        if(type == 'book_close') {  
            // flush events...
            this.flushEventLog();
        }
    },
    logSingleEvent: function(evt) {
        if(this.logger) {
            this.logger(evt)
        }
        this.eventHistory.push(evt);
        if(this.eventUrl) {
            Common.postJsonData(this.eventUrl+".json", evt);
        }
    },
    flushEventLog: function() {
        // TODO odesilat eventy pres AJAX
        console.log(JSON.stringify(this.eventHistory, null, 4));
    },
    setFullscreen: function(full) {
        this.fullscreen = full;
        this.bookContent.get().turn('disable', true);
        if(this.fullscreen) {
            $("#book-wrapper").appendTo($("#fullscreen"));
            $("#container").hide();
            $("#fullscreen").show();            
        } else {
            $("#book-wrapper").appendTo($("#content"));
            $("#container").show();
            $("#fullscreen").hide();

        }
        this.bookContent.get().turn('disable', false);
        this.updateToolbar(this.recreate());
        this.logEvent('book_fullscreen', this.bookUrl, full);
        return full;    
    },
    recreate: function() {
        var width = this.defaultWidth;
        var height = this.defaultHeight;
        // kniha je velka 800x560 - pomer stran cca 1:sqrt(2) ~ 1:1.428
        if(this.fullscreen) {
            var ww = $(window).width();
            var hh = $(window).height();
            var scaleFactor = ww/width;
            var scaleFactor2 = hh/height;
            var scale = Math.min(scaleFactor, scaleFactor2);
            width = /*Math.floor(width*scale);*/ww;
            height = /*Math.floor(height*scale);*/hh;
        } 
        // resize wrapper and pages...
        $("#book-wrapper").css({width:width+"px", height:height+"px"});
        if(this.fullscreen) {
            // na okrajich musi zbyt 8% mista; to odpovida 60px 
            var sidex = Math.max(Math.floor(width*0.08), 60);
            var newWidth = width - 2*sidex;
            var newHeight = Math.floor(newWidth/1.428);
            var maxHeight = height-40;
            if(newHeight > maxHeight) {
                newWidth = Math.floor(newWidth*maxHeight/newHeight);
                newHeight = maxHeight;
            }
        } else {
            var newWidth = width - 120;
            var newHeight = height - 40;
        }
        this.bookContent.get().turn('size', newWidth, newHeight);
        return newWidth;
    },
    updateToolbar: function(gapWidth) {
        var page = this.bookContent.get().turn("page");
        var pages = this.bookContent.get().turn("pages");
        this.showIcon('turn-right', page>1);
        this.showIcon('turn-left', page<(pages-pages%2)); // kdyz ma kniha 3 strany, uz nejde druha otocit
        //this.showIcon('fullscreen-on', !this.fullscreen);
        //this.showIcon('fullscreen-off', this.fullscreen);
        
        if(gapWidth) {
            var gapSize = 60;
            if(this.fullscreen) {
                gapSize += Math.floor(($("#book-wrapper").width() - gapWidth)/2);
            }
            var hh = this.bookContent.get().height();
            var iconSize = Math.min(gapSize - 12, 240);
            var iconSizeHalf = Math.floor(iconSize/2);
            var hh2 = Math.max(Math.floor(hh/2-iconSize/2), 28+3*iconSize);
            this.tools['turn-right'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['turn-left'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            //this.tools['fullscreen-on'].css({top: (20+iconSize)+'px', width: iconSize+"px", height: iconSize+"px"});
            //this.tools['fullscreen-off'].css({top: (20+iconSize)+'px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['closebook'].css({top: '16px', width: iconSizeHalf+"px", height: iconSizeHalf+"px"});
            //if(this.bookUrl) this.tools['home'].css({top: '16px', width: iconSize+"px", height: iconSize+"px"});
        }
    }
});

var ExportBookViewer = BookViewer.extend({
    constructor: function(options) {
        this.base(options);
        this.targetDiv = "#fullscreen"
    },
    init: function() {
        this.base()
        this.setFullscreen(true);
    },
    closeBook: function() {
        // export viewer closes the book
        this.close()
    },
    updateToolbar: function(gapWidth) {
        var page = this.bookContent.get().turn("page");
        var pages = this.bookContent.get().turn("pages");
        this.showIcon('turn-right', page>1);
        this.showIcon('turn-left', page<(pages-pages%2)); // kdyz ma kniha 3 strany, uz nejde druha otocit

        if(gapWidth) {
            var gapSize = 60;
            if(this.fullscreen) {
                gapSize += Math.floor(($("#book-wrapper").width() - gapWidth)/2);
            }
            var hh = this.bookContent.get().height();
            var iconSize = Math.min(gapSize - 12, 240);
            var iconSizeHalf = Math.floor(iconSize/2);
            var hh2 = Math.max(Math.floor(hh/2-iconSize/2), 28+2*iconSize);
            this.tools['turn-right'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['turn-left'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['closebook'].css({top: '16px', width: iconSizeHalf+"px", height: iconSizeHalf+"px"});
        }
    },
    setFullscreen: function(full) {
        this.fullscreen = full;
        this.updateToolbar(this.recreate());
        this.logEvent('book_fullscreen', this.bookUrl, full);
        return full;    
    }
});



$.tubeplayer.defaults.afterReady = function($player) {
    console.log($player)
    // TODO resize only single player
	$(".tubeplayer-wrapper").resize()
}

var TubeplayerThing = Thing.extend({
    _onplay: $.noop,
    _onpause: $.noop,
    _onstop: $.noop,
    _onkill: $.noop,
    onPlay: function(kb) {
        if(typeof kb == 'function') {
            this._onplay = kb;
        } else {
            this._onplay(kb);
        }
    },
    onPause: function(kb) {
        if(typeof kb == 'function') {
            this._onpause = kb;
        } else {
            this._onpause(kb);
        }
    },
    onStop: function(kb) {
        if(typeof kb == 'function') {
            this._onstop = kb;
        } else {
            this._onstop(kb);
        }
    },
    onKill: function(kb) {
        if(typeof kb == 'function') {
            this._onkill = kb;
        } else {
            this._onkill(kb);
        }
    },
    thumbnailUrl: function() {
        return $.jYoutube(this.options.name, 'small');
    },
    init: function() {
    	this.wrapper = $("<div>").addClass("tubeplayer-wrapper")
        this.glasspane = $("<div>").addClass("tubeplayer-glasspane")        
        var self = this
		self.wrapper.resize(function(e) {
			console.log("Resizing! width="+self.wrapper.width()+", height="+self.wrapper.height())
			self.adjustPlayerSize()
		})        
		console.log("Initialized!")
    },
    play: function() {
        this._play();
    },
    _play: function() {
        this.player.tubeplayer("play")
        this.onPlay();
    },
    _pause: function() {
        this.player.tubeplayer("pause")
        this.onPause();
    },
    _stop: function() {
        this.player.tubeplayer("stop")
        this.onStop();
    },
    _kill: function() {
        this.player.tubeplayer("destroy")
        this.player.remove()
        this.player = null
        this.onKill();
    },
    _setVolume: function(vol) {
        this.player.tubeplayer("volume", vol)
    },
    adjustPlayerSize: function() {
    	var self = this    	
    	console.log("Adjusting player size! width="+self.wrapper.width()+", height="+self.wrapper.height())
        self.player.tubeplayer("size", {
			width: self.wrapper.width(), 
			height: self.wrapper.height()
		})
    },
    refresh: function() {
        this.base();
        if(this.player) {
            //this.player.tubeplayer("destroy")
            this.player.remove()
            this.player = null
        }
        this.player = $("<div>").addClass("tubeplayer-container")
        this.element.html(this.wrapper.empty().append(
            this.player
            // this.glasspane
        ))
        var self = this;
        var o = self.options
		self.player.tubeplayer({
			allowFullScreen: false,
			autoPlay: false,
			showControls: 0,
            initialVideo: o.name,
            preferredQuality: o.quality,
            autoPlay: o.autoplay,
            onPlayerUnstarted: function(){},
			onPlay: function(id){}, // after the play method is called
			onPause: function(){}, // after the pause method is called
			onStop: function(){}, // after the player is stopped
			onSeek: function(time){}, // after the video has been seeked to a defined point
			onMute: function(){}, // after the player is muted
			onUnMute: function(){} // after the player is unmuted
		})		
        // console.log(self.player.tubeplayer("player"))
        self._setVolume(o.volume)
    },
    _klass: "tubeplayer-thing thing",
    _type: "tubeplayer-thing",
    _defaults: {
        "name": "ydRAb9cwHnA",
        'quality': "default",
        'autoplay': false,
        'loop': false,
        'volume': 50
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "name": {
			    "type":"string",
                "format": "string",
			    "required":true
    	    },
		    "quality": {
			    "type":"string",
                "format": "string",
			    "required":true
    	    },
            "volume":{
                "type":"integer",
                "required":true // TODO
            },
            "autoplay":{
                "type":"boolean",
                "required":true // TODO
            },
            "loop":{
                "type":"boolean",
                "required":true // TODO
            }
	    }
    }

});

// uses: jquery, common, base

// tohle projde markup a vytvori widgety tam kde jsou na to pripravena data
// widget ma serverovou cast/sablonu a JS na klientovi ktery z toho muze vyrobit
// treba graficky editor nebo embedded SVG

function valueDecode(value) {
    if((/^!/).test(value)) {
        // je to bud base64 nebo to zacina vykricnikem
        value = value.substring(1);
        if(!(/^!/).test(value)) {
            // je to base64
            value = JSON.parse(utf8_decode(base64_decode(value)));
        } else {
            value = html_decode(value);
        }
    } else {
        value = html_decode(value);
    }
    return value;
}

function valueEncode(value) {
    if(jQuery.isPlainObject(value)) {
        return '!' + base64_encode(utf8_encode(JSON.stringify(value)));
    } else {
        var out = html_encode(value);
        if(out.startsWith('!')) out = "!" + out;
    }
    return out;
}

function widgetize(what) {
    what.reverse().each(function() {
        var self = $(this);        
        // find the widget class...
        var csss = self.attr("class").split(" ");
        for(var i=0; i<csss.length; i++) {
            // je to widget?
            if(csss[i].endsWith("-widget")) {
                var widgetClass = csss[i].replace(/-widget$/, "");
                // gather all data-attributes
                var data = self.data();        
                for(var key in data) {
                    var value = data[key];
                    data[key] = valueDecode(data[key]);
                    self.data(key, data[key]);
                }
                // vytvorime widget - zavolame JS/jQuery plugin a predame mu parametry v data
                console.log(data)
                self[widgetClass](data);
                break;
            }
        }
    });
}


var Widget = Base.extend({
    constructor: function(element, options) {
        this.element = element;
        this.options = $.extend({}, options);
        // promenne widgetu...
        this.wid = Widget.getUniqueId();
        this.element.data('wid', this.wid);
        Widget.cache[this.wid] = this;
    },
    init: function() {
        // inicializace ramce pro widget (toho co se nemeni)
    },
    refresh: function() {
        // volat pokazde pokud se zmeni data
    },
    destroy: function() {
        // uvedeni widgetu do puvodniho stavu
    }
},{
    wid: 1,
    getUniqueId: function() {
        return 'widget'+Widget.wid++;
    },
    cache: {}
});







var ThingWidget = Widget.extend({
    init: function() {
        var self = this;
        var def = this.options.def;
        if(def) {
            var thing = Thing.create(def);
            this.element.empty().append(thing.get());
        }
        self.refresh();
    },
    refresh: function() {
    }
});

// widgety...
(function($){

    var defaultOptions = { def: { type: "empty" } };

    var methods = {
        init : function(options) {
            var settings = $.extend({}, defaultOptions, options);
            return this.each(function() {
                var $this = $(this);
                var widget = new ThingWidget($this, settings);
                widget.init();
            });
        }
    };

    $.fn.thing = function(methodOrOptions) {
        if ( methods[methodOrOptions] ) {
            return methods[ methodOrOptions ].apply( this, Array.prototype.slice.call( arguments, 1 ));
        } else if ( typeof methodOrOptions === 'object' || ! methodOrOptions ) {
            // Default to "init"
            return methods.init.apply( this, arguments );
        } else {
            $.error( 'Method ' +  method + ' does not exist on jQuery.thing' );
        }    
    };

})(jQuery);


// TODO rozeznavani 'media' podle pripony

var _audioPlayerIndex = 1;
var makeAudioPlayer = function(parent, media) {
    var id = _audioPlayerIndex++;
    var playerId = 'jquery_cplayer_'+id;
    var containerId = 'cp_container_'+id;
    var html = $.render.circlePlayer({playerId: playerId, containerId: containerId});
    var div = $("<div>").html(html);
    parent.append(div);
    // ensure that player div is at the root of body
    $("#"+playerId).appendTo($("body"));

	var myCirclePlayer = new CirclePlayer("#"+playerId, media, {
		cssSelectorAncestor: "#"+containerId
	});
    return div;
};

var _videoPlayerIndex = 1;
var makeVideoPlayer = function(parent, media) {
    var id = _videoPlayerIndex++;
    var playerId = 'jquery_jplayer_'+id;
    var containerId = 'jp_container_'+id;
    var html = $.render.videoPlayer({playerId: playerId, containerId: containerId});
    var div = $("<div>").html(html).appendTo(parent);
    $("#"+playerId).jPlayer({
        ready: function () {
          $(this).jPlayer("setMedia", media);
        },
        swfPath: "/js",
        supplied: "m4v, ogv",
        cssSelectorAncestor: "#"+containerId
    });    
    return div;
};

// initialization...
$(document).ready(function() {

    // widgetizer...
    widgetize($(".widget"));

});
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: slovensko\book.json
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\slovensko\book.json
VELIKOST: 8210 B (8.02 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
{"type":"book","options":[],"slots":[{"type":"text-thing","options":{"html":"Slovensko - Vysok\u00e9 Tatry 2020","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},{"type":"grid-layout","options":{"rows":2,"columns":2,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/331\/DSCN0665_2_original.jpg","repeat":"no-repeat","position":"center center","color":"","size":"cover"}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"text-thing","options":{"html":"<p>Star&yacute; Smokovec &rArr; Hrebienok &rArr; Malou Studenou dolinou &rArr; p\u0159es Z&aacute;mkovsk&eacute;ho chatu &rArr; na Teryho chatu <span style=\"font-size:14px\"><strong>:)<\/strong><\/span><\/p>\r\n","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}},{"type":"text-thing","options":{"html":"Mlha \"na Blatech\"","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/347\/DSCN0666_2_original.jpg","repeat":"no-repeat","position":"center center","color":"","size":"cover"}}}}]},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"audio-decorator","options":{"ogg":"","mp3":"voices\/30\/Mumford_Sons_Hopeless_Wanderer_Official_Music_Video_original.mp3","uri":"voices\/30\/Mumford_Sons_Hopeless_Wanderer_Official_Music_Video_original.mp3","autoplay":true,"loop":false,"volume":50},"slots":{"content":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/333\/DSCN0669_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}}}},{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"video-thing","options":{"uri":"videos\/10\/video_1596110981_original.mp4","ogg":"","mp4":"videos\/10\/video_1596110981_original.mp4","webm":"","autoplay":true,"loop":true,"volume":20}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/334\/DSCN0670_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}]},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/335\/DSCN0679_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}},{"type":"grid-layout","options":{"rows":1,"columns":2,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/337\/DSCN0689_2_original.jpg","repeat":"no-repeat","position":"center center","color":"","size":"cover"}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"audio-decorator","options":{"ogg":"","mp3":"voices\/31\/Jelen_Abych_tu_zil_original.mp3","uri":"voices\/31\/Jelen_Abych_tu_zil_original.mp3","autoplay":true,"loop":false,"volume":50},"slots":{"content":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/336\/DSCN0685_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}}}}]},{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"text-thing","options":{"html":"<p><em><strong><span style=\"background-color:#800080\">\u010clenov&eacute; v&yacute;pravy :))<\/span><\/strong><\/em><\/p>\r\n\r\n<p>&nbsp;<\/p>\r\n","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/338\/DSCN0696_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}]},{"type":"split-layout","options":{"ratio":65,"gap":2,"horizontal":false},"slots":{"first":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/339\/DSCN0697_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}},"second":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"text-thing","options":{"html":"<h1><u><strong>Popradsk&eacute; pleso<\/strong><\/u><\/h1>\r\n\r\n<h3>- ledovcov&eacute; jezero v <em>Mengusovsk&eacute; dolin\u011b<\/em> ve Vysok&yacute;ch Tatr&aacute;ch<\/h3>\r\n","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}}}},{"type":"split-layout","options":{"ratio":33,"gap":2,"horizontal":false},"slots":{"first":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"text-thing","options":{"html":"<h1><u><strong>&#39;Nad mraky&#39;<\/strong><\/u><\/h1>\r\n\r\n<h3><em>- v&yacute;hled z Ostrvy<\/em><\/h3>\r\n","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}},"second":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/340\/DSCN0706_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"grid-layout","options":{"rows":2,"columns":2,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/341\/DSCN0708_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}},{"type":"text-thing","options":{"html":"Popradsk\u00e9 pleso z Ostrvy","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},{"type":"text-thing","options":{"html":"V\u00fdhled z Ostrvy","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/342\/DSCN0712_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}]},{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/343\/DSCN0716_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/344\/DSCN0717_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}]},{"type":"split-layout","options":{"ratio":33,"gap":2,"horizontal":false},"slots":{"first":{"type":"text-thing","options":{"html":"Batizovsk\u00e9 pleso pod Gerlachovsk\u00fdm \u0161t\u00edtem","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},"second":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/345\/DSCN0720_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"audio-decorator","options":{"ogg":"","mp3":"voices\/32\/Tom_Petty_And_The_Heartbreakers_Learning_To_Fly_Version_1_original.mp3","uri":"voices\/32\/Tom_Petty_And_The_Heartbreakers_Learning_To_Fly_Version_1_original.mp3","autoplay":true,"loop":false,"volume":75},"slots":{"content":{"type":"text-thing","options":{"html":"A tady na\u0161e v\u00fdprava kon\u010d\u00ed :)","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}}}}]}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: slovensko\connector.js
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\slovensko\connector.js
VELIKOST: 26 B (26.00 B)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
var bookman_connector = {}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: slovensko\files
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\slovensko\files
VELIKOST: 1663 B (1.62 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
{"images\/331\/DSCN0665_2_original.jpg":"images\/331\/DSCN0665_2_original.jpg","images\/347\/DSCN0666_2_original.jpg":"images\/347\/DSCN0666_2_original.jpg","voices\/30\/Mumford_Sons_Hopeless_Wanderer_Official_Music_Video_original.mp3":"voices\/30\/Mumford_Sons_Hopeless_Wanderer_Official_Music_Video_original.mp3","images\/333\/DSCN0669_2_original.jpg":"images\/333\/DSCN0669_2_original.jpg","videos\/10\/video_1596110981_original.mp4":"videos\/10\/video_1596110981_original.mp4","images\/334\/DSCN0670_2_original.jpg":"images\/334\/DSCN0670_2_original.jpg","images\/335\/DSCN0679_2_original.jpg":"images\/335\/DSCN0679_2_original.jpg","images\/337\/DSCN0689_2_original.jpg":"images\/337\/DSCN0689_2_original.jpg","voices\/31\/Jelen_Abych_tu_zil_original.mp3":"voices\/31\/Jelen_Abych_tu_zil_original.mp3","images\/336\/DSCN0685_2_original.jpg":"images\/336\/DSCN0685_2_original.jpg","images\/338\/DSCN0696_2_original.jpg":"images\/338\/DSCN0696_2_original.jpg","images\/339\/DSCN0697_original.JPG":"images\/339\/DSCN0697_original.JPG","images\/340\/DSCN0706_original.JPG":"images\/340\/DSCN0706_original.JPG","images\/341\/DSCN0708_original.JPG":"images\/341\/DSCN0708_original.JPG","images\/342\/DSCN0712_2_original.jpg":"images\/342\/DSCN0712_2_original.jpg","images\/343\/DSCN0716_2_original.jpg":"images\/343\/DSCN0716_2_original.jpg","images\/344\/DSCN0717_2_original.jpg":"images\/344\/DSCN0717_2_original.jpg","images\/345\/DSCN0720_original.JPG":"images\/345\/DSCN0720_original.JPG","voices\/32\/Tom_Petty_And_The_Heartbreakers_Learning_To_Fly_Version_1_original.mp3":"voices\/32\/Tom_Petty_And_The_Heartbreakers_Learning_To_Fly_Version_1_original.mp3"}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: slovensko\index2.html
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\slovensko\index2.html
VELIKOST: 9206 B (8.99 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>eScrapBook</title>
<link href="images/favicon.ico" type="image/x-icon" rel="icon">
<link href="images/favicon.ico" type="image/x-icon" rel="shortcut icon">
<link rel="stylesheet" type="text/css" href="css/viewer.css">
<link rel="stylesheet" type="text/css" href="css/styles.css">
<script>
    var LocaleStrings = {};
</script>
<script type="text/javascript" src="js/libs-viewer.js"></script>
<script type="text/javascript" src="js/mykkro-viewer.js"></script></head>
<script type="text/javascript" src="connector.js"></script>
<script type="text/javascript" src="logging.js"></script>
</head>
<body>
<script>
$(document).ready(function() {

    bookman_log({"message":"Logging enabled."})

    var book = {"type":"book","options":[],"slots":[{"type":"text-thing","options":{"html":"Slovensko - Vysok\u00e9 Tatry 2020","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},{"type":"grid-layout","options":{"rows":2,"columns":2,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/331\/DSCN0665_2_original.jpg","repeat":"no-repeat","position":"center center","color":"","size":"cover"}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"text-thing","options":{"html":"<p>Star&yacute; Smokovec &rArr; Hrebienok &rArr; Malou Studenou dolinou &rArr; p\u0159es Z&aacute;mkovsk&eacute;ho chatu &rArr; na Teryho chatu <span style=\"font-size:14px\"><strong>:)<\/strong><\/span><\/p>\r\n","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}},{"type":"text-thing","options":{"html":"Mlha \"na Blatech\"","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/347\/DSCN0666_2_original.jpg","repeat":"no-repeat","position":"center center","color":"","size":"cover"}}}}]},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"audio-decorator","options":{"ogg":"","mp3":"voices\/30\/Mumford_Sons_Hopeless_Wanderer_Official_Music_Video_original.mp3","uri":"voices\/30\/Mumford_Sons_Hopeless_Wanderer_Official_Music_Video_original.mp3","autoplay":true,"loop":false,"volume":50},"slots":{"content":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/333\/DSCN0669_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}}}},{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"video-thing","options":{"uri":"videos\/10\/video_1596110981_original.mp4","ogg":"","mp4":"videos\/10\/video_1596110981_original.mp4","webm":"","autoplay":true,"loop":true,"volume":20}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/334\/DSCN0670_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}]},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/335\/DSCN0679_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}},{"type":"grid-layout","options":{"rows":1,"columns":2,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/337\/DSCN0689_2_original.jpg","repeat":"no-repeat","position":"center center","color":"","size":"cover"}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"audio-decorator","options":{"ogg":"","mp3":"voices\/31\/Jelen_Abych_tu_zil_original.mp3","uri":"voices\/31\/Jelen_Abych_tu_zil_original.mp3","autoplay":true,"loop":false,"volume":50},"slots":{"content":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/336\/DSCN0685_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}}}}]},{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"text-thing","options":{"html":"<p><em><strong><span style=\"background-color:#800080\">\u010clenov&eacute; v&yacute;pravy :))<\/span><\/strong><\/em><\/p>\r\n\r\n<p>&nbsp;<\/p>\r\n","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/338\/DSCN0696_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}]},{"type":"split-layout","options":{"ratio":65,"gap":2,"horizontal":false},"slots":{"first":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/339\/DSCN0697_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}},"second":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"text-thing","options":{"html":"<h1><u><strong>Popradsk&eacute; pleso<\/strong><\/u><\/h1>\r\n\r\n<h3>- ledovcov&eacute; jezero v <em>Mengusovsk&eacute; dolin\u011b<\/em> ve Vysok&yacute;ch Tatr&aacute;ch<\/h3>\r\n","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}}}},{"type":"split-layout","options":{"ratio":33,"gap":2,"horizontal":false},"slots":{"first":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"text-thing","options":{"html":"<h1><u><strong>&#39;Nad mraky&#39;<\/strong><\/u><\/h1>\r\n\r\n<h3><em>- v&yacute;hled z Ostrvy<\/em><\/h3>\r\n","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}},"second":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/340\/DSCN0706_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"grid-layout","options":{"rows":2,"columns":2,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/341\/DSCN0708_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}},{"type":"text-thing","options":{"html":"Popradsk\u00e9 pleso z Ostrvy","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},{"type":"text-thing","options":{"html":"V\u00fdhled z Ostrvy","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/342\/DSCN0712_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}]},{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/343\/DSCN0716_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/344\/DSCN0717_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}]},{"type":"split-layout","options":{"ratio":33,"gap":2,"horizontal":false},"slots":{"first":{"type":"text-thing","options":{"html":"Batizovsk\u00e9 pleso pod Gerlachovsk\u00fdm \u0161t\u00edtem","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},"second":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/345\/DSCN0720_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"audio-decorator","options":{"ogg":"","mp3":"voices\/32\/Tom_Petty_And_The_Heartbreakers_Learning_To_Fly_Version_1_original.mp3","uri":"voices\/32\/Tom_Petty_And_The_Heartbreakers_Learning_To_Fly_Version_1_original.mp3","autoplay":true,"loop":false,"volume":75},"slots":{"content":{"type":"text-thing","options":{"html":"A tady na\u0161e v\u00fdprava kon\u010d\u00ed :)","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}}}}]};
    var bookView = new ExportBookViewer({data:book, fullscreen:true});
    bookView.init();
});
</script>
<div id="fullscreen" style="width: 100%; height: 100%;">
</div>
</body>
</html>
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: slovensko\logging.js
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\slovensko\logging.js
VELIKOST: 750 B (750.00 B)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
var bookman_log = function(data) {
  console.log(data);
}

if(bookman_connector && bookman_connector.connectorUrl) {
    console.log("Logging is available, target is "+bookman_connector.connectorUrl)
    var serialize = function(obj) {
      var str = [];
      for(var p in obj)
         str.push(encodeURIComponent(p) + "=" + encodeURIComponent(obj[p]));
      return str.join("&");
    }
    // use iframe...
    bookman_log = function(data) {
        var iframe = $("<iframe>").attr("src", bookman_connector.connectorUrl + "?" + serialize(data))
        $("#iframe-target").html(iframe)
    }
    $(function() {
      $("body").append('<div id="iframe-target" style="display:none">')
    })
} else {
    console.log("Logging is not available")
}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: slovensko\README
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\slovensko\README
VELIKOST: 44 B (44.00 B)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
This is automatically generated README file.
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: slovensko\RUNeScrapBook
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\slovensko\RUNeScrapBook
VELIKOST: 49 B (49.00 B)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
#!/bin/bash
chromium-browser --kiosk "index.html"
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: slovensko\RUNeScrapBook.bat
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\slovensko\RUNeScrapBook.bat
VELIKOST: 53 B (53.00 B)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
@echo off
start chrome.exe --kiosk "%~dp0index.html"
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: slovensko\css\combined.css
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\slovensko\css\combined.css
VELIKOST: 31886 B (31.14 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
/* http://meyerweb.com/eric/tools/css/reset/ 
   v2.0b1 | 201101 
   NOTE: WORK IN PROGRESS
   USE WITH CAUTION AND TEST WITH ABANDON */

html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section, summary,
time, mark, audio, video {
	margin: 0;
	padding: 0;
	border: 0;
	outline: 0;
	font-size: 100%;
	font: inherit;
	vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section {
	display: block;
}
body {
	line-height: 1;
}
ol, ul {
	list-style: none;
}
blockquote, q {
	quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
	content: '';
	content: none;
}

/* remember to define visible focus styles! 
:focus {
	outline: ?????;
} */

/* remember to highlight inserts somehow! */
ins {
	text-decoration: none;
}
del {
	text-decoration: line-through;
}

table {
	border-collapse: collapse;
	border-spacing: 0;
}
/*
 * qTip2 - Pretty powerful tooltips - v2.1.1
 * http://qtip2.com
 *
 * Copyright (c) 2013 Craig Michael Thompson
 * Released under the MIT, GPL licenses
 * http://jquery.org/license
 *
 * Date: Sat Jul 20 2013 02:23 UTC+0000
 * Plugins: tips svg modal
 * Styles: basic css3
 */
.qtip{
	position: absolute;
	left: -28000px;
	top: -28000px;
	display: none;

	max-width: 280px;
	min-width: 50px;
	
	font-size: 10.5px;
	line-height: 12px;

	direction: ltr;

	box-shadow: none;
	padding: 0;
}

	.qtip-content{
		position: relative;
		padding: 5px 9px;
		overflow: hidden;

		text-align: left;
		word-wrap: break-word;
	}

	.qtip-titlebar{
		position: relative;
		padding: 5px 35px 5px 10px;
		overflow: hidden;

		border-width: 0 0 1px;
		font-weight: bold;
	}

	.qtip-titlebar + .qtip-content{ border-top-width: 0 !important; }

	/* Default close button class */
	.qtip-close{
		position: absolute;
		right: -9px; top: -9px;

		cursor: pointer;
		outline: medium none;

		border-width: 1px;
		border-style: solid;
		border-color: transparent;
	}

		.qtip-titlebar .qtip-close{
			right: 4px; top: 50%;
			margin-top: -9px;
		}
	
		* html .qtip-titlebar .qtip-close{ top: 16px; } /* IE fix */

		.qtip-titlebar .ui-icon,
		.qtip-icon .ui-icon{
			display: block;
			text-indent: -1000em;
			direction: ltr;
		}

		.qtip-icon, .qtip-icon .ui-icon{
			-moz-border-radius: 3px;
			-webkit-border-radius: 3px;
			border-radius: 3px;
			text-decoration: none;
		}

			.qtip-icon .ui-icon{
				width: 18px;
				height: 14px;

				line-height: 14px;
				text-align: center;
				text-indent: 0;
				font: normal bold 10px/13px Tahoma,sans-serif;

				color: inherit;
				background: transparent none no-repeat -100em -100em;
			}

/* Applied to 'focused' tooltips e.g. most recently displayed/interacted with */
.qtip-focus{}

/* Applied on hover of tooltips i.e. added/removed on mouseenter/mouseleave respectively */
.qtip-hover{}

/* Default tooltip style */
.qtip-default{
	border-width: 1px;
	border-style: solid;
	border-color: #F1D031;

	background-color: #FFFFA3;
	color: #555;
}

	.qtip-default .qtip-titlebar{
		background-color: #FFEF93;
	}

	.qtip-default .qtip-icon{
		border-color: #CCC;
		background: #F1F1F1;
		color: #777;
	}
	
	.qtip-default .qtip-titlebar .qtip-close{
		border-color: #AAA;
		color: #111;
	}



/*! Light tooltip style */
.qtip-light{
	background-color: white;
	border-color: #E2E2E2;
	color: #454545;
}

	.qtip-light .qtip-titlebar{
		background-color: #f1f1f1;
	}


/*! Dark tooltip style */
.qtip-dark{
	background-color: #505050;
	border-color: #303030;
	color: #f3f3f3;
}

	.qtip-dark .qtip-titlebar{
		background-color: #404040;
	}

	.qtip-dark .qtip-icon{
		border-color: #444;
	}

	.qtip-dark .qtip-titlebar .ui-state-hover{
		border-color: #303030;
	}


/*! Cream tooltip style */
.qtip-cream{
	background-color: #FBF7AA;
	border-color: #F9E98E;
	color: #A27D35;
}

	.qtip-cream .qtip-titlebar{
		background-color: #F0DE7D;
	}

	.qtip-cream .qtip-close .qtip-icon{
		background-position: -82px 0;
	}


/*! Red tooltip style */
.qtip-red{
	background-color: #F78B83;
	border-color: #D95252;
	color: #912323;
}

	.qtip-red .qtip-titlebar{
		background-color: #F06D65;
	}

	.qtip-red .qtip-close .qtip-icon{
		background-position: -102px 0;
	}

	.qtip-red .qtip-icon{
		border-color: #D95252;
	}

	.qtip-red .qtip-titlebar .ui-state-hover{
		border-color: #D95252;
	}


/*! Green tooltip style */
.qtip-green{
	background-color: #CAED9E;
	border-color: #90D93F;
	color: #3F6219;
}

	.qtip-green .qtip-titlebar{
		background-color: #B0DE78;
	}

	.qtip-green .qtip-close .qtip-icon{
		background-position: -42px 0;
	}


/*! Blue tooltip style */
.qtip-blue{
	background-color: #E5F6FE;
	border-color: #ADD9ED;
	color: #5E99BD;
}

	.qtip-blue .qtip-titlebar{
		background-color: #D0E9F5;
	}

	.qtip-blue .qtip-close .qtip-icon{
		background-position: -2px 0;
	}



.qtip-shadow{
	-webkit-box-shadow: 1px 1px 3px 1px rgba(0, 0, 0, 0.15);
	-moz-box-shadow: 1px 1px 3px 1px rgba(0, 0, 0, 0.15);
	box-shadow: 1px 1px 3px 1px rgba(0, 0, 0, 0.15);
}

/* Add rounded corners to your tooltips in: FF3+, Chrome 2+, Opera 10.6+, IE9+, Safari 2+ */
.qtip-rounded,
.qtip-tipsy,
.qtip-bootstrap{
	-moz-border-radius: 5px;
	-webkit-border-radius: 5px;
	border-radius: 5px;
}

.qtip-rounded .qtip-titlebar{
	-moz-border-radius: 4px 4px 0 0;
	-webkit-border-radius: 4px 4px 0 0;
	border-radius: 4px 4px 0 0;
}

/* Youtube tooltip style */
.qtip-youtube{
	-moz-border-radius: 2px;
	-webkit-border-radius: 2px;
	border-radius: 2px;
	
	-webkit-box-shadow: 0 0 3px #333;
	-moz-box-shadow: 0 0 3px #333;
	box-shadow: 0 0 3px #333;

	color: white;
	border-width: 0;

	background: #4A4A4A;
	background-image: -webkit-gradient(linear,left top,left bottom,color-stop(0,#4A4A4A),color-stop(100%,black));
	background-image: -webkit-linear-gradient(top,#4A4A4A 0,black 100%);
	background-image: -moz-linear-gradient(top,#4A4A4A 0,black 100%);
	background-image: -ms-linear-gradient(top,#4A4A4A 0,black 100%);
	background-image: -o-linear-gradient(top,#4A4A4A 0,black 100%);
}

	.qtip-youtube .qtip-titlebar{
		background-color: #4A4A4A;
		background-color: rgba(0,0,0,0);
	}
	
	.qtip-youtube .qtip-content{
		padding: .75em;
		font: 12px arial,sans-serif;
		
		filter: progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr=#4a4a4a,EndColorStr=#000000);
		-ms-filter: "progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr=#4a4a4a,EndColorStr=#000000);";
	}

	.qtip-youtube .qtip-icon{
		border-color: #222;
	}

	.qtip-youtube .qtip-titlebar .ui-state-hover{
		border-color: #303030;
	}


/* jQuery TOOLS Tooltip style */
.qtip-jtools{
	background: #232323;
	background: rgba(0, 0, 0, 0.7);
	background-image: -webkit-gradient(linear, left top, left bottom, from(#717171), to(#232323));
	background-image: -moz-linear-gradient(top, #717171, #232323);
	background-image: -webkit-linear-gradient(top, #717171, #232323);
	background-image: -ms-linear-gradient(top, #717171, #232323);
	background-image: -o-linear-gradient(top, #717171, #232323);

	border: 2px solid #ddd;
	border: 2px solid rgba(241,241,241,1);

	-moz-border-radius: 2px;
	-webkit-border-radius: 2px;
	border-radius: 2px;

	-webkit-box-shadow: 0 0 12px #333;
	-moz-box-shadow: 0 0 12px #333;
	box-shadow: 0 0 12px #333;
}

	/* IE Specific */
	.qtip-jtools .qtip-titlebar{
		background-color: transparent;
		filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#717171,endColorstr=#4A4A4A);
		-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#717171,endColorstr=#4A4A4A)";
	}
	.qtip-jtools .qtip-content{
		filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#4A4A4A,endColorstr=#232323);
		-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#4A4A4A,endColorstr=#232323)";
	}

	.qtip-jtools .qtip-titlebar,
	.qtip-jtools .qtip-content{
		background: transparent;
		color: white;
		border: 0 dashed transparent;
	}

	.qtip-jtools .qtip-icon{
		border-color: #555;
	}

	.qtip-jtools .qtip-titlebar .ui-state-hover{
		border-color: #333;
	}


/* Cluetip style */
.qtip-cluetip{
	-webkit-box-shadow: 4px 4px 5px rgba(0, 0, 0, 0.4);
	-moz-box-shadow: 4px 4px 5px rgba(0, 0, 0, 0.4);
	box-shadow: 4px 4px 5px rgba(0, 0, 0, 0.4);

	background-color: #D9D9C2;
	color: #111;
	border: 0 dashed transparent;
}

	.qtip-cluetip .qtip-titlebar{
		background-color: #87876A;
		color: white;
		border: 0 dashed transparent;
	}
	
	.qtip-cluetip .qtip-icon{
		border-color: #808064;
	}
	
	.qtip-cluetip .qtip-titlebar .ui-state-hover{
		border-color: #696952;
		color: #696952;
	}


/* Tipsy style */
.qtip-tipsy{
	background: black;
	background: rgba(0, 0, 0, .87);

	color: white;
	border: 0 solid transparent;

	font-size: 11px;
	font-family: 'Lucida Grande', sans-serif;
	font-weight: bold;
	line-height: 16px;
	text-shadow: 0 1px black;
}

	.qtip-tipsy .qtip-titlebar{
		padding: 6px 35px 0 10px;
		background-color: transparent;
	}

	.qtip-tipsy .qtip-content{
		padding: 6px 10px;
	}
	
	.qtip-tipsy .qtip-icon{
		border-color: #222;
		text-shadow: none;
	}

	.qtip-tipsy .qtip-titlebar .ui-state-hover{
		border-color: #303030;
	}


/* Tipped style */
.qtip-tipped{
	border: 3px solid #959FA9;

	-moz-border-radius: 3px;
	-webkit-border-radius: 3px;
	border-radius: 3px;

	background-color: #F9F9F9;
	color: #454545;

	font-weight: normal;
	font-family: serif;
}

	.qtip-tipped .qtip-titlebar{
		border-bottom-width: 0;

		color: white;
		background: #3A79B8;
		background-image: -webkit-gradient(linear, left top, left bottom, from(#3A79B8), to(#2E629D));
		background-image: -webkit-linear-gradient(top, #3A79B8, #2E629D);
		background-image: -moz-linear-gradient(top, #3A79B8, #2E629D);
		background-image: -ms-linear-gradient(top, #3A79B8, #2E629D);
		background-image: -o-linear-gradient(top, #3A79B8, #2E629D);
		filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#3A79B8,endColorstr=#2E629D);
		-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#3A79B8,endColorstr=#2E629D)";
	}

	.qtip-tipped .qtip-icon{
		border: 2px solid #285589;
		background: #285589;
	}

		.qtip-tipped .qtip-icon .ui-icon{
			background-color: #FBFBFB;
			color: #555;
		}


/**
 * Twitter Bootstrap style.
 *
 * Tested with IE 8, IE 9, Chrome 18, Firefox 9, Opera 11.
 * Does not work with IE 7.
 */
.qtip-bootstrap{
	/** Taken from Bootstrap body */
	font-size: 14px;
	line-height: 20px;
	color: #333333;

	/** Taken from Bootstrap .popover */
	padding: 1px;
	background-color: #ffffff;
	border: 1px solid #ccc;
	border: 1px solid rgba(0, 0, 0, 0.2);
	-webkit-border-radius: 6px;
	-moz-border-radius: 6px;
	border-radius: 6px;
	-webkit-box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
	-moz-box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
	box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
	-webkit-background-clip: padding-box;
	-moz-background-clip: padding;
	background-clip: padding-box;
}

	.qtip-bootstrap .qtip-titlebar{
		/** Taken from Bootstrap .popover-title */
		padding: 8px 14px;
		margin: 0;
		font-size: 14px;
		font-weight: normal;
		line-height: 18px;
		background-color: #f7f7f7;
		border-bottom: 1px solid #ebebeb;
		-webkit-border-radius: 5px 5px 0 0;
		-moz-border-radius: 5px 5px 0 0;
		border-radius: 5px 5px 0 0;
	}

		.qtip-bootstrap .qtip-titlebar .qtip-close{
			/**
			 * Overrides qTip2:
			 * .qtip-titlebar .qtip-close{
			 *   [...]
			 *   right: 4px;
			 *   top: 50%;
			 *   [...]
			 *   border-style: solid;
			 * }
			 */
			right: 11px;
			top: 45%;
			border-style: none;
		}

	.qtip-bootstrap .qtip-content{
		/** Taken from Bootstrap .popover-content */
		padding: 9px 14px;
	}

	.qtip-bootstrap .qtip-icon{
		/**
		 * Overrides qTip2:
		 * .qtip-default .qtip-icon {
		 *   border-color: #CCC;
		 *   background: #F1F1F1;
		 *   color: #777;
		 * }
		 */
		background: transparent;
	}

		.qtip-bootstrap .qtip-icon .ui-icon{
			/**
			 * Overrides qTip2:
			 * .qtip-icon .ui-icon{
			 *   width: 18px;
			 *   height: 14px;
			 * }
			 */
			width: auto;
			height: auto;

			/* Taken from Bootstrap .close */
			float: right;
			font-size: 20px;
			font-weight: bold;
			line-height: 18px;
			color: #000000;
			text-shadow: 0 1px 0 #ffffff;
			opacity: 0.2;
			filter: alpha(opacity=20);
		}

		.qtip-bootstrap .qtip-icon .ui-icon:hover{
			/* Taken from Bootstrap .close:hover */
			color: #000000;
			text-decoration: none;
			cursor: pointer;
			opacity: 0.4;
			filter: alpha(opacity=40);
		}


/* IE9 fix - removes all filters */
.qtip:not(.ie9haxors) div.qtip-content,
.qtip:not(.ie9haxors) div.qtip-titlebar{
	filter: none;
	-ms-filter: none;
}



.qtip .qtip-tip{
	margin: 0 auto;
	overflow: hidden;
	z-index: 10;
	
}

	/* Opera bug #357 - Incorrect tip position
	https://github.com/Craga89/qTip2/issues/367 */
	x:-o-prefocus, .qtip .qtip-tip{
		visibility: hidden;
	}

	.qtip .qtip-tip,
	.qtip .qtip-tip .qtip-vml,
	.qtip .qtip-tip canvas{
		position: absolute;

		color: #123456;
		background: transparent;
		border: 0 dashed transparent;
	}
	
	.qtip .qtip-tip canvas{ top: 0; left: 0; }

	.qtip .qtip-tip .qtip-vml{
		behavior: url(#default#VML);
		display: inline-block;
		visibility: visible;
	}

#qtip-overlay{
	position: fixed;
	left: -10000em;
	top: -10000em;
}

	/* Applied to modals with show.modal.blur set to true */
	#qtip-overlay.blurs{ cursor: pointer; }

	/* Change opacity of overlay here */
	#qtip-overlay div{
		position: absolute;
		left: 0; top: 0;
		width: 100%; height: 100%;

		background-color: black;

		opacity: 0.7;
		filter:alpha(opacity=70);
		-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=70)";
	}


.jsoneditor-field, .jsoneditor-value, .jsoneditor-field-readonly, .jsoneditor-readonly {
    border: 1px solid transparent;
    min-height: 16px;
    min-width: 24px;
    padding: 2px;
    margin: 1px;
    outline: none;
    word-wrap: break-word;
    float: left;
}

/* adjust margin of p elements inside editable divs, needed for Opera, IE */
.jsoneditor-field p, .jsoneditor-value p {
    margin: 0;
}

.jsoneditor-value {
    word-break: break-word;
}

.jsoneditor-empty {
    background-color: #E5E5E5;
    border-radius: 2px;
}

.jsoneditor-separator {
    padding: 3px 0;
    vertical-align: top;
}

.jsoneditor-value:focus, .jsoneditor-field:focus,
        .jsoneditor-value:hover, .jsoneditor-field:hover,
        .jsoneditor-search-highlight {
    background-color: #FFFFAB;
    border: 1px solid yellow;
    border-radius: 2px;
}

.jsoneditor-search-highlight-active,
        .jsoneditor-search-highlight-active:focus,
        .jsoneditor-search-highlight-active:hover {
    background-color: #ffee00;
    border: 1px solid #ffc700;
    border-radius: 2px;
}

.jsoneditor-field-readonly:hover {
    border: 1px solid white;
}

.jsoneditor-readonly {
    color: gray;
}

button.jsoneditor-remove, button.jsoneditor-append, button.jsoneditor-duplicate,
button.jsoneditor-collapsed, button.jsoneditor-expanded,
button.jsoneditor-invisible, button.jsoneditor-dragarea,
button.jsoneditor-type-auto, button.jsoneditor-type-string,
button.jsoneditor-type-array, button.jsoneditor-type-object {
    width: 24px;
    height: 24px;
    padding: 0;
    margin: 0;
    border: none;
    cursor: pointer;
    background: url('../img/jsoneditor-icons.png');
}

button:disabled {
    color: #808080;
}

button.jsoneditor-collapsed {
    background-position: -168px 0;
}

button.jsoneditor-expanded {
    background-position: -168px -24px;
}

button.jsoneditor-invisible {
    visibility: hidden;
    background: none;
}

button.jsoneditor-collapsed, button.jsoneditor-expanded,
button.jsoneditor-invisible {
    float: left;
}

button.jsoneditor-remove {
    background-position: -24px -24px;
}
button.jsoneditor-remove:hover {
    background-position: -24px 0;
}

button.jsoneditor-append {
    background-position: 0 -24px;
}
button.jsoneditor-append:hover {
    background-position: 0 0;
}

button.jsoneditor-duplicate {
    background-position: -48px -24px;
}
button.jsoneditor-duplicate:hover {
    background-position: -48px 0;
}

button.jsoneditor-type-string {
    background-position: -144px -24px;
}
button.jsoneditor-type-string:hover {
    background-position: -144px 0;
}

button.jsoneditor-type-auto {
    background-position: -120px -24px;
}
button.jsoneditor-type-auto:hover {
    background-position: -120px 0;
}

button.jsoneditor-type-object {
    background-position: -72px -24px;
}
button.jsoneditor-type-object:hover {
    background-position: -72px 0;
}

button.jsoneditor-type-array {
    background-position: -96px -24px;
}
button.jsoneditor-type-array:hover {
    background-position: -96px 0;
}

div.jsoneditor-select {
    border: 1px solid gray;
    background-color: white;
    box-shadow: 4px 4px 10px rgba(128, 128, 128, 0.5);
}

div.jsoneditor-option {
    color: #4D4D4D;
    background-color: white;

    border: none;
    margin: 0;
    display: block;
    text-align: left;
    cursor: pointer;
}
div.jsoneditor-option:hover {
    background-color: #FFFFAB;
    color: #1A1A1A;
}
div.jsoneditor-option-selected {
    background-color: #D5DDF6;
}
div.jsoneditor-option-text {
    height: 24px;
    line-height: 24px;
    padding: 0 12px 0 0;
    display: inline-block;
}

div.jsoneditor-option-string, div.jsoneditor-option-auto,
div.jsoneditor-option-object, div.jsoneditor-option-array {
    float: left;
    width: 24px;
    height: 24px;
    display: inline-block;
    background: url('../img/jsoneditor-icons.png');
}
div.jsoneditor-option-string {
    background-position: -144px 0;
}
div.jsoneditor-option-auto {
    background-position: -120px 0;
}
div.jsoneditor-option-object {
    background-position: -72px 0;
}
div.jsoneditor-option-array {
    background-position: -96px 0;
}


div.jsoneditor-frame {
    color: #1A1A1A;
    border: 1px solid #97B0F8;
    box-sizing: border-box;
    width: 100%;
    height: 100%;
    overflow: auto;
    position: relative;
    padding: 0;
}

table.jsoneditor-table {
    border-collapse: collapse;
    border-spacing: 0;
    width: 100%;
    margin: 0;
}

div.jsoneditor-content-outer, div.jsonformatter-content {
    width: 100%;
    height: 100%;
    margin: -35px 0 0 0;
    padding: 35px 0 0 0;

    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;

    overflow: hidden;
}

div.jsoneditor-content {
    width: 100%;
    height: 100%;
    position: relative;
    overflow: auto;
}

textarea.jsonformatter-textarea {
    width: 100%;
    height: 100%;
    margin: 0;

    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;

    border: none;
    background-color: white;
    resize: none;
}

tr.jsoneditor-tr-highlight {
    background-color: #FFFFAB;
}

button.jsoneditor-dragarea {
    width: 16px;
    height: 24px;
    /*
    margin: 3px 0;
    background: url('img/dots_gray.gif') top center;
    background-repeat: repeat-y;
    */
    background: url('../img/jsoneditor-icons.png') -220px 0;

    display: block;
    cursor: move;
}

div.jsoneditor-menu {
    width: 100%;
    height: 35px;
    padding: 2px;
    margin: 0;
    overflow: hidden;
    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;

    color: #1A1A1A;
    background-color: #D5DDF6;
    border-bottom: 1px solid #97B0F8;
}

table.jsoneditor-search {
    position: absolute;
    right: 2px;
    top: 2px;
}

table.jsoneditor-search-input {
    border-collapse: collapse;
}

div.jsoneditor-search {
    border: 1px solid #97B0F8;
    background-color: white;
    padding: 0 2px;
    margin: 0;
}

input.jsoneditor-search {
    width: 120px;
    border: none;
    outline: none;
    margin: 1px;
}

div.jsoneditor-search-results {
    color: #4d4d4d;
    padding-right: 5px;
}

button.jsoneditor-search-refresh, button.jsoneditor-search-next,
        button.jsoneditor-search-previous {
    width: 16px;
    height: 24px;
    padding: 0;
    margin: 0;
    border: none;
    background: url('../img/jsoneditor-icons.png');
    vertical-align: top;
}

button.jsoneditor-search-refresh {
    width: 18px;
    background-position: -243px -25px;
}

button.jsoneditor-search-next {
    cursor: pointer;
    background-position: -268px -25px;
}
button.jsoneditor-search-next:hover {
    background-position: -268px -1px;
}

button.jsoneditor-search-previous {
    cursor: pointer;
    background-position: -292px -25px;
    margin-right: 2px;
}
button.jsoneditor-search-previous:hover {
    background-position: -292px -1px;
}


button.jsoneditor-menu {
    width: 26px;
    height: 26px;
    margin: 2px;
    padding: 2px;
    border-radius: 2px;
    border: 1px solid #aec0f8;
    background: #e3eaf6 url('../img/jsoneditor-icons.png');
}

button.jsoneditor-menu:hover {
    background-color: #f0f2f5;
}
button.jsoneditor-menu:active {
    background-color: #ffffff;
}
button.jsoneditor-menu:disabled {
    background-color: #e3eaf6;
}

button.jsoneditor-collapse-all {
    background-position: -312px 0;
}
button.jsoneditor-expand-all {
    background-position: -312px -24px;
}
button.jsoneditor-undo {
    background-position: -336px 0;
}
button.jsoneditor-redo {
    background-position: -360px 0;
}
button.jsoneditor-undo:disabled {
    background-position: -336px -24px;
}
button.jsoneditor-redo:disabled {
    background-position: -360px -24px;
}
/* TODO: css for button:disabled is not supported by IE8 */
button.jsoneditor-compact {
    background-position: -384px 0;
}
button.jsoneditor-format {
    background-position: -384px -24px;
}


tr, th, td {
    padding: 0;
    margin: 0;
}

td.jsoneditor-td {
    vertical-align: top;
}

td.jsoneditor-td {
    padding: 0 3px;
}

td.jsoneditor-td-edit {
    background-color: #F5F5F5;
    padding: 0;
}

td.jsoneditor-td-tree {
    vertical-align: top;
}

td.jsoneditor-droparea {
    height: 24px;

    border-top: 1px dashed gray;
    border-bottom: 1px dashed gray;
    background-color: #FFFF80;
}

.jsoneditor-field, .jsoneditor-value, .jsoneditor-td, .jsoneditor-th,
.jsoneditor-type,
.jsonformatter-textarea {
    font-family: droid sans mono, monospace, courier new, courier, sans-serif;
    font-size: 10pt;
    color: #1A1A1A;
}

.jsoneditor-hidden-focus {
    position: absolute;
    left: -1000px;
    top: -1000px;
    border: none;
    outline: none;
}
.toolbar-wrapper {
    display: block;
    position: relative;
}

.toolbar {
    position: absolute;
    bottom: 0;
    right: 0;
    border-radius: 5px; 
    -moz-border-radius: 5px; 
    -webkit-border-radius: 5px; 
    border: 1px solid gray;
    background-color: lightgray;
}


.my-tooltip {
	display: inline;
	position: relative;
}

.my-tooltip:hover:after{
	background: #333;
	background: rgba(0,0,0,.8);
	border-radius: 5px;
	bottom: 26px;
	color: #fff;
	content: attr(data-title);
	left: 20%;
	padding: 5px 15px;
	position: absolute;
	z-index: 98;
    width: 180px;
}

.my-tooltip:hover:before{
	border: solid;
	border-color: #333 transparent;
	border-width: 6px 6px 0 6px;
	bottom: 20px;
	content: "";
	left: 50%;
	position: absolute;
	z-index: 99;
}


/*
.icon-default.icon-hover {
    background-image: url(../images/icons/32/Redo.png);
}
*/


.syntaxhighlighter a,
.syntaxhighlighter div,
.syntaxhighlighter code,
.syntaxhighlighter table,
.syntaxhighlighter table td,
.syntaxhighlighter table tr,
.syntaxhighlighter table tbody,
.syntaxhighlighter table thead,
.syntaxhighlighter table caption,
.syntaxhighlighter textarea {
  -moz-border-radius: 0 0 0 0 !important;
  -webkit-border-radius: 0 0 0 0 !important;
  background: none !important;
  border: 0 !important;
  bottom: auto !important;
  float: none !important;
  height: auto !important;
  left: auto !important;
  line-height: 1.1em !important;
  margin: 0 !important;
  outline: 0 !important;
  overflow: visible !important;
  padding: 0 !important;
  position: static !important;
  right: auto !important;
  text-align: left !important;
  top: auto !important;
  vertical-align: baseline !important;
  width: auto !important;
  box-sizing: content-box !important;
  font-family: "Consolas", "Bitstream Vera Sans Mono", "Courier New", Courier, monospace !important;
  font-weight: normal !important;
  font-style: normal !important;
  font-size: 1em !important;
  min-height: inherit !important;
  min-height: auto !important;
}

.syntaxhighlighter {
  width: 100% !important;
  margin: 1em 0 1em 0 !important;
  position: relative !important;
  overflow-x: auto !important;
  overflow-y: hidden !important;
  font-size: 1em !important;
}
.syntaxhighlighter.source {
  overflow: hidden !important;
}
.syntaxhighlighter .bold {
  font-weight: bold !important;
}
.syntaxhighlighter .italic {
  font-style: italic !important;
}
.syntaxhighlighter .line {
  white-space: pre !important;
}
.syntaxhighlighter table {
  width: 100% !important;
}
.syntaxhighlighter table caption {
  text-align: left !important;
  padding: .5em 0 0.5em 1em !important;
}
.syntaxhighlighter table td.code {
  width: 100% !important;
}
.syntaxhighlighter table td.code .container {
  position: relative !important;
}
.syntaxhighlighter table td.code .container textarea {
  box-sizing: border-box !important;
  position: absolute !important;
  left: 0 !important;
  top: 0 !important;
  width: 100% !important;
  height: 100% !important;
  border: none !important;
  background: white !important;
  padding-left: 1em !important;
  overflow: hidden !important;
  white-space: pre !important;
}
.syntaxhighlighter table td.gutter .line {
  text-align: right !important;
  padding: 0 0.5em 0 1em !important;
}
.syntaxhighlighter table td.code .line {
  padding: 0 1em !important;
}
.syntaxhighlighter.nogutter td.code .container textarea, .syntaxhighlighter.nogutter td.code .line {
  padding-left: 0em !important;
}
.syntaxhighlighter.show {
  display: block !important;
}
.syntaxhighlighter.collapsed table {
  display: none !important;
}
.syntaxhighlighter.collapsed .toolbar {
  padding: 0.1em 0.8em 0em 0.8em !important;
  font-size: 1em !important;
  position: static !important;
  width: auto !important;
  height: auto !important;
}
.syntaxhighlighter.collapsed .toolbar span {
  display: inline !important;
  margin-right: 1em !important;
}
.syntaxhighlighter.collapsed .toolbar span a {
  padding: 0 !important;
  display: none !important;
}
.syntaxhighlighter.collapsed .toolbar span a.expandSource {
  display: inline !important;
}
.syntaxhighlighter .toolbar {
  position: absolute !important;
  right: 1px !important;
  top: 1px !important;
  width: 11px !important;
  height: 11px !important;
  font-size: 10px !important;
  z-index: 10 !important;
}
.syntaxhighlighter .toolbar span.title {
  display: inline !important;
}
.syntaxhighlighter .toolbar a {
  display: block !important;
  text-align: center !important;
  text-decoration: none !important;
  padding-top: 1px !important;
}
.syntaxhighlighter .toolbar a.expandSource {
  display: none !important;
}
.syntaxhighlighter.ie {
  font-size: .9em !important;
  padding: 1px 0 1px 0 !important;
}
.syntaxhighlighter.ie .toolbar {
  line-height: 8px !important;
}
.syntaxhighlighter.ie .toolbar a {
  padding-top: 0px !important;
}
.syntaxhighlighter.printing .line.alt1 .content,
.syntaxhighlighter.printing .line.alt2 .content,
.syntaxhighlighter.printing .line.highlighted .number,
.syntaxhighlighter.printing .line.highlighted.alt1 .content,
.syntaxhighlighter.printing .line.highlighted.alt2 .content {
  background: none !important;
}
.syntaxhighlighter.printing .line .number {
  color: #bbbbbb !important;
}
.syntaxhighlighter.printing .line .content {
  color: black !important;
}
.syntaxhighlighter.printing .toolbar {
  display: none !important;
}
.syntaxhighlighter.printing a {
  text-decoration: none !important;
}
.syntaxhighlighter.printing .plain, .syntaxhighlighter.printing .plain a {
  color: black !important;
}
.syntaxhighlighter.printing .comments, .syntaxhighlighter.printing .comments a {
  color: #008200 !important;
}
.syntaxhighlighter.printing .string, .syntaxhighlighter.printing .string a {
  color: blue !important;
}
.syntaxhighlighter.printing .keyword {
  color: #006699 !important;
  font-weight: bold !important;
}
.syntaxhighlighter.printing .preprocessor {
  color: gray !important;
}
.syntaxhighlighter.printing .variable {
  color: #aa7700 !important;
}
.syntaxhighlighter.printing .value {
  color: #009900 !important;
}
.syntaxhighlighter.printing .functions {
  color: #ff1493 !important;
}
.syntaxhighlighter.printing .constants {
  color: #0066cc !important;
}
.syntaxhighlighter.printing .script {
  font-weight: bold !important;
}
.syntaxhighlighter.printing .color1, .syntaxhighlighter.printing .color1 a {
  color: gray !important;
}
.syntaxhighlighter.printing .color2, .syntaxhighlighter.printing .color2 a {
  color: #ff1493 !important;
}
.syntaxhighlighter.printing .color3, .syntaxhighlighter.printing .color3 a {
  color: red !important;
}
.syntaxhighlighter.printing .break, .syntaxhighlighter.printing .break a {
  color: black !important;
}
.syntaxhighlighter {
  background-color: white !important;
}
.syntaxhighlighter .line.alt1 {
  background-color: white !important;
}
.syntaxhighlighter .line.alt2 {
  background-color: white !important;
}
.syntaxhighlighter .line.highlighted.alt1, .syntaxhighlighter .line.highlighted.alt2 {
  background-color: #e0e0e0 !important;
}
.syntaxhighlighter .line.highlighted.number {
  color: black !important;
}
.syntaxhighlighter table caption {
  color: black !important;
}
.syntaxhighlighter .gutter {
  color: #afafaf !important;
}
.syntaxhighlighter .gutter .line {
  border-right: 3px solid #6ce26c !important;
}
.syntaxhighlighter .gutter .line.highlighted {
  background-color: #6ce26c !important;
  color: white !important;
}
.syntaxhighlighter.printing .line .content {
  border: none !important;
}
.syntaxhighlighter.collapsed {
  overflow: visible !important;
}
.syntaxhighlighter.collapsed .toolbar {
  color: blue !important;
  background: white !important;
  border: 1px solid #6ce26c !important;
}
.syntaxhighlighter.collapsed .toolbar a {
  color: blue !important;
}
.syntaxhighlighter.collapsed .toolbar a:hover {
  color: red !important;
}
.syntaxhighlighter .toolbar {
  color: white !important;
  background: #6ce26c !important;
  border: none !important;
}
.syntaxhighlighter .toolbar a {
  color: white !important;
}
.syntaxhighlighter .toolbar a:hover {
  color: black !important;
}
.syntaxhighlighter .plain, .syntaxhighlighter .plain a {
  color: black !important;
}
.syntaxhighlighter .comments, .syntaxhighlighter .comments a {
  color: #008200 !important;
}
.syntaxhighlighter .string, .syntaxhighlighter .string a {
  color: blue !important;
}
.syntaxhighlighter .keyword {
  color: #006699 !important;
}
.syntaxhighlighter .preprocessor {
  color: gray !important;
}
.syntaxhighlighter .variable {
  color: #aa7700 !important;
}
.syntaxhighlighter .value {
  color: #009900 !important;
}
.syntaxhighlighter .functions {
  color: #ff1493 !important;
}
.syntaxhighlighter .constants {
  color: #0066cc !important;
}
.syntaxhighlighter .script {
  font-weight: bold !important;
  color: #006699 !important;
  background-color: none !important;
}
.syntaxhighlighter .color1, .syntaxhighlighter .color1 a {
  color: gray !important;
}
.syntaxhighlighter .color2, .syntaxhighlighter .color2 a {
  color: #ff1493 !important;
}
.syntaxhighlighter .color3, .syntaxhighlighter .color3 a {
  color: red !important;
}

.syntaxhighlighter .keyword {
  font-weight: bold !important;
}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: slovensko\css\styles.css
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\slovensko\css\styles.css
VELIKOST: 50381 B (49.20 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
.hello-widget .area{width:200px;height:200px;background-color:#abc;display:block;position:relative;cursor:crosshair;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.hello-widget .pointer{position:absolute;left:0px;top:0px;width:10px;height:10px;background-color:blue;cursor:crosshair;-webkit-border-radius:5px;-moz-border-radius:5px;border-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:5px;padding:10px}.hello-widget .coords{height:10%;padding-top:45%;text-align:center;width:100%;cursor:crosshair;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.my-paddy{width:100px;height:100px;background-color:orange;position:relative}.my-paddy > .my-paddy-picker{width:10px;height:10px;background-color:blue;position:absolute}.jsoneditor-widget{background-color:white}.fiddles.form .textarea textarea{width:400px;height:200px;font-family:monospace;font-size:12px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.fiddles.form .jsoneditor-widget{width:400px}.editable-editor .fieldset fieldset{border:none;padding:0px}.ui-mykkro-fieldset,.ui-mykkro-titled,.ui-mykkro-optional{margin-bottom:5px}.ui-mykkro-fieldset > .ui-widget-header,.ui-mykkro-titled > .ui-widget-header,.ui-mykkro-optional > .ui-widget-header{padding:3px;position:relative;background:#ccc;color:black;border-color:#aaa}.ui-mykkro-fieldset > .ui-widget-content,.ui-mykkro-titled > .ui-widget-content,.ui-mykkro-optional > .ui-widget-content{padding:3px 20px;position:relative;background:#ddd;border-color:#aaa}.ui-mykkro-fieldset legend{display:block;width:100%;margin:0;padding:0;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.slider input{text-align:center;width:50px}.mykkro-thing{display:block;width:100%;height:100%;overflow:hidden}.mykkro-html{overflow:hidden;position:relative}.mykkro-html > div{overflow:hidden;position:absolute;width:100%}.mykkro-ajax{width:auto;height:auto}.mykkro-empty{background-color:#aaa;border:1px solid #666;display:-moz-box;-moz-box-orient:horizontal;-moz-box-pack:center;-moz-box-align:center;display:-webkit-box;-webkit-box-orient:horizontal;-webkit-box-pack:center;-webkit-box-align:center;display:box;box-orient:horizontal;box-pack:center;box-align:center;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;font-size:12px;opacity:0.7}.mykkro-editable > .editable-pane{width:385px;height:530px;display:inline-block;padding:10px;border:1px gray solid}.mykkro-editable > .editable-editor{width:392px;height:540px;display:inline-block;vertical-align:top;margin-left:12px;overflow:auto}.mykkro-clickable > div{width:100%;height:100%}.mykkro-clickable > .clickable-pane{position:absolute;background-color:#666;left:0px;top:0px;opacity:0}.mykkro-clickable > .clickable-pane:hover{opacity:0.3}.mykkro-clickable{position:relative}.mykkro-soft-text-editor{width:500px;height:200px}.mykkro-soft-text-editor > .textfield{padding:5px;vertical-align:top;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;display:inline-block;width:80%;height:30%}.mykkro-soft-text-editor > .textfield > textarea{width:100%;height:100%;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:10px;padding:10px;padding:4px;border:1px solid black;font-size:20px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.mykkro-soft-text-editor > .btn{display:inline-block;width:20%;height:30%;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;padding:5px}.mykkro-soft-text-editor > .btn > button{-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:10px;padding:10px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;height:100%;text-align:center}.mykkro-soft-text-editor > .mykkro-soft-keyboard{height:70%}.mykkro-soft-keyboard > div{position:relative;height:100%}.mykkro-soft-keyboard > div .key{position:absolute;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;padding:5px}.mykkro-soft-keyboard > div .key > div{-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;text-align:center;width:100%;height:100%;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:10px;padding:10px}.mykkro-soft-keyboard > div .key.active > div{background-color:#cfc}.mykkro-soft-keyboard > div .key:hover > div{background-color:#aaa}.mykkro-soft-keyboard > div .key.active:hover > div{background-color:#afa}.mykkro-modal .mykkro-soft-text-editor{width:100%;height:550px}.mykkro-modal .mykkro-soft-text-editor .key{font-size:36px}.mykkro-modal .mykkro-soft-text-editor .key > div{padding-top:20px}.mykkro-modal .mykkro-soft-text-editor .key.key-caps,.mykkro-modal .mykkro-soft-text-editor .key.key-del,.mykkro-modal .mykkro-soft-text-editor .key.key-space,.mykkro-modal .mykkro-soft-text-editor .key.key-enter,.mykkro-modal .mykkro-soft-text-editor .key.key-nums{background:#ddd;background:-webkit-gradient(linear,left bottom,left top,color-stop(0,#bbb),color-stop(1,#ddd));background:-ms-linear-gradient(bottom,#bbb,#ddd);background:-moz-linear-gradient(center bottom,#bbb 0%,#ddd 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#dddddd', endColorstr='#bbbbbb', GradientType=0)}.mykkro-modal .mykkro-soft-text-editor .done{font-size:30px;background:#afa;background:-webkit-gradient(linear,left bottom,left top,color-stop(0,#4f4),color-stop(1,#afa));background:-ms-linear-gradient(bottom,#4f4,#afa);background:-moz-linear-gradient(center bottom,#4f4 0%,#afa 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#aaffaa', endColorstr='#44ff44', GradientType=0)}.mykkro-calendar > div{width:100%;height:100%}.mykkro-text-thing{display:table;overflow:hidden}.mykkro-html.mykkro-text-thing > div{position:relative;display:table-cell;vertical-align:middle;text-align:center;width:100%;margin:0 auto}.mykkro-html.mykkro-text-thing > div.top{vertical-align:top}.mykkro-html.mykkro-text-thing > div.bottom{vertical-align:bottom}.mykkro-html.mykkro-text-thing > div.left{text-align:left}.mykkro-html.mykkro-text-thing > div.right{text-align:right}.mykkro-html.mykkro-text-thing{font-size:20px;line-height:130%;font-family:Georgia, serif}.mykkro-preview > .mykkro-html.mykkro-text-thing{font-size:20px;line-height:20px}.mykkro-preview{-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;border:1px solid #333;background-color:white}.mykkro-preview .mykkro-empty > div{display:none}.mykkro-dummy{position:relative}.mykkro-dummy > div{overflow:hidden;position:absolute;width:100%}.mykkro-imager > div{width:100%;height:100%}.mykkro-centering-decorator{width:100%;height:100%;text-align:center;display:table}.mykkro-centering-decorator .center2{display:table-cell;vertical-align:middle}.mykkro-centering-decorator .center2 .center3{margin:0 auto;display:block}.mykkro-centering-decorator .center2 .center3 .content-inner{margin:0 auto;display:inline-block;text-align:left}.mykkro-page{border:1px solid black}#fullscreen{display:block;height:100%;overflow:hidden}#fullscreen #book-wrapper >.icon-turn-left{background-image:url("../images/icon-turn-left-256.png")}#fullscreen #book-wrapper >.icon-turn-right{background-image:url("../images/icon-turn-right-256.png")}#book-wrapper{margin:0 auto;background-repeat:repeat;padding:19px 59px;width:920px;height:600px;-webkit-border-top-right-radius:10px;-webkit-border-bottom-right-radius:10px;-webkit-border-bottom-left-radius:10px;-webkit-border-top-left-radius:10px;-moz-border-radius-topright:10px;-moz-border-radius-bottomright:10px;-moz-border-radius-bottomleft:10px;-moz-border-radius-topleft:10px;border-top-right-radius:10px;border-bottom-right-radius:10px;border-bottom-left-radius:10px;border-top-left-radius:10px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}#book-wrapper > .mykkro-book{margin:0 auto}.mykkro-book.turnable > div > div > .mykkro-slot{background-color:white;width:400px;height:560px}.mykkro-book.basic{width:auto;height:auto}.mykkro-book.basic > .mykkro-slot{background-color:white;width:500px;height:700px}.mykkro-flow-layout > div{display:inline-block;vertical-align:bottom;padding:5px}.mykkro-stack-layout{position:relative;width:100%;height:100%}.mykkro-stack-layout > div{position:absolute;overflow:hidden}.mykkro-split-layout{position:relative}.mykkro-split-layout > div{position:absolute;overflow:hidden}.mykkro-grid-layout{position:relative}.mykkro-grid-layout > div{position:absolute;overflow:hidden}.sudoku-board{display:table;table-layout:fixed;width:100%;height:100%;border:#aaa solid 2px;color:#777;border-spacing:0px;border-collapse:separate}.sudoku-row{display:table-row}.sudoku-square{display:table-cell}.sudoku-square-in{display:table;table-layout:fixed;width:100%;height:100%;border:#aaa solid 1px;color:#777;border-spacing:0px;border-collapse:separate}.sudoku-smallrow{display:table-row}.sudoku-cell{display:table-cell}.sudoku-cell-in{display:table;table-layout:fixed;width:100%;height:100%;border:#aaa dashed 1px;color:#777;border-spacing:0px;border-collapse:separate;text-align:center}.sudoku-cell-cell{display:table-cell;vertical-align:middle}.mykkro-player-controls > .controls{opacity:1}.mykkro-player-controls > .controls.playing{opacity:0.5}.mykkro-player-controls > .controls > button{width:128px;height:128px;background-size:100%;background-color:transparent;background-repeat:no-repeat;border:none;margin-right:10px}.mykkro-player-controls > .controls > button.play{background-image:url('../images/icons/128/media_playback_start.png')}.mykkro-player-controls > .controls > button.pause{background-image:url('../images/icons/128/media_playback_pause.png');width:80px;height:80px}.mykkro-player-controls > .controls > button.stop{background-image:url('../images/icons/128/media_playback_stop.png');width:80px;height:80px}.mykkro-player-controls > .controls > button > span{display:none}.mykkro-preview .mykkro-player-controls > .controls > button{width:32px;height:32px;margin-right:4px}.mykkro-preview .mykkro-player-controls > .controls > button.pause,.mykkro-preview .mykkro-player-controls > .controls > button.stop{width:24px;height:24px}.mykkro-audio-decorator{position:relative}.mykkro-audio-decorator > .player{position:absolute;left:0px;top:0px}.mykkro-audio-decorator > .player .controls{opacity:0.5}.mykkro-audio-decorator > .player .controls.playing{opacity:0.3}.mykkro-audio-decorator > .player:hover .controls{opacity:1}.mykkro-audio-decorator > .player:hover .controls.playing{opacity:0.5}.mykkro-audio-decorator > .slot{width:100%;height:100%}.mykkro-video-thing{position:relative}.mykkro-video-thing > .player{position:absolute;left:0px;top:0px}.mykkro-video-thing > .player .controls{opacity:0.5}.mykkro-video-thing > .player .controls.playing{opacity:0}.mykkro-video-thing > .player:hover .controls{opacity:1}.mykkro-video-thing > .player:hover .controls.playing{opacity:0.5}.mykkro-video-thing > video{width:100%;height:100%}.mykkro-toolbar-decorator-content{width:100%;height:100%}.mykkro-ref-decorator{position:relative}.mykkro-ref-decorator .mykkro-ref-decorator-content{width:100%;height:100%}.mykkro-ref-decorator .mykkro-ref-decorator-control{display:block;position:absolute;right:0px;bottom:0px}.ref-link{display:inline-block;opacity:0.3;background-color:#ccc;font-size:20px;font-weight:bold;font-family:Ubuntu, sans-serif;-webkit-border-top-right-radius:16px;-webkit-border-bottom-right-radius:16px;-webkit-border-bottom-left-radius:16px;-webkit-border-top-left-radius:16px;-moz-border-radius-topright:16px;-moz-border-radius-bottomright:16px;-moz-border-radius-bottomleft:16px;-moz-border-radius-topleft:16px;border-top-right-radius:16px;border-bottom-right-radius:16px;border-bottom-left-radius:16px;border-top-left-radius:16px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;padding:2px 8px}.ref-link:hover{opacity:0.8}.ref-tooltip > p{font-style:italic}.mykkro-ref-list{font-size:20px;font-weight:500;font-family:Ubuntu, sans-serif}.mykkro-ref-list > p{padding:8px}.mykkro-ref-list ul{position:relative}.mykkro-ref-list ul .ref-label{font-size:16px;padding:4px;color:#333}.mykkro-modal .mykkro-page-decorator{height:auto}.mykkro-modal .mykkro-ajax-pager .mykkro-ajax{height:530px}.panel-body .pager{padding:10px 0px}.panel-body .pager span,.panel-body .pager a{display:inline-block;margin:3px;width:30px;height:20px;line-height:20px;background-color:#def;border:1px solid #aaa;text-align:center}.panel-body .pager span{background-color:#abc;font-weight:bold}.mykkro-preview .mykkro-html.mykkro-text-thing{font-size:8px}.mykkro-ajax-pager > .pager-controls{text-align:center;padding:4px}.mykkro-ajax-pager > .pager-controls > *{padding:0px 4px}.mykkro-inset-decorator,.mykkro-border-decorator{-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.mykkro-rounded-decorator{-webkit-mask-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAA5JREFUeNpiYGBgAAgwAAAEAAGbA+oJAAAAAElFTkSuQmCC);overflow:hidden;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.pageditor-widget{position:relative}.pageditor-widget .mykkro-page{background-color:white}form #tree-view-container{background-color:azure}#tree-view-container{position:absolute;left:516px;top:0px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:#eeecdd;border:1px solid #aaa;padding:10px;width:390px;height:700px;overflow:auto}#tree-view{display:block;color:black}#tree-view h2{font-size:12px;padding:3px;height:12px;margin-bottom:2px}#tree-view h3{display:inline-block;float:left;font-size:12px;padding:3px;height:12px;display:inline-block;width:50px;margin-right:10px;margin-bottom:2px;text-align:center;-webkit-border-top-right-radius:10px;-webkit-border-bottom-right-radius:10px;-webkit-border-bottom-left-radius:10px;-webkit-border-top-left-radius:10px;-moz-border-radius-topright:10px;-moz-border-radius-bottomright:10px;-moz-border-radius-bottomleft:10px;-moz-border-radius-topleft:10px;border-top-right-radius:10px;border-bottom-right-radius:10px;border-bottom-left-radius:10px;border-top-left-radius:10px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;background-color:lightblue}#tree-view h3.collapsed{background-color:#ccc}#tree-view .node{display:block;margin-left:20px}#tree-view > .node{margin-left:0px}#tree-view .slots.collapsed{display:none}#tree-view .tools{display:inline-block}#tree-view .tools > .toolbar{position:relative;border:none;background:none}#tree-view h2{display:inline-block}body{width:100%;*zoom:1}body:before,body:after{content:"";display:table}body:after{clear:both}.icon-link-bg{display:inline-block}.panel .icon-link-bg,.dashboard-items .icon-link-bg,input[type='submit']{background-image:-moz-linear-gradient(top,#ddd,#c4c4c4);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#ddd),color-stop(1,#c4c4c4));border-radius:16px;border:1px solid #aaaaaa;-webkit-border-radius:16px;-moz-border-radius:16px;text-decoration:none;text-shadow:#ddd 0 1px 0;padding:3px 8px;margin:2px;display:inline-block}input[type='submit']{background-image:-moz-linear-gradient(top,#ccf,#9999ff);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#ccf),color-stop(1,#9999ff));color:#000;text-shadow:#ccf 0 1px 0;font-weight:normal;padding:5px 15px}input[type='submit']:hover{background-image:-moz-linear-gradient(top,#8f8fff,#5c5cff);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#8f8fff),color-stop(1,#5c5cff))}.panel .icon-link-bg.danger{background-image:-moz-linear-gradient(top,#fbb,#ff8888);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#fbb),color-stop(1,#ff8888));color:#000000;text-shadow:#fbb 0 1px 0;font-weight:normal}.panel .icon-link-bg.danger:hover{background-image:-moz-linear-gradient(top,#ff8383,#ff5050);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#ff8383),color-stop(1,#ff5050))}.panel .icon-link-bg.download{background-image:-moz-linear-gradient(top,#afa,#77ff77);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#afa),color-stop(1,#77ff77));color:#000000;text-shadow:#afa 0 1px 0;font-weight:normal}.panel .icon-link-bg.download:hover{background-image:-moz-linear-gradient(top,#77d977,#4fce4f);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#77d977),color-stop(1,#4fce4f))}.panel .icon-link-bg:hover,.dashboard-items .icon-link-bg:hover{background-image:-moz-linear-gradient(top,#c7c7c7,#adadad);background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#c7c7c7),color-stop(1,#adadad))}.icon-link{display:inline-block;height:16px;line-height:16px;padding-left:20px;font-size:13px}a.icon-link,a.icon-link:link,a.icon-link:hover,a.icon-link:visited,a.icon-link:active{font-weight:300;color:#000}.icon-button{display:inline-block;background-size:cover;background-repeat:no-repeat no-repeat}.icon{display:block;background-size:cover;background-repeat:no-repeat no-repeat}.icon-12,.icon-tiny{width:12px;height:12px}.icon-16,.icon-small{width:16px;height:16px}.icon-24,.icon-medium{width:24px;height:24px}.icon-32,.icon-big{width:32px;height:32px}.icon-48,.icon-huge{width:48px;height:48px}.icon-snippet{background-color:transparent;background-image:url('../images/icons/48/snippet.png');background-repeat:no-repeat;background-position:left top}.icon-book{background-color:transparent;background-image:url('../images/icons/48/book.png');background-repeat:no-repeat;background-position:left top}.icon-image{background-color:transparent;background-image:url('../images/icons/48/image.png');background-repeat:no-repeat;background-position:left top}.icon-image.icon-32{background-color:transparent;background-image:url('../images/icons/32/Picture.png');background-repeat:no-repeat;background-position:left top}.icon-drawing{background-color:transparent;background-image:url('../images/icons/48/drawing.png');background-repeat:no-repeat;background-position:left top}.icon-drawing.icon-32{background-color:transparent;background-image:url('../images/icons/32/Picture.png');background-repeat:no-repeat;background-position:left top}.icon-note{background-color:transparent;background-image:url('../images/icons/48/note.png');background-repeat:no-repeat;background-position:left top}.icon-fiddle{background-color:transparent;background-image:url('../images/icons/48/fiddle.png');background-repeat:no-repeat;background-position:left top}.icon-usergroup{background-color:transparent;background-image:url('../images/icons/48/usergroup.png');background-repeat:no-repeat;background-position:left top}.icon-membergroup{background-color:transparent;background-image:url('../images/icons/48/membergroup.png');background-repeat:no-repeat;background-position:left top}.icon-todo{background-color:transparent;background-image:url('../images/icons/48/todo.png');background-repeat:no-repeat;background-position:left top}.icon-profile{background-color:transparent;background-image:url('../images/icons/48/profile.png');background-repeat:no-repeat;background-position:left top}.icon-logger{background-color:transparent;background-image:url('../images/icons/48/logger.png');background-repeat:no-repeat;background-position:left top}.icon-nodetype{background-color:transparent;background-image:url('../images/icons/48/nodetype.png');background-repeat:no-repeat;background-position:left top}.icon-plot{background-color:transparent;background-image:url('../images/icons/48/plot.png');background-repeat:no-repeat;background-position:left top}.icon-expression{background-color:transparent;background-image:url('../images/icons/48/expression.png');background-repeat:no-repeat;background-position:left top}.icon-video{background-color:transparent;background-image:url('../images/icons/48/video.png');background-repeat:no-repeat;background-position:left top}.icon-video.icon-32{background-color:transparent;background-image:url('../images/icons/32/Movie.png');background-repeat:no-repeat;background-position:left top}.icon-voice.icon-32{background-color:transparent;background-image:url('../images/icons/32/speaker-icon.png');background-repeat:no-repeat;background-position:left top}.icon-voice{background-color:transparent;background-image:url('../images/icons/48/voice.png');background-repeat:no-repeat;background-position:left top}.icon-article{background-color:transparent;background-image:url('../images/icons/48/article.png');background-repeat:no-repeat;background-position:left top}.icon-article.icon-32{background-color:transparent;background-image:url('../images/icons/32/article.png');background-repeat:no-repeat;background-position:left top}.icon-text{background-color:transparent;background-image:url('../images/icons/32/Edit text.png');background-repeat:no-repeat;background-position:left top}.icon-design{background-color:transparent;background-image:url('../images/icons/48/design.png');background-repeat:no-repeat;background-position:left top}.icon-design.icon-32{background-color:transparent;background-image:url('../images/icons/32/layout.png');background-repeat:no-repeat;background-position:left top}.icon-settings{background-color:transparent;background-image:url('../images/icons/48/settings.png');background-repeat:no-repeat;background-position:left top}.icon-settings.icon-32{background-color:transparent;background-image:url('../images/icons/32/Settings.png');background-repeat:no-repeat;background-position:left top}.icon-show-all{background-color:transparent;background-image:url('../images/icons/16/show-all.png');background-repeat:no-repeat;background-position:left top}.icon-view{background-color:transparent;background-image:url('../images/icons/16/view.png');background-repeat:no-repeat;background-position:left top}.icon-edit{background-color:transparent;background-image:url('../images/icons/16/edit.png');background-repeat:no-repeat;background-position:left top}.icon-add-page{background-color:transparent;background-image:url('../images/icons/16/db_add.png');background-repeat:no-repeat;background-position:left top}.icon-remove-page{background-color:transparent;background-image:url('../images/icons/16/db_remove.png');background-repeat:no-repeat;background-position:left top}.icon-add{background-color:transparent;background-image:url('../images/icons/16/add.png');background-repeat:no-repeat;background-position:left top}.icon-remove-16{background-color:transparent;background-image:url('../images/icons/16/delete.png');background-repeat:no-repeat;background-position:left top}.icon-remove{background-color:transparent;background-image:url('../images/icons/32/Erase.png');background-repeat:no-repeat;background-position:left top}.icon-remove.icon-16{background-color:transparent;background-image:url('../images/icons/16/delete.png');background-repeat:no-repeat;background-position:left top}.icon-bomb{background-color:transparent;background-image:url('../images/icons/32/bomb.png');background-repeat:no-repeat;background-position:left top}.icon-favorites{background-color:transparent;background-image:url('../images/icons/32/Favourites.png');background-repeat:no-repeat;background-position:left top}.icon-export-16{background-color:transparent;background-image:url('../images/icons/16/Export.png');background-repeat:no-repeat;background-position:left top}.icon-export{background-color:transparent;background-image:url('../images/icons/32/Export.png');background-repeat:no-repeat;background-position:left top}.icon-export.icon-16{background-color:transparent;background-image:url('../images/icons/16/Export.png');background-repeat:no-repeat;background-position:left top}.icon-info{background-color:transparent;background-image:url('../images/icons/32/Info.png');background-repeat:no-repeat;background-position:left top}.icon-no{background-color:transparent;background-image:url('../images/icons/32/No.png');background-repeat:no-repeat;background-position:left top}.icon-ok{background-color:transparent;background-image:url('../images/icons/32/Ok.png');background-repeat:no-repeat;background-position:left top}.icon-tools{background-color:transparent;background-image:url('../images/icons/32/Tools.png');background-repeat:no-repeat;background-position:left top}.icon-play{background-color:transparent;background-image:url('../images/icons/32/Play.png');background-repeat:no-repeat;background-position:left top}.icon-preview{background-color:transparent;background-image:url('../images/icons/32/Preview.png');background-repeat:no-repeat;background-position:left top}.icon-refresh{background-color:transparent;background-image:url('../images/icons/32/Refresh.png');background-repeat:no-repeat;background-position:left top}.icon-undo{background-color:transparent;background-image:url('../images/icons/32/Undo.png');background-repeat:no-repeat;background-position:left top}.icon-yes{background-color:transparent;background-image:url('../images/icons/32/Yes.png');background-repeat:no-repeat;background-position:left top}.icon-warning{background-color:transparent;background-image:url('../images/icons/32/Warning.png');background-repeat:no-repeat;background-position:left top}.icon-default{background-color:transparent;background-image:url('../images/icons/32/Refresh.png');background-repeat:no-repeat;background-position:left top}.icon-home{background-color:transparent;background-image:url('../images/icons/48/kfm_home.png');background-repeat:no-repeat;background-position:left top}.icon-turn-left{background-color:transparent;background-image:url('../images/icons/48/left_turn.png');background-repeat:no-repeat;background-position:left top}.icon-turn-right{background-color:transparent;background-image:url('../images/icons/48/right_turn.png');background-repeat:no-repeat;background-position:left top}.icon-fullscreen-on{background-color:transparent;background-image:url('../images/icons/48/window_fullscreen.png');background-repeat:no-repeat;background-position:left top}.icon-fullscreen-off{background-color:transparent;background-image:url('../images/icons/48/window_nofullscreen.png');background-repeat:no-repeat;background-position:left top}.icon-closebook{background-color:transparent;background-image:url('../images/icons/48/fileclose-red.png');background-repeat:no-repeat;background-position:left top}.icon-hover{opacity:0.5}.icon-regex{background-color:transparent;background-image:url('../images/icons/48/regex.png');background-repeat:no-repeat;background-position:left top}.icon-formula{background-color:transparent;background-image:url('../images/icons/48/formula.png');background-repeat:no-repeat;background-position:left top}.icon-search{background-color:transparent;background-image:url('../images/icons/48/search.png');background-repeat:no-repeat;background-position:left top}.icon-help{background-color:transparent;background-image:url('../images/icons/48/help.png');background-repeat:no-repeat;background-position:left top}.previews > ul > li{position:relative;background-color:#a6c4e1;padding-top:5px;padding-bottom:5px}.previews > ul > li:nth-child(odd){background-color:#cde}.preview{-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;display:block;position:relative;float:left;padding-left:70px;width:100%;min-height:68px}.preview.icon-only{width:68px;height:68px;padding:10px}.preview.image-preview.icon-only{width:100px;height:100px;padding:10px}.preview.video-preview.icon-only{width:200px;height:140px;padding:10px}.preview.drawing-preview.icon-only{width:120px;height:120px;padding:10px}.preview.design-preview.icon-only{width:104px;height:134px;padding:0px}.design-preview{min-height:134px;padding:10px 10px 10px 110px}.image-preview{padding:10px 10px 10px 100px;min-height:100px}.video-preview{padding-left:200px;min-height:140px}.video-preview img{width:180px;height:120px}.drawing-preview{padding-left:120px;min-height:120px}.drawing-preview .drawing-wrapper{width:100px;height:100px}.preview .media-icon{width:48px;height:48px}.preview .media-icon-small{width:24px;height:24px}.preview .media-icon,.image-preview img,.video-preview img,.design-preview .mykkro-preview,.drawing-preview .drawing-wrapper{position:absolute;top:10px;left:10px}.preview .media-icon > svg,.image-preview img > svg,.video-preview img > svg,.design-preview .mykkro-preview > svg,.drawing-preview .drawing-wrapper > svg{position:absolute}.preview h3{font-family:'Quattrocento Sans', sans-serif;font-weight:bold;font-size:20px}.preview .description{font-style:italic;color:#333;margin-bottom:6px}.preview .reference{margin-bottom:6px;font-size:80%}.preview .tags{margin-bottom:6px;font-size:80%}.preview .times{font-size:80%;color:#666}.previews{margin-top:16px;margin-bottom:16px}.previews.single{margin:0}.media-icon{width:48px;height:48px}.touchpad-widget{width:200px;height:200px;background-color:#abc;display:block;position:relative}.touchpad-widget > .pointer{position:absolute;left:0px;top:0px;width:10px;height:10px;background-color:blue}ul.dashboard-menu{list-style:none;margin:0;padding:0;display:block}ul.dashboard-menu li{margin:2px 0px;display:inline-block;vertical-align:top;width:90px;height:90px;background:#eef;background:-moz-linear-gradient(-45deg,#eef 0%,#ccf 100%);background:-webkit-gradient(linear,left top,right bottom,color-stop(0%,#eef),color-stop(100%,#ccf));background:-webkit-linear-gradient(-45deg,#eef 0%,#ccf 100%);background:-o-linear-gradient(-45deg,#eef 0%,#ccf 100%);background:-ms-linear-gradient(-45deg,#eef 0%,#ccf 100%);background:linear-gradient(135deg,#eef 0%,#ccf 100%);text-align:center;font-size:12px;overflow:hidden}ul.dashboard-menu li .dashboard-icon{margin:4px auto}ul.dashboard-menu li a{width:100%;height:100%;display:block;color:black;font-weight:300}ul.dashboard-menu li:hover{background:#eee;background:-moz-linear-gradient(-45deg,#eee 0%,#ccc 100%);background:-webkit-gradient(linear,left top,right bottom,color-stop(0%,#eee),color-stop(100%,#ccc));background:-webkit-linear-gradient(-45deg,#eee 0%,#ccc 100%);background:-o-linear-gradient(-45deg,#eee 0%,#ccc 100%);background:-ms-linear-gradient(-45deg,#eee 0%,#ccc 100%);background:linear-gradient(135deg,#eee 0%,#ccc 100%)}ul.dashboard-menu li.active{background:#fff;background:-moz-linear-gradient(-45deg,#fff 0%,#ddd 100%);background:-webkit-gradient(linear,left top,right bottom,color-stop(0%,#fff),color-stop(100%,#ddd));background:-webkit-linear-gradient(-45deg,#fff 0%,#ddd 100%);background:-o-linear-gradient(-45deg,#fff 0%,#ddd 100%);background:-ms-linear-gradient(-45deg,#fff 0%,#ddd 100%);background:linear-gradient(135deg,#fff 0%,#ddd 100%)}ul.dashboard-menu li.active:hover{background:#eee;background:-moz-linear-gradient(-45deg,#eee 0%,#bbb 100%);background:-webkit-gradient(linear,left top,right bottom,color-stop(0%,#eee),color-stop(100%,#bbb));background:-webkit-linear-gradient(-45deg,#eee 0%,#bbb 100%);background:-o-linear-gradient(-45deg,#eee 0%,#bbb 100%);background:-ms-linear-gradient(-45deg,#eee 0%,#bbb 100%);background:linear-gradient(135deg,#eee 0%,#bbb 100%)}.dashboard-items{margin:10px 0px}.dashboard-icon{width:48px;height:48px}ul.etabs{margin-bottom:12px}.tab-container .panel-container{background:#fff;border:solid #666 1px;padding:10px;-moz-border-radius:0 4px 4px 4px;-webkit-border-radius:0 4px 4px 4px}.datagrid-info{margin-bottom:10px;font-weight:bolder}.datagrid table{border-collapse:collapse;text-align:left;width:100%}.datagrid{font:normal 12px/150% Arial, Helvetica, sans-serif;background:#fff;overflow:hidden;border:1px solid #8C8C8C;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px}.datagrid table td,.datagrid table th{padding:3px 10px}.datagrid table thead th{background:-webkit-gradient(linear,left top,left bottom,color-stop(0.05,#8C8C8C),color-stop(1,#7D7D7D));background:-moz-linear-gradient(center top,#8C8C8C 5%,#7D7D7D 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#8C8C8C',endColorstr='#7D7D7D');background-color:#8C8C8C;color:#FFFFFF;font-size:15px;font-weight:bold;border-left:1px solid #A3A3A3}.datagrid table thead th:first-child{border:none}.datagrid table tbody td{color:#7D7D7D;border-left:1px solid #DBDBDB;font-size:12px;font-weight:normal}.datagrid table tbody .alt td{background:#EBEBEB;color:#7D7D7D}.datagrid table tbody td:first-child{border-left:none}.datagrid table tbody tr:last-child td{border-bottom:none}.datagrid table tfoot td div{border-top:1px solid #8C8C8C;background:#EBEBEB}.datagrid table tfoot td{padding:0;font-size:12px}.datagrid table tfoot td div{padding:2px}.datagrid table tfoot td ul{margin:0;padding:0;list-style:none;text-align:right}.datagrid table tfoot li{display:inline}.datagrid table tfoot li a{text-decoration:none;display:inline-block;padding:2px 8px;margin:1px;color:#F5F5F5;border:1px solid #8C8C8C;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;background:-webkit-gradient(linear,left top,left bottom,color-stop(0.05,#8C8C8C),color-stop(1,#7D7D7D));background:-moz-linear-gradient(center top,#8C8C8C 5%,#7D7D7D 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#8C8C8C',endColorstr='#7D7D7D');background-color:#8C8C8C}.datagrid table tfoot ul a.active,.datagrid table tfoot ul a:hover{text-decoration:none;border-color:#7D7D7D;color:#F5F5F5;background:none;background-color:#8C8C8C}input.search{padding:6px 15px 6px 30px;margin:3px;background:url('../images/search.png') no-repeat 8px 6px}input.rounded{border-radius:15px;-moz-border-radius:15px;-webkit-border-radius:15px}input.search[type=text]{color:#bcbcbc;width:400px}form.lighter{padding:5px;border:1px solid #aaa;background-color:#cdcdcd;margin-bottom:10px}form.lighter input[type=text]{border:1px solid #d0d0d0;background-color:#fcfcfc;margin-right:10px}form.lighter fieldset{margin:0px;border:none}form.lighter .sf-nodes li{display:inline-block;margin-right:10px;width:150px}a.search-type-switcher{margin-left:20px;font-size:85%;color:#666}a.search-nodes-all,a.search-nodes-none{margin-right:10px;font-size:85%;color:#666}.sf-nodes ul{margin:12px 0px 6px 0px}.search-result > p{margin-bottom:10px}.search-result .pagination-links a{margin-right:10px;font-size:85%;color:#666}.search-result .previews ol{counter-reset:item;list-style:none}.search-result .previews ol > li{padding:10px 4px;display:list-item;position:relative;font-size:28px;background-color:#a6c4e1}.search-result .previews ol > li:nth-child(odd){background-color:#cde}.search-result .previews ol > li >h3,.search-result .previews ol > li >div,.search-result .previews ol > li >a{font-size:12px}.search-result .previews ol > li:before{content:counter(item) ". ";counter-increment:item;float:left;text-align:right;width:50px}.search-result .previews ol .sf-node{position:relative}.search-result .previews ol .sf-node .title{font-size:16px;font-weight:bold}.search-result .previews ol .sf-node .title a:link{color:#044}.search-result .previews ol .sf-node .title a:hover{color:#033}.search-result .previews ol .sf-node .title.untitled a:link{color:#666}.search-result .previews ol .sf-node .title.untitled a:hover{color:#333}.search-result .previews ol .sf-node .type-title{font-size:12px;font-weight:normal}.search-result .previews ol .sf-node .type-title a:link{color:#aaa}.search-result .previews ol .sf-node .type-title a:hover{color:#666}.search-result .previews ol .sf-node .description{font-size:12px;color:#333;margin-bottom:6px}.search-result .previews ol .sf-node .modified{font-size:10px;color:#666}.search-result .previews.preview-test ol > li > .sf-node-overlay{position:absolute;width:100%;height:100%;z-index:100;top:0;left:0}.search-result .previews.preview-test ol > li > .sf-node-overlay:hover{background-color:cyan;opacity:0.3}.search-result .previews.preview-test ol > li > .sf-node-overlay.preview-loading,.search-result .previews.preview-test ol > li > .sf-node-overlay.preview-loading:hover{background-color:red;opacity:0.1}.search-result .previews.preview-test ol > li .sf-node-preview{position:relative;display:inline-block;vertical-align:top;margin:0px 8px}.search-result .previews.preview-test ol > li .sf-node-info{display:inline-block;vertical-align:top}.search-result .previews.preview-test ol .sf-avatar{width:24px;height:24px;position:absolute;right:-5px;bottom:-5px;display:none}.usergroup-avatar{display:inline-block;vertical-align:top}.usergroup-other{display:inline-block;vertical-align:top}.usergroup-user .avatar{width:68px;height:68px}.usergroup-user .avatar img{width:100%;height:100%}.usergroup-user{background-color:#ccb;padding:4px}.usergroup-user.odd{background-color:#ddc}.usergroup-user.member{background-color:#cfc}.usergroup-user.member.odd{background-color:#dfd}.usergroup-user .role{font-style:italic;font-size:90%;color:#333;margin-bottom:4px}.usergroup-user .joined{font-size:80%;color:#666;margin-bottom:4px}.usergroup-detail h6{margin-bottom:8px}.usergroup-detail{margin-bottom:20px}#snippet-content-wrapper{position:relative;width:800px;height:400px}#SnippetContent{display:none}.ribbon{background-color:#a00;overflow:hidden;position:absolute;right:-80px;top:-30px;-moz-transform:rotate(45deg);-webkit-transform:rotate(45deg);-moz-box-shadow:0 0 1em #888;-webkit-box-shadow:0 0 1em #888}.ribbon a:link,.ribbon a:visited{border:1px solid #faa;color:#fff;display:block;font:bold 81.25% 'Helvetiva Neue', Helvetica, Arial, sans-serif;margin:0.05em 0;padding:0.5em 3.5em;text-align:center;text-decoration:none;text-shadow:0 0 0.5em #444}html{font-size:14px;font-family:'Ubuntu', sans-serif;font-weight:300;background-color:#cdcdcd}body{height:100%}#container{width:960px;margin:0 auto;overflow:hidden}#container{background-color:none}#breadcrumb{font-size:13px;padding:6px;float:left}#header{width:100%;padding:10px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.logo{background:#eef url(../images/logo-scrapbook.png) no-repeat left top;width:268px;height:74px;display:inline-block;float:left}.user-controls{font-size:13px;padding:6px;float:right}#content{-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;margin:0px;width:100%}#content #accordion{background-color:#bbb}#content #accordion .ui-accordion-content{border-left:1px solid #aaa;border-right:1px solid #aaa;border-bottom:1px solid #aaa}#footer{width:100%;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;color:#666;padding:16px;text-align:center}h1,h2,h3,h4,h5,h6{font-weight:bolder}h1{font-size:40px;margin-bottom:10px}h2{font-size:34px;margin-bottom:10px}h3{font-size:28px;margin-bottom:8px}h4{font-size:24px;margin-bottom:6px}h5{font-size:20px;margin-bottom:5px}h6{font-size:16px;margin-bottom:4px}strong,b{font-weight:bold}em,i{font-style:italic}a:link{text-decoration:none;font-weight:normal;color:#008}a:visited{text-decoration:none;font-weight:normal;color:#008}a:hover{text-decoration:none;font-weight:normal;color:brown}a:active{text-decoration:none;font-weight:normal;color:#008}.clear{clear:both}.ui-accordion-header > a{margin-left:20px}.ui-dialog .ui-dialog-titlebar{background-color:#acf}.ui-dialog .ui-dialog-titlebar .ui-dialog-titlebar-close{margin-top:-10px !important;margin-right:10px !important;padding-top:0px !important}.logged-user .info{margin-right:10px}.autoform form{margin-bottom:1em;background:#eed;border:1px solid #ddd;-webkit-border-radius:2px;-moz-border-radius:2px;border-radius:2px;-moz-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);-webkit-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);-o-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);box-shadow:0 0 8px 2px rgba(0,0,0,0.1);padding:15px;background:#E8e3b1}.autoform form legend{font-weight:bolder;font-size:18px}.autoform form fieldset{padding:10px;background:#e2dc9d;border:1px solid #dcd58a}.autoform form label{padding-bottom:4px}.message{margin:1em;-webkit-border-radius:salmon;-moz-border-radius:salmon;border-radius:salmon;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:salmon;padding:10px;color:black;font-weight:bolder;font-size:16px}#authMessage{background-color:orange}.autoform fieldset{margin-bottom:16px}.autoform label{display:block;font-size:90%;margin-top:6px}.autoform .input input:not([type=submit]):not([type=file]),.autoform .input textarea{width:400px}.richtextfield textarea{width:250px;height:160px}#UserLoginForm fieldset input{width:150px}.input .error-message{color:red;font-size:90%;padding:6px}.panel{margin-bottom:1em;background:#eed;border:1px solid #ddd;-webkit-border-radius:2px;-moz-border-radius:2px;border-radius:2px;-moz-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);-webkit-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);-o-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);box-shadow:0 0 8px 2px rgba(0,0,0,0.1);padding:15px}.panel.main{background:#eed;border:1px solid #ddd;-webkit-border-radius:2px;-moz-border-radius:2px;border-radius:2px;-moz-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);-webkit-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);-o-box-shadow:0 0 8px 2px rgba(0,0,0,0.1);box-shadow:0 0 8px 2px rgba(0,0,0,0.1);padding:15px;background:#fea}.panel.headless .panel-body{margin:0}.avatar{width:90px;height:90px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:#ffe;padding:4px}.user-info .avatar{display:inline-block;vertical-align:top;margin-right:20px}.user-info .other{display:inline-block;vertical-align:top}.panel-body{margin-top:20px}.panel-actions{margin-top:20px}.image-detail > .panel-body > img{max-width:100%}.splash{margin:1em;-webkit-border-radius:maroon;-moz-border-radius:maroon;border-radius:maroon;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:maroon;padding:10px}.splash > ul{margin:20px}.splash > ul > li{font-weight:bolder}.splash > p{margin-bottom:10px}.actions{margin-top:8px}.node >.node-field{padding:5px;-webkit-border-radius:azure;-moz-border-radius:azure;border-radius:azure;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:azure;padding:10px;margin-bottom:5px}.node >.node-field > h3{font-size:14px}.node >.node-field > h4{font-size:12px;font-weight:lighter;color:gray}.mykkro-page-editor-links{margin:6px 0px}.mykkro-page-editor-links > span{display:inline-block;margin-right:2px;padding:4px}.mykkro-page-editor-links > span.number-link{-webkit-border-radius:#eec;-moz-border-radius:#eec;border-radius:#eec;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:#eec;padding:10px;padding:4px;text-align:center}.mykkro-page-editor-links > span.number-link.current{border:2px solid #a00}.mykkro-page-editor-links > span.disabled{display:none}.Web_OnlineTools_Logo{float:left;padding:8px}.Web_OnlineTools_Logo h1{border:0px;margin:0px;padding:0px;text-align:center;text-indent:0px;font-size:40x;line-height:46px;font-family:Trebuchet MS;color:#284460;font-weight:bold;text-shadow:0px 0px 9px #000000}.Web_OnlineTools_Logo h2{border:0px;margin:0px;padding:0px;text-align:center;text-indent:24px;font-size:15px;line-height:20px;font-style:italic;font-family:Trebuchet MS;color:#74777a;text-shadow:-1px 1px 17px #000000}.imagesearch-widget{display:inline-block}.imagesearch-widget .imagesearch-preview{width:50px;height:68px;display:inline-block;margin:8px;vertical-align:top;background-color:#ddf}.imagesearch-widget > button{display:inline-block;vertical-align:top;margin-top:8px}.form .pageditor-widget .mykkro-empty:hover{background-color:#bbb;border:2px dotted #666}.tubeplayer-wrapper{position:relative;width:100%;height:100%;margin:0;padding:0}.tubeplayer-container{width:100%;height:100%;margin:0;padding:0}.tubeplayer-glasspane{width:100%;height:100%;position:absolute;top:0px;left:0px}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: slovensko\css\viewer.css
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\slovensko\css\viewer.css
VELIKOST: 1315 B (1.28 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
/* http://meyerweb.com/eric/tools/css/reset/ 
   v2.0b1 | 201101 
   NOTE: WORK IN PROGRESS
   USE WITH CAUTION AND TEST WITH ABANDON */

html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section, summary,
time, mark, audio, video {
	margin: 0;
	padding: 0;
	border: 0;
	outline: 0;
	font-size: 100%;
	font: inherit;
	vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section {
	display: block;
}
body {
	line-height: 1;
}
ol, ul {
	list-style: none;
}
blockquote, q {
	quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
	content: '';
	content: none;
}

/* remember to define visible focus styles! 
:focus {
	outline: ?????;
} */

/* remember to highlight inserts somehow! */
ins {
	text-decoration: none;
}
del {
	text-decoration: line-through;
}

table {
	border-collapse: collapse;
	border-spacing: 0;
}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: slovensko\js\libs-viewer.js
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\slovensko\js\libs-viewer.js
VELIKOST: 433967 B (423.80 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
/*! jQuery v2.0.3 | (c) 2005, 2013 jQuery Foundation, Inc. | jquery.org/license
//@ sourceMappingURL=jquery-2.0.3.min.map
*/
(function(e,undefined){var t,n,r=typeof undefined,i=e.location,o=e.document,s=o.documentElement,a=e.jQuery,u=e.$,l={},c=[],p="2.0.3",f=c.concat,h=c.push,d=c.slice,g=c.indexOf,m=l.toString,y=l.hasOwnProperty,v=p.trim,x=function(e,n){return new x.fn.init(e,n,t)},b=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,w=/\S+/g,T=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,C=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,k=/^-ms-/,N=/-([\da-z])/gi,E=function(e,t){return t.toUpperCase()},S=function(){o.removeEventListener("DOMContentLoaded",S,!1),e.removeEventListener("load",S,!1),x.ready()};x.fn=x.prototype={jquery:p,constructor:x,init:function(e,t,n){var r,i;if(!e)return this;if("string"==typeof e){if(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:T.exec(e),!r||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof x?t[0]:t,x.merge(this,x.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:o,!0)),C.test(r[1])&&x.isPlainObject(t))for(r in t)x.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return i=o.getElementById(r[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):x.isFunction(e)?n.ready(e):(e.selector!==undefined&&(this.selector=e.selector,this.context=e.context),x.makeArray(e,this))},selector:"",length:0,toArray:function(){return d.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=x.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return x.each(this,e,t)},ready:function(e){return x.ready.promise().done(e),this},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(x.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:h,sort:[].sort,splice:[].splice},x.fn.init.prototype=x.fn,x.extend=x.fn.extend=function(){var e,t,n,r,i,o,s=arguments[0]||{},a=1,u=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[1]||{},a=2),"object"==typeof s||x.isFunction(s)||(s={}),u===a&&(s=this,--a);u>a;a++)if(null!=(e=arguments[a]))for(t in e)n=s[t],r=e[t],s!==r&&(l&&r&&(x.isPlainObject(r)||(i=x.isArray(r)))?(i?(i=!1,o=n&&x.isArray(n)?n:[]):o=n&&x.isPlainObject(n)?n:{},s[t]=x.extend(l,o,r)):r!==undefined&&(s[t]=r));return s},x.extend({expando:"jQuery"+(p+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===x&&(e.$=u),t&&e.jQuery===x&&(e.jQuery=a),x},isReady:!1,readyWait:1,holdReady:function(e){e?x.readyWait++:x.ready(!0)},ready:function(e){(e===!0?--x.readyWait:x.isReady)||(x.isReady=!0,e!==!0&&--x.readyWait>0||(n.resolveWith(o,[x]),x.fn.trigger&&x(o).trigger("ready").off("ready")))},isFunction:function(e){return"function"===x.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[m.call(e)]||"object":typeof e},isPlainObject:function(e){if("object"!==x.type(e)||e.nodeType||x.isWindow(e))return!1;try{if(e.constructor&&!y.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||o;var r=C.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=x.buildFragment([e],t,i),i&&x(i).remove(),x.merge([],r.childNodes))},parseJSON:JSON.parse,parseXML:function(e){var t,n;if(!e||"string"!=typeof e)return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(r){t=undefined}return(!t||t.getElementsByTagName("parsererror").length)&&x.error("Invalid XML: "+e),t},noop:function(){},globalEval:function(e){var t,n=eval;e=x.trim(e),e&&(1===e.indexOf("use strict")?(t=o.createElement("script"),t.text=e,o.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(k,"ms-").replace(N,E)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,o=e.length,s=j(e);if(n){if(s){for(;o>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(s){for(;o>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:function(e){return null==e?"":v.call(e)},makeArray:function(e,t){var n=t||[];return null!=e&&(j(Object(e))?x.merge(n,"string"==typeof e?[e]:e):h.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:g.call(t,e,n)},merge:function(e,t){var n=t.length,r=e.length,i=0;if("number"==typeof n)for(;n>i;i++)e[r++]=t[i];else while(t[i]!==undefined)e[r++]=t[i++];return e.length=r,e},grep:function(e,t,n){var r,i=[],o=0,s=e.length;for(n=!!n;s>o;o++)r=!!t(e[o],o),n!==r&&i.push(e[o]);return i},map:function(e,t,n){var r,i=0,o=e.length,s=j(e),a=[];if(s)for(;o>i;i++)r=t(e[i],i,n),null!=r&&(a[a.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(a[a.length]=r);return f.apply([],a)},guid:1,proxy:function(e,t){var n,r,i;return"string"==typeof t&&(n=e[t],t=e,e=n),x.isFunction(e)?(r=d.call(arguments,2),i=function(){return e.apply(t||this,r.concat(d.call(arguments)))},i.guid=e.guid=e.guid||x.guid++,i):undefined},access:function(e,t,n,r,i,o,s){var a=0,u=e.length,l=null==n;if("object"===x.type(n)){i=!0;for(a in n)x.access(e,t,a,n[a],!0,o,s)}else if(r!==undefined&&(i=!0,x.isFunction(r)||(s=!0),l&&(s?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(x(e),n)})),t))for(;u>a;a++)t(e[a],n,s?r:r.call(e[a],a,t(e[a],n)));return i?e:l?t.call(e):u?t(e[0],n):o},now:Date.now,swap:function(e,t,n,r){var i,o,s={};for(o in t)s[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=s[o];return i}}),x.ready.promise=function(t){return n||(n=x.Deferred(),"complete"===o.readyState?setTimeout(x.ready):(o.addEventListener("DOMContentLoaded",S,!1),e.addEventListener("load",S,!1))),n.promise(t)},x.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()});function j(e){var t=e.length,n=x.type(e);return x.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}t=x(o),function(e,undefined){var t,n,r,i,o,s,a,u,l,c,p,f,h,d,g,m,y,v="sizzle"+-new Date,b=e.document,w=0,T=0,C=st(),k=st(),N=st(),E=!1,S=function(e,t){return e===t?(E=!0,0):0},j=typeof undefined,D=1<<31,A={}.hasOwnProperty,L=[],q=L.pop,H=L.push,O=L.push,F=L.slice,P=L.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",W="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",$=W.replace("w","w#"),B="\\["+M+"*("+W+")"+M+"*(?:([*^$|!~]?=)"+M+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+$+")|)|)"+M+"*\\]",I=":("+W+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+B.replace(3,8)+")*)|.*)\\)|)",z=RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),_=RegExp("^"+M+"*,"+M+"*"),X=RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=RegExp(M+"*[+~]"),Y=RegExp("="+M+"*([^\\]'\"]*)"+M+"*\\]","g"),V=RegExp(I),G=RegExp("^"+$+"$"),J={ID:RegExp("^#("+W+")"),CLASS:RegExp("^\\.("+W+")"),TAG:RegExp("^("+W.replace("w","w*")+")"),ATTR:RegExp("^"+B),PSEUDO:RegExp("^"+I),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:RegExp("^(?:"+R+")$","i"),needsContext:RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Q=/^[^{]+\{\s*\[native \w/,K=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Z=/^(?:input|select|textarea|button)$/i,et=/^h\d$/i,tt=/'|\\/g,nt=RegExp("\\\\([\\da-f]{1,6}"+M+"?|("+M+")|.)","ig"),rt=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(55296|r>>10,56320|1023&r)};try{O.apply(L=F.call(b.childNodes),b.childNodes),L[b.childNodes.length].nodeType}catch(it){O={apply:L.length?function(e,t){H.apply(e,F.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}function ot(e,t,r,i){var o,s,a,u,l,f,g,m,x,w;if((t?t.ownerDocument||t:b)!==p&&c(t),t=t||p,r=r||[],!e||"string"!=typeof e)return r;if(1!==(u=t.nodeType)&&9!==u)return[];if(h&&!i){if(o=K.exec(e))if(a=o[1]){if(9===u){if(s=t.getElementById(a),!s||!s.parentNode)return r;if(s.id===a)return r.push(s),r}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(a))&&y(t,s)&&s.id===a)return r.push(s),r}else{if(o[2])return O.apply(r,t.getElementsByTagName(e)),r;if((a=o[3])&&n.getElementsByClassName&&t.getElementsByClassName)return O.apply(r,t.getElementsByClassName(a)),r}if(n.qsa&&(!d||!d.test(e))){if(m=g=v,x=t,w=9===u&&e,1===u&&"object"!==t.nodeName.toLowerCase()){f=gt(e),(g=t.getAttribute("id"))?m=g.replace(tt,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",l=f.length;while(l--)f[l]=m+mt(f[l]);x=U.test(e)&&t.parentNode||t,w=f.join(",")}if(w)try{return O.apply(r,x.querySelectorAll(w)),r}catch(T){}finally{g||t.removeAttribute("id")}}}return kt(e.replace(z,"$1"),t,r,i)}function st(){var e=[];function t(n,r){return e.push(n+=" ")>i.cacheLength&&delete t[e.shift()],t[n]=r}return t}function at(e){return e[v]=!0,e}function ut(e){var t=p.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function lt(e,t){var n=e.split("|"),r=e.length;while(r--)i.attrHandle[n[r]]=t}function ct(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||D)-(~e.sourceIndex||D);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function pt(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function ft(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ht(e){return at(function(t){return t=+t,at(function(n,r){var i,o=e([],n.length,t),s=o.length;while(s--)n[i=o[s]]&&(n[i]=!(r[i]=n[i]))})})}s=ot.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},n=ot.support={},c=ot.setDocument=function(e){var t=e?e.ownerDocument||e:b,r=t.defaultView;return t!==p&&9===t.nodeType&&t.documentElement?(p=t,f=t.documentElement,h=!s(t),r&&r.attachEvent&&r!==r.top&&r.attachEvent("onbeforeunload",function(){c()}),n.attributes=ut(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=ut(function(e){return e.appendChild(t.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=ut(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),n.getById=ut(function(e){return f.appendChild(e).id=v,!t.getElementsByName||!t.getElementsByName(v).length}),n.getById?(i.find.ID=function(e,t){if(typeof t.getElementById!==j&&h){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},i.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){return e.getAttribute("id")===t}}):(delete i.find.ID,i.filter.ID=function(e){var t=e.replace(nt,rt);return function(e){var n=typeof e.getAttributeNode!==j&&e.getAttributeNode("id");return n&&n.value===t}}),i.find.TAG=n.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==j?t.getElementsByTagName(e):undefined}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},i.find.CLASS=n.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==j&&h?t.getElementsByClassName(e):undefined},g=[],d=[],(n.qsa=Q.test(t.querySelectorAll))&&(ut(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||d.push("\\["+M+"*(?:value|"+R+")"),e.querySelectorAll(":checked").length||d.push(":checked")}),ut(function(e){var n=t.createElement("input");n.setAttribute("type","hidden"),e.appendChild(n).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&d.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||d.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),d.push(",.*:")})),(n.matchesSelector=Q.test(m=f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&ut(function(e){n.disconnectedMatch=m.call(e,"div"),m.call(e,"[s!='']:x"),g.push("!=",I)}),d=d.length&&RegExp(d.join("|")),g=g.length&&RegExp(g.join("|")),y=Q.test(f.contains)||f.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},S=f.compareDocumentPosition?function(e,r){if(e===r)return E=!0,0;var i=r.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(r);return i?1&i||!n.sortDetached&&r.compareDocumentPosition(e)===i?e===t||y(b,e)?-1:r===t||y(b,r)?1:l?P.call(l,e)-P.call(l,r):0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,n){var r,i=0,o=e.parentNode,s=n.parentNode,a=[e],u=[n];if(e===n)return E=!0,0;if(!o||!s)return e===t?-1:n===t?1:o?-1:s?1:l?P.call(l,e)-P.call(l,n):0;if(o===s)return ct(e,n);r=e;while(r=r.parentNode)a.unshift(r);r=n;while(r=r.parentNode)u.unshift(r);while(a[i]===u[i])i++;return i?ct(a[i],u[i]):a[i]===b?-1:u[i]===b?1:0},t):p},ot.matches=function(e,t){return ot(e,null,null,t)},ot.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&c(e),t=t.replace(Y,"='$1']"),!(!n.matchesSelector||!h||g&&g.test(t)||d&&d.test(t)))try{var r=m.call(e,t);if(r||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(i){}return ot(t,p,null,[e]).length>0},ot.contains=function(e,t){return(e.ownerDocument||e)!==p&&c(e),y(e,t)},ot.attr=function(e,t){(e.ownerDocument||e)!==p&&c(e);var r=i.attrHandle[t.toLowerCase()],o=r&&A.call(i.attrHandle,t.toLowerCase())?r(e,t,!h):undefined;return o===undefined?n.attributes||!h?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null:o},ot.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},ot.uniqueSort=function(e){var t,r=[],i=0,o=0;if(E=!n.detectDuplicates,l=!n.sortStable&&e.slice(0),e.sort(S),E){while(t=e[o++])t===e[o]&&(i=r.push(o));while(i--)e.splice(r[i],1)}return e},o=ot.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=o(t);return n},i=ot.selectors={cacheLength:50,createPseudo:at,match:J,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(nt,rt),e[3]=(e[4]||e[5]||"").replace(nt,rt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ot.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ot.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return J.CHILD.test(e[0])?null:(e[3]&&e[4]!==undefined?e[2]=e[4]:n&&V.test(n)&&(t=gt(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(nt,rt).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=C[e+" "];return t||(t=RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&C(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==j&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=ot.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var l,c,p,f,h,d,g=o!==s?"nextSibling":"previousSibling",m=t.parentNode,y=a&&t.nodeName.toLowerCase(),x=!u&&!a;if(m){if(o){while(g){p=t;while(p=p[g])if(a?p.nodeName.toLowerCase()===y:1===p.nodeType)return!1;d=g="only"===e&&!d&&"nextSibling"}return!0}if(d=[s?m.firstChild:m.lastChild],s&&x){c=m[v]||(m[v]={}),l=c[e]||[],h=l[0]===w&&l[1],f=l[0]===w&&l[2],p=h&&m.childNodes[h];while(p=++h&&p&&p[g]||(f=h=0)||d.pop())if(1===p.nodeType&&++f&&p===t){c[e]=[w,h,f];break}}else if(x&&(l=(t[v]||(t[v]={}))[e])&&l[0]===w)f=l[1];else while(p=++h&&p&&p[g]||(f=h=0)||d.pop())if((a?p.nodeName.toLowerCase()===y:1===p.nodeType)&&++f&&(x&&((p[v]||(p[v]={}))[e]=[w,f]),p===t))break;return f-=i,f===r||0===f%r&&f/r>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||ot.error("unsupported pseudo: "+e);return r[v]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?at(function(e,n){var i,o=r(e,t),s=o.length;while(s--)i=P.call(e,o[s]),e[i]=!(n[i]=o[s])}):function(e){return r(e,0,n)}):r}},pseudos:{not:at(function(e){var t=[],n=[],r=a(e.replace(z,"$1"));return r[v]?at(function(e,t,n,i){var o,s=r(e,null,i,[]),a=e.length;while(a--)(o=s[a])&&(e[a]=!(t[a]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),!n.pop()}}),has:at(function(e){return function(t){return ot(e,t).length>0}}),contains:at(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:at(function(e){return G.test(e||"")||ot.error("unsupported lang: "+e),e=e.replace(nt,rt).toLowerCase(),function(t){var n;do if(n=h?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===f},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return et.test(e.nodeName)},input:function(e){return Z.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:ht(function(){return[0]}),last:ht(function(e,t){return[t-1]}),eq:ht(function(e,t,n){return[0>n?n+t:n]}),even:ht(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:ht(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:ht(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:ht(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}},i.pseudos.nth=i.pseudos.eq;for(t in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[t]=pt(t);for(t in{submit:!0,reset:!0})i.pseudos[t]=ft(t);function dt(){}dt.prototype=i.filters=i.pseudos,i.setFilters=new dt;function gt(e,t){var n,r,o,s,a,u,l,c=k[e+" "];if(c)return t?0:c.slice(0);a=e,u=[],l=i.preFilter;while(a){(!n||(r=_.exec(a)))&&(r&&(a=a.slice(r[0].length)||a),u.push(o=[])),n=!1,(r=X.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace(z," ")}),a=a.slice(n.length));for(s in i.filter)!(r=J[s].exec(a))||l[s]&&!(r=l[s](r))||(n=r.shift(),o.push({value:n,type:s,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?ot.error(e):k(e,u).slice(0)}function mt(e){var t=0,n=e.length,r="";for(;n>t;t++)r+=e[t].value;return r}function yt(e,t,n){var i=t.dir,o=n&&"parentNode"===i,s=T++;return t.first?function(t,n,r){while(t=t[i])if(1===t.nodeType||o)return e(t,n,r)}:function(t,n,a){var u,l,c,p=w+" "+s;if(a){while(t=t[i])if((1===t.nodeType||o)&&e(t,n,a))return!0}else while(t=t[i])if(1===t.nodeType||o)if(c=t[v]||(t[v]={}),(l=c[i])&&l[0]===p){if((u=l[1])===!0||u===r)return u===!0}else if(l=c[i]=[p],l[1]=e(t,n,a)||r,l[1]===!0)return!0}}function vt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function xt(e,t,n,r,i){var o,s=[],a=0,u=e.length,l=null!=t;for(;u>a;a++)(o=e[a])&&(!n||n(o,r,i))&&(s.push(o),l&&t.push(a));return s}function bt(e,t,n,r,i,o){return r&&!r[v]&&(r=bt(r)),i&&!i[v]&&(i=bt(i,o)),at(function(o,s,a,u){var l,c,p,f=[],h=[],d=s.length,g=o||Ct(t||"*",a.nodeType?[a]:a,[]),m=!e||!o&&t?g:xt(g,f,e,a,u),y=n?i||(o?e:d||r)?[]:s:m;if(n&&n(m,y,a,u),r){l=xt(y,h),r(l,[],a,u),c=l.length;while(c--)(p=l[c])&&(y[h[c]]=!(m[h[c]]=p))}if(o){if(i||e){if(i){l=[],c=y.length;while(c--)(p=y[c])&&l.push(m[c]=p);i(null,y=[],l,u)}c=y.length;while(c--)(p=y[c])&&(l=i?P.call(o,p):f[c])>-1&&(o[l]=!(s[l]=p))}}else y=xt(y===s?y.splice(d,y.length):y),i?i(null,s,y,u):O.apply(s,y)})}function wt(e){var t,n,r,o=e.length,s=i.relative[e[0].type],a=s||i.relative[" "],l=s?1:0,c=yt(function(e){return e===t},a,!0),p=yt(function(e){return P.call(t,e)>-1},a,!0),f=[function(e,n,r){return!s&&(r||n!==u)||((t=n).nodeType?c(e,n,r):p(e,n,r))}];for(;o>l;l++)if(n=i.relative[e[l].type])f=[yt(vt(f),n)];else{if(n=i.filter[e[l].type].apply(null,e[l].matches),n[v]){for(r=++l;o>r;r++)if(i.relative[e[r].type])break;return bt(l>1&&vt(f),l>1&&mt(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(z,"$1"),n,r>l&&wt(e.slice(l,r)),o>r&&wt(e=e.slice(r)),o>r&&mt(e))}f.push(n)}return vt(f)}function Tt(e,t){var n=0,o=t.length>0,s=e.length>0,a=function(a,l,c,f,h){var d,g,m,y=[],v=0,x="0",b=a&&[],T=null!=h,C=u,k=a||s&&i.find.TAG("*",h&&l.parentNode||l),N=w+=null==C?1:Math.random()||.1;for(T&&(u=l!==p&&l,r=n);null!=(d=k[x]);x++){if(s&&d){g=0;while(m=e[g++])if(m(d,l,c)){f.push(d);break}T&&(w=N,r=++n)}o&&((d=!m&&d)&&v--,a&&b.push(d))}if(v+=x,o&&x!==v){g=0;while(m=t[g++])m(b,y,l,c);if(a){if(v>0)while(x--)b[x]||y[x]||(y[x]=q.call(f));y=xt(y)}O.apply(f,y),T&&!a&&y.length>0&&v+t.length>1&&ot.uniqueSort(f)}return T&&(w=N,u=C),b};return o?at(a):a}a=ot.compile=function(e,t){var n,r=[],i=[],o=N[e+" "];if(!o){t||(t=gt(e)),n=t.length;while(n--)o=wt(t[n]),o[v]?r.push(o):i.push(o);o=N(e,Tt(i,r))}return o};function Ct(e,t,n){var r=0,i=t.length;for(;i>r;r++)ot(e,t[r],n);return n}function kt(e,t,r,o){var s,u,l,c,p,f=gt(e);if(!o&&1===f.length){if(u=f[0]=f[0].slice(0),u.length>2&&"ID"===(l=u[0]).type&&n.getById&&9===t.nodeType&&h&&i.relative[u[1].type]){if(t=(i.find.ID(l.matches[0].replace(nt,rt),t)||[])[0],!t)return r;e=e.slice(u.shift().value.length)}s=J.needsContext.test(e)?0:u.length;while(s--){if(l=u[s],i.relative[c=l.type])break;if((p=i.find[c])&&(o=p(l.matches[0].replace(nt,rt),U.test(u[0].type)&&t.parentNode||t))){if(u.splice(s,1),e=o.length&&mt(u),!e)return O.apply(r,o),r;break}}}return a(e,f)(o,t,!h,r,U.test(e)),r}n.sortStable=v.split("").sort(S).join("")===v,n.detectDuplicates=E,c(),n.sortDetached=ut(function(e){return 1&e.compareDocumentPosition(p.createElement("div"))}),ut(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||lt("type|href|height|width",function(e,t,n){return n?undefined:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),n.attributes&&ut(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||lt("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?undefined:e.defaultValue}),ut(function(e){return null==e.getAttribute("disabled")})||lt(R,function(e,t,n){var r;return n?undefined:(r=e.getAttributeNode(t))&&r.specified?r.value:e[t]===!0?t.toLowerCase():null}),x.find=ot,x.expr=ot.selectors,x.expr[":"]=x.expr.pseudos,x.unique=ot.uniqueSort,x.text=ot.getText,x.isXMLDoc=ot.isXML,x.contains=ot.contains}(e);var D={};function A(e){var t=D[e]={};return x.each(e.match(w)||[],function(e,n){t[n]=!0}),t}x.Callbacks=function(e){e="string"==typeof e?D[e]||A(e):x.extend({},e);var t,n,r,i,o,s,a=[],u=!e.once&&[],l=function(p){for(t=e.memory&&p,n=!0,s=i||0,i=0,o=a.length,r=!0;a&&o>s;s++)if(a[s].apply(p[0],p[1])===!1&&e.stopOnFalse){t=!1;break}r=!1,a&&(u?u.length&&l(u.shift()):t?a=[]:c.disable())},c={add:function(){if(a){var n=a.length;(function s(t){x.each(t,function(t,n){var r=x.type(n);"function"===r?e.unique&&c.has(n)||a.push(n):n&&n.length&&"string"!==r&&s(n)})})(arguments),r?o=a.length:t&&(i=n,l(t))}return this},remove:function(){return a&&x.each(arguments,function(e,t){var n;while((n=x.inArray(t,a,n))>-1)a.splice(n,1),r&&(o>=n&&o--,s>=n&&s--)}),this},has:function(e){return e?x.inArray(e,a)>-1:!(!a||!a.length)},empty:function(){return a=[],o=0,this},disable:function(){return a=u=t=undefined,this},disabled:function(){return!a},lock:function(){return u=undefined,t||c.disable(),this},locked:function(){return!u},fireWith:function(e,t){return!a||n&&!u||(t=t||[],t=[e,t.slice?t.slice():t],r?u.push(t):l(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!n}};return c},x.extend({Deferred:function(e){var t=[["resolve","done",x.Callbacks("once memory"),"resolved"],["reject","fail",x.Callbacks("once memory"),"rejected"],["notify","progress",x.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return x.Deferred(function(n){x.each(t,function(t,o){var s=o[0],a=x.isFunction(e[t])&&e[t];i[o[1]](function(){var e=a&&a.apply(this,arguments);e&&x.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s+"With"](this===r?n.promise():this,a?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?x.extend(e,r):r}},i={};return r.pipe=r.then,x.each(t,function(e,o){var s=o[2],a=o[3];r[o[1]]=s.add,a&&s.add(function(){n=a},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=s.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=d.call(arguments),r=n.length,i=1!==r||e&&x.isFunction(e.promise)?r:0,o=1===i?e:x.Deferred(),s=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?d.call(arguments):r,n===a?o.notifyWith(t,n):--i||o.resolveWith(t,n)}},a,u,l;if(r>1)for(a=Array(r),u=Array(r),l=Array(r);r>t;t++)n[t]&&x.isFunction(n[t].promise)?n[t].promise().done(s(t,l,n)).fail(o.reject).progress(s(t,u,a)):--i;return i||o.resolveWith(l,n),o.promise()}}),x.support=function(t){var n=o.createElement("input"),r=o.createDocumentFragment(),i=o.createElement("div"),s=o.createElement("select"),a=s.appendChild(o.createElement("option"));return n.type?(n.type="checkbox",t.checkOn=""!==n.value,t.optSelected=a.selected,t.reliableMarginRight=!0,t.boxSizingReliable=!0,t.pixelPosition=!1,n.checked=!0,t.noCloneChecked=n.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!a.disabled,n=o.createElement("input"),n.value="t",n.type="radio",t.radioValue="t"===n.value,n.setAttribute("checked","t"),n.setAttribute("name","t"),r.appendChild(n),t.checkClone=r.cloneNode(!0).cloneNode(!0).lastChild.checked,t.focusinBubbles="onfocusin"in e,i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===i.style.backgroundClip,x(function(){var n,r,s="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",a=o.getElementsByTagName("body")[0];a&&(n=o.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(n).appendChild(i),i.innerHTML="",i.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",x.swap(a,null!=a.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===i.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(i,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(i,null)||{width:"4px"}).width,r=i.appendChild(o.createElement("div")),r.style.cssText=i.style.cssText=s,r.style.marginRight=r.style.width="0",i.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),a.removeChild(n))}),t):t}({});var L,q,H=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,O=/([A-Z])/g;function F(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=x.expando+Math.random()}F.uid=1,F.accepts=function(e){return e.nodeType?1===e.nodeType||9===e.nodeType:!0},F.prototype={key:function(e){if(!F.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=F.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(r){t[this.expando]=n,x.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var r,i=this.key(e),o=this.cache[i];if("string"==typeof t)o[t]=n;else if(x.isEmptyObject(o))x.extend(this.cache[i],t);else for(r in t)o[r]=t[r];return o},get:function(e,t){var n=this.cache[this.key(e)];return t===undefined?n:n[t]},access:function(e,t,n){var r;return t===undefined||t&&"string"==typeof t&&n===undefined?(r=this.get(e,t),r!==undefined?r:this.get(e,x.camelCase(t))):(this.set(e,t,n),n!==undefined?n:t)},remove:function(e,t){var n,r,i,o=this.key(e),s=this.cache[o];if(t===undefined)this.cache[o]={};else{x.isArray(t)?r=t.concat(t.map(x.camelCase)):(i=x.camelCase(t),t in s?r=[t,i]:(r=i,r=r in s?[r]:r.match(w)||[])),n=r.length;while(n--)delete s[r[n]]}},hasData:function(e){return!x.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}},L=new F,q=new F,x.extend({acceptData:F.accepts,hasData:function(e){return L.hasData(e)||q.hasData(e)},data:function(e,t,n){return L.access(e,t,n)},removeData:function(e,t){L.remove(e,t)},_data:function(e,t,n){return q.access(e,t,n)},_removeData:function(e,t){q.remove(e,t)}}),x.fn.extend({data:function(e,t){var n,r,i=this[0],o=0,s=null;if(e===undefined){if(this.length&&(s=L.get(i),1===i.nodeType&&!q.get(i,"hasDataAttrs"))){for(n=i.attributes;n.length>o;o++)r=n[o].name,0===r.indexOf("data-")&&(r=x.camelCase(r.slice(5)),P(i,r,s[r]));q.set(i,"hasDataAttrs",!0)}return s}return"object"==typeof e?this.each(function(){L.set(this,e)}):x.access(this,function(t){var n,r=x.camelCase(e);if(i&&t===undefined){if(n=L.get(i,e),n!==undefined)return n;if(n=L.get(i,r),n!==undefined)return n;if(n=P(i,r,undefined),n!==undefined)return n}else this.each(function(){var n=L.get(this,r);L.set(this,r,t),-1!==e.indexOf("-")&&n!==undefined&&L.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){L.remove(this,e)})}});function P(e,t,n){var r;if(n===undefined&&1===e.nodeType)if(r="data-"+t.replace(O,"-$1").toLowerCase(),n=e.getAttribute(r),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:H.test(n)?JSON.parse(n):n}catch(i){}L.set(e,t,n)}else n=undefined;return n}x.extend({queue:function(e,t,n){var r;return e?(t=(t||"fx")+"queue",r=q.get(e,t),n&&(!r||x.isArray(n)?r=q.access(e,t,x.makeArray(n)):r.push(n)),r||[]):undefined},dequeue:function(e,t){t=t||"fx";var n=x.queue(e,t),r=n.length,i=n.shift(),o=x._queueHooks(e,t),s=function(){x.dequeue(e,t)
};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,s,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return q.get(e,n)||q.access(e,n,{empty:x.Callbacks("once memory").add(function(){q.remove(e,[t+"queue",n])})})}}),x.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),n>arguments.length?x.queue(this[0],e):t===undefined?this:this.each(function(){var n=x.queue(this,e,t);x._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&x.dequeue(this,e)})},dequeue:function(e){return this.each(function(){x.dequeue(this,e)})},delay:function(e,t){return e=x.fx?x.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=x.Deferred(),o=this,s=this.length,a=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=undefined),e=e||"fx";while(s--)n=q.get(o[s],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(a));return a(),i.promise(t)}});var R,M,W=/[\t\r\n\f]/g,$=/\r/g,B=/^(?:input|select|textarea|button)$/i;x.fn.extend({attr:function(e,t){return x.access(this,x.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){x.removeAttr(this,e)})},prop:function(e,t){return x.access(this,x.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[x.propFix[e]||e]})},addClass:function(e){var t,n,r,i,o,s=0,a=this.length,u="string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).addClass(e.call(this,t,this.className))});if(u)for(t=(e||"").match(w)||[];a>s;s++)if(n=this[s],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):" ")){o=0;while(i=t[o++])0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=x.trim(r)}return this},removeClass:function(e){var t,n,r,i,o,s=0,a=this.length,u=0===arguments.length||"string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).removeClass(e.call(this,t,this.className))});if(u)for(t=(e||"").match(w)||[];a>s;s++)if(n=this[s],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):"")){o=0;while(i=t[o++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?x.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):x.isFunction(e)?this.each(function(n){x(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var t,i=0,o=x(this),s=e.match(w)||[];while(t=s[i++])o.hasClass(t)?o.removeClass(t):o.addClass(t)}else(n===r||"boolean"===n)&&(this.className&&q.set(this,"__className__",this.className),this.className=this.className||e===!1?"":q.get(this,"__className__")||"")})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(W," ").indexOf(t)>=0)return!0;return!1},val:function(e){var t,n,r,i=this[0];{if(arguments.length)return r=x.isFunction(e),this.each(function(n){var i;1===this.nodeType&&(i=r?e.call(this,n,x(this).val()):e,null==i?i="":"number"==typeof i?i+="":x.isArray(i)&&(i=x.map(i,function(e){return null==e?"":e+""})),t=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&t.set(this,i,"value")!==undefined||(this.value=i))});if(i)return t=x.valHooks[i.type]||x.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&(n=t.get(i,"value"))!==undefined?n:(n=i.value,"string"==typeof n?n.replace($,""):null==n?"":n)}}}),x.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||0>i,s=o?null:[],a=o?i+1:r.length,u=0>i?a:o?i:0;for(;a>u;u++)if(n=r[u],!(!n.selected&&u!==i||(x.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&x.nodeName(n.parentNode,"optgroup"))){if(t=x(n).val(),o)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=x.makeArray(t),s=i.length;while(s--)r=i[s],(r.selected=x.inArray(x(r).val(),o)>=0)&&(n=!0);return n||(e.selectedIndex=-1),o}}},attr:function(e,t,n){var i,o,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return typeof e.getAttribute===r?x.prop(e,t,n):(1===s&&x.isXMLDoc(e)||(t=t.toLowerCase(),i=x.attrHooks[t]||(x.expr.match.bool.test(t)?M:R)),n===undefined?i&&"get"in i&&null!==(o=i.get(e,t))?o:(o=x.find.attr(e,t),null==o?undefined:o):null!==n?i&&"set"in i&&(o=i.set(e,n,t))!==undefined?o:(e.setAttribute(t,n+""),n):(x.removeAttr(e,t),undefined))},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(w);if(o&&1===e.nodeType)while(n=o[i++])r=x.propFix[n]||n,x.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!x.support.radioValue&&"radio"===t&&x.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,o,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return o=1!==s||!x.isXMLDoc(e),o&&(t=x.propFix[t]||t,i=x.propHooks[t]),n!==undefined?i&&"set"in i&&(r=i.set(e,n,t))!==undefined?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||B.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),M={set:function(e,t,n){return t===!1?x.removeAttr(e,n):e.setAttribute(n,n),n}},x.each(x.expr.match.bool.source.match(/\w+/g),function(e,t){var n=x.expr.attrHandle[t]||x.find.attr;x.expr.attrHandle[t]=function(e,t,r){var i=x.expr.attrHandle[t],o=r?undefined:(x.expr.attrHandle[t]=undefined)!=n(e,t,r)?t.toLowerCase():null;return x.expr.attrHandle[t]=i,o}}),x.support.optSelected||(x.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){x.propFix[this.toLowerCase()]=this}),x.each(["radio","checkbox"],function(){x.valHooks[this]={set:function(e,t){return x.isArray(t)?e.checked=x.inArray(x(e).val(),t)>=0:undefined}},x.support.checkOn||(x.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var I=/^key/,z=/^(?:mouse|contextmenu)|click/,_=/^(?:focusinfocus|focusoutblur)$/,X=/^([^.]*)(?:\.(.+)|)$/;function U(){return!0}function Y(){return!1}function V(){try{return o.activeElement}catch(e){}}x.event={global:{},add:function(e,t,n,i,o){var s,a,u,l,c,p,f,h,d,g,m,y=q.get(e);if(y){n.handler&&(s=n,n=s.handler,o=s.selector),n.guid||(n.guid=x.guid++),(l=y.events)||(l=y.events={}),(a=y.handle)||(a=y.handle=function(e){return typeof x===r||e&&x.event.triggered===e.type?undefined:x.event.dispatch.apply(a.elem,arguments)},a.elem=e),t=(t||"").match(w)||[""],c=t.length;while(c--)u=X.exec(t[c])||[],d=m=u[1],g=(u[2]||"").split(".").sort(),d&&(f=x.event.special[d]||{},d=(o?f.delegateType:f.bindType)||d,f=x.event.special[d]||{},p=x.extend({type:d,origType:m,data:i,handler:n,guid:n.guid,selector:o,needsContext:o&&x.expr.match.needsContext.test(o),namespace:g.join(".")},s),(h=l[d])||(h=l[d]=[],h.delegateCount=0,f.setup&&f.setup.call(e,i,g,a)!==!1||e.addEventListener&&e.addEventListener(d,a,!1)),f.add&&(f.add.call(e,p),p.handler.guid||(p.handler.guid=n.guid)),o?h.splice(h.delegateCount++,0,p):h.push(p),x.event.global[d]=!0);e=null}},remove:function(e,t,n,r,i){var o,s,a,u,l,c,p,f,h,d,g,m=q.hasData(e)&&q.get(e);if(m&&(u=m.events)){t=(t||"").match(w)||[""],l=t.length;while(l--)if(a=X.exec(t[l])||[],h=g=a[1],d=(a[2]||"").split(".").sort(),h){p=x.event.special[h]||{},h=(r?p.delegateType:p.bindType)||h,f=u[h]||[],a=a[2]&&RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=f.length;while(o--)c=f[o],!i&&g!==c.origType||n&&n.guid!==c.guid||a&&!a.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(f.splice(o,1),c.selector&&f.delegateCount--,p.remove&&p.remove.call(e,c));s&&!f.length&&(p.teardown&&p.teardown.call(e,d,m.handle)!==!1||x.removeEvent(e,h,m.handle),delete u[h])}else for(h in u)x.event.remove(e,h+t[l],n,r,!0);x.isEmptyObject(u)&&(delete m.handle,q.remove(e,"events"))}},trigger:function(t,n,r,i){var s,a,u,l,c,p,f,h=[r||o],d=y.call(t,"type")?t.type:t,g=y.call(t,"namespace")?t.namespace.split("."):[];if(a=u=r=r||o,3!==r.nodeType&&8!==r.nodeType&&!_.test(d+x.event.triggered)&&(d.indexOf(".")>=0&&(g=d.split("."),d=g.shift(),g.sort()),c=0>d.indexOf(":")&&"on"+d,t=t[x.expando]?t:new x.Event(d,"object"==typeof t&&t),t.isTrigger=i?2:3,t.namespace=g.join("."),t.namespace_re=t.namespace?RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=undefined,t.target||(t.target=r),n=null==n?[t]:x.makeArray(n,[t]),f=x.event.special[d]||{},i||!f.trigger||f.trigger.apply(r,n)!==!1)){if(!i&&!f.noBubble&&!x.isWindow(r)){for(l=f.delegateType||d,_.test(l+d)||(a=a.parentNode);a;a=a.parentNode)h.push(a),u=a;u===(r.ownerDocument||o)&&h.push(u.defaultView||u.parentWindow||e)}s=0;while((a=h[s++])&&!t.isPropagationStopped())t.type=s>1?l:f.bindType||d,p=(q.get(a,"events")||{})[t.type]&&q.get(a,"handle"),p&&p.apply(a,n),p=c&&a[c],p&&x.acceptData(a)&&p.apply&&p.apply(a,n)===!1&&t.preventDefault();return t.type=d,i||t.isDefaultPrevented()||f._default&&f._default.apply(h.pop(),n)!==!1||!x.acceptData(r)||c&&x.isFunction(r[d])&&!x.isWindow(r)&&(u=r[c],u&&(r[c]=null),x.event.triggered=d,r[d](),x.event.triggered=undefined,u&&(r[c]=u)),t.result}},dispatch:function(e){e=x.event.fix(e);var t,n,r,i,o,s=[],a=d.call(arguments),u=(q.get(this,"events")||{})[e.type]||[],l=x.event.special[e.type]||{};if(a[0]=e,e.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,e)!==!1){s=x.event.handlers.call(this,e,u),t=0;while((i=s[t++])&&!e.isPropagationStopped()){e.currentTarget=i.elem,n=0;while((o=i.handlers[n++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(o.namespace))&&(e.handleObj=o,e.data=o.data,r=((x.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,a),r!==undefined&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,i,o,s=[],a=t.delegateCount,u=e.target;if(a&&u.nodeType&&(!e.button||"click"!==e.type))for(;u!==this;u=u.parentNode||this)if(u.disabled!==!0||"click"!==e.type){for(r=[],n=0;a>n;n++)o=t[n],i=o.selector+" ",r[i]===undefined&&(r[i]=o.needsContext?x(i,this).index(u)>=0:x.find(i,this,null,[u]).length),r[i]&&r.push(o);r.length&&s.push({elem:u,handlers:r})}return t.length>a&&s.push({elem:this,handlers:t.slice(a)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,s=t.button;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||o,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),e.which||s===undefined||(e.which=1&s?1:2&s?3:4&s?2:0),e}},fix:function(e){if(e[x.expando])return e;var t,n,r,i=e.type,s=e,a=this.fixHooks[i];a||(this.fixHooks[i]=a=z.test(i)?this.mouseHooks:I.test(i)?this.keyHooks:{}),r=a.props?this.props.concat(a.props):this.props,e=new x.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target||(e.target=o),3===e.target.nodeType&&(e.target=e.target.parentNode),a.filter?a.filter(e,s):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==V()&&this.focus?(this.focus(),!1):undefined},delegateType:"focusin"},blur:{trigger:function(){return this===V()&&this.blur?(this.blur(),!1):undefined},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&x.nodeName(this,"input")?(this.click(),!1):undefined},_default:function(e){return x.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=x.extend(new x.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?x.event.trigger(i,null,t):x.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},x.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},x.Event=function(e,t){return this instanceof x.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.getPreventDefault&&e.getPreventDefault()?U:Y):this.type=e,t&&x.extend(this,t),this.timeStamp=e&&e.timeStamp||x.now(),this[x.expando]=!0,undefined):new x.Event(e,t)},x.Event.prototype={isDefaultPrevented:Y,isPropagationStopped:Y,isImmediatePropagationStopped:Y,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=U,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=U,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=U,this.stopPropagation()}},x.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){x.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return(!i||i!==r&&!x.contains(r,i))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),x.support.focusinBubbles||x.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){x.event.simulate(t,e.target,x.event.fix(e),!0)};x.event.special[t]={setup:function(){0===n++&&o.addEventListener(e,r,!0)},teardown:function(){0===--n&&o.removeEventListener(e,r,!0)}}}),x.fn.extend({on:function(e,t,n,r,i){var o,s;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=undefined);for(s in e)this.on(s,t,n,e[s],i);return this}if(null==n&&null==r?(r=t,n=t=undefined):null==r&&("string"==typeof t?(r=n,n=undefined):(r=n,n=t,t=undefined)),r===!1)r=Y;else if(!r)return this;return 1===i&&(o=r,r=function(e){return x().off(e),o.apply(this,arguments)},r.guid=o.guid||(o.guid=x.guid++)),this.each(function(){x.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,x(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=undefined),n===!1&&(n=Y),this.each(function(){x.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){x.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?x.event.trigger(e,t,n,!0):undefined}});var G=/^.[^:#\[\.,]*$/,J=/^(?:parents|prev(?:Until|All))/,Q=x.expr.match.needsContext,K={children:!0,contents:!0,next:!0,prev:!0};x.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(x(e).filter(function(){for(t=0;i>t;t++)if(x.contains(r[t],this))return!0}));for(t=0;i>t;t++)x.find(e,r[t],n);return n=this.pushStack(i>1?x.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t=x(e,this),n=t.length;return this.filter(function(){var e=0;for(;n>e;e++)if(x.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(et(this,e||[],!0))},filter:function(e){return this.pushStack(et(this,e||[],!1))},is:function(e){return!!et(this,"string"==typeof e&&Q.test(e)?x(e):e||[],!1).length},closest:function(e,t){var n,r=0,i=this.length,o=[],s=Q.test(e)||"string"!=typeof e?x(e,t||this.context):0;for(;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(11>n.nodeType&&(s?s.index(n)>-1:1===n.nodeType&&x.find.matchesSelector(n,e))){n=o.push(n);break}return this.pushStack(o.length>1?x.unique(o):o)},index:function(e){return e?"string"==typeof e?g.call(x(e),this[0]):g.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?x(e,t):x.makeArray(e&&e.nodeType?[e]:e),r=x.merge(this.get(),n);return this.pushStack(x.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}});function Z(e,t){while((e=e[t])&&1!==e.nodeType);return e}x.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return x.dir(e,"parentNode")},parentsUntil:function(e,t,n){return x.dir(e,"parentNode",n)},next:function(e){return Z(e,"nextSibling")},prev:function(e){return Z(e,"previousSibling")},nextAll:function(e){return x.dir(e,"nextSibling")},prevAll:function(e){return x.dir(e,"previousSibling")},nextUntil:function(e,t,n){return x.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return x.dir(e,"previousSibling",n)},siblings:function(e){return x.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return x.sibling(e.firstChild)},contents:function(e){return e.contentDocument||x.merge([],e.childNodes)}},function(e,t){x.fn[e]=function(n,r){var i=x.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=x.filter(r,i)),this.length>1&&(K[e]||x.unique(i),J.test(e)&&i.reverse()),this.pushStack(i)}}),x.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?x.find.matchesSelector(r,e)?[r]:[]:x.find.matches(e,x.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,t,n){var r=[],i=n!==undefined;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&x(e).is(n))break;r.push(e)}return r},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});function et(e,t,n){if(x.isFunction(t))return x.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return x.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(G.test(t))return x.filter(t,e,n);t=x.filter(t,e)}return x.grep(e,function(e){return g.call(t,e)>=0!==n})}var tt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,nt=/<([\w:]+)/,rt=/<|&#?\w+;/,it=/<(?:script|style|link)/i,ot=/^(?:checkbox|radio)$/i,st=/checked\s*(?:[^=]|=\s*.checked.)/i,at=/^$|\/(?:java|ecma)script/i,ut=/^true\/(.*)/,lt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ct={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ct.optgroup=ct.option,ct.tbody=ct.tfoot=ct.colgroup=ct.caption=ct.thead,ct.th=ct.td,x.fn.extend({text:function(e){return x.access(this,function(e){return e===undefined?x.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=pt(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=pt(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?x.filter(e,this):this,i=0;for(;null!=(n=r[i]);i++)t||1!==n.nodeType||x.cleanData(mt(n)),n.parentNode&&(t&&x.contains(n.ownerDocument,n)&&dt(mt(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++)1===e.nodeType&&(x.cleanData(mt(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return x.clone(this,e,t)})},html:function(e){return x.access(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===undefined&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!it.test(e)&&!ct[(nt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(tt,"<$1></$2>");try{for(;r>n;n++)t=this[n]||{},1===t.nodeType&&(x.cleanData(mt(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=x.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(r&&r.parentNode!==i&&(r=this.nextSibling),x(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=f.apply([],e);var r,i,o,s,a,u,l=0,c=this.length,p=this,h=c-1,d=e[0],g=x.isFunction(d);if(g||!(1>=c||"string"!=typeof d||x.support.checkClone)&&st.test(d))return this.each(function(r){var i=p.eq(r);g&&(e[0]=d.call(this,r,i.html())),i.domManip(e,t,n)});if(c&&(r=x.buildFragment(e,this[0].ownerDocument,!1,!n&&this),i=r.firstChild,1===r.childNodes.length&&(r=i),i)){for(o=x.map(mt(r,"script"),ft),s=o.length;c>l;l++)a=r,l!==h&&(a=x.clone(a,!0,!0),s&&x.merge(o,mt(a,"script"))),t.call(this[l],a,l);if(s)for(u=o[o.length-1].ownerDocument,x.map(o,ht),l=0;s>l;l++)a=o[l],at.test(a.type||"")&&!q.access(a,"globalEval")&&x.contains(u,a)&&(a.src?x._evalUrl(a.src):x.globalEval(a.textContent.replace(lt,"")))}return this}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){x.fn[e]=function(e){var n,r=[],i=x(e),o=i.length-1,s=0;for(;o>=s;s++)n=s===o?this:this.clone(!0),x(i[s])[t](n),h.apply(r,n.get());return this.pushStack(r)}}),x.extend({clone:function(e,t,n){var r,i,o,s,a=e.cloneNode(!0),u=x.contains(e.ownerDocument,e);if(!(x.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||x.isXMLDoc(e)))for(s=mt(a),o=mt(e),r=0,i=o.length;i>r;r++)yt(o[r],s[r]);if(t)if(n)for(o=o||mt(e),s=s||mt(a),r=0,i=o.length;i>r;r++)gt(o[r],s[r]);else gt(e,a);return s=mt(a,"script"),s.length>0&&dt(s,!u&&mt(e,"script")),a},buildFragment:function(e,t,n,r){var i,o,s,a,u,l,c=0,p=e.length,f=t.createDocumentFragment(),h=[];for(;p>c;c++)if(i=e[c],i||0===i)if("object"===x.type(i))x.merge(h,i.nodeType?[i]:i);else if(rt.test(i)){o=o||f.appendChild(t.createElement("div")),s=(nt.exec(i)||["",""])[1].toLowerCase(),a=ct[s]||ct._default,o.innerHTML=a[1]+i.replace(tt,"<$1></$2>")+a[2],l=a[0];while(l--)o=o.lastChild;x.merge(h,o.childNodes),o=f.firstChild,o.textContent=""}else h.push(t.createTextNode(i));f.textContent="",c=0;while(i=h[c++])if((!r||-1===x.inArray(i,r))&&(u=x.contains(i.ownerDocument,i),o=mt(f.appendChild(i),"script"),u&&dt(o),n)){l=0;while(i=o[l++])at.test(i.type||"")&&n.push(i)}return f},cleanData:function(e){var t,n,r,i,o,s,a=x.event.special,u=0;for(;(n=e[u])!==undefined;u++){if(F.accepts(n)&&(o=n[q.expando],o&&(t=q.cache[o]))){if(r=Object.keys(t.events||{}),r.length)for(s=0;(i=r[s])!==undefined;s++)a[i]?x.event.remove(n,i):x.removeEvent(n,i,t.handle);q.cache[o]&&delete q.cache[o]}delete L.cache[n[L.expando]]}},_evalUrl:function(e){return x.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}});function pt(e,t){return x.nodeName(e,"table")&&x.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function ft(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function ht(e){var t=ut.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function dt(e,t){var n=e.length,r=0;for(;n>r;r++)q.set(e[r],"globalEval",!t||q.get(t[r],"globalEval"))}function gt(e,t){var n,r,i,o,s,a,u,l;if(1===t.nodeType){if(q.hasData(e)&&(o=q.access(e),s=q.set(t,o),l=o.events)){delete s.handle,s.events={};for(i in l)for(n=0,r=l[i].length;r>n;n++)x.event.add(t,i,l[i][n])}L.hasData(e)&&(a=L.access(e),u=x.extend({},a),L.set(t,u))}}function mt(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return t===undefined||t&&x.nodeName(e,t)?x.merge([e],n):n}function yt(e,t){var n=t.nodeName.toLowerCase();"input"===n&&ot.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}x.fn.extend({wrapAll:function(e){var t;return x.isFunction(e)?this.each(function(t){x(this).wrapAll(e.call(this,t))}):(this[0]&&(t=x(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return x.isFunction(e)?this.each(function(t){x(this).wrapInner(e.call(this,t))}):this.each(function(){var t=x(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=x.isFunction(e);return this.each(function(n){x(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){x.nodeName(this,"body")||x(this).replaceWith(this.childNodes)}).end()}});var vt,xt,bt=/^(none|table(?!-c[ea]).+)/,wt=/^margin/,Tt=RegExp("^("+b+")(.*)$","i"),Ct=RegExp("^("+b+")(?!px)[a-z%]+$","i"),kt=RegExp("^([+-])=("+b+")","i"),Nt={BODY:"block"},Et={position:"absolute",visibility:"hidden",display:"block"},St={letterSpacing:0,fontWeight:400},jt=["Top","Right","Bottom","Left"],Dt=["Webkit","O","Moz","ms"];function At(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Dt.length;while(i--)if(t=Dt[i]+n,t in e)return t;return r}function Lt(e,t){return e=t||e,"none"===x.css(e,"display")||!x.contains(e.ownerDocument,e)}function qt(t){return e.getComputedStyle(t,null)}function Ht(e,t){var n,r,i,o=[],s=0,a=e.length;for(;a>s;s++)r=e[s],r.style&&(o[s]=q.get(r,"olddisplay"),n=r.style.display,t?(o[s]||"none"!==n||(r.style.display=""),""===r.style.display&&Lt(r)&&(o[s]=q.access(r,"olddisplay",Rt(r.nodeName)))):o[s]||(i=Lt(r),(n&&"none"!==n||!i)&&q.set(r,"olddisplay",i?n:x.css(r,"display"))));for(s=0;a>s;s++)r=e[s],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[s]||"":"none"));return e}x.fn.extend({css:function(e,t){return x.access(this,function(e,t,n){var r,i,o={},s=0;if(x.isArray(t)){for(r=qt(e),i=t.length;i>s;s++)o[t[s]]=x.css(e,t[s],!1,r);return o}return n!==undefined?x.style(e,t,n):x.css(e,t)},e,t,arguments.length>1)},show:function(){return Ht(this,!0)},hide:function(){return Ht(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Lt(this)?x(this).show():x(this).hide()})}}),x.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=vt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,s,a=x.camelCase(t),u=e.style;return t=x.cssProps[a]||(x.cssProps[a]=At(u,a)),s=x.cssHooks[t]||x.cssHooks[a],n===undefined?s&&"get"in s&&(i=s.get(e,!1,r))!==undefined?i:u[t]:(o=typeof n,"string"===o&&(i=kt.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(x.css(e,t)),o="number"),null==n||"number"===o&&isNaN(n)||("number"!==o||x.cssNumber[a]||(n+="px"),x.support.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),s&&"set"in s&&(n=s.set(e,n,r))===undefined||(u[t]=n)),undefined)}},css:function(e,t,n,r){var i,o,s,a=x.camelCase(t);return t=x.cssProps[a]||(x.cssProps[a]=At(e.style,a)),s=x.cssHooks[t]||x.cssHooks[a],s&&"get"in s&&(i=s.get(e,!0,n)),i===undefined&&(i=vt(e,t,r)),"normal"===i&&t in St&&(i=St[t]),""===n||n?(o=parseFloat(i),n===!0||x.isNumeric(o)?o||0:i):i}}),vt=function(e,t,n){var r,i,o,s=n||qt(e),a=s?s.getPropertyValue(t)||s[t]:undefined,u=e.style;return s&&(""!==a||x.contains(e.ownerDocument,e)||(a=x.style(e,t)),Ct.test(a)&&wt.test(t)&&(r=u.width,i=u.minWidth,o=u.maxWidth,u.minWidth=u.maxWidth=u.width=a,a=s.width,u.width=r,u.minWidth=i,u.maxWidth=o)),a};function Ot(e,t,n){var r=Tt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function Ft(e,t,n,r,i){var o=n===(r?"border":"content")?4:"width"===t?1:0,s=0;for(;4>o;o+=2)"margin"===n&&(s+=x.css(e,n+jt[o],!0,i)),r?("content"===n&&(s-=x.css(e,"padding"+jt[o],!0,i)),"margin"!==n&&(s-=x.css(e,"border"+jt[o]+"Width",!0,i))):(s+=x.css(e,"padding"+jt[o],!0,i),"padding"!==n&&(s+=x.css(e,"border"+jt[o]+"Width",!0,i)));return s}function Pt(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=qt(e),s=x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,o);if(0>=i||null==i){if(i=vt(e,t,o),(0>i||null==i)&&(i=e.style[t]),Ct.test(i))return i;r=s&&(x.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+Ft(e,t,n||(s?"border":"content"),r,o)+"px"}function Rt(e){var t=o,n=Nt[e];return n||(n=Mt(e,t),"none"!==n&&n||(xt=(xt||x("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(xt[0].contentWindow||xt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=Mt(e,t),xt.detach()),Nt[e]=n),n}function Mt(e,t){var n=x(t.createElement(e)).appendTo(t.body),r=x.css(n[0],"display");return n.remove(),r}x.each(["height","width"],function(e,t){x.cssHooks[t]={get:function(e,n,r){return n?0===e.offsetWidth&&bt.test(x.css(e,"display"))?x.swap(e,Et,function(){return Pt(e,t,r)}):Pt(e,t,r):undefined},set:function(e,n,r){var i=r&&qt(e);return Ot(e,n,r?Ft(e,t,r,x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,i),i):0)}}}),x(function(){x.support.reliableMarginRight||(x.cssHooks.marginRight={get:function(e,t){return t?x.swap(e,{display:"inline-block"},vt,[e,"marginRight"]):undefined}}),!x.support.pixelPosition&&x.fn.position&&x.each(["top","left"],function(e,t){x.cssHooks[t]={get:function(e,n){return n?(n=vt(e,t),Ct.test(n)?x(e).position()[t]+"px":n):undefined}}})}),x.expr&&x.expr.filters&&(x.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight},x.expr.filters.visible=function(e){return!x.expr.filters.hidden(e)}),x.each({margin:"",padding:"",border:"Width"},function(e,t){x.cssHooks[e+t]={expand:function(n){var r=0,i={},o="string"==typeof n?n.split(" "):[n];for(;4>r;r++)i[e+jt[r]+t]=o[r]||o[r-2]||o[0];return i}},wt.test(e)||(x.cssHooks[e+t].set=Ot)});var Wt=/%20/g,$t=/\[\]$/,Bt=/\r?\n/g,It=/^(?:submit|button|image|reset|file)$/i,zt=/^(?:input|select|textarea|keygen)/i;x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=x.prop(this,"elements");return e?x.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!x(this).is(":disabled")&&zt.test(this.nodeName)&&!It.test(e)&&(this.checked||!ot.test(e))}).map(function(e,t){var n=x(this).val();return null==n?null:x.isArray(n)?x.map(n,function(e){return{name:t.name,value:e.replace(Bt,"\r\n")}}):{name:t.name,value:n.replace(Bt,"\r\n")}}).get()}}),x.param=function(e,t){var n,r=[],i=function(e,t){t=x.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(t===undefined&&(t=x.ajaxSettings&&x.ajaxSettings.traditional),x.isArray(e)||e.jquery&&!x.isPlainObject(e))x.each(e,function(){i(this.name,this.value)});else for(n in e)_t(n,e[n],t,i);return r.join("&").replace(Wt,"+")};function _t(e,t,n,r){var i;if(x.isArray(t))x.each(t,function(t,i){n||$t.test(e)?r(e,i):_t(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==x.type(t))r(e,t);else for(i in t)_t(e+"["+i+"]",t[i],n,r)}x.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){x.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),x.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)
},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var Xt,Ut,Yt=x.now(),Vt=/\?/,Gt=/#.*$/,Jt=/([?&])_=[^&]*/,Qt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Kt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Zt=/^(?:GET|HEAD)$/,en=/^\/\//,tn=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,nn=x.fn.load,rn={},on={},sn="*/".concat("*");try{Ut=i.href}catch(an){Ut=o.createElement("a"),Ut.href="",Ut=Ut.href}Xt=tn.exec(Ut.toLowerCase())||[];function un(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(w)||[];if(x.isFunction(n))while(r=o[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function ln(e,t,n,r){var i={},o=e===on;function s(a){var u;return i[a]=!0,x.each(e[a]||[],function(e,a){var l=a(t,n,r);return"string"!=typeof l||o||i[l]?o?!(u=l):undefined:(t.dataTypes.unshift(l),s(l),!1)}),u}return s(t.dataTypes[0])||!i["*"]&&s("*")}function cn(e,t){var n,r,i=x.ajaxSettings.flatOptions||{};for(n in t)t[n]!==undefined&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&x.extend(!0,e,r),e}x.fn.load=function(e,t,n){if("string"!=typeof e&&nn)return nn.apply(this,arguments);var r,i,o,s=this,a=e.indexOf(" ");return a>=0&&(r=e.slice(a),e=e.slice(0,a)),x.isFunction(t)?(n=t,t=undefined):t&&"object"==typeof t&&(i="POST"),s.length>0&&x.ajax({url:e,type:i,dataType:"html",data:t}).done(function(e){o=arguments,s.html(r?x("<div>").append(x.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){s.each(n,o||[e.responseText,t,e])}),this},x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){x.fn[t]=function(e){return this.on(t,e)}}),x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ut,type:"GET",isLocal:Kt.test(Xt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":sn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":x.parseJSON,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?cn(cn(e,x.ajaxSettings),t):cn(x.ajaxSettings,e)},ajaxPrefilter:un(rn),ajaxTransport:un(on),ajax:function(e,t){"object"==typeof e&&(t=e,e=undefined),t=t||{};var n,r,i,o,s,a,u,l,c=x.ajaxSetup({},t),p=c.context||c,f=c.context&&(p.nodeType||p.jquery)?x(p):x.event,h=x.Deferred(),d=x.Callbacks("once memory"),g=c.statusCode||{},m={},y={},v=0,b="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(2===v){if(!o){o={};while(t=Qt.exec(i))o[t[1].toLowerCase()]=t[2]}t=o[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===v?i:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return v||(e=y[n]=y[n]||e,m[e]=t),this},overrideMimeType:function(e){return v||(c.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>v)for(t in e)g[t]=[g[t],e[t]];else T.always(e[T.status]);return this},abort:function(e){var t=e||b;return n&&n.abort(t),k(0,t),this}};if(h.promise(T).complete=d.add,T.success=T.done,T.error=T.fail,c.url=((e||c.url||Ut)+"").replace(Gt,"").replace(en,Xt[1]+"//"),c.type=t.method||t.type||c.method||c.type,c.dataTypes=x.trim(c.dataType||"*").toLowerCase().match(w)||[""],null==c.crossDomain&&(a=tn.exec(c.url.toLowerCase()),c.crossDomain=!(!a||a[1]===Xt[1]&&a[2]===Xt[2]&&(a[3]||("http:"===a[1]?"80":"443"))===(Xt[3]||("http:"===Xt[1]?"80":"443")))),c.data&&c.processData&&"string"!=typeof c.data&&(c.data=x.param(c.data,c.traditional)),ln(rn,c,t,T),2===v)return T;u=c.global,u&&0===x.active++&&x.event.trigger("ajaxStart"),c.type=c.type.toUpperCase(),c.hasContent=!Zt.test(c.type),r=c.url,c.hasContent||(c.data&&(r=c.url+=(Vt.test(r)?"&":"?")+c.data,delete c.data),c.cache===!1&&(c.url=Jt.test(r)?r.replace(Jt,"$1_="+Yt++):r+(Vt.test(r)?"&":"?")+"_="+Yt++)),c.ifModified&&(x.lastModified[r]&&T.setRequestHeader("If-Modified-Since",x.lastModified[r]),x.etag[r]&&T.setRequestHeader("If-None-Match",x.etag[r])),(c.data&&c.hasContent&&c.contentType!==!1||t.contentType)&&T.setRequestHeader("Content-Type",c.contentType),T.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+("*"!==c.dataTypes[0]?", "+sn+"; q=0.01":""):c.accepts["*"]);for(l in c.headers)T.setRequestHeader(l,c.headers[l]);if(c.beforeSend&&(c.beforeSend.call(p,T,c)===!1||2===v))return T.abort();b="abort";for(l in{success:1,error:1,complete:1})T[l](c[l]);if(n=ln(on,c,t,T)){T.readyState=1,u&&f.trigger("ajaxSend",[T,c]),c.async&&c.timeout>0&&(s=setTimeout(function(){T.abort("timeout")},c.timeout));try{v=1,n.send(m,k)}catch(C){if(!(2>v))throw C;k(-1,C)}}else k(-1,"No Transport");function k(e,t,o,a){var l,m,y,b,w,C=t;2!==v&&(v=2,s&&clearTimeout(s),n=undefined,i=a||"",T.readyState=e>0?4:0,l=e>=200&&300>e||304===e,o&&(b=pn(c,T,o)),b=fn(c,b,T,l),l?(c.ifModified&&(w=T.getResponseHeader("Last-Modified"),w&&(x.lastModified[r]=w),w=T.getResponseHeader("etag"),w&&(x.etag[r]=w)),204===e||"HEAD"===c.type?C="nocontent":304===e?C="notmodified":(C=b.state,m=b.data,y=b.error,l=!y)):(y=C,(e||!C)&&(C="error",0>e&&(e=0))),T.status=e,T.statusText=(t||C)+"",l?h.resolveWith(p,[m,C,T]):h.rejectWith(p,[T,C,y]),T.statusCode(g),g=undefined,u&&f.trigger(l?"ajaxSuccess":"ajaxError",[T,c,l?m:y]),d.fireWith(p,[T,C]),u&&(f.trigger("ajaxComplete",[T,c]),--x.active||x.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,n){return x.get(e,t,n,"json")},getScript:function(e,t){return x.get(e,undefined,t,"script")}}),x.each(["get","post"],function(e,t){x[t]=function(e,n,r,i){return x.isFunction(n)&&(i=i||r,r=n,n=undefined),x.ajax({url:e,type:t,dataType:i,data:n,success:r})}});function pn(e,t,n){var r,i,o,s,a=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),r===undefined&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in a)if(a[i]&&a[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}s||(s=i)}o=o||s}return o?(o!==u[0]&&u.unshift(o),n[o]):undefined}function fn(e,t,n,r){var i,o,s,a,u,l={},c=e.dataTypes.slice();if(c[1])for(s in e.converters)l[s.toLowerCase()]=e.converters[s];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(s=l[u+" "+o]||l["* "+o],!s)for(i in l)if(a=i.split(" "),a[1]===o&&(s=l[u+" "+a[0]]||l["* "+a[0]])){s===!0?s=l[i]:l[i]!==!0&&(o=a[0],c.unshift(a[1]));break}if(s!==!0)if(s&&e["throws"])t=s(t);else try{t=s(t)}catch(p){return{state:"parsererror",error:s?p:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return x.globalEval(e),e}}}),x.ajaxPrefilter("script",function(e){e.cache===undefined&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),x.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=x("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),o.head.appendChild(t[0])},abort:function(){n&&n()}}}});var hn=[],dn=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=hn.pop()||x.expando+"_"+Yt++;return this[e]=!0,e}}),x.ajaxPrefilter("json jsonp",function(t,n,r){var i,o,s,a=t.jsonp!==!1&&(dn.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&dn.test(t.data)&&"data");return a||"jsonp"===t.dataTypes[0]?(i=t.jsonpCallback=x.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(dn,"$1"+i):t.jsonp!==!1&&(t.url+=(Vt.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return s||x.error(i+" was not called"),s[0]},t.dataTypes[0]="json",o=e[i],e[i]=function(){s=arguments},r.always(function(){e[i]=o,t[i]&&(t.jsonpCallback=n.jsonpCallback,hn.push(i)),s&&x.isFunction(o)&&o(s[0]),s=o=undefined}),"script"):undefined}),x.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var gn=x.ajaxSettings.xhr(),mn={0:200,1223:204},yn=0,vn={};e.ActiveXObject&&x(e).on("unload",function(){for(var e in vn)vn[e]();vn=undefined}),x.support.cors=!!gn&&"withCredentials"in gn,x.support.ajax=gn=!!gn,x.ajaxTransport(function(e){var t;return x.support.cors||gn&&!e.crossDomain?{send:function(n,r){var i,o,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(i in e.xhrFields)s[i]=e.xhrFields[i];e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(i in n)s.setRequestHeader(i,n[i]);t=function(e){return function(){t&&(delete vn[o],t=s.onload=s.onerror=null,"abort"===e?s.abort():"error"===e?r(s.status||404,s.statusText):r(mn[s.status]||s.status,s.statusText,"string"==typeof s.responseText?{text:s.responseText}:undefined,s.getAllResponseHeaders()))}},s.onload=t(),s.onerror=t("error"),t=vn[o=yn++]=t("abort"),s.send(e.hasContent&&e.data||null)},abort:function(){t&&t()}}:undefined});var xn,bn,wn=/^(?:toggle|show|hide)$/,Tn=RegExp("^(?:([+-])=|)("+b+")([a-z%]*)$","i"),Cn=/queueHooks$/,kn=[An],Nn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=Tn.exec(t),o=i&&i[3]||(x.cssNumber[e]?"":"px"),s=(x.cssNumber[e]||"px"!==o&&+r)&&Tn.exec(x.css(n.elem,e)),a=1,u=20;if(s&&s[3]!==o){o=o||s[3],i=i||[],s=+r||1;do a=a||".5",s/=a,x.style(n.elem,e,s+o);while(a!==(a=n.cur()/r)&&1!==a&&--u)}return i&&(s=n.start=+s||+r||0,n.unit=o,n.end=i[1]?s+(i[1]+1)*i[2]:+i[2]),n}]};function En(){return setTimeout(function(){xn=undefined}),xn=x.now()}function Sn(e,t,n){var r,i=(Nn[t]||[]).concat(Nn["*"]),o=0,s=i.length;for(;s>o;o++)if(r=i[o].call(n,t,e))return r}function jn(e,t,n){var r,i,o=0,s=kn.length,a=x.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;var t=xn||En(),n=Math.max(0,l.startTime+l.duration-t),r=n/l.duration||0,o=1-r,s=0,u=l.tweens.length;for(;u>s;s++)l.tweens[s].run(o);return a.notifyWith(e,[l,o,n]),1>o&&u?n:(a.resolveWith(e,[l]),!1)},l=a.promise({elem:e,props:x.extend({},t),opts:x.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:xn||En(),duration:n.duration,tweens:[],createTween:function(t,n){var r=x.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)l.tweens[n].run(1);return t?a.resolveWith(e,[l,t]):a.rejectWith(e,[l,t]),this}}),c=l.props;for(Dn(c,l.opts.specialEasing);s>o;o++)if(r=kn[o].call(l,e,c,l.opts))return r;return x.map(c,Sn,l),x.isFunction(l.opts.start)&&l.opts.start.call(e,l),x.fx.timer(x.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function Dn(e,t){var n,r,i,o,s;for(n in e)if(r=x.camelCase(n),i=t[r],o=e[n],x.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),s=x.cssHooks[r],s&&"expand"in s){o=s.expand(o),delete e[r];for(n in o)n in e||(e[n]=o[n],t[n]=i)}else t[r]=i}x.Animation=x.extend(jn,{tweener:function(e,t){x.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Nn[n]=Nn[n]||[],Nn[n].unshift(t)},prefilter:function(e,t){t?kn.unshift(e):kn.push(e)}});function An(e,t,n){var r,i,o,s,a,u,l=this,c={},p=e.style,f=e.nodeType&&Lt(e),h=q.get(e,"fxshow");n.queue||(a=x._queueHooks(e,"fx"),null==a.unqueued&&(a.unqueued=0,u=a.empty.fire,a.empty.fire=function(){a.unqueued||u()}),a.unqueued++,l.always(function(){l.always(function(){a.unqueued--,x.queue(e,"fx").length||a.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===x.css(e,"display")&&"none"===x.css(e,"float")&&(p.display="inline-block")),n.overflow&&(p.overflow="hidden",l.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],wn.exec(i)){if(delete t[r],o=o||"toggle"===i,i===(f?"hide":"show")){if("show"!==i||!h||h[r]===undefined)continue;f=!0}c[r]=h&&h[r]||x.style(e,r)}if(!x.isEmptyObject(c)){h?"hidden"in h&&(f=h.hidden):h=q.access(e,"fxshow",{}),o&&(h.hidden=!f),f?x(e).show():l.done(function(){x(e).hide()}),l.done(function(){var t;q.remove(e,"fxshow");for(t in c)x.style(e,t,c[t])});for(r in c)s=Sn(f?h[r]:0,r,l),r in h||(h[r]=s.start,f&&(s.end=s.start,s.start="width"===r||"height"===r?1:0))}}function Ln(e,t,n,r,i){return new Ln.prototype.init(e,t,n,r,i)}x.Tween=Ln,Ln.prototype={constructor:Ln,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(x.cssNumber[n]?"":"px")},cur:function(){var e=Ln.propHooks[this.prop];return e&&e.get?e.get(this):Ln.propHooks._default.get(this)},run:function(e){var t,n=Ln.propHooks[this.prop];return this.pos=t=this.options.duration?x.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Ln.propHooks._default.set(this),this}},Ln.prototype.init.prototype=Ln.prototype,Ln.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=x.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){x.fx.step[e.prop]?x.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[x.cssProps[e.prop]]||x.cssHooks[e.prop])?x.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Ln.propHooks.scrollTop=Ln.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},x.each(["toggle","show","hide"],function(e,t){var n=x.fn[t];x.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(qn(t,!0),e,r,i)}}),x.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Lt).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=x.isEmptyObject(e),o=x.speed(t,n,r),s=function(){var t=jn(this,x.extend({},e),o);(i||q.get(this,"finish"))&&t.stop(!0)};return s.finish=s,i||o.queue===!1?this.each(s):this.queue(o.queue,s)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=undefined),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=x.timers,s=q.get(this);if(i)s[i]&&s[i].stop&&r(s[i]);else for(i in s)s[i]&&s[i].stop&&Cn.test(i)&&r(s[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));(t||!n)&&x.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=q.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=x.timers,s=r?r.length:0;for(n.finish=!0,x.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;s>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}});function qn(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=jt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}x.each({slideDown:qn("show"),slideUp:qn("hide"),slideToggle:qn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){x.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),x.speed=function(e,t,n){var r=e&&"object"==typeof e?x.extend({},e):{complete:n||!n&&t||x.isFunction(e)&&e,duration:e,easing:n&&t||t&&!x.isFunction(t)&&t};return r.duration=x.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in x.fx.speeds?x.fx.speeds[r.duration]:x.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){x.isFunction(r.old)&&r.old.call(this),r.queue&&x.dequeue(this,r.queue)},r},x.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},x.timers=[],x.fx=Ln.prototype.init,x.fx.tick=function(){var e,t=x.timers,n=0;for(xn=x.now();t.length>n;n++)e=t[n],e()||t[n]!==e||t.splice(n--,1);t.length||x.fx.stop(),xn=undefined},x.fx.timer=function(e){e()&&x.timers.push(e)&&x.fx.start()},x.fx.interval=13,x.fx.start=function(){bn||(bn=setInterval(x.fx.tick,x.fx.interval))},x.fx.stop=function(){clearInterval(bn),bn=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fx.step={},x.expr&&x.expr.filters&&(x.expr.filters.animated=function(e){return x.grep(x.timers,function(t){return e===t.elem}).length}),x.fn.offset=function(e){if(arguments.length)return e===undefined?this:this.each(function(t){x.offset.setOffset(this,e,t)});var t,n,i=this[0],o={top:0,left:0},s=i&&i.ownerDocument;if(s)return t=s.documentElement,x.contains(t,i)?(typeof i.getBoundingClientRect!==r&&(o=i.getBoundingClientRect()),n=Hn(s),{top:o.top+n.pageYOffset-t.clientTop,left:o.left+n.pageXOffset-t.clientLeft}):o},x.offset={setOffset:function(e,t,n){var r,i,o,s,a,u,l,c=x.css(e,"position"),p=x(e),f={};"static"===c&&(e.style.position="relative"),a=p.offset(),o=x.css(e,"top"),u=x.css(e,"left"),l=("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1,l?(r=p.position(),s=r.top,i=r.left):(s=parseFloat(o)||0,i=parseFloat(u)||0),x.isFunction(t)&&(t=t.call(e,n,a)),null!=t.top&&(f.top=t.top-a.top+s),null!=t.left&&(f.left=t.left-a.left+i),"using"in t?t.using.call(e,f):p.css(f)}},x.fn.extend({position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===x.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),x.nodeName(e[0],"html")||(r=e.offset()),r.top+=x.css(e[0],"borderTopWidth",!0),r.left+=x.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-x.css(n,"marginTop",!0),left:t.left-r.left-x.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||s;while(e&&!x.nodeName(e,"html")&&"static"===x.css(e,"position"))e=e.offsetParent;return e||s})}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,n){var r="pageYOffset"===n;x.fn[t]=function(i){return x.access(this,function(t,i,o){var s=Hn(t);return o===undefined?s?s[n]:t[i]:(s?s.scrollTo(r?e.pageXOffset:o,r?o:e.pageYOffset):t[i]=o,undefined)},t,i,arguments.length,null)}});function Hn(e){return x.isWindow(e)?e:9===e.nodeType&&e.defaultView}x.each({Height:"height",Width:"width"},function(e,t){x.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){x.fn[r]=function(r,i){var o=arguments.length&&(n||"boolean"!=typeof r),s=n||(r===!0||i===!0?"margin":"border");return x.access(this,function(t,n,r){var i;return x.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):r===undefined?x.css(t,n,s):x.style(t,n,r,s)},t,o?r:undefined,o,null)}})}),x.fn.size=function(){return this.length},x.fn.andSelf=x.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=x:"function"==typeof define&&define.amd&&define("jquery",[],function(){return x}),"object"==typeof e&&"object"==typeof e.document&&(e.jQuery=e.$=x)})(window);
(function(l){var b=jQuery.fn.jquery>="1.8";var m={xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",html:"http://www.w3.org/1999/xhtml/"};rbackslash=/\\(?!\\)/g;var r={};for(var f in m){r[m[f]]=f}l.extend({xmlns:l.extend({},m,{"":"*"})});var n=[];l.fn.extend({xmlns:function(u,v){if(typeof u=="string"){u={"":u}}if(u){n.push(l.xmlns);l.xmlns=l.extend({},l.xmlns,u);if(v!==undefined){if(typeof v=="string"){return this.find(v).xmlns(undefined)}else{var t=this;try{t=v.call(this);if(!t){t=this}}finally{t.xmlns(undefined)}return t}}else{return this}}else{l.xmlns=(n?n.pop():{});return this}}});var p=function(u){if(!u){return l.xmlns[""]}u=u.substr(0,u.length-1);if(u==""||u=="*"){return u}var t=l.xmlns[u];if(typeof(t)=="undefined"){throw"Syntax error, undefined namespace prefix '"+u+"'"}return t};var g=(b)?function(t,u){l.expr.match[t]=u}:function(t,u){l.expr.match[t]=new RegExp(u.source+/(?![^\[]*\])(?![^\(]*\))/.source);if(l.expr.leftMatch){l.expr.leftMatch[t]=new RegExp(/(^(?:.|\r|\n)*?)/.source+l.expr.match[t].source.replace(/\\(\d+)/g,function(w,v){return"\\"+(v-0+1)}))}};if(b){g("TAG",/^((?:((?:\\.|[-\w*]|[^\x00-\xa0])+\|)?((?:\\.|[-\w*]|[^\x00-\xa0])+)))/)}else{g("TAG",/^((?:((?:[\w\u00c0-\uFFFF\*_-]*\|)?)((?:[\w\u00c0-\uFFFF\*_-]|\\.)+)))/)}var a=document.createElement("div");var e=false;a.appendChild(document.createComment(""));if(a.getElementsByTagName("*").length>0){e=true}var s=true;if(a.localName&&a.localName=="div"){s=false}a=null;l.expr.find.TAG=function(w,t,B){if(!jQuery.isArray(w)){if(typeof t.getElementsByTagName!=="undefined"){return t.getElementsByTagName(w)}}var z=p(w[2]);var x=w[3];var y;if(typeof t.getElementsByTagNameNS!="undefined"){y=t.getElementsByTagNameNS(z,x)}else{if(typeof t.selectNodes!="undefined"){if(t.ownerDocument){t.ownerDocument.setProperty("SelectionLanguage","XPath")}else{t.setProperty("SelectionLanguage","XPath")}var A="";if(z!="*"){if(x!="*"){A="namespace-uri()='"+z+"' and local-name()='"+x+"'"}else{A="namespace-uri()='"+z+"'"}}else{if(x!="*"){A="local-name()='"+x+"'"}}if(A){y=t.selectNodes("descendant-or-self::*["+A+"]")}else{y=t.selectNodes("descendant-or-self::*")}}else{y=t.getElementsByTagName(x);if(e&&x=="*"){var v=[];for(var u=0;y[u];u++){if(y[u].nodeType==1){v.push(y[u])}}y=v}if(y&&z!="*"){var v=[];for(var u=0;y[u];u++){if(y[u].namespaceURI==z||y[u].tagUrn==z){v.push(y[u])}}y=v}}}return y};var q=function(t){return t.nodeType===9&&t.documentElement.nodeName!=="HTML"||!!t.ownerDocument&&t.ownerDocument.documentElement.nodeName!=="HTML"};l.expr.preFilter.TAG=function(w,u,v,t,y,z){var x=w[3];if(!z){if(s){x=x.toUpperCase()}else{x=x.toLowerCase()}}return[w[0],p(w[2]),x]};function c(t,u){return function(x){var v=x.namespaceURI?x.namespaceURI:x.tagUrn;var w=x.localName?x.localName:x.tagName;if(t=="*"||v==t||(t==""&&!v)){return((u=="*"&&x.nodeType==1)||w==u)}return false}}l.expr.filter.TAG=(b)?c:function(w,t){var u=t[1];var v=t[2];return c(u,v).call(this,w,null)};if(b){g("ATTR",/^\[[\x20\t\r\n\f]*(((?:\\.|[-\w]|[^\x00-\xa0])+\|)?((?:\\.|[-\w]|[^\x00-\xa0])+))[\x20\t\r\n\f]*(?:([*^$|!~]?=)[\x20\t\r\n\f]*(?:(['"])((?:\\.|[^\\])*?)\5|((?:\\.|[-\w]|[^\x00-\xa0])+\|)?((?:\\.|[-\w#]|[^\x00-\xa0])+)|)|)[\x20\t\r\n\f]*\]/)}else{g("ATTR",/\[\s*((?:((?:[\w\u00c0-\uFFFF\*_-]*\|)?)((?:[\w\u00c0-\uFFFF_-]|\\.)+)))\s*(?:(\S?=)\s*(['"]*)(.*?)\5|)\s*\]/)}l.expr.preFilter.ATTR=(b)?function(u,v,w){var t=u[1].replace(rbackslash,"");if(u[4]=="~="){u[6]=" "+u[6]+" "}u[5]=(u[6]||u[7]||"").replace(rbackslash,"");if(!u[2]||u[2]=="|"){u[2]=""}else{u[2]=p(u[2])}return u.slice(0,6)}:function(x,u,v,t,y,z){var w=x[3].replace(/\\/g,"");if(!z&&l.expr.attrMap[w]){x[3]=l.expr.attrMap[w]}if(x[4]=="~="){x[6]=" "+x[6]+" "}if(!x[2]||x[2]=="|"){x[2]=""}else{x[2]=p(x[2])}return x};var o=function(t,v,u){if(t==null){return v==="!="}if(!v){return true}t+="";return v==="="?t===u:v==="!="?t!==u:v==="^="?u&&t.indexOf(u)===0:v==="*="?u&&t.indexOf(u)>-1:v==="$="?u&&t.substr(t.length-u.length)===u:v==="~="?(" "+t+" ").indexOf(u)>-1:v==="|="?t===u||t.substr(0,u.length+1)===u+"-":false};function h(v,w,u,x,t){return function(E,C){if(w==""){var z=l(E).attr(u);return o(z,x,t)}else{if(w!="*"&&typeof E.getAttributeNS!="undefined"){return o(E.getAttributeNS(w,u),x,t)}var A=E.attributes;for(var B=0;A[B];B++){var D=A[B].localName;if(!D){D=A[B].nodeName;var y=D.indexOf(":");if(y>=0){D=D.substr(y+1)}}if(D==u){z=A[B].nodeValue;if(w=="*"||A[B].namespaceURI==w){if(o(z,x,t)){return true}}if(A[B].namespaceURI===""&&A[B].prefix){if(A[B].prefix==r[w]){if(o(z,x,t)){return true}}}}}return false}}}l.expr.filter.ATTR=(b)?h:function(y,v){var x=v[2];var u=v[3];var w=v[4];var t=v[6];return h(null,x,u,w,t).call(this,y,null)}})(jQuery);(function($){var escape=/["\\\x00-\x1f\x7f-\x9f]/g,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},hasOwn=Object.prototype.hasOwnProperty;$.toJSON=typeof JSON==="object"&&JSON.stringify?JSON.stringify:function(o){if(o===null){return"null"}var pairs,k,name,val,type=$.type(o);if(type==="undefined"){return undefined}if(type==="number"||type==="boolean"){return String(o)}if(type==="string"){return $.quoteString(o)}if(typeof o.toJSON==="function"){return $.toJSON(o.toJSON())}if(type==="date"){var month=o.getUTCMonth()+1,day=o.getUTCDate(),year=o.getUTCFullYear(),hours=o.getUTCHours(),minutes=o.getUTCMinutes(),seconds=o.getUTCSeconds(),milli=o.getUTCMilliseconds();if(month<10){month="0"+month}if(day<10){day="0"+day}if(hours<10){hours="0"+hours}if(minutes<10){minutes="0"+minutes}if(seconds<10){seconds="0"+seconds}if(milli<100){milli="0"+milli}if(milli<10){milli="0"+milli}return'"'+year+"-"+month+"-"+day+"T"+hours+":"+minutes+":"+seconds+"."+milli+'Z"'}pairs=[];if($.isArray(o)){for(k=0;k<o.length;k++){pairs.push($.toJSON(o[k])||"null")}return"["+pairs.join(",")+"]"}if(typeof o==="object"){for(k in o){if(hasOwn.call(o,k)){type=typeof k;if(type==="number"){name='"'+k+'"'}else{if(type==="string"){name=$.quoteString(k)}else{continue}}type=typeof o[k];if(type!=="function"&&type!=="undefined"){val=$.toJSON(o[k]);pairs.push(name+":"+val)}}}return"{"+pairs.join(",")+"}"}};$.evalJSON=typeof JSON==="object"&&JSON.parse?JSON.parse:function(str){return eval("("+str+")")};$.secureEvalJSON=typeof JSON==="object"&&JSON.parse?JSON.parse:function(str){var filtered=str.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"");if(/^[\],:{}\s]*$/.test(filtered)){return eval("("+str+")")}throw new SyntaxError("Error parsing JSON, source is not valid.")};$.quoteString=function(str){if(str.match(escape)){return'"'+str.replace(escape,function(a){var c=meta[a];if(typeof c==="string"){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"'}return'"'+str+'"'}}(jQuery));(function(m,p,v,r,n){var t=v.createElement("div"),h=t.style,c="Transform",C=["O"+c,"ms"+c,"Webkit"+c,"Moz"+c],z=C.length,a,l,G="Float32Array" in p,J,w,F=/Matrix([^)]*)/,q=/^\s*matrix\(\s*1\s*,\s*0\s*,\s*0\s*,\s*1\s*(?:,\s*0(?:px)?\s*){2}\)\s*$/,I="transform",K="transformOrigin",H="translate",f="rotate",s="scale",B="skew",b="matrix";while(z--){if(C[z] in h){m.support[I]=a=C[z];m.support[K]=a+"Origin";continue}}if(!a){m.support.matrixFilter=l=h.filter===""}m.cssNumber[I]=m.cssNumber[K]=true;if(a&&a!=I){m.cssProps[I]=a;m.cssProps[K]=a+"Origin";if(a=="Moz"+c){J={get:function(M,L){return(L?m.css(M,a).split("px").join(""):M.style[a])},set:function(L,M){L.style[a]=/matrix\([^)p]*\)/.test(M)?M.replace(/matrix((?:[^,]*,){4})([^,]*),([^)]*)/,b+"$1$2px,$3px"):M}}}else{if(/^1\.[0-5](?:\.|$)/.test(m.fn.jquery)){J={get:function(M,L){return(L?m.css(M,a.replace(/^ms/,"Ms")):M.style[a])}}}}}else{if(l){J={get:function(P,O,L){var N=(O&&P.currentStyle?P.currentStyle:P.style),M,Q;if(N&&F.test(N.filter)){M=RegExp.$1.split(",");M=[M[0].split("=")[1],M[2].split("=")[1],M[1].split("=")[1],M[3].split("=")[1]]}else{M=[1,0,0,1]}if(!m.cssHooks[K]){M[4]=N?parseInt(N.left,10)||0:0;M[5]=N?parseInt(N.top,10)||0:0}else{Q=m._data(P,"transformTranslate",n);M[4]=Q?Q[0]:0;M[5]=Q?Q[1]:0}return L?M:b+"("+M+")"},set:function(R,S,N){var M=R.style,O,L,Q,P;if(!N){M.zoom=1}S=y(S);L=["Matrix(M11="+S[0],"M12="+S[2],"M21="+S[1],"M22="+S[3],"SizingMethod='auto expand'"].join();Q=(O=R.currentStyle)&&O.filter||M.filter||"";M.filter=F.test(Q)?Q.replace(F,L):Q+" progid:DXImageTransform.Microsoft."+L+")";if(!m.cssHooks[K]){if((P=m.transform.centerOrigin)){M[P=="margin"?"marginLeft":"left"]=-(R.offsetWidth/2)+(R.clientWidth/2)+"px";M[P=="margin"?"marginTop":"top"]=-(R.offsetHeight/2)+(R.clientHeight/2)+"px"}M.left=S[4]+"px";M.top=S[5]+"px"}else{m.cssHooks[K].set(R,S)}}}}}if(J){m.cssHooks[I]=J}w=J&&J.get||m.css;m.fx.step.transform=function(P){var O=P.elem,M=P.start,Q=P.end,U=P.pos,N="",S=100000,R,L,T,V;if(!M||typeof M==="string"){if(!M){M=w(O,a)}if(l){O.style.zoom=1}Q=Q.split("+=").join(M);m.extend(P,e(M,Q));M=P.start;Q=P.end}R=M.length;while(R--){L=M[R];T=Q[R];V=+false;switch(L[0]){case H:V="px";case s:V||(V="");N=L[0]+"("+r.round((L[1][0]+(T[1][0]-L[1][0])*U)*S)/S+V+","+r.round((L[1][1]+(T[1][1]-L[1][1])*U)*S)/S+V+")"+N;break;case B+"X":case B+"Y":case f:N=L[0]+"("+r.round((L[1]+(T[1]-L[1])*U)*S)/S+"rad)"+N;break}}P.origin&&(N=P.origin+N);J&&J.set?J.set(O,N,+true):O.style[a]=N};function y(N){N=N.split(")");var O=m.trim,R=-1,Q=N.length-1,T,L,M,P=G?new Float32Array(6):[],U=G?new Float32Array(6):[],S=G?new Float32Array(6):[1,0,0,1,0,0];P[0]=P[3]=S[0]=S[3]=1;P[1]=P[2]=P[4]=P[5]=0;while(++R<Q){T=N[R].split("(");L=O(T[0]);M=T[1];U[0]=U[3]=1;U[1]=U[2]=U[4]=U[5]=0;switch(L){case H+"X":U[4]=parseInt(M,10);break;case H+"Y":U[5]=parseInt(M,10);break;case H:M=M.split(",");U[4]=parseInt(M[0],10);U[5]=parseInt(M[1]||0,10);break;case f:M=g(M);U[0]=r.cos(M);U[1]=r.sin(M);U[2]=-r.sin(M);U[3]=r.cos(M);break;case s+"X":U[0]=+M;break;case s+"Y":U[3]=M;break;case s:M=M.split(",");U[0]=M[0];U[3]=M.length>1?M[1]:M[0];break;case B+"X":U[2]=r.tan(g(M));break;case B+"Y":U[1]=r.tan(g(M));break;case b:M=M.split(",");U[0]=M[0];U[1]=M[1];U[2]=M[2];U[3]=M[3];U[4]=parseInt(M[4],10);U[5]=parseInt(M[5],10);break}S[0]=P[0]*U[0]+P[2]*U[1];S[1]=P[1]*U[0]+P[3]*U[1];S[2]=P[0]*U[2]+P[2]*U[3];S[3]=P[1]*U[2]+P[3]*U[3];S[4]=P[0]*U[4]+P[2]*U[5]+P[4];S[5]=P[1]*U[4]+P[3]*U[5]+P[5];P=[S[0],S[1],S[2],S[3],S[4],S[5]]}return S}function u(O){var P,N,M,L=O[0],S=O[1],R=O[2],Q=O[3];if(L*Q-S*R){P=r.sqrt(L*L+S*S);L/=P;S/=P;M=L*R+S*Q;R-=L*M;Q-=S*M;N=r.sqrt(R*R+Q*Q);R/=N;Q/=N;M/=N;if(L*Q<S*R){L=-L;S=-S;M=-M;P=-P}}else{P=N=M=0}return[[H,[+O[4],+O[5]]],[f,r.atan2(S,L)],[B+"X",r.atan(M)],[s,[P,N]]]}function e(S,M){var P={start:[],end:[]},N=-1,L,O,Q,R;(S=="none"||E(S))&&(S="");(M=="none"||E(M))&&(M="");if(S&&M&&!M.indexOf("matrix")&&x(S).join()==x(M.split(")")[0]).join()){P.origin=S;S="";M=M.slice(M.indexOf(")")+1)}if(!S&&!M){return}if(!S||!M||A(S)==A(M)){S&&(S=S.split(")"))&&(L=S.length);M&&(M=M.split(")"))&&(L=M.length);while(++N<L-1){S[N]&&(O=S[N].split("("));M[N]&&(Q=M[N].split("("));R=m.trim((O||Q)[0]);D(P.start,o(R,O?O[1]:0));D(P.end,o(R,Q?Q[1]:0))}}else{P.start=u(y(S));P.end=u(y(M))}return P}function o(O,P){var M=+(!O.indexOf(s)),N,L=O.replace(/e[XY]/,"e");switch(O){case H+"Y":case s+"Y":P=[M,P?parseFloat(P):M];break;case H+"X":case H:case s+"X":N=1;case s:P=P?(P=P.split(","))&&[parseFloat(P[0]),parseFloat(P.length>1?P[1]:O==s?N||P[0]:M+"")]:[M,M];break;case B+"X":case B+"Y":case f:P=P?g(P):0;break;case b:return u(P?x(P):[1,0,0,1,0,0]);break}return[[L,P]]}function E(L){return q.test(L)}function A(L){return L.replace(/(?:\([^)]*\))|\s/g,"")}function D(M,L,N){while(N=L.shift()){M.push(N)}}function g(L){return ~L.indexOf("deg")?parseInt(L,10)*(r.PI*2/360):~L.indexOf("grad")?parseInt(L,10)*(r.PI/200):parseFloat(L)}function x(L){L=/([^,]*),([^,]*),([^,]*),([^,]*),([^,p]*)(?:px)?,([^)p]*)(?:px)?/.exec(L);return[L[1],L[2],L[3],L[4],L[5],L[6]]}m.transform={centerOrigin:"margin"}})(jQuery,window,document,Math);(function(e){var s=e.extend,n="mousedown",t="mousemove",o="mouseup",r="touchstart",l="touchmove",u="touchend",g="touchcancel";function f(A,y,z){if(y.substr(0,5)!=="touch"){return e(A).unbind(y,z)}var B,x;for(x=0;x<w._binds.length;x++){if(w._binds[x].elem===A&&w._binds[x].type===y&&w._binds[x].func===z){if(document.addEventListener){A.removeEventListener(y,w._binds[x].fnc,false)}else{A.detachEvent("on"+y,w._binds[x].fnc)}w._binds.splice(x--,1)}}}function w(B,y,A,z){if(y.substr(0,5)!=="touch"){return e(B).bind(y,z,A)}var C,x;if(w[y]){return w[y].bind(B,y,A,z)}C=function(D){if(!D){D=window.event}if(!D.stopPropagation){D.stopPropagation=function(){this.cancelBubble=true}}D.data=z;A.call(B,D)};if(document.addEventListener){B.addEventListener(y,C,false)}else{B.attachEvent("on"+y,C)}w._binds.push({elem:B,type:y,func:A,fnc:C})}function h(y,x){var z={move:{x:0,y:0},offset:{x:0,y:0},position:{x:0,y:0},start:{x:0,y:0},affects:document.documentElement,stopPropagation:false,preventDefault:true,touch:true};s(z,x);z.element=y;w(y,n,v,z);if(z.touch){w(y,r,a,z)}}function m(x){f(x,n,n)}function v(x){x.data.position.x=x.pageX;x.data.position.y=x.pageY;x.data.start.x=x.pageX;x.data.start.y=x.pageY;x.data.event=x;if(x.data.onstart&&x.data.onstart.call(x.data.element,x.data)){return}if(x.preventDefault&&x.data.preventDefault){x.preventDefault()}if(x.stopPropagation&&x.data.stopPropagation){x.stopPropagation()}w(x.data.affects,t,b,x.data);w(x.data.affects,o,q,x.data)}function b(x){if(x.preventDefault&&x.data.preventDefault){x.preventDefault()}if(x.stopPropagation&&x.data.preventDefault){x.stopPropagation()}x.data.move.x=x.pageX-x.data.position.x;x.data.move.y=x.pageY-x.data.position.y;x.data.position.x=x.pageX;x.data.position.y=x.pageY;x.data.offset.x=x.pageX-x.data.start.x;x.data.offset.y=x.pageY-x.data.start.y;x.data.event=x;if(x.data.onmove){x.data.onmove.call(x.data.element,x.data)}}function q(x){if(x.preventDefault&&x.data.preventDefault){x.preventDefault()}if(x.stopPropagation&&x.data.stopPropagation){x.stopPropagation()}f(x.data.affects,t,b);f(x.data.affects,o,q);x.data.event=x;if(x.data.onfinish){x.data.onfinish.call(x.data.element,x.data)}}function a(x){x.data.position.x=x.touches[0].pageX;x.data.position.y=x.touches[0].pageY;x.data.start.x=x.touches[0].pageX;x.data.start.y=x.touches[0].pageY;x.data.event=x;if(x.data.onstart&&x.data.onstart.call(x.data.element,x.data)){return}if(x.preventDefault&&x.data.preventDefault){x.preventDefault()}if(x.stopPropagation&&x.data.stopPropagation){x.stopPropagation()}w(x.data.affects,l,p,x.data);w(x.data.affects,u,c,x.data)}function p(x){if(x.preventDefault&&x.data.preventDefault){x.preventDefault()}if(x.stopPropagation&&x.data.stopPropagation){x.stopPropagation()}x.data.move.x=x.touches[0].pageX-x.data.position.x;x.data.move.y=x.touches[0].pageY-x.data.position.y;x.data.position.x=x.touches[0].pageX;x.data.position.y=x.touches[0].pageY;x.data.offset.x=x.touches[0].pageX-x.data.start.x;x.data.offset.y=x.touches[0].pageY-x.data.start.y;x.data.event=x;if(x.data.onmove){x.data.onmove.call(x.data.elem,x.data)}}function c(x){if(x.preventDefault&&x.data.preventDefault){x.preventDefault()}if(x.stopPropagation&&x.data.stopPropagation){x.stopPropagation()}f(x.data.affects,l,p);f(x.data.affects,u,c);x.data.event=x;if(x.data.onfinish){x.data.onfinish.call(x.data.element,x.data)}}w._binds=[];e.fn.grab=function(y,x){return this.each(function(){return h(this,y,x)})};e.fn.ungrab=function(x){return this.each(function(){return m(this,x)})}})(jQuery);PureCSSMatrix=(function(){var b=/deg$/;var f=/([0-9.\-e]+)/g;var g=/([a-zA-Z]+)\(([^\)]+)\)/g;function c(l){if(l&&l!==null&&l!="none"){if(l instanceof Matrix){this.setMatrix(l)}else{this.setMatrixValue(l)}}else{this.m=Matrix.I(3)}}c.prototype.setMatrix=function(l){this.m=l};function e(m){var l=parseFloat(h(m));if(m.match(b)){l=(2*Math.PI)*l/360}return l}c.prototype.setMatrixValue=function(o){var l=Matrix.I(3);var m;while((m=g.exec(o))!==null){var p=m[1].toLowerCase();var r=m[2].split(",");var n;if(p=="matrix"){n=Matrix.create([[parseFloat(r[0]),parseFloat(r[2]),parseFloat(h(r[4]))],[parseFloat(r[1]),parseFloat(r[3]),parseFloat(h(r[5]))],[0,0,1]])}else{if(p=="translate"){n=Matrix.I(3);n.elements[0][2]=parseFloat(h(r[0]));n.elements[1][2]=parseFloat(h(r[1]))}else{if(p=="scale"){var s=parseFloat(r[0]);var q;if(r.length>1){q=parseFloat(r[1])}else{q=s}n=Matrix.create([[s,0,0],[0,q,0],[0,0,1]])}else{if(p=="rotate"){n=Matrix.RotationZ(e(r[0]))}else{if(p=="skew"||p=="skewx"){n=Matrix.I(3);n.elements[0][1]=Math.tan(e(r[0]))}else{if(p=="skewy"){n=Matrix.I(3);n.elements[1][0]=Math.tan(e(r[0]))}else{console.log("Problem with setMatrixValue",p,r)}}}}}}l=l.multiply(n)}this.m=l};c.prototype.multiply=function(l){return new c(this.m.multiply(l.m))};c.prototype.inverse=function(){if(Math.abs(this.m.elements[0][0])<0.000001){this.m.elements[0][0]=0}return new c(this.m.inverse())};c.prototype.translate=function(l,n){var m=Matrix.I(3);m.elements[0][2]=l;m.elements[1][2]=n;return new c(this.m.multiply(m))};c.prototype.scale=function(n,m){var l=Matrix.create([[n,0,0],[0,m,0],[0,0,1]]);return new c(this.m.multiply(l))};c.prototype.rotate=function(l){var m=Matrix.RotationZ(l);return new c(this.m.multiply(m))};c.prototype.toString=function(){var m=this.m.elements;var l="";if($.browser.mozilla||$.browser.opera){l="px"}return"matrix("+a(m[0][0])+", "+a(m[1][0])+", "+a(m[0][1])+", "+a(m[1][1])+", "+a(m[0][2])+l+", "+a(m[1][2])+l+")"};c.prototype.elements=function(){var l=this.m.elements;return{a:l[0][0],b:l[1][0],c:l[0][1],d:l[1][1],e:l[0][2],f:l[1][2]}};function h(l){return l.match(f)}function a(l){return Number(l).toFixed(6)}return c})();if(!$.zoomooz){$.zoomooz={}}$.zoomooz.helpers=(function(c,b){var a=["-moz-","-webkit-","-o-","-ms-"];b.forEachPrefix=function(f,g){for(var e=0;e<a.length;e++){f(a[e])}if(g){f("")}};b.getElementTransform=function(e){var f;b.forEachPrefix(function(g){f=f||c(e).css(g+"transform")},true);return f};return b})(jQuery,{});(function(e){var q;var z;var h=/([0-9.\-e]+)/g;var b=/([a-z]+)\(([^\)]+)\)/g;var u=/deg$/;var s=e.zoomooz.helpers;var r={duration:450,easing:"ease",nativeanimation:false};var o;jQuery.cssHooks.MsTransform={set:function(C,D){C.style.msTransform=D}};jQuery.cssHooks.MsTransformOrigin={set:function(C,D){C.style.msTransformOrigin=D}};e.fn.animateTransformation=function(D,C,G,E){C=jQuery.extend({},r,C);var F=(e.browser.webkit&&C.nativeanimation);if(o){clearTimeout(o);o=null}if(F&&G){o=setTimeout(G,C.duration)}this.each(function(){var H=e(this);if(!D){D=new PureCSSMatrix()}var I=y(H);var J=l(I,A(D));if(F){H.css(m(B(J),C.duration,C.easing));if(E){E()}}else{a(H,I,J,C,G,E)}})};e.fn.setTransformation=function(C){this.each(function(){var D=e(this);var E=y(D);var F=l(E,A(C));D.css(m(B(F)))})};function m(C,E,H){var G={};s.forEachPrefix(function(I){G[I+"transform"]=C},true);if(E){var D=n(E/1000,6)+"s";G["-webkit-transition-duration"]=D;G["-o-transition-duration"]=D;G["-moz-transition-duration"]=D}if(H){var F=x(H);G["-webkit-transition-timing-function"]=F;G["-o-transition-timing-function"]=F;G["-moz-transition-timing-function"]=D}return G}function a(C,D,G,E,H,F){if(!D){D=A(new PureCSSMatrix())}q=(new Date()).getTime();if(z){clearInterval(z);z=null}if(E.easing){E.easingfunction=v(E.easing,E.duration)}t(C,D,G,E,H);if(F){F()}z=setInterval(function(){t(C,D,G,E,H)},1)}function t(C,I,F,E,H){var G=(new Date()).getTime()-q;var D;if(E.easingfunction){D=E.easingfunction(G/E.duration)}else{D=G/E.duration}C.css(m(B(f(I,F,D))));if(G>E.duration){clearInterval(z);z=null;D=1;if(H){H()}}}function A(O){var D=O.elements();var P=D.a,M=D.b,K=D.c,J=D.d,I=D.e,H=D.f;if(Math.abs(P*J-M*K)<0.01){console.log("fail!");return}var G=I,F=H;var N=Math.sqrt(P*P+M*M);P=P/N;M=M/N;var E=P*K+M*J;K-=P*E;J-=M*E;var L=Math.sqrt(K*K+J*J);K=K/L;J=J/L;E=E/L;if((P*J-M*K)<0){P=-P;M=-M;K=-K;J=-J;N=-N;L=-L}var C=Math.atan2(M,P);return{tx:G,ty:F,r:C,k:Math.atan(E),sx:N,sy:L}}function B(C){var D="";D+="translate("+n(C.tx,6)+"px,"+n(C.ty,6)+"px) ";D+="rotate("+n(C.r,6)+"rad) skewX("+n(C.k,6)+"rad) ";D+="scale("+n(C.sx,6)+","+n(C.sy,6)+")";return D}function x(C){if((C instanceof Array)){return"cubic-bezier("+n(C[0],6)+","+n(C[1],6)+","+n(C[2],6)+","+n(C[3],6)+")"}else{return C}}function v(D,E){var F=[];if((D instanceof Array)){F=D}else{switch(D){case"linear":F=[0,0,1,1];break;case"ease":F=[0.25,0.1,0.25,1];break;case"ease-in":F=[0.42,0,1,1];break;case"ease-out":F=[0,0,0.58,1];break;case"ease-in-out":F=[0.42,0,0.58,1];break}}var C=function(G){return c(G,F[0],F[1],F[2],F[3],E)};return C}function g(F,H,G,D,J){var C,I,E=((1-F)*(1-F)*(1-F));C=H*(3*F*F*(1-F))+D*(3*F*(1-F)*(1-F))+E;I=G*(3*F*F*(1-F))+J*(3*F*(1-F)*(1-F))+E;return{x:Math.abs(C),y:Math.abs(I)}}function c(Q,E,D,M,L,C){var P=0,T=0,G=0,N=0,R=0,F=0;function K(U){return((P*U+T)*U+G)*U}function J(U){return((N*U+R)*U+F)*U}function S(U){return(3*P*U+2*T)*U+G}function O(U){return 1/(200*U)}function I(U,V){return J(H(U,V))}function H(ab,ac){var aa,Z,Y,V,U,X;function W(ad){if(ad>=0){return ad}else{return 0-ad}}for(Y=ab,X=0;X<8;X++){V=K(Y)-ab;if(W(V)<ac){return Y}U=S(Y);if(W(U)<0.000001){break}Y=Y-V/U}aa=0;Z=1;Y=ab;if(Y<aa){return aa}if(Y>Z){return Z}while(aa<Z){V=K(Y);if(W(V-ab)<ac){return Y}if(ab>V){aa=Y}else{Z=Y}Y=(Z-aa)*0.5+aa}return Y}G=3*E;T=3*(M-E)-G;P=1-G-T;F=3*D;R=3*(L-D)-F;N=1-F-R;return I(Q,O(C))}function y(E){var D=s.getElementTransform(E);var F;if(!D){F=new PureCSSMatrix()}else{F=new PureCSSMatrix(D)}var C=A(F);C.r=p(D);return C}function p(G){var F=0;var D;while((D=b.exec(G))!==null){var H=D[1].toLowerCase();var I=D[2].split(",");if(H=="matrix"){var J=H+"("+D[2]+")";F+=A(new PureCSSMatrix(J)).r}else{if(H=="rotate"){var E=I[0];var C=parseFloat(w(E));if(E.match(u)){C=(2*Math.PI)*C/360}F+=C}}}return F}function l(C,D){if(Math.abs(C.r-D.r)>Math.PI){if(D.r<C.r){while(Math.abs(C.r-D.r)>Math.PI){D.r+=(2*Math.PI)}}else{while(Math.abs(C.r-D.r)>Math.PI){D.r-=(2*Math.PI)}}}return D}function f(C,F,G){var E={};for(var D in C){if(C.hasOwnProperty(D)){E[D]=C[D]+(F[D]-C[D])*G}}return E}function n(E,C){C=Math.abs(parseInt(C,10))||0;var D=Math.pow(10,C);return Math.round(E*D)/D}function w(C){return C.match(h)}})(jQuery);(function(l){var g=l.zoomooz.helpers;var o=["duration","easing","nativeanimation"];m();if(!l.zoomooz){l.zoomooz={}}l.zoomooz.setup=function(u){l.zoomooz.defaultSettings=jQuery.extend(p(),u)};l.fn.zoomSettings=function(u){var v;this.each(function(){var w=l(this);v=s(w,u)});return v};l.fn.zoomTo=function(v,u){this.each(function(){var w=l(this);if(!u){v=w.zoomSettings(v)}h(w,v);if(v.debug){if(l("#debug").length===0){l(v.root).append('<div id="debug"><div>')}else{l("#debug").html("")}r(w,v)}else{if(l("#debug").length!==0){l("#debug").html("")}}});return this};function s(v,A){var z=jQuery.extend({},A);if(!l.zoomooz.defaultSettings){l.zoomooz.setup()}var y=l.zoomooz.defaultSettings;var u=jQuery.extend({},z);for(var x in y){if(y.hasOwnProperty(x)&&!u[x]){u[x]=v.data(x)}}for(var w=0;w<o.length;w++){var x=o[w];if(!u[x]){u[x]=v.data(x)}}return jQuery.extend({},y,u)}function m(){var v=document.createElement("style");v.type="text/css";var u="";g.forEachPrefix(function(w){u+=w+"transform-origin: 0 0;"},true);v.innerHTML="html {height:100%;}.noScroll{overflow:hidden !important;}body.noScroll,html.noScroll body{margin-right:15px;}* {"+u+"}";document.getElementsByTagName("head")[0].appendChild(v)}function p(){return{targetsize:0.9,scalemode:"both",root:l(document.body),debug:false,animationendcallback:null,closeclick:false}}function h(y,w){var A=b(y,w);var x;var z=null;f(w.root);if(y[0]!==w.root[0]){var u=e(y,w.root).inverse();x=c(y,u,w);if(w.animationendcallback){z=function(){w.animationendcallback.call(y[0])}}}else{x=(new PureCSSMatrix()).translate(-A.x,-A.y);z=function(){var C=l(w.root);var B=A.elem;B.removeClass("noScroll");C.setTransformation(new PureCSSMatrix());C.data("original-scroll",null);l(document).off("touchmove");if(B[0]==document.body||B[0]==window){window.scrollTo(A.x,A.y)}else{B.scrollLeft(A.x);B.scrollTop(A.y)}if(w.animationendcallback){w.animationendcallback.call(y[0])}}}var v=null;if(A&&A.animationstartedcallback){v=A.animationstartedcallback}l(w.root).animateTransformation(x,w,z,v)}function b(w,v){var A=v.root;var u=A.parent();if(w[0]===A[0]){var z=A.data("original-scroll");if(z){return z}else{return{elem:u,x:0,"y:":0}}}else{if(!A.data("original-scroll")){var y=A.scrollTop();var B=A.scrollLeft();var w=A;if(!y){y=u.scrollTop();B=u.scrollLeft();w=u}var z={elem:w,x:B,y:y};A.data("original-scroll",z);l(document).on("touchmove",function(C){C.preventDefault()});var x="translate(-"+B+"px,-"+y+"px)";g.forEachPrefix(function(C){A.css(C+"transform",x)});w.addClass("noScroll");z.animationstartedcallback=function(){if(w[0]==document.body||w[0]==document){window.scrollTo(0,0)}else{w.scrollLeft(0);w.scrollTop(0)}};return z}}}function f(z){var A=l(z).parent();var w=A.width();var y=A.height();var u=w/2;var v=y/2;var x=q(u)+"px "+q(v)+"px";g.forEachPrefix(function(B){z.css(B+"transform-origin",x)})}function c(H,D,G){var L=G.targetsize;var K=G.scalemode;var u=G.root;var I=l(u).parent();var C=I.width();var E=I.height();var v=C/H.outerWidth();var x=E/H.outerHeight();var M;if(K=="width"){M=L*v}else{if(K=="height"){M=L*x}else{if(K=="both"){M=L*Math.min(v,x)}else{if(K=="scale"){M=L}else{console.log("wrong zoommode");return}}}}var B=(C-H.outerWidth()*M)/2;var y=(E-H.outerHeight()*M)/2;var F=C/2;var w=E/2;var z=-parseFloat(u.css("margin-left"))||0;var J=-parseFloat(u.css("margin-top"))||0;var A=(new PureCSSMatrix()).translate(z,J).translate(-F,-w).translate(B,y).scale(M,M).multiply(D).translate(F,w);return A}function t(v,u,w){return[v.a*u+v.c*w+v.e,v.b*u+v.d*w+v.f]}function r(v,u){var w=e(v,u.root).elements();n(t(w,0,0));n(t(w,0,v.outerHeight()));n(t(w,v.outerWidth(),v.outerHeight()));n(t(w,v.outerWidth(),0))}function n(w){var u="width:4px;height:4px;background-color:red;position:absolute;margin-left:-2px;margin-top:-2px;";u+="left:"+w[0]+"px;top:"+w[1]+"px;";var v='<div class="debuglabel" style="'+u+'"></div>';l("#debug").append(v)}function e(C,G){var J=C[0];if(!J||!J.ownerDocument){return null}var I=new PureCSSMatrix();var v;if(J===J.ownerDocument.body){var L=jQuery.offset.bodyOffset(J);v=new PureCSSMatrix();v=v.translate(L.left,L.top);I=I.multiply(v);return I}var A;if(jQuery.offset.initialize){jQuery.offset.initialize();A={fixedPosition:jQuery.offset.supportsFixedPosition,doesNotAddBorder:jQuery.offset.doesNotAddBorder,doesAddBorderForTableAndCells:jQuery.support.doesAddBorderForTableAndCells,subtractsBorderForOverflowNotVisible:jQuery.offset.subtractsBorderForOverflowNotVisible}}else{A=jQuery.support}var u=J.offsetParent;var M=J.ownerDocument;var y;var K=M.documentElement;var B=M.body;var H=G[0];var F=M.defaultView;var x;if(F){x=F.getComputedStyle(J,null)}else{x=J.currentStyle}var D=J.offsetTop;var w=J.offsetLeft;var z=a().translate(w,D);z=z.multiply(a(J));I=z.multiply((I));while((J=J.parentNode)&&J!==H){D=0;w=0;if(A.fixedPosition&&x.position==="fixed"){break}y=F?F.getComputedStyle(J,null):J.currentStyle;D-=J.scrollTop;w-=J.scrollLeft;if(J===u){D+=J.offsetTop;w+=J.offsetLeft;if(A.doesNotAddBorder&&!(A.doesAddBorderForTableAndCells&&/^t(able|d|h)$/i.test(J.nodeName))){D+=parseFloat(y.borderTopWidth)||0;w+=parseFloat(y.borderLeftWidth)||0}u=J.offsetParent}if(A.subtractsBorderForOverflowNotVisible&&y.overflow!=="visible"){D+=parseFloat(y.borderTopWidth)||0;w+=parseFloat(y.borderLeftWidth)||0}x=y;if(J.offsetParent==H){D-=parseFloat(l(J.offsetParent).css("margin-top"))||0;w-=parseFloat(l(J.offsetParent).css("margin-left"))||0}z=a().translate(w,D);z=z.multiply(a(J));I=z.multiply(I)}D=0;w=0;if(x.position==="relative"||x.position==="static"){D+=B.offsetTop;w+=B.offsetLeft}if(A.fixedPosition&&x.position==="fixed"){D+=Math.max(K.scrollTop,B.scrollTop);w+=Math.max(K.scrollLeft,B.scrollLeft)}var E=(new PureCSSMatrix()).translate(w,D);I=I.multiply(E);return I}function q(u){return Number(u).toFixed(6)}function a(v){var u=g.getElementTransform(v);if(!u){return new PureCSSMatrix()}else{return new PureCSSMatrix(u)}}})(jQuery);(function(b){if(!b.zoomooz){b.zoomooz={}}var a=b.zoomooz.helpers;b.fn.zoomTarget=function(f){this.each(function(){var g=b(this).zoomSettings(f);c(b(this),b(this),g)})};function c(f,n,g){f.addClass("zoomTarget");if(!g.animationendcallback){if(!g.closeclick){g.animationendcallback=function(){b(".selectedZoomTarget").removeClass("selectedZoomTarget zoomNotClickable");f.addClass("selectedZoomTarget zoomNotClickable")}}else{g.animationendcallback=function(){b(".selectedZoomTarget").removeClass("selectedZoomTarget zoomNotClickable");f.addClass("selectedZoomTarget")}}}var m=n.closest(".zoomContainer");if(m.length!=0){g.root=m}var h=g.root;if(!h.hasClass("zoomTarget")){var l=h.zoomSettings({});l.animationendcallback=function(){var o=b(this);b(".selectedZoomTarget").removeClass("selectedZoomTarget zoomNotClickable");o.addClass("selectedZoomTarget zoomNotClickable");o.parent().addClass("selectedZoomTarget zoomNotClickable")};c(h,h,l);c(h.parent(),h,l);h.click()}f.on("click",function(o){if(g.closeclick&&n.hasClass("selectedZoomTarget")){g.root.click()}else{n.zoomTo(g)}o.stopPropagation()})}function e(){var f=document.createElement("style");f.type="text/css";function g(h){var l="-webkit-touch-callout: "+(h?"default":"none")+";";a.forEachPrefix(function(m){l+=m+"user-select:"+(h?"text":"none")+";"},true);return l}f.innerHTML=".zoomTarget{"+g(false)+"}.zoomTarget:hover{cursor:pointer!important;}.zoomNotClickable{"+g(true)+"}.zoomNotClickable:hover{cursor:auto!important;}.zoomContainer{position:relative;padding:1px;margin:-1px;}";document.getElementsByTagName("head")[0].appendChild(f)}e();b(document).ready(function(){b(".zoomTarget").zoomTarget()})})(jQuery);(function(a){if(!a.zoomooz){a.zoomooz={}}a.fn.zoomContainer=function(b){};a(document).ready(function(){a(".zoomContainer").zoomContainer()})})(jQuery);var Sylvester={version:"0.1.3",precision:0.000001};function Matrix(){}Matrix.prototype={dup:function(){return Matrix.create(this.elements)},canMultiplyFromLeft:function(a){var b=a.elements||a;if(typeof(b[0][0])=="undefined"){b=Matrix.create(b).elements}return(this.elements[0].length==b.length)},multiply:function(s){var l=s.modulus?true:false;var p=s.elements||s;if(typeof(p[0][0])=="undefined"){p=Matrix.create(p).elements}if(!this.canMultiplyFromLeft(p)){return null}var f=this.elements.length,g=f,n,b,e=p[0].length,h;var r=this.elements[0].length,a=[],o,m,q;do{n=g-f;a[n]=[];b=e;do{h=e-b;o=0;m=r;do{q=r-m;o+=this.elements[n][q]*p[q][h]}while(--m);a[n][h]=o}while(--b)}while(--f);var p=Matrix.create(a);return l?p.col(1):p},isSquare:function(){return(this.elements.length==this.elements[0].length)},toRightTriangular:function(){var g=this.dup(),e;var b=this.elements.length,c=b,f,h,l=this.elements[0].length,a;do{f=c-b;if(g.elements[f][f]==0){for(j=f+1;j<c;j++){if(g.elements[j][f]!=0){e=[];h=l;do{a=l-h;e.push(g.elements[f][a]+g.elements[j][a])}while(--h);g.elements[f]=e;break}}}if(g.elements[f][f]!=0){for(j=f+1;j<c;j++){var m=g.elements[j][f]/g.elements[f][f];e=[];h=l;do{a=l-h;e.push(a<=f?0:g.elements[j][a]-g.elements[f][a]*m)}while(--h);g.elements[j]=e}}}while(--b);return g},determinant:function(){if(!this.isSquare()){return null}var f=this.toRightTriangular();var c=f.elements[0][0],e=f.elements.length-1,a=e,b;do{b=a-e+1;c=c*f.elements[b][b]}while(--e);return c},isSingular:function(){return(this.isSquare()&&this.determinant()===0)},augment:function(n){var l=n.elements||n;if(typeof(l[0][0])=="undefined"){l=Matrix.create(l).elements}var f=this.dup(),m=f.elements[0].length;var c=f.elements.length,e=c,h,a,b=l[0].length,g;if(c!=l.length){return null}do{h=e-c;a=b;do{g=b-a;f.elements[h][m+g]=l[h][g]}while(--a)}while(--c);return f},inverse:function(){if(!this.isSquare()||this.isSingular()){return null}var c=this.elements.length,e=c,l,h;var m=this.augment(Matrix.I(c)).toRightTriangular();var n,o=m.elements[0].length,a,g,b;var q=[],f;do{l=c-1;g=[];n=o;q[l]=[];b=m.elements[l][l];do{a=o-n;f=m.elements[l][a]/b;g.push(f);if(a>=e){q[l].push(f)}}while(--n);m.elements[l]=g;for(h=0;h<l;h++){g=[];n=o;do{a=o-n;g.push(m.elements[h][a]-m.elements[l][a]*m.elements[h][l])}while(--n);m.elements[h]=g}}while(--c);return Matrix.create(q)},setElements:function(l){var o,a=l.elements||l;if(typeof(a[0][0])!="undefined"){var e=a.length,g=e,b,c,m;this.elements=[];do{o=g-e;b=a[o].length;c=b;this.elements[o]=[];do{m=c-b;this.elements[o][m]=a[o][m]}while(--b)}while(--e);return this}var f=a.length,h=f;this.elements=[];do{o=h-f;this.elements.push([a[o]])}while(--f);return this}};Matrix.create=function(a){var b=new Matrix();return b.setElements(a)};Matrix.I=function(g){var f=[],a=g,e,c,b;do{e=a-g;f[e]=[];c=a;do{b=a-c;f[e][b]=(e==b)?1:0}while(--c)}while(--g);return Matrix.create(f)};(function(f,h,m,n,b){var l={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(s){for(var p=0;p<s.length;p++){var q=s[p].string;var r=s[p].prop;this.versionSearchString=s[p].versionSearch||s[p].identity;if(q){if(q.indexOf(s[p].subString)!=-1){return s[p].identity}}else{if(r){return s[p].identity}}}},searchVersion:function(q){var p=q.indexOf(this.versionSearchString);if(p==-1){return}return parseFloat(q.substring(p+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:h.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};l.init();var o={MSIE:{Windows:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"}},Firefox:{Windows:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Linux:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Mac:{ctrlKey:false,altKey:false,metaKey:true,shiftKey:true,which:70,string:"&#x21E7;&#x2318;F",alt:"Shift+Command+F"}},Chrome:{Windows:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Linux:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Mac:{ctrlKey:false,altKey:false,metaKey:true,shiftKey:true,which:70,string:"&#x21E7;&#x2318;F",alt:"Shift+Command+F"}},Safari:{Mac:{ctrlKey:true,altKey:false,metaKey:false,shiftKey:true,which:70,string:"^&#x2318;F",alt:"Control+Command+F"}},Opera:{Windows:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Linux:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Mac:{ctrlKey:false,altKey:false,metaKey:true,shiftKey:true,which:70,string:"&#x21E7;&#x2318;F",alt:"Shift+Command+F"}},};var g=function(){return(m.clientHeight==n&&m.clientWidth==b)||h.fullScreen||(h.outerHeight==n&&h.outerWidth==b)||(l.browser=="Safari"&&h.outerHeight==(n-40)&&h.outerWidth==b)},c=f(h);var a=o[l.browser][l.OS];var e={shortcut:a.string,longform:a.alt};c.data("fullscreen-state",g()).data("fullscreen-key",e).resize(function(){var p=g();if(c.data("fullscreen-state")&&!p){c.data("fullscreen-state",p).trigger("fullscreen-toggle",[false]).trigger("fullscreen-off")}else{if(!c.data("fullscreen-state")&&p){c.data("fullscreen-state",p).trigger("fullscreen-toggle",[true]).trigger("fullscreen-on")}}}).keydown(function(p){if(a&&p.ctrlKey==a.ctrlKey&&p.altKey==a.altKey&&p.metaKey==a.metaKey&&p.shiftKey==a.shiftKey&&p.which==a.which){c.trigger("fullscreen-key",[a.string,a.alt])}})})(jQuery,this,document.documentElement,screen.height,screen.width);(function(b,a,c){(function(e){if(typeof define==="function"&&define.amd){define(["jquery","imagesloaded"],e)}else{if(jQuery&&!jQuery.fn.qtip){e(jQuery)}}}(function(at){var Q=true,G=false,ae=null,Z="x",W="y",L="width",ay="height",q="top",e="left",au="bottom",n="right",I="center",v="flip",V="flipinvert",r="shift",z,az,ak,h,aF={},s="qtip",E="data-hasqtip",ac="data-qtip-id",aj=["ui-widget","ui-tooltip"],y="."+s,ad="click dblclick mousedown mouseup mousemove mouseleave mouseenter".split(" "),B=s+"-fixed",O=s+"-default",M=s+"-focus",aE=s+"-hover",T=s+"-disabled",aD="_replacedByqTip",F="oldtitle",aC;BROWSER={ie:(function(){var C=3,X=a.createElement("div");while((X.innerHTML="<!--[if gt IE "+(++C)+"]><i></i><![endif]-->")){if(!X.getElementsByTagName("i")[0]){break}}return C>4?C:NaN}()),iOS:parseFloat((""+(/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))||G};function aw(Y,X,aG,C){this.id=aG;this.target=Y;this.tooltip=ae;this.elements=elements={target:Y};this._id=s+"-"+aG;this.timers={img:{}};this.options=X;this.plugins={};this.cache=cache={event:{},target:at(),disabled:G,attr:C,onTooltip:G,lastClass:""};this.rendered=this.destroyed=this.disabled=this.waiting=this.hiddenDuringWait=this.positioning=this.triggering=G}az=aw.prototype;az.render=function(aI){if(this.rendered||this.destroyed){return this}var aL=this,aN=this.options,X=this.cache,C=this.elements,aK=aN.content.text,aH=aN.content.title,aG=aN.content.button,aJ=aN.position,Y="."+this._id+" ",aM=[];at.attr(this.target[0],"aria-describedby",this._id);this.tooltip=C.tooltip=tooltip=at("<div/>",{id:this._id,"class":[s,O,aN.style.classes,s+"-pos-"+aN.position.my.abbrev()].join(" "),width:aN.style.width||"",height:aN.style.height||"",tracking:aJ.target==="mouse"&&aJ.adjust.mouse,role:"alert","aria-live":"polite","aria-atomic":G,"aria-describedby":this._id+"-content","aria-hidden":Q}).toggleClass(T,this.disabled).attr(ac,this.id).data(s,this).appendTo(aJ.container).append(C.content=at("<div />",{"class":s+"-content",id:this._id+"-content","aria-atomic":Q}));this.rendered=-1;this.positioning=Q;if(aH){this._createTitle();if(!at.isFunction(aH)){aM.push(this._updateTitle(aH,G))}}if(aG){this._createButton()}if(!at.isFunction(aK)){aM.push(this._updateContent(aK,G))}this.rendered=Q;this._setWidget();at.each(aN.events,function(aO,aP){at.isFunction(aP)&&tooltip.bind((aO==="toggle"?["tooltipshow","tooltiphide"]:["tooltip"+aO]).join(Y)+Y,aP)});at.each(aF,function(aP){var aO;if(this.initialize==="render"&&(aO=this(aL))){aL.plugins[aP]=aO}});this._assignEvents();at.when.apply(at,aM).then(function(){aL._trigger("render");aL.positioning=G;if(!aL.hiddenDuringWait&&(aN.show.ready||aI)){aL.toggle(Q,X.event,G)}aL.hiddenDuringWait=G});z.api[this.id]=this;return this};az.destroy=function(C){if(this.destroyed){return this.target}function X(){if(this.destroyed){return}this.destroyed=Q;var Y=this.target,aG=Y.attr(F);if(this.rendered){this.tooltip.stop(1,0).find("*").remove().end().remove()}at.each(this.plugins,function(aH){this.destroy&&this.destroy()});clearTimeout(this.timers.show);clearTimeout(this.timers.hide);this._unassignEvents();Y.removeData(s).removeAttr(ac).removeAttr("aria-describedby");if(this.options.suppress&&aG){Y.attr("title",aG).removeAttr(F)}this._unbind(Y);this.options=this.elements=this.cache=this.timers=this.plugins=this.mouse=ae;delete z.api[this.id]}if(C!==Q&&this.rendered){tooltip.one("tooltiphidden",at.proxy(X,this));!this.triggering&&this.hide()}else{X.call(this)}return this.target};function A(C){return C===ae||at.type(C)!=="object"}function P(C){return !(at.isFunction(C)||(C&&C.attr)||C.length||(at.type(C)==="object"&&(C.jquery||C.then)))}function w(Y){var X,aH,aG,C;if(A(Y)){return G}if(A(Y.metadata)){Y.metadata={type:Y.metadata}}if("content" in Y){X=Y.content;if(A(X)||X.jquery||X.done){X=Y.content={text:(aH=P(X)?G:X)}}else{aH=X.text}if("ajax" in X){aG=X.ajax;C=aG&&aG.once!==G;delete X.ajax;X.text=function(aK,aJ){var aL=aH||at(this).attr(aJ.options.content.attr)||"Loading...",aI=at.ajax(at.extend({},aG,{context:aJ})).then(aG.success,ae,aG.error).then(function(aM){if(aM&&C){aJ.set("content.text",aM)}return aM},function(aO,aM,aN){if(aJ.destroyed||aO.status===0){return}aJ.set("content.text",aM+": "+aN)});return !C?(aJ.set("content.text",aL),aI):aL}}if("title" in X){if(!A(X.title)){X.button=X.title.button;X.title=X.title.text}if(P(X.title||G)){X.title=G}}}if("position" in Y&&A(Y.position)){Y.position={my:Y.position,at:Y.position}}if("show" in Y&&A(Y.show)){Y.show=Y.show.jquery?{target:Y.show}:Y.show===Q?{ready:Q}:{event:Y.show}}if("hide" in Y&&A(Y.hide)){Y.hide=Y.hide.jquery?{target:Y.hide}:{event:Y.hide}}if("style" in Y&&A(Y.style)){Y.style={classes:Y.style}}at.each(aF,function(){this.sanitize&&this.sanitize(Y)});return Y}h=az.checks={builtin:{"^id$":function(aG,aH,X,Y){var aI=X===Q?z.nextid:X,C=s+"-"+aI;if(aI!==G&&aI.length>0&&!at("#"+C).length){this._id=C;if(this.rendered){this.tooltip[0].id=this._id;this.elements.content[0].id=this._id+"-content";this.elements.title[0].id=this._id+"-title"}}else{aG[aH]=Y}},"^prerender":function(X,Y,C){C&&!this.rendered&&this.render(this.options.show.ready)},"^content.text$":function(X,Y,C){this._updateContent(C)},"^content.attr$":function(Y,aG,C,X){if(this.options.content.text===this.target.attr(X)){this._updateContent(this.target.attr(C))}},"^content.title$":function(X,Y,C){if(!C){return this._removeTitle()}C&&!this.elements.title&&this._createTitle();this._updateTitle(C)},"^content.button$":function(X,Y,C){this._updateButton(C)},"^content.title.(text|button)$":function(X,Y,C){this.set("content."+Y,C)},"^position.(my|at)$":function(X,Y,C){"string"===typeof C&&(X[Y]=new ak(C,Y==="at"))},"^position.container$":function(X,Y,C){this.tooltip.appendTo(C)},"^show.ready$":function(X,Y,C){C&&(!this.rendered&&this.render(Q)||this.toggle(Q))},"^style.classes$":function(Y,aG,C,X){this.tooltip.removeClass(X).addClass(C)},"^style.width|height":function(X,Y,C){this.tooltip.css(Y,C)},"^style.widget|content.title":function(){this._setWidget()},"^style.def":function(X,Y,C){this.tooltip.toggleClass(O,!!C)},"^events.(render|show|move|hide|focus|blur)$":function(X,Y,C){tooltip[(at.isFunction(C)?"":"un")+"bind"]("tooltip"+Y,C)},"^(show|hide|position).(event|target|fixed|inactive|leave|distance|viewport|adjust)":function(){var C=this.options.position;tooltip.attr("tracking",C.target==="mouse"&&C.adjust.mouse);this._unassignEvents();this._assignEvents()}}};function am(C,aG){var X=0,aI,Y=C,aH=aG.split(".");while(Y=Y[aH[X++]]){if(X<aH.length){aI=Y}}return[aI||C,aH.pop()]}az.get=function(X){if(this.destroyed){return this}var Y=am(this.options,X.toLowerCase()),C=Y[0][Y[1]];return C.precedance?C.string():C};function ab(aG,X){var Y,aH,C;for(Y in this.checks){for(aH in this.checks[Y]){if(C=(new RegExp(aH,"i")).exec(aG)){X.push(C);if(Y==="builtin"||this.plugins[Y]){this.checks[Y][aH].apply(this.plugins[Y]||this,X)}}}}}var x=/^position\.(my|at|adjust|target|container|viewport)|style|content|show\.ready/i,t=/^prerender|show\.ready/i;az.set=function(aH,aI){if(this.destroyed){return this}var aJ=this.rendered,C=G,aG=this.options,Y=this.checks,X;if("string"===typeof aH){X=aH;aH={};aH[X]=aI}else{aH=at.extend({},aH)}at.each(aH,function(aL,aM){if(!aJ&&!t.test(aL)){delete aH[aL];return}var aN=am(aG,aL.toLowerCase()),aK;aK=aN[0][aN[1]];aN[0][aN[1]]=aM&&aM.nodeType?at(aM):aM;C=x.test(aL)||C;aH[aL]=[aN[0],aN[1],aM,aK]});w(aG);this.positioning=Q;at.each(aH,at.proxy(ab,this));this.positioning=G;if(this.rendered&&this.tooltip[0].offsetWidth>0&&C){this.reposition(aG.position.target==="mouse"?ae:this.cache.event)}return this};az._update=function(aH,aG,C){var Y=this,X=this.cache;if(!this.rendered||!aH){return G}if(at.isFunction(aH)){aH=aH.call(this.elements.target,X.event,this)||""}if(at.isFunction(aH.then)){X.waiting=Q;return aH.then(function(aI){X.waiting=G;return Y._update(aI,aG)},ae,function(aI){return Y._update(aI,aG)})}if(aH===G||(!aH&&aH!=="")){return G}if(aH.jquery&&aH.length>0){aG.children().detach().end().append(aH.css({display:"block"}))}else{aG.html(aH)}X.waiting=Q;return(at.fn.imagesLoaded?aG.imagesLoaded():at.Deferred().resolve(at([]))).done(function(aI){X.waiting=G;if(aI.length&&Y.rendered&&Y.tooltip[0].offsetWidth>0){Y.reposition(X.event,!aI.length)}}).promise()};az._updateContent=function(X,C){this._update(X,this.elements.content,C)};az._updateTitle=function(X,C){if(this._update(X,this.elements.title,C)===G){this._removeTitle(G)}};az._createTitle=function(){var C=this.elements,X=this._id+"-title";if(C.titlebar){this._removeTitle()}C.titlebar=at("<div />",{"class":s+"-titlebar "+(this.options.style.widget?aA("header"):"")}).append(C.title=at("<div />",{id:X,"class":s+"-title","aria-atomic":Q})).insertBefore(C.content).delegate(".qtip-close","mousedown keydown mouseup keyup mouseout",function(Y){at(this).toggleClass("ui-state-active ui-state-focus",Y.type.substr(-4)==="down")}).delegate(".qtip-close","mouseover mouseout",function(Y){at(this).toggleClass("ui-state-hover",Y.type==="mouseover")});if(this.options.content.button){this._createButton()}};az._removeTitle=function(C){var X=this.elements;if(X.title){X.titlebar.remove();X.titlebar=X.title=X.button=ae;if(C!==G){this.reposition()}}};az.reposition=function(aV,aS){if(!this.rendered||this.positioning||this.destroyed){return this}this.positioning=Q;var aR=this.cache,aH=this.tooltip,aY=this.options.position,a0=aY.target,aP=aY.my,aQ=aY.at,aX=aY.viewport,aN=aY.container,aT=aY.adjust,X=aT.method.split(" "),aW=aH.outerWidth(G),aU=aH.outerHeight(G),aJ=0,aK=0,Y=aH.css("position"),aZ={left:0,top:0},C=aH[0].offsetWidth>0,aO=aV&&aV.type==="scroll",aG=at(b),a1=aN[0].ownerDocument,aM=this.mouse,aL,aI;if(at.isArray(a0)&&a0.length===2){aQ={x:e,y:q};aZ={left:a0[0],top:a0[1]}}else{if(a0==="mouse"&&((aV&&aV.pageX)||aR.event.pageX)){aQ={x:e,y:q};aV=aM&&aM.pageX&&(aT.mouse||!aV||!aV.pageX)?aM:(aV&&(aV.type==="resize"||aV.type==="scroll")?aR.event:aV&&aV.pageX&&aV.type==="mousemove"?aV:(!aT.mouse||this.options.show.distance)&&aR.origin&&aR.origin.pageX?aR.origin:aV)||aV||aR.event||aM||{};if(Y!=="static"){aZ=aN.offset()}if(a1.body.offsetWidth!==(b.innerWidth||a1.documentElement.clientWidth)){aI=at(a1.body).offset()}aZ={left:aV.pageX-aZ.left+(aI&&aI.left||0),top:aV.pageY-aZ.top+(aI&&aI.top||0)};if(aT.mouse&&aO){aZ.left-=aM.scrollX-aG.scrollLeft();aZ.top-=aM.scrollY-aG.scrollTop()}}else{if(a0==="event"&&aV&&aV.target&&aV.type!=="scroll"&&aV.type!=="resize"){aR.target=at(aV.target)}else{if(a0!=="event"){aR.target=at(a0.jquery?a0:elements.target)}}a0=aR.target;a0=at(a0).eq(0);if(a0.length===0){return this}else{if(a0[0]===a||a0[0]===b){aJ=BROWSER.iOS?b.innerWidth:a0.width();aK=BROWSER.iOS?b.innerHeight:a0.height();if(a0[0]===b){aZ={top:(aX||a0).scrollTop(),left:(aX||a0).scrollLeft()}}}else{if(aF.imagemap&&a0.is("area")){aL=aF.imagemap(this,a0,aQ,aF.viewport?X:G)}else{if(aF.svg&&a0[0].ownerSVGElement){aL=aF.svg(this,a0,aQ,aF.viewport?X:G)}else{aJ=a0.outerWidth(G);aK=a0.outerHeight(G);aZ=a0.offset()}}}}if(aL){aJ=aL.width;aK=aL.height;aI=aL.offset;aZ=aL.position}aZ=this.reposition.offset(a0,aZ,aN);if((BROWSER.iOS>3.1&&BROWSER.iOS<4.1)||(BROWSER.iOS>=4.3&&BROWSER.iOS<4.33)||(!BROWSER.iOS&&Y==="fixed")){aZ.left-=aG.scrollLeft();aZ.top-=aG.scrollTop()}if(!aL||(aL&&aL.adjustable!==G)){aZ.left+=aQ.x===n?aJ:aQ.x===I?aJ/2:0;aZ.top+=aQ.y===au?aK:aQ.y===I?aK/2:0}}}aZ.left+=aT.x+(aP.x===n?-aW:aP.x===I?-aW/2:0);aZ.top+=aT.y+(aP.y===au?-aU:aP.y===I?-aU/2:0);if(aF.viewport){aZ.adjusted=aF.viewport(this,aZ,aY,aJ,aK,aW,aU);if(aI&&aZ.adjusted.left){aZ.left+=aI.left}if(aI&&aZ.adjusted.top){aZ.top+=aI.top}}else{aZ.adjusted={left:0,top:0}}if(!this._trigger("move",[aZ,aX.elem||aX],aV)){return this}delete aZ.adjusted;if(aS===G||!C||isNaN(aZ.left)||isNaN(aZ.top)||a0==="mouse"||!at.isFunction(aY.effect)){aH.css(aZ)}else{if(at.isFunction(aY.effect)){aY.effect.call(aH,this,at.extend({},aZ));aH.queue(function(a2){at(this).css({opacity:"",height:""});if(BROWSER.ie){this.style.removeAttribute("filter")}a2()})}}this.positioning=G;return this};az.reposition.offset=function(aG,aK,X){if(!X[0]){return aK}var aN=at(aG[0].ownerDocument),aJ=!!BROWSER.ie&&a.compatMode!=="CSS1Compat",aM=X[0],Y,aI,C,aH;function aL(aP,aO){aK.left+=aO*aP.scrollLeft();aK.top+=aO*aP.scrollTop()}do{if((aI=at.css(aM,"position"))!=="static"){if(aI==="fixed"){C=aM.getBoundingClientRect();aL(aN,-1)}else{C=at(aM).position();C.left+=(parseFloat(at.css(aM,"borderLeftWidth"))||0);C.top+=(parseFloat(at.css(aM,"borderTopWidth"))||0)}aK.left-=C.left+(parseFloat(at.css(aM,"marginLeft"))||0);aK.top-=C.top+(parseFloat(at.css(aM,"marginTop"))||0);if(!Y&&(aH=at.css(aM,"overflow"))!=="hidden"&&aH!=="visible"){Y=at(aM)}}}while((aM=aM.offsetParent));if(Y&&(Y[0]!==aN[0]||aJ)){aL(Y,1)}return aK};var ag=(ak=az.reposition.Corner=function(X,C){X=(""+X).replace(/([A-Z])/," $1").replace(/middle/gi,I).toLowerCase();this.x=(X.match(/left|right/i)||X.match(/center/)||["inherit"])[0].toLowerCase();this.y=(X.match(/top|bottom|center/i)||["inherit"])[0].toLowerCase();this.forceY=!!C;var Y=X.charAt(0);this.precedance=(Y==="t"||Y==="b"?W:Z)}).prototype;ag.invert=function(X,C){this[X]=this[X]===e?n:this[X]===n?e:C||this[X]};ag.string=function(){var C=this.x,X=this.y;return C===X?C:this.precedance===W||(this.forceY&&X!=="center")?X+" "+C:C+" "+X};ag.abbrev=function(){var C=this.string().split(" ");return C[0].charAt(0)+(C[1]&&C[1].charAt(0)||"")};ag.clone=function(){return new ak(this.string(),this.forceY)};az.toggle=function(aI,aQ){var aO=this.cache,X=this.options,aH=this.tooltip;if(aQ){if((/over|enter/).test(aQ.type)&&(/out|leave/).test(aO.event.type)&&X.show.target.add(aQ.target).length===X.show.target.length&&aH.has(aQ.relatedTarget).length){return this}aO.event=at.extend({},aQ)}this.waiting&&!aI&&(this.hiddenDuringWait=Q);if(!this.rendered){return aI?this.render(1):this}else{if(this.destroyed||this.disabled){return this}}var aG=aI?"show":"hide",aN=this.options[aG],aM=this.options[!aI?"show":"hide"],aS=this.options.position,aK=this.options.content,aP=this.tooltip.css("width"),C=this.tooltip[0].offsetWidth>0,aJ=aI||aN.target.length===1,aL=!aQ||aN.target.length<2||aO.target[0]===aQ.target,aR,aU,Y,aT;if((typeof aI).search("boolean|number")){aI=!C}aR=!aH.is(":animated")&&C===aI&&aL;aU=!aR?!!this._trigger(aG,[90]):ae;if(aU!==G&&aI){this.focus(aQ)}if(!aU||aR){return this}at.attr(aH[0],"aria-hidden",!!!aI);if(aI){aO.origin=at.extend({},this.mouse);if(at.isFunction(aK.text)){this._updateContent(aK.text,G)}if(at.isFunction(aK.title)){this._updateTitle(aK.title,G)}if(!aC&&aS.target==="mouse"&&aS.adjust.mouse){at(a).bind("mousemove."+s,this._storeMouse);aC=Q}if(!aP){aH.css("width",aH.outerWidth(G))}this.reposition(aQ,arguments[2]);if(!aP){aH.css("width","")}if(!!aN.solo){(typeof aN.solo==="string"?at(aN.solo):at(y,aN.solo)).not(aH).not(aN.target).qtip("hide",at.Event("tooltipsolo"))}}else{clearTimeout(this.timers.show);delete aO.origin;if(aC&&!at(y+'[tracking="true"]:visible',aN.solo).not(aH).length){at(a).unbind("mousemove."+s);aC=G}this.blur(aQ)}after=at.proxy(function(){if(aI){if(BROWSER.ie){aH[0].style.removeAttribute("filter")}aH.css("overflow","");if("string"===typeof aN.autofocus){at(this.options.show.autofocus,aH).focus()}this.options.show.target.trigger("qtip-"+this.id+"-inactive")}else{aH.css({display:"",visibility:"",opacity:"",left:"",top:""})}this._trigger(aI?"visible":"hidden")},this);if(aN.effect===G||aJ===G){aH[aG]();after()}else{if(at.isFunction(aN.effect)){aH.stop(1,1);aN.effect.call(aH,this);aH.queue("fx",function(aV){after();aV()})}else{aH.fadeTo(90,aI?1:0,after)}}if(aI){aN.target.trigger("qtip-"+this.id+"-inactive")}return this};az.show=function(C){return this.toggle(Q,C)};az.hide=function(C){return this.toggle(G,C)};az.focus=function(aG){if(!this.rendered||this.destroyed){return this}var aI=at(y),aH=this.tooltip,Y=parseInt(aH[0].style.zIndex,10),X=z.zindex+aI.length,C;if(!aH.hasClass(M)){if(this._trigger("focus",[X],aG)){if(Y!==X){aI.each(function(){if(this.style.zIndex>Y){this.style.zIndex=this.style.zIndex-1}});aI.filter("."+M).qtip("blur",aG)}aH.addClass(M)[0].style.zIndex=X}}return this};az.blur=function(C){if(!this.rendered||this.destroyed){return this}this.tooltip.removeClass(M);this._trigger("blur",[this.tooltip.css("zIndex")],C);return this};az.disable=function(C){if(this.destroyed){return this}if("boolean"!==typeof C){C=!(this.tooltip.hasClass(T)||this.disabled)}if(this.rendered){this.tooltip.toggleClass(T,C).attr("aria-disabled",C)}this.disabled=!!C;return this};az.enable=function(){return this.disable(G)};az._createButton=function(){var X=this,aH=this.elements,aG=aH.tooltip,Y=this.options.content.button,C=typeof Y==="string",aI=C?Y:"Close tooltip";if(aH.button){aH.button.remove()}if(Y.jquery){aH.button=Y}else{aH.button=at("<a />",{"class":"qtip-close "+(this.options.style.widget?"":s+"-icon"),title:aI,"aria-label":aI}).prepend(at("<span />",{"class":"ui-icon ui-icon-close",html:"&times;"}))}aH.button.appendTo(aH.titlebar||aG).attr("role","button").click(function(aJ){if(!aG.hasClass(T)){X.hide(aJ)}return G})};az._updateButton=function(C){if(!this.rendered){return G}var X=this.elements.button;if(C){this._createButton()}else{X.remove()}};function aA(C){return aj.concat("").join(C?"-"+C+" ":" ")}az._setWidget=function(){var C=this.options.style.widget,aG=this.elements,Y=aG.tooltip,X=Y.hasClass(T);Y.removeClass(T);T=C?"ui-state-disabled":"qtip-disabled";Y.toggleClass(T,X);Y.toggleClass("ui-helper-reset "+aA(),C).toggleClass(O,this.options.style.def&&!C);if(aG.content){aG.content.toggleClass(aA("content"),C)}if(aG.titlebar){aG.titlebar.toggleClass(aA("header"),C)}if(aG.button){aG.button.toggleClass(s+"-icon",!C)}};function K(C){if(this.tooltip.hasClass(T)){return G}clearTimeout(this.timers.show);clearTimeout(this.timers.hide);var X=at.proxy(function(){this.toggle(Q,C)},this);if(this.options.show.delay>0){this.timers.show=setTimeout(X,this.options.show.delay)}else{X()}}function g(aG){if(this.tooltip.hasClass(T)){return G}var X=at(aG.relatedTarget),C=X.closest(y)[0]===this.tooltip[0],Y=X[0]===this.options.show.target[0];clearTimeout(this.timers.show);clearTimeout(this.timers.hide);if(this!==X[0]&&(this.options.position.target==="mouse"&&C)||(this.options.hide.fixed&&((/mouse(out|leave|move)/).test(aG.type)&&(C||Y)))){try{aG.preventDefault();aG.stopImmediatePropagation()}catch(aH){}return}var aI=at.proxy(function(){this.toggle(G,aG)},this);if(this.options.hide.delay>0){this.timers.hide=setTimeout(aI,this.options.hide.delay)}else{aI()}}function l(C){if(this.tooltip.hasClass(T)||!this.options.hide.inactive){return G}clearTimeout(this.timers.inactive);this.timers.inactive=setTimeout(at.proxy(function(){this.hide(C)},this),this.options.hide.inactive)}function ah(C){if(this.rendered&&this.tooltip[0].offsetWidth>0){this.reposition(C)}}az._storeMouse=function(C){this.mouse={pageX:C.pageX,pageY:C.pageY,type:"mousemove",scrollX:b.pageXOffset||a.body.scrollLeft||a.documentElement.scrollLeft,scrollY:b.pageYOffset||a.body.scrollTop||a.documentElement.scrollTop}};az._bind=function(C,Y,aI,aH,X){var aG="."+this._id+(aH?"-"+aH:"");Y.length&&at(C).bind((Y.split?Y:Y.join(aG+" "))+aG,at.proxy(aI,X||this))};az._unbind=function(C,X){at(C).unbind("."+this._id+(X?"-"+X:""))};var aa="."+s;function ap(C,X,Y){at(a.body).delegate(C,(X.split?X:X.join(aa+" "))+aa,function(){var aG=z.api[at.attr(this,ac)];aG&&!aG.disabled&&Y.apply(aG,arguments)})}at(function(){ap(y,["mouseenter","mouseleave"],function(X){var aG=X.type==="mouseenter",Y=at(X.currentTarget),aH=at(X.relatedTarget||X.target),C=this.options;if(aG){this.focus(X);Y.hasClass(B)&&!Y.hasClass(T)&&clearTimeout(this.timers.hide)}else{if(C.position.target==="mouse"&&C.hide.event&&C.show.target&&!aH.closest(C.show.target[0]).length){this.hide(X)}}Y.toggleClass(aE,aG)});ap("["+ac+"]",ad,l)});az._trigger=function(X,C,Y){var aG=at.Event("tooltip"+X);aG.originalEvent=(Y&&at.extend({},Y))||this.cache.event||ae;this.triggering=Q;this.tooltip.trigger(aG,[this].concat(C||[]));this.triggering=G;return !aG.isDefaultPrevented()};az._assignEvents=function(){var aP=this.options,aM=aP.position,aO=this.tooltip,aI=aP.show.target,aL=aP.hide.target,aJ=aM.container,Y=aM.viewport,aH=at(a),aG=at(a.body),aK=at(b),X=aP.show.event?at.trim(""+aP.show.event).split(" "):[],aN=aP.hide.event?at.trim(""+aP.hide.event).split(" "):[],C=[];if(/mouse(out|leave)/i.test(aP.hide.event)&&aP.hide.leave==="window"){this._bind(aH,["mouseout","blur"],function(aQ){if(!/select|option/.test(aQ.target.nodeName)&&!aQ.relatedTarget){this.hide(aQ)}})}if(aP.hide.fixed){aL=aL.add(aO.addClass(B))}else{if(/mouse(over|enter)/i.test(aP.show.event)){this._bind(aL,"mouseleave",function(){clearTimeout(this.timers.show)})}}if((""+aP.hide.event).indexOf("unfocus")>-1){this._bind(aJ.closest("html"),["mousedown","touchstart"],function(aT){var aS=at(aT.target),aR=this.rendered&&!this.tooltip.hasClass(T)&&this.tooltip[0].offsetWidth>0,aQ=aS.parents(y).filter(this.tooltip[0]).length>0;if(aS[0]!==this.target[0]&&aS[0]!==this.tooltip[0]&&!aQ&&!this.target.has(aS[0]).length&&aR){this.hide(aT)}})}if("number"===typeof aP.hide.inactive){this._bind(aI,"qtip-"+this.id+"-inactive",l);this._bind(aL.add(aO),z.inactiveEvents,l,"-inactive")}aN=at.map(aN,function(aR){var aQ=at.inArray(aR,X);if((aQ>-1&&aL.add(aI).length===aL.length)){C.push(X.splice(aQ,1)[0]);return}return aR});this._bind(aI,X,K);this._bind(aL,aN,g);this._bind(aI,C,function(aQ){(this.tooltip[0].offsetWidth>0?g:K).call(this,aQ)});this._bind(aI.add(aO),"mousemove",function(aT){if("number"===typeof aP.hide.distance){var aS=this.cache.origin||{},aR=this.options.hide.distance,aQ=Math.abs;if(aQ(aT.pageX-aS.pageX)>=aR||aQ(aT.pageY-aS.pageY)>=aR){this.hide(aT)}}this._storeMouse(aT)});if(aM.target==="mouse"){if(aM.adjust.mouse){if(aP.hide.event){this._bind(aI,["mouseenter","mouseleave"],function(aQ){this.cache.onTarget=aQ.type==="mouseenter"})}this._bind(aH,"mousemove",function(aQ){if(this.rendered&&this.cache.onTarget&&!this.tooltip.hasClass(T)&&this.tooltip[0].offsetWidth>0){this.reposition(aQ)}})}}if(aM.adjust.resize||Y.length){this._bind(at.event.special.resize?Y:aK,"resize",ah)}if(aM.adjust.scroll){this._bind(aK.add(aM.container),"scroll",ah)}};az._unassignEvents=function(){var C=[this.options.show.target[0],this.options.hide.target[0],this.rendered&&this.tooltip[0],this.options.position.container[0],this.options.position.viewport[0],this.options.position.container.closest("html")[0],b,a];if(this.rendered){this._unbind(at([]).pushStack(at.grep(C,function(X){return typeof X==="object"})))}else{at(C[0]).unbind("."+this._id+"-create")}};function af(aG,X,C){var aH,aQ,aL,Y,aO,aI=at(a.body),aN=aG[0]===a?aI:aG,aM=(aG.metadata)?aG.metadata(C.metadata):ae,aP=C.metadata.type==="html5"&&aM?aM[C.metadata.name]:ae,aJ=aG.data(C.metadata.name||"qtipopts");try{aJ=typeof aJ==="string"?at.parseJSON(aJ):aJ}catch(aK){}Y=at.extend(Q,{},z.defaults,C,typeof aJ==="object"?w(aJ):ae,w(aP||aM));aQ=Y.position;Y.id=X;if("boolean"===typeof Y.content.text){aL=aG.attr(Y.content.attr);if(Y.content.attr!==G&&aL){Y.content.text=aL}else{return G}}if(!aQ.container.length){aQ.container=aI}if(aQ.target===G){aQ.target=aN}if(Y.show.target===G){Y.show.target=aN}if(Y.show.solo===Q){Y.show.solo=aQ.container.closest("body")}if(Y.hide.target===G){Y.hide.target=aN}if(Y.position.viewport===Q){Y.position.viewport=aQ.container}aQ.container=aQ.container.eq(0);aQ.at=new ak(aQ.at,Q);aQ.my=new ak(aQ.my);if(aG.data(s)){if(Y.overwrite){aG.qtip("destroy")}else{if(Y.overwrite===G){return G}}}aG.attr(E,X);if(Y.suppress&&(aO=aG.attr("title"))){aG.removeAttr("title").attr(F,aO).attr("title","")}aH=new aw(aG,Y,X,!!aL);aG.data(s,aH);aG.one("remove.qtip-"+X+" removeqtip.qtip-"+X,function(){var aR;if((aR=at(this).data(s))){aR.destroy()}});return aH}z=at.fn.qtip=function(X,aI,aJ){var aK=(""+X).toLowerCase(),aH=ae,C=at.makeArray(arguments).slice(1),aG=C[C.length-1],Y=this[0]?at.data(this[0],s):ae;if((!arguments.length&&Y)||aK==="api"){return Y}else{if("string"===typeof X){this.each(function(){var aL=at.data(this,s);if(!aL){return Q}if(aG&&aG.timeStamp){aL.cache.event=aG}if(aI&&(aK==="option"||aK==="options")){if(aJ!==c||at.isPlainObject(aI)){aL.set(aI,aJ)}else{aH=aL.get(aI);return G}}else{if(aL[aK]){aL[aK].apply(aL,C)}}});return aH!==ae?aH:this}else{if("object"===typeof X||!arguments.length){Y=w(at.extend(Q,{},X));return z.bind.call(this,Y,aG)}}}};z.bind=function(X,C){return this.each(function(aI){var aG,Y,aH,aK,aJ,aM;aM=at.isArray(X.id)?X.id[aI]:X.id;aM=!aM||aM===G||aM.length<1||z.api[aM]?z.nextid++:aM;aK=".qtip-"+aM+"-create";aJ=af(at(this),aM,X);if(aJ===G){return Q}else{z.api[aM]=aJ}aG=aJ.options;at.each(aF,function(){if(this.initialize==="initialize"){this(aJ)}});Y={show:aG.show.target,hide:aG.hide.target};aH={show:at.trim(""+aG.show.event).replace(/ /g,aK+" ")+aK,hide:at.trim(""+aG.hide.event).replace(/ /g,aK+" ")+aK};if(/mouse(over|enter)/i.test(aH.show)&&!/mouse(out|leave)/i.test(aH.hide)){aH.hide+=" mouseleave"+aK}Y.show.bind("mousemove"+aK,function(aN){aJ._storeMouse(aN);aJ.cache.onTarget=Q});function aL(aO){function aN(){aJ.render(typeof aO==="object"||aG.show.ready);Y.show.add(Y.hide).unbind(aK)}if(aJ.disabled){return G}aJ.cache.event=at.extend({},aO);aJ.cache.target=aO?at(aO.target):[c];if(aG.show.delay>0){clearTimeout(aJ.timers.show);aJ.timers.show=setTimeout(aN,aG.show.delay);if(aH.show!==aH.hide){Y.hide.bind(aH.hide,function(){clearTimeout(aJ.timers.show)})}}else{aN()}}Y.show.bind(aH.show,aL);if(aG.show.ready||aG.prerender){aL(C)}})};z.api={};at.each({attr:function(C,aH){if(this.length){var X=this[0],aG="title",Y=at.data(X,"qtip");if(C===aG&&Y&&"object"===typeof Y&&Y.options.suppress){if(arguments.length<2){return at.attr(X,F)}if(Y&&Y.options.content.attr===aG&&Y.cache.attr){Y.set("content.text",aH)}return this.attr(F,aH)}}return at.fn["attr"+aD].apply(this,arguments)},clone:function(X){var aG=at([]),Y="title",C=at.fn["clone"+aD].apply(this,arguments);if(!X){C.filter("["+F+"]").attr("title",function(){return at.attr(this,F)}).removeAttr(F)}return C}},function(X,Y){if(!Y||at.fn[X+aD]){return Q}var C=at.fn[X+aD]=at.fn[X];at.fn[X]=function(){return Y.apply(this,arguments)||C.apply(this,arguments)}});if(!at.ui){at["cleanData"+aD]=at.cleanData;at.cleanData=function(C){for(var X=0,Y;(Y=at(C[X])).length;X++){if(Y.attr(E)){try{Y.triggerHandler("removeqtip")}catch(aG){}}}at["cleanData"+aD].apply(this,arguments)}}z.version="2.1.1";z.nextid=0;z.inactiveEvents=ad;z.zindex=15000;z.defaults={prerender:G,id:G,overwrite:Q,suppress:Q,content:{text:Q,attr:"title",title:G,button:G},position:{my:"top left",at:"bottom right",target:G,container:G,viewport:G,adjust:{x:0,y:0,mouse:Q,scroll:Q,resize:Q,method:"flipinvert flipinvert"},effect:function(X,Y,C){at(this).animate(Y,{duration:200,queue:G})}},show:{target:G,event:"mouseenter",effect:Q,delay:90,solo:G,ready:G,autofocus:G},hide:{target:G,event:"mouseleave",effect:Q,delay:0,fixed:G,inactive:G,leave:"window",distance:G},style:{classes:"",widget:G,width:G,height:G,def:Q},events:{render:ae,move:ae,show:ae,hide:ae,toggle:ae,visible:ae,hidden:ae,focus:ae,blur:ae}};var m,S=".qtip-tip",N="margin",ax="border",ar="color",an="background-color",ai="transparent",aq=" !important",av=!!a.createElement("canvas").getContext,f=/rgba?\(0, 0, 0(, 0)?\)|transparent|#123456/i;function U(C){return C.charAt(0).toUpperCase()+C.slice(1)}var D={},H=["Webkit","O","Moz","ms"];function o(aG,aJ){var C=aJ.charAt(0).toUpperCase()+aJ.slice(1),Y=(aJ+" "+H.join(C+" ")+C).split(" "),aI,aH,X=0;if(D[aJ]){return aG.css(D[aJ])}while((aI=Y[X++])){if((aH=aG.css(aI))!==c){return D[aJ]=aI,aH}}}function J(C,X){return parseInt(o(C,X),10)}if(!av){createVML=function(C,Y,X){return"<qtipvml:"+C+' xmlns="urn:schemas-microsoft.com:vml" class="qtip-vml" '+(Y||"")+' style="behavior: url(#default#VML); '+(X||"")+'" />'}}function ao(X,C){this._ns="tip";this.options=C;this.offset=C.offset;this.size=[C.width,C.height];this.init((this.qtip=X))}at.extend(ao.prototype,{init:function(Y){var C,X;X=this.element=Y.elements.tip=at("<div />",{"class":s+"-tip"}).prependTo(Y.tooltip);if(av){C=at("<canvas />").appendTo(this.element)[0].getContext("2d");C.lineJoin="miter";C.miterLimit=100;C.save()}else{C=createVML("shape",'coordorigin="0,0"',"position:absolute;");this.element.html(C+C);Y._bind(at("*",X).add(X),["click","mousedown"],function(aG){aG.stopPropagation()},this._ns)}Y._bind(Y.tooltip,"tooltipmove",this.reposition,this._ns,this);this.create()},_swapDimensions:function(){this.size[0]=this.options.height;this.size[1]=this.options.width},_resetDimensions:function(){this.size[0]=this.options.width;this.size[1]=this.options.height},_useTitle:function(C){var X=this.qtip.elements.titlebar;return X&&(C.y===q||(C.y===I&&this.element.position().top+(this.size[1]/2)+this.options.offset<X.outerHeight(Q)))},_parseCorner:function(C){var X=this.qtip.options.position.my;if(C===G||X===G){C=G}else{if(C===Q){C=new ak(X.string())}else{if(!C.string){C=new ak(C);C.fixed=Q}}}return C},_parseWidth:function(Y,X,C){var aG=this.qtip.elements,aH=ax+U(X)+"Width";return(C?J(C,aH):(J(aG.content,aH)||J(this._useTitle(Y)&&aG.titlebar||aG.content,aH)||J(tooltip,aH)))||0},_parseRadius:function(C){var X=this.qtip.elements,Y=ax+U(C.y)+U(C.x)+"Radius";return BROWSER.ie<9?0:J(this._useTitle(C)&&X.titlebar||X.content,Y)||J(X.tooltip,Y)||0},_invalidColour:function(C,aG,X){var Y=C.css(aG);return !Y||(X&&Y===C.css(X))||f.test(Y)?G:Y},_parseColours:function(aH){var aJ=this.qtip.elements,aI=this.element.css("cssText",""),aG=ax+U(aH[aH.precedance])+U(ar),X=this._useTitle(aH)&&aJ.titlebar||aJ.content,Y=this._invalidColour,C=[];C[0]=Y(aI,an)||Y(X,an)||Y(aJ.content,an)||Y(tooltip,an)||aI.css(an);C[1]=Y(aI,aG,ar)||Y(X,aG,ar)||Y(aJ.content,aG,ar)||Y(tooltip,aG,ar)||tooltip.css(aG);at("*",aI).add(aI).css("cssText",an+":"+ai+aq+";"+ax+":0"+aq+";");return C},_calculateSize:function(aM){var aK=aM.precedance===W,X=this.options[aK?"height":"width"],aN=this.options[aK?"width":"height"],aJ=aM.abbrev()==="c",C=X*(aJ?0.5:1),aG=Math.pow,aO=Math.round,aL,aI,aP,Y=Math.sqrt(aG(C,2)+aG(aN,2)),aH=[(this.border/C)*Y,(this.border/aN)*Y];aH[2]=Math.sqrt(aG(aH[0],2)-aG(this.border,2));aH[3]=Math.sqrt(aG(aH[1],2)-aG(this.border,2));aL=Y+aH[2]+aH[3]+(aJ?0:aH[0]);aI=aL/Y;aP=[aO(aI*X),aO(aI*aN)];return aK?aP:aP.reverse()},_calculateTip:function(aI){var aG=this.size[0],X=this.size[1],Y=Math.ceil(aG/2),aH=Math.ceil(X/2),C={br:[0,0,aG,X,aG,0],bl:[0,0,aG,0,0,X],tr:[0,X,aG,0,aG,X],tl:[0,0,0,X,aG,X],tc:[0,X,Y,0,aG,X],bc:[0,0,aG,0,Y,X],rc:[0,0,aG,aH,0,X],lc:[aG,0,aG,X,0,aH]};C.lt=C.br;C.rt=C.bl;C.lb=C.tr;C.rb=C.tl;return C[aI.abbrev()]},create:function(){var C=this.corner=(av||BROWSER.ie)&&this._parseCorner(this.options.corner);if((this.enabled=!!this.corner&&this.corner.abbrev()!=="c")){this.qtip.cache.corner=C.clone();this.update()}this.element.toggle(this.enabled);return this.corner},update:function(aN,aJ){if(!this.enabled){return this}var C=this.qtip.elements,aM=this.element,aR=aM.children(),aQ=this.options,aP=this.size,aS=aQ.mimic,aO=Math.round,aI,X,Y,aL,aG,aK,aH;if(!aN){aN=this.qtip.cache.corner||this.corner}if(aS===G){aS=aN}else{aS=new ak(aS);aS.precedance=aN.precedance;if(aS.x==="inherit"){aS.x=aN.x}else{if(aS.y==="inherit"){aS.y=aN.y}else{if(aS.x===aS.y){aS[aN.precedance]=aN[aN.precedance]}}}}X=aS.precedance;if(aN.precedance===Z){this._swapDimensions()}else{this._resetDimensions()}aI=this.color=this._parseColours(aN);if(aI[1]!==ai){aH=this.border=this._parseWidth(aN,aN[aN.precedance]);if(aQ.border&&aH<1){aI[0]=aI[1]}this.border=aH=aQ.border!==Q?aQ.border:aH}else{this.border=aH=0}aL=this._calculateTip(aS);aK=this.size=this._calculateSize(aN);aM.css({width:aK[0],height:aK[1],lineHeight:aK[1]+"px"});if(aN.precedance===W){aG=[aO(aS.x===e?aH:aS.x===n?aK[0]-aP[0]-aH:(aK[0]-aP[0])/2),aO(aS.y===q?aK[1]-aP[1]:0)]}else{aG=[aO(aS.x===e?aK[0]-aP[0]:0),aO(aS.y===q?aH:aS.y===au?aK[1]-aP[1]-aH:(aK[1]-aP[1])/2)]}if(av){aR.attr(L,aK[0]).attr(ay,aK[1]);Y=aR[0].getContext("2d");Y.restore();Y.save();Y.clearRect(0,0,3000,3000);Y.fillStyle=aI[0];Y.strokeStyle=aI[1];Y.lineWidth=aH*2;Y.translate(aG[0],aG[1]);Y.beginPath();Y.moveTo(aL[0],aL[1]);Y.lineTo(aL[2],aL[3]);Y.lineTo(aL[4],aL[5]);Y.closePath();if(aH){if(tooltip.css("background-clip")==="border-box"){Y.strokeStyle=aI[0];Y.stroke()}Y.strokeStyle=aI[1];Y.stroke()}Y.fill()}else{aL="m"+aL[0]+","+aL[1]+" l"+aL[2]+","+aL[3]+" "+aL[4]+","+aL[5]+" xe";aG[2]=aH&&/^(r|b)/i.test(aN.string())?BROWSER.ie===8?2:1:0;aR.css({coordsize:(aP[0]+aH)+" "+(aP[1]+aH),antialias:""+(aS.string().indexOf(I)>-1),left:aG[0]-(aG[2]*Number(X===Z)),top:aG[1]-(aG[2]*Number(X===W)),width:aP[0]+aH,height:aP[1]+aH}).each(function(aT){var aU=at(this);aU[aU.prop?"prop":"attr"]({coordsize:(aP[0]+aH)+" "+(aP[1]+aH),path:aL,fillcolor:aI[0],filled:!!aT,stroked:!aT}).toggle(!!(aH||aT));!aT&&aU.html(createVML("stroke",'weight="'+(aH*2)+'px" color="'+aI[1]+'" miterlimit="1000" joinstyle="miter"'))})}if(aJ!==G){this.calculate(aN)}},calculate:function(aK){if(!this.enabled){return G}var aL=this,C=this.qtip.elements,aJ=this.element,X=this.options.offset,Y=this.qtip.tooltip.hasClass("ui-widget"),aI={},aG,aM,aH;aK=aK||this.corner;aG=aK.precedance;aM=this._calculateSize(aK);aH=[aK.x,aK.y];if(aG===Z){aH.reverse()}at.each(aH,function(aQ,aP){var aN,aR,aO;if(aP===I){aN=aG===W?e:q;aI[aN]="50%";aI[N+"-"+aN]=-Math.round(aM[aG===W?0:1]/2)+X}else{aN=aL._parseWidth(aK,aP,C.tooltip);aR=aL._parseWidth(aK,aP,C.content);aO=aL._parseRadius(aK);aI[aP]=Math.max(-aL.border,aQ?aR:(X+(aO>aN?aO:-aN)))}});aI[aK[aG]]-=aM[aG===Z?0:1];aJ.css({margin:"",top:"",bottom:"",left:"",right:""}).css(aI);return aI},reposition:function(aG,aL,aO,aM){if(!this.enabled){return}var X=aL.cache,aQ=this.corner.clone(),aP=aO.adjusted,C=aL.options.position.adjust.method.split(" "),Y=C[0],aI=C[1]||C[0],aH={left:G,top:G,x:0,y:0},aJ,aK={},aN;if(this.corner.fixed!==Q){if(Y===r&&aQ.precedance===Z&&aP.left&&aQ.y!==I){aQ.precedance=aQ.precedance===Z?W:Z}else{if(Y!==r&&aP.left){aQ.x=aQ.x===I?(aP.left>0?e:n):(aQ.x===e?n:e)}}if(aI===r&&aQ.precedance===W&&aP.top&&aQ.x!==I){aQ.precedance=aQ.precedance===W?Z:W}else{if(aI!==r&&aP.top){aQ.y=aQ.y===I?(aP.top>0?q:au):(aQ.y===q?au:q)}}if(aQ.string()!==X.corner.string()&&(X.cornerTop!==aP.top||X.cornerLeft!==aP.left)){this.update(aQ,G)}}aJ=this.calculate(aQ,aP);if(aJ.right!==c){aJ.left=-aJ.right}if(aJ.bottom!==c){aJ.top=-aJ.bottom}aJ.user=this.offset;if(aH.left=(Y===r&&!!aP.left)){if(aQ.x===I){aK[N+"-left"]=aH.x=aJ[N+"-left"]-aP.left}else{aN=aJ.right!==c?[aP.left,-aJ.left]:[-aP.left,aJ.left];if((aH.x=Math.max(aN[0],aN[1]))>aN[0]){aO.left-=aP.left;aH.left=G}aK[aJ.right!==c?n:e]=aH.x}}if(aH.top=(aI===r&&!!aP.top)){if(aQ.y===I){aK[N+"-top"]=aH.y=aJ[N+"-top"]-aP.top}else{aN=aJ.bottom!==c?[aP.top,-aJ.top]:[-aP.top,aJ.top];if((aH.y=Math.max(aN[0],aN[1]))>aN[0]){aO.top-=aP.top;aH.top=G}aK[aJ.bottom!==c?au:q]=aH.y}}this.element.css(aK).toggle(!((aH.x&&aH.y)||(aQ.x===I&&aH.y)||(aQ.y===I&&aH.x)));aO.left-=aJ.left.charAt?aJ.user:Y!==r||aH.top||!aH.left&&!aH.top?aJ.left:0;aO.top-=aJ.top.charAt?aJ.user:aI!==r||aH.left||!aH.left&&!aH.top?aJ.top:0;X.cornerLeft=aP.left;X.cornerTop=aP.top;X.corner=aQ.clone()},destroy:function(){this.qtip._unbind(this.qtip.tooltip,this._ns);if(this.qtip.elements.tip){this.qtip.elements.tip.find("*").remove().end().remove()}}});m=aF.tip=function(C){return new ao(C,C.options.style.tip)};m.initialize="render";m.sanitize=function(C){if(C.style&&"tip" in C.style){opts=C.style.tip;if(typeof opts!=="object"){opts=C.style.tip={corner:opts}}if(!(/string|boolean/i).test(typeof opts.corner)){opts.corner=Q}}};h.tip={"^position.my|style.tip.(corner|mimic|border)$":function(){this.create();this.qtip.reposition()},"^style.tip.(height|width)$":function(C){this.size=size=[C.width,C.height];this.update();this.qtip.reposition()},"^content.title|style.(classes|widget)$":function(){this.update()}};at.extend(Q,z.defaults,{style:{tip:{corner:Q,mimic:G,width:6,height:6,border:Q,offset:0}}});aF.polys={polygon:function(X,aN){var aO={width:0,height:0,position:{top:10000000000,right:0,bottom:0,left:10000000000},adjustable:G},aI=0,aJ,aM=[],aL=1,aK=1,aH=0,Y=0,aG,C;aI=X.length;while(aI--){aJ=[parseInt(X[--aI],10),parseInt(X[aI+1],10)];if(aJ[0]>aO.position.right){aO.position.right=aJ[0]}if(aJ[0]<aO.position.left){aO.position.left=aJ[0]}if(aJ[1]>aO.position.bottom){aO.position.bottom=aJ[1]}if(aJ[1]<aO.position.top){aO.position.top=aJ[1]}aM.push(aJ)}aG=aO.width=Math.abs(aO.position.right-aO.position.left);C=aO.height=Math.abs(aO.position.bottom-aO.position.top);if(aN.abbrev()==="c"){aO.position={left:aO.position.left+(aO.width/2),top:aO.position.top+(aO.height/2)}}else{while(aG>0&&C>0&&aL>0&&aK>0){aG=Math.floor(aG/2);C=Math.floor(C/2);if(aN.x===e){aL=aG}else{if(aN.x===n){aL=aO.width-aG}else{aL+=Math.floor(aG/2)}}if(aN.y===q){aK=C}else{if(aN.y===au){aK=aO.height-C}else{aK+=Math.floor(C/2)}}aI=aM.length;while(aI--){if(aM.length<2){break}aH=aM[aI][0]-aO.position.left;Y=aM[aI][1]-aO.position.top;if((aN.x===e&&aH>=aL)||(aN.x===n&&aH<=aL)||(aN.x===I&&(aH<aL||aH>(aO.width-aL)))||(aN.y===q&&Y>=aK)||(aN.y===au&&Y<=aK)||(aN.y===I&&(Y<aK||Y>(aO.height-aK)))){aM.splice(aI,1)}}}aO.position={left:aM[0][0],top:aM[0][1]}}return aO},rect:function(Y,X,aH,aG,C){return{width:Math.abs(aH-Y),height:Math.abs(aG-X),position:{left:Math.min(Y,aH),top:Math.min(X,aG)}}},_angles:{tc:3/2,tr:7/4,tl:5/4,bc:1/2,br:1/4,bl:3/4,rc:2,lc:1,c:0},ellipse:function(X,aK,aI,aH,aG){var aJ=aF.polys._angles[aG.abbrev()],Y=aI*Math.cos(aJ*Math.PI),C=aH*Math.sin(aJ*Math.PI);return{width:(aI*2)-Math.abs(Y),height:(aH*2)-Math.abs(C),position:{left:X+Y,top:aK+C},adjustable:G}},circle:function(C,aG,Y,X){return aF.polys.ellipse(C,aG,Y,Y,X)}};aF.svg=function(aK,aJ,aM,aG){var aL=at(a),Y=aJ[0],aN={},X,aI,aH,C;while(!Y.getBBox){Y=Y.parentNode}if(!Y.getBBox||!Y.parentNode){return G}switch(Y.nodeName){case"rect":aH=aF.svg.toPixel(Y,Y.x.baseVal.value,Y.y.baseVal.value);C=aF.svg.toPixel(Y,Y.x.baseVal.value+Y.width.baseVal.value,Y.y.baseVal.value+Y.height.baseVal.value);aN=aF.polys.rect(aH[0],aH[1],C[0],C[1],aM);break;case"ellipse":case"circle":aH=aF.svg.toPixel(Y,Y.cx.baseVal.value,Y.cy.baseVal.value);aN=aF.polys.ellipse(aH[0],aH[1],(Y.rx||Y.r).baseVal.value,(Y.ry||Y.r).baseVal.value,aM);break;case"line":case"polygon":case"polyline":points=Y.points||[{x:Y.x1.baseVal.value,y:Y.y1.baseVal.value},{x:Y.x2.baseVal.value,y:Y.y2.baseVal.value}];for(aN=[],i=-1,len=points.numberOfItems||points.length;++i<len;){next=points.getItem?points.getItem(i):points[i];aN.push.apply(aN,aF.svg.toPixel(Y,next.x,next.y))}aN=aF.polys.polygon(aN,aM);break;default:aI=Y.getBBox();mtx=Y.getScreenCTM();root=Y.farthestViewportElement||Y;if(!root.createSVGPoint){return G}point=root.createSVGPoint();point.x=aI.x;point.y=aI.y;tPoint=point.matrixTransform(mtx);aN.position={left:tPoint.x,top:tPoint.y};point.x+=aI.width;point.y+=aI.height;tPoint=point.matrixTransform(mtx);aN.width=tPoint.x-aN.position.left;aN.height=tPoint.y-aN.position.top;break}aN.position.left+=aL.scrollLeft();aN.position.top+=aL.scrollTop();return aN};aF.svg.toPixel=function(aI,Y,aJ){var aH=aI.getScreenCTM(),aG=aI.farthestViewportElement||aI,X,C;if(!aG.createSVGPoint){return G}C=aG.createSVGPoint();C.x=Y;C.y=aJ;X=C.matrixTransform(aH);return[X.x,X.y]};var R,p,u="qtip-modal",al="."+u;p=function(){var aL=this,aJ={},X,Y,aI,C;function aH(aO){if(at.expr[":"].focusable){return at.expr[":"].focusable}var aM=!isNaN(at.attr(aO,"tabindex")),aR=aO.nodeName&&aO.nodeName.toLowerCase(),aQ,aP,aN;if("area"===aR){aQ=aO.parentNode;aP=aQ.name;if(!aO.href||!aP||aQ.nodeName.toLowerCase()!=="map"){return false}aN=at("img[usemap=#"+aP+"]")[0];return !!aN&&aN.is(":visible")}return(/input|select|textarea|button|object/.test(aR)?!aO.disabled:"a"===aR?aO.href||aM:aM)}function aG(aM){if(aJ.length<1&&aM.length){aM.not("body").blur()}else{aJ.first().focus()}}function aK(aN){if(!C.is(":visible")){return}var aP=at(aN.target),aO=X.tooltip,aM=aP.closest(y),aQ;aQ=aM.length<1?G:(parseInt(aM[0].style.zIndex,10)>parseInt(aO[0].style.zIndex,10));if(!aQ&&aP.closest(y)[0]!==aO[0]){aG(aP)}Y=aN.target===aJ[aJ.length-1]}at.extend(aL,{init:function(){C=aL.elem=at("<div />",{id:"qtip-overlay",html:"<div></div>",mousedown:function(){return G}}).hide();function aM(){var aN=at(this);C.css({height:aN.height(),width:aN.width()})}at(b).bind("resize"+al,aM);aM();at(a.body).bind("focusin"+al,aK);at(a).bind("keydown"+al,function(aN){if(X&&X.options.show.modal.escape&&aN.keyCode===27){X.hide(aN)}});C.bind("click"+al,function(aN){if(X&&X.options.show.modal.blur){X.hide(aN)}});return aL},update:function(aM){X=aM;if(aM.options.show.modal.stealfocus!==G){aJ=aM.tooltip.find("*").filter(function(){return aH(this)})}else{aJ=[]}},toggle:function(aR,aM,aO){var aQ=at(a.body),aU=aR.tooltip,aW=aR.options.show.modal,aV=aW.effect,aS=aM?"show":"hide",aN=C.is(":visible"),aP=at(al).filter(":visible:not(:animated)").not(aU),aT;aL.update(aR);if(aM&&aW.stealfocus!==G){aG(at(":focus"))}C.toggleClass("blurs",aW.blur);if(aM){C.css({left:0,top:0}).appendTo(a.body)}if((C.is(":animated")&&aN===aM&&aI!==G)||(!aM&&aP.length)){return aL}C.stop(Q,G);if(at.isFunction(aV)){aV.call(C,aM)}else{if(aV===G){C[aS]()}else{C.fadeTo(parseInt(aO,10)||90,aM?1:0,function(){if(!aM){C.hide()}})}}if(!aM){C.queue(function(aX){C.css({left:"",top:""});if(!at(al).length){C.detach()}aX()})}aI=aM;if(X.destroyed){X=ae}return aL}});aL.init()};p=new p();function aB(X,C){this.options=C;this._ns="-modal";this.init((this.qtip=X))}at.extend(aB.prototype,{init:function(X){var C=X.tooltip;if(!this.options.on){return this}X.elements.overlay=p.elem;C.addClass(u).css("z-index",aF.modal.zindex+at(al).length);X._bind(C,["tooltipshow","tooltiphide"],function(aH,aG,aJ){var Y=aH.originalEvent;if(aH.target===C[0]){if(Y&&aH.type==="tooltiphide"&&/mouse(leave|enter)/.test(Y.type)&&at(Y.relatedTarget).closest(overlay[0]).length){try{aH.preventDefault()}catch(aI){}}else{if(!Y||(Y&&!Y.solo)){this.toggle(aH,aH.type==="tooltipshow",aJ)}}}},this._ns,this);X._bind(C,"tooltipfocus",function(aI,aH){if(aI.isDefaultPrevented()||aI.target!==C[0]){return}var aJ=at(al),aG=aF.modal.zindex+aJ.length,Y=parseInt(C[0].style.zIndex,10);p.elem[0].style.zIndex=aG-1;aJ.each(function(){if(this.style.zIndex>Y){this.style.zIndex-=1}});aJ.filter("."+M).qtip("blur",aI.originalEvent);C.addClass(M)[0].style.zIndex=aG;p.update(aH);try{aI.preventDefault()}catch(aK){}},this._ns,this);X._bind(C,"tooltiphide",function(Y){if(Y.target===C[0]){at(al).filter(":visible").not(C).last().qtip("focus",Y)}},this._ns,this)},toggle:function(C,X,Y){if(C&&C.isDefaultPrevented()){return this}p.toggle(this.qtip,!!X,Y)},destroy:function(){this.qtip.tooltip.removeClass(u);this.qtip._unbind(this.qtip.tooltip,this._ns);p.toggle(this.qtip,G);delete this.qtip.elements.overlay}});R=aF.modal=function(C){return new aB(C,C.options.show.modal)};R.sanitize=function(C){if(C.show){if(typeof C.show.modal!=="object"){C.show.modal={on:!!C.show.modal}}else{if(typeof C.show.modal.on==="undefined"){C.show.modal.on=Q}}}};R.zindex=z.zindex-200;R.initialize="render";h.modal={"^show.modal.(on|blur)$":function(){this.destroy();this.init();this.qtip.elems.overlay.toggle(this.qtip.tooltip[0].offsetWidth>0)}};at.extend(Q,z.defaults,{show:{modal:{on:G,effect:Q,blur:Q,stealfocus:Q,escape:Q}}})}))}(window,document));(function(m){var f="0.4.2",n="hasOwnProperty",b=/[\.\/]/,a="*",h=function(){},g=function(q,p){return q-p},e,l,o={n:{}},c=function(p,F){p=String(p);var y=o,v=l,A=Array.prototype.slice.call(arguments,2),C=c.listeners(p),B=0,x=false,s,r=[],w={},t=[],q=e,D=[];e=p;l=0;for(var u=0,E=C.length;u<E;u++){if("zIndex" in C[u]){r.push(C[u].zIndex);if(C[u].zIndex<0){w[C[u].zIndex]=C[u]}}}r.sort(g);while(r[B]<0){s=w[r[B++]];t.push(s.apply(F,A));if(l){l=v;return t}}for(u=0;u<E;u++){s=C[u];if("zIndex" in s){if(s.zIndex==r[B]){t.push(s.apply(F,A));if(l){break}do{B++;s=w[r[B]];s&&t.push(s.apply(F,A));if(l){break}}while(s)}else{w[s.zIndex]=s}}else{t.push(s.apply(F,A));if(l){break}}}l=v;e=q;return t.length?t:null};c._events=o;c.listeners=function(p){var x=p.split(b),v=o,B,w,q,t,A,s,u,y,z=[v],r=[];for(t=0,A=x.length;t<A;t++){y=[];for(s=0,u=z.length;s<u;s++){v=z[s].n;w=[v[x[t]],v[a]];q=2;while(q--){B=w[q];if(B){y.push(B);r=r.concat(B.f||[])}}}z=y}return r};c.on=function(p,s){p=String(p);if(typeof s!="function"){return function(){}}var u=p.split(b),t=o;for(var q=0,r=u.length;q<r;q++){t=t.n;t=t.hasOwnProperty(u[q])&&t[u[q]]||(t[u[q]]={n:{}})}t.f=t.f||[];for(q=0,r=t.f.length;q<r;q++){if(t.f[q]==s){return h}}t.f.push(s);return function(v){if(+v==+v){s.zIndex=+v}}};c.f=function(q){var p=[].slice.call(arguments,1);return function(){c.apply(null,[q,null].concat(p).concat([].slice.call(arguments,0)))}};c.stop=function(){l=1};c.nt=function(p){if(p){return new RegExp("(?:\\.|\\/|^)"+p+"(?:\\.|\\/|$)").test(e)}return e};c.nts=function(){return e.split(b)};c.off=c.unbind=function(q,v){if(!q){c._events=o={n:{}};return}var x=q.split(b),w,z,r,t,A,s,u,y=[o];for(t=0,A=x.length;t<A;t++){for(s=0;s<y.length;s+=r.length-2){r=[s,1];w=y[s].n;if(x[t]!=a){if(w[x[t]]){r.push(w[x[t]])}}else{for(z in w){if(w[n](z)){r.push(w[z])}}}y.splice.apply(y,r)}}for(t=0,A=y.length;t<A;t++){w=y[t];while(w.n){if(v){if(w.f){for(s=0,u=w.f.length;s<u;s++){if(w.f[s]==v){w.f.splice(s,1);break}}!w.f.length&&delete w.f}for(z in w.n){if(w.n[n](z)&&w.n[z].f){var p=w.n[z].f;for(s=0,u=p.length;s<u;s++){if(p[s]==v){p.splice(s,1);break}}!p.length&&delete w.n[z].f}}}else{delete w.f;for(z in w.n){if(w.n[n](z)&&w.n[z].f){delete w.n[z].f}}}w=w.n}}};c.once=function(p,q){var r=function(){c.unbind(p,r);return q.apply(this,arguments)};return c.on(p,r)};c.version=f;c.toString=function(){return"You are running Eve "+f};(typeof module!="undefined"&&module.exports)?(module.exports=c):(typeof define!="undefined"?(define("eve",[],function(){return c})):(m.eve=c))})(this);(function(){function aT(E){if(aT.is(E,"function")){return aq?E():eve.on("raphael.DOMload",E)}else{if(aT.is(E,bf)){return aT._engine.create[bI](aT,E.splice(0,3+aT.is(E[0],aN))).add(E)}else{var b=Array.prototype.slice.call(arguments,0);if(aT.is(b[b.length-1],"function")){var g=b.pop();return aq?g.call(aT._engine.create[bI](aT,b)):eve.on("raphael.DOMload",function(){g.call(aT._engine.create[bI](aT,b))})}else{return aT._engine.create[bI](aT,arguments)}}}}aT.version="2.1.0";aT.eve=eve;var aq,a=/[, ]+/,by={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},bt=/\{(\d+)\}/g,bL="prototype",am="hasOwnProperty",aC={doc:document,win:window},u={was:Object.prototype[am].call(aC.win,"Raphael"),is:aC.win.Raphael},bH=function(){this.ca=this.customAttributes={}},a6,bq="appendChild",bI="apply",bG="concat",ab="createTouch" in aC.doc,aZ="",aS=" ",bJ=String,H="split",U="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[H](aS),bz={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},bM=bJ.prototype.toLowerCase,aw=Math,o=aw.max,bo=aw.min,ay=aw.abs,br=aw.pow,aX=aw.PI,aN="number",al="string",bf="array",a7="toString",bb="fill",a3=Object.prototype.toString,bB={},l="push",f=aT._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,C=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,ax={"NaN":1,"Infinity":1,"-Infinity":1},c=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,aj=aw.round,B="setAttribute",ap=parseFloat,W=parseInt,bv=bJ.prototype.toUpperCase,t=aT._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},au=aT._availableAnimAttrs={blur:aN,"clip-rect":"csv",cx:aN,cy:aN,fill:"colour","fill-opacity":aN,"font-size":aN,height:aN,opacity:aN,path:"path",r:aN,rx:aN,ry:aN,stroke:"colour","stroke-opacity":aN,"stroke-width":aN,transform:"transform",width:aN,x:aN,y:aN},ae=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]/g,bk=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,p={hs:1,rg:1},bi=/,?([achlmqrstvxz]),?/gi,a2=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,ak=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,aR=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/ig,aY=aT._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,aW={},bs=function(E,g){return E.key-g.key},w=function(E,g){return ap(E)-ap(g)},K=function(){},bD=function(b){return b},aB=aT._rectPath=function(b,S,g,E,R){if(R){return[["M",b+R,S],["l",g-R*2,0],["a",R,R,0,0,1,R,R],["l",0,E-R*2],["a",R,R,0,0,1,-R,R],["l",R*2-g,0],["a",R,R,0,0,1,-R,-R],["l",0,R*2-E],["a",R,R,0,0,1,R,-R],["z"]]}return[["M",b,S],["l",g,0],["l",0,E],["l",-g,0],["z"]]},M=function(b,R,E,g){if(g==null){g=E}return[["M",b,R],["m",0,-g],["a",E,g,0,1,1,0,2*g],["a",E,g,0,1,1,0,-2*g],["z"]]},P=aT._getPath={path:function(b){return b.attr("path")},circle:function(g){var b=g.attrs;return M(b.cx,b.cy,b.r)},ellipse:function(g){var b=g.attrs;return M(b.cx,b.cy,b.rx,b.ry)},rect:function(g){var b=g.attrs;return aB(b.x,b.y,b.width,b.height,b.r)},image:function(g){var b=g.attrs;return aB(b.x,b.y,b.width,b.height)},text:function(b){var g=b._getBBox();return aB(g.x,g.y,g.width,g.height)},set:function(b){var g=b._getBBox();return aB(g.x,g.y,g.width,g.height)}},N=aT.mapPath=function(bQ,bN){if(!bN){return bQ}var bO,S,E,b,bP,R,g;bQ=Y(bQ);for(E=0,bP=bQ.length;E<bP;E++){g=bQ[E];for(b=1,R=g.length;b<R;b+=2){bO=bN.x(g[b],g[b+1]);S=bN.y(g[b],g[b+1]);g[b]=bO;g[b+1]=S}}return bQ};aT._g=aC;aT.type=(aC.win.SVGAngle||aC.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML");if(aT.type=="VML"){var aG=aC.doc.createElement("div"),aJ;aG.innerHTML='<v:shape adj="1"/>';aJ=aG.firstChild;aJ.style.behavior="url(#default#VML)";if(!(aJ&&typeof aJ.adj=="object")){return(aT.type=aZ)}aG=null}aT.svg=!(aT.vml=aT.type=="VML");aT._Paper=bH;aT.fn=a6=bH.prototype=aT.prototype;aT._id=0;aT._oid=0;aT.is=function(g,b){b=bM.call(b);if(b=="finite"){return !ax[am](+g)}if(b=="array"){return g instanceof Array}return(b=="null"&&g===null)||(b==typeof g&&g!==null)||(b=="object"&&g===Object(g))||(b=="array"&&Array.isArray&&Array.isArray(g))||a3.call(g).slice(8,-1).toLowerCase()==b};function Z(E){if(Object(E)!==E){return E}var g=new E.constructor;for(var b in E){if(E[am](b)){g[b]=Z(E[b])}}return g}aT.angle=function(S,bO,E,bN,g,R){if(g==null){var b=S-E,bP=bO-bN;if(!b&&!bP){return 0}return(180+aw.atan2(-bP,-b)*180/aX+360)%360}else{return aT.angle(S,bO,g,R)-aT.angle(E,bN,g,R)}};aT.rad=function(b){return b%360*aX/180};aT.deg=function(b){return b*180/aX%360};aT.snapTo=function(g,R,b){b=aT.is(b,"finite")?b:10;if(aT.is(g,bf)){var E=g.length;while(E--){if(ay(g[E]-R)<=b){return g[E]}}}else{g=+g;var S=R%g;if(S<b){return R-S}if(S>g-b){return R-S+g}}return R};var h=aT.createUUID=(function(b,g){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(b,g).toUpperCase()}})(/[xy]/g,function(E){var g=aw.random()*16|0,b=E=="x"?g:(g&3|8);return b.toString(16)});aT.setWindow=function(b){eve("raphael.setWindow",aT,aC.win,b);aC.win=b;aC.doc=aC.win.document;if(aT._engine.initWin){aT._engine.initWin(aC.win)}};var bh=function(E){if(aT.vml){var b=/^\s+|\s+$/g;var S;try{var bN=new ActiveXObject("htmlfile");bN.write("<body>");bN.close();S=bN.body}catch(bO){S=createPopup().document.body}var g=S.createTextRange();bh=aI(function(bP){try{S.style.color=bJ(bP).replace(b,aZ);var bQ=g.queryCommandValue("ForeColor");bQ=((bQ&255)<<16)|(bQ&65280)|((bQ&16711680)>>>16);return"#"+("000000"+bQ.toString(16)).slice(-6)}catch(bR){return"none"}})}else{var R=aC.doc.createElement("i");R.title="Rapha\xebl Colour Picker";R.style.display="none";aC.doc.body.appendChild(R);bh=aI(function(bP){R.style.color=bP;return aC.doc.defaultView.getComputedStyle(R,aZ).getPropertyValue("color")})}return bh(E)},aK=function(){return"hsb("+[this.h,this.s,this.b]+")"},O=function(){return"hsl("+[this.h,this.s,this.l]+")"},z=function(){return this.hex},a0=function(bN,S,E){if(S==null&&aT.is(bN,"object")&&"r" in bN&&"g" in bN&&"b" in bN){E=bN.b;S=bN.g;bN=bN.r}if(S==null&&aT.is(bN,al)){var R=aT.getRGB(bN);bN=R.r;S=R.g;E=R.b}if(bN>1||S>1||E>1){bN/=255;S/=255;E/=255}return[bN,S,E]},a4=function(bN,S,E,bO){bN*=255;S*=255;E*=255;var R={r:bN,g:S,b:E,hex:aT.rgb(bN,S,E),toString:z};aT.is(bO,"finite")&&(R.opacity=bO);return R};aT.color=function(b){var g;if(aT.is(b,"object")&&"h" in b&&"s" in b&&"b" in b){g=aT.hsb2rgb(b);b.r=g.r;b.g=g.g;b.b=g.b;b.hex=g.hex}else{if(aT.is(b,"object")&&"h" in b&&"s" in b&&"l" in b){g=aT.hsl2rgb(b);b.r=g.r;b.g=g.g;b.b=g.b;b.hex=g.hex}else{if(aT.is(b,"string")){b=aT.getRGB(b)}if(aT.is(b,"object")&&"r" in b&&"g" in b&&"b" in b){g=aT.rgb2hsl(b);b.h=g.h;b.s=g.s;b.l=g.l;g=aT.rgb2hsb(b);b.v=g.b}else{b={hex:"none"};b.r=b.g=b.b=b.h=b.s=b.v=b.l=-1}}}b.toString=z;return b};aT.hsb2rgb=function(bO,bR,bP,S){if(this.is(bO,"object")&&"h" in bO&&"s" in bO&&"b" in bO){bP=bO.b;bR=bO.s;bO=bO.h;S=bO.o}bO*=360;var bN,bQ,g,E,b;bO=(bO%360)/60;b=bP*bR;E=b*(1-ay(bO%2-1));bN=bQ=g=bP-b;bO=~~bO;bN+=[b,E,0,0,E,b][bO];bQ+=[E,b,b,E,0,0][bO];g+=[0,0,E,b,b,E][bO];return a4(bN,bQ,g,S)};aT.hsl2rgb=function(bP,bR,bN,S){if(this.is(bP,"object")&&"h" in bP&&"s" in bP&&"l" in bP){bN=bP.l;bR=bP.s;bP=bP.h}if(bP>1||bR>1||bN>1){bP/=360;bR/=100;bN/=100}bP*=360;var bO,bQ,g,E,b;bP=(bP%360)/60;b=2*bR*(bN<0.5?bN:1-bN);E=b*(1-ay(bP%2-1));bO=bQ=g=bN-b/2;bP=~~bP;bO+=[b,E,0,0,E,b][bP];bQ+=[E,b,b,E,0,0][bP];g+=[0,0,E,b,b,E][bP];return a4(bO,bQ,g,S)};aT.rgb2hsb=function(bQ,bP,E){E=a0(bQ,bP,E);bQ=E[0];bP=E[1];E=E[2];var bO,bN,R,bR;R=o(bQ,bP,E);bR=R-bo(bQ,bP,E);bO=(bR==0?null:R==bQ?(bP-E)/bR:R==bP?(E-bQ)/bR+2:(bQ-bP)/bR+4);bO=((bO+360)%6)*60/360;bN=bR==0?0:bR/R;return{h:bO,s:bN,b:R,toString:aK}};aT.rgb2hsl=function(E,bP,bS){bS=a0(E,bP,bS);E=bS[0];bP=bS[1];bS=bS[2];var bT,bO,bR,bQ,bN,R;bQ=o(E,bP,bS);bN=bo(E,bP,bS);R=bQ-bN;bT=(R==0?null:bQ==E?(bP-bS)/R:bQ==bP?(bS-E)/R+2:(E-bP)/R+4);bT=((bT+360)%6)*60/360;bR=(bQ+bN)/2;bO=(R==0?0:bR<0.5?R/(2*bR):R/(2-2*bR));return{h:bT,s:bO,l:bR,toString:O}};aT._path2string=function(){return this.join(",").replace(bi,"$1")};function bm(R,E){for(var b=0,g=R.length;b<g;b++){if(R[b]===E){return R.push(R.splice(b,1)[0])}}}function aI(R,g,b){function E(){var S=Array.prototype.slice.call(arguments,0),bO=S.join("\u2400"),bN=E.cache=E.cache||{},bP=E.count=E.count||[];if(bN[am](bO)){bm(bP,bO);return b?b(bN[bO]):bN[bO]}bP.length>=1000&&delete bN[bP.shift()];bP.push(bO);bN[bO]=R[bI](g,S);return b?b(bN[bO]):bN[bO]}return E}var bx=aT._preload=function(E,g){var b=aC.doc.createElement("img");b.style.cssText="position:absolute;left:-9999em;top:-9999em";b.onload=function(){g.call(this);this.onload=null;aC.doc.body.removeChild(this)};b.onerror=function(){aC.doc.body.removeChild(this)};aC.doc.body.appendChild(b);b.src=E};function at(){return this.hex}aT.getRGB=aI(function(b){if(!b||!!((b=bJ(b)).indexOf("-")+1)){return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:at}}if(b=="none"){return{r:-1,g:-1,b:-1,hex:"none",toString:at}}!(p[am](b.toLowerCase().substring(0,2))||b.charAt()=="#")&&(b=bh(b));var S,g,E,bO,R,bQ,bP,bN=b.match(C);if(bN){if(bN[2]){bO=W(bN[2].substring(5),16);E=W(bN[2].substring(3,5),16);g=W(bN[2].substring(1,3),16)}if(bN[3]){bO=W((bQ=bN[3].charAt(3))+bQ,16);E=W((bQ=bN[3].charAt(2))+bQ,16);g=W((bQ=bN[3].charAt(1))+bQ,16)}if(bN[4]){bP=bN[4][H](bk);g=ap(bP[0]);bP[0].slice(-1)=="%"&&(g*=2.55);E=ap(bP[1]);bP[1].slice(-1)=="%"&&(E*=2.55);bO=ap(bP[2]);bP[2].slice(-1)=="%"&&(bO*=2.55);bN[1].toLowerCase().slice(0,4)=="rgba"&&(R=ap(bP[3]));bP[3]&&bP[3].slice(-1)=="%"&&(R/=100)}if(bN[5]){bP=bN[5][H](bk);g=ap(bP[0]);bP[0].slice(-1)=="%"&&(g*=2.55);E=ap(bP[1]);bP[1].slice(-1)=="%"&&(E*=2.55);bO=ap(bP[2]);bP[2].slice(-1)=="%"&&(bO*=2.55);(bP[0].slice(-3)=="deg"||bP[0].slice(-1)=="\xb0")&&(g/=360);bN[1].toLowerCase().slice(0,4)=="hsba"&&(R=ap(bP[3]));bP[3]&&bP[3].slice(-1)=="%"&&(R/=100);return aT.hsb2rgb(g,E,bO,R)}if(bN[6]){bP=bN[6][H](bk);g=ap(bP[0]);bP[0].slice(-1)=="%"&&(g*=2.55);E=ap(bP[1]);bP[1].slice(-1)=="%"&&(E*=2.55);bO=ap(bP[2]);bP[2].slice(-1)=="%"&&(bO*=2.55);(bP[0].slice(-3)=="deg"||bP[0].slice(-1)=="\xb0")&&(g/=360);bN[1].toLowerCase().slice(0,4)=="hsla"&&(R=ap(bP[3]));bP[3]&&bP[3].slice(-1)=="%"&&(R/=100);return aT.hsl2rgb(g,E,bO,R)}bN={r:g,g:E,b:bO,toString:at};bN.hex="#"+(16777216|bO|(E<<8)|(g<<16)).toString(16).slice(1);aT.is(R,"finite")&&(bN.opacity=R);return bN}return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:at}},aT);aT.hsb=aI(function(R,E,g){return aT.hsb2rgb(R,E,g).hex});aT.hsl=aI(function(E,g,b){return aT.hsl2rgb(E,g,b).hex});aT.rgb=aI(function(S,R,E){return"#"+(16777216|E|(R<<8)|(S<<16)).toString(16).slice(1)});aT.getColor=function(g){var E=this.getColor.start=this.getColor.start||{h:0,s:1,b:g||0.75},b=this.hsb2rgb(E.h,E.s,E.b);E.h+=0.075;if(E.h>1){E.h=0;E.s-=0.2;E.s<=0&&(this.getColor.start={h:0,s:1,b:E.b})}return b.hex};aT.getColor.reset=function(){delete this.start};function bd(E,bN){var S=[];for(var g=0,b=E.length;b-2*!bN>g;g+=2){var R=[{x:+E[g-2],y:+E[g-1]},{x:+E[g],y:+E[g+1]},{x:+E[g+2],y:+E[g+3]},{x:+E[g+4],y:+E[g+5]}];if(bN){if(!g){R[0]={x:+E[b-2],y:+E[b-1]}}else{if(b-4==g){R[3]={x:+E[0],y:+E[1]}}else{if(b-2==g){R[2]={x:+E[0],y:+E[1]};R[3]={x:+E[2],y:+E[3]}}}}}else{if(b-4==g){R[3]=R[2]}else{if(!g){R[0]={x:+E[g],y:+E[g+1]}}}}S.push(["C",(-R[0].x+6*R[1].x+R[2].x)/6,(-R[0].y+6*R[1].y+R[2].y)/6,(R[1].x+6*R[2].x-R[3].x)/6,(R[1].y+6*R[2].y-R[3].y)/6,R[2].x,R[2].y])}return S}aT.parsePathString=function(b){if(!b){return null}var E=aa(b);if(E.arr){return a1(E.arr)}var R={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},g=[];if(aT.is(b,bf)&&aT.is(b[0],bf)){g=a1(b)}if(!g.length){bJ(b).replace(a2,function(bN,S,bQ){var bP=[],bO=S.toLowerCase();bQ.replace(aR,function(bS,bR){bR&&bP.push(+bR)});if(bO=="m"&&bP.length>2){g.push([S][bG](bP.splice(0,2)));bO="l";S=S=="m"?"l":"L"}if(bO=="r"){g.push([S][bG](bP))}else{while(bP.length>=R[bO]){g.push([S][bG](bP.splice(0,R[bO])));if(!R[bO]){break}}}})}g.toString=aT._path2string;E.arr=a1(g);return g};aT.parseTransformString=aI(function(g){if(!g){return null}var E={r:3,s:4,t:2,m:6},b=[];if(aT.is(g,bf)&&aT.is(g[0],bf)){b=a1(g)}if(!b.length){bJ(g).replace(ak,function(S,R,bP){var bO=[],bN=bM.call(R);bP.replace(aR,function(bR,bQ){bQ&&bO.push(+bQ)});b.push([R][bG](bO))})}b.toString=aT._path2string;return b});var aa=function(g){var b=aa.ps=aa.ps||{};if(b[g]){b[g].sleep=100}else{b[g]={sleep:100}}setTimeout(function(){for(var E in b){if(b[am](E)&&E!=g){b[E].sleep--;!b[E].sleep&&delete b[E]}}});return b[g]};aT.findDotsAtSegment=function(g,b,b6,b4,bO,S,bR,bP,bZ){var bW=1-bZ,b1=br(bW,3),b2=br(bW,2),bT=bZ*bZ,bQ=bT*bZ,bV=b1*g+b2*3*bZ*b6+bW*3*bZ*bZ*bO+bQ*bR,bS=b1*b+b2*3*bZ*b4+bW*3*bZ*bZ*S+bQ*bP,b0=g+2*bZ*(b6-g)+bT*(bO-2*b6+g),bY=b+2*bZ*(b4-b)+bT*(S-2*b4+b),b5=b6+2*bZ*(bO-b6)+bT*(bR-2*bO+b6),b3=b4+2*bZ*(S-b4)+bT*(bP-2*S+b4),bX=bW*g+bZ*b6,bU=bW*b+bZ*b4,R=bW*bO+bZ*bR,E=bW*S+bZ*bP,bN=(90-aw.atan2(b0-b5,bY-b3)*180/aX);(b0>b5||bY<b3)&&(bN+=180);return{x:bV,y:bS,m:{x:b0,y:bY},n:{x:b5,y:b3},start:{x:bX,y:bU},end:{x:R,y:E},alpha:bN}};aT.bezierBBox=function(g,b,R,E,bQ,bO,bN,S){if(!aT.is(g,"array")){g=[g,b,R,E,bQ,bO,bN,S]}var bP=bc.apply(null,g);return{x:bP.min.x,y:bP.min.y,x2:bP.max.x,y2:bP.max.y,width:bP.max.x-bP.min.x,height:bP.max.y-bP.min.y}};aT.isPointInsideBBox=function(g,b,E){return b>=g.x&&b<=g.x2&&E>=g.y&&E<=g.y2};aT.isBBoxIntersect=function(E,g){var b=aT.isPointInsideBBox;return b(g,E.x,E.y)||b(g,E.x2,E.y)||b(g,E.x,E.y2)||b(g,E.x2,E.y2)||b(E,g.x,g.y)||b(E,g.x2,g.y)||b(E,g.x,g.y2)||b(E,g.x2,g.y2)||(E.x<g.x2&&E.x>g.x||g.x<E.x2&&g.x>E.x)&&(E.y<g.y2&&E.y>g.y||g.y<E.y2&&g.y>E.y)};function bl(b,bO,bN,S,R){var E=-3*bO+9*bN-9*S+3*R,g=b*E+6*bO-12*bN+6*S;return b*g-3*bO+3*bN}function s(bZ,S,bY,E,bX,g,bU,b,bR){if(bR==null){bR=1}bR=bR>1?1:bR<0?0:bR;var bS=bR/2,bT=12,bO=[-0.1252,0.1252,-0.3678,0.3678,-0.5873,0.5873,-0.7699,0.7699,-0.9041,0.9041,-0.9816,0.9816],bW=[0.2491,0.2491,0.2335,0.2335,0.2032,0.2032,0.1601,0.1601,0.1069,0.1069,0.0472,0.0472],R=0;for(var bV=0;bV<bT;bV++){var bP=bS*bO[bV]+bS,bQ=bl(bP,bZ,bY,bX,bU),b0=bl(bP,S,E,g,b),bN=bQ*bQ+b0*b0;R+=bW[bV]*aw.sqrt(bN)}return bS*R}function F(E,bT,g,bS,b,bQ,bV,bP,bR){if(bR<0||s(E,bT,g,bS,b,bQ,bV,bP)<bR){return}var bU=1,R=bU/2,bN=bU-R,S,bO=0.01;S=s(E,bT,g,bS,b,bQ,bV,bP,bN);while(ay(S-bR)>bO){R/=2;bN+=(S<bR?1:-1)*R;S=s(E,bT,g,bS,b,bQ,bV,bP,bN)}return bN}function Q(R,bU,E,bS,b,bR,bW,bQ){if(o(R,E)<bo(b,bW)||bo(R,E)>o(b,bW)||o(bU,bS)<bo(bR,bQ)||bo(bU,bS)>o(bR,bQ)){return}var bP=(R*bS-bU*E)*(b-bW)-(R-E)*(b*bQ-bR*bW),bO=(R*bS-bU*E)*(bR-bQ)-(bU-bS)*(b*bQ-bR*bW),S=(R-E)*(bR-bQ)-(bU-bS)*(b-bW);if(!S){return}var bV=bP/S,bT=bO/S,bN=+bV.toFixed(2),g=+bT.toFixed(2);if(bN<+bo(R,E).toFixed(2)||bN>+o(R,E).toFixed(2)||bN<+bo(b,bW).toFixed(2)||bN>+o(b,bW).toFixed(2)||g<+bo(bU,bS).toFixed(2)||g>+o(bU,bS).toFixed(2)||g<+bo(bR,bQ).toFixed(2)||g>+o(bR,bQ).toFixed(2)){return}return{x:bV,y:bT}}function aA(g,b){return ah(g,b)}function v(g,b){return ah(g,b,1)}function ah(b5,b4,b3){var R=aT.bezierBBox(b5),g=aT.bezierBBox(b4);if(!aT.isBBoxIntersect(R,g)){return b3?0:[]}var bY=s.apply(0,b5),bX=s.apply(0,b4),bP=~~(bY/5),bO=~~(bX/5),bV=[],bU=[],E={},b6=b3?0:[];for(var b0=0;b0<bP+1;b0++){var bW=aT.findDotsAtSegment.apply(aT,b5.concat(b0/bP));bV.push({x:bW.x,y:bW.y,t:b0/bP})}for(b0=0;b0<bO+1;b0++){bW=aT.findDotsAtSegment.apply(aT,b4.concat(b0/bO));bU.push({x:bW.x,y:bW.y,t:b0/bO})}for(b0=0;b0<bP;b0++){for(var bZ=0;bZ<bO;bZ++){var b2=bV[b0],b=bV[b0+1],b1=bU[bZ],bN=bU[bZ+1],bT=ay(b.x-b2.x)<0.001?"y":"x",bS=ay(bN.x-b1.x)<0.001?"y":"x",S=Q(b2.x,b2.y,b.x,b.y,b1.x,b1.y,bN.x,bN.y);if(S){if(E[S.x.toFixed(4)]==S.y.toFixed(4)){continue}E[S.x.toFixed(4)]=S.y.toFixed(4);var bR=b2.t+ay((S[bT]-b2[bT])/(b[bT]-b2[bT]))*(b.t-b2.t),bQ=b1.t+ay((S[bS]-b1[bS])/(bN[bS]-b1[bS]))*(bN.t-b1.t);if(bR>=0&&bR<=1&&bQ>=0&&bQ<=1){if(b3){b6++}else{b6.push({x:S.x,y:S.y,t1:bR,t2:bQ})}}}}}return b6}aT.pathIntersection=function(g,b){return G(g,b)};aT.pathIntersectionNumber=function(g,b){return G(g,b,1)};function G(E,b,bZ){E=aT._path2curve(E);b=aT._path2curve(b);var bX,bN,bW,R,bU,bO,g,bR,b3,b2,b4=bZ?0:[];for(var bV=0,bP=E.length;bV<bP;bV++){var b1=E[bV];if(b1[0]=="M"){bX=bU=b1[1];bN=bO=b1[2]}else{if(b1[0]=="C"){b3=[bX,bN].concat(b1.slice(1));bX=b3[6];bN=b3[7]}else{b3=[bX,bN,bX,bN,bU,bO,bU,bO];bX=bU;bN=bO}for(var bT=0,bY=b.length;bT<bY;bT++){var b0=b[bT];if(b0[0]=="M"){bW=g=b0[1];R=bR=b0[2]}else{if(b0[0]=="C"){b2=[bW,R].concat(b0.slice(1));bW=b2[6];R=b2[7]}else{b2=[bW,R,bW,R,g,bR,g,bR];bW=g;R=bR}var bQ=ah(b3,b2,bZ);if(bZ){b4+=bQ}else{for(var bS=0,S=bQ.length;bS<S;bS++){bQ[bS].segment1=bV;bQ[bS].segment2=bT;bQ[bS].bez1=b3;bQ[bS].bez2=b2}b4=b4.concat(bQ)}}}}}return b4}aT.isPointInsidePath=function(g,b,R){var E=aT.pathBBox(g);return aT.isPointInsideBBox(E,b,R)&&G(g,[["M",b,R],["H",E.x2+10]],1)%2==1};aT._removedFactory=function(b){return function(){eve("raphael.log",null,"Rapha\xebl: you are calling to method \u201c"+b+"\u201d of removed object",b)}};var ao=aT.pathBBox=function(bW){var bQ=aa(bW);if(bQ.bbox){return Z(bQ.bbox)}if(!bW){return{x:0,y:0,width:0,height:0,x2:0,y2:0}}bW=Y(bW);var bT=0,bS=0,S=[],g=[],E;for(var bO=0,bV=bW.length;bO<bV;bO++){E=bW[bO];if(E[0]=="M"){bT=E[1];bS=E[2];S.push(bT);g.push(bS)}else{var bP=bc(bT,bS,E[1],E[2],E[3],E[4],E[5],E[6]);S=S[bG](bP.min.x,bP.max.x);g=g[bG](bP.min.y,bP.max.y);bT=E[5];bS=E[6]}}var b=bo[bI](0,S),bU=bo[bI](0,g),bN=o[bI](0,S),R=o[bI](0,g),bR={x:b,y:bU,x2:bN,y2:R,width:bN-b,height:R-bU};bQ.bbox=Z(bR);return bR},a1=function(g){var b=Z(g);b.toString=aT._path2string;return b},aE=aT._pathToRelative=function(R){var bP=aa(R);if(bP.rel){return a1(bP.rel)}if(!aT.is(R,bf)||!aT.is(R&&R[0],bf)){R=aT.parsePathString(R)}var bS=[],bU=0,bT=0,bX=0,bW=0,E=0;if(R[0][0]=="M"){bU=R[0][1];bT=R[0][2];bX=bU;bW=bT;E++;bS.push(["M",bU,bT])}for(var bO=E,bY=R.length;bO<bY;bO++){var b=bS[bO]=[],bV=R[bO];if(bV[0]!=bM.call(bV[0])){b[0]=bM.call(bV[0]);switch(b[0]){case"a":b[1]=bV[1];b[2]=bV[2];b[3]=bV[3];b[4]=bV[4];b[5]=bV[5];b[6]=+(bV[6]-bU).toFixed(3);b[7]=+(bV[7]-bT).toFixed(3);break;case"v":b[1]=+(bV[1]-bT).toFixed(3);break;case"m":bX=bV[1];bW=bV[2];default:for(var bN=1,bQ=bV.length;bN<bQ;bN++){b[bN]=+(bV[bN]-((bN%2)?bU:bT)).toFixed(3)}}}else{b=bS[bO]=[];if(bV[0]=="m"){bX=bV[1]+bU;bW=bV[2]+bT}for(var S=0,g=bV.length;S<g;S++){bS[bO][S]=bV[S]}}var bR=bS[bO].length;switch(bS[bO][0]){case"z":bU=bX;bT=bW;break;case"h":bU+=+bS[bO][bR-1];break;case"v":bT+=+bS[bO][bR-1];break;default:bU+=+bS[bO][bR-2];bT+=+bS[bO][bR-1]}}bS.toString=aT._path2string;bP.rel=a1(bS);return bS},y=aT._pathToAbsolute=function(bT){var E=aa(bT);if(E.abs){return a1(E.abs)}if(!aT.is(bT,bf)||!aT.is(bT&&bT[0],bf)){bT=aT.parsePathString(bT)}if(!bT||!bT.length){return[["M",0,0]]}var bZ=[],bO=0,bN=0,bR=0,bQ=0,R=0;if(bT[0][0]=="M"){bO=+bT[0][1];bN=+bT[0][2];bR=bO;bQ=bN;R++;bZ[0]=["M",bO,bN]}var bY=bT.length==3&&bT[0][0]=="M"&&bT[1][0].toUpperCase()=="R"&&bT[2][0].toUpperCase()=="Z";for(var bS,b,bW=R,bP=bT.length;bW<bP;bW++){bZ.push(bS=[]);b=bT[bW];if(b[0]!=bv.call(b[0])){bS[0]=bv.call(b[0]);switch(bS[0]){case"A":bS[1]=b[1];bS[2]=b[2];bS[3]=b[3];bS[4]=b[4];bS[5]=b[5];bS[6]=+(b[6]+bO);bS[7]=+(b[7]+bN);break;case"V":bS[1]=+b[1]+bN;break;case"H":bS[1]=+b[1]+bO;break;case"R":var S=[bO,bN][bG](b.slice(1));for(var bV=2,bX=S.length;bV<bX;bV++){S[bV]=+S[bV]+bO;S[++bV]=+S[bV]+bN}bZ.pop();bZ=bZ[bG](bd(S,bY));break;case"M":bR=+b[1]+bO;bQ=+b[2]+bN;default:for(bV=1,bX=b.length;bV<bX;bV++){bS[bV]=+b[bV]+((bV%2)?bO:bN)}}}else{if(b[0]=="R"){S=[bO,bN][bG](b.slice(1));bZ.pop();bZ=bZ[bG](bd(S,bY));bS=["R"][bG](b.slice(-2))}else{for(var bU=0,g=b.length;bU<g;bU++){bS[bU]=b[bU]}}}switch(bS[0]){case"Z":bO=bR;bN=bQ;break;case"H":bO=bS[1];break;case"V":bN=bS[1];break;case"M":bR=bS[bS.length-2];bQ=bS[bS.length-1];default:bO=bS[bS.length-2];bN=bS[bS.length-1]}}bZ.toString=aT._path2string;E.abs=a1(bZ);return bZ},bK=function(g,R,b,E){return[g,R,b,E,b,E]},bp=function(g,R,bO,S,b,E){var bN=1/3,bP=2/3;return[bN*g+bP*bO,bN*R+bP*S,bN*b+bP*bO,bN*E+bP*S,b,E]},ag=function(bV,cq,b4,b2,bW,bQ,R,bU,cp,bX){var b1=aX*120/180,b=aX/180*(+bW||0),b8=[],b5,cm=aI(function(cs,cv,cr){var cu=cs*aw.cos(cr)-cv*aw.sin(cr),ct=cs*aw.sin(cr)+cv*aw.cos(cr);return{x:cu,y:ct}});if(!bX){b5=cm(bV,cq,-b);bV=b5.x;cq=b5.y;b5=cm(bU,cp,-b);bU=b5.x;cp=b5.y;var g=aw.cos(aX/180*bW),bS=aw.sin(aX/180*bW),ca=(bV-bU)/2,b9=(cq-cp)/2;var ck=(ca*ca)/(b4*b4)+(b9*b9)/(b2*b2);if(ck>1){ck=aw.sqrt(ck);b4=ck*b4;b2=ck*b2}var E=b4*b4,cd=b2*b2,cf=(bQ==R?-1:1)*aw.sqrt(ay((E*cd-E*b9*b9-cd*ca*ca)/(E*b9*b9+cd*ca*ca))),bZ=cf*b4*b9/b2+(bV+bU)/2,bY=cf*-b2*ca/b4+(cq+cp)/2,bP=aw.asin(((cq-bY)/b2).toFixed(9)),bO=aw.asin(((cp-bY)/b2).toFixed(9));bP=bV<bZ?aX-bP:bP;bO=bU<bZ?aX-bO:bO;bP<0&&(bP=aX*2+bP);bO<0&&(bO=aX*2+bO);if(R&&bP>bO){bP=bP-aX*2}if(!R&&bO>bP){bO=bO-aX*2}}else{bP=bX[0];bO=bX[1];bZ=bX[2];bY=bX[3]}var bT=bO-bP;if(ay(bT)>b1){var b0=bO,b3=bU,bR=cp;bO=bP+b1*(R&&bO>bP?1:-1);bU=bZ+b4*aw.cos(bO);cp=bY+b2*aw.sin(bO);b8=ag(bU,cp,b4,b2,bW,0,R,b3,bR,[bO,b0,bZ,bY])}bT=bO-bP;var bN=aw.cos(bP),co=aw.sin(bP),S=aw.cos(bO),cn=aw.sin(bO),cb=aw.tan(bT/4),ce=4/3*b4*cb,cc=4/3*b2*cb,cl=[bV,cq],cj=[bV+ce*co,cq-cc*bN],ci=[bU+ce*cn,cp-cc*S],cg=[bU,cp];cj[0]=2*cl[0]-cj[0];cj[1]=2*cl[1]-cj[1];if(bX){return[cj,ci,cg][bG](b8)}else{b8=[cj,ci,cg][bG](b8).join()[H](",");var b6=[];for(var ch=0,b7=b8.length;ch<b7;ch++){b6[ch]=ch%2?cm(b8[ch-1],b8[ch],b).y:cm(b8[ch],b8[ch+1],b).x}return b6}},ai=function(g,b,R,E,bQ,bP,bO,bN,bR){var S=1-bR;return{x:br(S,3)*g+br(S,2)*3*bR*R+S*3*bR*bR*bQ+br(bR,3)*bO,y:br(S,3)*b+br(S,2)*3*bR*E+S*3*bR*bR*bP+br(bR,3)*bN}},bc=aI(function(R,g,bN,S,bY,bX,bU,bR){var bW=(bY-2*bN+R)-(bU-2*bY+bN),bT=2*(bN-R)-2*(bY-bN),bQ=R-bN,bP=(-bT+aw.sqrt(bT*bT-4*bW*bQ))/2/bW,bO=(-bT-aw.sqrt(bT*bT-4*bW*bQ))/2/bW,bS=[g,bR],bV=[R,bU],E;ay(bP)>"1e12"&&(bP=0.5);ay(bO)>"1e12"&&(bO=0.5);if(bP>0&&bP<1){E=ai(R,g,bN,S,bY,bX,bU,bR,bP);bV.push(E.x);bS.push(E.y)}if(bO>0&&bO<1){E=ai(R,g,bN,S,bY,bX,bU,bR,bO);bV.push(E.x);bS.push(E.y)}bW=(bX-2*S+g)-(bR-2*bX+S);bT=2*(S-g)-2*(bX-S);bQ=g-S;bP=(-bT+aw.sqrt(bT*bT-4*bW*bQ))/2/bW;bO=(-bT-aw.sqrt(bT*bT-4*bW*bQ))/2/bW;ay(bP)>"1e12"&&(bP=0.5);ay(bO)>"1e12"&&(bO=0.5);if(bP>0&&bP<1){E=ai(R,g,bN,S,bY,bX,bU,bR,bP);bV.push(E.x);bS.push(E.y)}if(bO>0&&bO<1){E=ai(R,g,bN,S,bY,bX,bU,bR,bO);bV.push(E.x);bS.push(E.y)}return{min:{x:bo[bI](0,bV),y:bo[bI](0,bS)},max:{x:o[bI](0,bV),y:o[bI](0,bS)}}}),Y=aT._path2curve=aI(function(bX,bS){var bQ=!bS&&aa(bX);if(!bS&&bQ.curve){return a1(bQ.curve)}var R=y(bX),bT=bS&&y(bS),bU={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},g={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},bN=function(bZ,b0){var bY,b1;if(!bZ){return["C",b0.x,b0.y,b0.x,b0.y,b0.x,b0.y]}!(bZ[0] in {T:1,Q:1})&&(b0.qx=b0.qy=null);switch(bZ[0]){case"M":b0.X=bZ[1];b0.Y=bZ[2];break;case"A":bZ=["C"][bG](ag[bI](0,[b0.x,b0.y][bG](bZ.slice(1))));break;case"S":bY=b0.x+(b0.x-(b0.bx||b0.x));b1=b0.y+(b0.y-(b0.by||b0.y));bZ=["C",bY,b1][bG](bZ.slice(1));break;case"T":b0.qx=b0.x+(b0.x-(b0.qx||b0.x));b0.qy=b0.y+(b0.y-(b0.qy||b0.y));bZ=["C"][bG](bp(b0.x,b0.y,b0.qx,b0.qy,bZ[1],bZ[2]));break;case"Q":b0.qx=bZ[1];b0.qy=bZ[2];bZ=["C"][bG](bp(b0.x,b0.y,bZ[1],bZ[2],bZ[3],bZ[4]));break;case"L":bZ=["C"][bG](bK(b0.x,b0.y,bZ[1],bZ[2]));break;case"H":bZ=["C"][bG](bK(b0.x,b0.y,bZ[1],b0.y));break;case"V":bZ=["C"][bG](bK(b0.x,b0.y,b0.x,bZ[1]));break;case"Z":bZ=["C"][bG](bK(b0.x,b0.y,b0.X,b0.Y));break}return bZ},b=function(bY,bZ){if(bY[bZ].length>7){bY[bZ].shift();var b0=bY[bZ];while(b0.length){bY.splice(bZ++,0,["C"][bG](b0.splice(0,6)))}bY.splice(bZ,1);bV=o(R.length,bT&&bT.length||0)}},E=function(b2,b1,bZ,bY,b0){if(b2&&b1&&b2[b0][0]=="M"&&b1[b0][0]!="M"){b1.splice(b0,0,["M",bY.x,bY.y]);bZ.bx=0;bZ.by=0;bZ.x=b2[b0][1];bZ.y=b2[b0][2];bV=o(R.length,bT&&bT.length||0)}};for(var bP=0,bV=o(R.length,bT&&bT.length||0);bP<bV;bP++){R[bP]=bN(R[bP],bU);b(R,bP);bT&&(bT[bP]=bN(bT[bP],g));bT&&b(bT,bP);E(R,bT,bU,g,bP);E(bT,R,g,bU,bP);var bO=R[bP],bW=bT&&bT[bP],S=bO.length,bR=bT&&bW.length;bU.x=bO[S-2];bU.y=bO[S-1];bU.bx=ap(bO[S-4])||bU.x;bU.by=ap(bO[S-3])||bU.y;g.bx=bT&&(ap(bW[bR-4])||g.x);g.by=bT&&(ap(bW[bR-3])||g.y);g.x=bT&&bW[bR-2];g.y=bT&&bW[bR-1]}if(!bT){bQ.curve=a1(R)}return bT?[R,bT]:R},null,a1),x=aT._parseDots=aI(function(bQ){var bP=[];for(var S=0,bR=bQ.length;S<bR;S++){var b={},bO=bQ[S].match(/^([^:]*):?([\d\.]*)/);b.color=aT.getRGB(bO[1]);if(b.color.error){return null}b.color=b.color.hex;bO[2]&&(b.offset=bO[2]+"%");bP.push(b)}for(S=1,bR=bP.length-1;S<bR;S++){if(!bP[S].offset){var g=ap(bP[S-1].offset||0),E=0;for(var R=S+1;R<bR;R++){if(bP[R].offset){E=bP[R].offset;break}}if(!E){E=100;R=bR}E=ap(E);var bN=(E-g)/(R-S+1);for(;S<R;S++){g+=bN;bP[S].offset=g+"%"}}}return bP}),aM=aT._tear=function(b,g){b==g.top&&(g.top=b.prev);b==g.bottom&&(g.bottom=b.next);b.next&&(b.next.prev=b.prev);b.prev&&(b.prev.next=b.next)},ar=aT._tofront=function(b,g){if(g.top===b){return}aM(b,g);b.next=null;b.prev=g.top;g.top.next=b;g.top=b},r=aT._toback=function(b,g){if(g.bottom===b){return}aM(b,g);b.next=g.bottom;b.prev=null;g.bottom.prev=b;g.bottom=b},I=aT._insertafter=function(g,b,E){aM(g,E);b==E.top&&(E.top=g);b.next&&(b.next.prev=g);g.next=b.next;g.prev=b;b.next=g},aV=aT._insertbefore=function(g,b,E){aM(g,E);b==E.bottom&&(E.bottom=g);b.prev&&(b.prev.next=g);g.prev=b.prev;b.prev=g;g.next=b},bn=aT.toMatrix=function(E,b){var R=ao(E),g={_:{transform:aZ},getBBox:function(){return R}};aQ(g,b);return g.matrix},V=aT.transformPath=function(g,b){return N(g,bn(g,b))},aQ=aT._extractTransform=function(g,b2){if(b2==null){return g._.transform}b2=bJ(b2).replace(/\.{3}|\u2026/g,g._.transform||aZ);var bU=aT.parseTransformString(b2),bS=0,bQ=0,bP=0,bW=1,bV=1,b3=g._,bX=new aH;b3.transform=bU||[];if(bU){for(var bY=0,bR=bU.length;bY<bR;bY++){var bT=bU[bY],b=bT.length,S=bJ(bT[0]).toLowerCase(),b1=bT[0]!=S,bO=b1?bX.invert():0,b0,R,bZ,E,bN;if(S=="t"&&b==3){if(b1){b0=bO.x(0,0);R=bO.y(0,0);bZ=bO.x(bT[1],bT[2]);E=bO.y(bT[1],bT[2]);bX.translate(bZ-b0,E-R)}else{bX.translate(bT[1],bT[2])}}else{if(S=="r"){if(b==2){bN=bN||g.getBBox(1);bX.rotate(bT[1],bN.x+bN.width/2,bN.y+bN.height/2);bS+=bT[1]}else{if(b==4){if(b1){bZ=bO.x(bT[2],bT[3]);E=bO.y(bT[2],bT[3]);bX.rotate(bT[1],bZ,E)}else{bX.rotate(bT[1],bT[2],bT[3])}bS+=bT[1]}}}else{if(S=="s"){if(b==2||b==3){bN=bN||g.getBBox(1);bX.scale(bT[1],bT[b-1],bN.x+bN.width/2,bN.y+bN.height/2);bW*=bT[1];bV*=bT[b-1]}else{if(b==5){if(b1){bZ=bO.x(bT[3],bT[4]);E=bO.y(bT[3],bT[4]);bX.scale(bT[1],bT[2],bZ,E)}else{bX.scale(bT[1],bT[2],bT[3],bT[4])}bW*=bT[1];bV*=bT[2]}}}else{if(S=="m"&&b==7){bX.add(bT[1],bT[2],bT[3],bT[4],bT[5],bT[6])}}}}b3.dirtyT=1;g.matrix=bX}}g.matrix=bX;b3.sx=bW;b3.sy=bV;b3.deg=bS;b3.dx=bQ=bX.e;b3.dy=bP=bX.f;if(bW==1&&bV==1&&!bS&&b3.bbox){b3.bbox.x+=+bQ;b3.bbox.y+=+bP}else{b3.dirtyT=1}},n=function(g){var b=g[0];switch(b.toLowerCase()){case"t":return[b,0,0];case"m":return[b,1,0,0,1,0,0];case"r":if(g.length==4){return[b,0,g[2],g[3]]}else{return[b,0]}case"s":if(g.length==5){return[b,1,1,g[3],g[4]]}else{if(g.length==3){return[b,1,1]}else{return[b,1]}}}},aD=aT._equaliseTransform=function(S,R){R=bJ(R).replace(/\.{3}|\u2026/g,S);S=aT.parseTransformString(S)||[];R=aT.parseTransformString(R)||[];var b=o(S.length,R.length),bQ=[],bR=[],E=0,g,bN,bP,bO;for(;E<b;E++){bP=S[E]||n(R[E]);bO=R[E]||n(bP);if((bP[0]!=bO[0])||(bP[0].toLowerCase()=="r"&&(bP[2]!=bO[2]||bP[3]!=bO[3]))||(bP[0].toLowerCase()=="s"&&(bP[3]!=bO[3]||bP[4]!=bO[4]))){return}bQ[E]=[];bR[E]=[];for(g=0,bN=o(bP.length,bO.length);g<bN;g++){g in bP&&(bQ[E][g]=bP[g]);g in bO&&(bR[E][g]=bO[g])}}return{from:bQ,to:bR}};aT._getContainer=function(b,S,E,R){var g;g=R==null&&!aT.is(b,"object")?aC.doc.getElementById(b):b;if(g==null){return}if(g.tagName){if(S==null){return{container:g,width:g.style.pixelWidth||g.offsetWidth,height:g.style.pixelHeight||g.offsetHeight}}else{return{container:g,width:S,height:E}}}return{container:1,x:b,y:S,width:E,height:R}};aT.pathToRelative=aE;aT._engine={};aT.path2curve=Y;aT.matrix=function(E,g,bO,bN,S,R){return new aH(E,g,bO,bN,S,R)};function aH(E,g,bO,bN,S,R){if(E!=null){this.a=+E;this.b=+g;this.c=+bO;this.d=+bN;this.e=+S;this.f=+R}else{this.a=1;this.b=0;this.c=0;this.d=1;this.e=0;this.f=0}}(function(E){E.add=function(bX,bU,bS,bQ,bO,bN){var S=[[],[],[]],R=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],bW=[[bX,bS,bO],[bU,bQ,bN],[0,0,1]],bV,bT,bR,bP;if(bX&&bX instanceof aH){bW=[[bX.a,bX.c,bX.e],[bX.b,bX.d,bX.f],[0,0,1]]}for(bV=0;bV<3;bV++){for(bT=0;bT<3;bT++){bP=0;for(bR=0;bR<3;bR++){bP+=R[bV][bR]*bW[bR][bT]}S[bV][bT]=bP}}this.a=S[0][0];this.b=S[1][0];this.c=S[0][1];this.d=S[1][1];this.e=S[0][2];this.f=S[1][2]};E.invert=function(){var S=this,R=S.a*S.d-S.b*S.c;return new aH(S.d/R,-S.b/R,-S.c/R,S.a/R,(S.c*S.f-S.d*S.e)/R,(S.b*S.e-S.a*S.f)/R)};E.clone=function(){return new aH(this.a,this.b,this.c,this.d,this.e,this.f)};E.translate=function(R,S){this.add(1,0,0,1,R,S)};E.scale=function(S,bO,R,bN){bO==null&&(bO=S);(R||bN)&&this.add(1,0,0,1,R,bN);this.add(S,0,0,bO,0,0);(R||bN)&&this.add(1,0,0,1,-R,-bN)};E.rotate=function(S,R,bP){S=aT.rad(S);R=R||0;bP=bP||0;var bO=+aw.cos(S).toFixed(9),bN=+aw.sin(S).toFixed(9);this.add(bO,bN,-bN,bO,R,bP);this.add(1,0,0,1,-R,-bP)};E.x=function(R,S){return R*this.a+S*this.c+this.e};E.y=function(R,S){return R*this.b+S*this.d+this.f};E.get=function(R){return +this[bJ.fromCharCode(97+R)].toFixed(4)};E.toString=function(){return aT.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()};E.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"};E.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]};function g(R){return R[0]*R[0]+R[1]*R[1]}function b(R){var S=aw.sqrt(g(R));R[0]&&(R[0]/=S);R[1]&&(R[1]/=S)}E.split=function(){var S={};S.dx=this.e;S.dy=this.f;var bO=[[this.a,this.c],[this.b,this.d]];S.scalex=aw.sqrt(g(bO[0]));b(bO[0]);S.shear=bO[0][0]*bO[1][0]+bO[0][1]*bO[1][1];bO[1]=[bO[1][0]-bO[0][0]*S.shear,bO[1][1]-bO[0][1]*S.shear];S.scaley=aw.sqrt(g(bO[1]));b(bO[1]);S.shear/=S.scaley;var R=-bO[0][1],bN=bO[1][1];if(bN<0){S.rotate=aT.deg(aw.acos(bN));if(R<0){S.rotate=360-S.rotate}}else{S.rotate=aT.deg(aw.asin(R))}S.isSimple=!+S.shear.toFixed(9)&&(S.scalex.toFixed(9)==S.scaley.toFixed(9)||!S.rotate);S.isSuperSimple=!+S.shear.toFixed(9)&&S.scalex.toFixed(9)==S.scaley.toFixed(9)&&!S.rotate;S.noRotation=!+S.shear.toFixed(9)&&!S.rotate;return S};E.toTransformString=function(R){var S=R||this[H]();if(S.isSimple){S.scalex=+S.scalex.toFixed(4);S.scaley=+S.scaley.toFixed(4);S.rotate=+S.rotate.toFixed(4);return(S.dx||S.dy?"t"+[S.dx,S.dy]:aZ)+(S.scalex!=1||S.scaley!=1?"s"+[S.scalex,S.scaley,0,0]:aZ)+(S.rotate?"r"+[S.rotate,0,0]:aZ)}else{return"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}})(aH.prototype);var X=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);if((navigator.vendor=="Apple Computer, Inc.")&&(X&&X[1]<4||navigator.platform.slice(0,2)=="iP")||(navigator.vendor=="Google Inc."&&X&&X[1]<8)){a6.safari=function(){var b=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){b.remove()})}}else{a6.safari=K}var T=function(){this.returnValue=false},bF=function(){return this.originalEvent.preventDefault()},ba=function(){this.cancelBubble=true},aL=function(){return this.originalEvent.stopPropagation()},aF=(function(){if(aC.doc.addEventListener){return function(bN,R,E,g){var b=ab&&bz[R]?bz[R]:R,S=function(bT){var bS=aC.doc.documentElement.scrollTop||aC.doc.body.scrollTop,bU=aC.doc.documentElement.scrollLeft||aC.doc.body.scrollLeft,bO=bT.clientX+bU,bV=bT.clientY+bS;if(ab&&bz[am](R)){for(var bQ=0,bR=bT.targetTouches&&bT.targetTouches.length;bQ<bR;bQ++){if(bT.targetTouches[bQ].target==bN){var bP=bT;bT=bT.targetTouches[bQ];bT.originalEvent=bP;bT.preventDefault=bF;bT.stopPropagation=aL;break}}}return E.call(g,bT,bO,bV)};bN.addEventListener(b,S,false);return function(){bN.removeEventListener(b,S,false);return true}}}else{if(aC.doc.attachEvent){return function(bN,R,E,g){var S=function(bQ){bQ=bQ||aC.win.event;var bP=aC.doc.documentElement.scrollTop||aC.doc.body.scrollTop,bR=aC.doc.documentElement.scrollLeft||aC.doc.body.scrollLeft,bO=bQ.clientX+bR,bS=bQ.clientY+bP;bQ.preventDefault=bQ.preventDefault||T;bQ.stopPropagation=bQ.stopPropagation||ba;return E.call(g,bQ,bO,bS)};bN.attachEvent("on"+R,S);var b=function(){bN.detachEvent("on"+R,S);return true};return b}}}})(),bg=[],bA=function(bP){var bS=bP.clientX,bR=bP.clientY,bU=aC.doc.documentElement.scrollTop||aC.doc.body.scrollTop,bV=aC.doc.documentElement.scrollLeft||aC.doc.body.scrollLeft,E,R=bg.length;while(R--){E=bg[R];if(ab){var bN=bP.touches.length,S;while(bN--){S=bP.touches[bN];if(S.identifier==E.el._drag.id){bS=S.clientX;bR=S.clientY;(bP.originalEvent?bP.originalEvent:bP).preventDefault();break}}}else{bP.preventDefault()}var g=E.el.node,b,bO=g.nextSibling,bT=g.parentNode,bQ=g.style.display;aC.win.opera&&bT.removeChild(g);g.style.display="none";b=E.el.paper.getElementByPoint(bS,bR);g.style.display=bQ;aC.win.opera&&(bO?bT.insertBefore(g,bO):bT.appendChild(g));b&&eve("raphael.drag.over."+E.el.id,E.el,b);bS+=bV;bR+=bU;eve("raphael.drag.move."+E.el.id,E.move_scope||E.el,bS-E.el._drag.x,bR-E.el._drag.y,bS,bR,bP)}},e=function(E){aT.unmousemove(bA).unmouseup(e);var g=bg.length,b;while(g--){b=bg[g];b.el._drag={};eve("raphael.drag.end."+b.el.id,b.end_scope||b.start_scope||b.move_scope||b.el,E)}bg=[]},bj=aT.el={};for(var az=U.length;az--;){(function(b){aT[b]=bj[b]=function(E,g){if(aT.is(E,"function")){this.events=this.events||[];this.events.push({name:b,f:E,unbind:aF(this.shape||this.node||aC.doc,b,E,g||this)})}return this};aT["un"+b]=bj["un"+b]=function(R){var E=this.events||[],g=E.length;while(g--){if(E[g].name==b&&E[g].f==R){E[g].unbind();E.splice(g,1);!E.length&&delete this.events;return this}}return this}})(U[az])}bj.data=function(g,R){var E=aW[this.id]=aW[this.id]||{};if(arguments.length==1){if(aT.is(g,"object")){for(var b in g){if(g[am](b)){this.data(b,g[b])}}return this}eve("raphael.data.get."+this.id,this,E[g],g);return E[g]}E[g]=R;eve("raphael.data.set."+this.id,this,R,g);return this};bj.removeData=function(b){if(b==null){aW[this.id]={}}else{aW[this.id]&&delete aW[this.id][b]}return this};bj.hover=function(R,b,E,g){return this.mouseover(R,E).mouseout(b,g||E)};bj.unhover=function(g,b){return this.unmouseover(g).unmouseout(b)};var bw=[];bj.drag=function(g,bN,S,b,E,R){function bO(bQ){(bQ.originalEvent||bQ).preventDefault();var bP=aC.doc.documentElement.scrollTop||aC.doc.body.scrollTop,bR=aC.doc.documentElement.scrollLeft||aC.doc.body.scrollLeft;this._drag.x=bQ.clientX+bR;this._drag.y=bQ.clientY+bP;this._drag.id=bQ.identifier;!bg.length&&aT.mousemove(bA).mouseup(e);bg.push({el:this,move_scope:b,start_scope:E,end_scope:R});bN&&eve.on("raphael.drag.start."+this.id,bN);g&&eve.on("raphael.drag.move."+this.id,g);S&&eve.on("raphael.drag.end."+this.id,S);eve("raphael.drag.start."+this.id,E||b||this,bQ.clientX+bR,bQ.clientY+bP,bQ)}this._drag={};bw.push({el:this,start:bO});this.mousedown(bO);return this};bj.onDragOver=function(b){b?eve.on("raphael.drag.over."+this.id,b):eve.unbind("raphael.drag.over."+this.id)};bj.undrag=function(){var b=bw.length;while(b--){if(bw[b].el==this){this.unmousedown(bw[b].start);bw.splice(b,1);eve.unbind("raphael.drag.*."+this.id)}}!bw.length&&aT.unmousemove(bA).unmouseup(e)};a6.circle=function(b,R,E){var g=aT._engine.circle(this,b||0,R||0,E||0);this.__set__&&this.__set__.push(g);return g};a6.rect=function(b,bN,g,R,S){var E=aT._engine.rect(this,b||0,bN||0,g||0,R||0,S||0);this.__set__&&this.__set__.push(E);return E};a6.ellipse=function(b,S,R,E){var g=aT._engine.ellipse(this,b||0,S||0,R||0,E||0);this.__set__&&this.__set__.push(g);return g};a6.path=function(b){b&&!aT.is(b,al)&&!aT.is(b[0],bf)&&(b+=aZ);var g=aT._engine.path(aT.format[bI](aT,arguments),this);this.__set__&&this.__set__.push(g);return g};a6.image=function(S,b,bN,g,R){var E=aT._engine.image(this,S||"about:blank",b||0,bN||0,g||0,R||0);this.__set__&&this.__set__.push(E);return E};a6.text=function(b,R,E){var g=aT._engine.text(this,b||0,R||0,bJ(E));this.__set__&&this.__set__.push(g);return g};a6.set=function(g){!aT.is(g,"array")&&(g=Array.prototype.splice.call(arguments,0,arguments.length));var b=new an(g);this.__set__&&this.__set__.push(b);b.paper=this;b.type="set";return b};a6.setStart=function(b){this.__set__=b||this.set()};a6.setFinish=function(g){var b=this.__set__;delete this.__set__;return b};a6.setSize=function(g,b){return aT._engine.setSize.call(this,g,b)};a6.setViewBox=function(b,S,g,R,E){return aT._engine.setViewBox.call(this,b,S,g,R,E)};a6.top=a6.bottom=null;a6.raphael=aT;var bu=function(E){var S=E.getBoundingClientRect(),bQ=E.ownerDocument,bN=bQ.body,b=bQ.documentElement,R=b.clientTop||bN.clientTop||0,bO=b.clientLeft||bN.clientLeft||0,bP=S.top+(aC.win.pageYOffset||b.scrollTop||bN.scrollTop)-R,g=S.left+(aC.win.pageXOffset||b.scrollLeft||bN.scrollLeft)-bO;return{y:bP,x:g}};a6.getElementByPoint=function(g,bP){var bO=this,E=bO.canvas,bN=aC.doc.elementFromPoint(g,bP);if(aC.win.opera&&bN.tagName=="svg"){var S=bu(E),R=E.createSVGRect();R.x=g-S.x;R.y=bP-S.y;R.width=R.height=1;var b=E.getIntersectionList(R,null);if(b.length){bN=b[b.length-1]}}if(!bN){return null}while(bN.parentNode&&bN!=E.parentNode&&!bN.raphael){bN=bN.parentNode}bN==bO.canvas.parentNode&&(bN=E);bN=bN&&bN.raphael?bO.getById(bN.raphaelid):null;return bN};a6.getById=function(g){var b=this.bottom;while(b){if(b.id==g){return b}b=b.next}return null};a6.forEach=function(E,b){var g=this.bottom;while(g){if(E.call(b,g)===false){return this}g=g.next}return this};a6.getElementsByPoint=function(b,E){var g=this.set();this.forEach(function(R){if(R.isPointInside(b,E)){g.push(R)}});return g};function A(){return this.x+aS+this.y}function av(){return this.x+aS+this.y+aS+this.width+" \xd7 "+this.height}bj.isPointInside=function(b,E){var g=this.realPath=this.realPath||P[this.type](this);return aT.isPointInsidePath(g,b,E)};bj.getBBox=function(g){if(this.removed){return{}}var b=this._;if(g){if(b.dirty||!b.bboxwt){this.realPath=P[this.type](this);b.bboxwt=ao(this.realPath);b.bboxwt.toString=av;b.dirty=0}return b.bboxwt}if(b.dirty||b.dirtyT||!b.bbox){if(b.dirty||!this.realPath){b.bboxwt=0;this.realPath=P[this.type](this)}b.bbox=ao(N(this.realPath,this.matrix));b.bbox.toString=av;b.dirty=b.dirtyT=0}return b.bbox};bj.clone=function(){if(this.removed){return null}var b=this.paper[this.type]().attr(this.attr());this.__set__&&this.__set__.push(b);return b};bj.glow=function(bO){if(this.type=="text"){return null}bO=bO||{};var E={width:(bO.width||10)+(+this.attr("stroke-width")||1),fill:bO.fill||false,opacity:bO.opacity||0.5,offsetx:bO.offsetx||0,offsety:bO.offsety||0,color:bO.color||"#000"},bN=E.width/2,R=this.paper,b=R.set(),S=this.realPath||P[this.type](this);S=this.matrix?N(S,this.matrix):S;for(var g=1;g<bN+1;g++){b.push(R.path(S).attr({stroke:E.color,fill:E.fill?E.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(E.width/bN*g).toFixed(3),opacity:+(E.opacity/bN).toFixed(3)}))}return b.insertBefore(this).translate(E.offsetx,E.offsety)};var a9={},m=function(g,b,S,R,bQ,bP,bO,bN,E){if(E==null){return s(g,b,S,R,bQ,bP,bO,bN)}else{return aT.findDotsAtSegment(g,b,S,R,bQ,bP,bO,bN,F(g,b,S,R,bQ,bP,bO,bN,E))}},a8=function(b,g){return function(bW,S,bN){bW=Y(bW);var bS,bR,E,bO,R="",bV={},bT,bQ=0;for(var bP=0,bU=bW.length;bP<bU;bP++){E=bW[bP];if(E[0]=="M"){bS=+E[1];bR=+E[2]}else{bO=m(bS,bR,E[1],E[2],E[3],E[4],E[5],E[6]);if(bQ+bO>S){if(g&&!bV.start){bT=m(bS,bR,E[1],E[2],E[3],E[4],E[5],E[6],S-bQ);R+=["C"+bT.start.x,bT.start.y,bT.m.x,bT.m.y,bT.x,bT.y];if(bN){return R}bV.start=R;R=["M"+bT.x,bT.y+"C"+bT.n.x,bT.n.y,bT.end.x,bT.end.y,E[5],E[6]].join();bQ+=bO;bS=+E[5];bR=+E[6];continue}if(!b&&!g){bT=m(bS,bR,E[1],E[2],E[3],E[4],E[5],E[6],S-bQ);return{x:bT.x,y:bT.y,alpha:bT.alpha}}}bQ+=bO;bS=+E[5];bR=+E[6]}R+=E.shift()+E}bV.end=R;bT=b?bQ:g?bV:aT.findDotsAtSegment(bS,bR,E[0],E[1],E[2],E[3],E[4],E[5],1);bT.alpha&&(bT={x:bT.x,y:bT.y,alpha:bT.alpha});return bT}};var aU=a8(1),L=a8(),af=a8(0,1);aT.getTotalLength=aU;aT.getPointAtLength=L;aT.getSubpath=function(g,R,E){if(this.getTotalLength(g)-E<0.000001){return af(g,R).end}var b=af(g,E,1);return R?af(b,R).end:b};bj.getTotalLength=function(){if(this.type!="path"){return}if(this.node.getTotalLength){return this.node.getTotalLength()}return aU(this.attrs.path)};bj.getPointAtLength=function(b){if(this.type!="path"){return}return L(this.attrs.path,b)};bj.getSubpath=function(g,b){if(this.type!="path"){return}return aT.getSubpath(this.attrs.path,g,b)};var q=aT.easing_formulas={linear:function(b){return b},"<":function(b){return br(b,1.7)},">":function(b){return br(b,0.48)},"<>":function(bP){var R=0.48-bP/1.04,E=aw.sqrt(0.1734+R*R),b=E-R,bO=br(ay(b),1/3)*(b<0?-1:1),bN=-E-R,S=br(ay(bN),1/3)*(bN<0?-1:1),g=bO+S+0.5;return(1-g)*3*g*g+g*g*g},backIn:function(g){var b=1.70158;return g*g*((b+1)*g-b)},backOut:function(g){g=g-1;var b=1.70158;return g*g*((b+1)*g+b)+1},elastic:function(b){if(b==!!b){return b}return br(2,-10*b)*aw.sin((b-0.075)*(2*aX)/0.3)+1},bounce:function(R){var g=7.5625,E=2.75,b;if(R<(1/E)){b=g*R*R}else{if(R<(2/E)){R-=(1.5/E);b=g*R*R+0.75}else{if(R<(2.5/E)){R-=(2.25/E);b=g*R*R+0.9375}else{R-=(2.625/E);b=g*R*R+0.984375}}}return b}};q.easeIn=q["ease-in"]=q["<"];q.easeOut=q["ease-out"]=q[">"];q.easeInOut=q["ease-in-out"]=q["<>"];q["back-in"]=q.backIn;q["back-out"]=q.backOut;var ad=[],aP=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(b,16)},bE=function(){var bO=+new Date,bW=0;for(;bW<ad.length;bW++){var b2=ad[bW];if(b2.el.removed||b2.paused){continue}var R=bO-b2.start,bU=b2.ms,bT=b2.easing,bX=b2.from,bR=b2.diff,g=b2.to,bQ=b2.t,bN=b2.el,bS={},b,b0={},b4;if(b2.initstatus){R=(b2.initstatus*b2.anim.top-b2.prev)/(b2.percent-b2.prev)*bU;b2.status=b2.initstatus;delete b2.initstatus;b2.stop&&ad.splice(bW--,1)}else{b2.status=(b2.prev+(b2.percent-b2.prev)*(R/bU))/b2.anim.top}if(R<0){continue}if(R<bU){var E=bT(R/bU);for(var bV in bX){if(bX[am](bV)){switch(au[bV]){case aN:b=+bX[bV]+E*bU*bR[bV];break;case"colour":b="rgb("+[J(aj(bX[bV].r+E*bU*bR[bV].r)),J(aj(bX[bV].g+E*bU*bR[bV].g)),J(aj(bX[bV].b+E*bU*bR[bV].b))].join(",")+")";break;case"path":b=[];for(var bZ=0,bP=bX[bV].length;bZ<bP;bZ++){b[bZ]=[bX[bV][bZ][0]];for(var bY=1,b1=bX[bV][bZ].length;bY<b1;bY++){b[bZ][bY]=+bX[bV][bZ][bY]+E*bU*bR[bV][bZ][bY]}b[bZ]=b[bZ].join(aS)}b=b.join(aS);break;case"transform":if(bR[bV].real){b=[];for(bZ=0,bP=bX[bV].length;bZ<bP;bZ++){b[bZ]=[bX[bV][bZ][0]];for(bY=1,b1=bX[bV][bZ].length;bY<b1;bY++){b[bZ][bY]=bX[bV][bZ][bY]+E*bU*bR[bV][bZ][bY]}}}else{var b3=function(b5){return +bX[bV][b5]+E*bU*bR[bV][b5]};b=[["m",b3(0),b3(1),b3(2),b3(3),b3(4),b3(5)]]}break;case"csv":if(bV=="clip-rect"){b=[];bZ=4;while(bZ--){b[bZ]=+bX[bV][bZ]+E*bU*bR[bV][bZ]}}break;default:var S=[][bG](bX[bV]);b=[];bZ=bN.paper.customAttributes[bV].length;while(bZ--){b[bZ]=+S[bZ]+E*bU*bR[bV][bZ]}break}bS[bV]=b}}bN.attr(bS);(function(b7,b5,b6){setTimeout(function(){eve("raphael.anim.frame."+b7,b5,b6)})})(bN.id,bN,b2.anim)}else{(function(b7,b6,b5){setTimeout(function(){eve("raphael.anim.frame."+b6.id,b6,b5);eve("raphael.anim.finish."+b6.id,b6,b5);aT.is(b7,"function")&&b7.call(b6)})})(b2.callback,bN,b2.anim);bN.attr(g);ad.splice(bW--,1);if(b2.repeat>1&&!b2.next){for(b4 in g){if(g[am](b4)){b0[b4]=b2.totalOrigin[b4]}}b2.el.attr(b0);aO(b2.anim,b2.el,b2.anim.percents[0],null,b2.totalOrigin,b2.repeat-1)}if(b2.next&&!b2.stop){aO(b2.anim,b2.el,b2.next,null,b2.totalOrigin,b2.repeat)}}}aT.svg&&bN&&bN.paper&&bN.paper.safari();ad.length&&aP(bE)},J=function(b){return b>255?255:b<0?0:b};bj.animateWith=function(g,R,E,b,bO,bT){var bN=this;if(bN.removed){bT&&bT.call(bN);return bN}var bR=E instanceof bC?E:aT.animation(E,b,bO,bT),bQ,bP;aO(bR,bN,bR.percents[0],null,bN.attr());for(var S=0,bS=ad.length;S<bS;S++){if(ad[S].anim==R&&ad[S].el==g){ad[bS-1].start=ad[S].start;break}}return bN};function a5(bV,R,g,bU,bT,bP){var bQ=3*R,bS=3*(bU-R)-bQ,b=1-bQ-bS,bO=3*g,bR=3*(bT-g)-bO,bW=1-bO-bR;function bN(bX){return((b*bX+bS)*bX+bQ)*bX}function E(bX,bZ){var bY=S(bX,bZ);return((bW*bY+bR)*bY+bO)*bY}function S(bX,b4){var b3,b2,b0,bY,b1,bZ;for(b0=bX,bZ=0;bZ<8;bZ++){bY=bN(b0)-bX;if(ay(bY)<b4){return b0}b1=(3*b*b0+2*bS)*b0+bQ;if(ay(b1)<0.000001){break}b0=b0-bY/b1}b3=0;b2=1;b0=bX;if(b0<b3){return b3}if(b0>b2){return b2}while(b3<b2){bY=bN(b0);if(ay(bY-bX)<b4){return b0}if(bX>bY){b3=b0}else{b2=b0}b0=(b2-b3)/2+b3}return b0}return E(bV,1/(200*bP))}bj.onAnimation=function(b){b?eve.on("raphael.anim.frame."+this.id,b):eve.unbind("raphael.anim.frame."+this.id);return this};function bC(S,E){var g=[],R={};this.ms=E;this.times=1;if(S){for(var b in S){if(S[am](b)){R[ap(b)]=S[b];g.push(ap(b))}}g.sort(w)}this.anim=R;this.top=g[g.length-1];this.percents=g}bC.prototype.delay=function(g){var b=new bC(this.anim,this.ms);b.times=this.times;b.del=+g||0;return b};bC.prototype.repeat=function(g){var b=new bC(this.anim,this.ms);b.del=this.del;b.times=aw.floor(o(g,0))||1;return b};function aO(b6,E,b,b4,bO,bS){b=ap(b);var cd,bN,bR,ce=[],bY,bX,S,b0=b6.ms,b5={},R={},bU={};if(b4){for(b9=0,bT=ad.length;b9<bT;b9++){var cb=ad[b9];if(cb.el.id==E.id&&cb.anim==b6){if(cb.percent!=b){ad.splice(b9,1);bR=1}else{bN=cb}E.attr(cb.totalOrigin);break}}}else{b4=+R}for(var b9=0,bT=b6.percents.length;b9<bT;b9++){if(b6.percents[b9]==b||b6.percents[b9]>b4*b6.top){b=b6.percents[b9];bX=b6.percents[b9-1]||0;b0=b0/b6.top*(b-bX);bY=b6.percents[b9+1];cd=b6.anim[b];break}else{if(b4){E.attr(b6.anim[b6.percents[b9]])}}}if(!cd){return}if(!bN){for(var b2 in cd){if(cd[am](b2)){if(au[am](b2)||E.paper.customAttributes[am](b2)){b5[b2]=E.attr(b2);(b5[b2]==null)&&(b5[b2]=t[b2]);R[b2]=cd[b2];switch(au[b2]){case aN:bU[b2]=(R[b2]-b5[b2])/b0;break;case"colour":b5[b2]=aT.getRGB(b5[b2]);var b3=aT.getRGB(R[b2]);bU[b2]={r:(b3.r-b5[b2].r)/b0,g:(b3.g-b5[b2].g)/b0,b:(b3.b-b5[b2].b)/b0};break;case"path":var bP=Y(b5[b2],R[b2]),bW=bP[1];b5[b2]=bP[0];bU[b2]=[];for(b9=0,bT=b5[b2].length;b9<bT;b9++){bU[b2][b9]=[0];for(var b8=1,ca=b5[b2][b9].length;b8<ca;b8++){bU[b2][b9][b8]=(bW[b9][b8]-b5[b2][b9][b8])/b0}}break;case"transform":var cg=E._,cf=aD(cg[b2],R[b2]);if(cf){b5[b2]=cf.from;R[b2]=cf.to;bU[b2]=[];bU[b2].real=true;for(b9=0,bT=b5[b2].length;b9<bT;b9++){bU[b2][b9]=[b5[b2][b9][0]];for(b8=1,ca=b5[b2][b9].length;b8<ca;b8++){bU[b2][b9][b8]=(R[b2][b9][b8]-b5[b2][b9][b8])/b0}}}else{var b1=(E.matrix||new aH),cc={_:{transform:cg.transform},getBBox:function(){return E.getBBox(1)}};b5[b2]=[b1.a,b1.b,b1.c,b1.d,b1.e,b1.f];aQ(cc,R[b2]);R[b2]=cc._.transform;bU[b2]=[(cc.matrix.a-b1.a)/b0,(cc.matrix.b-b1.b)/b0,(cc.matrix.c-b1.c)/b0,(cc.matrix.d-b1.d)/b0,(cc.matrix.e-b1.e)/b0,(cc.matrix.f-b1.f)/b0]}break;case"csv":var g=bJ(cd[b2])[H](a),bQ=bJ(b5[b2])[H](a);if(b2=="clip-rect"){b5[b2]=bQ;bU[b2]=[];b9=bQ.length;while(b9--){bU[b2][b9]=(g[b9]-b5[b2][b9])/b0}}R[b2]=g;break;default:g=[][bG](cd[b2]);bQ=[][bG](b5[b2]);bU[b2]=[];b9=E.paper.customAttributes[b2].length;while(b9--){bU[b2][b9]=((g[b9]||0)-(bQ[b9]||0))/b0}break}}}}var bZ=cd.easing,b7=aT.easing_formulas[bZ];if(!b7){b7=bJ(bZ).match(c);if(b7&&b7.length==5){var bV=b7;b7=function(ch){return a5(ch,+bV[1],+bV[2],+bV[3],+bV[4],b0)}}else{b7=bD}}S=cd.start||b6.start||+new Date;cb={anim:b6,percent:b,timestamp:S,start:S+(b6.del||0),status:0,initstatus:b4||0,stop:false,ms:b0,easing:b7,from:b5,diff:bU,to:R,el:E,callback:cd.callback,prev:bX,next:bY,repeat:bS||b6.times,origin:E.attr(),totalOrigin:bO};ad.push(cb);if(b4&&!bN&&!bR){cb.stop=true;cb.start=new Date-b0*b4;if(ad.length==1){return bE()}}if(bR){cb.start=new Date-cb.ms*b4}ad.length==1&&aP(bE)}else{bN.initstatus=b4;bN.start=new Date-bN.ms*b4}eve("raphael.anim.start."+E.id,E,b6)}aT.animation=function(S,g,bO,bN){if(S instanceof bC){return S}if(aT.is(bO,"function")||!bO){bN=bN||bO||null;bO=null}S=Object(S);g=+g||0;var R={},E,b;for(b in S){if(S[am](b)&&ap(b)!=b&&ap(b)+"%"!=b){E=true;R[b]=S[b]}}if(!E){return new bC(S,g)}else{bO&&(R.easing=bO);bN&&(R.callback=bN);return new bC({100:R},g)}};bj.animate=function(R,b,bN,S){var g=this;if(g.removed){S&&S.call(g);return g}var E=R instanceof bC?R:aT.animation(R,b,bN,S);aO(E,g,E.percents[0],null,g.attr());return g};bj.setTime=function(g,b){if(g&&b!=null){this.status(g,bo(b,g.ms)/g.ms)}return this};bj.status=function(S,R){var g=[],E=0,b,bN;if(R!=null){aO(S,this,-1,bo(R,1));return this}else{b=ad.length;for(;E<b;E++){bN=ad[E];if(bN.el.id==this.id&&(!S||bN.anim==S)){if(S){return bN.status}g.push({anim:bN.anim,status:bN.status})}}if(S){return 0}return g}};bj.pause=function(g){for(var b=0;b<ad.length;b++){if(ad[b].el.id==this.id&&(!g||ad[b].anim==g)){if(eve("raphael.anim.pause."+this.id,this,ad[b].anim)!==false){ad[b].paused=true}}}return this};bj.resume=function(g){for(var b=0;b<ad.length;b++){if(ad[b].el.id==this.id&&(!g||ad[b].anim==g)){var E=ad[b];if(eve("raphael.anim.resume."+this.id,this,E.anim)!==false){delete E.paused;this.status(E.anim,E.status)}}}return this};bj.stop=function(g){for(var b=0;b<ad.length;b++){if(ad[b].el.id==this.id&&(!g||ad[b].anim==g)){if(eve("raphael.anim.stop."+this.id,this,ad[b].anim)!==false){ad.splice(b--,1)}}}return this};function ac(g){for(var b=0;b<ad.length;b++){if(ad[b].el.paper==g){ad.splice(b--,1)}}}eve.on("raphael.remove",ac);eve.on("raphael.clear",ac);bj.toString=function(){return"Rapha\xebl\u2019s object"};var an=function(b){this.items=[];this.length=0;this.type="set";if(b){for(var g=0,E=b.length;g<E;g++){if(b[g]&&(b[g].constructor==bj.constructor||b[g].constructor==an)){this[this.items.length]=this.items[this.items.length]=b[g];this.length++}}}},be=an.prototype;be.push=function(){var R,b;for(var g=0,E=arguments.length;g<E;g++){R=arguments[g];if(R&&(R.constructor==bj.constructor||R.constructor==an)){b=this.items.length;this[b]=this.items[b]=R;this.length++}}return this};be.pop=function(){this.length&&delete this[this.length--];return this.items.pop()};be.forEach=function(R,b){for(var g=0,E=this.items.length;g<E;g++){if(R.call(b,this.items[g],g)===false){return this}}return this};for(var D in bj){if(bj[am](D)){be[D]=(function(b){return function(){var g=arguments;return this.forEach(function(E){E[b][bI](E,g)})}})(D)}}be.attr=function(g,bN){if(g&&aT.is(g,bf)&&aT.is(g[0],"object")){for(var b=0,S=g.length;b<S;b++){this.items[b].attr(g[b])}}else{for(var E=0,R=this.items.length;E<R;E++){this.items[E].attr(g,bN)}}return this};be.clear=function(){while(this.length){this.pop()}};be.splice=function(R,bO,bP){R=R<0?o(this.length+R,0):R;bO=o(0,bo(this.length-R,bO));var E=[],b=[],g=[],S;for(S=2;S<arguments.length;S++){g.push(arguments[S])}for(S=0;S<bO;S++){b.push(this[R+S])}for(;S<this.length-R;S++){E.push(this[R+S])}var bN=g.length;for(S=0;S<bN+E.length;S++){this.items[R+S]=this[R+S]=S<bN?g[S]:E[S-bN]}S=this.items.length=this.length-=bO-bN;while(this[S]){delete this[S++]}return new an(b)};be.exclude=function(E){for(var b=0,g=this.length;b<g;b++){if(this[b]==E){this.splice(b,1);return true}}};be.animate=function(E,b,bO,bQ){(aT.is(bO,"function")||!bO)&&(bQ=bO||null);var bN=this.items.length,R=bN,bR,bP=this,S;if(!bN){return this}bQ&&(S=function(){!--bN&&bQ.call(bP)});bO=aT.is(bO,al)?bO:S;var g=aT.animation(E,b,bO,S);bR=this.items[--R].animate(g);while(R--){this.items[R]&&!this.items[R].removed&&this.items[R].animateWith(bR,g,g)}return this};be.insertAfter=function(g){var b=this.items.length;while(b--){this.items[b].insertAfter(g)}return this};be.getBBox=function(){var b=[],bN=[],g=[],R=[];for(var E=this.items.length;E--;){if(!this.items[E].removed){var S=this.items[E].getBBox();b.push(S.x);bN.push(S.y);g.push(S.x+S.width);R.push(S.y+S.height)}}b=bo[bI](0,b);bN=bo[bI](0,bN);g=o[bI](0,g);R=o[bI](0,R);return{x:b,y:bN,x2:g,y2:R,width:g-b,height:R-bN}};be.clone=function(E){E=this.paper.set();for(var b=0,g=this.items.length;b<g;b++){E.push(this.items[b].clone())}return E};be.toString=function(){return"Rapha\xebl\u2018s set"};aT.registerFont=function(g){if(!g.face){return g}this.fonts=this.fonts||{};var R={w:g.w,face:{},glyphs:{}},E=g.face["font-family"];for(var bO in g.face){if(g.face[am](bO)){R.face[bO]=g.face[bO]}}if(this.fonts[E]){this.fonts[E].push(R)}else{this.fonts[E]=[R]}if(!g.svg){R.face["units-per-em"]=W(g.face["units-per-em"],10);for(var S in g.glyphs){if(g.glyphs[am](S)){var bN=g.glyphs[S];R.glyphs[S]={w:bN.w,k:{},d:bN.d&&"M"+bN.d.replace(/[mlcxtrv]/g,function(bP){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[bP]||"M"})+"z"};if(bN.k){for(var b in bN.k){if(bN[am](b)){R.glyphs[S].k[b]=bN.k[b]}}}}}}return g};a6.getFont=function(bP,bQ,g,R){R=R||"normal";g=g||"normal";bQ=+bQ||{normal:400,bold:700,lighter:300,bolder:800}[bQ]||400;if(!aT.fonts){return}var S=aT.fonts[bP];if(!S){var E=new RegExp("(^|\\s)"+bP.replace(/[^\w\d\s+!~.:_-]/g,aZ)+"(\\s|$)","i");for(var b in aT.fonts){if(aT.fonts[am](b)){if(E.test(b)){S=aT.fonts[b];break}}}}var bN;if(S){for(var bO=0,bR=S.length;bO<bR;bO++){bN=S[bO];if(bN.face["font-weight"]==bQ&&(bN.face["font-style"]==g||!bN.face["font-style"])&&bN.face["font-stretch"]==R){break}}}return bN};a6.print=function(bO,bN,b,bR,bS,b1,g){b1=b1||"middle";g=o(bo(g||0,1),-1);var b0=bJ(b)[H](aZ),bX=0,bZ=0,bV=aZ,b2;aT.is(bR,b)&&(bR=this.getFont(bR));if(bR){b2=(bS||16)/bR.face["units-per-em"];var R=bR.face.bbox[H](a),bQ=+R[0],E=R[3]-R[1],S=0,bT=+R[1]+(b1=="baseline"?E+(+bR.face.descent):E/2);for(var bW=0,bP=b0.length;bW<bP;bW++){if(b0[bW]=="\n"){bX=0;bY=0;bZ=0;S+=E}else{var bU=bZ&&bR.glyphs[b0[bW-1]]||{},bY=bR.glyphs[b0[bW]];bX+=bZ?(bU.w||bR.w)+(bU.k&&bU.k[b0[bW]]||0)+(bR.w*g):0;bZ=1}if(bY&&bY.d){bV+=aT.transformPath(bY.d,["t",bX*b2,S*b2,"s",b2,b2,bQ,bT,"t",(bO-bQ)/b2,(bN-bT)/b2])}}}return this.path(bV).attr({fill:"#000",stroke:"none"})};a6.add=function(R){if(aT.is(R,"array")){var E=this.set(),g=0,S=R.length,b;for(;g<S;g++){b=R[g]||{};by[am](b.type)&&E.push(this[b.type]().attr(b))}}return E};aT.format=function(g,E){var b=aT.is(E,bf)?[0][bG](E):arguments;g&&aT.is(g,al)&&b.length-1&&(g=g.replace(bt,function(S,R){return b[++R]==null?aZ:b[R]}));return g||aZ};aT.fullfill=(function(){var E=/\{([^\}]+)\}/g,b=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,g=function(bN,S,bO){var R=bO;S.replace(b,function(bR,bQ,bP,bT,bS){bQ=bQ||bT;if(R){if(bQ in R){R=R[bQ]}typeof R=="function"&&bS&&(R=R())}});R=(R==null||R==bO?bN:R)+"";return R};return function(S,R){return String(S).replace(E,function(bO,bN){return g(bO,bN,R)})}})();aT.ninja=function(){u.was?(aC.win.Raphael=u.is):delete Raphael;return aT};aT.st=be;(function(R,g,E){if(R.readyState==null&&R.addEventListener){R.addEventListener(g,E=function(){R.removeEventListener(g,E,false);R.readyState="complete"},false);R.readyState="loading"}function b(){(/in/).test(R.readyState)?setTimeout(b,9):aT.eve("raphael.DOMload")}b()})(document,"DOMContentLoaded");u.was?(aC.win.Raphael=aT):(Raphael=aT);eve.on("raphael.DOMload",function(){aq=true})})();window.Raphael.svg&&function(p){var e="hasOwnProperty",G=String,r=parseFloat,u=parseInt,g=Math,H=g.max,w=g.abs,l=g.pow,h=/[, ]+/,D=p.eve,v="",n=" ";var s="http://www.w3.org/1999/xlink",C={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},y={};p.toString=function(){return"Your browser supports SVG.\nYou are running Rapha\xebl "+this.version};var m=function(J,E){if(E){if(typeof J=="string"){J=m(J)}for(var I in E){if(E[e](I)){if(I.substring(0,6)=="xlink:"){J.setAttributeNS(s,I.substring(6),G(E[I]))}else{J.setAttribute(I,G(E[I]))}}}}else{J=p._g.doc.createElementNS("http://www.w3.org/2000/svg",J);J.style&&(J.style.webkitTapHighlightColor="rgba(0,0,0,0)")}return J},a=function(Q,U){var S="linear",I=Q.id+U,O=0.5,M=0.5,K=Q.node,E=Q.paper,W=K.style,J=p._g.doc.getElementById(I);if(!J){U=G(U).replace(p._radial_gradient,function(Z,X,aa){S="radial";if(X&&aa){O=r(X);M=r(aa);var Y=((M>0.5)*2-1);l(O-0.5,2)+l(M-0.5,2)>0.25&&(M=g.sqrt(0.25-l(O-0.5,2))*Y+0.5)&&M!=0.5&&(M=M.toFixed(5)-0.00001*Y)}return v});U=U.split(/\s*\-\s*/);if(S=="linear"){var N=U.shift();N=-r(N);if(isNaN(N)){return null}var L=[0,0,g.cos(p.rad(N)),g.sin(p.rad(N))],T=1/(H(w(L[2]),w(L[3]))||1);L[2]*=T;L[3]*=T;if(L[2]<0){L[0]=-L[2];L[2]=0}if(L[3]<0){L[1]=-L[3];L[3]=0}}var R=p._parseDots(U);if(!R){return null}I=I.replace(/[\(\)\s,\xb0#]/g,"_");if(Q.gradient&&I!=Q.gradient.id){E.defs.removeChild(Q.gradient);delete Q.gradient}if(!Q.gradient){J=m(S+"Gradient",{id:I});Q.gradient=J;m(J,S=="radial"?{fx:O,fy:M}:{x1:L[0],y1:L[1],x2:L[2],y2:L[3],gradientTransform:Q.matrix.invert()});E.defs.appendChild(J);for(var P=0,V=R.length;P<V;P++){J.appendChild(m("stop",{offset:R[P].offset?R[P].offset:P?"100%":"0%","stop-color":R[P].color||"#fff"}))}}}m(K,{fill:"url(#"+I+")",opacity:1,"fill-opacity":1});W.fill=v;W.opacity=1;W.fillOpacity=1;return 1},b=function(I){var E=I.getBBox(1);m(I.pattern,{patternTransform:I.matrix.invert()+" translate("+E.x+","+E.y+")"})},c=function(S,U,N){if(S.type=="path"){var E=G(U).toLowerCase().split("-"),R=S.paper,af=N?"end":"start",W=S.node,T=S.attrs,M=T["stroke-width"],aa=E.length,K="classic",Z,J,P,X,V,O=3,ab=3,Q=5;while(aa--){switch(E[aa]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":K=E[aa];break;case"wide":ab=5;break;case"narrow":ab=2;break;case"long":O=5;break;case"short":O=2;break}}if(K=="open"){O+=2;ab+=2;Q+=2;P=1;X=N?4:1;V={fill:"none",stroke:T.stroke}}else{X=P=O/2;V={fill:T.stroke,stroke:"none"}}if(S._.arrows){if(N){S._.arrows.endPath&&y[S._.arrows.endPath]--;S._.arrows.endMarker&&y[S._.arrows.endMarker]--}else{S._.arrows.startPath&&y[S._.arrows.startPath]--;S._.arrows.startMarker&&y[S._.arrows.startMarker]--}}else{S._.arrows={}}if(K!="none"){var I="raphael-marker-"+K,ae="raphael-marker-"+af+K+O+ab;if(!p._g.doc.getElementById(I)){R.defs.appendChild(m(m("path"),{"stroke-linecap":"round",d:C[K],id:I}));y[I]=1}else{y[I]++}var L=p._g.doc.getElementById(ae),Y;if(!L){L=m(m("marker"),{id:ae,markerHeight:ab,markerWidth:O,orient:"auto",refX:X,refY:ab/2});Y=m(m("use"),{"xlink:href":"#"+I,transform:(N?"rotate(180 "+O/2+" "+ab/2+") ":v)+"scale("+O/Q+","+ab/Q+")","stroke-width":(1/((O/Q+ab/Q)/2)).toFixed(4)});L.appendChild(Y);R.defs.appendChild(L);y[ae]=1}else{y[ae]++;Y=L.getElementsByTagName("use")[0]}m(Y,V);var ad=P*(K!="diamond"&&K!="oval");if(N){Z=S._.arrows.startdx*M||0;J=p.getTotalLength(T.path)-ad*M}else{Z=ad*M;J=p.getTotalLength(T.path)-(S._.arrows.enddx*M||0)}V={};V["marker-"+af]="url(#"+ae+")";if(J||Z){V.d=Raphael.getSubpath(T.path,Z,J)}m(W,V);S._.arrows[af+"Path"]=I;S._.arrows[af+"Marker"]=ae;S._.arrows[af+"dx"]=ad;S._.arrows[af+"Type"]=K;S._.arrows[af+"String"]=U}else{if(N){Z=S._.arrows.startdx*M||0;J=p.getTotalLength(T.path)-Z}else{Z=0;J=p.getTotalLength(T.path)-(S._.arrows.enddx*M||0)}S._.arrows[af+"Path"]&&m(W,{d:Raphael.getSubpath(T.path,Z,J)});delete S._.arrows[af+"Path"];delete S._.arrows[af+"Marker"];delete S._.arrows[af+"dx"];delete S._.arrows[af+"Type"];delete S._.arrows[af+"String"]}for(V in y){if(y[e](V)&&!y[V]){var ac=p._g.doc.getElementById(V);ac&&ac.parentNode.removeChild(ac)}}}},z={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},o=function(N,L,M){L=z[G(L).toLowerCase()];if(L){var J=N.attrs["stroke-width"]||"1",E={round:J,square:J,butt:0}[N.attrs["stroke-linecap"]||M["stroke-linecap"]]||0,K=[],I=L.length;while(I--){K[I]=L[I]*J+((I%2)?1:-1)*E}m(N.node,{"stroke-dasharray":K.join(",")})}},A=function(S,aa){var W=S.node,T=S.attrs,Q=W.style.visibility;W.style.visibility="hidden";for(var V in aa){if(aa[e](V)){if(!p._availableAttrs[e](V)){continue}var U=aa[V];T[V]=U;switch(V){case"blur":S.blur(U);break;case"href":case"title":case"target":var Y=W.parentNode;if(Y.tagName.toLowerCase()!="a"){var L=m("a");Y.insertBefore(L,W);L.appendChild(W);Y=L}if(V=="target"){Y.setAttributeNS(s,"show",U=="blank"?"new":U)}else{Y.setAttributeNS(s,V,U)}break;case"cursor":W.style.cursor=U;break;case"transform":S.transform(U);break;case"arrow-start":c(S,U);break;case"arrow-end":c(S,U,1);break;case"clip-rect":var I=G(U).split(h);if(I.length==4){S.clip&&S.clip.parentNode.parentNode.removeChild(S.clip.parentNode);var J=m("clipPath"),X=m("rect");J.id=p.createUUID();m(X,{x:I[0],y:I[1],width:I[2],height:I[3]});J.appendChild(X);S.paper.defs.appendChild(J);m(W,{"clip-path":"url(#"+J.id+")"});S.clip=X}if(!U){var R=W.getAttribute("clip-path");if(R){var Z=p._g.doc.getElementById(R.replace(/(^url\(#|\)$)/g,v));Z&&Z.parentNode.removeChild(Z);m(W,{"clip-path":v});delete S.clip}}break;case"path":if(S.type=="path"){m(W,{d:U?T.path=p._pathToAbsolute(U):"M0,0"});S._.dirty=1;if(S._.arrows){"startString" in S._.arrows&&c(S,S._.arrows.startString);"endString" in S._.arrows&&c(S,S._.arrows.endString,1)}}break;case"width":W.setAttribute(V,U);S._.dirty=1;if(T.fx){V="x";U=T.x}else{break}case"x":if(T.fx){U=-T.x-(T.width||0)}case"rx":if(V=="rx"&&S.type=="rect"){break}case"cx":W.setAttribute(V,U);S.pattern&&b(S);S._.dirty=1;break;case"height":W.setAttribute(V,U);S._.dirty=1;if(T.fy){V="y";U=T.y}else{break}case"y":if(T.fy){U=-T.y-(T.height||0)}case"ry":if(V=="ry"&&S.type=="rect"){break}case"cy":W.setAttribute(V,U);S.pattern&&b(S);S._.dirty=1;break;case"r":if(S.type=="rect"){m(W,{rx:U,ry:U})}else{W.setAttribute(V,U)}S._.dirty=1;break;case"src":if(S.type=="image"){W.setAttributeNS(s,"href",U)}break;case"stroke-width":if(S._.sx!=1||S._.sy!=1){U/=H(w(S._.sx),w(S._.sy))||1}if(S.paper._vbSize){U*=S.paper._vbSize}W.setAttribute(V,U);if(T["stroke-dasharray"]){o(S,T["stroke-dasharray"],aa)}if(S._.arrows){"startString" in S._.arrows&&c(S,S._.arrows.startString);"endString" in S._.arrows&&c(S,S._.arrows.endString,1)}break;case"stroke-dasharray":o(S,U,aa);break;case"fill":var M=G(U).match(p._ISURL);if(M){J=m("pattern");var P=m("image");J.id=p.createUUID();m(J,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});m(P,{x:0,y:0,"xlink:href":M[1]});J.appendChild(P);(function(ab){p._preload(M[1],function(){var ac=this.offsetWidth,ad=this.offsetHeight;m(ab,{width:ac,height:ad});m(P,{width:ac,height:ad});S.paper.safari()})})(J);S.paper.defs.appendChild(J);m(W,{fill:"url(#"+J.id+")"});S.pattern=J;S.pattern&&b(S);break}var K=p.getRGB(U);if(!K.error){delete aa.gradient;delete T.gradient;!p.is(T.opacity,"undefined")&&p.is(aa.opacity,"undefined")&&m(W,{opacity:T.opacity});!p.is(T["fill-opacity"],"undefined")&&p.is(aa["fill-opacity"],"undefined")&&m(W,{"fill-opacity":T["fill-opacity"]})}else{if((S.type=="circle"||S.type=="ellipse"||G(U).charAt()!="r")&&a(S,U)){if("opacity" in T||"fill-opacity" in T){var E=p._g.doc.getElementById(W.getAttribute("fill").replace(/^url\(#|\)$/g,v));if(E){var N=E.getElementsByTagName("stop");m(N[N.length-1],{"stop-opacity":("opacity" in T?T.opacity:1)*("fill-opacity" in T?T["fill-opacity"]:1)})}}T.gradient=U;T.fill="none";break}}K[e]("opacity")&&m(W,{"fill-opacity":K.opacity>1?K.opacity/100:K.opacity});case"stroke":K=p.getRGB(U);W.setAttribute(V,K.hex);V=="stroke"&&K[e]("opacity")&&m(W,{"stroke-opacity":K.opacity>1?K.opacity/100:K.opacity});if(V=="stroke"&&S._.arrows){"startString" in S._.arrows&&c(S,S._.arrows.startString);"endString" in S._.arrows&&c(S,S._.arrows.endString,1)}break;case"gradient":(S.type=="circle"||S.type=="ellipse"||G(U).charAt()!="r")&&a(S,U);break;case"opacity":if(T.gradient&&!T[e]("stroke-opacity")){m(W,{"stroke-opacity":U>1?U/100:U})}case"fill-opacity":if(T.gradient){E=p._g.doc.getElementById(W.getAttribute("fill").replace(/^url\(#|\)$/g,v));if(E){N=E.getElementsByTagName("stop");m(N[N.length-1],{"stop-opacity":U})}break}default:V=="font-size"&&(U=u(U,10)+"px");var O=V.replace(/(\-.)/g,function(ab){return ab.substring(1).toUpperCase()});W.style[O]=U;S._.dirty=1;W.setAttribute(V,U);break}}}t(S,aa);W.style.visibility=Q},F=1.2,t=function(E,L){if(E.type!="text"||!(L[e]("text")||L[e]("font")||L[e]("font-size")||L[e]("x")||L[e]("y"))){return}var Q=E.attrs,J=E.node,S=J.firstChild?u(p._g.doc.defaultView.getComputedStyle(J.firstChild,v).getPropertyValue("font-size"),10):10;if(L[e]("text")){Q.text=L.text;while(J.firstChild){J.removeChild(J.firstChild)}var K=G(L.text).split("\n"),I=[],O;for(var M=0,R=K.length;M<R;M++){O=m("tspan");M&&m(O,{dy:S*F,x:Q.x});O.appendChild(p._g.doc.createTextNode(K[M]));J.appendChild(O);I[M]=O}}else{I=J.getElementsByTagName("tspan");for(M=0,R=I.length;M<R;M++){if(M){m(I[M],{dy:S*F,x:Q.x})}else{m(I[0],{dy:0})}}}m(J,{x:Q.x,y:Q.y});E._.dirty=1;var N=E._getBBox(),P=Q.y-(N.y+N.height/2);P&&p.is(P,"finite")&&m(I[0],{dy:P})},x=function(I,E){var K=0,J=0;this[0]=this.node=I;I.raphael=true;this.id=p._oid++;I.raphaelid=this.id;this.matrix=p.matrix();this.realPath=null;this.paper=E;this.attrs=this.attrs||{};this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1};!E.bottom&&(E.bottom=this);this.prev=E.top;E.top&&(E.top.next=this);E.top=this;this.next=null},q=p.el;x.prototype=q;q.constructor=x;p._engine.path=function(E,K){var I=m("path");K.canvas&&K.canvas.appendChild(I);var J=new x(I,K);J.type="path";A(J,{fill:"none",stroke:"#000",path:E});return J};q.rotate=function(I,E,K){if(this.removed){return this}I=G(I).split(h);if(I.length-1){E=r(I[1]);K=r(I[2])}I=r(I[0]);(K==null)&&(E=K);if(E==null||K==null){var J=this.getBBox(1);E=J.x+J.width/2;K=J.y+J.height/2}this.transform(this._.transform.concat([["r",I,E,K]]));return this};q.scale=function(L,J,E,K){if(this.removed){return this}L=G(L).split(h);if(L.length-1){J=r(L[1]);E=r(L[2]);K=r(L[3])}L=r(L[0]);(J==null)&&(J=L);(K==null)&&(E=K);if(E==null||K==null){var I=this.getBBox(1)}E=E==null?I.x+I.width/2:E;K=K==null?I.y+I.height/2:K;this.transform(this._.transform.concat([["s",L,J,E,K]]));return this};q.translate=function(I,E){if(this.removed){return this}I=G(I).split(h);if(I.length-1){E=r(I[1])}I=r(I[0])||0;E=+E||0;this.transform(this._.transform.concat([["t",I,E]]));return this};q.transform=function(I){var J=this._;if(I==null){return J.transform}p._extractTransform(this,I);this.clip&&m(this.clip,{transform:this.matrix.invert()});this.pattern&&b(this);this.node&&m(this.node,{transform:this.matrix});if(J.sx!=1||J.sy!=1){var E=this.attrs[e]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":E})}return this};q.hide=function(){!this.removed&&this.paper.safari(this.node.style.display="none");return this};q.show=function(){!this.removed&&this.paper.safari(this.node.style.display="");return this};q.remove=function(){if(this.removed||!this.node.parentNode){return}var I=this.paper;I.__set__&&I.__set__.exclude(this);D.unbind("raphael.*.*."+this.id);if(this.gradient){I.defs.removeChild(this.gradient)}p._tear(this,I);if(this.node.parentNode.tagName.toLowerCase()=="a"){this.node.parentNode.parentNode.removeChild(this.node.parentNode)}else{this.node.parentNode.removeChild(this.node)}for(var E in this){this[E]=typeof this[E]=="function"?p._removedFactory(E):null}this.removed=true};q._getBBox=function(){if(this.node.style.display=="none"){this.show();var E=true}var J={};try{J=this.node.getBBox()}catch(I){}finally{J=J||{}}E&&this.hide();return J};q.attr=function(E,Q){if(this.removed){return this}if(E==null){var N={};for(var P in this.attrs){if(this.attrs[e](P)){N[P]=this.attrs[P]}}N.gradient&&N.fill=="none"&&(N.fill=N.gradient)&&delete N.gradient;N.transform=this._.transform;return N}if(Q==null&&p.is(E,"string")){if(E=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}if(E=="transform"){return this._.transform}var O=E.split(h),K={};for(var L=0,S=O.length;L<S;L++){E=O[L];if(E in this.attrs){K[E]=this.attrs[E]}else{if(p.is(this.paper.customAttributes[E],"function")){K[E]=this.paper.customAttributes[E].def}else{K[E]=p._availableAttrs[E]}}}return S-1?K:K[O[0]]}if(Q==null&&p.is(E,"array")){K={};for(L=0,S=E.length;L<S;L++){K[E[L]]=this.attr(E[L])}return K}if(Q!=null){var I={};I[E]=Q}else{if(E!=null&&p.is(E,"object")){I=E}}for(var R in I){D("raphael.attr."+R+"."+this.id,this,I[R])}for(R in this.paper.customAttributes){if(this.paper.customAttributes[e](R)&&I[e](R)&&p.is(this.paper.customAttributes[R],"function")){var M=this.paper.customAttributes[R].apply(this,[].concat(I[R]));this.attrs[R]=I[R];for(var J in M){if(M[e](J)){I[J]=M[J]}}}}A(this,I);return this};q.toFront=function(){if(this.removed){return this}if(this.node.parentNode.tagName.toLowerCase()=="a"){this.node.parentNode.parentNode.appendChild(this.node.parentNode)}else{this.node.parentNode.appendChild(this.node)}var E=this.paper;E.top!=this&&p._tofront(this,E);return this};q.toBack=function(){if(this.removed){return this}var I=this.node.parentNode;if(I.tagName.toLowerCase()=="a"){I.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild)}else{if(I.firstChild!=this.node){I.insertBefore(this.node,this.node.parentNode.firstChild)}}p._toback(this,this.paper);var E=this.paper;return this};q.insertAfter=function(E){if(this.removed){return this}var I=E.node||E[E.length-1].node;if(I.nextSibling){I.parentNode.insertBefore(this.node,I.nextSibling)}else{I.parentNode.appendChild(this.node)}p._insertafter(this,E,this.paper);return this};q.insertBefore=function(E){if(this.removed){return this}var I=E.node||E[0].node;I.parentNode.insertBefore(this.node,I);p._insertbefore(this,E,this.paper);return this};q.blur=function(I){var E=this;if(+I!==0){var J=m("filter"),K=m("feGaussianBlur");E.attrs.blur=I;J.id=p.createUUID();m(K,{stdDeviation:+I||1.5});J.appendChild(K);E.paper.defs.appendChild(J);E._blur=J;m(E.node,{filter:"url(#"+J.id+")"})}else{if(E._blur){E._blur.parentNode.removeChild(E._blur);delete E._blur;delete E.attrs.blur}E.node.removeAttribute("filter")}};p._engine.circle=function(I,E,M,L){var K=m("circle");I.canvas&&I.canvas.appendChild(K);var J=new x(K,I);J.attrs={cx:E,cy:M,r:L,fill:"none",stroke:"#000"};J.type="circle";m(K,J.attrs);return J};p._engine.rect=function(J,E,O,I,M,N){var L=m("rect");J.canvas&&J.canvas.appendChild(L);var K=new x(L,J);K.attrs={x:E,y:O,width:I,height:M,r:N||0,rx:N||0,ry:N||0,fill:"none",stroke:"#000"};K.type="rect";m(L,K.attrs);return K};p._engine.ellipse=function(I,E,N,M,L){var K=m("ellipse");I.canvas&&I.canvas.appendChild(K);var J=new x(K,I);J.attrs={cx:E,cy:N,rx:M,ry:L,fill:"none",stroke:"#000"};J.type="ellipse";m(K,J.attrs);return J};p._engine.image=function(J,N,E,O,I,M){var L=m("image");m(L,{x:E,y:O,width:I,height:M,preserveAspectRatio:"none"});L.setAttributeNS(s,"href",N);J.canvas&&J.canvas.appendChild(L);var K=new x(L,J);K.attrs={x:E,y:O,width:I,height:M,src:N};K.type="image";return K};p._engine.text=function(I,E,M,L){var K=m("text");I.canvas&&I.canvas.appendChild(K);var J=new x(K,I);J.attrs={x:E,y:M,"text-anchor":"middle",text:L,font:p._availableAttrs.font,stroke:"none",fill:"#000"};J.type="text";A(J,J.attrs);return J};p._engine.setSize=function(I,E){this.width=I||this.width;this.height=E||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);if(this._viewBox){this.setViewBox.apply(this,this._viewBox)}return this};p._engine.create=function(){var K=p._getContainer.apply(0,arguments),I=K&&K.container,O=K.x,N=K.y,J=K.width,P=K.height;if(!I){throw new Error("SVG container not found.")}var E=m("svg"),M="overflow:hidden;",L;O=O||0;N=N||0;J=J||512;P=P||342;m(E,{height:P,version:1.1,width:J,xmlns:"http://www.w3.org/2000/svg"});if(I==1){E.style.cssText=M+"position:absolute;left:"+O+"px;top:"+N+"px";p._g.doc.body.appendChild(E);L=1}else{E.style.cssText=M+"position:relative";if(I.firstChild){I.insertBefore(E,I.firstChild)}else{I.appendChild(E)}}I=new p._Paper;I.width=J;I.height=P;I.canvas=E;I.clear();I._left=I._top=0;L&&(I.renderfix=function(){});I.renderfix();return I};p._engine.setViewBox=function(M,K,O,E,I){D("raphael.setViewBox",this,this._viewBox,[M,K,O,E,I]);var Q=H(O/this.width,E/this.height),L=this.top,P=I?"meet":"xMinYMin",J,N;if(M==null){if(this._vbSize){Q=1}delete this._vbSize;J="0 0 "+this.width+n+this.height}else{this._vbSize=Q;J=M+n+K+n+O+n+E}m(this.canvas,{viewBox:J,preserveAspectRatio:P});while(Q&&L){N="stroke-width" in L.attrs?L.attrs["stroke-width"]:1;L.attr({"stroke-width":N});L._.dirty=1;L._.dirtyT=1;L=L.prev}this._viewBox=[M,K,O,E,!!I];return this};p.prototype.renderfix=function(){var M=this.canvas,E=M.style,L;try{L=M.getScreenCTM()||M.createSVGMatrix()}catch(K){L=M.createSVGMatrix()}var J=-L.e%1,I=-L.f%1;if(J||I){if(J){this._left=(this._left+J)%1;E.left=this._left+"px"}if(I){this._top=(this._top+I)%1;E.top=this._top+"px"}}};p.prototype.clear=function(){p.eve("raphael.clear",this);var E=this.canvas;while(E.firstChild){E.removeChild(E.firstChild)}this.bottom=this.top=null;(this.desc=m("desc")).appendChild(p._g.doc.createTextNode("Created with Rapha\xebl "+p.version));E.appendChild(this.desc);E.appendChild(this.defs=m("defs"))};p.prototype.remove=function(){D("raphael.remove",this);this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var E in this){this[E]=typeof this[E]=="function"?p._removedFactory(E):null}};var B=p.st;for(var f in q){if(q[e](f)&&!B[e](f)){B[f]=(function(E){return function(){var I=arguments;return this.forEach(function(J){J[E].apply(J,I)})}})(f)}}}(window.Raphael);window.Raphael.vml&&function(p){var f="hasOwnProperty",J=String,r=parseFloat,l=Math,G=l.round,M=l.max,H=l.min,w=l.abs,z="fill",m=/[, ]+/,F=p.eve,A=" progid:DXImageTransform.Microsoft",o=" ",u="",I={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},n=/([clmz]),?([^clmz]*)/gi,x=/ progid:\S+Blur\([^\)]+\)/g,L=/-?[^,\s-]+/g,e="position:absolute;left:0;top:0;width:1px;height:1px",b=21600,D={path:1,rect:1,image:1},v={circle:1,ellipse:1},g=function(W){var T=/[ahqstv]/ig,O=p._pathToAbsolute;J(W).match(T)&&(O=p._path2curve);T=/[clmz]/g;if(O==p._pathToAbsolute&&!J(W).match(T)){var S=J(W).replace(n,function(aa,ac,Y){var ab=[],X=ac.toLowerCase()=="m",Z=I[ac];Y.replace(L,function(ad){if(X&&ab.length==2){Z+=ab+I[ac=="m"?"l":"L"];ab=[]}ab.push(G(ad*b))});return Z+ab});return S}var U=O(W),N,E;S=[];for(var Q=0,V=U.length;Q<V;Q++){N=U[Q];E=U[Q][0].toLowerCase();E=="z"&&(E="x");for(var P=1,R=N.length;P<R;P++){E+=G(N[P]*b)+(P!=R-1?",":u)}S.push(E)}return S.join(o)},s=function(P,O,N){var E=p.matrix();E.rotate(-P,0.5,0.5);return{dx:E.x(O,N),dy:E.y(O,N)}},t=function(V,U,T,Q,P,R){var ad=V._,X=V.matrix,E=ad.fillpos,W=V.node,S=W.style,O=1,N="",Z,ab=b/U,aa=b/T;S.visibility="hidden";if(!U||!T){return}W.coordsize=w(ab)+o+w(aa);S.rotation=R*(U*T<0?-1:1);if(R){var ac=s(R,Q,P);Q=ac.dx;P=ac.dy}U<0&&(N+="x");T<0&&(N+=" y")&&(O=-1);S.flip=N;W.coordorigin=(Q*-ab)+o+(P*-aa);if(E||ad.fillsize){var Y=W.getElementsByTagName(z);Y=Y&&Y[0];W.removeChild(Y);if(E){ac=s(R,X.x(E[0],E[1]),X.y(E[0],E[1]));Y.position=ac.dx*O+o+ac.dy*O}if(ad.fillsize){Y.size=ad.fillsize[0]*w(U)+o+ad.fillsize[1]*w(T)}W.appendChild(Y)}S.visibility="visible"};p.toString=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\xebl "+this.version};var c=function(E,S,N){var U=J(S).toLowerCase().split("-"),Q=N?"end":"start",O=U.length,R="classic",T="medium",P="medium";while(O--){switch(U[O]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":R=U[O];break;case"wide":case"narrow":P=U[O];break;case"long":case"short":T=U[O];break}}var V=E.node.getElementsByTagName("stroke")[0];V[Q+"arrow"]=R;V[Q+"arrowlength"]=T;V[Q+"arrowwidth"]=P},B=function(ad,an){ad.attrs=ad.attrs||{};var ai=ad.node,ar=ad.attrs,Z=ai.style,V,al=D[ad.type]&&(an.x!=ar.x||an.y!=ar.y||an.width!=ar.width||an.height!=ar.height||an.cx!=ar.cx||an.cy!=ar.cy||an.rx!=ar.rx||an.ry!=ar.ry||an.r!=ar.r),ac=v[ad.type]&&(ar.cx!=an.cx||ar.cy!=an.cy||ar.r!=an.r||ar.rx!=an.rx||ar.ry!=an.ry),av=ad;for(var aa in an){if(an[f](aa)){ar[aa]=an[aa]}}if(al){ar.path=p._getPath[ad.type](ad);ad._.dirty=1}an.href&&(ai.href=an.href);an.title&&(ai.title=an.title);an.target&&(ai.target=an.target);an.cursor&&(Z.cursor=an.cursor);"blur" in an&&ad.blur(an.blur);if(an.path&&ad.type=="path"||al){ai.path=g(~J(ar.path).toLowerCase().indexOf("r")?p._pathToAbsolute(ar.path):ar.path);if(ad.type=="image"){ad._.fillpos=[ar.x,ar.y];ad._.fillsize=[ar.width,ar.height];t(ad,1,1,0,0,0)}}"transform" in an&&ad.transform(an.transform);if(ac){var Q=+ar.cx,O=+ar.cy,U=+ar.rx||+ar.r||0,T=+ar.ry||+ar.r||0;ai.path=p.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",G((Q-U)*b),G((O-T)*b),G((Q+U)*b),G((O+T)*b),G(Q*b))}if("clip-rect" in an){var N=J(an["clip-rect"]).split(m);if(N.length==4){N[2]=+N[2]+(+N[0]);N[3]=+N[3]+(+N[1]);var ab=ai.clipRect||p._g.doc.createElement("div"),au=ab.style;au.clip=p.format("rect({1}px {2}px {3}px {0}px)",N);if(!ai.clipRect){au.position="absolute";au.top=0;au.left=0;au.width=ad.paper.width+"px";au.height=ad.paper.height+"px";ai.parentNode.insertBefore(ab,ai);ab.appendChild(ai);ai.clipRect=ab}}if(!an["clip-rect"]){ai.clipRect&&(ai.clipRect.style.clip="auto")}}if(ad.textpath){var ap=ad.textpath.style;an.font&&(ap.font=an.font);an["font-family"]&&(ap.fontFamily='"'+an["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,u)+'"');an["font-size"]&&(ap.fontSize=an["font-size"]);an["font-weight"]&&(ap.fontWeight=an["font-weight"]);an["font-style"]&&(ap.fontStyle=an["font-style"])}if("arrow-start" in an){c(av,an["arrow-start"])}if("arrow-end" in an){c(av,an["arrow-end"],1)}if(an.opacity!=null||an["stroke-width"]!=null||an.fill!=null||an.src!=null||an.stroke!=null||an["stroke-width"]!=null||an["stroke-opacity"]!=null||an["fill-opacity"]!=null||an["stroke-dasharray"]!=null||an["stroke-miterlimit"]!=null||an["stroke-linejoin"]!=null||an["stroke-linecap"]!=null){var aj=ai.getElementsByTagName(z),aq=false;aj=aj&&aj[0];!aj&&(aq=aj=K(z));if(ad.type=="image"&&an.src){aj.src=an.src}an.fill&&(aj.on=true);if(aj.on==null||an.fill=="none"||an.fill===null){aj.on=false}if(aj.on&&an.fill){var S=J(an.fill).match(p._ISURL);if(S){aj.parentNode==ai&&ai.removeChild(aj);aj.rotate=true;aj.src=S[1];aj.type="tile";var E=ad.getBBox(1);aj.position=E.x+o+E.y;ad._.fillpos=[E.x,E.y];p._preload(S[1],function(){ad._.fillsize=[this.offsetWidth,this.offsetHeight]})}else{aj.color=p.getRGB(an.fill).hex;aj.src=u;aj.type="solid";if(p.getRGB(an.fill).error&&(av.type in {circle:1,ellipse:1}||J(an.fill).charAt()!="r")&&a(av,an.fill,aj)){ar.fill="none";ar.gradient=an.fill;aj.rotate=false}}}if("fill-opacity" in an||"opacity" in an){var R=((+ar["fill-opacity"]+1||2)-1)*((+ar.opacity+1||2)-1)*((+p.getRGB(an.fill).o+1||2)-1);R=H(M(R,0),1);aj.opacity=R;if(aj.src){aj.color="none"}}ai.appendChild(aj);var W=(ai.getElementsByTagName("stroke")&&ai.getElementsByTagName("stroke")[0]),at=false;!W&&(at=W=K("stroke"));if((an.stroke&&an.stroke!="none")||an["stroke-width"]||an["stroke-opacity"]!=null||an["stroke-dasharray"]||an["stroke-miterlimit"]||an["stroke-linejoin"]||an["stroke-linecap"]){W.on=true}(an.stroke=="none"||an.stroke===null||W.on==null||an.stroke==0||an["stroke-width"]==0)&&(W.on=false);var ah=p.getRGB(an.stroke);W.on&&an.stroke&&(W.color=ah.hex);R=((+ar["stroke-opacity"]+1||2)-1)*((+ar.opacity+1||2)-1)*((+ah.o+1||2)-1);var ae=(r(an["stroke-width"])||1)*0.75;R=H(M(R,0),1);an["stroke-width"]==null&&(ae=ar["stroke-width"]);an["stroke-width"]&&(W.weight=ae);ae&&ae<1&&(R*=ae)&&(W.weight=1);W.opacity=R;an["stroke-linejoin"]&&(W.joinstyle=an["stroke-linejoin"]||"miter");W.miterlimit=an["stroke-miterlimit"]||8;an["stroke-linecap"]&&(W.endcap=an["stroke-linecap"]=="butt"?"flat":an["stroke-linecap"]=="square"?"square":"round");if(an["stroke-dasharray"]){var ag={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};W.dashstyle=ag[f](an["stroke-dasharray"])?ag[an["stroke-dasharray"]]:u}at&&ai.appendChild(W)}if(av.type=="text"){av.paper.canvas.style.display=u;var ak=av.paper.span,af=100,P=ar.font&&ar.font.match(/\d+(?:\.\d*)?(?=px)/);Z=ak.style;ar.font&&(Z.font=ar.font);ar["font-family"]&&(Z.fontFamily=ar["font-family"]);ar["font-weight"]&&(Z.fontWeight=ar["font-weight"]);ar["font-style"]&&(Z.fontStyle=ar["font-style"]);P=r(ar["font-size"]||P&&P[0])||10;Z.fontSize=P*af+"px";av.textpath.string&&(ak.innerHTML=J(av.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var Y=ak.getBoundingClientRect();av.W=ar.w=(Y.right-Y.left)/af;av.H=ar.h=(Y.bottom-Y.top)/af;av.X=ar.x;av.Y=ar.y+av.H/2;("x" in an||"y" in an)&&(av.path.v=p.format("m{0},{1}l{2},{1}",G(ar.x*b),G(ar.y*b),G(ar.x*b)+1));var X=["x","y","text","font","font-family","font-weight","font-style","font-size"];for(var am=0,ao=X.length;am<ao;am++){if(X[am] in an){av._.dirty=1;break}}switch(ar["text-anchor"]){case"start":av.textpath.style["v-text-align"]="left";av.bbx=av.W/2;break;case"end":av.textpath.style["v-text-align"]="right";av.bbx=-av.W/2;break;default:av.textpath.style["v-text-align"]="center";av.bbx=0;break}av.textpath.style["v-text-kern"]=true}},a=function(E,V,Y){E.attrs=E.attrs||{};var W=E.attrs,P=Math.pow,Q,R,T="linear",U=".5 .5";E.attrs.gradient=V;V=J(V).replace(p._radial_gradient,function(ab,ac,aa){T="radial";if(ac&&aa){ac=r(ac);aa=r(aa);P(ac-0.5,2)+P(aa-0.5,2)>0.25&&(aa=l.sqrt(0.25-P(ac-0.5,2))*((aa>0.5)*2-1)+0.5);U=ac+o+aa}return u});V=V.split(/\s*\-\s*/);if(T=="linear"){var N=V.shift();N=-r(N);if(isNaN(N)){return null}}var S=p._parseDots(V);if(!S){return null}E=E.shape||E.node;if(S.length){E.removeChild(Y);Y.on=true;Y.method="none";Y.color=S[0].color;Y.color2=S[S.length-1].color;var Z=[];for(var O=0,X=S.length;O<X;O++){S[O].offset&&Z.push(S[O].offset+o+S[O].color)}Y.colors=Z.length?Z.join():"0% "+Y.color;if(T=="radial"){Y.type="gradientTitle";Y.focus="100%";Y.focussize="0 0";Y.focusposition=U;Y.angle=0}else{Y.type="gradient";Y.angle=(270-N)%360}E.appendChild(Y)}return 1},y=function(N,E){this[0]=this.node=N;N.raphael=true;this.id=p._oid++;N.raphaelid=this.id;this.X=0;this.Y=0;this.attrs={};this.paper=E;this.matrix=p.matrix();this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1};!E.bottom&&(E.bottom=this);this.prev=E.top;E.top&&(E.top.next=this);E.top=this;this.next=null};var q=p.el;y.prototype=q;q.constructor=y;q.transform=function(Q){if(Q==null){return this._.transform}var S=this.paper._viewBoxShift,R=S?"s"+[S.scale,S.scale]+"-1-1t"+[S.dx,S.dy]:u,V;if(S){V=Q=J(Q).replace(/\.{3}|\u2026/g,this._.transform||u)}p._extractTransform(this,R+Q);var W=this.matrix.clone(),Y=this.skew,O=this.node,U,P=~J(this.attrs.fill).indexOf("-"),E=!J(this.attrs.fill).indexOf("url(");W.translate(-0.5,-0.5);if(E||P||this.type=="image"){Y.matrix="1 0 0 1";Y.offset="0 0";U=W.split();if((P&&U.noRotation)||!U.isSimple){O.style.filter=W.toFilter();var T=this.getBBox(),N=this.getBBox(1),Z=T.x-N.x,X=T.y-N.y;O.coordorigin=(Z*-b)+o+(X*-b);t(this,1,1,Z,X,0)}else{O.style.filter=u;t(this,U.scalex,U.scaley,U.dx,U.dy,U.rotate)}}else{O.style.filter=u;Y.matrix=J(W);Y.offset=W.offset()}V&&(this._.transform=V);return this};q.rotate=function(N,E,P){if(this.removed){return this}if(N==null){return}N=J(N).split(m);if(N.length-1){E=r(N[1]);P=r(N[2])}N=r(N[0]);(P==null)&&(E=P);if(E==null||P==null){var O=this.getBBox(1);E=O.x+O.width/2;P=O.y+O.height/2}this._.dirtyT=1;this.transform(this._.transform.concat([["r",N,E,P]]));return this};q.translate=function(N,E){if(this.removed){return this}N=J(N).split(m);if(N.length-1){E=r(N[1])}N=r(N[0])||0;E=+E||0;if(this._.bbox){this._.bbox.x+=N;this._.bbox.y+=E}this.transform(this._.transform.concat([["t",N,E]]));return this};q.scale=function(Q,O,E,P){if(this.removed){return this}Q=J(Q).split(m);if(Q.length-1){O=r(Q[1]);E=r(Q[2]);P=r(Q[3]);isNaN(E)&&(E=null);isNaN(P)&&(P=null)}Q=r(Q[0]);(O==null)&&(O=Q);(P==null)&&(E=P);if(E==null||P==null){var N=this.getBBox(1)}E=E==null?N.x+N.width/2:E;P=P==null?N.y+N.height/2:P;this.transform(this._.transform.concat([["s",Q,O,E,P]]));this._.dirtyT=1;return this};q.hide=function(){!this.removed&&(this.node.style.display="none");return this};q.show=function(){!this.removed&&(this.node.style.display=u);return this};q._getBBox=function(){if(this.removed){return{}}return{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}};q.remove=function(){if(this.removed||!this.node.parentNode){return}this.paper.__set__&&this.paper.__set__.exclude(this);p.eve.unbind("raphael.*.*."+this.id);p._tear(this,this.paper);this.node.parentNode.removeChild(this.node);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var E in this){this[E]=typeof this[E]=="function"?p._removedFactory(E):null}this.removed=true};q.attr=function(E,V){if(this.removed){return this}if(E==null){var S={};for(var U in this.attrs){if(this.attrs[f](U)){S[U]=this.attrs[U]}}S.gradient&&S.fill=="none"&&(S.fill=S.gradient)&&delete S.gradient;S.transform=this._.transform;return S}if(V==null&&p.is(E,"string")){if(E==z&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}var T=E.split(m),P={};for(var Q=0,X=T.length;Q<X;Q++){E=T[Q];if(E in this.attrs){P[E]=this.attrs[E]}else{if(p.is(this.paper.customAttributes[E],"function")){P[E]=this.paper.customAttributes[E].def}else{P[E]=p._availableAttrs[E]}}}return X-1?P:P[T[0]]}if(this.attrs&&V==null&&p.is(E,"array")){P={};for(Q=0,X=E.length;Q<X;Q++){P[E[Q]]=this.attr(E[Q])}return P}var N;if(V!=null){N={};N[E]=V}V==null&&p.is(E,"object")&&(N=E);for(var W in N){F("raphael.attr."+W+"."+this.id,this,N[W])}if(N){for(W in this.paper.customAttributes){if(this.paper.customAttributes[f](W)&&N[f](W)&&p.is(this.paper.customAttributes[W],"function")){var R=this.paper.customAttributes[W].apply(this,[].concat(N[W]));this.attrs[W]=N[W];for(var O in R){if(R[f](O)){N[O]=R[O]}}}}if(N.text&&this.type=="text"){this.textpath.string=N.text}B(this,N)}return this};q.toFront=function(){!this.removed&&this.node.parentNode.appendChild(this.node);this.paper&&this.paper.top!=this&&p._tofront(this,this.paper);return this};q.toBack=function(){if(this.removed){return this}if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild);p._toback(this,this.paper)}return this};q.insertAfter=function(E){if(this.removed){return this}if(E.constructor==p.st.constructor){E=E[E.length-1]}if(E.node.nextSibling){E.node.parentNode.insertBefore(this.node,E.node.nextSibling)}else{E.node.parentNode.appendChild(this.node)}p._insertafter(this,E,this.paper);return this};q.insertBefore=function(E){if(this.removed){return this}if(E.constructor==p.st.constructor){E=E[0]}E.node.parentNode.insertBefore(this.node,E.node);p._insertbefore(this,E,this.paper);return this};q.blur=function(E){var N=this.node.runtimeStyle,O=N.filter;O=O.replace(x,u);if(+E!==0){this.attrs.blur=E;N.filter=O+o+A+".Blur(pixelradius="+(+E||1.5)+")";N.margin=p.format("-{0}px 0 0 -{0}px",G(+E||1.5))}else{N.filter=O;N.margin=0;delete this.attrs.blur}};p._engine.path=function(P,N){var Q=K("shape");Q.style.cssText=e;Q.coordsize=b+o+b;Q.coordorigin=N.coordorigin;var R=new y(Q,N),E={fill:"none",stroke:"#000"};P&&(E.path=P);R.type="path";R.path=[];R.Path=u;B(R,E);N.canvas.appendChild(Q);var O=K("skew");O.on=true;Q.appendChild(O);R.skew=O;R.transform(u);return R};p._engine.rect=function(N,S,Q,T,O,E){var U=p._rectPath(S,Q,T,O,E),P=N.path(U),R=P.attrs;P.X=R.x=S;P.Y=R.y=Q;P.W=R.width=T;P.H=R.height=O;R.r=E;R.path=U;P.type="rect";return P};p._engine.ellipse=function(N,E,S,R,Q){var P=N.path(),O=P.attrs;P.X=E-R;P.Y=S-Q;P.W=R*2;P.H=Q*2;P.type="ellipse";B(P,{cx:E,cy:S,rx:R,ry:Q});return P};p._engine.circle=function(N,E,R,Q){var P=N.path(),O=P.attrs;P.X=E-Q;P.Y=R-Q;P.W=P.H=Q*2;P.type="circle";B(P,{cx:E,cy:R,r:Q});return P};p._engine.image=function(N,E,T,R,U,P){var W=p._rectPath(T,R,U,P),Q=N.path(W).attr({stroke:"none"}),S=Q.attrs,O=Q.node,V=O.getElementsByTagName(z)[0];S.src=E;Q.X=S.x=T;Q.Y=S.y=R;Q.W=S.width=U;Q.H=S.height=P;S.path=W;Q.type="image";V.parentNode==O&&O.removeChild(V);V.rotate=true;V.src=E;V.type="tile";Q._.fillpos=[T,R];Q._.fillsize=[U,P];O.appendChild(V);t(Q,1,1,0,0,0);return Q};p._engine.text=function(E,S,R,T){var P=K("shape"),V=K("path"),O=K("textpath");S=S||0;R=R||0;T=T||"";V.v=p.format("m{0},{1}l{2},{1}",G(S*b),G(R*b),G(S*b)+1);V.textpathok=true;O.string=J(T);O.on=true;P.style.cssText=e;P.coordsize=b+o+b;P.coordorigin="0 0";var N=new y(P,E),Q={fill:"#000",stroke:"none",font:p._availableAttrs.font,text:T};N.shape=P;N.path=V;N.textpath=O;N.type="text";N.attrs.text=J(T);N.attrs.x=S;N.attrs.y=R;N.attrs.w=1;N.attrs.h=1;B(N,Q);P.appendChild(O);P.appendChild(V);E.canvas.appendChild(P);var U=K("skew");U.on=true;P.appendChild(U);N.skew=U;N.transform(u);return N};p._engine.setSize=function(O,E){var N=this.canvas.style;this.width=O;this.height=E;O==+O&&(O+="px");E==+E&&(E+="px");N.width=O;N.height=E;N.clip="rect(0 "+O+" "+E+" 0)";if(this._viewBox){p._engine.setViewBox.apply(this,this._viewBox)}return this};p._engine.setViewBox=function(R,Q,S,O,P){p.eve("raphael.setViewBox",this,this._viewBox,[R,Q,S,O,P]);var E=this.width,U=this.height,V=1/M(S/E,O/U),T,N;if(P){T=U/O;N=E/S;if(S*T<E){R-=(E-S*T)/2/T}if(O*N<U){Q-=(U-O*N)/2/N}}this._viewBox=[R,Q,S,O,!!P];this._viewBoxShift={dx:-R,dy:-Q,scale:V};this.forEach(function(W){W.transform("...")});return this};var K;p._engine.initWin=function(O){var N=O.document;N.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!N.namespaces.rvml&&N.namespaces.add("rvml","urn:schemas-microsoft-com:vml");K=function(P){return N.createElement("<rvml:"+P+' class="rvml">')}}catch(E){K=function(P){return N.createElement("<"+P+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}};p._engine.initWin(p._g.win);p._engine.create=function(){var O=p._getContainer.apply(0,arguments),E=O.container,U=O.height,V,N=O.width,T=O.x,S=O.y;if(!E){throw new Error("VML container not found.")}var Q=new p._Paper,R=Q.canvas=p._g.doc.createElement("div"),P=R.style;T=T||0;S=S||0;N=N||512;U=U||342;Q.width=N;Q.height=U;N==+N&&(N+="px");U==+U&&(U+="px");Q.coordsize=b*1000+o+b*1000;Q.coordorigin="0 0";Q.span=p._g.doc.createElement("span");Q.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;";R.appendChild(Q.span);P.cssText=p.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",N,U);if(E==1){p._g.doc.body.appendChild(R);P.left=T+"px";P.top=S+"px";P.position="absolute"}else{if(E.firstChild){E.insertBefore(R,E.firstChild)}else{E.appendChild(R)}}Q.renderfix=function(){};return Q};p.prototype.clear=function(){p.eve("raphael.clear",this);this.canvas.innerHTML=u;this.span=p._g.doc.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas.appendChild(this.span);this.bottom=this.top=null};p.prototype.remove=function(){p.eve("raphael.remove",this);this.canvas.parentNode.removeChild(this.canvas);for(var E in this){this[E]=typeof this[E]=="function"?p._removedFactory(E):null}return true};var C=p.st;for(var h in q){if(q[f](h)&&!C[f](h)){C[h]=(function(E){return function(){var N=arguments;return this.forEach(function(O){O[E].apply(O,N)})}})(h)}}}(window.Raphael);(function(){window.ScaleRaphael=function(c,f,b){var h=(typeof c=="string")?document.getElementById(c):c;if(!h.style.position){h.style.position="relative"}h.style.width=f+"px";h.style.height=b+"px";h.style.overflow="hidden";var e;if(Raphael.type=="VML"){h.innerHTML="<rvml:group style='position : absolute; width: 1000px; height: 1000px; top: 0px; left: 0px' coordsize='1000,1000' class='rvml' id='vmlgroup'></rvml:group>";e=document.getElementById("vmlgroup")}else{h.innerHTML="<div id='svggroup'></div>";e=document.getElementById("svggroup")}var g=new Raphael(e,f,b);var a;if(Raphael.type=="SVG"){g.canvas.setAttribute("viewBox","0 0 "+f+" "+b)}else{a=h.getElementsByTagName("div")[0]}g.changeSize=function(y,t,m,n){n=!n;var v=y/f;var p=t/b;var o=v<p?v:p;var l=parseInt(b*o);var s=parseInt(f*o);if(Raphael.type=="VML"){var r=document.getElementsByTagName("textpath");for(var q in r){var z=r[q];if(z.style){if(!z._fontSize){var x=z.style.font.split("px");z._fontSize=parseInt(x[0]);z._font=x[1]}z.style.font=z._fontSize*o+"px"+z._font}}var u;if(s<l){u=s*1000/f}else{u=l*1000/b}u=parseInt(u);e.style.width=u+"px";e.style.height=u+"px";if(n){e.style.left=parseInt((y-s)/2)+"px";e.style.top=parseInt((t-l)/2)+"px"}a.style.overflow="visible"}if(n){s=y;l=t}h.style.width=s+"px";h.style.height=l+"px";g.setSize(s,l);if(m){h.style.position="absolute";h.style.left=parseInt((y-s)/2)+"px";h.style.top=parseInt((t-l)/2)+"px"}};g.scaleAll=function(l){g.changeSize(f*l,b*l)};g.changeSize(f,b);g.w=f;g.h=b;return g}})();if(typeof exports==="undefined"){exports={}}if(typeof require!=="function"){require=function(a){return exports}}(function(){var F=function(aD){var aF=arguments[0],aC=1,aE=arguments[aC];while(aE){aF=aF.slice(0,-1)+aE.slice(1);aE=arguments[++aC]}return aF},v=function(aC){return"(?:"+aC+")"},c="[A-Za-z]",M="[\\x0D]",g="[0-9]",af="[\\x22]",at=F(g,"[A-Fa-f]"),ai="[\\x0A]",ac="[\\x20]",ak=v("%"+at+at),au="[\\:\\/\\?\\#\\[\\]\\@]",al="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",J=F(au,al),Q=F(c,g,"[\\-\\.\\_\\~]"),e=v(c+F(c,g,"[\\+\\-\\.]")+"*"),p=v(v(ak+"|"+F(Q,al,"[\\:]"))+"*"),U=v(v("25[0-5]")+"|"+v("2[0-4]"+g)+"|"+v("1"+g+g)+"|"+v("[1-9]"+g)+"|"+g),ar=v(U+"\\."+U+"\\."+U+"\\."+U),L=v(at+"{1,4}"),aw=v(v(L+"\\:"+L)+"|"+ar),ap=v(F(Q,al,"[\\:]")+"+"),R=v("v"+at+"+\\."+F(Q,al,"[\\:]")+"+"),aq=v("\\["+v(ap+"|"+R)+"\\]"),aB=v(v(ak+"|"+F(Q,al))+"*"),f=v(aq+"|"+ar+"|"+aB),Y=v(g+"*"),l=v(v(p+"@")+"?"+f+v("\\:"+Y)+"?"),r=v(ak+"|"+F(Q,al,"[\\:\\@]")),W=v(r+"*"),aj=v(r+"+"),ah=v(v(ak+"|"+F(Q,al,"[\\@]"))+"+"),a=v(v("\\/"+W)+"*"),q=v("\\/"+v(aj+a)+"?"),ax=v(ah+a),aA=v(aj+a),b=v(""),m=v(a+"|"+q+"|"+ax+"|"+aA+"|"+b),s=v(v(r+"|[\\/\\?]")+"*"),X=v(v(r+"|[\\/\\?]")+"*"),av=v(v("\\/\\/"+l+a)+"|"+q+"|"+aA+"|"+b),aa=v(e+"\\:"+av+v("\\?"+s)+"?"+v("\\#"+X)+"?"),P=v(v("\\/\\/"+l+a)+"|"+q+"|"+ax+"|"+b),u=v(P+v("\\?"+s)+"?"+v("\\#"+X)+"?"),w=v(aa+"|"+u),ay=v(e+"\\:"+av+v("\\?"+s)+"?"),t=new RegExp("^"+v("("+aa+")|("+u+")")+"$"),ao=new RegExp("^("+e+")\\:"+v(v("\\/\\/("+v("("+p+")@")+"?("+f+")"+v("\\:("+Y+")")+"?)")+"?("+a+"|"+q+"|"+aA+"|"+b+")")+v("\\?("+s+")")+"?"+v("\\#("+X+")")+"?$"),N=new RegExp("^(){0}"+v(v("\\/\\/("+v("("+p+")@")+"?("+f+")"+v("\\:("+Y+")")+"?)")+"?("+a+"|"+q+"|"+ax+"|"+b+")")+v("\\?("+s+")")+"?"+v("\\#("+X+")")+"?$"),G=new RegExp("^("+e+")\\:"+v(v("\\/\\/("+v("("+p+")@")+"?("+f+")"+v("\\:("+Y+")")+"?)")+"?("+a+"|"+q+"|"+aA+"|"+b+")")+v("\\?("+s+")")+"?$"),O=new RegExp("^"+v("\\#("+X+")")+"?$"),H=new RegExp("^"+v("("+p+")@")+"?("+f+")"+v("\\:("+Y+")")+"?$"),am=new RegExp(F("[^]",c,g,"[\\+\\-\\.]"),"g"),ab=new RegExp(F("[^\\%\\:]",Q,al),"g"),az=new RegExp(F("[^\\%]",Q,al),"g"),S=new RegExp(F("[^\\%\\/\\:\\@]",Q,al),"g"),Z=new RegExp(F("[^\\%\\/\\@]",Q,al),"g"),C=new RegExp(F("[^\\%]",Q,al,"[\\:\\@\\/\\?]"),"g"),K=C,V=new RegExp(F("[^]",Q,al),"g"),I=new RegExp(Q,"g"),x=new RegExp(F("[^\\%]",Q,J),"g"),T=new RegExp(ak+"+","g"),o=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?([^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/i,E=/^\.\.?\//,D=/^\/\.(\/|$)/,B=/^\/\.\.(\/|$)/,z=/^\.\.?$/,y=/^\/?.*?(?=\/|$)/,A=("").match(/(){0}/)[1]===undefined,n=function(aC){var aD=aC.charCodeAt(0);if(aD<128){return"%"+aD.toString(16).toUpperCase()}else{if((aD>127)&&(aD<2048)){return"%"+((aD>>6)|192).toString(16).toUpperCase()+"%"+((aD&63)|128).toString(16).toUpperCase()}else{return"%"+((aD>>12)|224).toString(16).toUpperCase()+"%"+(((aD>>6)&63)|128).toString(16).toUpperCase()+"%"+((aD&63)|128).toString(16).toUpperCase()}}},an=function(aF){var aC="",aD=0,aG,aE;while(aD<aF.length){aG=parseInt(aF.substr(aD+1,2),16);if(aG<128){aE=String.fromCharCode(aG);if(aE.match(I)){aC+=aE}else{aC+=aF.substr(aD,3)}aD+=3}else{if((aG>191)&&(aG<224)){aC+=aF.substr(aD,6);aD+=6}else{aC+=aF.substr(aD,9);aD+=9}}}return aC},h=function(aG){var aD="",aF=0,aH,aE,aC;while(aF<aG.length){aH=parseInt(aG.substr(aF+1,2),16);if(aH<128){aD+=String.fromCharCode(aH);aF+=3}else{if((aH>191)&&(aH<224)){aE=parseInt(aG.substr(aF+4,2),16);aD+=String.fromCharCode(((aH&31)<<6)|(aE&63));aF+=6}else{aE=parseInt(aG.substr(aF+4,2),16);aC=parseInt(aG.substr(aF+7,2),16);aD+=String.fromCharCode(((aH&15)<<12)|((aE&63)<<6)|(aC&63));aF+=9}}}return aD},ae=function(aC){return aC===undefined?"undefined":(aC===null?"null":Object.prototype.toString.call(aC).split(" ").pop().split("]").shift().toLowerCase())},ag=function(){this.errors=[]},ad=exports;ag.prototype={scheme:undefined,authority:undefined,userinfo:undefined,host:undefined,port:undefined,path:undefined,query:undefined,fragment:undefined,reference:undefined,errors:undefined};ad.SCHEMES={};ad.parse=function(aG,aC){var aF,aE=new ag(),aD;aG=aG?aG.toString():"";aC=aC||{};if(aC.reference==="suffix"){aG=(aC.scheme?aC.scheme+":":"")+"//"+aG}aF=aG.match(t);if(aF){if(aF[1]){aF=aG.match(ao)}else{aF=aG.match(N)}}if(!aF){if(!aC.tolerant){aE.errors.push("URI is not strictly valid.")}aF=aG.match(o)}if(aF){if(A){aE.scheme=aF[1];aE.authority=aF[2];aE.userinfo=aF[3];aE.host=aF[4];aE.port=parseInt(aF[5],10);aE.path=aF[6]||"";aE.query=aF[7];aE.fragment=aF[8];if(isNaN(aE.port)){aE.port=aF[5]}}else{aE.scheme=aF[1]||undefined;aE.authority=(aG.indexOf("//")!==-1?aF[2]:undefined);aE.userinfo=(aG.indexOf("@")!==-1?aF[3]:undefined);aE.host=(aG.indexOf("//")!==-1?aF[4]:undefined);aE.port=parseInt(aF[5],10);aE.path=aF[6]||"";aE.query=(aG.indexOf("?")!==-1?aF[7]:undefined);aE.fragment=(aG.indexOf("#")!==-1?aF[8]:undefined);if(isNaN(aE.port)){aE.port=(aG.match(/\/\/.*\:(?:\/|\?|\#|$)/)?aF[4]:undefined)}}if(!aE.scheme&&!aE.authority&&!aE.path&&!aE.query){aE.reference="same-document"}else{if(!aE.scheme){aE.reference="relative"}else{if(!aE.fragment){aE.reference="absolute"}else{aE.reference="uri"}}}if(aC.reference&&aC.reference!=="suffix"&&aC.reference!==aE.reference){aE.errors.push("URI is not a "+aC.reference+" reference.")}aD=ad.SCHEMES[(aE.scheme||aC.scheme||"").toLowerCase()];if(aD&&aD.parse){aD.parse(aE,aC)}}else{aE.errors.push("URI can not be parsed.")}return aE};ad._recomposeAuthority=function(aD){var aC=[];if(aD.userinfo!==undefined||aD.host!==undefined||typeof aD.port==="number"){if(aD.userinfo!==undefined){aC.push(aD.userinfo.toString().replace(ab,n));aC.push("@")}if(aD.host!==undefined){aC.push(aD.host.toString().toLowerCase().replace(az,n))}if(typeof aD.port==="number"){aC.push(":");aC.push(aD.port.toString(10))}}return aC.length?aC.join(""):undefined};ad.removeDotSegments=function(aD){var aC=[],aE;while(aD.length){if(aD.match(E)){aD=aD.replace(E,"")}else{if(aD.match(D)){aD=aD.replace(D,"/")}else{if(aD.match(B)){aD=aD.replace(B,"/");aC.pop()}else{if(aD==="."||aD===".."){aD=""}else{aE=aD.match(y)[0];aD=aD.slice(aE.length);aC.push(aE)}}}}}return aC.join("")};ad.serialize=function(aG,aC){var aE=[],aD,aF;aC=aC||{};aD=ad.SCHEMES[aG.scheme||aC.scheme];if(aD&&aD.serialize){aD.serialize(aG,aC)}if(aC.reference!=="suffix"&&aG.scheme){aE.push(aG.scheme.toString().toLowerCase().replace(am,""));aE.push(":")}aG.authority=ad._recomposeAuthority(aG);if(aG.authority!==undefined){if(aC.reference!=="suffix"){aE.push("//")}aE.push(aG.authority);if(aG.path&&aG.path.charAt(0)!=="/"){aE.push("/")}}if(aG.path){aF=ad.removeDotSegments(aG.path.toString().replace(/%2E/ig,"."));if(aG.scheme){aF=aF.replace(S,n)}else{aF=aF.replace(Z,n)}if(aG.authority===undefined){aF=aF.replace(/^\/\//,"/%2F")}aE.push(aF)}if(aG.query){aE.push("?");aE.push(aG.query.toString().replace(C,n))}if(aG.fragment){aE.push("#");aE.push(aG.fragment.toString().replace(K,n))}return aE.join("").replace(T,an).replace(/%[0-9A-Fa-f]{2}/g,function(aH){return aH.toUpperCase()})};ad.resolveComponents=function(aE,aD,aC,aG){var aF=new ag();if(!aG){aE=ad.parse(ad.serialize(aE,aC),aC);aD=ad.parse(ad.serialize(aD,aC),aC)}aC=aC||{};if(!aC.tolerant&&aD.scheme){aF.scheme=aD.scheme;aF.authority=aD.authority;aF.userinfo=aD.userinfo;aF.host=aD.host;aF.port=aD.port;aF.path=ad.removeDotSegments(aD.path);aF.query=aD.query}else{if(aD.authority!==undefined){aF.authority=aD.authority;aF.userinfo=aD.userinfo;aF.host=aD.host;aF.port=aD.port;aF.path=ad.removeDotSegments(aD.path);aF.query=aD.query}else{if(!aD.path){aF.path=aE.path;if(aD.query!==undefined){aF.query=aD.query}else{aF.query=aE.query}}else{if(aD.path.charAt(0)==="/"){aF.path=ad.removeDotSegments(aD.path)}else{if(aE.authority!==undefined&&!aE.path){aF.path="/"+aD.path}else{if(!aE.path){aF.path=aD.path}else{aF.path=aE.path.slice(0,aE.path.lastIndexOf("/")+1)+aD.path}}aF.path=ad.removeDotSegments(aF.path)}aF.query=aD.query}aF.authority=aE.authority;aF.userinfo=aE.userinfo;aF.host=aE.host;aF.port=aE.port}aF.scheme=aE.scheme}aF.fragment=aD.fragment;return aF};ad.resolve=function(aE,aD,aC){return ad.serialize(ad.resolveComponents(ad.parse(aE,aC),ad.parse(aD,aC),aC,true),aC)};ad.normalize=function(aD,aC){if(typeof aD==="string"){return ad.serialize(ad.parse(aD,aC),aC)}else{if(ae(aD)==="object"){return ad.parse(ad.serialize(aD,aC),aC)}}return aD};ad.equal=function(aE,aD,aC){if(typeof aE==="string"){aE=ad.serialize(ad.parse(aE,aC),aC)}else{if(ae(aE)==="object"){aE=ad.serialize(aE,aC)}}if(typeof aD==="string"){aD=ad.serialize(ad.parse(aD,aC),aC)}else{if(ae(aD)==="object"){aD=ad.serialize(aD,aC)}}return aE===aD};ad.escapeComponent=function(aC){return aC&&aC.toString().replace(V,n)};ad.unescapeComponent=function(aC){return aC&&aC.toString().replace(T,h)};exports.pctEncChar=n;exports.pctDecChars=h;exports.Components=ag;exports.URI=ad;exports.pctEncChar=n;exports.pctDecChars=h;exports.Components=ag;exports.URI={SCHEMES:ad.SCHEMES,parse:ad.parse,removeDotSegments:ad.removeDotSegments,serialize:ad.serialize,resolveComponents:ad.resolveComponents,resolve:ad.resolve,normalize:ad.normalize,equal:ad.equal,escapeComponent:ad.escapeComponent,unescapeComponent:ad.unescapeComponent}}());(function(){var n=require("../uri"),l=n.URI,p=n.pctEncChar,b="(?:[0-9A-Za-z][0-9A-Za-z\\-]{1,31})",e="(?:\\%[0-9A-Fa-f]{2})",f="[0-9A-Za-z\\(\\)\\+\\,\\-\\.\\:\\=\\@\\;\\$\\_\\!\\*\\'\\/\\?\\#]",a="(?:(?:"+e+"|"+f+")+)",m=new RegExp("^urn\\:("+b+")$"),g=new RegExp("^("+b+")\\:("+a+")$"),c=/^([^\:]+)\:(.*)/,h=/[\x00-\x20\\\"\&\<\>\[\]\^\`\{\|\}\~\x7F-\xFF]/g,o=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/;l.SCHEMES.urn={parse:function(t,r){var u=t.path.match(g),q,s;if(!u){if(!r.tolerant){t.errors.push("URN is not strictly valid.")}u=t.path.match(c)}if(u){q="urn:"+u[1].toLowerCase();s=l.SCHEMES[q];if(!s){s=l.SCHEMES[q]={}}if(!s.serialize){s.serialize=l.SCHEMES.urn.serialize}t.scheme=q;t.path=u[2];if(s.parse){s.parse(t,r)}}else{t.errors.push("URN can not be parsed.")}return t},serialize:function(s,r){var q=s.scheme||r.scheme,t;if(q&&q!=="urn"){var t=q.match(m);if(!t){t=["urn:"+q,q]}s.scheme="urn";s.path=t[1]+":"+(s.path?s.path.replace(h,p):"")}return s}};l.SCHEMES["urn:uuid"]={serialize:function(r,q){if(!q.tolerant&&(!r.path||!r.path.match(o))){r.scheme=undefined}return l.SCHEMES.urn.serialize(r,q)}}}());var exports=exports||this,require=require||function(){return exports};(function(){var m=require("./uri/uri").URI,f={},E="0123456789abcdef".split(""),o,s,D,h;function e(F){return F===undefined?"undefined":(F===null?"null":Object.prototype.toString.call(F).split(" ").pop().split("]").shift().toLowerCase())}function p(){}function x(F){p.prototype=F||{};return new p()}function b(J,I,H){var F={},G;for(G in J){if(J[G]!==f[G]){F[G]=I.call(H,J[G],G,J)}}return F}o=function(G,J,I){var F=0,K=G.length,H=new Array(K);for(;F<K;++F){H[F]=J.call(I,G[F],F,G)}return H};if(Array.prototype.map){o=function(F,H,G){return Array.prototype.map.call(F,H,G)}}s=function(G,J,I){var F=0,K=G.length,H=[];for(;F<K;++F){if(J.call(I,G[F],F,G)){H[H.length]=G[F]}}return H};if(Array.prototype.filter){s=function(F,H,G){return Array.prototype.filter.call(F,H,G)}}D=function(G,H){var F=0,I=G.length;for(;F<I;++F){if(G[F]===H){return F}}return -1};if(Array.prototype.indexOf){D=function(F,G){return Array.prototype.indexOf.call(F,G)}}function z(F){return F!==undefined&&F!==null?(F instanceof Array&&!F.callee?F:(typeof F.length!=="number"||F.split||F.setInterval||F.call?[F]:Array.prototype.slice.call(F))):[]}function r(H){var F=[],G;switch(e(H)){case"object":for(G in H){if(H[G]!==f[G]){F[F.length]=G}}break;case"array":for(G=H.length-1;G>=0;--G){F[G]=G}break}return F}function g(F,G){if(D(F,G)===-1){F.push(G)}return F}function t(F,H){var G=D(F,H);if(G>-1){F.splice(G,1)}return F}function y(){return[E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],"-",E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],"-4",E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],"-",E[(Math.floor(Math.random()*16)&3)|8],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],"-",E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)],E[Math.floor(Math.random()*16)]].join("")}function B(F){return encodeURIComponent(F).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")}function a(F){if(typeof F==="string"&&F.indexOf("#")===-1){F+="#"}return F}function w(F){if(F instanceof A){return F.getURI()}switch(e(F)){case"undefined":case"null":case"boolean":case"number":case"string":return F;case"object":return b(F,w);case"array":return o(F,w);default:return F.toString()}}function c(G,J,F,I,H){Error.call(this,I);this.uri=G instanceof A?G.getURI():G;this.schemaUri=J instanceof A?J.getURI():J;this.attribute=F;this.message=I;this.description=I;this.details=H}c.prototype=new Error();c.prototype.constructor=c;c.prototype.name="InitializationError";function u(){this.errors=[];this.validated={}}u.prototype.addError=function(G,J,F,I,H){this.errors.push({uri:G instanceof A?G.getURI():G,schemaUri:J instanceof A?J.getURI():J,attribute:F,message:I,details:w(H)})};u.prototype.registerValidation=function(G,F){if(!this.validated[G]){this.validated[G]=[F]}else{this.validated[G].push(F)}};u.prototype.isValidatedBy=function(G,F){return !!this.validated[G]&&D(this.validated[G],F)!==-1};function A(H,G,I,F){if(G instanceof A){if(typeof F!=="string"){F=G._fd}if(typeof I!=="string"){I=G._uri}G=G._value}if(typeof I!=="string"){I="urn:uuid:"+y()+"#"}else{if(I.indexOf(":")===-1){I=a(m.resolve("urn:uuid:"+y()+"#",I))}}this._env=H;this._value=G;this._uri=I;this._fd=F||this._env._options.defaultFragmentDelimiter}A.prototype.getEnvironment=function(){return this._env};A.prototype.getType=function(){return e(this._value)};A.prototype.getValue=function(){return this._value};A.prototype.getURI=function(){return this._uri};A.prototype.resolveURI=function(F){return a(m.resolve(this._uri,F))};A.prototype.getPropertyNames=function(){return r(this._value)};A.prototype.getProperty=function(F){var G=this._value?this._value[F]:undefined;if(G instanceof A){return G}return new A(this._env,G,this._uri+this._fd+B(F),this._fd)};A.prototype.getProperties=function(){var G=e(this._value),F=this;if(G==="object"){return b(this._value,function(I,H){if(I instanceof A){return I}return new A(F._env,I,F._uri+F._fd+B(H),F._fd)})}else{if(G==="array"){return o(this._value,function(I,H){if(I instanceof A){return I}return new A(F._env,I,F._uri+F._fd+B(H),F._fd)})}}};A.prototype.getValueOfProperty=function(F){if(this._value){if(this._value[F] instanceof A){return this._value[F]._value}return this._value[F]}};A.prototype.equals=function(F){if(F instanceof A){return this._value===F._value}return this._value===F};function C(I,G){var H,F;if(I instanceof A){I=I.getValue()}switch(e(I)){case"object":if(G){H={};for(F in I){if(I[F]!==f[F]){H[F]=C(I[F],G)}}return H}else{return x(I)}break;case"array":if(G){H=new Array(I.length);F=I.length;while(--F>=0){H[F]=C(I[F],G)}return H}else{return Array.prototype.slice.call(I)}break;default:return I}}function v(H,G,J,I){var F;A.call(this,H,G,J);if(I===true){this._schema=this}else{if(G instanceof v&&!(I instanceof v)){this._schema=G._schema}else{this._schema=I instanceof v?I:this._env.getDefaultSchema()||this._env.createEmptySchema()}}F=this._schema.getValueOfProperty("fragmentResolution");if(F==="dot-delimited"){this._fd="."}else{if(F==="slash-delimited"){this._fd="/"}}return this.rebuild()}v.prototype=x(A.prototype);v.prototype.getSchema=function(){var F=this._refs&&this._refs.describedby,G;if(F){G=F&&this._env.findSchema(F);if(G){if(!G.equals(this._schema)){this._schema=G;this.rebuild()}}else{if(this._env._options.enforceReferences){throw new c(this,this._schema,"{describedby}","Unknown schema reference",F)}}}return this._schema};v.prototype.getAttribute=function(I,H){var G,L,K,F,J=this.getSchema();if(!H&&this._attributes&&this._attributes.hasOwnProperty(I)){return this._attributes[I]}G=J.getProperty("properties").getProperty(I);L=G.getValueOfProperty("parser");K=this.getProperty(I);if(typeof L==="function"){F=L(K,G,H);if(!H&&this._attributes){this._attributes[I]=F}return F}return K.getValue()};v.prototype.getAttributes=function(){var H,J,G,F,K,I=this.getSchema();if(!this._attributes&&this.getType()==="object"){H=this.getProperties();J=I.getProperty("properties");this._attributes={};for(G in H){if(H[G]!==f[G]){F=J&&J.getProperty(G);K=F&&F.getValueOfProperty("parser");if(typeof K==="function"){this._attributes[G]=K(H[G],F)}else{this._attributes[G]=H[G].getValue()}}}}return C(this._attributes,false)};v.prototype.getLink=function(G,F){var H=this.getAttribute("links",[G,F]);if(H&&H.length&&H[H.length-1]){return H[H.length-1]}};v.prototype.validate=function(F,H,K,L,I){var G=this.getSchema(),J=G.getValueOfProperty("validator");if(!(F instanceof A)){F=this.getEnvironment().createInstance(F)}if(!(H instanceof u)){H=new u()}if(this._env._options.validateReferences&&this._refs){if(this._refs.describedby&&!this._env.findSchema(this._refs.describedby)){H.addError(this,this._schema,"{describedby}","Unknown schema reference",this._refs.describedby)}if(this._refs.full&&!this._env.findSchema(this._refs.full)){H.addError(this,this._schema,"{full}","Unknown schema reference",this._refs.full)}}if(typeof J==="function"&&!H.isValidatedBy(F.getURI(),this.getURI())){H.registerValidation(F.getURI(),this.getURI());J(F,this,G,H,K,L,I)}return H};function l(G){return function F(){var I=this,H=[],K=I._refs&&I._refs.full,J;while(K){J=I._env.findSchema(K);if(J){if(J._value===I._value){break}I=J;H.push(K);K=I._refs&&I._refs.full;if(H.indexOf(K)>-1){break}}else{if(I._env._options.enforceReferences){throw new c(I,I._schema,"{full}","Unknown schema reference",K)}else{K=null}}}return G.apply(I,arguments)}}(function(){var F;for(F in v.prototype){if(v.prototype[F]!==f[F]&&e(v.prototype[F])==="function"){v.prototype[F]=l(v.prototype[F])}}}());v.prototype.rebuild=function(){var F=this,G=F.getSchema().getValueOfProperty("initializer");F._refs=null;F._attributes=null;if(typeof G==="function"){F=G(F)}F._env._schemas[F._uri]=F;F.getAttributes();return F};v.prototype.setReference=function(F,G){if(!this._refs){this._refs={}}this._refs[F]=this.resolveURI(G)};v.prototype.getReference=function(F){return this._refs&&this._refs[F]};function n(J,G,L){var I=e(J),H=e(G),K,F;if(H==="undefined"){return C(J,true)}else{if(I==="undefined"||H!==I){return C(G,true)}else{if(H==="object"){if(J instanceof v){J=J.getAttributes()}if(G instanceof v){G=G.getAttributes();if(G["extends"]&&L&&G["extends"] instanceof v){G["extends"]=[G["extends"]]}}K=C(J,true);for(F in G){if(G[F]!==f[F]){K[F]=n(J[F],G[F],L)}}return K}else{return C(G,true)}}}}function q(){this._id=y();this._schemas={};this._options={};this.createSchema({},true,"urn:jsv:empty-schema#")}q.prototype.clone=function(){var F=new q();F._schemas=x(this._schemas);F._options=x(this._options);return F};q.prototype.createInstance=function(G,F){F=a(F);if(G instanceof A&&(!F||G.getURI()===F)){return G}return new A(this,G,F)};q.prototype.createSchema=function(H,G,F){F=a(F);if(H instanceof v&&(!F||H._uri===F)&&(!G||H.getSchema().equals(G))){return H}return new v(this,H,F,G)};q.prototype.createEmptySchema=function(){return this._schemas["urn:jsv:empty-schema#"]};q.prototype.findSchema=function(F){return this._schemas[a(F)]};q.prototype.setOption=function(F,G){this._options[F]=G};q.prototype.getOption=function(F){return this._options[F]};q.prototype.setDefaultFragmentDelimiter=function(F){if(typeof F==="string"&&F.length>0){this._options.defaultFragmentDelimiter=F}};q.prototype.getDefaultFragmentDelimiter=function(){return this._options.defaultFragmentDelimiter};q.prototype.setDefaultSchemaURI=function(F){if(typeof F==="string"){this._options.defaultSchemaURI=a(F)}};q.prototype.getDefaultSchema=function(){return this.findSchema(this._options.defaultSchemaURI)};q.prototype.validate=function(M,L){var F,I,H,G=new u();try{F=this.createInstance(M);G.instance=F}catch(K){G.addError(K.uri,K.schemaUri,K.attribute,K.message,K.details)}try{I=this.createSchema(L);G.schema=I;H=I.getSchema();G.schemaSchema=H}catch(J){G.addError(J.uri,J.schemaUri,J.attribute,J.message,J.details)}if(H){H.validate(I,G)}if(G.errors.length){return G}return I.validate(F,G)};q.prototype._checkForInvalidInstances=function(L,H){var O=[],J=[[H,this._schemas[H]]],F=0,N,G,M,I,K;while(F++<L&&J.length){N=J.shift();G=N[0];M=N[1];if(M instanceof v){if(this._schemas[M._uri]!==M){O.push("Instance "+G+" does not match "+M._uri)}else{I=M.getAttributes();for(K in I){if(I[K]!==f[K]){J.push([G+"/"+B(K),I[K]])}}}}else{if(e(M)==="object"){I=M;for(K in I){if(I.hasOwnProperty(K)){J.push([G+"/"+B(K),I[K]])}}}else{if(e(M)==="array"){I=M;for(K=0;K<I.length;++K){J.push([G+"/"+B(K),I[K]])}}}}}return O.length?O:F};h={_environments:{},_defaultEnvironmentID:"",isJSONInstance:function(F){return F instanceof A},isJSONSchema:function(F){return F instanceof v},createEnvironment:function(F){F=F||this._defaultEnvironmentID;if(!this._environments[F]){throw new Error("Unknown Environment ID")}return this._environments[F].clone()},Environment:q,registerEnvironment:function(G,F){G=G||(F||0)._id;if(G&&!this._environments[G]&&F instanceof q){F._id=G;this._environments[G]=F}},setDefaultEnvironmentID:function(F){if(typeof F==="string"){if(!this._environments[F]){throw new Error("Unknown Environment ID")}this._defaultEnvironmentID=F}},getDefaultEnvironmentID:function(){return this._defaultEnvironmentID},typeOf:e,createObject:x,mapObject:b,mapArray:o,filterArray:s,searchArray:D,toArray:z,keys:r,pushUnique:g,popFirst:t,clone:C,randomUUID:y,escapeURIComponent:B,formatURI:a,inherits:n,InitializationError:c};this.JSV=h;exports.JSV=h;require("./environments")}());(function(){var n={},p=require("./jsv").JSV,G,w,l,A,m,f,c,z,o,B,q,e,b,y,r,D,s,a,F,v,t,g,x,E,C,u;G={string:function(H,I){return H.getType()==="string"},number:function(H,I){return H.getType()==="number"},integer:function(H,I){return H.getType()==="number"&&H.getValue()%1===0},"boolean":function(H,I){return H.getType()==="boolean"},object:function(H,I){return H.getType()==="object"},array:function(H,I){return H.getType()==="array"},"null":function(H,I){return H.getType()==="null"},any:function(H,I){return true}};w=new p.Environment();w.setOption("validateReferences",true);w.setOption("enforceReferences",false);w.setOption("strict",false);l={"$schema":"http://json-schema.org/draft-00/hyper-schema#",id:"http://json-schema.org/draft-00/schema#",type:"object",properties:{type:{type:["string","array"],items:{type:["string",{"$ref":"#"}]},optional:true,uniqueItems:true,"default":"any",parser:function(H,I){var J;if(H.getType()==="string"){return H.getValue()}else{if(H.getType()==="object"){return H.getEnvironment().createSchema(H,I.getEnvironment().findSchema(I.resolveURI("#")))}else{if(H.getType()==="array"){J=I.getValueOfProperty("parser");return p.mapArray(H.getProperties(),function(K){return J(K,I)})}}}return"any"},validator:function(R,K,S,M,Q,T,H){var I=p.toArray(K.getAttribute("type")),P,N,O,L,J;if(R.getType()!=="undefined"&&I&&I.length){J=S.getValueOfProperty("typeValidators")||{};for(P=0,N=I.length;P<N;++P){O=I[P];if(p.isJSONSchema(O)){L=p.createObject(M);L.errors=[];L.validated=p.clone(M.validated);if(O.validate(R,L,Q,T,H).errors.length===0){return true}}else{if(J[O]!==n[O]&&typeof J[O]==="function"){if(J[O](R,M)){return true}}else{return true}}}M.addError(R,K,"type","Instance is not a required type",I);return false}return true},typeValidators:G},properties:{type:"object",additionalProperties:{"$ref":"#"},optional:true,"default":{},parser:function(I,J,H){var K=I.getEnvironment(),L=J.getEnvironment();if(I.getType()==="object"){if(H){return K.createSchema(I.getProperty(H),L.findSchema(J.resolveURI("#")))}else{return p.mapObject(I.getProperties(),function(M){return K.createSchema(M,L.findSchema(J.resolveURI("#")))})}}return{}},validator:function(N,J,O,K,L,P,H){var I,M;if(N.getType()==="object"){I=J.getAttribute("properties");for(M in I){if(I[M]!==n[M]&&I[M]){I[M].validate(N.getProperty(M),K,N,J,M)}}}}},items:{type:[{"$ref":"#"},"array"],items:{"$ref":"#"},optional:true,"default":{},parser:function(H,I){if(H.getType()==="object"){return H.getEnvironment().createSchema(H,I.getEnvironment().findSchema(I.resolveURI("#")))}else{if(H.getType()==="array"){return p.mapArray(H.getProperties(),function(J){return J.getEnvironment().createSchema(J,I.getEnvironment().findSchema(I.resolveURI("#")))})}}return H.getEnvironment().createEmptySchema()},validator:function(R,I,S,J,Q,T,H){var N,M,P,K,O,L;if(R.getType()==="array"){N=R.getProperties();M=I.getAttribute("items");L=I.getAttribute("additionalProperties");if(p.typeOf(M)==="array"){for(P=0,K=N.length;P<K;++P){O=M[P]||L;if(O!==false){O.validate(N[P],J,R,I,P)}else{J.addError(R,I,"additionalProperties","Additional items are not allowed",O)}}}else{O=M||L;for(P=0,K=N.length;P<K;++P){O.validate(N[P],J,R,I,P)}}}}},optional:{type:"boolean",optional:true,"default":false,parser:function(H,I){return !!H.getValue()},validator:function(H,M,J,I,L,N,K){if(H.getType()==="undefined"&&!M.getAttribute("optional")){I.addError(H,M,"optional","Property is required",false)}},validationRequired:true},additionalProperties:{type:[{"$ref":"#"},"boolean"],optional:true,"default":{},parser:function(H,I){if(H.getType()==="object"){return H.getEnvironment().createSchema(H,I.getEnvironment().findSchema(I.resolveURI("#")))}else{if(H.getType()==="boolean"&&H.getValue()===false){return false}}return H.getEnvironment().createEmptySchema()},validator:function(P,J,Q,K,N,R,H){var L,I,M,O;if(P.getType()==="object"){L=J.getAttribute("additionalProperties");I=J.getAttribute("properties")||{};M=P.getProperties();for(O in M){if(M[O]!==n[O]&&M[O]&&I[O]===n[O]){if(p.isJSONSchema(L)){L.validate(M[O],K,P,J,O)}else{if(L===false){K.addError(P,J,"additionalProperties","Additional properties are not allowed",L)}}}}}}},requires:{type:["string",{"$ref":"#"}],optional:true,parser:function(H,I){if(H.getType()==="string"){return H.getValue()}else{if(H.getType()==="object"){return H.getEnvironment().createSchema(H,I.getEnvironment().findSchema(I.resolveURI("#")))}}},validator:function(H,N,J,I,M,O,K){var L;if(H.getType()!=="undefined"&&M&&M.getType()!=="undefined"){L=N.getAttribute("requires");if(typeof L==="string"){if(M.getProperty(L).getType()==="undefined"){I.addError(H,N,"requires",'Property requires sibling property "'+L+'"',L)}}else{if(p.isJSONSchema(L)){L.validate(M,I)}}}}},minimum:{type:"number",optional:true,parser:function(H,I){if(H.getType()==="number"){return H.getValue()}},validator:function(N,I,O,J,L,P,H){var K,M;if(N.getType()==="number"){K=I.getAttribute("minimum");M=I.getAttribute("minimumCanEqual");if(typeof K==="number"&&(N.getValue()<K||(M===false&&N.getValue()===K))){J.addError(N,I,"minimum","Number is less than the required minimum value",K)}}}},maximum:{type:"number",optional:true,parser:function(H,I){if(H.getType()==="number"){return H.getValue()}},validator:function(N,J,O,L,M,P,H){var I,K;if(N.getType()==="number"){I=J.getAttribute("maximum");K=J.getAttribute("maximumCanEqual");if(typeof I==="number"&&(N.getValue()>I||(K===false&&N.getValue()===I))){L.addError(N,J,"maximum","Number is greater than the required maximum value",I)}}}},minimumCanEqual:{type:"boolean",optional:true,requires:"minimum","default":true,parser:function(H,I){if(H.getType()==="boolean"){return H.getValue()}return true}},maximumCanEqual:{type:"boolean",optional:true,requires:"maximum","default":true,parser:function(H,I){if(H.getType()==="boolean"){return H.getValue()}return true}},minItems:{type:"integer",optional:true,minimum:0,"default":0,parser:function(H,I){if(H.getType()==="number"){return H.getValue()}return 0},validator:function(H,N,K,I,M,O,L){var J;if(H.getType()==="array"){J=N.getAttribute("minItems");if(typeof J==="number"&&H.getProperties().length<J){I.addError(H,N,"minItems","The number of items is less than the required minimum",J)}}}},maxItems:{type:"integer",optional:true,minimum:0,parser:function(H,I){if(H.getType()==="number"){return H.getValue()}},validator:function(H,N,J,I,M,O,L){var K;if(H.getType()==="array"){K=N.getAttribute("maxItems");if(typeof K==="number"&&H.getProperties().length>K){I.addError(H,N,"maxItems","The number of items is greater than the required maximum",K)}}}},pattern:{type:"string",optional:true,format:"regex",parser:function(H,I){if(H.getType()==="string"){return H.getValue()}},validator:function(N,I,O,J,M,P,H){var L;try{L=new RegExp(I.getAttribute("pattern"));if(N.getType()==="string"&&L&&!L.test(N.getValue())){J.addError(N,I,"pattern","String does not match pattern",L.toString())}}catch(K){J.addError(I,O,"pattern","Invalid pattern",I.getValueOfProperty("pattern"))}}},minLength:{type:"integer",optional:true,minimum:0,"default":0,parser:function(H,I){if(H.getType()==="number"){return H.getValue()}return 0},validator:function(H,N,K,I,M,O,L){var J;if(H.getType()==="string"){J=N.getAttribute("minLength");if(typeof J==="number"&&H.getValue().length<J){I.addError(H,N,"minLength","String is less than the required minimum length",J)}}}},maxLength:{type:"integer",optional:true,parser:function(H,I){if(H.getType()==="number"){return H.getValue()}},validator:function(H,N,K,J,M,O,L){var I;if(H.getType()==="string"){I=N.getAttribute("maxLength");if(typeof I==="number"&&H.getValue().length>I){J.addError(H,N,"maxLength","String is greater than the required maximum length",I)}}}},"enum":{type:"array",optional:true,minItems:1,uniqueItems:true,parser:function(H,I){if(H.getType()==="array"){return H.getValue()}},validator:function(O,J,P,K,N,Q,I){var H,M,L;if(O.getType()!=="undefined"){H=J.getAttribute("enum");if(H){for(M=0,L=H.length;M<L;++M){if(O.equals(H[M])){return true}}K.addError(O,J,"enum","Instance is not one of the possible values",H)}}}},title:{type:"string",optional:true},description:{type:"string",optional:true},format:{type:"string",optional:true,parser:function(H,I){if(H.getType()==="string"){return H.getValue()}},validator:function(N,I,O,J,L,P,H){var K,M;if(N.getType()==="string"){K=I.getAttribute("format");M=O.getValueOfProperty("formatValidators");if(typeof K==="string"&&M[K]!==n[K]&&typeof M[K]==="function"&&!M[K].call(this,N,J)){J.addError(N,I,"format","String is not in the required format",K)}}},formatValidators:{}},contentEncoding:{type:"string",optional:true},"default":{type:"any",optional:true},maxDecimal:{type:"integer",optional:true,minimum:0,parser:function(H,I){if(H.getType()==="number"){return H.getValue()}},validator:function(N,J,O,L,M,P,H){var K,I;if(N.getType()==="number"){K=J.getAttribute("maxDecimal");if(typeof K==="number"){I=N.getValue().toString(10).split(".")[1];if(I&&I.length>K){L.addError(N,J,"maxDecimal","The number of decimal places is greater than the allowed maximum",K)}}}}},disallow:{type:["string","array"],items:{type:"string"},optional:true,uniqueItems:true,parser:function(H,I){if(H.getType()==="string"||H.getType()==="array"){return H.getValue()}},validator:function(R,J,S,L,P,T,H){var N=p.toArray(J.getAttribute("disallow")),O,M,Q,I,K;if(R.getType()!=="undefined"&&N&&N.length){I=S.getValueOfProperty("typeValidators")||{};for(O=0,M=N.length;O<M;++O){Q=N[O];if(p.isJSONSchema(Q)){K=p.createObject(L);K.errors=[];K.validated=p.clone(L.validated);if(Q.validate(R,K,P,T,H).errors.length===0){L.addError(R,J,"disallow","Instance is a disallowed type",N);return false}}else{if(I[Q]!==n[Q]&&typeof I[Q]==="function"){if(I[Q](R,L)){L.addError(R,J,"disallow","Instance is a disallowed type",N);return false}}}}return true}return true},typeValidators:G},"extends":{type:[{"$ref":"#"},"array"],items:{"$ref":"#"},optional:true,"default":{},parser:function(H,I){if(H.getType()==="object"){return H.getEnvironment().createSchema(H,I.getEnvironment().findSchema(I.resolveURI("#")))}else{if(H.getType()==="array"){return p.mapArray(H.getProperties(),function(J){return J.getEnvironment().createSchema(J,I.getEnvironment().findSchema(I.resolveURI("#")))})}}},validator:function(O,I,P,J,N,Q,H){var L=I.getAttribute("extends"),M,K;if(L){if(p.isJSONSchema(L)){L.validate(O,J,N,Q,H)}else{if(p.typeOf(L)==="array"){for(M=0,K=L.length;M<K;++M){L[M].validate(O,J,N,Q,H)}}}}}}},optional:true,"default":{},fragmentResolution:"dot-delimited",parser:function(H,I){if(H.getType()==="object"){return H.getEnvironment().createSchema(H,I)}},validator:function(Q,J,R,K,P,S,I){var T=J.getPropertyNames(),O,L,M=R.getAttribute("properties"),N=Q.getEnvironment().getOption("strict"),H;for(O in M){if(M[O]!==n[O]){if(M[O].getValueOfProperty("validationRequired")){p.pushUnique(T,O)}if(N&&M[O].getValueOfProperty("deprecated")){p.popFirst(T,O)}}}for(O=0,L=T.length;O<L;++O){if(M[T[O]]!==n[T[O]]){H=M[T[O]].getValueOfProperty("validator");if(typeof H==="function"){H(Q,J,M[T[O]],K,P,S,I)}}}}};A={"$schema":"http://json-schema.org/draft-00/hyper-schema#",id:"http://json-schema.org/draft-00/hyper-schema#",properties:{links:{type:"array",items:{"$ref":"links#"},optional:true,parser:function(K,N,J){var M,I=N.getValueOfProperty("items")["$ref"],O=N.getEnvironment().findSchema(I),H=O&&O.getValueOfProperty("parser"),L;J=p.toArray(J);if(typeof H==="function"){M=p.mapArray(K.getProperties(),function(P){return H(P,O)})}else{M=p.toArray(K.getValue())}if(J[0]){M=p.filterArray(M,function(P){return P.rel===J[0]})}if(J[1]){L=N.getValueOfProperty("selfReferenceVariable");M=p.mapArray(M,function(R){var P=J[1],Q=R.href;Q=Q.replace(/\{(.+)\}/g,function(W,V,U,S){var T;if(V===L){T=P.getValue()}else{T=P.getValueOfProperty(V)}return T!==undefined?String(T):""});return Q?p.formatURI(P.resolveURI(Q)):Q})}return M},selfReferenceVariable:"-this"},fragmentResolution:{type:"string",optional:true,"default":"dot-delimited"},root:{type:"boolean",optional:true,"default":false},readonly:{type:"boolean",optional:true,"default":false},pathStart:{type:"string",optional:true,format:"uri",validator:function(H,M,J,I,L,O,K){var N;if(H.getType()!=="undefined"){N=M.getAttribute("pathStart");if(typeof N==="string"){if(H.getURI().indexOf(N)!==0){I.addError(H,M,"pathStart","Instance's URI does not start with "+N,N)}}}}},mediaType:{type:"string",optional:true,format:"media-type"},alternate:{type:"array",items:{"$ref":"#"},optional:true}},links:[{href:"{$ref}",rel:"full"},{href:"{$schema}",rel:"describedby"},{href:"{id}",rel:"self"}],initializer:function(I){var J,K,H;J=I._schema.getLink("describedby",I);if(J&&I._schema._uri!==J){I.setReference("describedby",J)}J=I._schema.getLink("self",I);if(p.typeOf(J)==="string"){I._uri=p.formatURI(J)}J=I._schema.getLink("full",I);if(J&&I._uri!==J){I.setReference("full",J)}K=I.getAttribute("extends");if(p.isJSONSchema(K)){H=p.inherits(K,I,true);I=I._env.createSchema(H,I._schema,I._uri)}return I}};m={"$schema":"http://json-schema.org/draft-00/hyper-schema#",id:"http://json-schema.org/draft-00/links#",type:"object",properties:{href:{type:"string"},rel:{type:"string"},method:{type:"string","default":"GET",optional:true},enctype:{type:"string",requires:"method",optional:true},properties:{type:"object",additionalProperties:{"$ref":"hyper-schema#"},optional:true,parser:function(J,K,I){var L=J.getEnvironment(),M=K.getEnvironment(),H=K.getValueOfProperty("additionalProperties")["$ref"];if(J.getType()==="object"){if(I){return L.createSchema(J.getProperty(I),M.findSchema(K.resolveURI(H)))}else{return p.mapObject(J.getProperties(),function(N){return L.createSchema(N,M.findSchema(K.resolveURI(H)))})}}}}},parser:function(H,J){var I=J.getProperty("properties");if(H.getType()==="object"){return p.mapObject(H.getProperties(),function(M,L){var K=I.getProperty(L),N=K&&K.getValueOfProperty("parser");if(typeof N==="function"){return N(M,K)}return M.getValue()})}return H.getValue()}};w.setOption("defaultFragmentDelimiter",".");w.setOption("defaultSchemaURI","http://json-schema.org/draft-00/schema#");f=w.createSchema(l,true,"http://json-schema.org/draft-00/schema#");c=w.createSchema(p.inherits(f,w.createSchema(A,true,"http://json-schema.org/draft-00/hyper-schema#"),true),true,"http://json-schema.org/draft-00/hyper-schema#");w.setOption("defaultSchemaURI","http://json-schema.org/draft-00/hyper-schema#");z=w.createSchema(m,c,"http://json-schema.org/draft-00/links#");o=p.inherits(l,{"$schema":"http://json-schema.org/draft-01/hyper-schema#",id:"http://json-schema.org/draft-01/schema#"});B=p.inherits(A,{"$schema":"http://json-schema.org/draft-01/hyper-schema#",id:"http://json-schema.org/draft-01/hyper-schema#"});q=p.inherits(m,{"$schema":"http://json-schema.org/draft-01/hyper-schema#",id:"http://json-schema.org/draft-01/links#"});w.setOption("defaultSchemaURI","http://json-schema.org/draft-01/schema#");e=w.createSchema(o,true,"http://json-schema.org/draft-01/schema#");b=w.createSchema(p.inherits(e,w.createSchema(B,true,"http://json-schema.org/draft-01/hyper-schema#"),true),true,"http://json-schema.org/draft-01/hyper-schema#");w.setOption("defaultSchemaURI","http://json-schema.org/draft-01/hyper-schema#");y=w.createSchema(q,b,"http://json-schema.org/draft-01/links#");r=p.inherits(o,{"$schema":"http://json-schema.org/draft-02/hyper-schema#",id:"http://json-schema.org/draft-02/schema#",properties:{uniqueItems:{type:"boolean",optional:true,"default":false,parser:function(H,I){return !!H.getValue()},validator:function(Q,J,R,K,P,S,H){var O,N,L,M,I;if(Q.getType()==="array"&&J.getAttribute("uniqueItems")){O=Q.getProperties();for(N=0,L=O.length-1;N<L;++N){for(M=N+1,I=O.length;M<I;++M){if(O[N].equals(O[M])){K.addError(Q,J,"uniqueItems","Array can only contain unique items",{x:N,y:M})}}}}}},maxDecimal:{deprecated:true},divisibleBy:{type:"number",minimum:0,minimumCanEqual:false,optional:true,parser:function(H,I){if(H.getType()==="number"){return H.getValue()}},validator:function(O,K,P,L,N,Q,H){var J,M,I;if(O.getType()==="number"){J=K.getAttribute("divisibleBy");if(J===0){L.addError(O,K,"divisibleBy","Nothing is divisible by 0",J)}else{if(J!==1){M=O.getValue();I=Math.max((M.toString().split(".")[1]||" ").length,(J.toString().split(".")[1]||" ").length);I=parseFloat(((M/J)%1).toFixed(I));if(0<I&&I<1){L.addError(O,K,"divisibleBy","Number is not divisible by "+J,J)}}}}}}},fragmentResolution:"slash-delimited"});D=p.inherits(B,{id:"http://json-schema.org/draft-02/hyper-schema#",properties:{fragmentResolution:{"default":"slash-delimited"}}});s=p.inherits(q,{"$schema":"http://json-schema.org/draft-02/hyper-schema#",id:"http://json-schema.org/draft-02/links#",properties:{targetSchema:{"$ref":"hyper-schema#",parser:b.getAttribute("parser")}}});w.setOption("defaultFragmentDelimiter","/");w.setOption("defaultSchemaURI","http://json-schema.org/draft-02/schema#");a=w.createSchema(r,true,"http://json-schema.org/draft-02/schema#");F=w.createSchema(p.inherits(a,w.createSchema(D,true,"http://json-schema.org/draft-02/hyper-schema#"),true),true,"http://json-schema.org/draft-02/hyper-schema#");w.setOption("defaultSchemaURI","http://json-schema.org/draft-02/hyper-schema#");v=w.createSchema(s,F,"http://json-schema.org/draft-02/links#");function h(Q,H,I,R){var J={},O,M,N,L,P;if(Q.getType()==="object"){O=H.getAttribute("patternProperties");L=Q.getProperties();for(M in O){if(O[M]!==n[M]){N=null;try{N=new RegExp(M)}catch(K){if(I){I.addError(H,R,"patternProperties","Invalid pattern",M)}}if(N){for(P in L){if(L[P]!==n[P]&&N.test(P)){J[P]=J[P]?p.pushUnique(J[P],O[M]):[O[M]]}}}}}}return J}t=p.inherits(r,{"$schema":"http://json-schema.org/draft-03/schema#",id:"http://json-schema.org/draft-03/schema#",properties:{patternProperties:{type:"object",additionalProperties:{"$ref":"#"},"default":{},parser:a.getValueOfProperty("properties")["properties"]["parser"],validator:function(O,I,P,J,M,Q,H){var K,N,L;if(O.getType()==="object"){K=h(O,I,J,P);for(N in K){if(K[N]!==n[N]){L=K[N].length;while(L--){K[N][L].validate(O.getProperty(N),J,O,I,N)}}}}}},additionalProperties:{validator:function(Q,J,R,K,O,S,H){var M,I,N,L,P;if(Q.getType()==="object"){M=J.getAttribute("additionalProperties");I=J.getAttribute("properties")||{};N=Q.getProperties();L=h(Q,J);for(P in N){if(N[P]!==n[P]&&N[P]&&I[P]===n[P]&&L[P]===n[P]){if(p.isJSONSchema(M)){M.validate(N[P],K,Q,J,P)}else{if(M===false){K.addError(Q,J,"additionalProperties","Additional properties are not allowed",M)}}}}}}},items:{validator:function(R,J,S,K,Q,T,I){var N,M,P,L,O,H;if(R.getType()==="array"){N=R.getProperties();M=J.getAttribute("items");H=J.getAttribute("additionalItems");if(p.typeOf(M)==="array"){for(P=0,L=N.length;P<L;++P){O=M[P]||H;if(O!==false){O.validate(N[P],K,R,J,P)}else{K.addError(R,J,"additionalItems","Additional items are not allowed",O)}}}else{O=M||H;for(P=0,L=N.length;P<L;++P){O.validate(N[P],K,R,J,P)}}}}},additionalItems:{type:[{"$ref":"#"},"boolean"],"default":{},parser:a.getValueOfProperty("properties")["additionalProperties"]["parser"],validator:function(P,J,Q,K,O,R,I){var H,M,N,L;if(P.getType()==="array"&&J.getProperty("items").getType()==="undefined"){H=J.getAttribute("additionalItems");M=P.getProperties();if(H!==false){for(N=0,L=M.length;N<L;++N){H.validate(M[N],K,P,J,N)}}else{if(M.length){K.addError(P,J,"additionalItems","Additional items are not allowed",H)}}}}},optional:{validationRequired:false,deprecated:true},required:{type:"boolean","default":false,parser:function(H,I){return !!H.getValue()},validator:function(H,M,J,I,L,N,K){if(H.getType()==="undefined"&&M.getAttribute("required")){I.addError(H,M,"required","Property is required",true)}}},requires:{deprecated:true},dependencies:{type:"object",additionalProperties:{type:["string","array",{"$ref":"#"}],items:{type:"string"}},"default":{},parser:function(I,J,H){function K(M){var L=M.getType();if(L==="string"||L==="array"){return M.getValue()}else{if(L==="object"){return M.getEnvironment().createSchema(M,J.getEnvironment().findSchema(J.resolveURI("#")))}}}if(I.getType()==="object"){if(H){return K(I.getProperty(H))}else{return p.mapObject(I.getProperties(),K)}}return{}},validator:function(R,J,S,K,P,T,H){var M,Q,I,N,O,L;if(R.getType()==="object"){M=J.getAttribute("dependencies");for(Q in M){if(M[Q]!==n[Q]&&R.getProperty(Q).getType()!=="undefined"){I=M[Q];N=p.typeOf(I);if(N==="string"){if(R.getProperty(I).getType()==="undefined"){K.addError(R,J,"dependencies",'Property "'+Q+'" requires sibling property "'+I+'"',M)}}else{if(N==="array"){for(O=0,L=I.length;O<L;++O){if(R.getProperty(I[O]).getType()==="undefined"){K.addError(R,J,"dependencies",'Property "'+Q+'" requires sibling property "'+I[O]+'"',M)}}}else{if(p.isJSONSchema(I)){I.validate(R,K)}}}}}}}},minimumCanEqual:{deprecated:true},maximumCanEqual:{deprecated:true},exclusiveMinimum:{type:"boolean","default":false,parser:function(H,I){return !!H.getValue()}},exclusiveMaximum:{type:"boolean","default":false,parser:function(H,I){return !!H.getValue()}},minimum:{validator:function(N,I,O,J,M,P,H){var K,L;if(N.getType()==="number"){K=I.getAttribute("minimum");L=I.getAttribute("exclusiveMinimum")||(!N.getEnvironment().getOption("strict")&&!I.getAttribute("minimumCanEqual"));if(typeof K==="number"&&(N.getValue()<K||(L===true&&N.getValue()===K))){J.addError(N,I,"minimum","Number is less than the required minimum value",K)}}}},maximum:{validator:function(N,J,O,K,M,P,H){var I,L;if(N.getType()==="number"){I=J.getAttribute("maximum");L=J.getAttribute("exclusiveMaximum")||(!N.getEnvironment().getOption("strict")&&!J.getAttribute("maximumCanEqual"));if(typeof I==="number"&&(N.getValue()>I||(L===true&&N.getValue()===I))){K.addError(N,J,"maximum","Number is greater than the required maximum value",I)}}}},contentEncoding:{deprecated:true},divisibleBy:{exclusiveMinimum:true},disallow:{items:{type:["string",{"$ref":"#"}]},parser:r.properties["type"]["parser"]},id:{type:"string",format:"uri"},"$ref":{type:"string",format:"uri"},"$schema":{type:"string",format:"uri"}},dependencies:{exclusiveMinimum:"minimum",exclusiveMaximum:"maximum"},initializer:function(I){var M,N,H,K=I.getValueOfProperty("$schema"),J=I.getValueOfProperty("$ref"),L=I.getValueOfProperty("id");if(K){M=I.resolveURI(K);I.setReference("describedby",M)}if(L){M=I.resolveURI(L);if(p.typeOf(M)==="string"){I._uri=p.formatURI(M)}}if(J){M=I.resolveURI(J);I.setReference("full",M)}N=I.getAttribute("extends");if(p.isJSONSchema(N)){H=p.inherits(N,I,true);I=I._env.createSchema(H,I._schema,I._uri)}return I}});g=p.inherits(D,{"$schema":"http://json-schema.org/draft-03/hyper-schema#",id:"http://json-schema.org/draft-03/hyper-schema#",properties:{links:{selfReferenceVariable:"@"},root:{deprecated:true},contentEncoding:{deprecated:false},alternate:{deprecated:true}}});x=p.inherits(s,{"$schema":"http://json-schema.org/draft-03/hyper-schema#",id:"http://json-schema.org/draft-03/links#",properties:{href:{required:true,format:"link-description-object-template"},rel:{required:true},properties:{deprecated:true},schema:{"$ref":"http://json-schema.org/draft-03/hyper-schema#"}}});w.setOption("defaultSchemaURI","http://json-schema.org/draft-03/schema#");E=w.createSchema(t,true,"http://json-schema.org/draft-03/schema#");C=w.createSchema(p.inherits(E,w.createSchema(g,true,"http://json-schema.org/draft-03/hyper-schema#"),true),true,"http://json-schema.org/draft-03/hyper-schema#");w.setOption("defaultSchemaURI","http://json-schema.org/draft-03/hyper-schema#");u=w.createSchema(x,true,"http://json-schema.org/draft-03/links#");w.setOption("latestJSONSchemaSchemaURI","http://json-schema.org/draft-03/schema#");w.setOption("latestJSONSchemaHyperSchemaURI","http://json-schema.org/draft-03/hyper-schema#");w.setOption("latestJSONSchemaLinksURI","http://json-schema.org/draft-03/links#");w._schemas["http://json-schema.org/schema#"]=E;w._schemas["http://json-schema.org/hyper-schema#"]=C;w._schemas["http://json-schema.org/links#"]=u;p.registerEnvironment("json-schema-draft-03",w);if(!p.getDefaultEnvironmentID()||p.getDefaultEnvironmentID()==="json-schema-draft-01"||p.getDefaultEnvironmentID()==="json-schema-draft-02"){p.setDefaultEnvironmentID("json-schema-draft-03")}}());(function(g){var p,C="",w=Math.PI,l=w/2,n="ontouchstart" in window,c=(n)?{start:"touchstart",move:"touchmove",end:"touchend"}:{start:"mousedown",move:"mousemove",end:"mouseup"},x={backward:["bl","tl"],forward:["br","tr"],all:["tl","bl","tr","br"]},m=["single","double"],f={page:1,gradients:true,duration:600,acceleration:true,display:"double",when:null},a={folding:null,corners:"forward",cornerSize:100,gradients:true,duration:600,acceleration:true},B=6,v={0:{top:0,left:0,right:"auto",bottom:"auto"},1:{top:0,right:0,left:"auto",bottom:"auto"}},t=function(G,F,H,E){return{css:{position:"absolute",top:G,left:F,overflow:E||"hidden","z-index":H||"auto"}}},r=function(K,J,I,H,G){var E=1-G,F=E*E*E,L=G*G*G;return h(Math.round(F*K.x+3*G*E*E*J.x+3*G*G*E*I.x+L*H.x),Math.round(F*K.y+3*G*E*E*J.y+3*G*G*E*I.y+L*H.y))},D=function(E){return E/180*w},s=function(E){return E/w*180},h=function(E,F){return{x:E,y:F}},q=function(E,G,F){return(p&&F)?" translate3d("+E+"px,"+G+"px, 0px) ":" translate("+E+"px, "+G+"px) "},z=function(E){return" rotate("+E+"deg) "},e=function(F,E){return Object.prototype.hasOwnProperty.call(E,F)},u=function(){var F=["Moz","Webkit","Khtml","O","ms"],E=F.length,G="";while(E--){if((F[E]+"Transform") in document.body.style){G="-"+F[E].toLowerCase()+"-"}}return G},b=function(Q,G,F,L,R){var U,O=[];if(C=="-webkit-"){for(U=0;U<R;U++){O.push("color-stop("+L[U][0]+", "+L[U][1]+")")}Q.css({"background-image":"-webkit-gradient(linear, "+G.x+"% "+G.y+"%,  "+F.x+"% "+F.y+"%, "+O.join(",")+" )"})}else{G={x:G.x/100*Q.width(),y:G.y/100*Q.height()};F={x:F.x/100*Q.width(),y:F.y/100*Q.height()};var P=F.x-G.x,N=F.y-G.y,V=Math.atan2(N,P),H=V-Math.PI/2,T=Math.abs(Q.width()*Math.sin(H))+Math.abs(Q.height()*Math.cos(H)),E=Math.sqrt(N*N+P*P),J=h((F.x<G.x)?Q.width():0,(F.y<G.y)?Q.height():0),K=Math.tan(V),I=-1/K,M=(I*J.x-J.y-K*G.x+G.y)/(I-K),W={x:M,y:I*M-I*J.x+J.y},S=(Math.sqrt(Math.pow(W.x-G.x,2)+Math.pow(W.y-G.y,2)));for(U=0;U<R;U++){O.push(" "+L[U][1]+" "+((S+E*L[U][0])*100/T)+"%")}Q.css({"background-image":C+"linear-gradient("+(-V)+"rad,"+O.join(",")+")"})}},A={init:function(G){if(p===undefined){p="WebKitCSSMatrix" in window||"MozPerspective" in document.body.style;C=u()}var E,H=this.data(),F=this.children();G=g.extend({width:this.width(),height:this.height()},f,G);H.opts=G;H.pageObjs={};H.pages={};H.pageWrap={};H.pagePlace={};H.pageMv=[];H.totalPages=G.pages||0;if(G.when){for(E in G.when){if(e(E,G.when)){this.bind(E,G.when[E])}}}this.css({position:"relative",width:G.width,height:G.height});this.turn("display",G.display);if(p&&!n&&G.acceleration){this.transform(q(0,0,true))}for(E=0;E<F.length;E++){this.turn("addPage",F[E],E+1)}this.turn("page",G.page);x=g.extend({},x,G.corners);g(this).bind(c.start,function(J){for(var I in H.pages){if(e(I,H.pages)&&y._eventStart.call(H.pages[I],J)===false){return false}}});g(document).bind(c.move,function(J){for(var I in H.pages){if(e(I,H.pages)){y._eventMove.call(H.pages[I],J)}}}).bind(c.end,function(J){for(var I in H.pages){if(e(I,H.pages)){y._eventEnd.call(H.pages[I],J)}}});H.done=true;return this},addPage:function(E,I){var F=false,H=this.data(),G=H.totalPages+1;if(I){if(I==G){I=G;F=true}else{if(I>G){throw new Error('It is impossible to add the page "'+I+'", the maximum value is: "'+G+'"')}}}else{I=G;F=true}if(I>=1&&I<=G){if(H.done){this.turn("stop")}if(I in H.pageObjs){A._movePages.call(this,I,1)}if(F){H.totalPages=G}H.pageObjs[I]=g(E).addClass("turn-page p"+I);A._addPage.call(this,I);if(H.done){this.turn("update")}A._removeFromDOM.call(this)}return this},_addPage:function(I){var H=this.data(),F=H.pageObjs[I];if(F){if(A._necessPage.call(this,I)){if(!H.pageWrap[I]){var E=(H.display=="double")?this.width()/2:this.width(),G=this.height();F.css({width:E,height:G});H.pagePlace[I]=I;H.pageWrap[I]=g("<div/>",{"class":"turn-page-wrapper",page:I,css:{position:"absolute",overflow:"hidden",width:E,height:G}}).css(v[(H.display=="double")?I%2:0]);this.append(H.pageWrap[I]);H.pageWrap[I].prepend(H.pageObjs[I])}if(!I||A._setPageLoc.call(this,I)==1){A._makeFlip.call(this,I)}}else{H.pagePlace[I]=0;if(H.pageObjs[I]){H.pageObjs[I].remove()}}}},hasPage:function(E){return E in this.data().pageObjs},_makeFlip:function(F){var E=this.data();if(!E.pages[F]&&E.pagePlace[F]==F){var H=E.display=="single",G=F%2;E.pages[F]=E.pageObjs[F].css({width:(H)?this.width():this.width()/2,height:this.height()}).flip({page:F,next:(H&&F===E.totalPages)?F-1:((G||H)?F+1:F-1),turn:this,duration:E.opts.duration,acceleration:E.opts.acceleration,corners:(H)?"all":((G)?"forward":"backward"),backGradient:E.opts.gradients,frontGradient:E.opts.gradients}).flip("disable",E.disabled).bind("pressed",A._pressed).bind("released",A._released).bind("start",A._start).bind("end",A._end).bind("flip",A._flip)}return E.pages[F]},_makeRange:function(){var G,F=this.data(),E=this.turn("range");for(G=E[0];G<=E[1];G++){A._addPage.call(this,G)}},range:function(I){var E,J,G,H=this.data();I=I||H.tpage||H.page;var F=A._view.call(this,I);if(I<1||I>H.totalPages){throw new Error('"'+I+'" is not a page for range')}F[1]=F[1]||F[0];if(F[0]>=1&&F[1]<=H.totalPages){E=Math.floor((B-2)/2);if(H.totalPages-F[1]>F[0]){J=Math.min(F[0]-1,E);G=2*E-J}else{G=Math.min(H.totalPages-F[1],E);J=2*E-G}}else{J=B-1;G=B-1}return[Math.max(1,F[0]-J),Math.min(H.totalPages,F[1]+G)]},_necessPage:function(F){if(F===0){return true}var E=this.turn("range");return F>=E[0]&&F<=E[1]},_removeFromDOM:function(){var F,E=this.data();for(F in E.pageWrap){if(e(F,E.pageWrap)&&!A._necessPage.call(this,F)){A._removePageFromDOM.call(this,F)}}},_removePageFromDOM:function(G){var F=this.data();if(F.pages[G]){var E=F.pages[G].data();if(E.f&&E.f.fwrapper){E.f.fwrapper.remove()}F.pages[G].remove();delete F.pages[G]}if(F.pageObjs[G]){F.pageObjs[G].remove()}if(F.pageWrap[G]){F.pageWrap[G].remove();delete F.pageWrap[G]}delete F.pagePlace[G]},removePage:function(F){var E=this.data();if(E.pageObjs[F]){this.turn("stop");A._removePageFromDOM.call(this,F);delete E.pageObjs[F];A._movePages.call(this,F,-1);E.totalPages=E.totalPages-1;A._makeRange.call(this);if(E.page>E.totalPages){this.turn("page",E.totalPages)}}return this},_movePages:function(J,I){var G,F=this.data(),H=F.display=="single",E=function(M){var K=M+I,L=K%2;if(F.pageObjs[M]){F.pageObjs[K]=F.pageObjs[M].removeClass("page"+M).addClass("page"+K)}if(F.pagePlace[M]&&F.pageWrap[M]){F.pagePlace[K]=K;F.pageWrap[K]=F.pageWrap[M].css(v[(H)?0:L]).attr("page",K);if(F.pages[M]){F.pages[K]=F.pages[M].flip("options",{page:K,next:(H||L)?K+1:K-1,corners:(H)?"all":((L)?"forward":"backward")})}if(I){delete F.pages[M];delete F.pagePlace[M];delete F.pageObjs[M];delete F.pageWrap[M];delete F.pageObjs[M]}}};if(I>0){for(G=F.totalPages;G>=J;G--){E(G)}}else{for(G=J;G<=F.totalPages;G++){E(G)}}},display:function(G){var F=this.data(),H=F.display;if(G){if(g.inArray(G,m)==-1){throw new Error('"'+G+'" is not a value for display')}if(G=="single"){if(!F.pageObjs[0]){this.turn("stop").css({overflow:"hidden"});F.pageObjs[0]=g("<div />",{"class":"turn-page p-temporal"}).css({width:this.width(),height:this.height()}).appendTo(this)}}else{if(F.pageObjs[0]){this.turn("stop").css({overflow:""});F.pageObjs[0].remove();delete F.pageObjs[0]}}F.display=G;if(H){var E=this.turn("size");A._movePages.call(this,1,0);this.turn("size",E.width,E.height).turn("update")}return this}else{return H}},animating:function(){return this.data().pageMv.length>0},disable:function(F){var H,G=this.data(),E=this.turn("view");G.disabled=F===undefined||F===true;for(H in G.pages){if(e(H,G.pages)){G.pages[H].flip("disable",F?g.inArray(H,E):false)}}return this},size:function(G,E){if(G&&E){var I=this.data(),F=(I.display=="double")?G/2:G,H;this.css({width:G,height:E});if(I.pageObjs[0]){I.pageObjs[0].css({width:F,height:E})}for(H in I.pageWrap){if(!e(H,I.pageWrap)){continue}I.pageObjs[H].css({width:F,height:E});I.pageWrap[H].css({width:F,height:E});if(I.pages[H]){I.pages[H].css({width:F,height:E})}}this.turn("resize");return this}else{return{width:this.width(),height:this.height()}}},resize:function(){var F,E=this.data();if(E.pages[0]){E.pageWrap[0].css({left:-this.width()});E.pages[0].flip("resize",true)}for(F=1;F<=E.totalPages;F++){if(E.pages[F]){E.pages[F].flip("resize",true)}}},_removeMv:function(G){var E,F=this.data();for(E=0;E<F.pageMv.length;E++){if(F.pageMv[E]==G){F.pageMv.splice(E,1);return true}}return false},_addMv:function(F){var E=this.data();A._removeMv.call(this,F);E.pageMv.push(F)},_view:function(F){var E=this.data();F=F||E.page;if(E.display=="double"){return(F%2)?[F-1,F]:[F,F+1]}else{return[F]}},view:function(G){var F=this.data(),E=A._view.call(this,G);return(F.display=="double")?[(E[0]>0)?E[0]:0,(E[1]<=F.totalPages)?E[1]:0]:[(E[0]>0&&E[0]<=F.totalPages)?E[0]:0]},stop:function(G){var F,H,I=this.data(),E=I.pageMv;I.pageMv=[];if(I.tpage){I.page=I.tpage;delete I.tpage}for(F in E){if(!e(F,E)){continue}H=I.pages[E[F]].data().f.opts;y._moveFoldingPage.call(I.pages[E[F]],null);I.pages[E[F]].flip("hideFoldedPage");I.pagePlace[H.next]=H.next;if(H.force){H.next=(H.page%2===0)?H.page-1:H.page+1;delete H.force}}this.turn("update");return this},pages:function(E){var G=this.data();if(E){if(E<G.totalPages){for(var F=E+1;F<=G.totalPages;F++){this.turn("removePage",F)}if(this.turn("page")>E){this.turn("page",E)}}G.totalPages=E;return this}else{return G.totalPages}},_fitPage:function(G,E){var F=this.data(),H=this.turn("view",G);if(F.page!=G){this.trigger("turning",[G,H]);if(g.inArray(1,H)!=-1){this.trigger("first")}if(g.inArray(F.totalPages,H)!=-1){this.trigger("last")}}if(!F.pageObjs[G]){return}F.tpage=G;this.turn("stop",E);A._removeFromDOM.call(this);A._makeRange.call(this);this.trigger("turned",[G,H])},_turnPage:function(I){var J,F,H=this.data(),E=this.turn("view"),K=this.turn("view",I);if(H.page!=I){this.trigger("turning",[I,K]);if(g.inArray(1,K)!=-1){this.trigger("first")}if(g.inArray(H.totalPages,K)!=-1){this.trigger("last")}}if(!H.pageObjs[I]){return}H.tpage=I;this.turn("stop");A._makeRange.call(this);if(H.display=="single"){J=E[0];F=K[0]}else{if(E[1]&&I>E[1]){J=E[1];F=K[0]}else{if(E[0]&&I<E[0]){J=E[0];F=K[1]}}}if(H.pages[J]){var G=H.pages[J].data().f.opts;H.tpage=F;if(G.next!=F){G.next=F;H.pagePlace[F]=G.page;G.force=true}if(H.display=="single"){H.pages[J].flip("turnPage",(K[0]>E[0])?"br":"bl")}else{H.pages[J].flip("turnPage")}}},page:function(F){F=parseInt(F,10);var E=this.data();if(F>0&&F<=E.totalPages){if(!E.done||g.inArray(F,this.turn("view"))!=-1){A._fitPage.call(this,F)}else{A._turnPage.call(this,F)}return this}else{return E.page}},next:function(){var E=this.data();return this.turn("page",A._view.call(this,E.page).pop()+1)},previous:function(){var E=this.data();return this.turn("page",A._view.call(this,E.page).shift()-1)},_addMotionPage:function(){var G=g(this).data().f.opts,F=G.turn,E=F.data();G.pageMv=G.page;A._addMv.call(F,G.pageMv);E.pagePlace[G.next]=G.page;F.turn("update")},_start:function(J,G,F){var H=G.turn.data(),E=g.Event("start");J.stopPropagation();G.turn.trigger(E,[G,F]);if(E.isDefaultPrevented()){J.preventDefault();return}if(H.display=="single"){var I=F.charAt(1)=="l";if((G.page==1&&I)||(G.page==H.totalPages&&!I)){J.preventDefault()}else{if(I){G.next=(G.next<G.page)?G.next:G.page-1;G.force=true}else{G.next=(G.next>G.page)?G.next:G.page+1}}}A._addMotionPage.call(this)},_end:function(K,I){var H=g(this),J=H.data().f,G=J.opts,F=G.turn,E=F.data();K.stopPropagation();if(I||E.tpage){if(E.tpage==G.next||E.tpage==G.page){delete E.tpage;A._fitPage.call(F,E.tpage||G.next,true)}}else{A._removeMv.call(F,G.pageMv);F.turn("update")}},_pressed:function(){var I,G=g(this),H=G.data().f,F=H.opts.turn,E=F.data().pages;for(I in E){if(I!=H.opts.page){E[I].flip("disable",true)}}return H.time=new Date().getTime()},_released:function(H,E){var F=g(this),G=F.data().f;H.stopPropagation();if((new Date().getTime())-G.time<200||E.x<0||E.x>g(this).width()){H.preventDefault();G.opts.turn.data().tpage=G.opts.next;G.opts.turn.turn("update");g(F).flip("turnPage")}},_flip:function(){var E=g(this).data().f.opts;E.turn.trigger("turn",[E.next])},calculateZ:function(P){var H,K,N,F,O,J=this,G=this.data(),M=this.turn("view"),I=M[0]||M[1],E={pageZ:{},partZ:{},pageV:{}},L=function(R){var Q=J.turn("view",R);if(Q[0]){E.pageV[Q[0]]=true}if(Q[1]){E.pageV[Q[1]]=true}};for(H=0;H<P.length;H++){K=P[H];N=G.pages[K].data().f.opts.next;F=G.pagePlace[K];L(K);L(N);O=(G.pagePlace[N]==N)?N:K;E.pageZ[O]=G.totalPages-Math.abs(I-O);E.partZ[F]=G.totalPages*2+Math.abs(I-O)}return E},update:function(){var I,H=this.data();if(H.pageMv.length&&H.pageMv[0]!==0){var G,J=this.turn("calculateZ",H.pageMv),F=this.turn("view",H.tpage);if(H.pagePlace[F[0]]==F[0]){G=F[0]}else{if(H.pagePlace[F[1]]==F[1]){G=F[1]}}for(I in H.pageWrap){if(!e(I,H.pageWrap)){continue}H.pageWrap[I].css({display:(J.pageV[I])?"":"none","z-index":J.pageZ[I]||0});if(H.pages[I]){H.pages[I].flip("z",J.partZ[I]||null);if(J.pageV[I]){H.pages[I].flip("resize")}if(H.tpage){H.pages[I].flip("disable",true)}}}}else{for(I in H.pageWrap){if(!e(I,H.pageWrap)){continue}var E=A._setPageLoc.call(this,I);if(H.pages[I]){H.pages[I].flip("disable",H.disabled||E!=1).flip("z",null)}}}},_setPageLoc:function(G){var F=this.data(),E=this.turn("view");if(G==E[0]||G==E[1]){F.pageWrap[G].css({"z-index":F.totalPages,display:""});return 1}else{if((F.display=="single"&&G==E[0]+1)||(F.display=="double"&&G==E[0]-2||G==E[1]+2)){F.pageWrap[G].css({"z-index":F.totalPages-1,display:""});return 2}else{F.pageWrap[G].css({"z-index":0,display:"none"});return 0}}}},y={init:function(E){if(E.gradients){E.frontGradient=true;E.backGradient=true}this.data({f:{}});this.flip("options",E);y._addPageWrapper.call(this);return this},setData:function(F){var E=this.data();E.f=g.extend(E.f,F);return this},options:function(E){var F=this.data().f;if(E){y.setData.call(this,{opts:g.extend({},F.opts||a,E)});return this}else{return F.opts}},z:function(F){var E=this.data().f;E.opts["z-index"]=F;E.fwrapper.css({"z-index":F||parseInt(E.parent.css("z-index"),10)||0});return this},_cAllowed:function(){return x[this.data().f.opts.corners]||this.data().f.opts.corners},_cornerActivated:function(J){if(J.originalEvent===undefined){return false}J=(n)?J.originalEvent.touches:[J];var H=this.data().f,L=H.parent.offset(),G=this.width(),F=this.height(),K={x:Math.max(0,J[0].pageX-L.left),y:Math.max(0,J[0].pageY-L.top)},I=H.opts.cornerSize,E=y._cAllowed.call(this);if(K.x<=0||K.y<=0||K.x>=G||K.y>=F){return false}if(K.y<I){K.corner="t"}else{if(K.y>=F-I){K.corner="b"}else{return false}}if(K.x<=I){K.corner+="l"}else{if(K.x>=G-I){K.corner+="r"}else{return false}}return(g.inArray(K.corner,E)==-1)?false:K},_c:function(F,E){E=E||0;return({tl:h(E,E),tr:h(this.width()-E,E),bl:h(E,this.height()-E),br:h(this.width()-E,this.height()-E)})[F]},_c2:function(E){return{tl:h(this.width()*2,0),tr:h(-this.width(),0),bl:h(this.width()*2,this.height()),br:h(-this.width(),this.height())}[E]},_foldingPage:function(F){var E=this.data().f.opts;if(E.folding){return E.folding}else{if(E.turn){var G=E.turn.data();if(G.display=="single"){return(G.pageObjs[E.next])?G.pageObjs[0]:null}else{return G.pageObjs[E.next]}}}},_backGradient:function(){var F=this.data().f,E=F.opts.turn,G=F.opts.backGradient&&(!E||E.data().display=="single"||(F.opts.page!=2&&F.opts.page!=E.data().totalPages-1));if(G&&!F.bshadow){F.bshadow=g("<div/>",t(0,0,1)).css({position:"",width:this.width(),height:this.height()}).appendTo(F.parent)}return G},resize:function(G){var I=this.data().f,H=this.width(),E=this.height(),F=Math.round(Math.sqrt(Math.pow(H,2)+Math.pow(E,2)));if(G){I.wrapper.css({width:F,height:F});I.fwrapper.css({width:F,height:F}).children(":first-child").css({width:H,height:E});I.fpage.css({width:E,height:H});if(I.opts.frontGradient){I.ashadow.css({width:E,height:H})}if(y._backGradient.call(this)){I.bshadow.css({width:H,height:E})}}if(I.parent.is(":visible")){I.fwrapper.css({top:I.parent.offset().top,left:I.parent.offset().left});if(I.opts.turn){I.fparent.css({top:-I.opts.turn.offset().top,left:-I.opts.turn.offset().left})}}this.flip("z",I.opts["z-index"])},_addPageWrapper:function(){var I,H=this.data().f,K=this.parent();if(!H.wrapper){var G=this.css("left"),J=this.css("top"),F=this.width(),L=this.height(),M=Math.round(Math.sqrt(Math.pow(F,2)+Math.pow(L,2)));H.parent=K;H.fparent=(H.opts.turn)?H.opts.turn.data().fparent:g("#turn-fwrappers");if(!H.fparent){var E=g("<div/>",{css:{"pointer-events":"none"}}).hide();E.data().flips=0;if(H.opts.turn){E.css(t(-H.opts.turn.offset().top,-H.opts.turn.offset().left,"auto","visible").css).appendTo(H.opts.turn);H.opts.turn.data().fparent=E}else{E.css(t(0,0,"auto","visible").css).attr("id","turn-fwrappers").appendTo(g("body"))}H.fparent=E}this.css({position:"absolute",top:0,left:0,bottom:"auto",right:"auto"});H.wrapper=g("<div/>",t(0,0,this.css("z-index"))).appendTo(K).prepend(this);H.fwrapper=g("<div/>",t(K.offset().top,K.offset().left)).hide().appendTo(H.fparent);H.fpage=g("<div/>",{css:{cursor:"default"}}).appendTo(g("<div/>",t(0,0,0,"visible")).appendTo(H.fwrapper));if(H.opts.frontGradient){H.ashadow=g("<div/>",t(0,0,1)).appendTo(H.fpage)}y.setData.call(this,H);y.resize.call(this,true)}},_fold:function(U){var L=this,ad=0,J=0,Z,O,I,G,F,R,K,P=h(0,0),Y=h(0,0),E=h(0,0),T=this.width(),Q=this.height(),ab=y._foldingPage.call(this),X=Math.tan(J),ae=this.data().f,aa=ae.opts.acceleration,W=ae.wrapper.height(),S=y._c.call(this,U.corner),N=U.corner.substr(0,1)=="t",H=U.corner.substr(1,1)=="l",V=function(){var ao=h((S.x)?S.x-U.x:U.x,(S.y)?S.y-U.y:U.y),al=(Math.atan2(ao.y,ao.x)),ap;J=l-al;ad=s(J);ap=h((H)?T-ao.x/2:U.x+ao.x/2,ao.y/2);var ag=J-Math.atan2(ap.y,ap.x),af=Math.max(0,Math.sin(ag)*Math.sqrt(Math.pow(ap.x,2)+Math.pow(ap.y,2)));E=h(af*Math.sin(J),af*Math.cos(J));if(J>l){E.x=E.x+Math.abs(E.y*Math.tan(al));E.y=0;if(Math.round(E.x*Math.tan(w-J))<Q){U.y=Math.sqrt(Math.pow(Q,2)+2*ap.x*ao.x);if(N){U.y=Q-U.y}return V()}}if(J>l){var am=w-J,an=W-Q/Math.sin(am);P=h(Math.round(an*Math.cos(am)),Math.round(an*Math.sin(am)));if(H){P.x=-P.x}if(N){P.y=-P.y}}O=Math.round(E.y/Math.tan(J)+E.x);var ak=T-O,ai=ak*Math.cos(J*2),ah=ak*Math.sin(J*2);Y=h(Math.round((H?ak-ai:O+ai)),Math.round((N)?ah:Q-ah));R=ak*Math.sin(J);var ac=y._c2.call(L,U.corner),aj=Math.sqrt(Math.pow(ac.x-U.x,2)+Math.pow(ac.y-U.y,2));K=(aj<T)?aj/T:1;if(ae.opts.frontGradient){F=R>100?(R-100)/R:0;I=h(R*Math.sin(l-J)/Q*100,R*Math.cos(l-J)/T*100);if(N){I.y=100-I.y}if(H){I.x=100-I.x}}if(y._backGradient.call(L)){G=h(R*Math.sin(J)/T*100,R*Math.cos(J)/Q*100);if(!H){G.x=100-G.x}if(!N){G.y=100-G.y}}E.x=Math.round(E.x);E.y=Math.round(E.y);return true},M=function(ai,ah,ak,aj){var ag=["0","auto"],al=(T-W)*ak[0]/100,af=(Q-W)*ak[1]/100,am={left:ag[ah[0]],top:ag[ah[1]],right:ag[ah[2]],bottom:ag[ah[3]]},ac=(aj!=90&&aj!=-90)?(H?-1:1):0;ak=ak[0]+"% "+ak[1]+"%";L.css(am).transform(z(aj)+q(ai.x+ac,ai.y,aa),ak);ae.fpage.parent().css(am);ae.wrapper.transform(q(-ai.x+al-ac,-ai.y+af,aa)+z(-aj),ak);ae.fwrapper.transform(q(-ai.x+P.x+al,-ai.y+P.y+af,aa)+z(-aj),ak);ae.fpage.parent().transform(z(aj)+q(ai.x+Y.x-P.x,ai.y+Y.y-P.y,aa),ak);if(ae.opts.frontGradient){b(ae.ashadow,h(H?100:0,N?100:0),h(I.x,I.y),[[F,"rgba(0,0,0,0)"],[((1-F)*0.8)+F,"rgba(0,0,0,"+(0.2*K)+")"],[1,"rgba(255,255,255,"+(0.2*K)+")"]],3,J)}if(y._backGradient.call(L)){b(ae.bshadow,h(H?0:100,N?0:100),h(G.x,G.y),[[0.8,"rgba(0,0,0,0)"],[1,"rgba(0,0,0,"+(0.3*K)+")"],[1,"rgba(0,0,0,0)"]],3)}};switch(U.corner){case"tl":U.x=Math.max(U.x,1);V();M(E,[1,0,0,1],[100,0],ad);ae.fpage.transform(q(-Q,-T,aa)+z(90-ad*2),"100% 100%");ab.transform(z(90)+q(0,-Q,aa),"0% 0%");break;case"tr":U.x=Math.min(U.x,T-1);V();M(h(-E.x,E.y),[0,0,0,1],[0,0],-ad);ae.fpage.transform(q(0,-T,aa)+z(-90+ad*2),"0% 100%");ab.transform(z(270)+q(-T,0,aa),"0% 0%");break;case"bl":U.x=Math.max(U.x,1);V();M(h(E.x,-E.y),[1,1,0,0],[100,100],-ad);ae.fpage.transform(q(-Q,0,aa)+z(-90+ad*2),"100% 0%");ab.transform(z(270)+q(-T,0,aa),"0% 0%");break;case"br":U.x=Math.min(U.x,T-1);V();M(h(-E.x,-E.y),[0,1,1,0],[0,100],ad);ae.fpage.transform(z(90-ad*2),"0% 0%");ab.transform(z(90)+q(0,-Q,aa),"0% 0%");break}ae.point=U},_moveFoldingPage:function(E){var G=this.data().f,F=y._foldingPage.call(this);if(F){if(E){if(!G.fpage.children()[G.ashadow?"1":"0"]){y.setData.call(this,{backParent:F.parent()});G.fpage.prepend(F)}}else{if(G.backParent){G.backParent.prepend(F)}}}},_showFoldedPage:function(L,G){var H=y._foldingPage.call(this),F=this.data(),K=F.f;if(!K.point||K.point.corner!=L.corner){var J=g.Event("start");this.trigger(J,[K.opts,L.corner]);if(J.isDefaultPrevented()){return false}}if(H){if(G){var I=this,E=(K.point&&K.point.corner==L.corner)?K.point:y._c.call(this,L.corner,1);this.animatef({from:[E.x,E.y],to:[L.x,L.y],duration:500,frame:function(M){L.x=Math.round(M[0]);L.y=Math.round(M[1]);y._fold.call(I,L)}})}else{y._fold.call(this,L);if(F.effect&&!F.effect.turning){this.animatef(false)}}if(!K.fwrapper.is(":visible")){K.fparent.show().data().flips++;y._moveFoldingPage.call(this,true);K.fwrapper.show();if(K.bshadow){K.bshadow.show()}}return true}return false},hide:function(){var F=this.data().f,E=y._foldingPage.call(this);if((--F.fparent.data().flips)===0){F.fparent.hide()}this.css({left:0,top:0,right:"auto",bottom:"auto"}).transform("","0% 100%");F.wrapper.transform("","0% 100%");F.fwrapper.hide();if(F.bshadow){F.bshadow.hide()}E.transform("","0% 0%");return this},hideFoldedPage:function(E){var F=this.data().f;if(!F.point){return}var H=this,N=F.point,G=function(){F.point=null;H.flip("hide");H.trigger("end",[false])};if(E){var J=y._c.call(this,N.corner),I=(N.corner.substr(0,1)=="t"),M=(I)?Math.min(0,N.y-J.y)/2:Math.max(0,N.y-J.y)/2,L=h(N.x,N.y+M),K=h(J.x,J.y-M);this.animatef({from:0,to:1,frame:function(O){var P=r(N,L,K,J,O);N.x=P.x;N.y=P.y;y._fold.call(H,N)},complete:G,duration:800,hiding:true})}else{this.animatef(false);G()}},turnPage:function(G){var F=this,H=this.data().f;G={corner:(H.corner)?H.corner.corner:G||y._cAllowed.call(this)[0]};var I=H.point||y._c.call(this,G.corner,(H.opts.turn)?H.opts.turn.data().opts.elevation:0),E=y._c2.call(this,G.corner);this.trigger("flip").animatef({from:0,to:1,frame:function(J){var K=r(I,I,E,E,J);G.x=K.x;G.y=K.y;y._showFoldedPage.call(F,G)},complete:function(){F.trigger("end",[true])},duration:H.opts.duration,turning:true});H.corner=null},moving:function(){return"effect" in this.data()},isTurning:function(){return this.flip("moving")&&this.data().effect.turning},_eventStart:function(F){var E=this.data().f;if(!E.disabled&&!this.flip("isTurning")){E.corner=y._cornerActivated.call(this,F);if(E.corner&&y._foldingPage.call(this,E.corner)){y._moveFoldingPage.call(this,true);this.trigger("pressed",[E.point]);return false}else{E.corner=null}}},_eventMove:function(H){var G=this.data().f;if(!G.disabled){H=(n)?H.originalEvent.touches:[H];if(G.corner){var I=G.parent.offset();G.corner.x=H[0].pageX-I.left;G.corner.y=H[0].pageY-I.top;y._showFoldedPage.call(this,G.corner)}else{if(!this.data().effect&&this.is(":visible")){var F=y._cornerActivated.call(this,H[0]);if(F){var E=y._c.call(this,F.corner,G.opts.cornerSize/2);F.x=E.x;F.y=E.y;y._showFoldedPage.call(this,F,true)}else{y.hideFoldedPage.call(this,true)}}}}},_eventEnd:function(){var F=this.data().f;if(!F.disabled&&F.point){var E=g.Event("released");this.trigger(E,[F.point]);if(!E.isDefaultPrevented()){y.hideFoldedPage.call(this,true)}}F.corner=null},disable:function(E){y.setData.call(this,{disabled:E});return this}},o=function(G,E,F){if(!F[0]||typeof(F[0])=="object"){return E.init.apply(G,F)}else{if(E[F[0]]&&F[0].toString().substr(0,1)!="_"){return E[F[0]].apply(G,Array.prototype.slice.call(F,1))}else{throw F[0]+" is an invalid value"}}};g.extend(g.fn,{flip:function(F,E){return o(this,y,arguments)},turn:function(E){return o(this,A,arguments)},transform:function(F,E){var G={};if(E){G[C+"transform-origin"]=E}G[C+"transform"]=F;return this.css(G)},animatef:function(M){var H=this.data();if(H.effect){clearInterval(H.effect.handle)}if(M){if(!M.to.length){M.to=[M.to]}if(!M.from.length){M.from=[M.from]}if(!M.easing){M.easing=function(O,P,N,R,Q){return R*Math.sqrt(1-(P=P/Q-1)*P)+N}}var G,L=[],K=M.to.length,J=this,E=M.fps||30,F=-E,I=function(){var O,N=[];F=Math.min(M.duration,F+E);for(O=0;O<K;O++){N.push(M.easing(1,F,M.from[O],L[O],M.duration))}M.frame((K==1)?N[0]:N);if(F==M.duration){clearInterval(H.effect.handle);delete H.effect;J.data(H);if(M.complete){M.complete()}}};for(G=0;G<K;G++){L.push(M.to[G]-M.from[G])}H.effect=M;H.effect.handle=setInterval(I,E);this.data(H);I()}else{delete H.effect}}});g.isTouch=n})(jQuery);Array.prototype.contains=function(b){var a=this.length;while(a--){if(this[a]===b){return true}}return false};Array.prototype.clear=function(){var a=this.length;while(a--){this[a]=0}};var timeDiff={start:function(){d=new Date();time=d.getTime()},end:function(){d=new Date();return(d.getTime()-time)}};function Sudoku(){this.matrix=new Array(81);this.matrix.clear();this.level=0;this.shuffle=function(q){for(var m=0;m<9;m++){for(var g=0;g<9;g++){q[m*9+g]=(m*3+Math.floor(m/3)+g)%9+1}}for(var m=0;m<42;m++){var o=Math.ceil(Math.random()*9);var n;do{n=Math.ceil(Math.random()*9)}while(o==n);for(var v=0;v<9;v++){for(var e=0;e<e;k++){if(q[v*9+e]==o){q[v*9+e]=n}else{if(q[v*9+e]==n){q[v*9+e]=o}}}}}for(var p=0;p<42;p++){var t=Math.floor(Math.random()*3);var r=Math.floor(Math.random()*3);for(var v=0;v<9;v++){var l=this.matrix[v*9+(t*3+p%3)];this.matrix[v*9+(t*3+p%3)]=this.matrix[v*9+(r*3+p%3)];this.matrix[v*9+(r*3+p%3)]=l}}for(var u=0;u<42;u++){var h=Math.floor(Math.random()*3);var f=Math.floor(Math.random()*3);for(var v=0;v<9;v++){var l=this.matrix[v*9+(u%3*3+h)];this.matrix[v*9+(u%3*3+h)]=this.matrix[v*9+(u%3*3+f)];this.matrix[v*9+(u%3*3+f)]=l}}for(var u=0;u<42;u++){var b=Math.floor(Math.random()*3);var a=Math.floor(Math.random()*3);for(var e=0;e<9;e++){var l=this.matrix[(u%3*3+b)*9+e];this.matrix[(u%3*3+b)*9+e]=this.matrix[(u%3*3+a)*9+e];this.matrix[(u%3*3+a)*9+e]=l}}};this.maskBoardEasy=function(e,a){var g,f,b;for(g=0;g<81;g++){a[g]=e[g]}for(var g=0;g<3;g++){for(var f=0;f<3;f++){for(var b=0;b<5;b++){var h;do{h=Math.floor(Math.random()*9)}while(a[(g*3+Math.floor(h/3))*9+f*3+h%3]==0);a[(g*3+Math.floor(h/3))*9+f*3+h%3]=0}}}};this.getAvailable=function(m,n,h){var f,e,o,b,a,l;var g=new Array(9);g.clear();o=Math.floor(n/9);b=n%9;for(f=0;f<9;f++){e=o*9+f;if(m[e]>0){g[m[e]-1]=1}}for(f=0;f<9;f++){e=f*9+b;if(m[e]>0){g[m[e]-1]=1}}a=o-o%3;l=b-b%3;for(f=a;f<a+3;f++){for(e=l;e<l+3;e++){if(m[f*9+e]>0){g[m[f*9+e]-1]=1}}}e=0;if(h!=null){for(f=0;f<9;f++){if(g[f]==0){h[e++]=f+1}}}else{for(f=0;f<9;f++){if(g[f]==0){e++}}return e}if(e==0){return 0}for(f=0;f<18;f++){a=Math.floor(Math.random()*e);l=Math.floor(Math.random()*e);o=h[a];h[a]=h[l];h[l]=o}return e};this.getCell=function(b){var a=-1,g=10,e,c;var f=new Array(9);f.clear();for(e=0;e<81;e++){if(b[e]==0){c=this.getAvailable(b,e,null);if(c<g){g=c;a=e}if(g==1){break}}}return a};this.solve=function(b){var f,e,c=0;var a=this.getCell(b);if(a==-1){return 1}var g=new Array(9);g.clear();e=this.getAvailable(b,a,g);for(f=0;f<e;f++){b[a]=g[f];if(this.solve(b)==1){return 1}}b[a]=0;return 0};this.enumSolutions=function(b){var f,e,c=0;var a=this.getCell(b);if(a==-1){return 1}var g=new Array(9);g.clear();e=this.getAvailable(b,a,g);for(f=0;f<e;f++){b[a]=g[f];c+=this.enumSolutions(b);if(c>1){break}}b[a]=0;return c};this.maskBoard=function(q,w){var x,s,p,l,y,m=0,A,o=0,b,B;var h=new Array(9);h.clear();var z=new Array(81);z.clear();w.clear();do{do{b=Math.floor(Math.random()*81)}while((w[b]!=0)||(z[b]!=0));B=q[b];x=this.getAvailable(w,b,null);if(x>1){var u,f=Math.floor(b/9),e=b%9;u=0;for(x=0;x<9;x++){if(x==e){continue}s=f*9+x;if(w[s]>0){continue}A=this.getAvailable(w,s,h);for(s=0;s<A;s++){if(h[s]==B){u++;break}h[s]=0}}if(u>0){u=0;for(x=0;x<9;x++){if(x==f){continue}s=x*9+e;if(w[s]>0){continue}A=this.getAvailable(w,s,h);for(s=0;s<A;s++){if(h[s]==B){u++;break}h[s]=0}}if(u>0){u=0;l=f-f%3;y=e-e%3;for(x=l;x<l+3;x++){for(s=y;s<y+3;s++){if((x==f)&&(s==e)){continue}p=x*9+s;if(w[p]>0){continue}A=this.getAvailable(w,p,h);for(p=0;p<A;p++){if(h[p]==B){u++;break}h[p]=0}}}if(u>0){w[b]=B;o++}}}}z[b]=1;m++}while(m<81);do{do{b=Math.floor(Math.random()*81)}while((w[b]==0)||(z[b]==0));B=w[b];var g=this;var v=0;w[b]=0;v=this.enumSolutions(w);if(v>1){w[b]=B}z[b]=0;o--}while(o>0)};this._checkVal=function(a,l,e,h){var f,b,g,m;for(f=0;f<9;f++){if((f!=e)&&(a[l*9+f]==h)){return false}}for(f=0;f<9;f++){if((f!=l)&&(a[f*9+e]==h)){return false}}g=l-l%3;m=e-e%3;for(f=g;f<g+3;f++){for(b=m;b<m+3;b++){if(((f!=l)||(b!=e))&&(a[f*9+b]==h)){return false}}}return true};this.checkVal=function(c,a,b){return this._checkVal(this.matrix,c,a,b)};this.setVal=function(c,a,b){this.matrix[c*9+a]=b};this.getVal=function(b,a){return this.matrix[b*9+a]};this._newGame=function(){var c,e=0;var b=new Array(81);this.matrix.clear();this.solve(this.matrix);if(this.level==0){this.maskBoardEasy(this.matrix,b)}else{this.maskBoard(this.matrix,b);if(this.level==1){for(c=0;c<4;c++){do{var a=Math.floor(Math.random()*81)}while(b[a]!=0);b[a]=this.matrix[a]}}}this.save=this.matrix;this.matrix=b;timeDiff.start()};this.done;this._doHints=function(e,b,c,g){if(g>0){do{cell=Math.floor(Math.random()*81)}while((b[cell]==0)||(c[cell]==0));val=b[cell];var f=this;var a=0;b[cell]=0;a=this.enumSolutions(b);if(a>1){b[cell]=val}c[cell]=0;g--;var f=this;setTimeout(function(){f._doHints(e,b,c,g)},50)}else{this.save=this.matrix;this.matrix=b;this.done()}};this._doMask=function(q,v){var w,s,p,l,x,m=0,z,o=0,b,A;var h=new Array(9);h.clear();var y=new Array(81);y.clear();v.clear();do{do{b=Math.floor(Math.random()*81)}while((v[b]!=0)||(y[b]!=0));A=q[b];w=this.getAvailable(v,b,null);if(w>1){var u,f=Math.floor(b/9),e=b%9;u=0;for(w=0;w<9;w++){if(w==e){continue}s=f*9+w;if(v[s]>0){continue}z=this.getAvailable(v,s,h);for(s=0;s<z;s++){if(h[s]==A){u++;break}h[s]=0}}if(u>0){u=0;for(w=0;w<9;w++){if(w==f){continue}s=w*9+e;if(v[s]>0){continue}z=this.getAvailable(v,s,h);for(s=0;s<z;s++){if(h[s]==A){u++;break}h[s]=0}}if(u>0){u=0;l=f-f%3;x=e-e%3;for(w=l;w<l+3;w++){for(s=x;s<x+3;s++){if((w==f)&&(s==e)){continue}p=w*9+s;if(v[p]>0){continue}z=this.getAvailable(v,p,h);for(p=0;p<z;p++){if(h[p]==A){u++;break}h[p]=0}}}if(u>0){v[b]=A;o++}}}}y[b]=1;m++}while(m<81);var g=this;setTimeout(function(){g._doHints(q,v,y,o)},50)};this.newGame=function(){var c,e=0;var b=new Array(81);this.matrix.clear();this.solve(this.matrix);if(this.level==0){this.maskBoardEasy(this.matrix,b);this.save=this.matrix;this.matrix=b;timeDiff.start();this.done()}else{this._doMask(this.matrix,b);if(this.level==1){for(c=0;c<4;c++){do{var a=Math.floor(Math.random()*81)}while(b[a]!=0);b[a]=this.matrix[a]}}}};this.solveGame=function(){this.matrix=this.save};this.gameFinished=function(){for(var b=0;b<9;b++){for(var a=0;a<9;a++){var c=this.matrix[b*9+a];if((c==0)||(this._checkVal(this.matrix,b,a,c)==false)){return 0}}}return timeDiff.end()}};/*!
 * jQuery TubePlayer Plugin
 * 
 * version: 1.1.0 (1-Oct-2012)
 * @requires v1.3.2 or later
 *
 * @imports SWFObject - http://code.google.com/p/swfobject/
 *	- Degrades to flash based player if not HTML5/iframe option 
 *
 * Author: Nirvana Tikku (@ntikku / ntikku@gmail.com)
 * Documentation:
 * 		http://www.tikku.com/jquery-youtube-tubeplayer-plugin
 * 
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html 
 */
;(function($){
    
    "use strict";
	
	// tubeplayer namespace
	
	var TUBEPLAYER = ".tubeplayer",
	
		TUBE_PLAYER_CLASS = "jquery-youtube-tubeplayer",
		
		OPTS = "opts"+TUBEPLAYER;
	
	//	
	//
	// TubePlayer package 
	//
	//
	var TubePlayer = {};
	
	// all the instances that exist
	TubePlayer.ytplayers = {}; 
	
	// local init functions for multiple iframe players
	TubePlayer.inits = []; 
	
	// no need to import the iframe script multiple times
	TubePlayer.iframeScriptInited = false; 
	
	// tubeplayer inited flag - for destroy/re-init
	TubePlayer.inited = false;
	
	//
	//
	// public facing defaults
	//
	//
	
	$.tubeplayer = {};
	$.tubeplayer.TubePlayer = TubePlayer;
	
	// events cache -- used by flashplayer version of video player
	$.tubeplayer.events = {};
	
	/**
	 * These are all the events that are bound to the YouTube Player
	 * the events can be overridden as they are public.
	 * 
	 * There are several functions that serve as wrappers to be utilized
	 * internally - stateChange, onError, qualityChange. Change them at your 
	 * own risk.
	 */
	$.tubeplayer.defaults = {
	
		afterReady: function($player){},
		
		stateChange: function(player){
			
			var _ret = this.onPlayer;
			
			return function(state){
			    
				if(typeof(state)==="object")
					state = state.data;
				
				switch(state){
					
					case -1: return _ret.unstarted[player]();
					
					case 0: return _ret.ended[player]();
					
					case 1: return _ret.playing[player]();
					
					case 2: return _ret.paused[player]();
					
					case 3: return _ret.buffering[player]();
					
					case 5: return _ret.cued[player]();
					
					default: return null;
					
				}
			}
			
		},
		
		onError: function(player){
			
			var _ret = this.onErr;
			
			return function(errorCode){
				
				if(typeof(errorCode)==="object")
					errorCode = errorCode.data;
					
				switch(errorCode){
					
					case 2: return _ret.invalidParameter[player]();
					
					case 100: return _ret.notFound[player]();
					
					case 101:
					case 150: return _ret.notEmbeddable[player]();
					
					default: return null;
					
				}
				
			}
			
		},
		
		qualityChange: function(player){
			
			var _this = this;
			
			return function(suggested){
				
				if(typeof(suggested)==="object")
					suggested = suggested.data;
					
				return _this.onQualityChange[player](suggested);
				
			}
			
		},
		
		onQualityChange:{},
		
		onPlayer:{unstarted:{},ended:{},playing:{},paused:{},buffering:{},cued:{}},
		
		onErr:{notFound:{},notEmbeddable:{},invalidParameter:{}}
		
	};
	
	/**
	 * These are the internal defaults for the TubePlayer
	 * plugin to work without providing any parameters. They
	 * are merged with the users options.
	 */
	var defaults = {
		
		// public facing
		width: 425,
		height: 355,
		allowFullScreen: "true",
		initialVideo: "DkoeNLuMbcI",
		start: 0,
		preferredQuality: "default",
		showControls: true,
		showRelated: false,
		annotations: true,
		autoPlay: false,
		autoHide: true,
		loop: 0,
		theme: 'dark', // 'dark' or 'light'
		color: 'red', // 'red' or 'white'
		showinfo: false,
		modestbranding: true,
		protocol: 'http', // set to 'https' for compatibility on SSL-enabled pages
		
		// with respect to [wmode] - 'transparent' maintains z-index, but disables GPU acceleration
		wmode: 'transparent', // you probably want to use 'window' when optimizing for mobile devices
		swfobjectURL: "ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js", // exclude the protocol, it will be read from the 'protocol' property
		loadSWFObject: true, // by default, we will attempt to load the swfobject script, if utilizing the flash player
		
		// privately used
		allowScriptAccess: "always",
		playerID: "tubeplayer-player-container",
		
		// html5 specific attrs
		iframed: true,
				
		// trigger fn's
		onPlay: function(id){},
		onPause: function(){},
		onStop: function(){},
		onSeek: function(time){},
		onMute: function(){},
		onUnMute: function(){},
		
		// player fn's
		onPlayerUnstarted: function(){},
		onPlayerEnded: function(){},
		onPlayerPlaying: function(){},
		onPlayerPaused: function(){},
		onPlayerBuffering: function(){},
		onPlayerCued: function(){},
		onQualityChange: function(){},
		
		// error fn's
		onErrorNotFound: function(){},
		onErrorNotEmbeddable: function(){},
		onErrorInvalidParameter: function(){}
		
	};
	
	/**
	 * The TubePlayer plugin bound to the jQuery object's prototype. 
	 * This method acts as an interface to instantiate a TubePlayer, 
	 * as well as invoke events that are attached - typically getters/setters
	 */
	$.fn.tubeplayer = function(input, xtra){
		
		var $this = $(this);
		
		var type = typeof input;
		
		if( arguments.length === 0 || type === "object" )
		
			return $this.each(function(){
				
				TubePlayer.init( $(this), input );
				
			});
			
		else if( type === "string" )
		
			return $this.triggerHandler( input+TUBEPLAYER, xtra || null );
			
	};
	
		
	/**
	 * This method is the base method for all the events
	 * that are bound to the TubePlayer. 
	 */
	var buildFN = function(fn, after){
		
		return function(evt,param){
			
			var p = TubePlayer.getPkg(evt);
			
			if(p.ytplayer) { 
				
				var ret = fn(evt, param, p);
				
				if(typeof(ret)==="undefined") 
					ret = p.$player;
					
				return ret;
				
			}
			
			return p.$player;
			
		};
		
	};
	
	/**
	 * Public method to get all the player instances
	 */
	$.tubeplayer.getPlayers = function(){
		
		return TubePlayer.ytplayers;
		
	};
	
	
	/**
	 * Initialize a YouTube player; 
	 *
	 *	First check to see if TubePlayer has been init'd
	 *	if it has then return, otherwise:
	 *		> add the tubeplayer class (used to denote a player)
	 *		> provide local data access to the options and store it
	 *		> initialize the default events on the jQuery instance
	 *		> create the container for the player
	 *		> initialize the player (iframe/HTML5 vs flash based)
	 * 
	 *	@param $player - the instance being created on
	 *	@param opts - the user's options
	 */
	TubePlayer.init = function($player, opts){
	
		if( $player.hasClass(TUBE_PLAYER_CLASS) )
			return $player;
		
		var o = $.extend({}, defaults, opts);
			
		o.playerID += "-" + guid();
			
		$player.addClass(TUBE_PLAYER_CLASS).data(OPTS, o);
		
		for(var event in PLAYER) 
			$player.bind(event+TUBEPLAYER, $player, PLAYER[event]);
			
		// initialize the default event methods
		TubePlayer.initDefaults($.tubeplayer.defaults, o);
	
		// insert the player container
		$("<div></div>").attr("id", o.playerID).appendTo($player);
		
		// append the player into the container
		TubePlayer.initPlayer($player, o);
		
		return $player; 
		
	};
	
	/**
	 * Every method needs these items
	 */
	TubePlayer.getPkg = function(evt){
		
		var $player = evt.data;
		
		var opts = $player.data(OPTS);
		
		var ytplayer = TubePlayer.ytplayers[opts.playerID];
		
		return {
			
			$player: $player,
			
			opts: opts,
			
			ytplayer: ytplayer
			
		}
		
	};
	
	/**
	 * This method handles the player init. Since 
	 * onYouTubePlayerReady is called when the script
	 * has been evaluated, we want all the instances
	 * to get init'd. For this we have a init queue.
	 * If the script has been init'd, we automatically
	 * pop the method off the queue and init the player.
	 */
	TubePlayer.iframeReady = function(o){
		
		TubePlayer.inits.push(function(){
			
			new YT.Player(o.playerID, {
				
				videoId: o.initialVideo,
				
				width: o.width,
				
				height: o.height,
				
				playerVars: { 
					
					'autoplay': (o.autoPlay?1:0), 
					
					'autohide': (o.autoHide?1:0),
					
					'controls': (o.showControls?1:0),
					
					'loop': (o.loop?1:0),
					
					'playlist': (o.loop ? o.initialVideo : ""),

					'rel': (o.showRelated?1:0),
					
					'fs': (o.allowFullScreen?1:0),
					
					'wmode': o.wmode,
					
					'showinfo': (o.showinfo?1:0),
					
					'modestbranding': (o.modestbranding?1:0),
					
					'iv_load_policy': (o.annotations?1:3),
					
					'start': o.start,
					
					'theme': o.theme,
					
					'color': o.color
					
				},
				
				events: {
					
					'onReady': function(evt){
						
						TubePlayer.ytplayers[o.playerID] = evt.target;
						
						var $player = $(evt.target).parents("."+TUBE_PLAYER_CLASS);
						
						$.tubeplayer.defaults.afterReady($player);
						
					},
					
					'onPlaybackQualityChange': $.tubeplayer.defaults.qualityChange(o.playerID),
					
					'onStateChange': $.tubeplayer.defaults.stateChange(o.playerID),
				
					'onError': $.tubeplayer.defaults.onError(o.playerID)
					
				}
				
			});
			
		});
		
		// stacked init method
		if(TubePlayer.inits.length>=1 && !TubePlayer.inited){
			
			return function(){
				
				for(var i=0; i<TubePlayer.inits.length; i++){

					TubePlayer.inits[i]();
					
				}
				
				TubePlayer.inited = true;
				
			};
			
		}
		
		// if we've inited already, just call the init fn
		if(TubePlayer.inited){
			
			( TubePlayer.inits.pop() )();
			
		}
		
		return window.onYouTubePlayerAPIReady;
		
	};
	
	/**
	 * check to see if iframe option is plausible
	 */
	TubePlayer.supportsHTML5 = function(){
		
		return !!document.createElement('video').canPlayType;
		
	};
	
	/**
	 * @param d - the defaults
	 * @param o - the options w/ methods to attach
	 */
	TubePlayer.initDefaults = function(d, o){
	
		var ID = o.playerID; 
		
		// default onPlayer events
		var dp = d.onPlayer;
		dp.unstarted[ID] = o.onPlayerUnstarted;
		dp.ended[ID] = o.onPlayerEnded;
		dp.playing[ID] = o.onPlayerPlaying;
		dp.paused[ID] = o.onPlayerPaused;
		dp.buffering[ID] = o.onPlayerBuffering;
		dp.cued[ID] = o.onPlayerCued;
		
		// default onQualityChange
		d.onQualityChange[ID] = o.onQualityChange;
		
		// default onError events
		var de = d.onErr;
		de.notFound[ID] = o.onErrorNotFound;
		de.notEmbeddable[ID] = o.onErrorNotEmbeddable;
		de.invalidParameter[ID] = o.onErrorInvalidParameter;
		
	};
	
	/**
	 * init the iframed option if its requested and supported
	 * otherwise initialize the flash based player
	 * @param $player - the player that the tubeplayer binds to
	 * @param o - the init options
	 */
	TubePlayer.initPlayer = function($player, o){
		
		if(o.iframed && TubePlayer.supportsHTML5())
		
			TubePlayer.initIframePlayer($player, o);
			
		else
		
			TubePlayer.initFlashPlayer($player, o);
			
	};
	
	/**
	 * Initialize an iframe player
	 */
	TubePlayer.initIframePlayer = function($player, o){
		
		if(!TubePlayer.iframeScriptInited){
		
			// write the api script tag
			var tag = document.createElement('script');
		
			tag.src = o.protocol + "://www.youtube.com/iframe_api";
		
			var firstScriptTag = document.getElementsByTagName('script')[0];
		
			firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
		
			TubePlayer.iframeScriptInited = true;
		
		};
		
		// init the iframe player
		window.onYouTubePlayerAPIReady = TubePlayer.iframeReady(o);
		
	};
	
	/**
	 * Flash player initialization
	 *  -> if 'loadSWFObject' is set to true, player will only be init'd
	 *      when the swfobject script request has completed successfully
	 *  -> if 'loadSWFObject' is set to false, assumes that you have 
	 *      imported your own SWFObject, prior to TubePlayer's initialization
	 * @imports swfobject automatically
	 */
	TubePlayer.initFlashPlayer = function($player, o){
		
		if(o.loadSWFObject){
		    
		    // cleanup swfobjectURL to re-apply the protocol
		    o.swfobjectURL = o.swfobjectURL.replace('http://', '');
		    o.swfobjectURL = o.swfobjectURL.replace('https://', '');
		    o.swfobjectURL = o.protocol + '://' + o.swfobjectURL;
		    
		    $.getScript(o.swfobjectURL, TubePlayer.initFlashPlayerFN(o));
		    
		} else {
		    
		    TubePlayer.initFlashPlayerFN(o)();
		    
		}
		
	};
	
	TubePlayer.initFlashPlayerFN = function(o){
	  
	    return function(){
		
			var url =  ["//www.youtube.com/v/"]
			url.push( o.initialVideo );
			url.push( "?&enablejsapi=1&version=3" );
			url.push( "&playerapiid=" + o.playerID );
			url.push( "&rel= " + (o.showRelated?1:0) );
			url.push( "&autoplay=" + (o.autoPlay?1:0) );
			url.push( "&autohide=" + (o.autoHide?1:0) );
			url.push( "&loop=" + (o.loop?1:0) );
			url.push( "&playlist=" + (o.loop ? o.initialVideo : ""));
			url.push( "&controls=" + (o.showControls?1:0) );
			url.push( "&showinfo=" + (o.showinfo?1:0) );
			url.push( "&modestbranding=" + (o.modestbranding?1:0) );
			url.push( "&iv_load_policy=" + (o.annotations?1:3) );
			url.push( "&start=" + o.start );
			url.push( "&theme=" + o.theme );
			url.push( "&color=" + o.color );
			url.push( "&fs=" + (o.allowFullScreen?1:0) );
			
			swfobject.embedSWF(url.join(""), o.playerID, 
				o.width, 
				o.height, 
				"8", null, null, 
				{ 
					allowScriptAccess: o.allowScriptAccess, 
					wmode: o.wmode, 
					allowFullScreen: o.allowFullScreen 
				}, 
				{ id: o.playerID }
			);
			
			// init the player ready fn
			window.onYouTubePlayerReady = function(playerId) { 
				
				var player = document.getElementById(playerId);
				
                var pid = playerId.replace(/-/g,'');
                
                var d = $.tubeplayer.defaults;
                $.tubeplayer.events[pid] = {
                    "stateChange": d.stateChange(playerId),
                    "error": d.onError(playerId),
                    "qualityChange": d.qualityChange(playerId)
                };
                
				player.addEventListener("onStateChange", "$.tubeplayer.events."+pid+".stateChange"); 
				player.addEventListener("onError", "$.tubeplayer.events."+pid+".error");
				player.addEventListener("onPlaybackQualityChange", "$.tubeplayer.events."+pid+".qualityChange");
				
				TubePlayer.ytplayers[playerId] = player;
				
                var $player = $(player).parents("."+TUBE_PLAYER_CLASS);
				
				$.tubeplayer.defaults.afterReady($player);
				
			};
			
		}
	    
	};
	
	// fmt: youtube.com/watch?x=[anything]&v=[desired-token]&
	TubePlayer.getVideoIDFromURL = function(sURL){
		
		sURL = sURL || ""; // make sure it's a string; sometimes the YT player API returns undefined, and then indexOf() below will fail
		
		var qryParamsStart = sURL.indexOf("?");
		
		var qryParams = sURL.substring(qryParamsStart, sURL.length);
		
		var videoStart = qryParams.indexOf("v=");
		if( videoStart > -1 ) { 
		    var videoEnd = qryParams.indexOf("&", videoStart);
		    if( videoEnd === -1 ) { 
		        videoEnd = qryParams.length;
		    }
		    return qryParams.substring(videoStart+"v=".length, videoEnd);
		}
		
		return "";
		
	};
	
	/**
	 * All the events that are bound to a TubePlayer instance
	 */
	var PLAYER = {
		
		cue: buildFN(function(evt,param,p){ 
			
			p.ytplayer.cueVideoById(param, p.opts.preferredQuality);
			
		}),
		
		play: buildFN(function(evt,param,p){
			
			if(typeof(param)==='object') 
				p.ytplayer.loadVideoById(param.id,param.time, p.opts.preferredQuality); 
		
			else if(param) 
				p.ytplayer.loadVideoById(param, 0, p.opts.preferredQuality); 
	
			else
				p.ytplayer.playVideo(); 
				
			p.opts.onPlay(param);
			
		}),
		
		pause: buildFN(function(evt,param,p){
			
			p.ytplayer.pauseVideo();
			
			p.opts.onPause(p);
			
		}),
		
		stop: buildFN(function(evt,param,p){
			
			p.ytplayer.stopVideo();
			
			p.opts.onStop(p);
			
		}),
		
		seek: buildFN(function(evt,param,p){
			
			p.ytplayer.seekTo(param, true);
			
			p.opts.onSeek(param);
			
		}),
		
		mute: buildFN(function(evt,param,p){
			
			p.$player.attr("data-prev-mute-volume", p.ytplayer.getVolume());
			
			p.ytplayer.mute(); 
			
			p.opts.onMute(p);
			
		}),
		
		unmute: buildFN(function(evt,param,p){
			
			p.ytplayer.unMute(); 
			
			p.ytplayer.setVolume( ( p.$player.attr("data-prev-mute-volume") || 50 ) );
			
			p.opts.onUnMute();
			
		}),
		
		isMuted: buildFN(function(evt,param,p){
			
			return p.ytplayer.isMuted();
			
		}),
		
		volume: buildFN(function(evt,param,p){
			
			if(param) {
				
				p.ytplayer.setVolume(param);
				
				p.$player.attr("data-prev-mute-volume", p.ytplayer.getVolume());
				
			}	else  {
				
				return p.ytplayer.getVolume() || 0; // 0 because iframe's currently in labs
				
			}
		
		}),
		
		quality: buildFN(function(evt,param,p){
			
			if(param) 
				p.ytplayer.setPlaybackQuality(param); 
				
			else 
				return p.ytplayer.getPlaybackQuality();
				
		}),
		
		data: buildFN(function(evt,param,p){
			
			var ret = {}; 
			
			var P = p.ytplayer;
			
			ret.bytesLoaded = P.getVideoBytesLoaded(); 
			
			ret.bytesTotal = P.getVideoBytesTotal();
			
			ret.startBytes= P.getVideoStartBytes();
			
			ret.state = P.getPlayerState();
			
			ret.currentTime = P.getCurrentTime();
			
			ret.duration = P.getDuration();
			
			ret.videoURL = P.getVideoUrl();
			
			ret.getVideoEmbedCode = P.getVideoEmbedCode();
			
			ret.videoID = TubePlayer.getVideoIDFromURL(ret.videoURL);
			
			ret.availableQualityLevels = P.getAvailableQualityLevels();
            
			return ret;
			
		}),
		
		videoId: buildFN(function(evt,param,p){
			
			return TubePlayer.getVideoIDFromURL( p.ytplayer.getVideoUrl() );
			
		}),
		
		size: buildFN(function(evt, param, p){
			
			if(param.width && param.height) { 
				
				p.ytplayer.setSize(param.width, param.height);
				
				$(p.ytplayer).css(param);
				
			}
			
		}),
		
		destroy: buildFN(function(evt, param, p){

			p.$player.removeClass(TUBE_PLAYER_CLASS)
				.data(OPTS, null)
				.unbind(TUBEPLAYER)
				.html("");
				
			delete TubePlayer.ytplayers[p.opts.playerID];
			
			// cleanup callback handler references..
			var d = $.tubeplayer.defaults;
			
			var events = ['unstarted','ended','playing','paused','buffering','cued'];
			for(var _event in events) 
			    delete d.onPlayer[events[_event]][p.opts.playerID];
			    
			events = ['notFound','notEmbeddable','invalidParameter'];
			for(var _event in events) 
			    delete d.onErr[events[_event]][p.opts.playerID];
			    
			delete d.onQualityChange[p.opts.playerID];
			
			delete $.tubeplayer.events[p.opts.playerID]; // flash callback ref's
			
			$(p.ytplayer).remove();
			
			return null;		
			
		}),
		
		player: buildFN(function(evt, param, p){
			
			return p.ytplayer;
			
		})
		
	};
	
	// used in case of multiple players
	function guid(){
	    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
            var r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);
            return v.toString(16);
        });;
	};
	
})(jQuery);/*!
 * jQuery Cookie Plugin v1.3.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */
(function (factory) {
	if (typeof define === 'function' && define.amd) {
		// AMD. Register as anonymous module.
		define(['jquery'], factory);
	} else {
		// Browser globals.
		factory(jQuery);
	}
}(function ($) {

	var pluses = /\+/g;

	function raw(s) {
		return s;
	}

	function decoded(s) {
		return decodeURIComponent(s.replace(pluses, ' '));
	}

	function converted(s) {
		if (s.indexOf('"') === 0) {
			// This is a quoted cookie as according to RFC2068, unescape
			s = s.slice(1, -1).replace(/\\"/g, '"').replace(/\\\\/g, '\\');
		}
		try {
			return config.json ? JSON.parse(s) : s;
		} catch(er) {}
	}

	var config = $.cookie = function (key, value, options) {

		// write
		if (value !== undefined) {
			options = $.extend({}, config.defaults, options);

			if (typeof options.expires === 'number') {
				var days = options.expires, t = options.expires = new Date();
				t.setDate(t.getDate() + days);
			}

			value = config.json ? JSON.stringify(value) : String(value);

			return (document.cookie = [
				config.raw ? key : encodeURIComponent(key),
				'=',
				config.raw ? value : encodeURIComponent(value),
				options.expires ? '; expires=' + options.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE
				options.path    ? '; path=' + options.path : '',
				options.domain  ? '; domain=' + options.domain : '',
				options.secure  ? '; secure' : ''
			].join(''));
		}

		// read
		var decode = config.raw ? raw : decoded;
		var cookies = document.cookie.split('; ');
		var result = key ? undefined : {};
		for (var i = 0, l = cookies.length; i < l; i++) {
			var parts = cookies[i].split('=');
			var name = decode(parts.shift());
			var cookie = decode(parts.join('='));

			if (key && key === name) {
				result = converted(cookie);
				break;
			}

			if (!key) {
				result[name] = converted(cookie);
			}
		}

		return result;
	};

	config.defaults = {};

	$.removeCookie = function (key, options) {
		if ($.cookie(key) !== undefined) {
			// Must not alter options, thus extending a fresh object...
			$.cookie(key, '', $.extend({}, options, { expires: -1 }));
			return true;
		}
		return false;
	};

}));
/*!
 * jQuery resize event - v1.1 - 3/14/2010
 * http://benalman.com/projects/jquery-resize-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */

// Script: jQuery resize event
//
// *Version: 1.1, Last updated: 3/14/2010*
// 
// Project Home - http://benalman.com/projects/jquery-resize-plugin/
// GitHub       - http://github.com/cowboy/jquery-resize/
// Source       - http://github.com/cowboy/jquery-resize/raw/master/jquery.ba-resize.js
// (Minified)   - http://github.com/cowboy/jquery-resize/raw/master/jquery.ba-resize.min.js (1.0kb)
// 
// About: License
// 
// Copyright (c) 2010 "Cowboy" Ben Alman,
// Dual licensed under the MIT and GPL licenses.
// http://benalman.com/about/license/
// 
// About: Examples
// 
// This working example, complete with fully commented code, illustrates a few
// ways in which this plugin can be used.
// 
// resize event - http://benalman.com/code/projects/jquery-resize/examples/resize/
// 
// About: Support and Testing
// 
// Information about what version or versions of jQuery this plugin has been
// tested with, what browsers it has been tested in, and where the unit tests
// reside (so you can test it yourself).
// 
// jQuery Versions - 1.3.2, 1.4.1, 1.4.2
// Browsers Tested - Internet Explorer 6-8, Firefox 2-3.6, Safari 3-4, Chrome, Opera 9.6-10.1.
// Unit Tests      - http://benalman.com/code/projects/jquery-resize/unit/
// 
// About: Release History
// 
// 1.1 - (3/14/2010) Fixed a minor bug that was causing the event to trigger
//       immediately after bind in some circumstances. Also changed $.fn.data
//       to $.data to improve performance.
// 1.0 - (2/10/2010) Initial release

(function($,window,undefined){
  '$:nomunge'; // Used by YUI compressor.
  
  // A jQuery object containing all non-window elements to which the resize
  // event is bound.
  var elems = $([]),
    
    // Extend $.resize if it already exists, otherwise create it.
    jq_resize = $.resize = $.extend( $.resize, {} ),
    
    timeout_id,
    
    // Reused strings.
    str_setTimeout = 'setTimeout',
    str_resize = 'resize',
    str_data = str_resize + '-special-event',
    str_delay = 'delay',
    str_throttle = 'throttleWindow';
  
  // Property: jQuery.resize.delay
  // 
  // The numeric interval (in milliseconds) at which the resize event polling
  // loop executes. Defaults to 250.
  
  jq_resize[ str_delay ] = 250;
  
  // Property: jQuery.resize.throttleWindow
  // 
  // Throttle the native window object resize event to fire no more than once
  // every <jQuery.resize.delay> milliseconds. Defaults to true.
  // 
  // Because the window object has its own resize event, it doesn't need to be
  // provided by this plugin, and its execution can be left entirely up to the
  // browser. However, since certain browsers fire the resize event continuously
  // while others do not, enabling this will throttle the window resize event,
  // making event behavior consistent across all elements in all browsers.
  // 
  // While setting this property to false will disable window object resize
  // event throttling, please note that this property must be changed before any
  // window object resize event callbacks are bound.
  
  jq_resize[ str_throttle ] = true;
  
  // Event: resize event
  // 
  // Fired when an element's width or height changes. Because browsers only
  // provide this event for the window element, for other elements a polling
  // loop is initialized, running every <jQuery.resize.delay> milliseconds
  // to see if elements' dimensions have changed. You may bind with either
  // .resize( fn ) or .bind( "resize", fn ), and unbind with .unbind( "resize" ).
  // 
  // Usage:
  // 
  // > jQuery('selector').bind( 'resize', function(e) {
  // >   // element's width or height has changed!
  // >   ...
  // > });
  // 
  // Additional Notes:
  // 
  // * The polling loop is not created until at least one callback is actually
  //   bound to the 'resize' event, and this single polling loop is shared
  //   across all elements.
  // 
  // Double firing issue in jQuery 1.3.2:
  // 
  // While this plugin works in jQuery 1.3.2, if an element's event callbacks
  // are manually triggered via .trigger( 'resize' ) or .resize() those
  // callbacks may double-fire, due to limitations in the jQuery 1.3.2 special
  // events system. This is not an issue when using jQuery 1.4+.
  // 
  // > // While this works in jQuery 1.4+
  // > $(elem).css({ width: new_w, height: new_h }).resize();
  // > 
  // > // In jQuery 1.3.2, you need to do this:
  // > var elem = $(elem);
  // > elem.css({ width: new_w, height: new_h });
  // > elem.data( 'resize-special-event', { width: elem.width(), height: elem.height() } );
  // > elem.resize();
      
  $.event.special[ str_resize ] = {
    
    // Called only when the first 'resize' event callback is bound per element.
    setup: function() {
      // Since window has its own native 'resize' event, return false so that
      // jQuery will bind the event using DOM methods. Since only 'window'
      // objects have a .setTimeout method, this should be a sufficient test.
      // Unless, of course, we're throttling the 'resize' event for window.
      if ( !jq_resize[ str_throttle ] && this[ str_setTimeout ] ) { return false; }
      
      var elem = $(this);
      
      // Add this element to the list of internal elements to monitor.
      elems = elems.add( elem );
      
      // Initialize data store on the element.
      $.data( this, str_data, { w: elem.width(), h: elem.height() } );
      
      // If this is the first element added, start the polling loop.
      if ( elems.length === 1 ) {
        loopy();
      }
    },
    
    // Called only when the last 'resize' event callback is unbound per element.
    teardown: function() {
      // Since window has its own native 'resize' event, return false so that
      // jQuery will unbind the event using DOM methods. Since only 'window'
      // objects have a .setTimeout method, this should be a sufficient test.
      // Unless, of course, we're throttling the 'resize' event for window.
      if ( !jq_resize[ str_throttle ] && this[ str_setTimeout ] ) { return false; }
      
      var elem = $(this);
      
      // Remove this element from the list of internal elements to monitor.
      elems = elems.not( elem );
      
      // Remove any data stored on the element.
      elem.removeData( str_data );
      
      // If this is the last element removed, stop the polling loop.
      if ( !elems.length ) {
        clearTimeout( timeout_id );
      }
    },
    
    // Called every time a 'resize' event callback is bound per element (new in
    // jQuery 1.4).
    add: function( handleObj ) {
      // Since window has its own native 'resize' event, return false so that
      // jQuery doesn't modify the event object. Unless, of course, we're
      // throttling the 'resize' event for window.
      if ( !jq_resize[ str_throttle ] && this[ str_setTimeout ] ) { return false; }
      
      var old_handler;
      
      // The new_handler function is executed every time the event is triggered.
      // This is used to update the internal element data store with the width
      // and height when the event is triggered manually, to avoid double-firing
      // of the event callback. See the "Double firing issue in jQuery 1.3.2"
      // comments above for more information.
      
      function new_handler( e, w, h ) {
        var elem = $(this),
          data = $.data( this, str_data );
        
        // If called from the polling loop, w and h will be passed in as
        // arguments. If called manually, via .trigger( 'resize' ) or .resize(),
        // those values will need to be computed.
        data.w = w !== undefined ? w : elem.width();
        data.h = h !== undefined ? h : elem.height();
        
        old_handler.apply( this, arguments );
      };
      
      // This may seem a little complicated, but it normalizes the special event
      // .add method between jQuery 1.4/1.4.1 and 1.4.2+
      if ( $.isFunction( handleObj ) ) {
        // 1.4, 1.4.1
        old_handler = handleObj;
        return new_handler;
      } else {
        // 1.4.2+
        old_handler = handleObj.handler;
        handleObj.handler = new_handler;
      }
    }
    
  };
  
  function loopy() {
    
    // Start the polling loop, asynchronously.
    timeout_id = window[ str_setTimeout ](function(){
      
      // Iterate over all elements to which the 'resize' event is bound.
      elems.each(function(){
        var elem = $(this),
          width = elem.width(),
          height = elem.height(),
          data = $.data( this, str_data );
        
        // If element size has changed since the last time, update the element
        // data store and trigger the 'resize' event.
        if ( width !== data.w || height !== data.h ) {
          elem.trigger( str_resize, [ data.w = width, data.h = height ] );
        }
        
      });
      
      // Loop.
      loopy();
      
    }, jq_resize[ str_delay ] );
    
  };
  
})(jQuery,this);
/*!
 * jQuery Transit - CSS3 transitions and transformations
 * (c) 2011-2012 Rico Sta. Cruz <rico@ricostacruz.com>
 * MIT Licensed.
 *
 * http://ricostacruz.com/jquery.transit
 * http://github.com/rstacruz/jquery.transit
 */

(function($) {
  $.transit = {
    version: "0.9.9",

    // Map of $.css() keys to values for 'transitionProperty'.
    // See https://developer.mozilla.org/en/CSS/CSS_transitions#Properties_that_can_be_animated
    propertyMap: {
      marginLeft    : 'margin',
      marginRight   : 'margin',
      marginBottom  : 'margin',
      marginTop     : 'margin',
      paddingLeft   : 'padding',
      paddingRight  : 'padding',
      paddingBottom : 'padding',
      paddingTop    : 'padding'
    },

    // Will simply transition "instantly" if false
    enabled: true,

    // Set this to false if you don't want to use the transition end property.
    useTransitionEnd: false
  };

  var div = document.createElement('div');
  var support = {};

  // Helper function to get the proper vendor property name.
  // (`transition` => `WebkitTransition`)
  function getVendorPropertyName(prop) {
    // Handle unprefixed versions (FF16+, for example)
    if (prop in div.style) return prop;

    var prefixes = ['Moz', 'Webkit', 'O', 'ms'];
    var prop_ = prop.charAt(0).toUpperCase() + prop.substr(1);

    if (prop in div.style) { return prop; }

    for (var i=0; i<prefixes.length; ++i) {
      var vendorProp = prefixes[i] + prop_;
      if (vendorProp in div.style) { return vendorProp; }
    }
  }

  // Helper function to check if transform3D is supported.
  // Should return true for Webkits and Firefox 10+.
  function checkTransform3dSupport() {
    div.style[support.transform] = '';
    div.style[support.transform] = 'rotateY(90deg)';
    return div.style[support.transform] !== '';
  }

  var isChrome = navigator.userAgent.toLowerCase().indexOf('chrome') > -1;

  // Check for the browser's transitions support.
  support.transition      = getVendorPropertyName('transition');
  support.transitionDelay = getVendorPropertyName('transitionDelay');
  support.transform       = getVendorPropertyName('transform');
  support.transformOrigin = getVendorPropertyName('transformOrigin');
  support.transform3d     = checkTransform3dSupport();

  var eventNames = {
    'transition':       'transitionEnd',
    'MozTransition':    'transitionend',
    'OTransition':      'oTransitionEnd',
    'WebkitTransition': 'webkitTransitionEnd',
    'msTransition':     'MSTransitionEnd'
  };

  // Detect the 'transitionend' event needed.
  var transitionEnd = support.transitionEnd = eventNames[support.transition] || null;

  // Populate jQuery's `$.support` with the vendor prefixes we know.
  // As per [jQuery's cssHooks documentation](http://api.jquery.com/jQuery.cssHooks/),
  // we set $.support.transition to a string of the actual property name used.
  for (var key in support) {
    if (support.hasOwnProperty(key) && typeof $.support[key] === 'undefined') {
      $.support[key] = support[key];
    }
  }

  // Avoid memory leak in IE.
  div = null;

  // ## $.cssEase
  // List of easing aliases that you can use with `$.fn.transition`.
  $.cssEase = {
    '_default':       'ease',
    'in':             'ease-in',
    'out':            'ease-out',
    'in-out':         'ease-in-out',
    'snap':           'cubic-bezier(0,1,.5,1)',
    // Penner equations
    'easeOutCubic':   'cubic-bezier(.215,.61,.355,1)',
    'easeInOutCubic': 'cubic-bezier(.645,.045,.355,1)',
    'easeInCirc':     'cubic-bezier(.6,.04,.98,.335)',
    'easeOutCirc':    'cubic-bezier(.075,.82,.165,1)',
    'easeInOutCirc':  'cubic-bezier(.785,.135,.15,.86)',
    'easeInExpo':     'cubic-bezier(.95,.05,.795,.035)',
    'easeOutExpo':    'cubic-bezier(.19,1,.22,1)',
    'easeInOutExpo':  'cubic-bezier(1,0,0,1)',
    'easeInQuad':     'cubic-bezier(.55,.085,.68,.53)',
    'easeOutQuad':    'cubic-bezier(.25,.46,.45,.94)',
    'easeInOutQuad':  'cubic-bezier(.455,.03,.515,.955)',
    'easeInQuart':    'cubic-bezier(.895,.03,.685,.22)',
    'easeOutQuart':   'cubic-bezier(.165,.84,.44,1)',
    'easeInOutQuart': 'cubic-bezier(.77,0,.175,1)',
    'easeInQuint':    'cubic-bezier(.755,.05,.855,.06)',
    'easeOutQuint':   'cubic-bezier(.23,1,.32,1)',
    'easeInOutQuint': 'cubic-bezier(.86,0,.07,1)',
    'easeInSine':     'cubic-bezier(.47,0,.745,.715)',
    'easeOutSine':    'cubic-bezier(.39,.575,.565,1)',
    'easeInOutSine':  'cubic-bezier(.445,.05,.55,.95)',
    'easeInBack':     'cubic-bezier(.6,-.28,.735,.045)',
    'easeOutBack':    'cubic-bezier(.175, .885,.32,1.275)',
    'easeInOutBack':  'cubic-bezier(.68,-.55,.265,1.55)'
  };

  // ## 'transform' CSS hook
  // Allows you to use the `transform` property in CSS.
  //
  //     $("#hello").css({ transform: "rotate(90deg)" });
  //
  //     $("#hello").css('transform');
  //     //=> { rotate: '90deg' }
  //
  $.cssHooks['transit:transform'] = {
    // The getter returns a `Transform` object.
    get: function(elem) {
      return $(elem).data('transform') || new Transform();
    },

    // The setter accepts a `Transform` object or a string.
    set: function(elem, v) {
      var value = v;

      if (!(value instanceof Transform)) {
        value = new Transform(value);
      }

      // We've seen the 3D version of Scale() not work in Chrome when the
      // element being scaled extends outside of the viewport.  Thus, we're
      // forcing Chrome to not use the 3d transforms as well.  Not sure if
      // translate is affectede, but not risking it.  Detection code from
      // http://davidwalsh.name/detecting-google-chrome-javascript
      if (support.transform === 'WebkitTransform' && !isChrome) {
        elem.style[support.transform] = value.toString(true);
      } else {
        elem.style[support.transform] = value.toString();
      }

      $(elem).data('transform', value);
    }
  };

  // Add a CSS hook for `.css({ transform: '...' })`.
  // In jQuery 1.8+, this will intentionally override the default `transform`
  // CSS hook so it'll play well with Transit. (see issue #62)
  $.cssHooks.transform = {
    set: $.cssHooks['transit:transform'].set
  };

  // jQuery 1.8+ supports prefix-free transitions, so these polyfills will not
  // be necessary.
  if ($.fn.jquery < "1.8") {
    // ## 'transformOrigin' CSS hook
    // Allows the use for `transformOrigin` to define where scaling and rotation
    // is pivoted.
    //
    //     $("#hello").css({ transformOrigin: '0 0' });
    //
    $.cssHooks.transformOrigin = {
      get: function(elem) {
        return elem.style[support.transformOrigin];
      },
      set: function(elem, value) {
        elem.style[support.transformOrigin] = value;
      }
    };

    // ## 'transition' CSS hook
    // Allows you to use the `transition` property in CSS.
    //
    //     $("#hello").css({ transition: 'all 0 ease 0' });
    //
    $.cssHooks.transition = {
      get: function(elem) {
        return elem.style[support.transition];
      },
      set: function(elem, value) {
        elem.style[support.transition] = value;
      }
    };
  }

  // ## Other CSS hooks
  // Allows you to rotate, scale and translate.
  registerCssHook('scale');
  registerCssHook('translate');
  registerCssHook('rotate');
  registerCssHook('rotateX');
  registerCssHook('rotateY');
  registerCssHook('rotate3d');
  registerCssHook('perspective');
  registerCssHook('skewX');
  registerCssHook('skewY');
  registerCssHook('x', true);
  registerCssHook('y', true);

  // ## Transform class
  // This is the main class of a transformation property that powers
  // `$.fn.css({ transform: '...' })`.
  //
  // This is, in essence, a dictionary object with key/values as `-transform`
  // properties.
  //
  //     var t = new Transform("rotate(90) scale(4)");
  //
  //     t.rotate             //=> "90deg"
  //     t.scale              //=> "4,4"
  //
  // Setters are accounted for.
  //
  //     t.set('rotate', 4)
  //     t.rotate             //=> "4deg"
  //
  // Convert it to a CSS string using the `toString()` and `toString(true)` (for WebKit)
  // functions.
  //
  //     t.toString()         //=> "rotate(90deg) scale(4,4)"
  //     t.toString(true)     //=> "rotate(90deg) scale3d(4,4,0)" (WebKit version)
  //
  function Transform(str) {
    if (typeof str === 'string') { this.parse(str); }
    return this;
  }

  Transform.prototype = {
    // ### setFromString()
    // Sets a property from a string.
    //
    //     t.setFromString('scale', '2,4');
    //     // Same as set('scale', '2', '4');
    //
    setFromString: function(prop, val) {
      var args =
        (typeof val === 'string')  ? val.split(',') :
        (val.constructor === Array) ? val :
        [ val ];

      args.unshift(prop);

      Transform.prototype.set.apply(this, args);
    },

    // ### set()
    // Sets a property.
    //
    //     t.set('scale', 2, 4);
    //
    set: function(prop) {
      var args = Array.prototype.slice.apply(arguments, [1]);
      if (this.setter[prop]) {
        this.setter[prop].apply(this, args);
      } else {
        this[prop] = args.join(',');
      }
    },

    get: function(prop) {
      if (this.getter[prop]) {
        return this.getter[prop].apply(this);
      } else {
        return this[prop] || 0;
      }
    },

    setter: {
      // ### rotate
      //
      //     .css({ rotate: 30 })
      //     .css({ rotate: "30" })
      //     .css({ rotate: "30deg" })
      //     .css({ rotate: "30deg" })
      //
      rotate: function(theta) {
        this.rotate = unit(theta, 'deg');
      },

      rotateX: function(theta) {
        this.rotateX = unit(theta, 'deg');
      },

      rotateY: function(theta) {
        this.rotateY = unit(theta, 'deg');
      },

      // ### scale
      //
      //     .css({ scale: 9 })      //=> "scale(9,9)"
      //     .css({ scale: '3,2' })  //=> "scale(3,2)"
      //
      scale: function(x, y) {
        if (y === undefined) { y = x; }
        this.scale = x + "," + y;
      },

      // ### skewX + skewY
      skewX: function(x) {
        this.skewX = unit(x, 'deg');
      },

      skewY: function(y) {
        this.skewY = unit(y, 'deg');
      },

      // ### perspectvie
      perspective: function(dist) {
        this.perspective = unit(dist, 'px');
      },

      // ### x / y
      // Translations. Notice how this keeps the other value.
      //
      //     .css({ x: 4 })       //=> "translate(4px, 0)"
      //     .css({ y: 10 })      //=> "translate(4px, 10px)"
      //
      x: function(x) {
        this.set('translate', x, null);
      },

      y: function(y) {
        this.set('translate', null, y);
      },

      // ### translate
      // Notice how this keeps the other value.
      //
      //     .css({ translate: '2, 5' })    //=> "translate(2px, 5px)"
      //
      translate: function(x, y) {
        if (this._translateX === undefined) { this._translateX = 0; }
        if (this._translateY === undefined) { this._translateY = 0; }

        if (x !== null && x !== undefined) { this._translateX = unit(x, 'px'); }
        if (y !== null && y !== undefined) { this._translateY = unit(y, 'px'); }

        this.translate = this._translateX + "," + this._translateY;
      }
    },

    getter: {
      x: function() {
        return this._translateX || 0;
      },

      y: function() {
        return this._translateY || 0;
      },

      scale: function() {
        var s = (this.scale || "1,1").split(',');
        if (s[0]) { s[0] = parseFloat(s[0]); }
        if (s[1]) { s[1] = parseFloat(s[1]); }

        // "2.5,2.5" => 2.5
        // "2.5,1" => [2.5,1]
        return (s[0] === s[1]) ? s[0] : s;
      },

      rotate3d: function() {
        var s = (this.rotate3d || "0,0,0,0deg").split(',');
        for (var i=0; i<=3; ++i) {
          if (s[i]) { s[i] = parseFloat(s[i]); }
        }
        if (s[3]) { s[3] = unit(s[3], 'deg'); }

        return s;
      }
    },

    // ### parse()
    // Parses from a string. Called on constructor.
    parse: function(str) {
      var self = this;
      str.replace(/([a-zA-Z0-9]+)\((.*?)\)/g, function(x, prop, val) {
        self.setFromString(prop, val);
      });
    },

    // ### toString()
    // Converts to a `transition` CSS property string. If `use3d` is given,
    // it converts to a `-webkit-transition` CSS property string instead.
    toString: function(use3d) {
      var re = [];

      for (var i in this) {
        if (this.hasOwnProperty(i)) {
          // Don't use 3D transformations if the browser can't support it.
          if ((!support.transform3d) && (
            (i === 'rotateX') ||
            (i === 'rotateY') ||
            (i === 'perspective') ||
            (i === 'transformOrigin'))) { continue; }

          if (i[0] !== '_') {
            if (use3d && (i === 'scale')) {
              re.push(i + "3d(" + this[i] + ",1)");
            } else if (use3d && (i === 'translate')) {
              re.push(i + "3d(" + this[i] + ",0)");
            } else {
              re.push(i + "(" + this[i] + ")");
            }
          }
        }
      }

      return re.join(" ");
    }
  };

  function callOrQueue(self, queue, fn) {
    if (queue === true) {
      self.queue(fn);
    } else if (queue) {
      self.queue(queue, fn);
    } else {
      fn();
    }
  }

  // ### getProperties(dict)
  // Returns properties (for `transition-property`) for dictionary `props`. The
  // value of `props` is what you would expect in `$.css(...)`.
  function getProperties(props) {
    var re = [];

    $.each(props, function(key) {
      key = $.camelCase(key); // Convert "text-align" => "textAlign"
      key = $.transit.propertyMap[key] || $.cssProps[key] || key;
      key = uncamel(key); // Convert back to dasherized

      if ($.inArray(key, re) === -1) { re.push(key); }
    });

    return re;
  }

  // ### getTransition()
  // Returns the transition string to be used for the `transition` CSS property.
  //
  // Example:
  //
  //     getTransition({ opacity: 1, rotate: 30 }, 500, 'ease');
  //     //=> 'opacity 500ms ease, -webkit-transform 500ms ease'
  //
  function getTransition(properties, duration, easing, delay) {
    // Get the CSS properties needed.
    var props = getProperties(properties);

    // Account for aliases (`in` => `ease-in`).
    if ($.cssEase[easing]) { easing = $.cssEase[easing]; }

    // Build the duration/easing/delay attributes for it.
    var attribs = '' + toMS(duration) + ' ' + easing;
    if (parseInt(delay, 10) > 0) { attribs += ' ' + toMS(delay); }

    // For more properties, add them this way:
    // "margin 200ms ease, padding 200ms ease, ..."
    var transitions = [];
    $.each(props, function(i, name) {
      transitions.push(name + ' ' + attribs);
    });

    return transitions.join(', ');
  }

  // ## $.fn.transition
  // Works like $.fn.animate(), but uses CSS transitions.
  //
  //     $("...").transition({ opacity: 0.1, scale: 0.3 });
  //
  //     // Specific duration
  //     $("...").transition({ opacity: 0.1, scale: 0.3 }, 500);
  //
  //     // With duration and easing
  //     $("...").transition({ opacity: 0.1, scale: 0.3 }, 500, 'in');
  //
  //     // With callback
  //     $("...").transition({ opacity: 0.1, scale: 0.3 }, function() { ... });
  //
  //     // With everything
  //     $("...").transition({ opacity: 0.1, scale: 0.3 }, 500, 'in', function() { ... });
  //
  //     // Alternate syntax
  //     $("...").transition({
  //       opacity: 0.1,
  //       duration: 200,
  //       delay: 40,
  //       easing: 'in',
  //       complete: function() { /* ... */ }
  //      });
  //
  $.fn.transition = $.fn.transit = function(properties, duration, easing, callback) {
    var self  = this;
    var delay = 0;
    var queue = true;

    // Account for `.transition(properties, callback)`.
    if (typeof duration === 'function') {
      callback = duration;
      duration = undefined;
    }

    // Account for `.transition(properties, duration, callback)`.
    if (typeof easing === 'function') {
      callback = easing;
      easing = undefined;
    }

    // Alternate syntax.
    if (typeof properties.easing !== 'undefined') {
      easing = properties.easing;
      delete properties.easing;
    }

    if (typeof properties.duration !== 'undefined') {
      duration = properties.duration;
      delete properties.duration;
    }

    if (typeof properties.complete !== 'undefined') {
      callback = properties.complete;
      delete properties.complete;
    }

    if (typeof properties.queue !== 'undefined') {
      queue = properties.queue;
      delete properties.queue;
    }

    if (typeof properties.delay !== 'undefined') {
      delay = properties.delay;
      delete properties.delay;
    }

    // Set defaults. (`400` duration, `ease` easing)
    if (typeof duration === 'undefined') { duration = $.fx.speeds._default; }
    if (typeof easing === 'undefined')   { easing = $.cssEase._default; }

    duration = toMS(duration);

    // Build the `transition` property.
    var transitionValue = getTransition(properties, duration, easing, delay);

    // Compute delay until callback.
    // If this becomes 0, don't bother setting the transition property.
    var work = $.transit.enabled && support.transition;
    var i = work ? (parseInt(duration, 10) + parseInt(delay, 10)) : 0;

    // If there's nothing to do...
    if (i === 0) {
      var fn = function(next) {
        self.css(properties);
        if (callback) { callback.apply(self); }
        if (next) { next(); }
      };

      callOrQueue(self, queue, fn);
      return self;
    }

    // Save the old transitions of each element so we can restore it later.
    var oldTransitions = {};

    var run = function(nextCall) {
      var bound = false;

      // Prepare the callback.
      var cb = function() {
        if (bound) { self.unbind(transitionEnd, cb); }

        if (i > 0) {
          self.each(function() {
            this.style[support.transition] = (oldTransitions[this] || null);
          });
        }

        if (typeof callback === 'function') { callback.apply(self); }
        if (typeof nextCall === 'function') { nextCall(); }
      };

      if ((i > 0) && (transitionEnd) && ($.transit.useTransitionEnd)) {
        // Use the 'transitionend' event if it's available.
        bound = true;
        self.bind(transitionEnd, cb);
      } else {
        // Fallback to timers if the 'transitionend' event isn't supported.
        window.setTimeout(cb, i);
      }

      // Apply transitions.
      self.each(function() {
        if (i > 0) {
          this.style[support.transition] = transitionValue;
        }
        $(this).css(properties);
      });
    };

    // Defer running. This allows the browser to paint any pending CSS it hasn't
    // painted yet before doing the transitions.
    var deferredRun = function(next) {
        this.offsetWidth; // force a repaint
        run(next);
    };

    // Use jQuery's fx queue.
    callOrQueue(self, queue, deferredRun);

    // Chainability.
    return this;
  };

  function registerCssHook(prop, isPixels) {
    // For certain properties, the 'px' should not be implied.
    if (!isPixels) { $.cssNumber[prop] = true; }

    $.transit.propertyMap[prop] = support.transform;

    $.cssHooks[prop] = {
      get: function(elem) {
        var t = $(elem).css('transit:transform');
        return t.get(prop);
      },

      set: function(elem, value) {
        var t = $(elem).css('transit:transform');
        t.setFromString(prop, value);

        $(elem).css({ 'transit:transform': t });
      }
    };

  }

  // ### uncamel(str)
  // Converts a camelcase string to a dasherized string.
  // (`marginLeft` => `margin-left`)
  function uncamel(str) {
    return str.replace(/([A-Z])/g, function(letter) { return '-' + letter.toLowerCase(); });
  }

  // ### unit(number, unit)
  // Ensures that number `number` has a unit. If no unit is found, assume the
  // default is `unit`.
  //
  //     unit(2, 'px')          //=> "2px"
  //     unit("30deg", 'rad')   //=> "30deg"
  //
  function unit(i, units) {
    if ((typeof i === "string") && (!i.match(/^[\-0-9\.]+$/))) {
      return i;
    } else {
      return "" + i + units;
    }
  }

  // ### toMS(duration)
  // Converts given `duration` to a millisecond string.
  //
  //     toMS('fast')   //=> '400ms'
  //     toMS(10)       //=> '10ms'
  //
  function toMS(duration) {
    var i = duration;

    // Allow for string durations like 'fast'.
    if ($.fx.speeds[i]) { i = $.fx.speeds[i]; }

    return unit(i, 'ms');
  }

  // Export some functions for testable-ness.
  $.transit.getTransitionValue = getTransition;
})(jQuery);
/*! JsRender v1.0pre: http://github.com/BorisMoore/jsrender */
/*
* Optimized version of jQuery Templates, for rendering to string.
* Does not require jQuery, or HTML DOM
* Integrates with JsViews (http://github.com/BorisMoore/jsviews)
* Copyright 2012, Boris Moore
* Released under the MIT License.
*/
// informal pre beta commit counter: 22

(function(global, jQuery, undefined) {
	// global is the this object, which is window when running in the usual browser environment.
	"use strict";

	if (jQuery && jQuery.views || global.jsviews) { return; } // JsRender is already loaded

	//========================== Top-level vars ==========================

	var versionNumber = "v1.0pre",

		$, jsvStoreName, rTag, rTmplString,
//TODO	tmplFnsCache = {},
		delimOpenChar0 = "{", delimOpenChar1 = "{", delimCloseChar0 = "}", delimCloseChar1 = "}", linkChar = "^",
		FALSE = false, TRUE = true,

		rPath = /^(?:null|true|false|\d[\d.]*|([\w$]+|\.|~([\w$]+)|#(view|([\w$]+))?)([\w$.^]*?)(?:[.[^]([\w$]+)\]?)?)$/g,
		//                                     object     helper    view  viewProperty pathTokens      leafToken

		rParams = /(\()(?=|\s*\()|(?:([([])\s*)?(?:([#~]?[\w$.^]+)?\s*((\+\+|--)|\+|-|&&|\|\||===|!==|==|!=|<=|>=|[<>%*!:?\/]|(=))\s*|([#~]?[\w$.^]+)([([])?)|(,\s*)|(\(?)\\?(?:(')|("))|(?:\s*([)\]])([([]?))|(\s+)/g,
		//          lftPrn        lftPrn2                 path    operator err                                                eq          path2       prn    comma   lftPrn2   apos quot        rtPrn   prn2   space
		// (left paren? followed by (path? followed by operator) or (path followed by paren?)) or comma or apos or quot or right paren or space

		rNewLine = /\r?\n/g,
		rUnescapeQuotes = /\\(['"])/g,
		// escape quotes and \ character
		rEscapeQuotes = /([\\'"])/g,
		rBuildHash = /\x08(~)?([^\x08]+)\x08/g,
		rTestElseIf = /^if\s/,
		rFirstElem = /<(\w+)[>\s]/,
		rPrevElem = /<(\w+)[^>\/]*>[^>]*$/,
		autoTmplName = 0,
		viewId = 0,
		escapeMapForHtml = {
			"&": "&amp;",
			"<": "&lt;",
			">": "&gt;"
		},
        attrEncodeChars = /[<"'&]/g,
		htmlEncodeChars = /[\x00<>"'&]/g,
		tmplAttr = "data-jsv-tmpl",
		fnDeclStr = "var j=j||" + (jQuery ? "jQuery." : "js") + "views,",
		slice = [].slice,

		$render = {},
		jsvStores = {
			template: {
				compile: compileTmpl
			},
			tag: {
				compile: compileTag
			},
			helper: {},
			converter: {}
		},

		// jsviews object ($.views if jQuery is loaded)
		$views = {
			jsviews: versionNumber,
			render: $render,
			View: View,
			settings: {
				delimiters: $viewsDelimiters,
				debugMode: TRUE
			},
			sub: {
				// subscription, e.g. JsViews integration
				Error: JsViewsError,
				tmplFn: tmplFn,
				parse: parseParams,
				extend: $extend,
				error: error
//TODO			invoke: $invoke
			},
			_cnvt: convertVal,
			_tag: renderTag,

			// TODO provide better debug experience - e.g. support $.views.onError callback
			_err: function(e) {
				// Place a breakpoint here to intercept template rendering errors
				return $viewsSettings.debugMode ? ("Error: " + (e.message || e)) + ". " : '';
			}
		};

		function JsViewsError(message, object) {
			// Error exception type for JsViews/JsRender
			// Override of $.views.sub.Error is possible
			if (object && object.onError) {
				if (object.onError(message) === FALSE) {
					return;
				}
			}
			this.name = "JsRender Error";
			this.message = message || "JsRender error";
		}

		function $extend(target, source) {
			var name;
			target = target || {};
			for (name in source) {
				target[name] = source[name];
			}
			return target;
		}

//TODO		function $invoke() {
//			try {
//				return arguments[1].apply(arguments[0], arguments[2]);
//			}
//			catch(e) {
//				throw new $views.sub.Error(e, arguments[0]);
//			}
//		}

		(JsViewsError.prototype = new Error()).constructor = JsViewsError;

	//========================== Top-level functions ==========================

	//===================
	// jsviews.delimiters
	//===================

	function $viewsDelimiters(openChars, closeChars, link) {
		// Set the tag opening and closing delimiters and 'link' character. Default is "{{", "}}" and "^"
		// openChars, closeChars: opening and closing strings, each with two characters

		if (!$views.rTag || arguments.length) {
			delimOpenChar0 = openChars ? openChars.charAt(0) : delimOpenChar0; // Escape the characters - since they could be regex special characters
			delimOpenChar1 = openChars ? openChars.charAt(1) : delimOpenChar1;
			delimCloseChar0 = closeChars ? closeChars.charAt(0) : delimCloseChar0;
			delimCloseChar1 = closeChars ? closeChars.charAt(1) : delimCloseChar1;
			linkChar = link || linkChar;
			openChars = "\\" + delimOpenChar0 + "(\\" + linkChar + ")?\\" + delimOpenChar1;  // Default is "{^{"
			closeChars = "\\" + delimCloseChar0 + "\\" + delimCloseChar1;                   // Default is "}}"
			// Build regex with new delimiters
			//          tag    (followed by / space or })   or cvtr+colon or html or code
			rTag = "(?:(?:(\\w+(?=[\\/\\s\\" + delimCloseChar0 + "]))|(?:(\\w+)?(:)|(>)|!--((?:[^-]|-(?!-))*)--|(\\*)))"
				+ "\\s*((?:[^\\" + delimCloseChar0 + "]|\\" + delimCloseChar0 + "(?!\\" + delimCloseChar1 + "))*?)";

			// make rTag available to JsViews (or other components) for parsing binding expressions
			$views.rTag = rTag + ")";

			rTag = new RegExp(openChars + rTag + "(\\/)?|(?:\\/(\\w+)))" + closeChars, "g");

			// Default:    bind           tag       converter colon html     comment            code      params            slash   closeBlock
			//           /{(\^)?{(?:(?:(\w+(?=[\/\s}]))|(?:(\w+)?(:)|(>)|!--((?:[^-]|-(?!-))*)--|(\*)))\s*((?:[^}]|}(?!}))*?)(\/)?|(?:\/(\w+)))}}/g

			rTmplString = new RegExp("<.*>|([^\\\\]|^)[{}]|" + openChars + ".*" + closeChars);
			// rTmplString looks for html tags or { or } char not preceded by \\, or JsRender tags {{xxx}}. Each of these strings are considered NOT to be jQuery selectors
		}
		return [delimOpenChar0, delimOpenChar1, delimCloseChar0, delimCloseChar1, linkChar];
	}

	//=========
	// View.get
	//=========

	function getView(type) {
		// TODO complete/test/provide samples for this
		// If type is undefined, returns root view (view under top view).
		var view = this,
			root = !type || type === "root";
		while (root && view.parent.parent || view && view.type !== type) {
			view = view.parent;
		}
		return view;
	}

	//==========
	// View._hlp
	//==========

	function getHelper(helper) {
		// Helper method called as view._hlp(key) from compiled template, for helper functions or template parameters ~foo
		var wrapped,
			view = this,
			viewCtx = view.ctx ||{},
			tmplHelpers = view.tmpl.helpers || {};

		helper = (
			viewCtx[helper] !== undefined
				? viewCtx
				: tmplHelpers[helper] !== undefined
					? tmplHelpers
					: $helpers[helper] !== undefined
						? $helpers
						: {}
		)[helper];

		if (helper) {
			if (typeof helper === "function") {
				wrapped = function() {
						// If it is of type function, we will wrap it so it gets called with view as 'this' context.
						// If the helper ~foo() was in a data-link expression, the view will have a 'temporary' linkCtx property too.
						// However note that helper functions on deeper paths will not have access to view and tagCtx.
						// For example, ~util.foo() will have the ~util object as 'this' pointer
						var i,
							args = arguments;

						for (i in args) {
							if (typeof args[i] === "function") {
								args[i] = args[i].call(view.data);
							}
						}
						return helper.apply(view, args);
					};
				wrapped.depends = helper.depends;
			}
		}
		return wrapped || helper;
	}

	//==============
	// jsviews._cnvt
	//==============

	function convertVal(converter, view, self, tagCtx, bindingPaths, text) {
		// self is template object or linkCtx object
		if (converter || bindingPaths) {
			var tmplConverter,
				linkCtx = !self.markup && self,
				tag = {
					tagName:  converter + ":",
					tagCtx: tagCtx
				},
				args = tagCtx.args = slice.call(arguments, 5);

			tagCtx.view = view;
			tagCtx.bind = !!(linkCtx || bindingPaths);

			if (linkCtx) {
				linkCtx.tag = tag;
				tag.linkCtx = linkCtx;
				tagCtx.ctx = extendCtx(tagCtx.ctx, linkCtx.view.ctx);
			}
			tag.ctx = tagCtx.ctx || {};
			delete tagCtx.ctx;

			if (converter) {
				// A call to {{cnvt: ... }} or {^{cnvt: ... }} or data-link="{cnvt: ... }"
				tmplConverter = view.tmpl.converters;
				tmplConverter = tmplConverter && tmplConverter[converter] || $converters[converter];
				if (tmplConverter || error("Unknown converter: {{"+ converter + ":")) {
					text = tmplConverter.apply(tag, args);
				}
			}
			if (bindingPaths) {
				// A call to {^{: ... }} or {^{cnvt: ... }}
				bindingPaths = view.tmpl.bnds[bindingPaths-1];
				linkCtx.paths = bindingPaths;
				// Consider being able to switch off binding if parent view is not currently bound.
				view._.tag = tag; // Provide this tag on view, for markerNode on bound tags, and for getting the tagCtx and linkCtx during rendering.
				// Provide this tag on view, for addMarkerNode on bound tags to add the tag to view._.bnds, associated with the tag id,
				// and so when rendering subsequent {{else}}, will be associated with this tag
				//TODO does this work with nested elses and with {^{foo:...}} which also adds tag to view, for markerNodes.
				text = view._.onRender(text, view, TRUE);
	//Example:  text = '<script type="jsv123"></script>' + text + '<script type="jsv123/"></script>';
			}
		}
		return text;
	}

	//=============
	// jsviews._tag
	//=============

	function renderTag(tagName, parentView, self, content, tagCtx, bind) {
		// Called from within compiled template function, to render a template tag
		// Returns the rendered tag

		var ret, render, ctx, elses, tag, tags,
			tmpl = self.markup && self,
			// self is either a template object (if rendering a tag) or a linkCtx object (if linking using a link tag)
			linkCtx = !tmpl && self,
			parentView_ = parentView._,
			parentTmpl = tmpl || parentView.tmpl,
			tmplTags = parentTmpl.tags,
			childTemplates = parentTmpl.templates,
			tagDef = tmplTags && tmplTags[tagName] || $tags[tagName],
			args = tagCtx.args = arguments.length > 6 ? slice.call(arguments, 6) : [],
			props = tagCtx.props || {};

		tagCtx.view = parentView;
		tagCtx.ctx = extendCtx(tagCtx.ctx, parentView.ctx); // Extend parentView.ctx
		ctx = tagCtx.ctx || {};
		delete tagCtx.ctx;

		if (!tagDef) {
			error("Unknown tag: {{"+ tagName + "}}");
			return "";
		}
		tmpl = props.tmpl;

		// Set the tmpl property to the content of the block tag, unless set as an override property on the tag
		content = content && parentTmpl.tmpls[content - 1];
		tmpl = tmpl || content || tagDef.template || undefined;
		tmpl = "" + tmpl === tmpl // if a string
			? childTemplates && childTemplates[tmpl] || $templates[tmpl] || $templates(tmpl)
			: tmpl;

		if (tagName === "else") {
			tag = parentView._.tag;
			// Switch current tagCtx of tag instance to this {{else ...}}
			elses = tag._elses = tag._elses || [];
			elses.push(tmpl);
			tagCtx.isElse = elses.length;
			render = tag.render;
		}
		if (tagDef.init) {
			// init is the constructor for the tag/control instance

			// tags hash: tag.ctx.tags, merged with parentView.ctx.tags,
			tags = ctx.tags = parentView.ctx && extendCtx(ctx.tags, parentView.ctx.tags) || {};

			tag = tag || linkCtx.tag;
			if (tag) {
				// tag has already been instantiated, so keep it, but attach the current context, which may have changed
				// Add tag to tags hash
				tags[tagName] = tag;
			} else {
				// If the tag has not already been instantiated, we will create a new instance and add to the tags hash,
				// so ~tags.tagName will access the tag, even within the rendering of the template content of this tag
//	TODO provide error handling owned by the tag - using tag.onError
//			try {
					tag = tags[tagName] = new tagDef.init(tagCtx, linkCtx, ctx);
//				}
//				catch(e) {
//					tagDef.onError(e);
//				}
				tag.tmpl = tmpl;

				if (linkCtx) {
					tag.attr =
						// Setting attr on tag so renderContent knows whether to include script node markers.
						linkCtx.attr =
							// Setting attr on self to ensure outputting to the correct target attribute.
							linkCtx.attr || tagDef.attr || "";
				}
			}
			ctx.tag = tag;
		} else {
			// This is a simple tag declared as a function. We won't instantiate a specific tag constructor - just a standard instance object.
			tag = tag || {
				// tag instance object if no init constructor
				render: tagDef.render,
				renderContent: renderContent,
				tmpl: tmpl,
				tagName: tagName
			};
		}

		// Provide tagCtx, linkCtx and ctx access from tag
		tag.tagCtx = tagCtx;
		tag.ctx = ctx;
		if (linkCtx) {
			linkCtx.tag = tag;
			tag.linkCtx = linkCtx;
		}

		tag._is = "tag";
		tag._done = tagCtx.isElse ? tag._done : FALSE; // If not an {{else}} this is a new
		tmpl = tmpl || tag.tmpl;
		elses = tag._elses;

//TODO The above works for initial rendering, but when refreshing {^{foo}} need also to associate with {{else}} tags. Use compilation to bind else content templates and expressions with the primary tag template and expression.

		parentView_.tag = tag;
		// Provide this tag on view, for addMarkerNode on bound tags to add the tag to view._.bnds, associated with the tag id,
		// for getting the tagCtx and linkCtx during rendering, and so when rendering subsequent {{else}}, will be associated with this tag
		//TODO does this work with nested elses and with {^{foo:...}} which also adds tag to view, for markerNodes.

//		while (tmpl) {
			// If tagDef has a 'render' function, call it.
			// If the return result is undefined, return "", or, if a template (or content) is provided,
			// return the rendered template(using the current data or the first parameter as data);
			if (render = render || tag.render) {
				ret = render.apply(tag, args);

//	TODO		ret = $invoke(tag, render, args);
			}
			ret = ret !== undefined
				? ret    // Return result of render function unless it is undefined, in which case return rendered template
				: tmpl
					// render template on args[0] if defined, or otherwise on the current data item
					? tag.renderContent(tagCtx.data !== undefined ? tagCtx.data : parentView.data, undefined, parentView)
					: ""; // No return value from render, and no template defined, so return ::

//			tmpl = (tag !== "else" && elses) ? (tagCtx.isElse = tagCtx.isElse || 0, elses[tagCtx.isElse++]) : undefined;
//}

		// If bind, for {^{tag ... }}, insert script marker nodes
		return bind ? parentView_.onRender(ret, parentView, bind) : ret;
	}

	//=================
	// View constructor
	//=================

	function View(context, type, parentView, data, template, key, onRender) {
		// Constructor for view object in view hierarchy. (Augmented by JsViews if JsViews is loaded)
		var views, parentView_,
			isArray = type === "array",
			self_ = {
				key: 0,
				useKey: isArray ? 0 : 1,
				id: "" + viewId++,
				onRender: onRender,
				bnd: {}
			},
			self = {
				data: data,
				tmpl: template,
				views: isArray ? [] : {},
				parent: parentView,
				ctx: context,
				type: type,
				// If the data is an array, this is an 'array view' with a views array for each child 'item view'
				// If the data is not an array, this is an 'item view' with a views 'map' object for any child nested views
				// _useKey is non zero if is not an 'array view' (owning a data array). Uuse this as next key for adding to child views map
				get: getView,
				_hlp: getHelper,
				_: self_
		};

		if (parentView) {
			views = parentView.views;
			parentView_ = parentView._;
			if (parentView_.useKey) {
				// Parent is an 'item view'. Add this view to its views object
				// self._key = is the key in the parent view map
				views[self_.key = "_" + parentView_.useKey++] = self;
			} else {
				// Parent is an 'array view'. Add this view to its views array
				views.splice(
					// self._.key = self.index - the index in the parent view array
					self_.key = self.index =
						key !== undefined
							? key
							: views.length,
				0, self);
			}
			// If no context was passed in, use parent context
			// If context was passed in, it should have been merged already with parent context
			self.ctx = context || parentView.ctx;
		}
		return self;
	}

	//=============
	// Registration
	//=============

	function compileChildResources(parentTmpl) {
		var storeName, resources, resourceName, settings, compile;
		for (storeName in jsvStores) {
			settings = jsvStores[storeName];
			if ((compile = settings.compile) && (resources = parentTmpl[storeName + "s"])) {
				for (resourceName in resources) {
					// compile child resource declarations (templates, tags, converters or helpers)
					resources[resourceName] = compile(resourceName, resources[resourceName], parentTmpl, storeName, settings);
				}
			}
		}
	}

	function compileTag(name, item, parentTmpl) {
		var init, tmpl;
		if (typeof item === "function") {
			// Simple tag declared as function. No presenter instantation.
			item = {
				tagName: name,
				render: item,
				depends: item.depends
			};
		} else {
			// Tag declared as object, used as the prototype for tag instantiation (control/presenter)
			item.tagName = name;
			if (tmpl = item.template) {
				item.template = "" + tmpl === tmpl ? ($templates[tmpl] || $templates(tmpl)) : tmpl;
			}
			if (item.init !== FALSE) {
				init = item.init = item.init || function(tagCtx) {};
				init.prototype = item;
				(init.prototype = item).constructor = init;
			}
		}
		item.renderContent = renderContent;
		item.attr = "html";
		if (parentTmpl) {
			item._parentTmpl = parentTmpl;
		}
//TODO	item.onError = function(e) {
//			var error;
//			if (error = this.prototype.onError) {
//				error.call(this, e);
//			} else {
//				throw e;
//			}
//		}
		return item;
	}

	function compileTmpl(name, tmpl, parentTmpl, storeName, storeSettings, options) {
		// tmpl is either a template object, a selector for a template script block, the name of a compiled template, or a template object

		//==== nested functions ====
		function tmplOrMarkupFromStr(value) {
			// If value is of type string - treat as selector, or name of compiled template
			// Return the template object, if already compiled, or the markup string

			if (("" + value === value) || value.nodeType > 0) {
				try {
					elem = value.nodeType > 0
					? value
					: !rTmplString.test(value)
					// If value is a string and does not contain HTML or tag content, then test as selector
						&& jQuery && jQuery(value)[0];
					// If selector is valid and returns at least one element, get first element
					// If invalid, jQuery will throw. We will stay with the original string.
				} catch (e) { }

				if (elem) {
					// Generally this is a script element.
					// However we allow it to be any element, so you can for example take the content of a div,
					// use it as a template, and replace it by the same content rendered against data.
					// e.g. for linking the content of a div to a container, and using the initial content as template:
					// $.link("#content", model, {tmpl: "#content"});

					// Create a name for compiled template if none provided
					value = $templates[elem.getAttribute(tmplAttr)];
					if (!value) {
						// Not already compiled and cached, so compile and cache the name
						name = name || "_" + autoTmplName++;
						elem.setAttribute(tmplAttr, name);
						$templates[name] = value = compileTmpl(name, elem.innerHTML, parentTmpl, storeName, storeSettings, options); // Use tmpl as options
					}
				}
				return value;
			}
			// If value is not a string, return undefined
		}

		var tmplOrMarkup, elem;

		//==== Compile the template ====
		tmpl = tmpl || "";
		tmplOrMarkup = tmplOrMarkupFromStr(tmpl);

		// If options, then this was already compiled from a (script) element template declaration.
		// If not, then if tmpl is a template object, use it for options
		options = options || (tmpl.markup ? tmpl : {});
		options.tmplName = name;
		if (parentTmpl) {
			options._parentTmpl = parentTmpl;
		}
		// If tmpl is not a markup string or a selector string, then it must be a template object
		// In that case, get it from the markup property of the object
		if (!tmplOrMarkup && tmpl.markup && (tmplOrMarkup = tmplOrMarkupFromStr(tmpl.markup))) {
			if (tmplOrMarkup.fn && (tmplOrMarkup.debug !== tmpl.debug || tmplOrMarkup.allowCode !== tmpl.allowCode)) {
				// if the string references a compiled template object, but the debug or allowCode props are different, need to recompile
				tmplOrMarkup = tmplOrMarkup.markup;
			}
		}
		if (tmplOrMarkup !== undefined) {
			if (name && !parentTmpl) {
				$render[name] = function() {
					return tmpl.render.apply(tmpl, arguments);
				};
			}
			if (tmplOrMarkup.fn || tmpl.fn) {
				// tmpl is already compiled, so use it, or if different name is provided, clone it
				if (tmplOrMarkup.fn) {
					if (name && name !== tmplOrMarkup.name) {
						tmpl = extendCtx(options, tmplOrMarkup);
					} else {
						tmpl = tmplOrMarkup;
					}
				}
			} else {
				// tmplOrMarkup is a markup string, not a compiled template
				// Create template object
				tmpl = TmplObject(tmplOrMarkup, options);
				// Compile to AST and then to compiled function
				tmplFn(tmplOrMarkup, tmpl);
			}
			compileChildResources(options);
			return tmpl;
		}
	}
	//==== /end of function compile ====

	function TmplObject(markup, options) {
		// Template object constructor
		var htmlTag,
			wrapMap = $viewsSettings.wrapMap || {},
			tmpl = $extend(
				{
					markup: markup,
					tmpls: [],
					links: {},
					bnds: [],
					render: renderContent
				},
				options
			);

		if (!options.htmlTag) {
			// Set tmpl.tag to the top-level HTML tag used in the template, if any...
			htmlTag = rFirstElem.exec(markup);
			tmpl.htmlTag = htmlTag ? htmlTag[1].toLowerCase() : "";
		}
		htmlTag = wrapMap[tmpl.htmlTag];
		if (htmlTag && htmlTag !== wrapMap.div) {
			// When using JsViews, we trim templates which are inserted into HTML contexts where text nodes are not rendered (i.e. not 'Phrasing Content').
			tmpl.markup = $.trim(tmpl.markup);
			tmpl._elCnt = TRUE; // element content model (no rendered text nodes), not phrasing content model
		}

		return tmpl;
	}

	function registerStore(storeName, storeSettings) {

		function theStore(name, item, parentTmpl) {
			// The store is also the function used to add items to the store. e.g. $.templates, or $.views.tags

			// For store of name 'thing', Call as:
			//    $.views.things(items[, parentTmpl]),
			// or $.views.things(name, item[, parentTmpl])

			var onStore, compile, items, itemName, childTemplates, childTemplate, thisStore, childStoreName;

			if (name && "" + name !== name && !name.nodeType && !name.markup) {
				// Call to $.views.things(items[, parentTmpl]),

				// Adding items to the store
				// If name is a map, then item is parentTmpl. Iterate over map and call store for key.
				for (itemName in name) {
					theStore(itemName, name[itemName], item);
				}
				return $views;
			}
			thisStore = parentTmpl ? parentTmpl[storeNames] = parentTmpl[storeNames] || {} : theStore;

			// Adding a single unnamed item to the store
			if (item === undefined) {
				item = name;
				name = undefined;
			}
			compile = storeSettings.compile;
			if (onStore = $viewsSub.onBeforeStoreItem) {
				// e.g. provide an external compiler or preprocess the item.
				compile = onStore(thisStore, name, item, compile) || compile;
			}
			if (!name) {
				item = compile(undefined, item);
			} else if ("" + name === name) { // name must be a string
				if (item === null) {
					// If item is null, delete this entry
					delete thisStore[name];
				} else {
					thisStore[name] = compile ? (item = compile(name, item, parentTmpl, storeName, storeSettings)) : item;
					if (storeName === "template" && (childTemplates = thisStore[name].templates)) {
						// This is a template which has child templates defined. We will copy child items of parent template to each
						// child template, since items registered with the parent templates must also be accessible from the child template
						for (childStoreName in jsvStores) {
							// Find child items registered for this parent template
							childStoreName += "s";
							if (items = item[childStoreName]) {
								// Copy these items to each child template
								for (childTemplate in childTemplates ) {
									childTemplate = childTemplates[childTemplate];
									// Copy parent items except if overridden by item of same name in child template
									childTemplate[childStoreName] = extendCtx(childTemplate[childStoreName], items);
								}
							}
						}
					}
				}
			}
			if (item) {
				item._is = storeName;
			}
			if (onStore = $viewsSub.onStoreItem) {
				// e.g. JsViews integration
				onStore(thisStore, name, item, compile);
			}
			return item;
		}

		var storeNames = storeName + "s";

		$views[storeNames] = theStore;
		jsvStores[storeName] = storeSettings;
	}

	//==============
	// renderContent
	//==============

	function renderContent(data, context, parentView, key, isLayout, onRender) {
		// Render template against data as a tree of subviews (nested rendered template instances), or as a string (top-level template).
		// If the data is the parent view, treat as layout template, re-render with the same data context.
		var i, l, dataItem, newView, childView, itemResult, parentContext, props, swapContent, tagCtx, isTag, outerOnRender,
			self = this,
			tmpl = self,
			allowDataLink = self.attr === undefined || self.attr === "html",
			result = "";

		if (key === TRUE) {
			swapContent = TRUE;
			key = 0;
		}
		if (isTag = self._is === "tag") {
			tagCtx = self.tagCtx;
			// This is a call from renderTag
			tmpl = tagCtx.isElse ? self._elses[tagCtx.isElse-1] : self.tmpl;
			context = extendCtx(context, self.ctx);
			props = tagCtx.props || {};
			if ( props.link === FALSE ) {
				// link=false setting on block tag
				// We will override inherited value of link by the explicit setting link=false taken from props
				// The child views of an unlinked view are also unlinked. So setting child back to true will not have any effect.
				context =  context || {};
				context.link = FALSE;
			}
			parentView = parentView || tagCtx.view;
		} else {
			tmpl = self.jquery && (self[0] || error('Unknown template: "' + self.selector + '"')) // This is a call from $(selector).render
				|| self;
		}
		if (tmpl) {
			if (parentView) {
				onRender = onRender || parentView._.onRender;
				parentContext = parentView.ctx;
				if (data === parentView) {
					// Inherit the data from the parent view.
					// This may be the contents of an {{if}} block
					// Set isLayout = true so we don't iterate the if block if the data is an array.
					data = parentView.data;
					isLayout = TRUE;
				}
			}

			// Set additional context on views created here, (as modified context inherited from the parent, and to be inherited by child views)
			// Note: If no jQuery, $extend does not support chained copies - so limit extend() to two parameters
			context = extendCtx(context, parentContext);

			if (!tmpl.fn) {
				tmpl = $templates[tmpl] || $templates(tmpl);
			}

			if (tmpl) {
				onRender = (context && context.link) !== FALSE && allowDataLink && onRender;
				// If link===false, do not call onRender, so no data-linking marker nodes
				outerOnRender = onRender;
				if (onRender === TRUE) {
					// Used by view.refresh(). Don't create a new wrapper view.
					outerOnRender = undefined;
					onRender = parentView._.onRender;
				}
				if ($.isArray(data) && !isLayout) {
					// Create a view for the array, whose child views correspond to each data item.
					// (Note: if key and parentView are passed in along with parent view, treat as
					// insert -e.g. from view.addViews - so parentView is already the view item for array)
					newView = swapContent ? parentView : (key !== undefined && parentView) || View(context, "array", parentView, data, tmpl, key, onRender);
					for (i = 0, l = data.length; i < l; i++) {
						// Create a view for each data item.
						dataItem = data[i];
						childView = View(context, "item", newView, dataItem, tmpl, (key || 0) + i, onRender);
						itemResult = tmpl.fn(dataItem, childView, $views);
						result += newView._.onRender ? newView._.onRender(itemResult, childView) : itemResult;
					}
				} else {
					// Create a view for singleton data object.
					newView = swapContent ? parentView : View(context, "data", parentView, data, tmpl, key, onRender);
					result += tmpl.fn(data, newView, $views);
				}
				return outerOnRender ? outerOnRender(result, newView) : result;
			}
		}
		return "";
	}

	//===========================
	// Build and compile template
	//===========================

	// Generate a reusable function that will serve to render a template against data
	// (Compile AST then build template function)

	function error(message) {
		if ($viewsSettings.debugMode) {
			throw new $views.sub.Error(message);
		}
	}

	function syntaxError(message) {
		error("Syntax error\n" + message);
	}

	function tmplFn(markup, tmpl, isLinkExpression) {
		// Compile markup to AST (abtract syntax tree) then build the template function code from the AST nodes
		// Used for compiling templates, and also by JsViews to build functions for data link expressions


		//==== nested functions ====
		function pushprecedingContent(shift) {
			shift -= loc;
			if (shift) {
				content.push(markup.substr(loc, shift).replace(rNewLine, "\\n"));
			}
		}

		function blockTagCheck(tagName) {
			tagName && syntaxError('Unmatched or missing tag: "{{/' + tagName + '}}" in template:\n' + markup);
		}

		function parseTag(all, bind, tagName, converter, colon, html, comment, codeTag, params, slash, closeBlock, index) {

			//    bind         tag        converter colon html     comment            code      params            slash   closeBlock
			// /{(\^)?{(?:(?:(\w+(?=[\/\s}]))|(?:(\w+)?(:)|(>)|!--((?:[^-]|-(?!-))*)--|(\*)))\s*((?:[^}]|}(?!}))*?)(\/)?|(?:\/(\w+)))}}/g

			// Build abstract syntax tree (AST): [ tagName, converter, params, content, hash, bindings, contentMarkup ]
			if (html) {
				colon = ":";
				converter = "html";
			}
			var current0,
				pathBindings = [],
				code = "",
				hash = "",
				passedCtx = "",
				// Block tag if not self-closing and not {{:}} or {{>}} (special case) and not a data-link expression
				block = !slash && !colon && !comment && !isLinkExpression;

			//==== nested helper function ====
			tagName = tagName || colon;
			pushprecedingContent(index);
			loc = index + all.length; // location marker - parsed up to here
			if (codeTag) {
				if (allowCode) {
					content.push(["*", "\n" + params.replace(rUnescapeQuotes, "$1") + "\n"]);
				}
			} else if (tagName) {
				if (tagName === "else") {
					if (rTestElseIf.test(params)) {
						syntaxError('for "{{else if expr}}" use "{{else expr}}"');
					}
					current[6] = markup.substring(current[6], index); // contentMarkup for block tag
					current = stack.pop();
					content = current[3];
					block = TRUE;
				}
				if (params) {
					code = parseParams(params, pathBindings)
						.replace(rBuildHash, function(all, isCtx, keyValue) {
							if (isCtx) {
								passedCtx += keyValue + ",";
							} else {
								hash += keyValue + ",";
							}
							return "";
						});
				}
				hash = hash.slice(0, -1);
				code = code.slice(0, -1);
				newNode = [
						tagName,
						converter || "",
						code,
						block && [],
						"{" + (hash ? ("props:{" + hash + "},") : "") + 'params:"' + params + '"' + (passedCtx ? ",ctx:{" + passedCtx.slice(0, -1) + "}" : "") + "},",
						bind && pathBindings || 0
					];
				content.push(newNode);
				if (block) {
					stack.push(current);
					current = newNode;
					current[6] = loc; // Store current location of open tag, to be able to add contentMarkup when we reach closing tag
				}
			} else if (closeBlock) {
				current0 = current[0];
				blockTagCheck(closeBlock !== current0 && current0 && current0 !== "else");
				current[6] = markup.substring(current[6], index); // contentMarkup for block tag
				current = stack.pop();
			}
			blockTagCheck(!current && closeBlock);
			content = current[3];
		}
		//==== /end of nested functions ====

		var newNode,
			allowCode = tmpl && tmpl.allowCode,
			astTop = [],
			loc = 0,
			stack = [],
			content = astTop,
			current = [, , , astTop];

		markup = markup.replace(rEscapeQuotes, "\\$1");

//TODO	result = tmplFnsCache[markup];  // Only cache if template is not named and markup length < ..., and there are no bindings or subtemplates?? Consider standard optimization for data-link="a.b.c"
//		if (result) {
//			tmpl.fn = result;
//		} else {

//		result = markup;

		blockTagCheck(stack[0] && stack[0][3].pop()[0]);

		// Build the AST (abstract syntax tree) under astTop
		markup.replace(rTag, parseTag);

		pushprecedingContent(markup.length);

		if (loc = astTop[astTop.length-1]) {
			blockTagCheck("" + loc !== loc && (+loc[6] === loc[6]) && loc[0]);
		}
//			result = tmplFnsCache[markup] = buildCode(astTop, tmpl);
//		}
		return buildCode(astTop, tmpl);
	}

	function buildCode(ast, tmpl) {
		// Build the template function code from the AST nodes, and set as property on the passed-in template object
		// Used for compiling templates, and also by JsViews to build functions for data link expressions
		var i, node, hasTag, hasEncoder, getsValue, hasConverter, hasViewPath, tagName, converter, params, hash, bindings, bindingPaths, nestedTmpls, nestedTmpl, allowCode, content, markup,
			code = "",
			tmplOptions = {},
			l = ast.length;

		if (tmpl) {
			if (allowCode = tmpl.allowCode) {
				tmplOptions.allowCode = TRUE;
			}
			if (tmpl.debug) {
				tmplOptions.debug = TRUE;
			}
			bindings = tmpl.bnds;
			nestedTmpls = tmpl.tmpls;
		}

		for (i = 0; i < l; i++) {
			// AST nodes: [ tagName, converter, params, content, hash, bindings, contentMarkup, link ]
			node = ast[i];

			// Add newline for each callout to t() c() etc. and each markup string
			//TODO consider changing to ret += t()...; so debug break points can be inserted on each callout.
			code += "\nret+=";
			if ("" + node === node) {
				// a markup string to be inserted
				code += '"' + node + '";';
			} else {
				// a compiled tag expression to be inserted
				tagName = node[0];
				if (tagName === "*") {
					// If this {{* }} tag is at the beginning of the template, start with var ret="";
					// Otherwise remove the last "+\n" characters and replace with ";" to complete the ret += ...; statement, prior to inserted user code,
					code = (i ? code.slice(0, -5) : "") + node[1];
				} else {
					converter = node[1];
					params = node[2];
					content = node[3];
					hash = node[4];
					bindingPaths = node[5];
					markup = node[6];

					if (content) {
						// Create template object for nested template
						nestedTmpl = TmplObject(markup, tmplOptions);
						// Compile to AST and then to compiled function
						buildCode(content, nestedTmpl);
						nestedTmpls.push(nestedTmpl);
					}
					if (bindingPaths) {
						// Add leaf binding paths to template
						bindings.push(bindingPaths);
						bindingPaths = bindings.length;
					}
					hasViewPath = hasViewPath || hash.indexOf("view") > -1;
					// Add newline for each callout to t() c() etc.

					//TODO consider changing to ret += t()...; so debug break points can be inserted on each callout. At the same time, pass in ret to c() and t()
					// so they can look at the previous ret, and detect whether this is a jsrender tag within an HTML element tag. If so, don't insert marker nodes,
					// and make the databinding trigger view refresh on parent view... No need for people to set link=false.
					code += tagName === ":"
					? (converter === "html" && !bindingPaths
						? (hasEncoder = TRUE, "h(" + params+ ");")
						: converter || bindingPaths // Call _cnvt if there is a converter, or binding: {{cnvt: ... }}, {^{: ... }} or {^{cnvt: ... }}
							? (hasConverter = TRUE, 'c("' + converter + '",view,this,' + hash + bindingPaths + "," + params + ");")
							: (getsValue = TRUE, "(v=" + params + ')!=u?v:"";')
					)
					: (hasTag = TRUE, 't("' + tagName + '",view,this,'
						+ (content ? nestedTmpls.length : '""') // For block tags, pass in the key (nestedTmpls.length) to the nested content template
						+ "," + hash + bindingPaths + (params ? "," : "") + params) + ");";
				}
			}
		}

		// Include only the var references that are needed in the code
		code = fnDeclStr
		+ (getsValue ? "v," : "")
		+ (hasTag ? "t=j._tag," : "")
		+ (hasConverter ? "c=j._cnvt," : "")
		+ (hasEncoder ? "h=j.converters.html," : "")
		+ 'ret=""; try{\n'
		+ (tmplOptions.debug ? "debugger;" : "")
		+ code + "\nreturn ret;\n\n}catch(e){return j._err(e);}";

		try {
			code = new Function("data, view, j, u", code);
		} catch (e) {
			syntaxError("Compiled template code:\n\n" + code, e);
		}

		if (tmpl) {
			tmpl.fn = code;
		}
		return code;
	}

	function parseParams(params, bindings) {

		function parseTokens(all, lftPrn0, lftPrn, path, operator, err, eq, path2, prn, comma, lftPrn2, apos, quot, rtPrn, prn2, space) {
			// rParams = /(\()(?=|\s*\()|(?:([([])\s*)?(?:([#~]?[\w$^.]+)?\s*((\+\+|--)|\+|-|&&|\|\||===|!==|==|!=|<=|>=|[<>%*!:?\/]|(=))\s*|([#~]?[\w$^.]+)([([])?)|(,\s*)|(\(?)\\?(?:(')|("))|(?:\s*([)\]])([([]?))|(\s+)
			//          lftPrn0-flwed by (- lftPrn               path    operator err                                                eq         path2       prn    comma   lftPrn3   apos quot        rtPrn   prn2   space
			// (left paren? followed by (path? followed by operator) or (path followed by paren?)) or comma or apos or quot or right paren or space
			operator = operator || "";
			lftPrn = lftPrn || lftPrn0 || lftPrn2;
			path = path || path2;
			prn = prn || prn2 || "";

			function parsePath(all, object, helper, view, viewProperty, pathTokens, leafToken) {
				// rPath = /^(?:null|true|false|\d[\d.]*|([\w$]+|~([\w$]+)|#(view|([\w$]+))?)([\w$.^]*?)(?:[.[^]([\w$]+)\]?)?)$/g,
				//                                        object   helper    view  viewProperty pathTokens       leafToken

				if (object) {
					bindings.push(path);
					if (object !== ".") {
						var leaf,
							ret = (helper
								? 'view._hlp("' + helper + '")'
								: view
									? "view"
									: "data")
							+ (leafToken
								? (viewProperty
									? "." + viewProperty
									: helper
										? ""
										: (view ? "" : "." + object)
									) + (pathTokens || "")
								: (leafToken = helper ? "" : view ? viewProperty || "" : object, ""));

						leaf = (leafToken ? "." + leafToken : "");
						ret = ret + leaf;
						ret = ret.slice(0, 9) === "view.data"
						? ret.slice(5) // convert #view.data... to data...
						: ret;
						return ret;
					}
				}
				return all;
			}

			if (err) {
				syntaxError(params);
			} else {
				return (aposed
					// within single-quoted string
					? (aposed = !apos, (aposed ? all : '"'))
					: quoted
					// within double-quoted string
						? (quoted = !quot, (quoted ? all : '"'))
						:
					(
						(lftPrn
								? (parenDepth++, lftPrn)
								: "")
						+ (space
							? (parenDepth
								? ""
								: named
									? (named = FALSE, "\b")
									: ","
							)
							: eq
					// named param
								? (parenDepth && syntaxError(params), named = TRUE, '\b' + path + ':')
								: path
					// path
									? (path.split("^").join(".").replace(rPath, parsePath)
										+ (prn
											? (fnCall[++parenDepth] = TRUE, prn)
											: operator)
									)
									: operator
										? operator
										: rtPrn
					// function
											? ((fnCall[parenDepth--] = FALSE, rtPrn)
												+ (prn
													? (fnCall[++parenDepth] = TRUE, prn)
													: "")
											)
											: comma
												? (fnCall[parenDepth] || syntaxError(params), ",") // We don't allow top-level literal arrays or objects
												: lftPrn0
													? ""
													: (aposed = apos, quoted = quot, '"')
					))
				);
			}
		}
		var named,
			fnCall = {},
			parenDepth = 0,
			quoted = FALSE, // boolean for string content in double quotes
			aposed = FALSE; // or in single quotes

		bindings.expr = params.replace(rUnescapeQuotes, "$1");
		return (params + " ").replace(rParams, parseTokens);
	}

	//==========
	// Utilities
	//==========

	// HTML encoding helper
	function replacerForHtml(ch) {
		// Original code from Mike Samuel <msamuel@google.com>
		return escapeMapForHtml[ch]
			// Intentional assignment that caches the result of encoding ch.
			|| (escapeMapForHtml[ch] = "&#" + ch.charCodeAt(0) + ";");
	}

	// Merge objects, in particular contexts which inherit from parent contexts
	function extendCtx(context, parentContext) {
		// Return copy of parentContext, unless context is defined and is different, in which case return a new merged context
		// If neither context nor parentContext are undefined, return undefined
		return context && context !== parentContext
			? (parentContext
				? $extend($extend({}, parentContext), context)
				: context)
			: parentContext && $extend({}, parentContext);
	}

	//========================== Initialize ==========================

	for (jsvStoreName in jsvStores) {
		registerStore(jsvStoreName, jsvStores[jsvStoreName]);
	}

	var $templates = $views.templates,
		$converters = $views.converters,
		$helpers = $views.helpers,
		$tags = $views.tags,
		$viewsSub = $views.sub,
		$viewsSettings = $views.settings;

	if (jQuery) {
		////////////////////////////////////////////////////////////////////////////////////////////////
		// jQuery is loaded, so make $ the jQuery object
		$ = jQuery;
		$.render = $render;
		$.views = $views;
		$.templates = $templates = $views.templates;
		$.fn.render = renderContent;

	} else {
		////////////////////////////////////////////////////////////////////////////////////////////////
		// jQuery is not loaded.

		$ = global.jsviews = $views;

		$.isArray = Array && Array.isArray || function(obj) {
			return Object.prototype.toString.call(obj) === "[object Array]";
		};
	}

	//========================== Register tags ==========================

	$tags({
		"if": function(val) {
			var self = this;
				// If not done and val is truey, set done=true on tag instance and render content. Otherwise return ""
				// On else will call this function again on the same tag instance.
			return (self._done || arguments.length && !val)
				? ""
				: (self._done = true,
					// Test is satisfied, so render content on current context. Rather than return undefined
					// (which will render the tmpl/content on the current context but will iterate if it is an array),
					// we pass in the view. This ensures treating as a layout template - with no iteration
					self.renderContent(self.tagCtx.view));
		},
// Temporary fix for binding to {{if}}
//	"if": {
//		render: function(val) {
//			var self = this;
//			return (self._done || arguments.length && !val) ? "" : (self._done = true, self.renderContent(self.tagCtx.view));
//		}
//	},
		"else": function() {}, // Does nothing but ensures {{else}} tags are recognized as valid
		"for": function() {
			var i, arg, undef,
				self = this,
				tagCtx = self.tagCtx,
				result = "",
				args = arguments,
				done = 0,
				l = args.length;

			if (!l) {
				return tagCtx.done
					? ""
					: (tagCtx.done = TRUE,
						// Test is satisfied, so render content on current context. Rather than return undefined
						// (which will render the tmpl/content on the current context but will iterate if it is an array),
						// we pass in the view. This ensures treating as a layout template - with no iteration
						self.renderContent(tagCtx.view));
			}
			for (i = 0; i < l; i++) {
				arg = args[i];
				undef = arg === undefined;
				if (!undef) {
					done += $.isArray(arg) ? arg.length : 1;
					result += self.renderContent(arg);
				} else {
					return "";
				}
			}
			tagCtx.done = done;
			return result;
		},
		"*": function(value) {
			return value;
		}
	});

	//========================== Register global helpers ==========================

	//	$helpers({ // Global helper functions
	//		// TODO add any useful built-in helper functions
	//	});

	//========================== Register converters ==========================

	$converters({
		html: function(text) {
			// HTML encoding helper: Replace < > & and ' and " by corresponding entities.
			return text != undefined ? String(text).replace(htmlEncodeChars, replacerForHtml) : "";
		},
		attr: function(text) {
			// Attribute encoding helper: Replace < & ' and " by corresponding entities.
			return text != undefined ? String(text).replace(attrEncodeChars, replacerForHtml) : "";
		},
		url: function(text) {
			// TODO - support chaining {{attr|url:....}} to protect against injection attacks from url parameters containing " or '.
			// URL encoding helper.
			return text != undefined ? encodeURI(String(text)) : "";
		}
	});

	//========================== Define default delimiters ==========================
	$viewsDelimiters();

})(this, this.jQuery);
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: slovensko\js\mykkro-viewer.js
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\slovensko\js\mykkro-viewer.js
VELIKOST: 207477 B (202.61 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
// configuration file
var DEBUG = false;

var Config = {
};
var __ = function(arg) {
    return LocaleStrings[arg] || arg;
}

/*
	Base.js, version 1.1
	Copyright 2006-2007, Dean Edwards
	License: http://www.opensource.org/licenses/mit-license.php
*/

var Base = function() {
	// dummy
};

Base.extend = function(_instance, _static) { // subclass
	var extend = Base.prototype.extend;
	
	// build the prototype
	Base._prototyping = true;
	var proto = new this;
	extend.call(proto, _instance);
	delete Base._prototyping;
	
	// create the wrapper for the constructor function
	//var constructor = proto.constructor.valueOf(); //-dean
	var constructor = proto.constructor;
	var klass = proto.constructor = function() {
		if (!Base._prototyping) {
			if (this._constructing || this.constructor == klass) { // instantiation
				this._constructing = true;
				constructor.apply(this, arguments);
				delete this._constructing;
			} else if (arguments[0] != null) { // casting
				return (arguments[0].extend || extend).call(arguments[0], proto);
			}
		}
	};
	
	// build the class interface
	klass.ancestor = this;
	klass.extend = this.extend;
	klass.forEach = this.forEach;
	klass.implement = this.implement;
	klass.prototype = proto;
	klass.toString = this.toString;
	klass.valueOf = function(type) {
		//return (type == "object") ? klass : constructor; //-dean
		return (type == "object") ? klass : constructor.valueOf();
	};
	extend.call(klass, _static);
	// class initialisation
	if (typeof klass.init == "function") klass.init();
	return klass;
};

Base.prototype = {	
	extend: function(source, value) {
		if (arguments.length > 1) { // extending with a name/value pair
			var ancestor = this[source];
			if (ancestor && (typeof value == "function") && // overriding a method?
				// the valueOf() comparison is to avoid circular references
				(!ancestor.valueOf || ancestor.valueOf() != value.valueOf()) &&
				/\bbase\b/.test(value)) {
				// get the underlying method
				var method = value.valueOf();
				// override
				value = function() {
					var previous = this.base || Base.prototype.base;
					this.base = ancestor;
					var returnValue = method.apply(this, arguments);
					this.base = previous;
					return returnValue;
				};
				// point to the underlying method
				value.valueOf = function(type) {
					return (type == "object") ? value : method;
				};
				value.toString = Base.toString;
			}
			this[source] = value;
		} else if (source) { // extending with an object literal
			var extend = Base.prototype.extend;
			// if this object has a customised extend method then use it
			if (!Base._prototyping && typeof this != "function") {
				extend = this.extend || extend;
			}
			var proto = {toSource: null};
			// do the "toString" and other methods manually
			var hidden = ["constructor", "toString", "valueOf"];
			// if we are prototyping then include the constructor
			var i = Base._prototyping ? 0 : 1;
			while (key = hidden[i++]) {
				if (source[key] != proto[key]) {
					extend.call(this, key, source[key]);

				}
			}
			// copy each of the source object's properties to this object
			for (var key in source) {
				if (!proto[key]) extend.call(this, key, source[key]);
			}
		}
		return this;
	},

	base: function() {
		// call this method from any other method to invoke that method's ancestor
	}
};

// initialise
Base = Base.extend({
	constructor: function() {
		this.extend(arguments[0]);
	}
}, {
	ancestor: Object,
	version: "1.1",
	
	forEach: function(object, block, context) {
		for (var key in object) {
			if (this.prototype[key] === undefined) {
				block.call(context, object[key], key, object);
			}
		}
	},
		
	implement: function() {
		for (var i = 0; i < arguments.length; i++) {
			if (typeof arguments[i] == "function") {
				// if it's a function, call it
				arguments[i](this.prototype);
			} else {
				// add the interface using the extend method
				this.prototype.extend(arguments[i]);
			}
		}
		return this;
	},
	
	toString: function() {
		return String(this.valueOf());
	}
});

// requires: jquery

var log = function(what) {
    $("body").prepend($("<pre>").text(what));
}

var ajaxify = function(sel) {
    $(sel || ".ajaxify").each(function() {
        $(this).load($(this).data("target"));
    })
}

// From http://www.terrainformatica.com/?p=13
var delegate = function( that, thatMethod )
{
    if(arguments.length > 2)
    {
        var _params = [];
        for(var n = 2; n < arguments.length; ++n) _params.push(arguments[n]);
        return function() { return thatMethod.apply(that,_params); };
    }
    else
      return function() { return thatMethod.call(that); };
}

var delegate_cp = function( that, thatMethod ) {
    return function() { return thatMethod.apply(that,arguments); }
};

function utf8_encode( s ) {
  return unescape( encodeURIComponent( s ) );
}

function utf8_decode( s ) {
  return decodeURIComponent( escape( s ) );
}

function html_encode( input ) {
    return String(input)
        .replace(/&/g, '&amp;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '\'')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;');
}

function html_decode( input ) {
    return String(input)
        .replace(/&amp;/g, '&')
        .replace(/&quot;/g, '\"')
        .replace(/'/g, '\'')
        .replace(/&lt;/g, '<')
        .replace(/&gt;/g, '>');
}

function base64_decode (data) {
  // http://kevin.vanzonneveld.net
  // +   original by: Tyler Akins (http://rumkin.com)
  // +   improved by: Thunder.m
  // +      input by: Aman Gupta
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +   bugfixed by: Onno Marsman
  // +   bugfixed by: Pellentesque Malesuada
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +      input by: Brett Zamir (http://brett-zamir.me)
  // +   bugfixed by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // *     example 1: base64_decode('S2V2aW4gdmFuIFpvbm5ldmVsZA==');
  // *     returns 1: 'Kevin van Zonneveld'
  // mozilla has this native
  // - but breaks in 2.0.0.12!
  //if (typeof this.window['atob'] == 'function') {
  //    return atob(data);
  //}
  var b64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
  var o1, o2, o3, h1, h2, h3, h4, bits, i = 0,
    ac = 0,
    dec = "",
    tmp_arr = [];

  if (!data) {
    return data;
  }

  data += '';

  do { // unpack four hexets into three octets using index points in b64
    h1 = b64.indexOf(data.charAt(i++));
    h2 = b64.indexOf(data.charAt(i++));
    h3 = b64.indexOf(data.charAt(i++));
    h4 = b64.indexOf(data.charAt(i++));

    bits = h1 << 18 | h2 << 12 | h3 << 6 | h4;

    o1 = bits >> 16 & 0xff;
    o2 = bits >> 8 & 0xff;
    o3 = bits & 0xff;

    if (h3 == 64) {
      tmp_arr[ac++] = String.fromCharCode(o1);
    } else if (h4 == 64) {
      tmp_arr[ac++] = String.fromCharCode(o1, o2);
    } else {
      tmp_arr[ac++] = String.fromCharCode(o1, o2, o3);
    }
  } while (i < data.length);

  dec = tmp_arr.join('');

  return dec;
}



function base64_encode (data) {
  // http://kevin.vanzonneveld.net
  // +   original by: Tyler Akins (http://rumkin.com)
  // +   improved by: Bayron Guevara
  // +   improved by: Thunder.m
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +   bugfixed by: Pellentesque Malesuada
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +   improved by: Rafał Kukawski (http://kukawski.pl)
  // *     example 1: base64_encode('Kevin van Zonneveld');
  // *     returns 1: 'S2V2aW4gdmFuIFpvbm5ldmVsZA=='
  // mozilla has this native
  // - but breaks in 2.0.0.12!
  //if (typeof this.window['btoa'] == 'function') {
  //    return btoa(data);
  //}
  var b64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
  var o1, o2, o3, h1, h2, h3, h4, bits, i = 0,
    ac = 0,
    enc = "",
    tmp_arr = [];

  if (!data) {
    return data;
  }

  do { // pack three octets into four hexets
    o1 = data.charCodeAt(i++);
    o2 = data.charCodeAt(i++);
    o3 = data.charCodeAt(i++);

    bits = o1 << 16 | o2 << 8 | o3;

    h1 = bits >> 18 & 0x3f;
    h2 = bits >> 12 & 0x3f;
    h3 = bits >> 6 & 0x3f;
    h4 = bits & 0x3f;

    // use hexets to index into b64, and append result to encoded string
    tmp_arr[ac++] = b64.charAt(h1) + b64.charAt(h2) + b64.charAt(h3) + b64.charAt(h4);
  } while (i < data.length);

  enc = tmp_arr.join('');

  var r = data.length % 3;

  return (r ? enc.slice(0, r - 3) : enc) + '==='.slice(r || 3);

}

/**
 * Returns the first data element of an object, regardless on its key name.
 */
var extractRoot = function(data) {
  for(var key in data) {
    return data[key];
  }
}


Array.prototype.toObject = function() {
    var out = {};
    for(var i=0; i<this.length; i++) {
        out[i] = this[i];
    }
    return out;
}

// Array.copy() - Copy an array
if( typeof Array.prototype.copy==='undefined' ) {
 Array.prototype.copy = function() {
  var a = [], i = this.length;
  while( i-- ) {
   a[i] = typeof this[i].copy!=='undefined' ? this[i].copy() : this[i];
  }
  return a;
 };
}

// Array.insert( index, value ) - Insert value at index, without overwriting existing keys
Array.prototype.insert = function( i, v ) {
 if( i>=0 ) {
  var a = this.slice(), b = a.splice( i );
  a[i] = v;
  return a.concat( b );
 }
};

// Array Remove - By John Resig (MIT Licensed)
Array.prototype.remove = function(from, to) {
  var rest = this.slice((to || from) + 1 || this.length);
  this.length = from < 0 ? this.length + from : from;
  return this.push.apply(this, rest);
};

// Array.random( range ) - Return a random element, optionally up to or from range
Array.prototype.random = function( r ) {
 var i = 0, l = this.length;
 if( !r ) { r = this.length; }
 else if( r > 0 ) { r = r % l; }
 else { i = r; r = l + r % l; }
 return this[ Math.floor( r * Math.random() - i ) ];
};

// Array.shuffle( deep ) - Randomly interchange elements
Array.prototype.shuffle = function( b ) {
 var i = this.length, j, t;
 while( i ) {
  j = Math.floor( ( i-- ) * Math.random() );
  t = b && typeof this[i].shuffle!=='undefined' ? this[i].shuffle() : this[i];
  this[i] = this[j];
  this[j] = t;
 }
 return this;
};

// Array.unique( strict ) - Remove duplicate values
Array.prototype.unique = function( b ) {
 var a = [], i, l = this.length;
 for( i=0; i<l; i++ ) {
  if( a.indexOf( this[i], 0, b ) < 0 ) { a.push( this[i] ); }
 }
 return a;
};

// Array.walk() - Change each value according to a callback function
Array.prototype.walk = function( f ) {
 var a = [], i = this.length;
 while(i--) { a.push( f( this[i] ) ); }
 return a.reverse();
};

String.prototype.capitalize = function() {
    return this.charAt(0).toUpperCase() + this.slice(1);
}

//String.prototype.trim=function(){return this.replace(/^\s\s*/, '').replace(/\s\s*$/, '');};

// deprecated: use trimLeft, trimRight
/*
String.prototype.ltrim=function(){return this.replace(/^\s+/,'');}

String.prototype.rtrim=function(){return this.replace(/\s+$/,'');}
*/
String.prototype.fulltrim=function(){return this.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,'').replace(/\s+/g,' ');}

String.prototype.camelCase = function() { 
    var s = this.trim();
    return ( /\S[A-Z]/.test( s ) ) ?
        s.replace( /(.)([A-Z])/g, function(t,a,b) { return a + ' ' + b.toLowerCase(); } ) :
        s.replace( /( )([a-z])/g, function(t,a,b) { return b.toUpperCase(); } );
}

// code generation utilities

var CodeGenUtils = {
    getSetterName: function(name) {
        return "set" + name.capitalize();
    },
    getGetterName: function(name, isBoolean) {
        return (isBoolean ? "is" : "get") + name.capitalize();
    }
}



String.prototype.endsWith = function(suffix) {
    return this.indexOf(suffix, this.length - suffix.length) !== -1;
};

String.prototype.startsWith = function (str){
    return this.slice(0, str.length) == str;
};


jQuery.fn.swap = function(b) {
    b = jQuery(b)[0];
    var a = this[0];

    var t = a.parentNode.insertBefore(document.createTextNode(''), a);
    b.parentNode.insertBefore(a, b);
    t.parentNode.insertBefore(b, t);
    t.parentNode.removeChild(t);

    return this;
};


// smallest jQuery plugin :)
jQuery.fn.reverse = [].reverse;


$.extend({
  jYoutube: function( url, size ){
    if(url === null){ return ""; }

    size = (size === null) ? "big" : size;
    var vid;
    var results;

    results = url.match("[\\?&amp;]v=([^&amp;#]*)");

    vid = ( results === null ) ? url : results[1];

    if(size == "small"){
      return "http://img.youtube.com/vi/"+vid+"/2.jpg";
    }else {
      return "http://img.youtube.com/vi/"+vid+"/0.jpg";
    }
  }
});

var makeSvgScalable = function(svg) {
    var el = svg[0];
    var ww = el.getAttribute("width");
    var hh = el.getAttribute("height");
    el.setAttribute('width', '100%');
    el.setAttribute('height', '100%');
    el.setAttribute('viewBox', '0 0 '+ww+' '+hh);
    el.setAttribute('preserveAspectRatio', 'xMidyMid meet');
};

var Common = {
    postJsonData: function(url, data, success, error) {
        $.ajax({
            type: "post",       // Request method: post, get
            url: url,
            data: JSON.stringify(data), 
            dataType: "json",    // Expected response type
            contentType: "application/json",
            cache: false,
            success: success || $.noop,
            error: error || $.noop
        });
    },
    isValidUrl: function(str) {
      var pattern = new RegExp('^(https?:\\/\\/)?'+ // protocol
      '((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|'+ // domain name
      '((\\d{1,3}\\.){3}\\d{1,3}))'+ // OR ip (v4) address
      '(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*'+ // port and path
      '(\\?[;&a-z\\d%_.~+=-]*)?'+ // query string
      '(\\#[-a-z\\d_]*)?$','i'); // fragment locator
      if(!pattern.test(str)) {
        return false;
      } else {
        return true;
      }
    }
};

var JQ = {
    button: function(caption, click, parent) {
        var btn = $("<button>").text(caption);
        if(click) btn.click(click);
        if(parent) btn.appendTo(parent);
        return btn;
    },
    linkButton: function(content, click, parent) {
        var btn = JQ.put($("<a>"), content);
        if(click) btn.click(click);
        if(parent) btn.appendTo(parent);
        return btn;
    },
    link: function(content, href, tooltip, parent) {
        var link = JQ.put($("<a>"), content).attr({"title":tooltip, "href":href});
        if(parent) link.appendTo(parent);
        return link;
    },
    ul: function(parent) {
        var ul = $("<ul>");
        if(parent) ul.appendTo(parent);
        return ul;
    },
    li: function(klass, parent) {
        var li = $("<li>").addClass(klass);
        if(parent) li.appendTo(parent);
        return li;
    },
    checkbox: function(name, checked, parent) {
        var input = $("<input>").attr({'type':'checkbox', 'name':name}).prop("checked", checked);
        if(parent) input.appendTo(parent);
        return input;
    },
    textfield: function(name, value, parent) {
        var input = $("<input>").attr({'type':'text', 'name':name, "value":value});
        if(parent) input.appendTo(parent);
        return input;
    },
    span: function(content, klass, parent) {
        var span = JQ.put("span", content).addClass(klass);
        if(parent) span.appendTo(parent);
        return span;
    },
    div: function(content, klass, parent) {
        var div = JQ.put("div", content).addClass(klass);
        if(parent) div.appendTo(parent);
        return div;
    },
    p: function(content, klass, parent) {
        var p = JQ.put("p", content).addClass(klass);
        if(parent) p.appendTo(parent);
        return p;
    },
    h1: function(content, klass, parent) {
        return JQ.hN(1, content, klass, parent);
    },
    h2: function(content, klass, parent) {
        return JQ.hN(2, content, klass, parent);
    },
    h3: function(content, klass, parent) {
        return JQ.hN(3, content, klass, parent);
    },
    h4: function(content, klass, parent) {
        return JQ.hN(4, content, klass, parent);
    },
    h5: function(content, klass, parent) {
        return JQ.hN(5, content, klass, parent);
    },
    h6: function(content, klass, parent) {
        return JQ.hN(6, content, klass, parent);
    },
    hN: function(level, content, klass, parent) {
        var heading = JQ.put("h"+level, content).addClass(klass);
        if(parent) heading.appendTo(parent);
        return heading;
    },
    label: function(content, klass, parent) {
        var label = JQ.put("label", content).addClass(klass);
        if(parent) label.appendTo(parent);
        return label;
    },
    clear: function(parent) {
        var clr = $("<div>").addClass("clear");
        if(parent) clr.appendTo(parent);
        return clr;
    },
    show: function(elem, enabled) {
        if(enabled) elem.show(); else elem.hide();
    },
    form: function(klass, parent) {
        var div = $("<form>").addClass(klass);
        if(parent) div.appendTo(parent);
        return div;
    },
    fieldset: function(klass, parent) {
        var div = $("<fieldset>").addClass(klass);
        if(parent) div.appendTo(parent);
        return div;
    },
    toggleLink: function(captionOn, captionOff, target, parent) {
        var visible = target.is(":visible");
        var btn = JQ.put("a", visible ? captionOn : captionOff).click(function() {
            var visible = target.is(":visible");
            if(visible) {
                target.hide();
                btn.text(captionOff);
            } else {
                target.show();
                btn.text(captionOn);
            }
        });
        if(parent) btn.appendTo(parent);
        return btn;
    },
    linkExt: function(caption, href, tooltip, parent) {
        return JQ.link(caption, href, tooltip, parent).attr("target","_blank");
    },
    put: function(where, what) {
        if(typeof(where) == "string") {
            where = $("<"+where+">");
        }
        if(what) {
            if(typeof(what) == "string") {
                where.text(what);
            } else {
                where.append(what);
            }
        }
        return where;
    }
};

// kazda 'vec' ma options (s defaultni hodnotou) a slots
var Thing = Base.extend({
    constructor: function(options, slots) {
        this.options = $.extend({}, this.defaults(), options);        
        this.tid = Thing.tid++;
        Thing.things[this.tid] = this;
        this.element = $("<div>").addClass(this.getClass()).attr("data-tid", this.tid);
        if(DEBUG) {
            this.element.css("background-color", '#'+Math.floor(Math.random()*16777215).toString(16));
        }
        this.slots = {};
        this.parent = null;
        this.name = null;
        // initializing...
	    this.slotChanged($.noop);
        this.init();
        this.setSlots(slots);
        // display update
        this.refresh();
    },
    copy: function() {
        return Thing.create(this.serialize());
    },
    remove: function() {
        this.replaceWith(Thing.empty());        
    },
    replaceWith: function(thing) {
        if(this.parent) {
            this.parent.setSlot(this.name, thing);
            this.parent = null;
            this.name = null;           
            Thing.things[this.tid] = null;
        }
    },
    // obali this dekoratorem
    decorate: function(deco) {
        if(this.parent) {
            var par = this.parent;
            var slot = this.name;
            deco.setSlot('content', this);
            par.setSlot(slot, deco);
            return deco;
        }
    },
    serialize: function() {
        var slots = {};
        var numslots = 0;
        for(var key in this.slots) {
            slots[key] = this.slots[key].serialize();
            numslots++;
        }
        var obj = {
            type: this.getType(),
            options: this.options
        };
        if(numslots) obj.slots = slots
        return obj;
    },
    getType: function() {
        return this._type;
    },
    getClass: function() {
        return this._klass.split(" ").map(function(a){return "mykkro-"+a;}).join(" ");
    },
    init: function() {
        // create structure and variables
    },
    refresh: function() {
        // options changed...
        this.element.attr('class','');
        this.element.addClass(this.getClass());
        this.element.addClass(this.options.css);
    },
    get: function() {
        return this.element;
    },
    defaults: function() {
        return this._defaults;
    },
    // muzeme se dostat takhle i ke slotu ve slotu
    content: function(key, value) {
        var ndx = key.indexOf(".");
        if(ndx>=0) {
            // odkazujeme se na slot ve slotu
            var newKey = key.substring(0,ndx);
            var rest = key.substring(ndx+1);
            return this.getSlot(newKey).content(rest, value);
        }
        if(this.hasSlot(key)) {
            if(value) {
                // setter
                this.setSlot(key, value);
                return this;
            } else {
                // getter
                return this.getSlot(key);
            }
        } else {
            // unknown slot!
            return null;
        }
    },
    hasSlot: function(key) {
        return !!this.slots[key];
    },
    getSlot: function(key) {
        return this.slots[key];
    },
    setSlot: function(key, thing) {
        this.slots[key] = thing;
        thing._setParent(this, key);
        // DOM manipulation - to be overridden
	    this.slotChanged(key);
        return this;
    },
    removeSlot: function(key) {
        delete this.slots[key]
    },
    clearSlots: function() {
        for(var key in this.slots) {
            this.setSlot(key, Thing.empty());
        }
    },
    setOptions: function(opts) {
        this.options = $.extend(this.options, opts);
        this.refresh();
	    this.slotChanged('options');
    },
    setSlots: function(slots) {
        if(slots) {
            // pokud je parametr pole, udelat z nej objekt
            if($.isArray(slots)) slots = slots.toObject();
            for(var key in slots) {
                this.setSlot(key, slots[key]);
            }
        }
    },
    _setParent: function(parent, key) {
        this.parent = parent;
        this.name = key;
    },
    isEmpty: function() {
        return this.getType() == "empty";
    },
    slotChanged: function(arg) {
        if(typeof arg == "function") {
            this.onslotchanged = arg;
        } else {
            return this.onslotchanged(this, arg);
        }
    },    
    // bez parametru vraci rekurzivne vsechny sloty
    findSlots: function(predicate, out) {
        if(!predicate) predicate = function() { return true; };
        if(!out) out = [];
        if(predicate(this)) out.push(this);
        for(var key in this.slots) {
            this.slots[key].findSlots(predicate, out);
        }
        return out;
    },
    findEmptySlots: function(out) {
        return this.findSlots(function(thing) { return thing.isEmpty(); }, out)
    },
    findSlotsByType: function(type, out) {
        return this.findSlots(function(thing) { return thing.getType() == type; }, out)
    },
    getTree: function() {
        var node = { type: this.getType(), children: {} };
        for(var key in this.slots) {
            node.children[key] = this.slots[key].getTree();
        }
        return node;
    },
    _toggleTreeView: function(node) {
        node.children(".slots").toggleClass('collapsed');
    },
    // TODO mohlo by si to pamatovat expands/collapse mezi updaty
    /* example decorator:
        decorator = function(thing, node) {
            $("<div>").addClass("toolz").insertAfter(node.find(">h2"));
        };
    */
    getTreeView: function(decorator) {
        var self = this;
        var node = $("<div>").addClass('node').attr('data-type', this.getType()).attr('data-tid', this.tid);
        var hdr = $("<h2>").text(this.getType()).appendTo(node);
        var slots = $("<div>").addClass('slots').appendTo(node);
        hdr.click(function() {
            self._toggleTreeView(node);
        });
        for(var key in this.slots) {
            (function(){
                var subtree = self.slots[key].getTreeView(decorator);
                var subheading = $("<h3>").text(key).click(function() {
                    $(this).toggleClass('collapsed');
                    self._toggleTreeView(subtree);
                });
                slots.append(subheading);
                slots.append(subtree);
            })();
        }
        node.append($("<div>").addClass('clear'));
        if(decorator) decorator(this, node);
        return node;
    },
    _type: "thing",
    _defaults: {
        "css": ""
    },
    _klass: "thing",
    _schema: {
       "type":"object",
       "properties":{
       },
       "additionalProperties":true
    }

},{    
    tid: 0,
    things: {},
    create: function(def, opts) {
        if(!def) {
            return Thing.empty();
        }
        // udelat deserializaci
        // { type, options, slots }
        var klassName = def.type.replace(/-([a-z])/g, function (g) { return g[1].toUpperCase() });
        klassName = klassName.capitalize();
        var klazz = window[klassName];
        var slots = def.slots;
        var oid = def.id;
        if($.isArray(slots)) slots = slots.toObject();
        for(var key in slots) {
            slots[key] = Thing.create(slots[key]);
        }
        var thing = new klazz($.extend(def.options, opts), slots);
        thing.oid = oid
        return thing
    },
    empty: function(options) {
        return new Empty(options);
    }
});



var Empty = Thing.extend({
    refresh: function() {
        this.element.empty();
        /*
        if(this.parent) this.element.html(
            $("<div>").text(this.parent.getType()+"#"+this.name)
        );
        */
    },
    _setParent: function(parent, key) {
        this.base(parent, key);
        this.refresh();
    },
    _klass: "empty thing",
    _type: "empty"
});


var Imager = Thing.extend({
    refresh: function() {
        var img = $("<div>")
            .css("background-image",'url("'+this.options.url+'")')
            .css('background-position',this.options['position'])
            .css('background-repeat',this.options['repeat'])
            .css('background-color',this.options['color'])
            .css('background-size',this.options['size'])
            .css('-moz-background-size',this.options['size'])
            .css('-webkit-background-size',this.options['size']);
        this.element.html(img);
    },
    _klass: "imager thing",
    _type: "imager",
    _defaults: {
        "url": "images/demo/australie1.jpg",
        "repeat": "no-repeat",
        "position": "center center",
        "color": "white",
        "size": "cover" 
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "color": {
			    "type":"string",
			    "id": "color",
			    "required":true,
                "format": "color"
		    },
		    "position": {
			    "type":"string",
			    "id": "position",
			    "required":true
		    },
		    "repeat": {
			    "type":"string",
			    "id": "repeat",
			    "required":true
		    },
		    "size": {
			    "type":"string",
			    "id": "size",
                "enum":["cover","contain"],
			    "required":true
		    },
		    "url": {
			    "type":"string",
			    "id": "url",
                "format": "my-image-uri",
			    "required":true
		    }
	    }
    }

});


var RaphaelThing = Thing.extend({
    refresh: function() {
        var o = this.options;
        var div = $("<div>");
        this.element.html(div);
        var paper = Raphael(div.get(0), "100%","100%");
        paper.setViewBox(0, 0, o.width, o.height, true);
        this.canvas = paper;
    },
    _klass: "raphael-thing thing",
    _type: "raphael-thing",
    _defaults: {
        width: 100,
        height: 100
    },
    _schema: {
       "type":"object",
       "description":"RaphaelThing properties",
       "properties":{
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }

});


var CanvasThing = Thing.extend({
    init: function() {
        var o = this.options;
        var self = this;
        this.canvas = $("<canvas>").appendTo(this.element).attr({width:o.width, height:o.height});
        // pouziva CSS transformaci, rastr je porad stejne velky
        if(o.autoscale) {
            this.element.resize(function() {
                var el = $(this);
                var o = self.options;
                var zoom = Math.min(el.width()/o.width, el.height()/o.height);
                el.css({
                    "-moz-transform": "scale("+zoom+")", 
                    "-webkit-transform": "scale("+zoom+")", 
                    "-moz-transform-origin":"0px 0px", 
                    "-webkit-transform-origin":"0px 0px"
                });
            });
        }
        // zvetsuje fyzicky pocet pixelu rastru
        if(o.autoresize) {
            this.element.resize(function() {
                var el = $(this);
                var ww = el.width();
                var hh = el.height();
                if(o.keepaspectratio) { var asp = o.width/o.height; if(ww/hh > asp) ww = hh*asp; else hh = ww/asp; }
                self.canvas.attr({
                    "width": ww, 
                    "height": hh
                });
                self.refresh();
            });
            var el = this.element;
            var ww = el.width();
            var hh = el.height();
            if(o.keepaspectratio) { var asp = o.width/o.height; if(ww/hh > asp) ww = hh*asp; else hh = ww/asp; }
            this.canvas.attr({
                "width": ww, 
                "height": hh
            });            
        }
    },
    refresh: function() {
        var context = this.canvas.get(0).getContext('2d');
        if (context) {
            this.draw(context, this.canvas.width() || this.options.width, this.canvas.height() || this.options.height);
        }
    },
    draw: function(g, w, h) {
        /* by default, draws only rectangle... */
        g.strokeRect(0,  0, w, h);
    },
    _klass: "canvas-thing thing",
    _type: "canvas-thing",
    _defaults: {
        width: 100,
        height: 100,
        autoscale: false,
        autoresize: true,
        keepaspectratio: true
    },
    _schema: {
       "type":"object",
       "description":"CanvasThing properties",
       "properties":{
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          },
          "autoscale":{
             "type":"boolean",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


// http://www.nihilogic.dk/labs/javascript_canvas_fractals/
var Fractal = CanvasThing.extend({
    draw: function(ctx, w, h) {
        var smoothColors = this.options.smoothcolors;
        var vx = this.options.vx;
        var vy = this.options.vy;
        var zoom = this.options.zoom;

        var imageData = !!ctx.getImageData;
        var startit = 30;
        var xmin, xmax, ymin, ymax, dx, dy;
        var er = 2;

        var colors = {
	        red : [[0,0,1],[0,1,0],[0,1,0]],
	        blue : [[0,0,0],[0,1,0],[0,1,1]],
	        green : [[0,1,0],[0,0,1],[0,1,0]],
	        orange : [[1,1,1],[0,1,0],[0,0,0]],
	        magenta : [[0,0,1],[0,0.1,0.5],[0,0,1]],
	        yellow : [[0.2,0.2,1],[0.2,0.2,1],[0,0,0.2]],

        };

        var log2 = 1 / Math.log(2.0);
        var sin = Math.sin;
        var cos = Math.cos;
        var exp = Math.exp;
        var phi = 1.6180339887;
        function cosh(a) {
            return (exp(a) + exp(-a))/2;
        }
        function sinh(a) {
            return (exp(a) - exp(-a))/2;
        }
        function csin(x,y) {
	        return [sin(x) * cosh(y), cos(x) * sinh(y)];
        }
        function ccos(x,y) {
	        return [cos(x)*cosh(y), -sin(x)*sinh(y)];
        }
        function cexp(x,y) {
	        return [exp(x)*cos(y), exp(x)*sin(y)];
        }
        function cmul(c1,c2) {
	        return [
		        c1[0]*c2[0]-c1[1]*c2[1],
		        c1[0]*c2[1]+c1[1]*c2[0]
	        ];
        }

        var fractals = {

	        mandelbrot : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        var lastxx, lastyy;
		        do {
			        y = (x+x)*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2) {

				        y = (x+x)*y + y0; // iterate once for more for smoother colors
				        x = xx - yy + x0;
				        yy = y*y;
				        xx = x*x;

				        break;
			        }
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliacubed : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {

			        tx = x;
			        ty = y;

			        tx2 = x*x-y*y;
			        ty2 = 2*x*y;

			        x = tx2*tx-ty2*ty + 1-phi;
			        y = tx2*ty+ty2*tx + 0.3;

			        xx = x*x;
			        yy = y*y;

			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        multibrot3 : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var tx, ty, tx2, ty2;
		        var xx = x*x, yy = y*y;
		        do {
			        tx = x;
			        ty = y;
			        tx2 = xx-yy;
			        ty2 = 2*x*y;
			        x = tx2*tx-ty2*ty + x0;
			        y = tx2*ty+ty2*tx + y0;
			        xx = x*x;
			        yy = y*y;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        multibrot4 : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = 2*x*y;
			        x = xx - yy;
			        yy = y*y;
			        xx = x*x;
			        y = 2*x*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        multibrot8 : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = 2*x*y;
			        x = xx - yy;
			        yy = y*y;
			        xx = x*x;
			        y = 2*x*y;
			        x = xx - yy;
			        yy = y*y;
			        xx = x*x;
			        y = 2*x*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        burningship : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = 2*Math.abs(x*y) - y0;
			        x = xx - yy - x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        tricorn : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = -y;

			        y = (x+x)*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        julia_base : function(x, y, it, er2, cr, ci) {
		        var xx = x*x, yy = y*y;
		        do {
			        y = (x+x)*y + ci;
			        x = xx - yy + cr;
			        yy = y*y;
			        xx = x*x;

			        if (xx+yy > er2) {
				        y = (x+x)*y + ci;
				        x = xx - yy + cr;
				        yy = y*y;
				        xx = x*x;

				        break;
			        }
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        julia1 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, phi - 2, phi - 1);
	        },

	        julia2 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 1-phi, 0);
	        },

	        julia3 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 0.285, 0);
	        },

	        julia4 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 0.285, 0.01);
	        },

	        julia5 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.835, -0.2321);
	        },

	        julia6 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.7, -0.3);
	        },

	        julia7 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 0, 1);
	        },

	        julia8 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.391, -0.587);
	        },

	        julia9 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.123, 0.745);
	        },

	        julia10 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.75, 0);
	        },

	        julia11 : function(x, y, it, er2) {
		        var zr, zi;
		        var cr = 0.6;
		        var ci = 1.1;
		        var xx = x*x, yy = y*y;
		        do {
			        zr = x - (x?(x<0?-1:1):0);
			        zi = y;
			        x = cr*zr-ci*zi;
			        y = cr*zi+ci*zr;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliasine_base : function(x, y, it, er2, cr, ci) {
		        var xx = x*x, yy = y*y;
		        var z, expy, expmy;
		        var c = [cr, ci];
		        do {
			        //z = csin(x,y);
			        expy = exp(y);
			        expmy = exp(-y);
			        z = [sin(x) * (expy + expmy)/2, cos(x) * (expy - expmy)/2];

			        x = c[0]*z[0]-c[1]*z[1];
			        y = c[0]*z[1]+c[1]*z[0];

			        yy = y*y, xx = x*x;
			        if (xx+yy > 500)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliasine : function(x, y, it, er2) {
		        return fractals["juliasine_base"](x, y, it, er2, 1, 0.1);
	        },

	        juliasine2 : function(x, y, it, er2) {
		        return fractals["juliasine_base"](x, y, it, er2, 1, 0.3);
	        },

	        juliacosine_base : function(x, y, it, er2, cr, ci) {
		        var xx = x*x, yy = y*y;
		        var z, expy, expmy;
		        var c = [cr, ci];
		        do {
			        //z = ccos(x,y);
			        expy = exp(y);
			        expmy = exp(-y);
			        z = [cos(x) * (expy + expmy)/2, -sin(x) * (expy - expmy)/2];

			        x = c[0]*z[0]-c[1]*z[1];
			        y = c[0]*z[1]+c[1]*z[0];

			        yy = y*y, xx = x*x;
			        if (xx+yy > 500)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliacosine : function(x, y, it, er2) {
		        return fractals["juliacosine_base"](x, y, it, er2, 1, 0.6);
	        },

	        juliacosine2 : function(x, y, it, er2) {
		        return fractals["juliacosine_base"](x, y, it, er2, Math.PI/2 * 1.5, Math.PI/2 * 0.05);
	        },

	        juliacosine3 : function(x, y, it, er2) {
		        var xx = x*x, yy = y*y;
		        var z, expy, expmy;
		        var c = [1, 0.1];
		        do {
			        //z = ccos(x,y);
			        expy = exp(y);
			        expmy = exp(-y);
			        z = [cos(x) * (expy + expmy)/2, -sin(x) * (expy - expmy)/2];

			        x = c[0]*z[0]-c[1]*z[1];
			        y = c[0]*z[1]+c[1]*z[0];

			        tx = x;
			        x = -y;
			        y = tx;

			        yy = y*y, xx = x*x;
			        if (xx+yy > 500)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

        };

        // from http://www.nihilogic.dk/labs/javascript_canvas_fractals/
        function render(fncFrac, colWeights) {
	        var time = new Date().getTime();

	        ctx.fillStyle = "#000000";
	        ctx.fillRect(0,0,w,h);

	        if (imageData) {
		        var data = ctx.getImageData(0,0,w,h);
		        var pixels = data.data;
	        }

	        var mi = Math.max(startit, Math.round(Math.max(Math.log(zoom),1) * startit));
	        var itfac = 1/mi*startit

	        xmin = vx - 2/zoom;
	        xmax = vx + 2/zoom;
	        ymin = vy - 2/zoom;
	        ymax = vy + 2/zoom;

	        dx = xmax-xmin;
	        dy = ymax-ymin;

	        var px, py, it;

	        var er2 = er*er;

	        var c1, c2, c3, m;
	        var col1, col2, col3;
	        var cw0 = colWeights[0], cw1 = colWeights[1], cw2 = colWeights[2];

	        var i = (w*h)-1;
	        do {
		        var offset = i*4;

		        px = (i%w);
		        py = h-((i/w)|0);

		        var res = fncFrac(
			        xmin + px/w * dx, 
			        ymin + py/h * dy, 
			        mi, er2
		        )

		        it = mi - res.it;

		        var mag = smoothColors ? 
				        (it * itfac) - (Math.log(Math.log(res.xx+res.yy))) * log2
				        : it * itfac;

		        //if (color == "bw") {
			    //    c1 = c2 = c3 = 
				//        (res.it==mi) ? 255 : 255 - mag/startit * 255;
		        //} else {
			        if (res.it == 0)
				        continue;

			        if (mag < startit/3) {
				        m = (mag*3);
				        col1 = m * 4;
				        col2 = m * 4;
				        col3 = m * 10;
			        } else if (mag < startit/1.5) {
				        m = (mag-startit/3)*3;
				        col1 = 80 + m * 8;
				        col2 = 80 + m * 8;
				        col3 = 200 + m * 2.5;
			        } else {
				        m = (mag-2*startit/3)*3
				        col1 = 220 + m * 1.5;
				        col2 = 220 + m * 1.5;
				        col3 = 255;
			        }

			        c1 = col1*cw0[0] + col2*cw0[1] + col3*cw0[2];
			        c2 = col1*cw1[0] + col2*cw1[1] + col3*cw1[2];
			        c3 = col1*cw2[0] + col2*cw2[1] + col3*cw2[2];
		        //}

		        c1 = c1 < 0 ? 0 : c1;
		        c2 = c2 < 0 ? 0 : c2;
		        c3 = c3 < 0 ? 0 : c3;

		        c1 = c1 > 255 ? 255 : c1;
		        c2 = c2 > 255 ? 255 : c2;
		        c3 = c3 > 255 ? 255 : c3;

		        if (!imageData) {
			        ctx.fillStyle = "rgb(" + (c1|0) + "," + (c2|0) + "," + (c3|0) + ")";
			        ctx.fillRect((px|0), h-((py|0)), 1, 1);
		        } else {
			        pixels[offset] = c1;
			        pixels[offset+1] = c2;
			        pixels[offset+2] = c3;
		        }

	        } while(--i);

	        if (imageData) {
		        ctx.putImageData(data,0,0);
		        ctx.fillRect(0,0,0,0);
	        }
        };

        render(fractals[this.options.algorithm], colors[this.options.color]);
    },
    _klass: "fractal thing",
    _type: "fractal",
    _defaults: {
        width: 300,
        height: 300,
        autoscale: false,
        autoresize: true,
        keepaspectratio: true,
        algorithm: "mandelbrot",
        color: "yellow",
        smoothcolors: true,
        vx: 0.3,
        vy: 0,
        zoom: 10
    },
    _schema: {
       "type":"object",
       "description":"Fractal properties",
       "properties":{
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          },
          "autoscale":{
             "type":"boolean",
             "required":false
          }
       },
       "additionalProperties":true
    }
});


var Html = Thing.extend({
    init: function() {
        this.inner = $("<div>");
        this.element.html(this.inner);
    },
    refresh: function() {
        this.base();
        this.inner.html(this.options.html).attr('class',this.options.innerCss);
    },
    _klass: "html thing",
    _type: "html",
    _defaults: {
        html: ""
    },
    _schema: {
       "type":"object",
       "description":"Html properties",
       "properties":{
          "html":{
             "type":"string",
             "required":true
          },
          "css":{
             "type":"string",
             "required":false
          },
          "innerCss":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


var Svg = Thing.extend({
    init: function() {
    },
    refresh: function() {
        this.base();
        this.element.html(this.options.svg);
    },
    _klass: "svg thing",
    _type: "svg",
    _defaults: {
        svg: '<svg xmlns="http://www.w3.org/2000/svg" version="1.1">'
    },
    _schema: {
       "type":"object",
       "description":"Svg properties",
       "properties":{
          "svg":{
             "type":"string",
             "required":true
          },
          "width":{
             "type":"string",
             "required":false
          },
          "height":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


var SvgEditor = Thing.extend({
    change: function(arg) {
        if(typeof arg == 'function') {
            this.onchange = arg;
        } else {
            this.onchange(arg);
        }
    },
    init: function() {
        var self = this;
        self.onchange = $.noop;
        self.frame = $('<iframe src="'+baseUrl+'testing/svgedit">').attr('width',self.options.width).attr('height', self.options.height);
        self.frame.ready(function() {
            // http://code.google.com/p/svg-edit/wiki/TipsAndTricks
            // waiting for real load
            (function(){
                try {
                    var cw = self.frame[0].contentWindow;
                    var md = cw.methodDraw;
                    md.ready(function() {     
                        cw.svgCanvas.setSvgString(self.options.svg);
                    });        
                    md.addExtension("server_opensave", {
                        callback: function() {
                            md.setCustomHandlers({
	                            save: function(win, data) {
		                            self.options.svg = data;
                                    self.onchange(data);
	                            }
                            });
                        }
                    });
                }
                catch (Ex){
                    setTimeout(arguments.callee, 1000);
                }
            })();
        });
        self.frame.appendTo(self.element);
    },
    refresh: function() {
        this.base();
    },
    _klass: "svg-editor thing",
    _type: "svg-editor",
    _defaults: {
        svg: '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100" height="100"></svg>',
        width: "800px",
        height: "600px"
    },
    _schema: {
       "type":"object",
       "description":"SvgEditor properties",
       "properties":{
          "svg":{
             "type":"string",
             "required":true
          },
          "width":{
             "type":"string",
             "required":false
          },
          "height":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


var TextThing = Html.extend({
    refresh: function() {
        this.base();
        var o = this.options;
        if(o['h-align'] && o['h-align'] != 'center') this.inner.addClass(o['h-align']);
        if(o['v-align'] && o['v-align'] != 'center') this.inner.addClass(o['v-align']);
        this.inner.css('font-size', o['font-size']);
        this.inner.css('font-family', o['font-family']);
    },
    _klass: "text-thing html thing",
    _type: "text-thing",
    _defaults: {
        "html": "",
        "css": "",
        "h-align": "center",
        "v-align": "center",
        "font-size": "20px",
        "font-family": "Georgia, serif"
    },
    _schema: {
       "type":"object",
       "properties":{
          "html":{
             "type":"string",
	     "format":"richtext",
             "required":true
          },
          "h-align":{
             "type":"string",
             "enum":["left","center","right"],
             "required":false
          },
          "v-align":{
             "type":"string",
             "enum":["top","center","bottom"],
             "required":false
          },
          "font-size":{
             "type":"string",
             "enum":["50%","60%","75%", "85%", "100%", "120%", "150%", "175%", "200%", "250%"],
             "required":false
          },
          "font-family":{
             "type":"string",
             "enum":[
'Arial,Arial,Helvetica,sans-serif',
'Arial Black,Arial Black,Gadget,sans-serif',
'Comic Sans MS,Comic Sans MS,cursive',
'Courier New,Courier New,Courier,monospace',
'Georgia,Georgia,serif',
'Impact,Charcoal,sans-serif',
'Lucida Console,Monaco,monospace',
'Lucida Sans Unicode,Lucida Grande,sans-serif',
'Palatino Linotype,Book Antiqua,Palatino,serif',
'Tahoma,Geneva,sans-serif',
'Times New Roman,Times,serif',
'Trebuchet MS,Helvetica,sans-serif',
'Verdana,Geneva,sans-serif' 
],
             /*"format":"font",*/
             "required":false
          }
       },
       "additionalProperties":true
    }
});


var Templated = Thing.extend({
    refresh: function() {
        var tmpl = $.templates( "#"+this.options.template+"Template" );
        var html = tmpl.render(this.options);
        this.element.html(html);
        this.element.find("[data-slot]").each(function() { 
            $(this).html(Thing.empty().get()); 
        });
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.find("[data-slot='"+key+"']").html(value.get());
        return this;
    },
    _klass: "templated thing",
    _type: "templated",
    _defaults: {
        template: "demo",
        name: "Myrousz"
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "template": {
			    "type":"string",
			    "required":true
		    },
		    "name": {
			    "type":"string",
			    "required":true
		    }
	    }
    }
});


var Snippet = Thing.extend({
    refresh: function() {
        var o = this.options;
        var code = $("<pre>").text(o.code);
        this.element.html(code);
        SyntaxHighlighter.highlight({title: o.title, 'brush':o.lang}, code.get(0));        
    },
    _klass: "snippet thing",
    _type: "snippet",
    _defaults: {
        "title": "",
        "lang": "js",
        "code": ""
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "title": {
			    "type":"string",
			    "required":false
		    },
		    "lang": {
			    "type":"string",
                "enum":["js","php","plain"],
			    "required":true
		    },
		    "code": {
			    "type":"string",
			    "required":true
		    }
	    }
    }
});


var SoftKeyboard = Thing.extend({
    init: function() {
        this.keys = {};
        this.onkeypress = $.noop;
    },
    refresh: function() {
        var kbd = $("<div>");
        var rows = this.options.rows;
        var cols = this.options.rows;
        for(var key in this.options.keys) {
            var k = this.options.keys[key];
            var kk = this._makeKey(key, k).appendTo(kbd);
            this.keys[key] = kk;
        }
        this.element.html(kbd);
    },
    getKeyButton: function(key) {
        return {"name":key, "button":this.keys[key], "key":this.options.keys[key]};
    },
    _makeKey: function(name, k) {
        var self = this;
        var o = this.options;
        var top = Math.floor(100*k.top/o.rows) + "%";
        var left = Math.floor(100*k.left/o.columns) + "%";
        var ww = k.size || k.width;
        var hh = k.size || k.height;
        var mm = 2;
        var width = Math.floor(100*ww/o.columns) + "%";
        var height = Math.floor(100*hh/o.rows) + "%";
        var div = $("<button>").addClass("key key-"+name).css({'top':top, 'left':left, 'width':width, 'height':height}).append($("<div>").text(k.label));
        div.click(function() {
            if(k['switch']) {
                div.toggleClass("active");
            }
            self.keyPressed(self.getKeyButton(name));
        });
        return div;
    },
    keyPressed: function(kb) {
        if(typeof kb == 'function') {
            this.onkeypress = kb;
        } else {
            this.onkeypress(kb);
        }
    },
    getSwitchState: function(name) {
        if(this.options.keys[name] && this.options.keys[name]['switch']) {
            return this.keys[name].hasClass("active");
        } else {
            return false;
        }
    },    
    _klass: "soft-keyboard thing",
    _type: "soft-keyboard",
    _defaults: {
        "rows": 8,
        "columns": 20,
        "keys": {
            "q" : { "left":0, "top":0, "size":2, "label":"Q"},
            "w" : { "left":2, "top":0, "size":2, "label":"W"},
            "e" : { "left":4, "top":0, "size":2, "label":"E"},
            "r" : { "left":6, "top":0, "size":2, "label":"R"},
            "t" : { "left":8, "top":0, "size":2, "label":"T"},
            "y" : { "left":10, "top":0, "size":2, "label":"Y"},
            "u" : { "left":12, "top":0, "size":2, "label":"U"},
            "i" : { "left":14, "top":0, "size":2, "label":"I"},
            "o" : { "left":16, "top":0, "size":2, "label":"O"},
            "p" : { "left":18, "top":0, "size":2, "label":"P"},
            "a" : { "left":1, "top":2, "size":2, "label":"A"},
            "s" : { "left":3, "top":2, "size":2, "label":"S"},
            "d" : { "left":5, "top":2, "size":2, "label":"D"},
            "f" : { "left":7, "top":2, "size":2, "label":"F"},
            "g" : { "left":9, "top":2, "size":2, "label":"G"},
            "h" : { "left":11, "top":2, "size":2, "label":"H"},
            "j" : { "left":13, "top":2, "size":2, "label":"J"},
            "k" : { "left":15, "top":2, "size":2, "label":"K"},
            "l" : { "left":17, "top":2, "size":2, "label":"L"},
            "caps" : { "left":0, "top":4, "width":3, "height":2, "label":__("caps"), "switch":true},
            "z" : { "left":3, "top":4, "size":2, "label":"Z"},
            "x" : { "left":5, "top":4, "size":2, "label":"X"},
            "c" : { "left":7, "top":4, "size":2, "label":"C"},
            "v" : { "left":9, "top":4, "size":2, "label":"V"},
            "b" : { "left":11, "top":4, "size":2, "label":"B"},
            "n" : { "left":13, "top":4, "size":2, "label":"N"},
            "m" : { "left":15, "top":4, "size":2, "label":"M"},
            "del" : { "left":17, "top":4, "width":3, "height":2, "label":__("del")},
            "nums" : { "left":0, "top":6, "width":4, "height":2, "label":__("?123")},
            "comma" : { "left":4, "top":6, "width":3, "height":2, "label":","},
            "space" : { "left":7, "top":6, "width":6, "height":2, "label":__("space")},
            "dot" : { "left":13, "top":6, "width":3, "height":2, "label":"."},
            "enter" : { "left":16, "top":6, "width":4, "height":2, "label":__("enter")}
        }
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "rows": {
			    "type":"integer",
			    "required":true
		    },
		    "columns": {
			    "type":"integer",
			    "required":true
		    }
	    }
    }
});


var SoftTextEditor = Thing.extend({
    init: function() {
        var self = this;
        this.onchange = $.noop;
        this.keyboard = new SoftKeyboard();
        this.keyboard.keyPressed(function(kb) {
            self._keyPressed(kb);
        });
        this.textfield = $("<textarea>").val(this.options.value).change(function() {
            self.options.value = $(this).val();
        });
        this.buttonOk = $("<button>").addClass('done').text(__("Done")).click(function() {
            self.change(self.textfield.val());
        });
        this.element
            .append($("<div>").addClass("textfield").append(this.textfield))
            .append($("<div>").addClass("btn").append(this.buttonOk))            
            .append(this.keyboard.get());
    },
    refresh: function() {
        this.textfield.val(this.options.value);
    },
    // TODO napojit
    change: function(arg) {
        if(typeof arg == 'function') {
            this.onchange = arg;
        } else {
            this.onchange(arg);
        }
    },
    _keyPressed: function(kb) {
        var cc = kb.name;
        switch(cc) {
            case 'caps': 
                this.capsLock = this.keyboard.getSwitchState('caps');
                break;
            case 'del':
                // delete last character
                this.options.value = this.options.value.slice(0, -1);
                this.refresh();
                break;
            case 'nums': 
                break;
            case 'enter':
                this.options.value += "\n";
                this.refresh();
                break;
            case 'comma':
                this.options.value += ",";
                this.refresh();
                break;
            case 'space':
                this.options.value += " ";
                this.refresh();
                break;
            case 'dot':
                this.options.value += ".";
                this.refresh();
                break;
            default:
                if(this.capsLock) {
                    // invert case...
                    cc = ( cc >= 'A' && cc <= 'Z' ) ? cc.toLowerCase() : cc.toUpperCase();
                }
                this.options.value += cc;
                this.refresh();
        }
    },
    _klass: "soft-text-editor thing",
    _type: "soft-text-editor",
    _defaults: {
        "value": ""
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "value": {
			    "type":"string",
			    "required":true
		    }
	    }
    }
});



var HolidayCalendar = {
    // kdy je velikonocni nedele - bozi hod velikonocni?
    easter: {
        "2012": {month: 4, day: 8},
        "2013": {month: 3, day: 31},
        "2014": {month: 4, day: 20},
        "2015": {month: 4, day: 5}
    },
    data: 
// BEGIN JSON DATA
[
    {
        "month": "Leden",
        "days": [
            {
                "number": "1",
                "names": [
                    "Nový rok"/*,
                    "Den obnovy samostatného českého státu"*/
                ],
                "holiday": true
            },
            {
                "number": "2",
                "names": [
                    "Karina"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Radmila"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Diana"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Dalimil"
                ]
            },
            {
                "number": "6",
                "names": [
                    /*"Kašpar",
                    "Melichar",
                    "Baltazar"*/"Tři králové"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Vilma"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Čestmír"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Vladan"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Břetislav"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Bohdana"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Pravoslav"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Edita"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Radovan"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Alice"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Ctirad"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Drahoslav"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Vladislav"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Sára/Doubravka"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Ilona"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Běla"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Slavomír"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Zdeněk"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Milena"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Miloš"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Zora"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Ingrid"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Otýlie"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Zdislava"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Robin"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Marika"
                ]
            }
        ]
    },
    {
        "month": "Únor",
        "days": [
            {
                "number": "1",
                "names": [
                    "Hynek"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Nela"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Blažej"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Jarmila"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Dobromila"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Vanda"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Veronika"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Milada"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Apolena"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Mojmír"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Božena"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Slavěna"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Věnceslav"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Valentýn"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Jiřina"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Ljuba"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Miloslava"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Gizela"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Patrik"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Oldřich"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Lenka"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Petr"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Svatopluk"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Matěj"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Liliana"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Dorota"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Alexandr"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Lumír"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Horymír"
                ]
            }
        ]
    },
    {
        "month": "Březen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Bedřich"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Anežka"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Kamil"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Stela"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Kazimír"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Miroslav"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Tomáš"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Gabriela"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Františka"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Viktorie"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Anděla"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Řehoř"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Růžena"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Matylda/Rút"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Ida"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Herbert/Elena"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Vlastimil"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Eduard"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Josef"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Světlana"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Radek"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Leona"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Ivona"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Gabriel"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Marian"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Emanuel"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Dita"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Soňa"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Taťána"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Arnošt"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Kvido"
                ]
            }
        ]
    },
    {
        "month": "Duben",
        "days": [
            {
                "number": "1",
                "names": [
                    "Hugo"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Erika"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Richard"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Ivana"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Miroslava"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Vendula"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Hermína/Herman"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Ema"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Dušan"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Darja"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Izabela"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Július"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Aleš"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Vincenc"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Anastázie"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Irena"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Rudolf"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Valérie"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Rostislav"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Marcela"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Alexandra"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Evženie"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Vojtěch"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jiří"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Marek"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Oto"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Jaroslav"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Vlastislav"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Robert"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Blahoslav"
                ]
            }
        ]
    },
    {
        "month": "Květen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Svátek práce"
                ],
                "holiday": true
            },
            {
                "number": "2",
                "names": [
                    "Zikmund"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Alexej"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Květoslav"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Klaudie"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Radoslav"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Stanislav"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Den vítězství"
                ],
                "holiday": true
            },
            {
                "number": "9",
                "names": [
                    "Ctibor"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Blažena"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Svatava"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Pankrác"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Servác"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Bonifác"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Žofie"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Přemysl"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Aneta"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Nataša"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Ivo"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Zbyšek"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Monika"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Emil"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Vladimír"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jana"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Viola"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Filip"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Valdemar"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Vilém"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Maxmilián"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Ferdinand"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Kamila"
                ]
            }
        ]
    },
    {
        "month": "Červen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Laura"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Jarmil"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Tamara"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Dalibor"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Dobroslav"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Norbert"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Iveta"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Medard"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Stanislava"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Gita"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Bruno"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Antonie"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Antonín"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Roland"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Vít"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Zbyněk"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Adolf"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Milan"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Leoš"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Květa"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Alois"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Pavla"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Zdeňka"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jan"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Ivan"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Adriana"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Ladislav"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Lubomír"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Petr a Pavel"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Šárka"
                ]
            }
        ]
    },
    {
        "month": "Červenec",
        "days": [
            {
                "number": "1",
                "names": [
                    "Jaroslava"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Patricie"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Radomír"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Prokop"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Cyril a Metoděj"
                ],
                "holiday": true
            },
            {
                "number": "6",
                "names": [
                    /*"Den upálení Mistra Jana Husa"*/"Jan Hus"
                ],
                "holiday": true
            },
            {
                "number": "7",
                "names": [
                    "Bohuslava"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Nora"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Drahoslava"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Libuše/Amálie"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Olga"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Bořek"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Markéta"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Karolína"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Jindřich"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Luboš"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Martina"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Drahomíra"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Čeněk"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Ilja/Eliáš"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Vítězslav"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Magdalena"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Libor"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Kristýna"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Jakub"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Anna"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Věroslav"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Viktor"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Marta"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Bořivoj"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Ignác"
                ]
            }
        ]
    },
    {
        "month": "Srpen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Oskar"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Gustav"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Miluše"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Dominik"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Kristián"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Oldřiška"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Lada"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Soběslav"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Roman"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Vavřinec"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Zuzana"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Klára"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Alena"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Alan"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Hana"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Jáchym"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Petra"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Helena"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Ludvík"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Bernard"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Johana"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Bohuslav"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Sandra"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Bartoloměj"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Radim"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Luděk"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Otakar"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Augustýn"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Evelína"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Vladěna"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Pavlína"
                ]
            }
        ]
    },
    {
        "month": "Září",
        "days": [
            {
                "number": "1",
                "names": [
                    "Linda/Samuel"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Adéla"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Bronislav"
                    /* /Bronislava"*/
                ]
            },
            {
                "number": "4",
                "names": [
                    "Jindřiška"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Boris"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Boleslav"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Regina"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Mariana"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Daniela"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Irma"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Denisa"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Marie"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Lubor"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Radka"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Jolana"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Ludmila"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Naděžda"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Kryštof"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Zita"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Oleg"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Matouš"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Darina"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Berta"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jaromír"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Zlata"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Andrea"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Jonáš"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Václav"/*,
                    "Den české státnosti"*/
                ],
                "holiday": true
            },
            {
                "number": "29",
                "names": [
                    "Michal"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Jeroným"
                ]
            }
        ]
    },
    {
        "month": "Říjen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Igor"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Olivie/Oliver"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Bohumil"
                ]
            },
            {
                "number": "4",
                "names": [
                    "František"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Eliška"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Hanuš"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Justýna"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Věra"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Štefan/Sára"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Marina"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Andrej"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Marcel"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Renáta"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Agáta"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Tereza"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Havel"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Hedvika"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Lukáš"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Michaela"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Vendelín"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Brigita"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Sabina"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Teodor"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Nina"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Beáta"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Erik"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Šarlota/Zoe"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Státní svátek"/*,
                    "Den vzniku samostatného československého státu"*/
                ],
                "holiday": true
            },
            {
                "number": "29",
                "names": [
                    "Silvie"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Tadeáš"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Štěpánka"
                ]
            }
        ]
    },
    {
        "month": "Listopad",
        "days": [
            {
                "number": "1",
                "names": [
                    "Felix"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Památka zesnulých"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Hubert"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Karel"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Miriam"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Liběna"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Saskie"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Bohumír"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Bohdan"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Evžen"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Martin"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Benedikt"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Tibor"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Sáva"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Leopold"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Otmar"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Mahulena"/*,
                    "Den boje za svobodu a demokracii"*/
                ],
                "holiday": true
            },
            {
                "number": "18",
                "names": [
                    "Romana"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Alžběta"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Nikola"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Albert"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Cecílie"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Klement"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Emílie"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Kateřina"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Artur"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Xenie"
                ]
            },
            {
                "number": "28",
                "names": [
                    "René"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Zina"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Ondřej"
                ]
            }
        ]
    },
    {
        "month": "Prosinec",
        "days": [
            {
                "number": "1",
                "names": [
                    "Iva"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Blanka"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Svatoslav"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Barbora"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Jitka"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Mikuláš"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Ambrož/Benjamín"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Květoslava"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Vratislav"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Julie"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Dana"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Simona"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Lucie"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Lydie"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Radana"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Albína"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Daniel"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Miloslav"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Ester"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Dagmar"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Natálie"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Šimon"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Vlasta"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Adam a Eva"/*,
                    "Štědrý den"*/
                ],
                "holiday": true
            },
            {
                "number": "25",
                "names": [
                    "Boží hod vánoční"
                ],
                "holiday": true
            },
            {
                "number": "26",
                "names": [
                    "Štěpán"/*,
                    "Druhý svátek vánoční"*/
                ],
                "holiday": true
            },
            {
                "number": "27",
                "names": [
                    "Žaneta"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Bohumila"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Judita"
                ]
            },
            {
                "number": "30",
                "names": [
                    "David"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Silvestr"
                ]
            }
        ]
    }
]
// END JSON DATA
};

var Calendar = RaphaelThing.extend({
    /* canvas size: 1000x1000 */
    refresh: function() { 
        this.base();   
        var d = this.options;
        this.paper = this.canvas;
        this.paper.clear();
        this.lineAttr = { "fill": "none", "stroke": d.lineColor};
        this.monthNameAttr = { "stroke": "none", "fill": d.fontColor, "font-family":d.fontFamily, "font-size":d.titleFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.monthCapAttr = { "fill": d.fontColor, "stroke": "none", "font-family":d.fontFamily, "font-size":d.dayCapFontSize, "font-style":d.fontStyle};
        this.dayNumAttr = { "stroke": "none", "fill":d.fontColor, "font-family":d.fontFamily, "font-weight":"bold", "font-size":d.numbersFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.dayNameAttr = { "stroke": "none", "fill": d.fontColor, "font-family":d.fontFamily, "font-size":d.namesFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.dayNumAttrHigh = { "stroke": "none", "fill": d.fontColorHigh, "font-family":d.fontFamily, "font-weight":"bold", "font-size":d.numbersFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.dayNameAttrHigh = { "stroke": "none", "fill": d.fontColorHigh, "font-family":d.fontFamily, "font-size":d.namesFontSize, "font-style":d.fontStyle, "text-anchor":"end"};

        this.monthCapOffset = 12;
        this.boxWidth = 142;
        this.boxHeight = 142;
        this.drawMonth(d.year, d.month);
        // HACK: https://github.com/DmitryBaranovskiy/raphael/issues/491
        this.element.find("tspan").attr("dy", 0);
    },

    drawMonthGrid: function(rows, x, y) {
        // draws grid 7x5 with day captions
        for(var i=0; i<=7; i++) {
            // draw captions
            // draw vertical lines
            var xx = x + i*this.boxWidth;
            var str = "M"+xx+","+y+"l0,"+rows*this.boxHeight;
            this.paper.path(str).attr(this.lineAttr); 
            if(i<7) this.paper.text(xx+this.boxWidth/2, y-this.monthCapOffset, this.locale[this.currentLocale].daysOfWeek[i]).attr(this.monthCapAttr);
        }
        for(var j=0; j<=rows; j++) {
            // draw horizontal lines
            var yy = y + j*this.boxHeight;
            var str = "M"+x+","+yy+"l"+7*this.boxWidth+",0";
            this.paper.path(str).attr(this.lineAttr);            
        }                    
    },

    drawDayBox: function(row, column, year, month, day, x, y) {
        // is day sunday?
        var sunday = this.getDayOfWeek(year, month, day) == 0;
        // is day holiday?
        var holiday = HolidayCalendar.data[month-1].days[day-1].holiday;

        var xx = x + (column+1)*this.boxWidth - 5;
        // print number...
        var yy = y + (row+1-0.45)*this.boxHeight - 5;
        this.paper.text(xx, yy, day).attr((sunday || holiday) ? this.dayNumAttrHigh : this.dayNumAttr);
        // print name
        var yy = y + (row+1-0.1)*this.boxHeight - 5;
        this.paper.text(xx, yy, HolidayCalendar.data[month-1].days[day-1].names[0]).attr(holiday ? this.dayNameAttrHigh : this.dayNameAttr);
    },

    drawMonth: function(year, month) {
        var x = 0;
        var column = this.getDayOfWeek(year, month, 1);
        // nedele = 0! pondeli 1...
        column = (column==0) ? 6 : column-1;
        // how many total rows?
        lastColumn = column+HolidayCalendar.data[month-1].days.length;
        var totalRows = Math.floor((lastColumn+6)/7);
        var y = 7*this.boxHeight - totalRows*this.boxHeight;
        // draw month name
        var mn = this.locale[this.currentLocale].months[month-1] + " "+year;
        this.drawMonthGrid(totalRows, x, y);
        this.paper.text(x+7*this.boxWidth, y-0.7*this.boxHeight, mn).attr(this.monthNameAttr);
        var row = 0;
        for(var i=0; i<HolidayCalendar.data[month-1].days.length; i++) {
            this.drawDayBox(row, column, year, month, i+1, x, y);
            column++;
            if(column == 7) {
                column = 0;
                row++;
            }
        }

    },
    locale: {
        "en": {
            "months": [
                "January","February","March","April","May","June","July","August","September","October","November","December"
            ],
            "daysOfWeek": [
                "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"
            ]
        },
        "cz": {
            "months": [
                "Leden","Únor","Březen","Duben","Květen","Červen","Červenec","Srpen","Září","Říjen","Listopad","Prosinec"
            ],
            "daysOfWeek": [
                "Pondělí", "Úterý", "Středa", "Čtvrtek", "Pátek", "Sobota", "Neděle"
            ]
        }
    },
    currentLocale: 'cz',
    getDayOfWeek: function(year, month, day) {
        var d = new Date(year, month-1, day, 0, 0, 0, 0);
        return d.getDay();
    },
    isLeapYear: function(yr) {
        return new Date(yr,2-1,29).getDate()==29;
    },

    _klass: "calendar raphael-thing thing",
    _type: "calendar",
    _defaults: {
        width: 1000,
        height: 1000,
        year: 2012,
        month: 12,
        fontFamily: "Arial", 
        fontStyle: "italic", 
        lineColor: "black",
        fontColor: "black",
        fontColorHigh: "red",
        titleFontSize: "40",
        dayCapFontSize: "20",
        numbersFontSize: "60",
        namesFontSize: "16"
    },
    _schema: {
       "type":"object",
       "description":"Calendar properties",
       "properties":{
          "year":{
             "type":"string",
             "enum":["2012", "2013","2014","2015"],
             "required":true
          },
          "month":{
             "type":"string",
             "enum":["1", "2","3","4","5","6","7","8","9","10","11","12"],
             "required":true
          },
            // .....
          "titleFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "dayCapFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "numbersFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "namesFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "fontFamily":{
             "type":"string",
             "enum":["Georgia, serif","Arial, Helvetica, sans-serif","Impact, Charcoal, sans-serif", "Tahoma, Geneva, sans-serif", "Verdana, Geneva, sans-serif", "Monaco, monospace"],
             "required":true
          },
          "fontStyle":{
             "type":"string",
             "enum":["regular","italic","monospace"],
             "required":true
          }
       },
       "additionalProperties":true
    }
});



// TODO kdyz zmenim parametry hodin a ulozim, nepromitne se to do inputu

var Clock = RaphaelThing.extend({
    refresh: function() {
        this.base();
        var 
            o = this.options,
            size = o.size,
            canvas = this.canvas,
            clock = canvas.circle(size*.5,size*.5, size * .475);
        clock.attr({"fill":o.fillColor,"stroke":o.strokeColor,"stroke-width":(size*.025)})
        var hour_sign;
        for(i=0;i<12;i++){
            var start_x = size*.5+Math.round((size*.4)*Math.cos(30*i*Math.PI/180));
            var start_y = size*.5+Math.round((size*.4)*Math.sin(30*i*Math.PI/180));
            var end_x = size*.5+Math.round((size*.45)*Math.cos(30*i*Math.PI/180));
            var end_y = size*.5+Math.round((size*.45)*Math.sin(30*i*Math.PI/180));
            hour_sign = canvas.path("M"+start_x+" "+start_y+"L"+end_x+" "+end_y);
        }
        this.hour_hand = canvas.path("M" + size*.5 + " " + size*.5 + "L" + size*.5 + " " + (size*.25) + "");
        this.hour_hand.attr({stroke: o.hourHandColor, "stroke-width": size*.03});
        this.minute_hand = canvas.path("M" + size*.5 + " " + size*.5 + "L" + size*.5 + " " + (size*.2) + "");
        this.minute_hand.attr({stroke: o.minuteHandColor, "stroke-width": size*.02});
        this.second_hand = canvas.path("M" + size*.5 + " " + (size*.55) + "L" + size*.5 + " " + (size*.125) + "");
        this.second_hand.attr({stroke: o.secondHandColor, "stroke-width": size*.01});
        var pin = canvas.circle(size*.5, size*.5, size*.025);
        pin.attr("fill", o.pinColor);

        var self = this;
        var updater = function() {
            self.update();
        };
        updater();
        setInterval(updater,1000); 
    },
    update: function() {
        var self = this,
            size = this.options.size,
            now = new Date(),
            hours = now.getHours(),
            minutes = now.getMinutes(),
            seconds = now.getSeconds(),
            cc = ","+(size*.5)+","+(size*.5);
        self.hour_hand.transform('r'+(30*hours+(minutes/2.5))+cc);
        self.minute_hand.transform('r'+(6*minutes)+cc);
        self.second_hand.transform('r'+(6*seconds)+cc);
    },
    _klass: "clock raphael-thing thing",
    _type: "clock",
    _defaults: {
        width: 100,
        height: 100,
        size: 100,
        fillColor: "white", 
        strokeColor: "black", 
        pinColor: "gray",
        hourHandColor:"black", 
        minuteHandColor:"black",
        secondHandColor:"black"
    },
    _schema: {
       "type":"object",
       "description":"Clock properties",
       "properties":{
          "size":{
             "type":"integer",
             "required":true
          },
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          },
          "fillColor":{
             "type":"string",
             "format": "color",
             "required":true
          },
          "strokeColor": { "type": "string", "required": true, "format": "color" },
          "pinColor": { "type": "string", "required": true, "format": "color" },
          "hourHandColor": { "type": "string", "required": true, "format": "color" },
          "minuteHandColor": { "type": "string", "required": true, "format": "color" },
          "secondHandColor": { "type": "string", "required": true, "format": "color" }
       },
       "additionalProperties":true
    }
});


var Modal = Thing.extend({
    init: function() {
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.html($("<p>").html(value.get()));
        this.refresh();
        return this;
    },
    _fullOpts: function() {
      return $.extend({modal: true}, this.options)
    },
    show: function() {
        var self = this;
	    $(self.element).dialog(this._fullOpts());
	    $(self.element).dialog('open');
    },
    close: function() {
	    $(this.element).dialog('close');
    },
    refresh: function() {
    	$(this.element).dialog(this._fullOpts());
    },
    _klass: "modal thing",
    _type: "modal",
    _defaults: {
        autoOpen: false,
        minHeight: 608, // 560,  
        minWidth: 760, //740
        title: 'Dialog',
        closeOnEscape: true
    },
    _schema: {
       "type":"object",
       "properties":{
          "title": {
             "type": "string",
             "required": false
          },
          "autoOpen":{
             "type":"boolean",
             "required":true
          },
          "minHeight":{
             "type":"string",
             "required":true
          },
          "minWidth":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }

}, {
    show: function(thing, opts) {
        var modal = new Modal(opts);
        modal.content('content',thing);
        modal.show();
        return modal;
    }
});


var Dummy = Html.extend({
    refresh: function() {
        this.base();
        this.element.css('width', this.options['width']);
        this.element.css('height',this.options['height']);
        this.element.css('color',this.options['color']);
        this.element.css('background-color',this.options['background-color']);
    },
    _klass: "dummy html thing",
    _type: "dummy",
    _defaults: {
        html: "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla sed dolor nisl, in suscipit justo. Donec a enim et est porttitor semper at vitae augue. Proin at nulla at dui mattis mattis. Nam a volutpat ante. Aliquam consequat dui eu sem convallis ullamcorper. Nulla suscipit, massa vitae suscipit ornare, tellus est consequat nunc, quis blandit elit odio eu arcu. Nam a urna nec nisl varius sodales. Mauris iaculis tincidunt orci id commodo. Aliquam non magna quis tortor malesuada aliquam eget ut lacus. Nam ut vestibulum est. Praesent volutpat tellus in eros dapibus elementum. Nam laoreet risus non nulla mollis ac luctus felis dapibus. Pellentesque mattis elementum augue non sollicitudin. Nullam lobortis fermentum elit ac mollis. Nam ac varius risus. Cras faucibus euismod nulla, ac auctor diam rutrum sit amet. Nulla vel odio erat, ac mattis enim.",
        'width': "",
        'height': '',
        'color': '',
        'background-color': ''
    },
    _schema: {
       "type":"object",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "height":{
             "type":"string",
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          },
          "background-color":{
             "type":"string",
             "format": "color",
             "required":true
          }
       },
       "additionalProperties":true
    }
});

// decorator = thing with a single slot named 'content'

// TODO podedit toto vsechno od 'Decorator'
// kvuli reverzibilite dekoratoru by bylo dobre kdyby kazdy menil css properties 'wrapper' divu
var Decorator = Thing.extend({
    init: function() {
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.html(value.get());
        return this;
    },
    unwrap: function() {
        this.replaceWith(this.getSlot('content'));
    },
    _klass: "decorator thing",
    _type: "decorator"
});


















var Clickable = Thing.extend({
    init: function() {
        this.pane = $("<div>").addClass("clickable-pane");
        this.setSlot('content', Thing.empty());
        this.click($.noop);
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.empty()
            .append(value.get())
            .append(this.pane);
        return this;
    },
    refresh: function() {
      this.base();
      this.pane.attr('title', this.options.tooltip);
    },
    click: function(arg) {
        if(arg) {
            this.onclick = arg;
            this.pane.click(this.onclick);
        } else {
            return this.onclick();
        }
    },
    _klass: "clickable thing",
    _type: "clickable",
    _defaults: {
      "tooltip": ""
    }
});


var Editable = Thing.extend({
    init: function() {
        this.onchanged = $.noop;
        this.editor = $("<div>").addClass("editable-editor");
        this.pane = $("<div>").addClass("editable-pane");
        this.element.append(this.pane).append(this.editor);
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        var self = this;
        var schema = value._schema;
        this.editor.empty();
        if(!schema) {
            // pouzit radsi json editor
        } else {
            this.editor.jsonform({schema: value._schema, value: value.options, name: __("Properties")+" - "+value._type});
            this.editor.jsonform('change', function() {
                self._save(true);
            });
            this.editor.jsonform('save', function() {
                self._save();
            });
        }
        this.pane.html(value.get());
        return this;
    },
    _save: function(stay) {
        var self = this;
        // value changed in editor...
        var newVal = self.editor.jsonform('value');
        self.getSlot('content').setOptions(newVal);
        if(!stay) self.onchanged(newVal);
    },
    _klass: "editable thing",
    _type: "editable",
    _defaults: {}
}, {
    edit: function(thing, changed) {
        var edt = new Editable();
        edt.setSlot('content', thing.copy());
        var modal = Modal.show(edt, {height: 630, minHeight: 630, width: 840, minWidth: 840, resizable: false, draggable: true, title:__('Properties')});
        edt.onchanged = function(newVal) {
            modal.close();
            if(changed) changed(newVal);
        };
    }
});



var ToolbarDecorator = Thing.extend({
    init: function() {
        this._content = $("<div>")
            .addClass("mykkro-toolbar-decorator-content")
            .appendTo(this.element);
        this.setSlot('content', Thing.empty());
    },
    refresh: function() {
	    this.base();
        if(this.options.hidden) {
            this.element.toolbar({tools:{}});
        } else {
            this.element.toolbar({tools:this.options.tools});
        }
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this._content.html(value.get());
        return this;
    },
    showToolbar: function() {
        this.options.hidden = false;
        this.refresh();
    },
    hideToolbar: function() {
        this.options.hidden = true;
        this.refresh();
    },
    serialize: function() {
        // toolbar decorator se nebude serializovat (aspon automaticky ne)
        return this.getSlot('content').serialize();
    },
    getTree: function() {
        // skip the outer layer...
        return this.getSlot('content').getTree();
    },
    getTreeView: function(decorator) {
        // skip the outer layer...
        return this.getSlot('content').getTreeView(decorator);
    },
    _klass: "toolbar-decorator thing",
    _type: "toolbar-decorator",
    _defaults: {
        tools: {}
    } 
});


var ContextmenuDecorator = Thing.extend({
    init: function() {
        this._content = $("<div>")
            .addClass("mykkro-contextmenu-decorator-content")
            .appendTo(this.element);
        this.setSlot('content', Thing.empty());
    },
    refresh: function() {
	    this.base();
        if(this.options.hidden) {
            this.element.toolbar({tools:{}});
        } else {
            this.element.toolbar({tools:this.options.tools});
        }
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this._content.html(value.get());
        return this;
    },
    showToolbar: function() {
        this.options.hidden = false;
        this.refresh();
    },
    hideToolbar: function() {
        this.options.hidden = true;
        this.refresh();
    },
    serialize: function() {
        // toolbar decorator se nebude serializovat (aspon automaticky ne)
        return this.getSlot('content').serialize();
    },
    getTree: function() {
        // skip the outer layer...
        return this.getSlot('content').getTree();
    },
    getTreeView: function(decorator) {
        // skip the outer layer...
        return this.getSlot('content').getTreeView(decorator);
    },
    _klass: "contextmenu-decorator thing",
    _type: "contextmenu-decorator",
    _defaults: {
        tools: {}
    } 
});


var Page = Decorator.extend({
    // options changed...
    refresh: function() {
        this.element.css({
          'width': this.options['width'],
          'height': this.options['height'],
          'background-size': 'cover',
          'background-image': 'url('+this.options['background_url']+')'
        })
    },
    _klass: "page decorator thing",
    _type: "page",
    _defaults: {
        'width': '500px',
        'height': '700px',
        'background_url': ''
    },
    _schema: {
       "type":"object",
       "description":"Page properties",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "height":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var Preview = Decorator.extend({
    // options changed...
    refresh: function() {
        this.element.css('width',this.options['width']);
        this.element.css('height',this.options['height']);
    },
    _klass: "preview decorator thing",
    _type: "preview",
    _defaults: {
        'width': '80px',
        'height': '110px',
        'label': 'preview',
        'description': ''
    },
    _schema: {
       "type":"object",
       "description":"Clock properties",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "height":{
             "type":"string",
             "required":true
          },
          "label":{
             "type":"string",
             "required":false
          },
          "description":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }
});


var OpacityDecorator = Decorator.extend({
    refresh: function() {
      this.base();
      this.element.css('opacity',this.options.opacity);
    },
    _klass: "opacity-decorator decorator thing",
    _type: "opacity-decorator",
    _defaults: {
        opacity: 0.8
    },
    _schema: {
       "type":"object",
       "description":"Clock properties",
       "properties":{
          "opacity":{
             "type":"number",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var InsetDecorator = Decorator.extend({
    refresh: function() {
	this.base();
        this.element.css('padding',this.options.top+'% '+this.options.right+"% "+this.options.bottom+"% "+this.options.left+"%");
    },
    _klass: "inset-decorator decorator thing",
    _type: "inset-decorator",
    _defaults: {
        top: 2,
        left: 2,
        right: 2,
        bottom: 2
    },
    _schema: {
	"type":"object",
	"$schema": "http://json-schema.org/draft-03/schema",
	"properties":{
		"bottom": {
			"type":"number",
			"id": "bottom",
			"required":true
		},
		"left": {
			"type":"number",
			"id": "left",
			"required":true
		},
		"right": {
			"type":"number",
			"id": "right",
			"required":true
		},
		"top": {
			"type":"number",
			"id": "top",
			"required":true
		}
	},
       "additionalProperties":true
    }

});



var ShadowDecorator = Decorator.extend({
    // options changed...
    refresh: function() {
	this.base();
        var br = this.options['h-shadow']+" "+this.options['v-shadow']+" "+this.options.blur+" "+this.options.spread+" "+this.options.color;
        this.element.css('box-shadow',br);
        this.element.css('-webkit-box-shadow',br);
    },
    _klass: "shadow-decorator decorator thing",
    _type: "shadow-decorator",
    _defaults: {
        'h-shadow': "5px",
        'v-shadow': "5px",
        blur: "5px",
        spread: "5px",
        color: "#666"
    },
    _schema: {
       "type":"object",
       "properties":{
          "h-shadow":{
             "type":"string",
             "required":true
          },
          "v-shadow":{
             "type":"string",
             "required":true
          },
          "blur":{
             "type":"string",
             "required":true
          },
          "spread":{
             "type":"string",
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          }
       },
       "additionalProperties":true
    }
});





var BackgroundDecorator = Decorator.extend({
    // options changed...
    refresh: function() {
        this.base();
        if(this.options['image']) 
            this.element.css('background-image','url("'+this.options['image']+'")');
        else 
            this.element.css('background-image','');
        this.element.css('background-position',this.options['position']);
        this.element.css('background-repeat',this.options['repeat']);
        this.element.css('background-color',this.options['color']);
        this.element.css('background-size',this.options['size']);
    },
    _klass: "background-decorator decorator thing",
    _type: "background-decorator",
    _defaults: {
        'image': "",
        'repeat': 'no-repeat',
        'position': 'center center',
        'color': 'white',
        'size': 'cover'
    },
    _schema: {
       "type":"object",
       "properties":{
          "image":{
             "type":"string",
             "format": "my-image-uri",
            // TODO vadi mu kdyz je to false - option se neda rozkliknout
             "required":true
          },
          "repeat":{
             "enum": ["repeat","no-repeat","repeat-x","repeat-y"],
             "type":"string",
             "required":true // TODO
          },
          "position":{
             "type":"string",
             "required":true // TODO
          },
          "size":{
             "type":"string",
             "enum": ["cover","contain"],
             "required":true // TODO
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true // TODO
          }
       },
       "additionalProperties":true
    }
});



// TODO sloucit nejak s rounded decoratorem
var BorderDecorator = Decorator.extend({
    // options changed...
    refresh: function() {
        this.base();
        this.element.css('border-width', this.options['width']);
        this.element.css('border-style',this.options['style']);
        this.element.css('border-color',this.options['color']);
    },
    _klass: "border-decorator decorator thing",
    _type: "border-decorator",
    _defaults: {
        'width': "1px",
        'style': 'solid',
        'color': 'black'
    },
    _schema: {
       "type":"object",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "style":{
             "type":"string",
             "enum": ["none","solid","dotted","dashed","double","groove","ridge","inset","outset"],
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var RoundedDecorator = BorderDecorator.extend({
    refresh: function() {
        this.base();
        var br = this.options.radius;
        // TODO individualne vsechny 4 rohy
        this.element.css('border-radius',br);
        this.element.css('-webkit-border-radius',br);
        this.element.css('-moz-border-radius',br);
    },
    _klass: "rounded-decorator decorator thing",
    _type: "rounded-decorator",
    _defaults: {
        'width': "1px",
        'style': 'solid',
        'color': 'black',
        radius: "5%"
    },
    _schema: {
       "type":"object",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "style":{
             "type":"string",
             "enum": ["none","solid","dotted","dashed","double","groove","ridge","inset","outset"],
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          },
          "radius":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }
});



var PageDecorator = Thing.extend({
    init: function() {
        this.base();
        this.pageContent = $("<div>").addClass("page-content").appendTo(this.element);
        this.pageInfo = $("<div>").addClass('page-info').appendTo(this.element);
        this.setSlot('content', Thing.empty());
    },
    // options changed...
    refresh: function() {
        // TODO text mask?
        this.base();
        if(this.options.showInfo) this.pageInfo.show(); else this.pageInfo.hide();
        this.pageInfo.text("Page "+this.options.pageNumber);
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.pageContent.html(value.get());
        return this;
    },
    _klass: "page-decorator thing",
    _type: "page-decorator",
    _defaults: {
        'showInfo' : false,
        'pageNumber': 2,
        'pagesTotal' : 3,
        'recordsTotal' : 10
    },
    _schema: {
       "type":"object",
       "properties":{
          "showInfo":{
             "type":"boolean",
             "required":true
          },
          "pageNumber":{
             "type":"integer",
             "required":true
          },
          "pagesTotal":{
             "type":"integer",
             "required":true
          },
          "recordsTotal":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var CenteringDecorator = Thing.extend({
    init: function() {
        this.inner = $("<div>").addClass('content-inner').appendTo(
            $("<div>").addClass('center3').appendTo(
                $("<div>").addClass('center2').appendTo(
                    this.element
                )
            )
        );
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.inner.html(value.get());
        return this;
    },
    // options changed...
    refresh: function() {
        this.base();
        this.element.css('text-align',this.options['x-align']);
        this.element.children(".center2").css('vertical-align',this.options['y-align']);
        this.inner.css('width',this.options['content-width']);
        this.inner.css('height',this.options['content-height']);
    },
    _klass: "centering-decorator decorator thing",
    _type: "centering-decorator",
    _defaults: {
        'x-align': "center",
        'y-align': 'center',
        'content-width': '',
        'content-height': ''
    },
    _schema: {
       "type":"object",
       "properties":{
          "x-align":{
             "enum": ["left","center","right"],
             "type":"string",
             "required":true // TODO
          },
          "y-align":{
             "enum": ["top","middle","bottom"],
             "type":"string",
             "required":true // TODO
          },
          "content-width":{
             "type":"string",
             "required":true // TODO
          },
          "content-height":{
             "type":"string",
             "required":true // TODO
          }
       },
       "additionalProperties":true
    }
});



var RefDecorator = Thing.extend({
    init: function() {
        this._content = $("<div>").addClass("mykkro-ref-decorator-content")
        this._control = $("<a>").addClass('ref-link mykkro-ref-decorator-control')
        this._tooltip = $("<div>").addClass("hidden ref-tooltip")
        this.element.append(
            this._content,
            this._tooltip,
            this._control
        )
        this._control.qtip({content: { text: this._tooltip } })
        this.setSlot('content', Thing.empty())
    },
    refresh: function() {
        this.base()
        var label = this.options.label || "?"
        var src = this.options.source
        this._tooltip.empty().append($("<p>").text(__("Originally from:")))
        // TODO tohle nejak blbne...
        //if(Common.isValidUrl(src)) {
        if(src.startsWith("http")) {
            this._tooltip.append(
                $("<p>").append($("<a>").attr("href", src).text(src))
            )
            this._control.text(label).attr("href", src)
        } else {
            this._tooltip.append(
                $("<p>").text(src)
            )
            this._control.text(label).attr("href", "#").click(function() { return false;})
        }
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this._content.html(value.get());
        return this;
    },
    showToolbar: function() {
        this.options.hidden = false;
        this.refresh();
    },
    hideToolbar: function() {
        this.options.hidden = true;
        this.refresh();
    },
    /*
    serialize: function() {
        return this.getSlot('content').serialize();
    },
    */
    // pouziva se toto nekde?
    getTree: function() {
        // skip the outer layer...
        return this.getSlot('content').getTree();
    },
    /* ref decorator won't be editable */
    getTreeView: function(decorator) {
        // skip the outer layer...
        return this.getSlot('content').getTreeView(decorator);
    },
    _klass: "ref-decorator thing",
    _type: "ref-decorator",
    _defaults: {
        label: null,
        source: "http://www.google.com"
    },
    _schema: {
       "type":"object",
       "properties":{
          "label":{
             "type":"string",
             "required":false
          },
          "source":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }

});


var RefList = Thing.extend({
    init: function() {
      this.element.empty()
      this.element.append($("<p>").text(__("References")))
    },
    refresh: function() {
        this.base();
    },
    // refs = array of ref decorator objects
    setReferences: function(refs) {
      this.element.empty()
      this.element.append($("<p>").text(__("References")))
      var list = $("<ul>").appendTo(this.element)
      if(refs) {
        for(var i=0; i<refs.length; i++) {
          list.append(this.makeReference(refs[i], i))
        }
      } else {
        this.element.append($("<p>").text(__("No references found.")))
      }
    },
    makeReference: function(ref, index) {
      return $("<li>").append(
        $("<span>").addClass("ref-link").text(index+1),
        $("<span>").addClass("ref-label").text(ref.options.source)
      )
    },
    _klass: "ref-list thing",
    _type: "ref-list",
    _defaults: {
    },
    _schema: {
       "type":"object",
       "description":"References List properties",
       "properties":{
       },
       "additionalProperties":true
    }

});


var Ajax = Decorator.extend({
    init: function() {
        this.loaded($.noop);
        this.received(function(data) { return data; });
        this.transform(function(data) { return Thing.create(data); })
        this.base();
        this.reload();
    },
    reload: function() {
        var url = this.options.url;
        var self = this;
        if(url) {
            $.ajax({
              url: url,
              dataType: 'json',
              //data: data,
              success: function(data) {
                var thing = self.transform(self.received(data));
                self.setSlot('content', thing);
                self.loaded(thing);
              },
              error: function(jqXHR, textStatus, errorThrown) {
                // TODO dat tam misto toho chyb. panel
                alert("AJAX failed! "+textStatus);
              }
            });
        }
        if(this.options.reloadInterval) {
            var fun = function() { self.reload(); };
            setTimeout(fun, 1000*this.options.reloadInterval);
        }
    },
    loaded: function(arg) {
        if(typeof arg == 'function') {
            this.onloaded = arg;
        } else {
            return this.onloaded(arg);
        }
    },
    received: function(arg) {
        if(typeof arg == 'function') {
            this.onreceive = arg;
        } else {
            return this.onreceive(arg);
        }
    },
    transform: function(arg) {
        if(typeof arg == 'function') {
            this.ontransform = arg;
        } else {
            return this.ontransform(arg);
        }
    },
    _klass: "ajax thing",
    _type: "ajax",
    _defaults: {
        url: '', //"testing/thing.json",
        reloadInterval: 0 //60 // in seconds
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "reloadInterval": {
			    "type":"integer",
			    "required":true
		    },
		    "url": {
			    "type":"string",
			    "id": "url",
                "format": "uri",
			    "required":true
		    }
	    }
    }
});




var AjaxPager = Thing.extend({
    init: function() {
        var self = this;
        this.base();
        this.page = new Ajax();
        this.page.received(function(data) { return self._dataReceived(data);});
        this.page.transform(function(data) { return self._dataTransform(data);});
        this.page.loaded(function(ajax) {self._pageLoaded(ajax);});
        this.page.get().appendTo(this.element);
        this.createControls();
        this.setPage(this.options.page);
    },
    createControls: function() {
        this.pagerControls = $("<div>").addClass('pager-controls');
        if(!this.options.disablePagerControl) this.pagerControls.appendTo(this.element);
    },
    refreshView: function() {
        this.setPage(this.options.page);
    },
    setPage: function(num) {
        this.options.page = num;
        var url = null;
        if(this.options.page && this.options.baseUrl) {
            url = this.getPageUrl(this.options.page);
            this.page.options.url = url;
            this.page.reload();
        } else {
            // signal error
        }
    },
    getPageUrl: function(page) {
        return this.options.baseUrl + page + ".json";
    },
    // muzeme podedit pokud potrebujeme jine chovani, transformaci dat aj.
    _dataReceived: function(data) {
        return data;
    },
    _dataTransform: function(data) {
        return Thing.create(data);
    },
    _pageLoaded: function(ajax) {
        this.pagerControls.empty();
        if(ajax instanceof PageDecorator) {
            // rebuild page controls
            this._buildPageControls(ajax);
        }
    },
    _buildPageControls: function(paged) {
        // TODO udelat PagerControls jako Thing
        // stranky jsou cislovany od jedne, nejmensi cislo je 1
        var o = paged.options;
        if(o.pageNumber>1) {
            // add first link
            this.pagerControls.append(this._makePageLink(1, "first"));
        }
        if(o.pageNumber>1) {
            // add previous link
            this.pagerControls.append(this._makePageLink(o.pageNumber-1, "previous"));
        }
        this.pagerControls
            .append($("<span>").text(__("Page")+" "+o.pageNumber+" "+__("from")+" "+o.pagesTotal));        
        if(o.pageNumber<o.pagesTotal) {
            // add previous link
            this.pagerControls.append(this._makePageLink(o.pageNumber+1, "next"));
        }
        if(o.pageNumber<o.pagesTotal) {
            // add first link
            this.pagerControls.append(this._makePageLink(o.pagesTotal, "last"));
        }
    },
    _makePageLink: function(pageno, type) {
        var self = this;
        return $('<a href="#">').text(type).click(function() {
            self.setPage(pageno);
            return false;
        });
    },
    _klass: "ajax-pager thing",
    _type: "ajax-pager",
    _defaults: {
        baseUrl: '',// 'testing/multi/',
        page: 1,
        disablePagerControl: false
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "page": {
			    "type":"integer",
			    "required":true
		    },
		    "url": {
			    "type":"string",
			    "id": "url",
                "format": "uri",
			    "required":true
		    }
	    }
    }
});


var Layout = Thing.extend({
    _klass: "layout thing",
    _type: "layout"
});









var Slot = Base.extend({
    constructor: function(parent, name) {
        this.name = name;
        this.parent = parent;
        this.element = $("<div>").addClass("mykkro-slot").attr('data-name', name);
        this.thing = null;
    },
    empty: function() {
        this.element.empty();
        this.thing = null;
    },
    set: function(thing) {
        this.element.empty().append(thing.get());
        this.thing = thing;
    },
    get: function() {
        return this.thing;
    }
});


// TODO metody na prohazovani elementu - move to front/back, move up, move down
// TODO metody insert/delete?
// TODO -> DynamicLayout
var GrowableLayout = Layout.extend({
    init: function() {
        this.cells = []; // v tomto poradi budou v this.element!
        this.cellMap = {}; 
    },
    // remove all slots
    // TODO obsolete, use removeSlots instead
    clear: function() {
        this.element.empty();
        this.cells = [];
        this.cellMap = {};
    },
    length: function() {
        return this.cells.length;
    },
    first: function() {
        return this.cells.length ? this.cells[0] : undefined;
    },
    last: function() {
        return this.cells.length ? this.cells[this.cells.length-1] : undefined;
    },
    nth: function(ndx) {
        return (ndx>=0 && ndx<this.cells.length) ? this.cells[ndx] : undefined;
    },
    isEmpty: function() {
        return this.cells.length;
    },
    // dynamically add slot
    add: function(thing) {        
        var ndx = this.cells.length;
        var slot = new Slot(this, ndx);
        slot.element.appendTo(this.element);
        this.cells.push(slot);
        this.cellMap[ndx] = slot;
        this.setSlot(ndx, thing);
        return slot;
    },
    setSlot: function(key, value) {
        // TODO implement hasSlot
        this.base(key, value);
        this.cellMap[key].set(value);
        return this;
    },
    removeSlots: function() {
        // remove slot content...
        this.clearSlots(); 
        // remove slots proper...
        this.element.empty();
        this.slots = {};
        this.cells = [];
        this.cellMap = {};
    },
    setSlots: function(slots) {
        // remove existing slots...
        this.removeSlots();
        if(slots) {
            // pokud je parametr pole, udelat z nej objekt
            if($.isArray(slots)) slots = slots.toObject();
            for(var key in slots) {
                this.add(slots[key]);
            }
        }
    },
    _klass: "growable-layout layout thing",
    _type: "growable-layout",
    _defaults: {
        "css": "" //"mykkro-flow-layout"
    },
    _schema: {
       "type":"object",
       "properties":{
          "css":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }
});



// TODO metody na prohazovani elementu - move to front/back, move up, move down
// TODO metody insert/delete?
// TODO -> DynamicLayout
// TODO ze by se to poradi slotu dalo ulozit?
var OrderableLayout = GrowableLayout.extend({
    init: function() {
        this.cells = []; // v tomto poradi budou v this.element!
        this.cellMap = {}; 
    },
    // what muze byt Slot nebo Thing
    getSlotIndex: function(what) {
        if(what && typeof what === 'object') {
            for(var i=0; i<this.cells.length; i++) {
                if(this.cells[i] == what || this.cells[i].get() == what) return i;
            }
            return -1;
        } else {
            if(what>=0 && what < this.cells.length) return what;
            return -1;
        }
    },
    moveSlotUp: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>0) {
            // swap slots 'i-1' and 'i'
            this.swapSlots(slot-1, slot);
        }
    },
    moveSlotDown: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>=0 && slot<this.cells.length-1) {
            // swap slots 'i' and 'i+1'
            this.swapSlots(slot, slot+1);
        }
    },
    moveSlotToTop: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>0) {
            this.swapSlots(0, slot);
        }
    },
    moveSlotToBottom: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>=0 && slot<this.cells.length-1) {
            this.swapSlots(slot, this.cells.length-1);
        }
    },
    swapSlots: function(slot1, slot2) {
        slot1 = this.getSlotIndex(slot1);
        slot2 = this.getSlotIndex(slot2);
        if(slot1 != slot2) {
            // prohodit to v DOM...
            this.cells[slot1].element.swap(this.cells[slot2].element);
            var tmp = this.cells[slot1];
            this.cells[slot1] = this.cells[slot2];
            this.cells[slot2] = tmp;
        }
    },
    shuffle: function() {
        var len = this.cells.length;
        for (var i = len-1; i >=0; i--) {
            var randomIndex = Math.floor(Math.random()*(i+1)); 
            this.swapSlots(randomIndex, i);
        }
    },
    remove: function(what) {        
        var ndx = this.getSlotIndex(what);
        if(ndx>=0) {
            var slot = this.cells[ndx];
            this.cellMap[slot.name] = null;
            // remove from array
            this.cells.remove(ndx);
            // remove from DOM
            slot.element.remove();
            this.refresh();
        }
    },
    _klass: "orderable-layout growable-layout layout thing",
    _type: "orderable-layout",
    _defaults: {
        "css": "" //"mykkro-flow-layout"
    },
    _schema: {
       "type":"object",
       "properties":{
          "css":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }
});



var PreviewPager = AjaxPager.extend({
    constructor: function(options, callback) {
        this.base(options); // baseUrl, query, includePublic, allTags, disableSearchBox
        this.onselected = callback || $.noop;
    },
    createControls: function() {
        this.base();
        var self = this
        var changer = function() {
            self.refreshView()
        }
        this.searchBox = $('<input type="text" name="sf-text" class="search rounded" placeholder="Search...">').attr("value", this.options.query).on("change keyup paste", changer)
        this.publicCBox = $('<input type="checkbox" name="sf-public">').prop('checked', this.options.includePublic).change(changer)
        this.allCBox = $('<input type="checkbox" name="sf-all">').prop("checked", this.options.allTags).change(changer)
        if(!this.options.disableSearchBox) {
            var sc = $("<div>")
                .addClass('search-controls')
                .appendTo(this.element)
                .append(
                    $('<label>').append(this.searchBox), 
                    $('<label>').append(this.publicCBox, $('<span>Include public content</span>')),
                    $('<label>').append(this.allCBox, $('<span>Use all tags</span>'))
                );
        }
    },
    getPageUrl: function(page) {
        var text = encodeURIComponent(this.searchBox.val())
        var publ = this.publicCBox.is(':checked') ? 'true' : 'false'
        var all = this.allCBox.is(':checked') ? 'true' : 'false'
        return this.base(page) + "?public="+publ+"&text="+text+"&all="+all
    },
    _dataReceived: function(data) {
        return data;
    },
    _dataTransform: function(data) {
        var self = this;
        var ol = new OrderableLayout({"css":"mykkro-flow-layout"});
        for(var i=0; i<data.items.length; i++) {
            var thing = Thing.create(data.items[i].preview);
            var clickable = new Clickable({tooltip: data.items[i].title});
            clickable.setSlot('content', thing);
            (function() {
                var url = data.items[i].url;
                clickable.click(function() {
                    self._selected(url);
                });
/*
                // TODO settings - otevre formular
                // Thing ma definovane schema pro validaci options
                var st = makeSettingsToolbar(function(){
                    // change thing's settings
                    self._selected(url, true);
                });
                st.setSlot('content', clickable);
                ol.add(st);
*/
                ol.add(clickable);
            })();
        }
        var pd = new PageDecorator({
            'pageNumber': data.page,
            'pagesTotal' : data.pagesTotal,
            'recordsTotal' : data.itemsTotal            
        });
        pd.setSlot('content', ol);
        return pd;
    },
    _selected: function(url, editSettings) {
        var self = this;
         $.ajax({
              url: url,
              dataType: 'json',
              //data: data,
              success: function(data) {
                   console.log("Selected:")
                   console.log(data)
                  if(editSettings) {
                     // ziskat schema, zobrazit formular, nastavit data.options                    
                  }
                  var thing = Thing.create(data);
                  self.onselected(thing);
              }
          });
    },
    _type: "preview-pager"
}, {
    choose: function(type, callback, options) {
        options = options || {}
	    var mm = {};
        var url = baseUrl+'api/pagedpreviews/'+type+'/';
        var ap = new PreviewPager($.extend({baseUrl:url}, options), function(thing) { 
            mm.modal.close();
            if(callback) callback(thing);
        });
        /**/options.resizable = false/**/
        mm.modal = Modal.show(ap, options);
    }
});


// TODO vertical split
var SplitLayout = Layout.extend({
    init: function() {
        this.first = $("<div>");
        this.second = $("<div>");
        this.element.append(this.first).append(this.second);
        this.setSlot('first', Thing.empty());
        this.setSlot('second', Thing.empty());
    },
    // options changed...
    refresh: function() {
        this.base();
        var first = this.options.ratio + "%";
        var gap = this.options.gap + "%";
        var xx = (this.options.ratio + this.options.gap) + "%";
        var second = (100 - this.options.ratio - this.options.gap) + "%";
        if(this.options.horizontal) {
            this.first.css("left","0px").css("top","0px").css("width",first).css('height','100%');
            this.second.css("left",xx).css("top","0px").css("width",second).css('height','100%');
        } else {
            this.first.css("left","0px").css("top","0px").css("height",first).css('width','100%');
            this.second.css("left","0px").css("top",xx).css("height",second).css('width','100%');
        }
    },
    setSlot: function(key, value) {
        // TODO implement hasSlot
        this.base(key, value);
        if(key=='first') {
            this.first.empty().append(value.get());
        }
        if(key=='second') {
            this.second.empty().append(value.get());
        }
        return this;
    },
    _klass: "split-layout layout thing",
    _type: "split-layout",
    _defaults: {
        ratio: 70, // v %
        gap: 2, // v %
        horizontal: false
    },
    _schema: {
       "type":"object",
       "properties":{
          "horizontal":{
             "type":"boolean",
             "required":true
          },
          "ratio":{
             "type":"integer",
             "required":true
          },
          "gap":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});



var GridLayout = Layout.extend({
    init: function() {
        // TODO create grid and slots
        this.cellCount = 0;
        this.cells = {};
        for(var i=0; i<this.options.rows; i++) {
            for(var j=0; j<this.options.columns; j++) {
                // create slot
                this.cells[this.cellCount] = $("<div>").appendTo(this.element);                
                // set slot value
                this.setSlot(this.cellCount, Thing.empty());
                this.cellCount++;
            }
        }
    },
    // options changed...
    refresh: function() {
        this.base();
        var gap = this.options.gap;
        var cols = this.options.columns;
        var rows = this.options.rows;
        if(cols*rows != this.cellCount) {
          // resize grid...
          if(cols*rows < this.cellCount) {
            // truncate array...
            while(this.cellCount > rows*cols) {
                this.cellCount--;
                this.removeSlot(this.cellCount)
            }
          } else {
            // expand array by adding new elements
            while(this.cellCount<rows*cols) {
                // create slot
                this.cells[this.cellCount] = $("<div>").appendTo(this.element);                
                // set slot value
                this.setSlot(this.cellCount, Thing.empty());
                this.cellCount++;
            }
          }          
        }
        var ww = Math.round(10*(100 - (cols-1)*gap)/cols)/10;
        var hh = Math.round(10*(100 - (rows-1)*gap)/rows)/10;
        var xx = 0;
        var yy = 0;
        var ndx = 0;
        for(var i=0; i<rows; i++) {
            for(var j=0; j<cols; j++) {
                this.cells[ndx].css({
                    "width": ww+"%",
                    "height": hh+"%",
                    "left": xx+"%",
                    "top": yy+"%"
                });
                ndx++;
                xx += ww + gap;
            }
            xx = 0;
            yy += hh + gap;
        }
    },
    setSlot: function(key, value) {
        if(!!this.cells[key]) {
          this.base(key, value);
          this.cells[key].empty().append(value.get());
        }
        return this;
    },
    removeSlot: function(key) {
        if(this.hasSlot(key)) {
          this.cells[key].remove()
          delete this.cells[key]                
          this.base(key);
        }
    },
    _klass: "grid-layout layout thing",
    _type: "grid-layout",
    _defaults: {
        rows: 3, // nemelo by se menit za behu
        columns: 3, // nemelo by se menit za behu
        gap: 2 // v procentech
    },
    _schema: {
       "type":"object",
       "properties":{
          "rows":{
             "type":"integer",
             "required":true
          },
          "columns":{
             "type":"integer",
             "required":true
          },
          "gap":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});



var SwitchLayout = GrowableLayout.extend({
    refresh: function() {
        this.base();
        var index = parseInt(this.options.index)+1;
        this.element.children().hide();
        this.element.find("div:nth-child("+index+")").show();
    },
    setIndex: function(ndx) {
        this.options.index = ndx;
        this.refresh();
    },
    add: function(thing) {
        var slot = this.base(thing);
        this.refresh();
        return slot;
    },
    _klass: "switch-layout growable-layout layout thing",
    _type: "switch-layout",
    _defaults: {
        "css": "", //"mykkro-flow-layout"
        index: 0
    },
    _schema: {
       "type":"object",
       "properties":{
          "css":{
             "type":"string",
             "required":false
          },
          "index":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var Book = GrowableLayout.extend({
    currentPage: 0,
    init: function() {
        this.base();
        console.log("Book created")
        console.log(this)
    },
    refresh: function() {
        this.base();
    },
    // TODO tohle se muze zavolat jen pokud jsou stranky uz vlozena do DOMu
    makeDisplay: function() {
        var self = this;
	    // kniha = <div class="mykkro-book> <div class="mykkro-slot"> .. </div>
	    this.element.addClass(this.options.display);
	    switch(this.options.display) {
	      case 'basic':
	        // add page numbers...
	        break;
	      case "turnable":
	        this.element.turn({gradients: true, acceleration: true});
            this.element.bind("start", function(ev, pageObject, corner) { 
                self.onTurnStart(ev, pageObject, corner); })
            this.element.bind("turning", function(ev, page, pageObject) { 
                self.onTurning(ev, page, pageObject); })
            this.element.bind("turned", function(ev, page, view) { 
                self.onTurned(ev, page, view); })
            this.element.bind("end", function(ev, pageObject, turned) { 
                self.onTurnEnd(ev, pageObject, turned); })
	        break;
	    }
    },
    _setPage: function(page) {
        if(!this.currentPage) {
            // page 1 became visible
            this.onPageVisibilityChange(page, true);
        }
        else if(this.currentPage>>1 == page>>1) {
            // je videt porad stejna dvoustrana
        } else {            
            // visibility changed
            var oldPages = 2*(Math.floor(this.currentPage / 2));
            var newPages = 2*(Math.floor(page / 2));
            this.onPageVisibilityChange(oldPages, false);
            this.onPageVisibilityChange(oldPages+1, false);
            this.onPageVisibilityChange(newPages, true);
            this.onPageVisibilityChange(newPages+1, true);
        }
        this.currentPage = page;
        // notifikovat stranky pokud se jejich viditelnost zmenila
        this.onPageChange(page);
    },
    // TODO udelat si na to taky bind funkci
    onPageVisibilityChange: function(page, visible) {
        if(typeof(page)=='function') this._onPageVisibilityChange = page;  
        else {
            // mame takovou stranku?
            var name = page-1;
            if(this.slots[name]) {
                this._updatePageVisibility(page, visible);
                if(this._onPageVisibilityChange) this._onPageVisibilityChange(page, visible);
            }
        }
    },
    _updatePageVisibility: function(page, visible) {
        // pri zviditelneni musim refereshnout vsechny audio-decoratory a video-thingy
        // pri zneviditelneni vypnout jejich playback
        //log("Page: "+page+" visibility: "+visible);
        var name = page-1;
        var thing = this.slots[name];
        var media = [];
        thing.findSlotsByType('audio-decorator', media);
        thing.findSlotsByType('video-thing', media)
        //log(audio.length+","+video.length);
        if(visible) {
            // page became visible...
            for(var i=0; i<media.length; i++) {
                media[i].refresh();
                if(media[i].options['autoplay']) {
                    media[i].play();
                }
            }
        } else {
            // TODO stop only if playing...
            for(var i=0; i<media.length; i++) media[i]._kill();
        }
    },
    onPageChange: function(ev) {
        if(typeof(ev)=='function') this._onPageChange = ev;  
        else {
            if(this._onPageChange) this._onPageChange(ev);
        }
    },
    onInit: function(ev) {
        if(typeof(ev)=='function') this._onInit = ev;  
        else {
            this._setPage(1);
            if(this._onInit) this._onInit();
        }
    },
    onExit: function(ev) {
        if(typeof(ev)=='function') this._onExit = ev;  
        else {
            if(this._onExit) this._onExit();
        }
    },
    onTurnStart: function(ev, pageObject, corner) {
        if(typeof(ev)=='function') this._onTurnStart = ev;  
        else {
            if(this._onTurnStart) this._onTurnStart(ev, pageObject, corner);
        }
    }, 
    onTurning: function(ev, page, pageObject) {
        if(typeof(ev)=='function') this._onTurning = ev;  
        else {
            if(this._onTurning) this._onTurning(ev, page, pageObject);
        }
    }, 
    onTurned: function(ev, page, view) { 
        if(typeof(ev)=='function') this._onTurned = ev;  
        else {
            this._setPage(page);
            if(this._onTurned) this._onTurned(ev, page, view);
        }
    }, 
    onTurnEnd: function(ev, pageObject, turned) { // nefunguje
        if(typeof(ev)=='function') this._onTurnEnd = ev;  
        else {
            if(this._onTurnEnd) this._onTurnEnd(ev, pageObject, corner);
        }
    }, 
    _klass: "book growable-layout layout thing",
    _type: "book",
    _defaults: {
        "title": "My Book",
	    "display": "basic"
    },
    _schema: {
       "type":"object",
       "properties":{
          "title":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var Quest = Thing.extend({
    init: function() {
        this.status = 'active';
        this.finished($.noop);
    },
    refresh: function() {
        this.base();
        //this.inner.html(this.options.html).attr('class',this.options.innerCss);
    },
    finished: function(arg) {
        if(typeof arg == 'function') {
            this.onfinished = arg;
        } else {
            return this.onfinished(arg);
        }
    },
    pass: function() {
        this.status = 'passed';
        this.finished({'quest':this, 'status':this.status});
    },
    fail: function() {
        this.status = 'failed';
        this.finished({'quest':this, 'status':this.status});
    },
    _klass: "quest thing",
    _type: "quest",
    _defaults: {
        //html: ""
    },
    _schema: {
       "type":"object",
       "description":"Quest properties",
       "properties":{
/*
          "html":{
             "type":"string",
             "required":true
          },
          "css":{
             "type":"string",
             "required":false
          },
          "innerCss":{
             "type":"string",
             "required":false
          }
*/
       },
       "additionalProperties":true
    }

});

var DemoQuest = Quest.extend({
    init: function() {
        this.base();
        var self = this;
        this.passButton = $("<button>").text("Pass").click(function() { self.pass(); }).appendTo(this.element);
        this.failButton = $("<button>").text("Fail").click(function() { self.fail(); }).appendTo(this.element);
        this.statusBar = $("<span>").appendTo(this.element);
        this.statusBar.text('active');
    },
    pass: function() {
        this.statusBar.text('passed');
        this.passButton.prop('disabled', true);
        this.failButton.prop('disabled', true);
        this.base();
    },
    fail: function() {
        this.statusBar.text('failed');
        this.passButton.prop('disabled', true);
        this.failButton.prop('disabled', true);
        this.base();
    },
    _klass: "demo-quest quest thing",
    _type: "demo-quest",
    _defaults: {
        //html: ""
    },
    _schema: {
       "type":"object",
       "description":"Demo Quest properties",
       "properties":{
/*
          "html":{
             "type":"string",
             "required":true
          },
          "css":{
             "type":"string",
             "required":false
          },
          "innerCss":{
             "type":"string",
             "required":false
          }
*/
       },
       "additionalProperties":true
    }

});

var PlayerControls = Thing.extend({
    _onplay: $.noop,
    _onpause: $.noop,
    _onstop: $.noop,
    init: function() {
        var self = this;
        var cont = $("<div>").addClass('controls').appendTo(this.element);
        this._playBtn = $("<button>")
            .addClass("play").append($("<span>").text("Play"))
            .appendTo(cont).click(function() { self.onPlay(); });
        this._pauseBtn = $("<button>")
            .addClass("pause").append($("<span>").text("Pause"))
            .appendTo(cont).click(function() { self.onPause(); });
        this._stopBtn = $("<button>")
            .addClass("stop").append($("<span>").text("Stop"))
            .appendTo(cont).click(function() { self.onStop(); });
        this.controls = cont;
        this.playing = false;
        this.paused = false;
    },
    refresh: function() {
        this.base();
        this.controls.toggleClass('playing', this.playing);
        this._playBtn.prop('disabled', this.playing);
        this._pauseBtn.prop('disabled', !this.playing);
        this._stopBtn.prop('disabled', !(this.playing/* || this.paused*/));    
        if(this.playing) {
            this._playBtn.hide();
            this._pauseBtn.show();
        } else {
            this._playBtn.show();
            this._pauseBtn.hide();
        }        
        if(this.playing/* || this.paused*/) {
            this._stopBtn.show();
        } else {
            this._stopBtn.hide();
        }
    },
    updateGui: function(playing, paused) {
        this.playing = playing;
        this.paused = paused;
        this.refresh();
    },
    onPlay: function(kb) {
        if(typeof kb == 'function') {
            this._onplay = kb;
        } else {
            this.updateGui(true, false);
            this._onplay(kb);
        }
    },
    onPause: function(kb) {
        if(typeof kb == 'function') {
            this._onpause = kb;
        } else {
            this.updateGui(false, true);
            this._onpause(kb);
        }
    },
    onStop: function(kb) {
        if(typeof kb == 'function') {
            this._onstop = kb;
        } else {
            this.updateGui(false, false);
            this._onstop(kb);
        }
    },
    _klass: "player-controls thing",
    _type: "player-controls",
    _defaults: {
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
	    }
    }
});


var AudioDecorator = Thing.extend({
    _onplay: $.noop,
    _onpause: $.noop,
    _onstop: $.noop,
    _onkill: $.noop,
    onPlay: function(kb) {
        if(typeof kb == 'function') {
            this._onplay = kb;
        } else {
            this._onplay(kb);
        }
    },
    onPause: function(kb) {
        if(typeof kb == 'function') {
            this._onpause = kb;
        } else {
            this._onpause(kb);
        }
    },
    onStop: function(kb) {
        if(typeof kb == 'function') {
            this._onstop = kb;
        } else {
            this._onstop(kb);
        }
    },
    onKill: function(kb) {
        if(typeof kb == 'function') {
            this._onkill = kb;
        } else {
            this._onkill(kb);
        }
    },
    init: function() {
        this.slot = $("<div>").addClass("slot");
        this.setSlot('content', Thing.empty());
    },
    play: function() {
        this._play();
        this.player.updateGui(true, false);
    },
    _play: function() {
        this.audio.get(0).play();
        this.onPlay();
    },
    _pause: function() {
        this.audio.get(0).pause();
        this.onPause();
    },
    _stop: function() {
        // regenerate player...
        this.refresh();
        this.onStop();
    },
    _kill: function() {
        this.audio.get(0).pause();
        this.audio.get(0).src = "";
        this.onKill();
    },
    _setVolume: function(vol) {
        // HTML5 volume is between 0 and 1
        this.audio.get(0).volume = vol / 100.0;
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.slot.html(value.get());
        return this;
    },
    _addSource: function(uri, type) {
        if(uri) $("<source>").attr({src:uri, type: type, preload: false/**/}).appendTo(this.audio);
    },
    refresh: function() {
        this.base();
        var self = this;
        this.audio = $("<audio>");
        this.player = new PlayerControls();  
        this.player.onPlay(function() { self._play(); });
        this.player.onPause(function() { self._pause(); });
        this.player.onStop(function() { self._stop(); });
        var cc = new CenteringDecorator({},{content: this.player});
        this.pane = cc.get();
        this.pane.addClass("player");
        this.element.empty()
            .append(this.slot)
            .append(this.pane)
            .append(this.audio);

        // incorrect... and unnecessary: this.audio.remove("source");
        this.audio.prop('loop', this.options.loop);
        if(this.options.uri) {            
            var ext = this.options.uri.split('.').pop();
            this.options.ogg = (ext == 'ogg') ? this.options.uri : '';
            this.options.mp3 = (ext == 'mp3') ? this.options.uri : '';
        }
        this._addSource(this.options.ogg, 'audio/ogg; codecs="vorbis"');
        this._addSource(this.options.mp3, 'audio/mpeg; codecs="mp3"');
        // HTML5 volume is between 0 and 1
        this._setVolume(this.options.volume);
    },
    _klass: "audio-decorator decorator thing",
    _type: "audio-decorator",
    _defaults: {
        'ogg': "",
        'mp3': "",
        'uri': "",
        'autoplay': false,
        'loop': false,
        'volume': 50
    },
    _schema: {
       "type":"object",
       "properties":{
          "uri":{
             "type":"string",
             "format": "my-voice-uri",
            // TODO vadi mu kdyz je to false - option se neda rozkliknout
             "required":true
          },
          "volume":{
             "type":"integer",
             "required":true // TODO
          },
          "autoplay":{
             "type":"boolean",
             "required":true // TODO
          },
          "loop":{
             "type":"boolean",
             "required":true // TODO
          }
       },
       "additionalProperties":true
    }
});



var VideoThing = Thing.extend({
    _onplay: $.noop,
    _onpause: $.noop,
    _onstop: $.noop,
    _onkill: $.noop,
    onPlay: function(kb) {
        if(typeof kb == 'function') {
            this._onplay = kb;
        } else {
            this._onplay(kb);
        }
    },
    onPause: function(kb) {
        if(typeof kb == 'function') {
            this._onpause = kb;
        } else {
            this._onpause(kb);
        }
    },
    onStop: function(kb) {
        if(typeof kb == 'function') {
            this._onstop = kb;
        } else {
            this._onstop(kb);
        }
    },
    onKill: function(kb) {
        if(typeof kb == 'function') {
            this._onkill = kb;
        } else {
            this._onkill(kb);
        }
    },
    init: function() {
    },
    play: function() {
        this._play();
        this.player.updateGui(true, false);
    },
    _play: function() {
        this.video.get(0).play();
        this.onPlay();
    },
    _pause: function() {
        this.video.get(0).pause();
        this.onPause();
    },
    _stop: function() {
        //this.video.get(0).pause();
        //this.video.get(0).currentTime = 0;
        // regenerate player...
        this.refresh();  // TODO udelat to lepe
        this.onStop();
    },
    _kill: function() {
        this.video.get(0).pause();
        this.video.get(0).src = "";
        this.onKill();
    },
    _setVolume: function(vol) {
        // HTML5 volume is between 0 and 1
        this.video.get(0).volume = vol / 100.0;
    },
    _addSource: function(uri, type) {
        if(uri) {
            $("<source>").attr({src:uri, type: type, preload: false/**/}).appendTo(this.video);
        }
    },
    refresh: function() {
        this.base();
        var self = this;
        this.video = $("<video>");
        this.player = new PlayerControls();  
        this.player.onPlay(function() { self._play(); });
        this.player.onPause(function() { self._pause(); });
        this.player.onStop(function() { self._stop(); });
        var cc = new CenteringDecorator({},{content: this.player});
        this.pane = cc.get();
        this.pane.addClass("player");
        this.element.empty()
            .append(this.video)
            .append(this.pane);

        this.video.prop('loop', this.options.loop);
        if(this.options.uri) {            
            var ext = this.options.uri.split('.').pop();
            this.options.ogg = (ext == 'ogg' || ext == 'ogv') ? this.options.uri : '';
            this.options.mp4 = (ext == 'mp4') ? this.options.uri : '';
            this.options.webm = (ext == 'webm') ? this.options.uri : '';
        }
        this._addSource(this.options.ogg, 'video/ogg; codecs="theora, vorbis"');
        this._addSource(this.options.mp4, 'video/mp4; codecs="avc1.42E01E, mp4a.40.2"');
        this._addSource(this.options.webm, 'video/webm; codecs="vp8, vorbis"');
        ////this.video.get(0).src = this.options.uri;
        // TODO tohle nejak zlobi v Chrome, pri znovuvytvareni videi... ale ve FF to zda se funguje

        // HTML5 volume is between 0 and 1
        this._setVolume(this.options.volume);
        this.video.on('canplay canplaythrough', function(){
            console.log('canplay event fired');
        });
    },
    _klass: "video-thing thing",
    _type: "video-thing",
    _defaults: {
        "uri": "",
        'ogg': "",
        'mp4': "",
        'webm': "",
        'autoplay': false,
        'loop': false,
        'volume': 50
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "uri": {
			    "type":"string",
                "format": "my-video-uri",
			    "required":true
    	    },
            "volume":{
                "type":"integer",
                "required":true // TODO
            },
            "autoplay":{
                "type":"boolean",
                "required":true // TODO
            },
            "loop":{
                "type":"boolean",
                "required":true // TODO
            }
	    }
    }

});


/*

document.addEventListener('DOMContentLoaded', function(){
    var v = document.getElementById('vid');
    var canvas = document.getElementById('canvas');
    var context = canvas.getContext('2d');

    var cw = canvas.clientWidth;
    var ch = canvas.clientHeight;
    canvas.width = cw;
    canvas.height = ch;

    v.addEventListener('play', function(){
        draw(this,context);
    },false);

},false);

var mode = 'stretch';
function draw(v,c) {
    var canvas = document.getElementById('canvas');
    var w = canvas.clientWidth;
    var h = canvas.clientHeight;
    if(v.paused || v.ended) return false;
    if(mode == 'stretch') {
        c.drawImage(v,0,0,w,h); //-> stretch
    } else if(mode == 'cover') {
        // TODO tady je neco spatne
        var sx=0, sy=0, sw=v.width, sh=v.height;
        if(sw/sh < w/h) {
            sy = (sh - h*sw/w)/2;
            sh = h*sw/w;
        } else {
            sx = (sw - w*sh/h)/2;
            sw = w*sh/h;
        }
        c.drawImage(v,sx,sy,sw,sh,0,0,w,h); 
    } else { // contain
        var ww = v.width;
        var hh = v.height;
        var x = y = 0;
        if(ww/hh < w/h) {
            x = (w-ww*h/hh)/2;
            c.drawImage(v,x,0,ww*h/hh,h); 
        } else {
            y = (h-hh*w/ww)/2;
            c.drawImage(v,0,y,w,hh*w/ww); 
        }
    }
    setTimeout(draw,20,v,c);
}

<canvas id="canvas"></canvas>

*/

// TODO udelat z toho Thing
// TODO k ikonam pridat tooltipy

var BookViewer = Base.extend({
    constructor: function(options) {
        this.bookData = options.data;
        this.bookUrl = options.url;
        this.eventUrl = options.eventUrl;
        this.fullscreen = options.fullscreen;
        this.logger = options.logger;
        this.defaultWidth = 920;
        this.defaultHeight = 600;
        this.tools = {};
        this.bookContent = null;
        this.eventHistory = [];
        this.targetDiv = "#content"
    },
    makeIcon: function(icon, title) {
        return $("<div>").addClass('icon icon-48 icon-'+icon).css('display','inline-block').attr("title", title);
    },
    makeTool: function(icon, label, left/*bool*/, top, click) {
        this.tools[icon] = this.makeIcon(icon, label).css({position:'absolute', top: top}).css(left ? {'left':'6px'}:{'right':'6px'}).click(click).appendTo($("#book-wrapper"));
        return this.tools[icon];
    },
    showIcon: function(icon, enable) {
        if(enable) this.tools[icon].show() ; else this.tools[icon].hide();
    },
    turnNext: function() {
        this.bookContent.get().turn("next");
    },
    turnPrevious: function() {
        this.bookContent.get().turn("previous");
    },
    turnFirst: function() {
        this.bookContent.get().turn("page", 1);
    },
    goHome: function() {
        this.logEvent('book_close', this.bookUrl);
        window.location.href = this.bookUrl;
    },
    // v Chrome to nejak nefunguje...
    close: function() {
        this.logEvent('book_close', this.bookUrl);
        window.open('','_self','');
        window.close();
    },
    closeBook: function() {
        // normal viewer only turns to page 1
        this.turnFirst()
    },
    _setPageBackgrounds: function(bookContent, o) {
        var totalPages = bookContent.length()
        for(var i=0; i<totalPages; i++) {
            var slot = bookContent.nth(i)
            var elem = slot.element
            var css = { "background-size": "cover", "background-color": "white"}
            if(i==0) {
                // first page
                css["background-image"] = 'url('+o.frontpage_image_url+')'
            } else if(i == totalPages-1 && i%2!=0) {
                // last page, must be odd
                css["background-image"] = 'url('+o.backpage_image_url+')'
            } else if(i%2==0) {
                // even page
                css["background-image"] = 'url('+o.evenpage_image_url+')'
            } else {
                // odd page
                css["background-image"] = 'url('+o.oddpage_image_url+')'
            }
            elem.css(css)
        }
    },
    _makeWrapper: function(o) {
        return $("<div>")
            .attr("id", "book-wrapper")
            .css('position','relative')
            .css("background-image", 'url('+o.background_image_url+')')
    },
    _makeReferences: function(bookContent) {
        // gather references...
        var refs = [];
        bookContent.findSlotsByType('ref-decorator', refs);
        for(var i=0; i<refs.length; i++) {
            refs[i].options.label = (i+1)+""
            refs[i].refresh()
        }
        // TODO find reference-page layout and fill it by reference info...
        var reflists = [];
        bookContent.findSlotsByType('ref-list', reflists);
        // only the first will be used; later: we can split reference items into multiple ref lists
        if(reflists.length>0) {
            reflists[0].setReferences(refs);
        }
    },
    _monitorMediaEvents: function(bookContent) {
        // find audio and video Things and monitor their play, stop, pause, kill events
        var media = [];
        var self = this;
        bookContent.findSlotsByType('audio-decorator', media);
        bookContent.findSlotsByType('video-thing', media);
        for(var i=0; i<media.length; i++) {
            var m = media[i]; 
            var src = m.options.uri;           
            (function(){
                m.onPlay(function() { self.logEvent('book_media_play', src); });
                m.onPause(function() { self.logEvent('book_media_pause', src); });
                m.onStop(function() { self.logEvent('book_media_stop', src); });
                m.onKill(function() { self.logEvent('book_media_kill', src); });
            })();
        }
    },
    init: function() {
        /* display book... */
        var self = this;
        var width = this.defaultWidth;
        var height = this.defaultHeight;
        var o = this.bookData.options      
        // create wrapper...
        var wrapper = this._makeWrapper(o);
        wrapper.appendTo(this.targetDiv);
        this.bookContent = Thing.create(this.bookData, {"display":"turnable"});

        this._setPageBackgrounds(this.bookContent, o)
        this._makeReferences(this.bookContent)
        this._monitorMediaEvents(this.bookContent)
        
        // init book...
        this.bookContent.onInit();
        $("#book-wrapper").css({width:width+"px", height:height+"px"}).html(this.bookContent.get());
        this.bookContent.makeDisplay();

        // events...
        $(window).unload(function() {
            self.bookContent.onExit(); // TODO tohle mi nejak nefunguje...
        });
        $(window).resize(function() {
            if(self.fullscreen) {
                self.updateToolbar(self.recreate());
            }
        });
        $(window).bind("fullscreen-toggle", function(e, state) {
            self.setFullscreen(state);
        });
        this.bookContent.get().bind("turned", function(event, page, view) {
            self.updateToolbar();
            self.logEvent('book_page_turn', self.bookUrl, self.bookContent.get().turn("page"));
        });
        this.makeTool('turn-right', __('Previous page'), true, '50%', function() { self.turnPrevious();});
        this.makeTool('turn-left', __('Next page'), false, '50%', function() { self.turnNext();});
        this.makeTool('closebook', __('Close book'), false, '16px', function() { self.closeBook();});
        // reduce close icon in size...
        this.tools['closebook'].css({top: '16px', width: "24px", height: "24px"});

        // update icons...
        //$("#book-wrapper >.icon-turn-left").css("background-image", 'url('+o.turnleft_image_url+')')
        //$("#book-wrapper >.icon-turn-right").css("background-image", 'url('+o.turnright_image_url+')')

        this.updateToolbar();
        this.logEvent('book_open', this.bookUrl);
    },
    logEvent: function(type, src, data) {
        var timestamp = Math.floor(new Date().getTime() / 1000);
        this.logSingleEvent({"type":type,"src":src,"data":data,"timestamp":timestamp});
        if(type == 'book_close') {  
            // flush events...
            this.flushEventLog();
        }
    },
    logSingleEvent: function(evt) {
        if(this.logger) {
            this.logger(evt)
        }
        this.eventHistory.push(evt);
        if(this.eventUrl) {
            Common.postJsonData(this.eventUrl+".json", evt);
        }
    },
    flushEventLog: function() {
        // TODO odesilat eventy pres AJAX
        console.log(JSON.stringify(this.eventHistory, null, 4));
    },
    setFullscreen: function(full) {
        this.fullscreen = full;
        this.bookContent.get().turn('disable', true);
        if(this.fullscreen) {
            $("#book-wrapper").appendTo($("#fullscreen"));
            $("#container").hide();
            $("#fullscreen").show();            
        } else {
            $("#book-wrapper").appendTo($("#content"));
            $("#container").show();
            $("#fullscreen").hide();

        }
        this.bookContent.get().turn('disable', false);
        this.updateToolbar(this.recreate());
        this.logEvent('book_fullscreen', this.bookUrl, full);
        return full;    
    },
    recreate: function() {
        var width = this.defaultWidth;
        var height = this.defaultHeight;
        // kniha je velka 800x560 - pomer stran cca 1:sqrt(2) ~ 1:1.428
        if(this.fullscreen) {
            var ww = $(window).width();
            var hh = $(window).height();
            var scaleFactor = ww/width;
            var scaleFactor2 = hh/height;
            var scale = Math.min(scaleFactor, scaleFactor2);
            width = /*Math.floor(width*scale);*/ww;
            height = /*Math.floor(height*scale);*/hh;
        } 
        // resize wrapper and pages...
        $("#book-wrapper").css({width:width+"px", height:height+"px"});
        if(this.fullscreen) {
            // na okrajich musi zbyt 8% mista; to odpovida 60px 
            var sidex = Math.max(Math.floor(width*0.08), 60);
            var newWidth = width - 2*sidex;
            var newHeight = Math.floor(newWidth/1.428);
            var maxHeight = height-40;
            if(newHeight > maxHeight) {
                newWidth = Math.floor(newWidth*maxHeight/newHeight);
                newHeight = maxHeight;
            }
        } else {
            var newWidth = width - 120;
            var newHeight = height - 40;
        }
        this.bookContent.get().turn('size', newWidth, newHeight);
        return newWidth;
    },
    updateToolbar: function(gapWidth) {
        var page = this.bookContent.get().turn("page");
        var pages = this.bookContent.get().turn("pages");
        this.showIcon('turn-right', page>1);
        this.showIcon('turn-left', page<(pages-pages%2)); // kdyz ma kniha 3 strany, uz nejde druha otocit
        //this.showIcon('fullscreen-on', !this.fullscreen);
        //this.showIcon('fullscreen-off', this.fullscreen);
        
        if(gapWidth) {
            var gapSize = 60;
            if(this.fullscreen) {
                gapSize += Math.floor(($("#book-wrapper").width() - gapWidth)/2);
            }
            var hh = this.bookContent.get().height();
            var iconSize = Math.min(gapSize - 12, 240);
            var iconSizeHalf = Math.floor(iconSize/2);
            var hh2 = Math.max(Math.floor(hh/2-iconSize/2), 28+3*iconSize);
            this.tools['turn-right'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['turn-left'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            //this.tools['fullscreen-on'].css({top: (20+iconSize)+'px', width: iconSize+"px", height: iconSize+"px"});
            //this.tools['fullscreen-off'].css({top: (20+iconSize)+'px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['closebook'].css({top: '16px', width: iconSizeHalf+"px", height: iconSizeHalf+"px"});
            //if(this.bookUrl) this.tools['home'].css({top: '16px', width: iconSize+"px", height: iconSize+"px"});
        }
    }
});

var ExportBookViewer = BookViewer.extend({
    constructor: function(options) {
        this.base(options);
        this.targetDiv = "#fullscreen"
    },
    init: function() {
        this.base()
        this.setFullscreen(true);
    },
    closeBook: function() {
        // export viewer closes the book
        this.close()
    },
    updateToolbar: function(gapWidth) {
        var page = this.bookContent.get().turn("page");
        var pages = this.bookContent.get().turn("pages");
        this.showIcon('turn-right', page>1);
        this.showIcon('turn-left', page<(pages-pages%2)); // kdyz ma kniha 3 strany, uz nejde druha otocit

        if(gapWidth) {
            var gapSize = 60;
            if(this.fullscreen) {
                gapSize += Math.floor(($("#book-wrapper").width() - gapWidth)/2);
            }
            var hh = this.bookContent.get().height();
            var iconSize = Math.min(gapSize - 12, 240);
            var iconSizeHalf = Math.floor(iconSize/2);
            var hh2 = Math.max(Math.floor(hh/2-iconSize/2), 28+2*iconSize);
            this.tools['turn-right'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['turn-left'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['closebook'].css({top: '16px', width: iconSizeHalf+"px", height: iconSizeHalf+"px"});
        }
    },
    setFullscreen: function(full) {
        this.fullscreen = full;
        this.updateToolbar(this.recreate());
        this.logEvent('book_fullscreen', this.bookUrl, full);
        return full;    
    }
});



$.tubeplayer.defaults.afterReady = function($player) {
    console.log($player)
    // TODO resize only single player
	$(".tubeplayer-wrapper").resize()
}

var TubeplayerThing = Thing.extend({
    _onplay: $.noop,
    _onpause: $.noop,
    _onstop: $.noop,
    _onkill: $.noop,
    onPlay: function(kb) {
        if(typeof kb == 'function') {
            this._onplay = kb;
        } else {
            this._onplay(kb);
        }
    },
    onPause: function(kb) {
        if(typeof kb == 'function') {
            this._onpause = kb;
        } else {
            this._onpause(kb);
        }
    },
    onStop: function(kb) {
        if(typeof kb == 'function') {
            this._onstop = kb;
        } else {
            this._onstop(kb);
        }
    },
    onKill: function(kb) {
        if(typeof kb == 'function') {
            this._onkill = kb;
        } else {
            this._onkill(kb);
        }
    },
    thumbnailUrl: function() {
        return $.jYoutube(this.options.name, 'small');
    },
    init: function() {
    	this.wrapper = $("<div>").addClass("tubeplayer-wrapper")
        this.glasspane = $("<div>").addClass("tubeplayer-glasspane")        
        var self = this
		self.wrapper.resize(function(e) {
			console.log("Resizing! width="+self.wrapper.width()+", height="+self.wrapper.height())
			self.adjustPlayerSize()
		})        
		console.log("Initialized!")
    },
    play: function() {
        this._play();
    },
    _play: function() {
        this.player.tubeplayer("play")
        this.onPlay();
    },
    _pause: function() {
        this.player.tubeplayer("pause")
        this.onPause();
    },
    _stop: function() {
        this.player.tubeplayer("stop")
        this.onStop();
    },
    _kill: function() {
        this.player.tubeplayer("destroy")
        this.player.remove()
        this.player = null
        this.onKill();
    },
    _setVolume: function(vol) {
        this.player.tubeplayer("volume", vol)
    },
    adjustPlayerSize: function() {
    	var self = this    	
    	console.log("Adjusting player size! width="+self.wrapper.width()+", height="+self.wrapper.height())
        self.player.tubeplayer("size", {
			width: self.wrapper.width(), 
			height: self.wrapper.height()
		})
    },
    refresh: function() {
        this.base();
        if(this.player) {
            //this.player.tubeplayer("destroy")
            this.player.remove()
            this.player = null
        }
        this.player = $("<div>").addClass("tubeplayer-container")
        this.element.html(this.wrapper.empty().append(
            this.player
            // this.glasspane
        ))
        var self = this;
        var o = self.options
		self.player.tubeplayer({
			allowFullScreen: false,
			autoPlay: false,
			showControls: 0,
            initialVideo: o.name,
            preferredQuality: o.quality,
            autoPlay: o.autoplay,
            onPlayerUnstarted: function(){},
			onPlay: function(id){}, // after the play method is called
			onPause: function(){}, // after the pause method is called
			onStop: function(){}, // after the player is stopped
			onSeek: function(time){}, // after the video has been seeked to a defined point
			onMute: function(){}, // after the player is muted
			onUnMute: function(){} // after the player is unmuted
		})		
        // console.log(self.player.tubeplayer("player"))
        self._setVolume(o.volume)
    },
    _klass: "tubeplayer-thing thing",
    _type: "tubeplayer-thing",
    _defaults: {
        "name": "ydRAb9cwHnA",
        'quality': "default",
        'autoplay': false,
        'loop': false,
        'volume': 50
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "name": {
			    "type":"string",
                "format": "string",
			    "required":true
    	    },
		    "quality": {
			    "type":"string",
                "format": "string",
			    "required":true
    	    },
            "volume":{
                "type":"integer",
                "required":true // TODO
            },
            "autoplay":{
                "type":"boolean",
                "required":true // TODO
            },
            "loop":{
                "type":"boolean",
                "required":true // TODO
            }
	    }
    }

});

// uses: jquery, common, base

// tohle projde markup a vytvori widgety tam kde jsou na to pripravena data
// widget ma serverovou cast/sablonu a JS na klientovi ktery z toho muze vyrobit
// treba graficky editor nebo embedded SVG

function valueDecode(value) {
    if((/^!/).test(value)) {
        // je to bud base64 nebo to zacina vykricnikem
        value = value.substring(1);
        if(!(/^!/).test(value)) {
            // je to base64
            value = JSON.parse(utf8_decode(base64_decode(value)));
        } else {
            value = html_decode(value);
        }
    } else {
        value = html_decode(value);
    }
    return value;
}

function valueEncode(value) {
    if(jQuery.isPlainObject(value)) {
        return '!' + base64_encode(utf8_encode(JSON.stringify(value)));
    } else {
        var out = html_encode(value);
        if(out.startsWith('!')) out = "!" + out;
    }
    return out;
}

function widgetize(what) {
    what.reverse().each(function() {
        var self = $(this);        
        // find the widget class...
        var csss = self.attr("class").split(" ");
        for(var i=0; i<csss.length; i++) {
            // je to widget?
            if(csss[i].endsWith("-widget")) {
                var widgetClass = csss[i].replace(/-widget$/, "");
                // gather all data-attributes
                var data = self.data();        
                for(var key in data) {
                    var value = data[key];
                    data[key] = valueDecode(data[key]);
                    self.data(key, data[key]);
                }
                // vytvorime widget - zavolame JS/jQuery plugin a predame mu parametry v data
                console.log(data)
                self[widgetClass](data);
                break;
            }
        }
    });
}


var Widget = Base.extend({
    constructor: function(element, options) {
        this.element = element;
        this.options = $.extend({}, options);
        // promenne widgetu...
        this.wid = Widget.getUniqueId();
        this.element.data('wid', this.wid);
        Widget.cache[this.wid] = this;
    },
    init: function() {
        // inicializace ramce pro widget (toho co se nemeni)
    },
    refresh: function() {
        // volat pokazde pokud se zmeni data
    },
    destroy: function() {
        // uvedeni widgetu do puvodniho stavu
    }
},{
    wid: 1,
    getUniqueId: function() {
        return 'widget'+Widget.wid++;
    },
    cache: {}
});







var ThingWidget = Widget.extend({
    init: function() {
        var self = this;
        var def = this.options.def;
        if(def) {
            var thing = Thing.create(def);
            this.element.empty().append(thing.get());
        }
        self.refresh();
    },
    refresh: function() {
    }
});

// widgety...
(function($){

    var defaultOptions = { def: { type: "empty" } };

    var methods = {
        init : function(options) {
            var settings = $.extend({}, defaultOptions, options);
            return this.each(function() {
                var $this = $(this);
                var widget = new ThingWidget($this, settings);
                widget.init();
            });
        }
    };

    $.fn.thing = function(methodOrOptions) {
        if ( methods[methodOrOptions] ) {
            return methods[ methodOrOptions ].apply( this, Array.prototype.slice.call( arguments, 1 ));
        } else if ( typeof methodOrOptions === 'object' || ! methodOrOptions ) {
            // Default to "init"
            return methods.init.apply( this, arguments );
        } else {
            $.error( 'Method ' +  method + ' does not exist on jQuery.thing' );
        }    
    };

})(jQuery);


// TODO rozeznavani 'media' podle pripony

var _audioPlayerIndex = 1;
var makeAudioPlayer = function(parent, media) {
    var id = _audioPlayerIndex++;
    var playerId = 'jquery_cplayer_'+id;
    var containerId = 'cp_container_'+id;
    var html = $.render.circlePlayer({playerId: playerId, containerId: containerId});
    var div = $("<div>").html(html);
    parent.append(div);
    // ensure that player div is at the root of body
    $("#"+playerId).appendTo($("body"));

	var myCirclePlayer = new CirclePlayer("#"+playerId, media, {
		cssSelectorAncestor: "#"+containerId
	});
    return div;
};

var _videoPlayerIndex = 1;
var makeVideoPlayer = function(parent, media) {
    var id = _videoPlayerIndex++;
    var playerId = 'jquery_jplayer_'+id;
    var containerId = 'jp_container_'+id;
    var html = $.render.videoPlayer({playerId: playerId, containerId: containerId});
    var div = $("<div>").html(html).appendTo(parent);
    $("#"+playerId).jPlayer({
        ready: function () {
          $(this).jPlayer("setMedia", media);
        },
        swfPath: "/js",
        supplied: "m4v, ogv",
        cssSelectorAncestor: "#"+containerId
    });    
    return div;
};

// initialization...
$(document).ready(function() {

    // widgetizer...
    widgetize($(".widget"));

});
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: slovensko\js\mykkro-viewerOld.js
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\slovensko\js\mykkro-viewerOld.js
VELIKOST: 207473 B (202.61 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
// configuration file
var DEBUG = false;

var Config = {
};
var __ = function(arg) {
    return LocaleStrings[arg] || arg;
}

/*
	Base.js, version 1.1
	Copyright 2006-2007, Dean Edwards
	License: http://www.opensource.org/licenses/mit-license.php
*/

var Base = function() {
	// dummy
};

Base.extend = function(_instance, _static) { // subclass
	var extend = Base.prototype.extend;
	
	// build the prototype
	Base._prototyping = true;
	var proto = new this;
	extend.call(proto, _instance);
	delete Base._prototyping;
	
	// create the wrapper for the constructor function
	//var constructor = proto.constructor.valueOf(); //-dean
	var constructor = proto.constructor;
	var klass = proto.constructor = function() {
		if (!Base._prototyping) {
			if (this._constructing || this.constructor == klass) { // instantiation
				this._constructing = true;
				constructor.apply(this, arguments);
				delete this._constructing;
			} else if (arguments[0] != null) { // casting
				return (arguments[0].extend || extend).call(arguments[0], proto);
			}
		}
	};
	
	// build the class interface
	klass.ancestor = this;
	klass.extend = this.extend;
	klass.forEach = this.forEach;
	klass.implement = this.implement;
	klass.prototype = proto;
	klass.toString = this.toString;
	klass.valueOf = function(type) {
		//return (type == "object") ? klass : constructor; //-dean
		return (type == "object") ? klass : constructor.valueOf();
	};
	extend.call(klass, _static);
	// class initialisation
	if (typeof klass.init == "function") klass.init();
	return klass;
};

Base.prototype = {	
	extend: function(source, value) {
		if (arguments.length > 1) { // extending with a name/value pair
			var ancestor = this[source];
			if (ancestor && (typeof value == "function") && // overriding a method?
				// the valueOf() comparison is to avoid circular references
				(!ancestor.valueOf || ancestor.valueOf() != value.valueOf()) &&
				/\bbase\b/.test(value)) {
				// get the underlying method
				var method = value.valueOf();
				// override
				value = function() {
					var previous = this.base || Base.prototype.base;
					this.base = ancestor;
					var returnValue = method.apply(this, arguments);
					this.base = previous;
					return returnValue;
				};
				// point to the underlying method
				value.valueOf = function(type) {
					return (type == "object") ? value : method;
				};
				value.toString = Base.toString;
			}
			this[source] = value;
		} else if (source) { // extending with an object literal
			var extend = Base.prototype.extend;
			// if this object has a customised extend method then use it
			if (!Base._prototyping && typeof this != "function") {
				extend = this.extend || extend;
			}
			var proto = {toSource: null};
			// do the "toString" and other methods manually
			var hidden = ["constructor", "toString", "valueOf"];
			// if we are prototyping then include the constructor
			var i = Base._prototyping ? 0 : 1;
			while (key = hidden[i++]) {
				if (source[key] != proto[key]) {
					extend.call(this, key, source[key]);

				}
			}
			// copy each of the source object's properties to this object
			for (var key in source) {
				if (!proto[key]) extend.call(this, key, source[key]);
			}
		}
		return this;
	},

	base: function() {
		// call this method from any other method to invoke that method's ancestor
	}
};

// initialise
Base = Base.extend({
	constructor: function() {
		this.extend(arguments[0]);
	}
}, {
	ancestor: Object,
	version: "1.1",
	
	forEach: function(object, block, context) {
		for (var key in object) {
			if (this.prototype[key] === undefined) {
				block.call(context, object[key], key, object);
			}
		}
	},
		
	implement: function() {
		for (var i = 0; i < arguments.length; i++) {
			if (typeof arguments[i] == "function") {
				// if it's a function, call it
				arguments[i](this.prototype);
			} else {
				// add the interface using the extend method
				this.prototype.extend(arguments[i]);
			}
		}
		return this;
	},
	
	toString: function() {
		return String(this.valueOf());
	}
});

// requires: jquery

var log = function(what) {
    $("body").prepend($("<pre>").text(what));
}

var ajaxify = function(sel) {
    $(sel || ".ajaxify").each(function() {
        $(this).load($(this).data("target"));
    })
}

// From http://www.terrainformatica.com/?p=13
var delegate = function( that, thatMethod )
{
    if(arguments.length > 2)
    {
        var _params = [];
        for(var n = 2; n < arguments.length; ++n) _params.push(arguments[n]);
        return function() { return thatMethod.apply(that,_params); };
    }
    else
      return function() { return thatMethod.call(that); };
}

var delegate_cp = function( that, thatMethod ) {
    return function() { return thatMethod.apply(that,arguments); }
};

function utf8_encode( s ) {
  return unescape( encodeURIComponent( s ) );
}

function utf8_decode( s ) {
  return decodeURIComponent( escape( s ) );
}

function html_encode( input ) {
    return String(input)
        .replace(/&/g, '&amp;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '\'')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;');
}

function html_decode( input ) {
    return String(input)
        .replace(/&amp;/g, '&')
        .replace(/&quot;/g, '\"')
        .replace(/'/g, '\'')
        .replace(/&lt;/g, '<')
        .replace(/&gt;/g, '>');
}

function base64_decode (data) {
  // http://kevin.vanzonneveld.net
  // +   original by: Tyler Akins (http://rumkin.com)
  // +   improved by: Thunder.m
  // +      input by: Aman Gupta
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +   bugfixed by: Onno Marsman
  // +   bugfixed by: Pellentesque Malesuada
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +      input by: Brett Zamir (http://brett-zamir.me)
  // +   bugfixed by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // *     example 1: base64_decode('S2V2aW4gdmFuIFpvbm5ldmVsZA==');
  // *     returns 1: 'Kevin van Zonneveld'
  // mozilla has this native
  // - but breaks in 2.0.0.12!
  //if (typeof this.window['atob'] == 'function') {
  //    return atob(data);
  //}
  var b64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
  var o1, o2, o3, h1, h2, h3, h4, bits, i = 0,
    ac = 0,
    dec = "",
    tmp_arr = [];

  if (!data) {
    return data;
  }

  data += '';

  do { // unpack four hexets into three octets using index points in b64
    h1 = b64.indexOf(data.charAt(i++));
    h2 = b64.indexOf(data.charAt(i++));
    h3 = b64.indexOf(data.charAt(i++));
    h4 = b64.indexOf(data.charAt(i++));

    bits = h1 << 18 | h2 << 12 | h3 << 6 | h4;

    o1 = bits >> 16 & 0xff;
    o2 = bits >> 8 & 0xff;
    o3 = bits & 0xff;

    if (h3 == 64) {
      tmp_arr[ac++] = String.fromCharCode(o1);
    } else if (h4 == 64) {
      tmp_arr[ac++] = String.fromCharCode(o1, o2);
    } else {
      tmp_arr[ac++] = String.fromCharCode(o1, o2, o3);
    }
  } while (i < data.length);

  dec = tmp_arr.join('');

  return dec;
}



function base64_encode (data) {
  // http://kevin.vanzonneveld.net
  // +   original by: Tyler Akins (http://rumkin.com)
  // +   improved by: Bayron Guevara
  // +   improved by: Thunder.m
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +   bugfixed by: Pellentesque Malesuada
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +   improved by: Rafał Kukawski (http://kukawski.pl)
  // *     example 1: base64_encode('Kevin van Zonneveld');
  // *     returns 1: 'S2V2aW4gdmFuIFpvbm5ldmVsZA=='
  // mozilla has this native
  // - but breaks in 2.0.0.12!
  //if (typeof this.window['btoa'] == 'function') {
  //    return btoa(data);
  //}
  var b64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
  var o1, o2, o3, h1, h2, h3, h4, bits, i = 0,
    ac = 0,
    enc = "",
    tmp_arr = [];

  if (!data) {
    return data;
  }

  do { // pack three octets into four hexets
    o1 = data.charCodeAt(i++);
    o2 = data.charCodeAt(i++);
    o3 = data.charCodeAt(i++);

    bits = o1 << 16 | o2 << 8 | o3;

    h1 = bits >> 18 & 0x3f;
    h2 = bits >> 12 & 0x3f;
    h3 = bits >> 6 & 0x3f;
    h4 = bits & 0x3f;

    // use hexets to index into b64, and append result to encoded string
    tmp_arr[ac++] = b64.charAt(h1) + b64.charAt(h2) + b64.charAt(h3) + b64.charAt(h4);
  } while (i < data.length);

  enc = tmp_arr.join('');

  var r = data.length % 3;

  return (r ? enc.slice(0, r - 3) : enc) + '==='.slice(r || 3);

}

/**
 * Returns the first data element of an object, regardless on its key name.
 */
var extractRoot = function(data) {
  for(var key in data) {
    return data[key];
  }
}


Array.prototype.toObject = function() {
    var out = {};
    for(var i=0; i<this.length; i++) {
        out[i] = this[i];
    }
    return out;
}

// Array.copy() - Copy an array
if( typeof Array.prototype.copy==='undefined' ) {
 Array.prototype.copy = function() {
  var a = [], i = this.length;
  while( i-- ) {
   a[i] = typeof this[i].copy!=='undefined' ? this[i].copy() : this[i];
  }
  return a;
 };
}

// Array.insert( index, value ) - Insert value at index, without overwriting existing keys
Array.prototype.insert = function( i, v ) {
 if( i>=0 ) {
  var a = this.slice(), b = a.splice( i );
  a[i] = v;
  return a.concat( b );
 }
};

// Array Remove - By John Resig (MIT Licensed)
Array.prototype.remove = function(from, to) {
  var rest = this.slice((to || from) + 1 || this.length);
  this.length = from < 0 ? this.length + from : from;
  return this.push.apply(this, rest);
};

// Array.random( range ) - Return a random element, optionally up to or from range
Array.prototype.random = function( r ) {
 var i = 0, l = this.length;
 if( !r ) { r = this.length; }
 else if( r > 0 ) { r = r % l; }
 else { i = r; r = l + r % l; }
 return this[ Math.floor( r * Math.random() - i ) ];
};

// Array.shuffle( deep ) - Randomly interchange elements
Array.prototype.shuffle = function( b ) {
 var i = this.length, j, t;
 while( i ) {
  j = Math.floor( ( i-- ) * Math.random() );
  t = b && typeof this[i].shuffle!=='undefined' ? this[i].shuffle() : this[i];
  this[i] = this[j];
  this[j] = t;
 }
 return this;
};

// Array.unique( strict ) - Remove duplicate values
Array.prototype.unique = function( b ) {
 var a = [], i, l = this.length;
 for( i=0; i<l; i++ ) {
  if( a.indexOf( this[i], 0, b ) < 0 ) { a.push( this[i] ); }
 }
 return a;
};

// Array.walk() - Change each value according to a callback function
Array.prototype.walk = function( f ) {
 var a = [], i = this.length;
 while(i--) { a.push( f( this[i] ) ); }
 return a.reverse();
};

String.prototype.capitalize = function() {
    return this.charAt(0).toUpperCase() + this.slice(1);
}

//String.prototype.trim=function(){return this.replace(/^\s\s*/, '').replace(/\s\s*$/, '');};

// deprecated: use trimLeft, trimRight
/*
String.prototype.ltrim=function(){return this.replace(/^\s+/,'');}

String.prototype.rtrim=function(){return this.replace(/\s+$/,'');}
*/
String.prototype.fulltrim=function(){return this.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,'').replace(/\s+/g,' ');}

String.prototype.camelCase = function() { 
    var s = this.trim();
    return ( /\S[A-Z]/.test( s ) ) ?
        s.replace( /(.)([A-Z])/g, function(t,a,b) { return a + ' ' + b.toLowerCase(); } ) :
        s.replace( /( )([a-z])/g, function(t,a,b) { return b.toUpperCase(); } );
}

// code generation utilities

var CodeGenUtils = {
    getSetterName: function(name) {
        return "set" + name.capitalize();
    },
    getGetterName: function(name, isBoolean) {
        return (isBoolean ? "is" : "get") + name.capitalize();
    }
}



String.prototype.endsWith = function(suffix) {
    return this.indexOf(suffix, this.length - suffix.length) !== -1;
};

String.prototype.startsWith = function (str){
    return this.slice(0, str.length) == str;
};


jQuery.fn.swap = function(b) {
    b = jQuery(b)[0];
    var a = this[0];

    var t = a.parentNode.insertBefore(document.createTextNode(''), a);
    b.parentNode.insertBefore(a, b);
    t.parentNode.insertBefore(b, t);
    t.parentNode.removeChild(t);

    return this;
};


// smallest jQuery plugin :)
jQuery.fn.reverse = [].reverse;


$.extend({
  jYoutube: function( url, size ){
    if(url === null){ return ""; }

    size = (size === null) ? "big" : size;
    var vid;
    var results;

    results = url.match("[\\?&amp;]v=([^&amp;#]*)");

    vid = ( results === null ) ? url : results[1];

    if(size == "small"){
      return "http://img.youtube.com/vi/"+vid+"/2.jpg";
    }else {
      return "http://img.youtube.com/vi/"+vid+"/0.jpg";
    }
  }
});

var makeSvgScalable = function(svg) {
    var el = svg[0];
    var ww = el.getAttribute("width");
    var hh = el.getAttribute("height");
    el.setAttribute('width', '100%');
    el.setAttribute('height', '100%');
    el.setAttribute('viewBox', '0 0 '+ww+' '+hh);
    el.setAttribute('preserveAspectRatio', 'xMidyMid meet');
};

var Common = {
    postJsonData: function(url, data, success, error) {
        $.ajax({
            type: "post",       // Request method: post, get
            url: url,
            data: JSON.stringify(data), 
            dataType: "json",    // Expected response type
            contentType: "application/json",
            cache: false,
            success: success || $.noop,
            error: error || $.noop
        });
    },
    isValidUrl: function(str) {
      var pattern = new RegExp('^(https?:\\/\\/)?'+ // protocol
      '((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|'+ // domain name
      '((\\d{1,3}\\.){3}\\d{1,3}))'+ // OR ip (v4) address
      '(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*'+ // port and path
      '(\\?[;&a-z\\d%_.~+=-]*)?'+ // query string
      '(\\#[-a-z\\d_]*)?$','i'); // fragment locator
      if(!pattern.test(str)) {
        return false;
      } else {
        return true;
      }
    }
};

var JQ = {
    button: function(caption, click, parent) {
        var btn = $("<button>").text(caption);
        if(click) btn.click(click);
        if(parent) btn.appendTo(parent);
        return btn;
    },
    linkButton: function(content, click, parent) {
        var btn = JQ.put($("<a>"), content);
        if(click) btn.click(click);
        if(parent) btn.appendTo(parent);
        return btn;
    },
    link: function(content, href, tooltip, parent) {
        var link = JQ.put($("<a>"), content).attr({"title":tooltip, "href":href});
        if(parent) link.appendTo(parent);
        return link;
    },
    ul: function(parent) {
        var ul = $("<ul>");
        if(parent) ul.appendTo(parent);
        return ul;
    },
    li: function(klass, parent) {
        var li = $("<li>").addClass(klass);
        if(parent) li.appendTo(parent);
        return li;
    },
    checkbox: function(name, checked, parent) {
        var input = $("<input>").attr({'type':'checkbox', 'name':name}).prop("checked", checked);
        if(parent) input.appendTo(parent);
        return input;
    },
    textfield: function(name, value, parent) {
        var input = $("<input>").attr({'type':'text', 'name':name, "value":value});
        if(parent) input.appendTo(parent);
        return input;
    },
    span: function(content, klass, parent) {
        var span = JQ.put("span", content).addClass(klass);
        if(parent) span.appendTo(parent);
        return span;
    },
    div: function(content, klass, parent) {
        var div = JQ.put("div", content).addClass(klass);
        if(parent) div.appendTo(parent);
        return div;
    },
    p: function(content, klass, parent) {
        var p = JQ.put("p", content).addClass(klass);
        if(parent) p.appendTo(parent);
        return p;
    },
    h1: function(content, klass, parent) {
        return JQ.hN(1, content, klass, parent);
    },
    h2: function(content, klass, parent) {
        return JQ.hN(2, content, klass, parent);
    },
    h3: function(content, klass, parent) {
        return JQ.hN(3, content, klass, parent);
    },
    h4: function(content, klass, parent) {
        return JQ.hN(4, content, klass, parent);
    },
    h5: function(content, klass, parent) {
        return JQ.hN(5, content, klass, parent);
    },
    h6: function(content, klass, parent) {
        return JQ.hN(6, content, klass, parent);
    },
    hN: function(level, content, klass, parent) {
        var heading = JQ.put("h"+level, content).addClass(klass);
        if(parent) heading.appendTo(parent);
        return heading;
    },
    label: function(content, klass, parent) {
        var label = JQ.put("label", content).addClass(klass);
        if(parent) label.appendTo(parent);
        return label;
    },
    clear: function(parent) {
        var clr = $("<div>").addClass("clear");
        if(parent) clr.appendTo(parent);
        return clr;
    },
    show: function(elem, enabled) {
        if(enabled) elem.show(); else elem.hide();
    },
    form: function(klass, parent) {
        var div = $("<form>").addClass(klass);
        if(parent) div.appendTo(parent);
        return div;
    },
    fieldset: function(klass, parent) {
        var div = $("<fieldset>").addClass(klass);
        if(parent) div.appendTo(parent);
        return div;
    },
    toggleLink: function(captionOn, captionOff, target, parent) {
        var visible = target.is(":visible");
        var btn = JQ.put("a", visible ? captionOn : captionOff).click(function() {
            var visible = target.is(":visible");
            if(visible) {
                target.hide();
                btn.text(captionOff);
            } else {
                target.show();
                btn.text(captionOn);
            }
        });
        if(parent) btn.appendTo(parent);
        return btn;
    },
    linkExt: function(caption, href, tooltip, parent) {
        return JQ.link(caption, href, tooltip, parent).attr("target","_blank");
    },
    put: function(where, what) {
        if(typeof(where) == "string") {
            where = $("<"+where+">");
        }
        if(what) {
            if(typeof(what) == "string") {
                where.text(what);
            } else {
                where.append(what);
            }
        }
        return where;
    }
};

// kazda 'vec' ma options (s defaultni hodnotou) a slots
var Thing = Base.extend({
    constructor: function(options, slots) {
        this.options = $.extend({}, this.defaults(), options);        
        this.tid = Thing.tid++;
        Thing.things[this.tid] = this;
        this.element = $("<div>").addClass(this.getClass()).attr("data-tid", this.tid);
        if(DEBUG) {
            this.element.css("background-color", '#'+Math.floor(Math.random()*16777215).toString(16));
        }
        this.slots = {};
        this.parent = null;
        this.name = null;
        // initializing...
	    this.slotChanged($.noop);
        this.init();
        this.setSlots(slots);
        // display update
        this.refresh();
    },
    copy: function() {
        return Thing.create(this.serialize());
    },
    remove: function() {
        this.replaceWith(Thing.empty());        
    },
    replaceWith: function(thing) {
        if(this.parent) {
            this.parent.setSlot(this.name, thing);
            this.parent = null;
            this.name = null;           
            Thing.things[this.tid] = null;
        }
    },
    // obali this dekoratorem
    decorate: function(deco) {
        if(this.parent) {
            var par = this.parent;
            var slot = this.name;
            deco.setSlot('content', this);
            par.setSlot(slot, deco);
            return deco;
        }
    },
    serialize: function() {
        var slots = {};
        var numslots = 0;
        for(var key in this.slots) {
            slots[key] = this.slots[key].serialize();
            numslots++;
        }
        var obj = {
            type: this.getType(),
            options: this.options
        };
        if(numslots) obj.slots = slots
        return obj;
    },
    getType: function() {
        return this._type;
    },
    getClass: function() {
        return this._klass.split(" ").map(function(a){return "mykkro-"+a;}).join(" ");
    },
    init: function() {
        // create structure and variables
    },
    refresh: function() {
        // options changed...
        this.element.attr('class','');
        this.element.addClass(this.getClass());
        this.element.addClass(this.options.css);
    },
    get: function() {
        return this.element;
    },
    defaults: function() {
        return this._defaults;
    },
    // muzeme se dostat takhle i ke slotu ve slotu
    content: function(key, value) {
        var ndx = key.indexOf(".");
        if(ndx>=0) {
            // odkazujeme se na slot ve slotu
            var newKey = key.substring(0,ndx);
            var rest = key.substring(ndx+1);
            return this.getSlot(newKey).content(rest, value);
        }
        if(this.hasSlot(key)) {
            if(value) {
                // setter
                this.setSlot(key, value);
                return this;
            } else {
                // getter
                return this.getSlot(key);
            }
        } else {
            // unknown slot!
            return null;
        }
    },
    hasSlot: function(key) {
        return !!this.slots[key];
    },
    getSlot: function(key) {
        return this.slots[key];
    },
    setSlot: function(key, thing) {
        this.slots[key] = thing;
        thing._setParent(this, key);
        // DOM manipulation - to be overridden
	    this.slotChanged(key);
        return this;
    },
    removeSlot: function(key) {
        delete this.slots[key]
    },
    clearSlots: function() {
        for(var key in this.slots) {
            this.setSlot(key, Thing.empty());
        }
    },
    setOptions: function(opts) {
        this.options = $.extend(this.options, opts);
        this.refresh();
	    this.slotChanged('options');
    },
    setSlots: function(slots) {
        if(slots) {
            // pokud je parametr pole, udelat z nej objekt
            if($.isArray(slots)) slots = slots.toObject();
            for(var key in slots) {
                this.setSlot(key, slots[key]);
            }
        }
    },
    _setParent: function(parent, key) {
        this.parent = parent;
        this.name = key;
    },
    isEmpty: function() {
        return this.getType() == "empty";
    },
    slotChanged: function(arg) {
        if(typeof arg == "function") {
            this.onslotchanged = arg;
        } else {
            return this.onslotchanged(this, arg);
        }
    },    
    // bez parametru vraci rekurzivne vsechny sloty
    findSlots: function(predicate, out) {
        if(!predicate) predicate = function() { return true; };
        if(!out) out = [];
        if(predicate(this)) out.push(this);
        for(var key in this.slots) {
            this.slots[key].findSlots(predicate, out);
        }
        return out;
    },
    findEmptySlots: function(out) {
        return this.findSlots(function(thing) { return thing.isEmpty(); }, out)
    },
    findSlotsByType: function(type, out) {
        return this.findSlots(function(thing) { return thing.getType() == type; }, out)
    },
    getTree: function() {
        var node = { type: this.getType(), children: {} };
        for(var key in this.slots) {
            node.children[key] = this.slots[key].getTree();
        }
        return node;
    },
    _toggleTreeView: function(node) {
        node.children(".slots").toggleClass('collapsed');
    },
    // TODO mohlo by si to pamatovat expands/collapse mezi updaty
    /* example decorator:
        decorator = function(thing, node) {
            $("<div>").addClass("toolz").insertAfter(node.find(">h2"));
        };
    */
    getTreeView: function(decorator) {
        var self = this;
        var node = $("<div>").addClass('node').attr('data-type', this.getType()).attr('data-tid', this.tid);
        var hdr = $("<h2>").text(this.getType()).appendTo(node);
        var slots = $("<div>").addClass('slots').appendTo(node);
        hdr.click(function() {
            self._toggleTreeView(node);
        });
        for(var key in this.slots) {
            (function(){
                var subtree = self.slots[key].getTreeView(decorator);
                var subheading = $("<h3>").text(key).click(function() {
                    $(this).toggleClass('collapsed');
                    self._toggleTreeView(subtree);
                });
                slots.append(subheading);
                slots.append(subtree);
            })();
        }
        node.append($("<div>").addClass('clear'));
        if(decorator) decorator(this, node);
        return node;
    },
    _type: "thing",
    _defaults: {
        "css": ""
    },
    _klass: "thing",
    _schema: {
       "type":"object",
       "properties":{
       },
       "additionalProperties":true
    }

},{    
    tid: 0,
    things: {},
    create: function(def, opts) {
        if(!def) {
            return Thing.empty();
        }
        // udelat deserializaci
        // { type, options, slots }
        var klassName = def.type.replace(/-([a-z])/g, function (g) { return g[1].toUpperCase() });
        klassName = klassName.capitalize();
        var klazz = window[klassName];
        var slots = def.slots;
        var oid = def.id;
        if($.isArray(slots)) slots = slots.toObject();
        for(var key in slots) {
            slots[key] = Thing.create(slots[key]);
        }
        var thing = new klazz($.extend(def.options, opts), slots);
        thing.oid = oid
        return thing
    },
    empty: function(options) {
        return new Empty(options);
    }
});



var Empty = Thing.extend({
    refresh: function() {
        this.element.empty();
        /*
        if(this.parent) this.element.html(
            $("<div>").text(this.parent.getType()+"#"+this.name)
        );
        */
    },
    _setParent: function(parent, key) {
        this.base(parent, key);
        this.refresh();
    },
    _klass: "empty thing",
    _type: "empty"
});


var Imager = Thing.extend({
    refresh: function() {
        var img = $("<div>")
            .css("background-image",'url("'+this.options.url+'")')
            .css('background-position',this.options['position'])
            .css('background-repeat',this.options['repeat'])
            .css('background-color',this.options['color'])
            .css('background-size',this.options['size'])
            .css('-moz-background-size',this.options['size'])
            .css('-webkit-background-size',this.options['size']);
        this.element.html(img);
    },
    _klass: "imager thing",
    _type: "imager",
    _defaults: {
        "url": "images/demo/australie1.jpg",
        "repeat": "no-repeat",
        "position": "center center",
        "color": "white",
        "size": "cover" 
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "color": {
			    "type":"string",
			    "id": "color",
			    "required":true,
                "format": "color"
		    },
		    "position": {
			    "type":"string",
			    "id": "position",
			    "required":true
		    },
		    "repeat": {
			    "type":"string",
			    "id": "repeat",
			    "required":true
		    },
		    "size": {
			    "type":"string",
			    "id": "size",
                "enum":["cover","contain"],
			    "required":true
		    },
		    "url": {
			    "type":"string",
			    "id": "url",
                "format": "my-image-uri",
			    "required":true
		    }
	    }
    }

});


var RaphaelThing = Thing.extend({
    refresh: function() {
        var o = this.options;
        var div = $("<div>");
        this.element.html(div);
        var paper = Raphael(div.get(0), "100%","100%");
        paper.setViewBox(0, 0, o.width, o.height, true);
        this.canvas = paper;
    },
    _klass: "raphael-thing thing",
    _type: "raphael-thing",
    _defaults: {
        width: 100,
        height: 100
    },
    _schema: {
       "type":"object",
       "description":"RaphaelThing properties",
       "properties":{
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }

});


var CanvasThing = Thing.extend({
    init: function() {
        var o = this.options;
        var self = this;
        this.canvas = $("<canvas>").appendTo(this.element).attr({width:o.width, height:o.height});
        // pouziva CSS transformaci, rastr je porad stejne velky
        if(o.autoscale) {
            this.element.resize(function() {
                var el = $(this);
                var o = self.options;
                var zoom = Math.min(el.width()/o.width, el.height()/o.height);
                el.css({
                    "-moz-transform": "scale("+zoom+")", 
                    "-webkit-transform": "scale("+zoom+")", 
                    "-moz-transform-origin":"0px 0px", 
                    "-webkit-transform-origin":"0px 0px"
                });
            });
        }
        // zvetsuje fyzicky pocet pixelu rastru
        if(o.autoresize) {
            this.element.resize(function() {
                var el = $(this);
                var ww = el.width();
                var hh = el.height();
                if(o.keepaspectratio) { var asp = o.width/o.height; if(ww/hh > asp) ww = hh*asp; else hh = ww/asp; }
                self.canvas.attr({
                    "width": ww, 
                    "height": hh
                });
                self.refresh();
            });
            var el = this.element;
            var ww = el.width();
            var hh = el.height();
            if(o.keepaspectratio) { var asp = o.width/o.height; if(ww/hh > asp) ww = hh*asp; else hh = ww/asp; }
            this.canvas.attr({
                "width": ww, 
                "height": hh
            });            
        }
    },
    refresh: function() {
        var context = this.canvas.get(0).getContext('2d');
        if (context) {
            this.draw(context, this.canvas.width() || this.options.width, this.canvas.height() || this.options.height);
        }
    },
    draw: function(g, w, h) {
        /* by default, draws only rectangle... */
        g.strokeRect(0,  0, w, h);
    },
    _klass: "canvas-thing thing",
    _type: "canvas-thing",
    _defaults: {
        width: 100,
        height: 100,
        autoscale: false,
        autoresize: true,
        keepaspectratio: true
    },
    _schema: {
       "type":"object",
       "description":"CanvasThing properties",
       "properties":{
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          },
          "autoscale":{
             "type":"boolean",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


// http://www.nihilogic.dk/labs/javascript_canvas_fractals/
var Fractal = CanvasThing.extend({
    draw: function(ctx, w, h) {
        var smoothColors = this.options.smoothcolors;
        var vx = this.options.vx;
        var vy = this.options.vy;
        var zoom = this.options.zoom;

        var imageData = !!ctx.getImageData;
        var startit = 30;
        var xmin, xmax, ymin, ymax, dx, dy;
        var er = 2;

        var colors = {
	        red : [[0,0,1],[0,1,0],[0,1,0]],
	        blue : [[0,0,0],[0,1,0],[0,1,1]],
	        green : [[0,1,0],[0,0,1],[0,1,0]],
	        orange : [[1,1,1],[0,1,0],[0,0,0]],
	        magenta : [[0,0,1],[0,0.1,0.5],[0,0,1]],
	        yellow : [[0.2,0.2,1],[0.2,0.2,1],[0,0,0.2]],

        };

        var log2 = 1 / Math.log(2.0);
        var sin = Math.sin;
        var cos = Math.cos;
        var exp = Math.exp;
        var phi = 1.6180339887;
        function cosh(a) {
            return (exp(a) + exp(-a))/2;
        }
        function sinh(a) {
            return (exp(a) - exp(-a))/2;
        }
        function csin(x,y) {
	        return [sin(x) * cosh(y), cos(x) * sinh(y)];
        }
        function ccos(x,y) {
	        return [cos(x)*cosh(y), -sin(x)*sinh(y)];
        }
        function cexp(x,y) {
	        return [exp(x)*cos(y), exp(x)*sin(y)];
        }
        function cmul(c1,c2) {
	        return [
		        c1[0]*c2[0]-c1[1]*c2[1],
		        c1[0]*c2[1]+c1[1]*c2[0]
	        ];
        }

        var fractals = {

	        mandelbrot : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        var lastxx, lastyy;
		        do {
			        y = (x+x)*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2) {

				        y = (x+x)*y + y0; // iterate once for more for smoother colors
				        x = xx - yy + x0;
				        yy = y*y;
				        xx = x*x;

				        break;
			        }
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliacubed : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {

			        tx = x;
			        ty = y;

			        tx2 = x*x-y*y;
			        ty2 = 2*x*y;

			        x = tx2*tx-ty2*ty + 1-phi;
			        y = tx2*ty+ty2*tx + 0.3;

			        xx = x*x;
			        yy = y*y;

			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        multibrot3 : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var tx, ty, tx2, ty2;
		        var xx = x*x, yy = y*y;
		        do {
			        tx = x;
			        ty = y;
			        tx2 = xx-yy;
			        ty2 = 2*x*y;
			        x = tx2*tx-ty2*ty + x0;
			        y = tx2*ty+ty2*tx + y0;
			        xx = x*x;
			        yy = y*y;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        multibrot4 : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = 2*x*y;
			        x = xx - yy;
			        yy = y*y;
			        xx = x*x;
			        y = 2*x*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        multibrot8 : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = 2*x*y;
			        x = xx - yy;
			        yy = y*y;
			        xx = x*x;
			        y = 2*x*y;
			        x = xx - yy;
			        yy = y*y;
			        xx = x*x;
			        y = 2*x*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        burningship : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = 2*Math.abs(x*y) - y0;
			        x = xx - yy - x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        tricorn : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = -y;

			        y = (x+x)*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        julia_base : function(x, y, it, er2, cr, ci) {
		        var xx = x*x, yy = y*y;
		        do {
			        y = (x+x)*y + ci;
			        x = xx - yy + cr;
			        yy = y*y;
			        xx = x*x;

			        if (xx+yy > er2) {
				        y = (x+x)*y + ci;
				        x = xx - yy + cr;
				        yy = y*y;
				        xx = x*x;

				        break;
			        }
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        julia1 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, phi - 2, phi - 1);
	        },

	        julia2 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 1-phi, 0);
	        },

	        julia3 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 0.285, 0);
	        },

	        julia4 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 0.285, 0.01);
	        },

	        julia5 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.835, -0.2321);
	        },

	        julia6 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.7, -0.3);
	        },

	        julia7 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 0, 1);
	        },

	        julia8 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.391, -0.587);
	        },

	        julia9 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.123, 0.745);
	        },

	        julia10 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.75, 0);
	        },

	        julia11 : function(x, y, it, er2) {
		        var zr, zi;
		        var cr = 0.6;
		        var ci = 1.1;
		        var xx = x*x, yy = y*y;
		        do {
			        zr = x - (x?(x<0?-1:1):0);
			        zi = y;
			        x = cr*zr-ci*zi;
			        y = cr*zi+ci*zr;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliasine_base : function(x, y, it, er2, cr, ci) {
		        var xx = x*x, yy = y*y;
		        var z, expy, expmy;
		        var c = [cr, ci];
		        do {
			        //z = csin(x,y);
			        expy = exp(y);
			        expmy = exp(-y);
			        z = [sin(x) * (expy + expmy)/2, cos(x) * (expy - expmy)/2];

			        x = c[0]*z[0]-c[1]*z[1];
			        y = c[0]*z[1]+c[1]*z[0];

			        yy = y*y, xx = x*x;
			        if (xx+yy > 500)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliasine : function(x, y, it, er2) {
		        return fractals["juliasine_base"](x, y, it, er2, 1, 0.1);
	        },

	        juliasine2 : function(x, y, it, er2) {
		        return fractals["juliasine_base"](x, y, it, er2, 1, 0.3);
	        },

	        juliacosine_base : function(x, y, it, er2, cr, ci) {
		        var xx = x*x, yy = y*y;
		        var z, expy, expmy;
		        var c = [cr, ci];
		        do {
			        //z = ccos(x,y);
			        expy = exp(y);
			        expmy = exp(-y);
			        z = [cos(x) * (expy + expmy)/2, -sin(x) * (expy - expmy)/2];

			        x = c[0]*z[0]-c[1]*z[1];
			        y = c[0]*z[1]+c[1]*z[0];

			        yy = y*y, xx = x*x;
			        if (xx+yy > 500)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliacosine : function(x, y, it, er2) {
		        return fractals["juliacosine_base"](x, y, it, er2, 1, 0.6);
	        },

	        juliacosine2 : function(x, y, it, er2) {
		        return fractals["juliacosine_base"](x, y, it, er2, Math.PI/2 * 1.5, Math.PI/2 * 0.05);
	        },

	        juliacosine3 : function(x, y, it, er2) {
		        var xx = x*x, yy = y*y;
		        var z, expy, expmy;
		        var c = [1, 0.1];
		        do {
			        //z = ccos(x,y);
			        expy = exp(y);
			        expmy = exp(-y);
			        z = [cos(x) * (expy + expmy)/2, -sin(x) * (expy - expmy)/2];

			        x = c[0]*z[0]-c[1]*z[1];
			        y = c[0]*z[1]+c[1]*z[0];

			        tx = x;
			        x = -y;
			        y = tx;

			        yy = y*y, xx = x*x;
			        if (xx+yy > 500)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

        };

        // from http://www.nihilogic.dk/labs/javascript_canvas_fractals/
        function render(fncFrac, colWeights) {
	        var time = new Date().getTime();

	        ctx.fillStyle = "#000000";
	        ctx.fillRect(0,0,w,h);

	        if (imageData) {
		        var data = ctx.getImageData(0,0,w,h);
		        var pixels = data.data;
	        }

	        var mi = Math.max(startit, Math.round(Math.max(Math.log(zoom),1) * startit));
	        var itfac = 1/mi*startit

	        xmin = vx - 2/zoom;
	        xmax = vx + 2/zoom;
	        ymin = vy - 2/zoom;
	        ymax = vy + 2/zoom;

	        dx = xmax-xmin;
	        dy = ymax-ymin;

	        var px, py, it;

	        var er2 = er*er;

	        var c1, c2, c3, m;
	        var col1, col2, col3;
	        var cw0 = colWeights[0], cw1 = colWeights[1], cw2 = colWeights[2];

	        var i = (w*h)-1;
	        do {
		        var offset = i*4;

		        px = (i%w);
		        py = h-((i/w)|0);

		        var res = fncFrac(
			        xmin + px/w * dx, 
			        ymin + py/h * dy, 
			        mi, er2
		        )

		        it = mi - res.it;

		        var mag = smoothColors ? 
				        (it * itfac) - (Math.log(Math.log(res.xx+res.yy))) * log2
				        : it * itfac;

		        //if (color == "bw") {
			    //    c1 = c2 = c3 = 
				//        (res.it==mi) ? 255 : 255 - mag/startit * 255;
		        //} else {
			        if (res.it == 0)
				        continue;

			        if (mag < startit/3) {
				        m = (mag*3);
				        col1 = m * 4;
				        col2 = m * 4;
				        col3 = m * 10;
			        } else if (mag < startit/1.5) {
				        m = (mag-startit/3)*3;
				        col1 = 80 + m * 8;
				        col2 = 80 + m * 8;
				        col3 = 200 + m * 2.5;
			        } else {
				        m = (mag-2*startit/3)*3
				        col1 = 220 + m * 1.5;
				        col2 = 220 + m * 1.5;
				        col3 = 255;
			        }

			        c1 = col1*cw0[0] + col2*cw0[1] + col3*cw0[2];
			        c2 = col1*cw1[0] + col2*cw1[1] + col3*cw1[2];
			        c3 = col1*cw2[0] + col2*cw2[1] + col3*cw2[2];
		        //}

		        c1 = c1 < 0 ? 0 : c1;
		        c2 = c2 < 0 ? 0 : c2;
		        c3 = c3 < 0 ? 0 : c3;

		        c1 = c1 > 255 ? 255 : c1;
		        c2 = c2 > 255 ? 255 : c2;
		        c3 = c3 > 255 ? 255 : c3;

		        if (!imageData) {
			        ctx.fillStyle = "rgb(" + (c1|0) + "," + (c2|0) + "," + (c3|0) + ")";
			        ctx.fillRect((px|0), h-((py|0)), 1, 1);
		        } else {
			        pixels[offset] = c1;
			        pixels[offset+1] = c2;
			        pixels[offset+2] = c3;
		        }

	        } while(--i);

	        if (imageData) {
		        ctx.putImageData(data,0,0);
		        ctx.fillRect(0,0,0,0);
	        }
        };

        render(fractals[this.options.algorithm], colors[this.options.color]);
    },
    _klass: "fractal thing",
    _type: "fractal",
    _defaults: {
        width: 300,
        height: 300,
        autoscale: false,
        autoresize: true,
        keepaspectratio: true,
        algorithm: "mandelbrot",
        color: "yellow",
        smoothcolors: true,
        vx: 0.3,
        vy: 0,
        zoom: 10
    },
    _schema: {
       "type":"object",
       "description":"Fractal properties",
       "properties":{
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          },
          "autoscale":{
             "type":"boolean",
             "required":false
          }
       },
       "additionalProperties":true
    }
});


var Html = Thing.extend({
    init: function() {
        this.inner = $("<div>");
        this.element.html(this.inner);
    },
    refresh: function() {
        this.base();
        this.inner.html(this.options.html).attr('class',this.options.innerCss);
    },
    _klass: "html thing",
    _type: "html",
    _defaults: {
        html: ""
    },
    _schema: {
       "type":"object",
       "description":"Html properties",
       "properties":{
          "html":{
             "type":"string",
             "required":true
          },
          "css":{
             "type":"string",
             "required":false
          },
          "innerCss":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


var Svg = Thing.extend({
    init: function() {
    },
    refresh: function() {
        this.base();
        this.element.html(this.options.svg);
    },
    _klass: "svg thing",
    _type: "svg",
    _defaults: {
        svg: '<svg xmlns="http://www.w3.org/2000/svg" version="1.1">'
    },
    _schema: {
       "type":"object",
       "description":"Svg properties",
       "properties":{
          "svg":{
             "type":"string",
             "required":true
          },
          "width":{
             "type":"string",
             "required":false
          },
          "height":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


var SvgEditor = Thing.extend({
    change: function(arg) {
        if(typeof arg == 'function') {
            this.onchange = arg;
        } else {
            this.onchange(arg);
        }
    },
    init: function() {
        var self = this;
        self.onchange = $.noop;
        self.frame = $('<iframe src="'+baseUrl+'testing/svgedit">').attr('width',self.options.width).attr('height', self.options.height);
        self.frame.ready(function() {
            // http://code.google.com/p/svg-edit/wiki/TipsAndTricks
            // waiting for real load
            (function(){
                try {
                    var cw = self.frame[0].contentWindow;
                    var md = cw.methodDraw;
                    md.ready(function() {     
                        cw.svgCanvas.setSvgString(self.options.svg);
                    });        
                    md.addExtension("server_opensave", {
                        callback: function() {
                            md.setCustomHandlers({
	                            save: function(win, data) {
		                            self.options.svg = data;
                                    self.onchange(data);
	                            }
                            });
                        }
                    });
                }
                catch (Ex){
                    setTimeout(arguments.callee, 1000);
                }
            })();
        });
        self.frame.appendTo(self.element);
    },
    refresh: function() {
        this.base();
    },
    _klass: "svg-editor thing",
    _type: "svg-editor",
    _defaults: {
        svg: '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100" height="100"></svg>',
        width: "800px",
        height: "600px"
    },
    _schema: {
       "type":"object",
       "description":"SvgEditor properties",
       "properties":{
          "svg":{
             "type":"string",
             "required":true
          },
          "width":{
             "type":"string",
             "required":false
          },
          "height":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


var TextThing = Html.extend({
    refresh: function() {
        this.base();
        var o = this.options;
        if(o['h-align'] && o['h-align'] != 'center') this.inner.addClass(o['h-align']);
        if(o['v-align'] && o['v-align'] != 'center') this.inner.addClass(o['v-align']);
        this.inner.css('font-size', o['font-size']);
        this.inner.css('font-family', o['font-family']);
    },
    _klass: "text-thing html thing",
    _type: "text-thing",
    _defaults: {
        "html": "",
        "css": "",
        "h-align": "center",
        "v-align": "center",
        "font-size": "20px",
        "font-family": "Georgia, serif"
    },
    _schema: {
       "type":"object",
       "properties":{
          "html":{
             "type":"string",
	     "format":"richtext",
             "required":true
          },
          "h-align":{
             "type":"string",
             "enum":["left","center","right"],
             "required":false
          },
          "v-align":{
             "type":"string",
             "enum":["top","center","bottom"],
             "required":false
          },
          "font-size":{
             "type":"string",
             "enum":["50%","60%","75%", "85%", "100%", "120%", "150%", "175%", "200%", "250%"],
             "required":false
          },
          "font-family":{
             "type":"string",
             "enum":[
'Arial,Arial,Helvetica,sans-serif',
'Arial Black,Arial Black,Gadget,sans-serif',
'Comic Sans MS,Comic Sans MS,cursive',
'Courier New,Courier New,Courier,monospace',
'Georgia,Georgia,serif',
'Impact,Charcoal,sans-serif',
'Lucida Console,Monaco,monospace',
'Lucida Sans Unicode,Lucida Grande,sans-serif',
'Palatino Linotype,Book Antiqua,Palatino,serif',
'Tahoma,Geneva,sans-serif',
'Times New Roman,Times,serif',
'Trebuchet MS,Helvetica,sans-serif',
'Verdana,Geneva,sans-serif' 
],
             /*"format":"font",*/
             "required":false
          }
       },
       "additionalProperties":true
    }
});


var Templated = Thing.extend({
    refresh: function() {
        var tmpl = $.templates( "#"+this.options.template+"Template" );
        var html = tmpl.render(this.options);
        this.element.html(html);
        this.element.find("[data-slot]").each(function() { 
            $(this).html(Thing.empty().get()); 
        });
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.find("[data-slot='"+key+"']").html(value.get());
        return this;
    },
    _klass: "templated thing",
    _type: "templated",
    _defaults: {
        template: "demo",
        name: "Myrousz"
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "template": {
			    "type":"string",
			    "required":true
		    },
		    "name": {
			    "type":"string",
			    "required":true
		    }
	    }
    }
});


var Snippet = Thing.extend({
    refresh: function() {
        var o = this.options;
        var code = $("<pre>").text(o.code);
        this.element.html(code);
        SyntaxHighlighter.highlight({title: o.title, 'brush':o.lang}, code.get(0));        
    },
    _klass: "snippet thing",
    _type: "snippet",
    _defaults: {
        "title": "",
        "lang": "js",
        "code": ""
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "title": {
			    "type":"string",
			    "required":false
		    },
		    "lang": {
			    "type":"string",
                "enum":["js","php","plain"],
			    "required":true
		    },
		    "code": {
			    "type":"string",
			    "required":true
		    }
	    }
    }
});


var SoftKeyboard = Thing.extend({
    init: function() {
        this.keys = {};
        this.onkeypress = $.noop;
    },
    refresh: function() {
        var kbd = $("<div>");
        var rows = this.options.rows;
        var cols = this.options.rows;
        for(var key in this.options.keys) {
            var k = this.options.keys[key];
            var kk = this._makeKey(key, k).appendTo(kbd);
            this.keys[key] = kk;
        }
        this.element.html(kbd);
    },
    getKeyButton: function(key) {
        return {"name":key, "button":this.keys[key], "key":this.options.keys[key]};
    },
    _makeKey: function(name, k) {
        var self = this;
        var o = this.options;
        var top = Math.floor(100*k.top/o.rows) + "%";
        var left = Math.floor(100*k.left/o.columns) + "%";
        var ww = k.size || k.width;
        var hh = k.size || k.height;
        var mm = 2;
        var width = Math.floor(100*ww/o.columns) + "%";
        var height = Math.floor(100*hh/o.rows) + "%";
        var div = $("<button>").addClass("key key-"+name).css({'top':top, 'left':left, 'width':width, 'height':height}).append($("<div>").text(k.label));
        div.click(function() {
            if(k['switch']) {
                div.toggleClass("active");
            }
            self.keyPressed(self.getKeyButton(name));
        });
        return div;
    },
    keyPressed: function(kb) {
        if(typeof kb == 'function') {
            this.onkeypress = kb;
        } else {
            this.onkeypress(kb);
        }
    },
    getSwitchState: function(name) {
        if(this.options.keys[name] && this.options.keys[name]['switch']) {
            return this.keys[name].hasClass("active");
        } else {
            return false;
        }
    },    
    _klass: "soft-keyboard thing",
    _type: "soft-keyboard",
    _defaults: {
        "rows": 8,
        "columns": 20,
        "keys": {
            "q" : { "left":0, "top":0, "size":2, "label":"Q"},
            "w" : { "left":2, "top":0, "size":2, "label":"W"},
            "e" : { "left":4, "top":0, "size":2, "label":"E"},
            "r" : { "left":6, "top":0, "size":2, "label":"R"},
            "t" : { "left":8, "top":0, "size":2, "label":"T"},
            "y" : { "left":10, "top":0, "size":2, "label":"Y"},
            "u" : { "left":12, "top":0, "size":2, "label":"U"},
            "i" : { "left":14, "top":0, "size":2, "label":"I"},
            "o" : { "left":16, "top":0, "size":2, "label":"O"},
            "p" : { "left":18, "top":0, "size":2, "label":"P"},
            "a" : { "left":1, "top":2, "size":2, "label":"A"},
            "s" : { "left":3, "top":2, "size":2, "label":"S"},
            "d" : { "left":5, "top":2, "size":2, "label":"D"},
            "f" : { "left":7, "top":2, "size":2, "label":"F"},
            "g" : { "left":9, "top":2, "size":2, "label":"G"},
            "h" : { "left":11, "top":2, "size":2, "label":"H"},
            "j" : { "left":13, "top":2, "size":2, "label":"J"},
            "k" : { "left":15, "top":2, "size":2, "label":"K"},
            "l" : { "left":17, "top":2, "size":2, "label":"L"},
            "caps" : { "left":0, "top":4, "width":3, "height":2, "label":__("caps"), "switch":true},
            "z" : { "left":3, "top":4, "size":2, "label":"Z"},
            "x" : { "left":5, "top":4, "size":2, "label":"X"},
            "c" : { "left":7, "top":4, "size":2, "label":"C"},
            "v" : { "left":9, "top":4, "size":2, "label":"V"},
            "b" : { "left":11, "top":4, "size":2, "label":"B"},
            "n" : { "left":13, "top":4, "size":2, "label":"N"},
            "m" : { "left":15, "top":4, "size":2, "label":"M"},
            "del" : { "left":17, "top":4, "width":3, "height":2, "label":__("del")},
            "nums" : { "left":0, "top":6, "width":4, "height":2, "label":__("?123")},
            "comma" : { "left":4, "top":6, "width":3, "height":2, "label":","},
            "space" : { "left":7, "top":6, "width":6, "height":2, "label":__("space")},
            "dot" : { "left":13, "top":6, "width":3, "height":2, "label":"."},
            "enter" : { "left":16, "top":6, "width":4, "height":2, "label":__("enter")}
        }
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "rows": {
			    "type":"integer",
			    "required":true
		    },
		    "columns": {
			    "type":"integer",
			    "required":true
		    }
	    }
    }
});


var SoftTextEditor = Thing.extend({
    init: function() {
        var self = this;
        this.onchange = $.noop;
        this.keyboard = new SoftKeyboard();
        this.keyboard.keyPressed(function(kb) {
            self._keyPressed(kb);
        });
        this.textfield = $("<textarea>").val(this.options.value).change(function() {
            self.options.value = $(this).val();
        });
        this.buttonOk = $("<button>").addClass('done').text(__("Done")).click(function() {
            self.change(self.textfield.val());
        });
        this.element
            .append($("<div>").addClass("textfield").append(this.textfield))
            .append($("<div>").addClass("btn").append(this.buttonOk))            
            .append(this.keyboard.get());
    },
    refresh: function() {
        this.textfield.val(this.options.value);
    },
    // TODO napojit
    change: function(arg) {
        if(typeof arg == 'function') {
            this.onchange = arg;
        } else {
            this.onchange(arg);
        }
    },
    _keyPressed: function(kb) {
        var cc = kb.name;
        switch(cc) {
            case 'caps': 
                this.capsLock = this.keyboard.getSwitchState('caps');
                break;
            case 'del':
                // delete last character
                this.options.value = this.options.value.slice(0, -1);
                this.refresh();
                break;
            case 'nums': 
                break;
            case 'enter':
                this.options.value += "\n";
                this.refresh();
                break;
            case 'comma':
                this.options.value += ",";
                this.refresh();
                break;
            case 'space':
                this.options.value += " ";
                this.refresh();
                break;
            case 'dot':
                this.options.value += ".";
                this.refresh();
                break;
            default:
                if(this.capsLock) {
                    // invert case...
                    cc = ( cc >= 'A' && cc <= 'Z' ) ? cc.toLowerCase() : cc.toUpperCase();
                }
                this.options.value += cc;
                this.refresh();
        }
    },
    _klass: "soft-text-editor thing",
    _type: "soft-text-editor",
    _defaults: {
        "value": ""
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "value": {
			    "type":"string",
			    "required":true
		    }
	    }
    }
});



var HolidayCalendar = {
    // kdy je velikonocni nedele - bozi hod velikonocni?
    easter: {
        "2012": {month: 4, day: 8},
        "2013": {month: 3, day: 31},
        "2014": {month: 4, day: 20},
        "2015": {month: 4, day: 5}
    },
    data: 
// BEGIN JSON DATA
[
    {
        "month": "Leden",
        "days": [
            {
                "number": "1",
                "names": [
                    "Nový rok"/*,
                    "Den obnovy samostatného českého státu"*/
                ],
                "holiday": true
            },
            {
                "number": "2",
                "names": [
                    "Karina"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Radmila"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Diana"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Dalimil"
                ]
            },
            {
                "number": "6",
                "names": [
                    /*"Kašpar",
                    "Melichar",
                    "Baltazar"*/"Tři králové"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Vilma"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Čestmír"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Vladan"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Břetislav"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Bohdana"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Pravoslav"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Edita"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Radovan"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Alice"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Ctirad"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Drahoslav"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Vladislav"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Sára/Doubravka"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Ilona"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Běla"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Slavomír"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Zdeněk"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Milena"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Miloš"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Zora"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Ingrid"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Otýlie"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Zdislava"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Robin"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Marika"
                ]
            }
        ]
    },
    {
        "month": "Únor",
        "days": [
            {
                "number": "1",
                "names": [
                    "Hynek"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Nela"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Blažej"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Jarmila"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Dobromila"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Vanda"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Veronika"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Milada"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Apolena"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Mojmír"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Božena"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Slavěna"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Věnceslav"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Valentýn"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Jiřina"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Ljuba"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Miloslava"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Gizela"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Patrik"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Oldřich"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Lenka"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Petr"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Svatopluk"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Matěj"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Liliana"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Dorota"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Alexandr"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Lumír"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Horymír"
                ]
            }
        ]
    },
    {
        "month": "Březen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Bedřich"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Anežka"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Kamil"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Stela"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Kazimír"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Miroslav"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Tomáš"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Gabriela"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Františka"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Viktorie"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Anděla"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Řehoř"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Růžena"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Matylda/Rút"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Ida"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Herbert/Elena"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Vlastimil"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Eduard"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Josef"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Světlana"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Radek"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Leona"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Ivona"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Gabriel"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Marian"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Emanuel"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Dita"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Soňa"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Taťána"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Arnošt"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Kvido"
                ]
            }
        ]
    },
    {
        "month": "Duben",
        "days": [
            {
                "number": "1",
                "names": [
                    "Hugo"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Erika"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Richard"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Ivana"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Miroslava"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Vendula"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Hermína/Herman"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Ema"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Dušan"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Darja"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Izabela"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Július"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Aleš"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Vincenc"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Anastázie"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Irena"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Rudolf"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Valérie"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Rostislav"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Marcela"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Alexandra"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Evženie"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Vojtěch"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jiří"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Marek"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Oto"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Jaroslav"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Vlastislav"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Robert"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Blahoslav"
                ]
            }
        ]
    },
    {
        "month": "Květen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Svátek práce"
                ],
                "holiday": true
            },
            {
                "number": "2",
                "names": [
                    "Zikmund"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Alexej"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Květoslav"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Klaudie"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Radoslav"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Stanislav"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Den vítězství"
                ],
                "holiday": true
            },
            {
                "number": "9",
                "names": [
                    "Ctibor"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Blažena"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Svatava"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Pankrác"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Servác"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Bonifác"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Žofie"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Přemysl"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Aneta"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Nataša"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Ivo"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Zbyšek"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Monika"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Emil"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Vladimír"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jana"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Viola"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Filip"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Valdemar"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Vilém"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Maxmilián"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Ferdinand"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Kamila"
                ]
            }
        ]
    },
    {
        "month": "Červen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Laura"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Jarmil"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Tamara"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Dalibor"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Dobroslav"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Norbert"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Iveta"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Medard"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Stanislava"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Gita"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Bruno"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Antonie"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Antonín"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Roland"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Vít"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Zbyněk"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Adolf"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Milan"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Leoš"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Květa"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Alois"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Pavla"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Zdeňka"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jan"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Ivan"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Adriana"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Ladislav"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Lubomír"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Petr a Pavel"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Šárka"
                ]
            }
        ]
    },
    {
        "month": "Červenec",
        "days": [
            {
                "number": "1",
                "names": [
                    "Jaroslava"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Patricie"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Radomír"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Prokop"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Cyril a Metoděj"
                ],
                "holiday": true
            },
            {
                "number": "6",
                "names": [
                    /*"Den upálení Mistra Jana Husa"*/"Jan Hus"
                ],
                "holiday": true
            },
            {
                "number": "7",
                "names": [
                    "Bohuslava"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Nora"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Drahoslava"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Libuše/Amálie"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Olga"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Bořek"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Markéta"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Karolína"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Jindřich"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Luboš"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Martina"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Drahomíra"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Čeněk"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Ilja/Eliáš"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Vítězslav"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Magdalena"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Libor"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Kristýna"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Jakub"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Anna"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Věroslav"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Viktor"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Marta"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Bořivoj"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Ignác"
                ]
            }
        ]
    },
    {
        "month": "Srpen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Oskar"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Gustav"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Miluše"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Dominik"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Kristián"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Oldřiška"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Lada"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Soběslav"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Roman"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Vavřinec"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Zuzana"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Klára"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Alena"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Alan"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Hana"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Jáchym"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Petra"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Helena"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Ludvík"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Bernard"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Johana"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Bohuslav"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Sandra"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Bartoloměj"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Radim"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Luděk"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Otakar"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Augustýn"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Evelína"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Vladěna"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Pavlína"
                ]
            }
        ]
    },
    {
        "month": "Září",
        "days": [
            {
                "number": "1",
                "names": [
                    "Linda/Samuel"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Adéla"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Bronislav"
                    /* /Bronislava"*/
                ]
            },
            {
                "number": "4",
                "names": [
                    "Jindřiška"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Boris"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Boleslav"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Regina"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Mariana"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Daniela"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Irma"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Denisa"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Marie"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Lubor"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Radka"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Jolana"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Ludmila"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Naděžda"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Kryštof"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Zita"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Oleg"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Matouš"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Darina"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Berta"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jaromír"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Zlata"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Andrea"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Jonáš"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Václav"/*,
                    "Den české státnosti"*/
                ],
                "holiday": true
            },
            {
                "number": "29",
                "names": [
                    "Michal"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Jeroným"
                ]
            }
        ]
    },
    {
        "month": "Říjen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Igor"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Olivie/Oliver"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Bohumil"
                ]
            },
            {
                "number": "4",
                "names": [
                    "František"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Eliška"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Hanuš"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Justýna"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Věra"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Štefan/Sára"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Marina"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Andrej"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Marcel"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Renáta"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Agáta"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Tereza"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Havel"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Hedvika"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Lukáš"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Michaela"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Vendelín"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Brigita"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Sabina"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Teodor"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Nina"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Beáta"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Erik"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Šarlota/Zoe"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Státní svátek"/*,
                    "Den vzniku samostatného československého státu"*/
                ],
                "holiday": true
            },
            {
                "number": "29",
                "names": [
                    "Silvie"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Tadeáš"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Štěpánka"
                ]
            }
        ]
    },
    {
        "month": "Listopad",
        "days": [
            {
                "number": "1",
                "names": [
                    "Felix"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Památka zesnulých"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Hubert"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Karel"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Miriam"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Liběna"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Saskie"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Bohumír"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Bohdan"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Evžen"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Martin"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Benedikt"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Tibor"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Sáva"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Leopold"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Otmar"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Mahulena"/*,
                    "Den boje za svobodu a demokracii"*/
                ],
                "holiday": true
            },
            {
                "number": "18",
                "names": [
                    "Romana"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Alžběta"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Nikola"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Albert"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Cecílie"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Klement"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Emílie"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Kateřina"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Artur"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Xenie"
                ]
            },
            {
                "number": "28",
                "names": [
                    "René"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Zina"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Ondřej"
                ]
            }
        ]
    },
    {
        "month": "Prosinec",
        "days": [
            {
                "number": "1",
                "names": [
                    "Iva"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Blanka"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Svatoslav"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Barbora"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Jitka"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Mikuláš"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Ambrož/Benjamín"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Květoslava"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Vratislav"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Julie"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Dana"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Simona"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Lucie"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Lydie"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Radana"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Albína"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Daniel"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Miloslav"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Ester"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Dagmar"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Natálie"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Šimon"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Vlasta"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Adam a Eva"/*,
                    "Štědrý den"*/
                ],
                "holiday": true
            },
            {
                "number": "25",
                "names": [
                    "Boží hod vánoční"
                ],
                "holiday": true
            },
            {
                "number": "26",
                "names": [
                    "Štěpán"/*,
                    "Druhý svátek vánoční"*/
                ],
                "holiday": true
            },
            {
                "number": "27",
                "names": [
                    "Žaneta"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Bohumila"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Judita"
                ]
            },
            {
                "number": "30",
                "names": [
                    "David"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Silvestr"
                ]
            }
        ]
    }
]
// END JSON DATA
};

var Calendar = RaphaelThing.extend({
    /* canvas size: 1000x1000 */
    refresh: function() { 
        this.base();   
        var d = this.options;
        this.paper = this.canvas;
        this.paper.clear();
        this.lineAttr = { "fill": "none", "stroke": d.lineColor};
        this.monthNameAttr = { "stroke": "none", "fill": d.fontColor, "font-family":d.fontFamily, "font-size":d.titleFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.monthCapAttr = { "fill": d.fontColor, "stroke": "none", "font-family":d.fontFamily, "font-size":d.dayCapFontSize, "font-style":d.fontStyle};
        this.dayNumAttr = { "stroke": "none", "fill":d.fontColor, "font-family":d.fontFamily, "font-weight":"bold", "font-size":d.numbersFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.dayNameAttr = { "stroke": "none", "fill": d.fontColor, "font-family":d.fontFamily, "font-size":d.namesFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.dayNumAttrHigh = { "stroke": "none", "fill": d.fontColorHigh, "font-family":d.fontFamily, "font-weight":"bold", "font-size":d.numbersFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.dayNameAttrHigh = { "stroke": "none", "fill": d.fontColorHigh, "font-family":d.fontFamily, "font-size":d.namesFontSize, "font-style":d.fontStyle, "text-anchor":"end"};

        this.monthCapOffset = 12;
        this.boxWidth = 142;
        this.boxHeight = 142;
        this.drawMonth(d.year, d.month);
        // HACK: https://github.com/DmitryBaranovskiy/raphael/issues/491
        this.element.find("tspan").attr("dy", 0);
    },

    drawMonthGrid: function(rows, x, y) {
        // draws grid 7x5 with day captions
        for(var i=0; i<=7; i++) {
            // draw captions
            // draw vertical lines
            var xx = x + i*this.boxWidth;
            var str = "M"+xx+","+y+"l0,"+rows*this.boxHeight;
            this.paper.path(str).attr(this.lineAttr); 
            if(i<7) this.paper.text(xx+this.boxWidth/2, y-this.monthCapOffset, this.locale[this.currentLocale].daysOfWeek[i]).attr(this.monthCapAttr);
        }
        for(var j=0; j<=rows; j++) {
            // draw horizontal lines
            var yy = y + j*this.boxHeight;
            var str = "M"+x+","+yy+"l"+7*this.boxWidth+",0";
            this.paper.path(str).attr(this.lineAttr);            
        }                    
    },

    drawDayBox: function(row, column, year, month, day, x, y) {
        // is day sunday?
        var sunday = this.getDayOfWeek(year, month, day) == 0;
        // is day holiday?
        var holiday = HolidayCalendar.data[month-1].days[day-1].holiday;

        var xx = x + (column+1)*this.boxWidth - 5;
        // print number...
        var yy = y + (row+1-0.45)*this.boxHeight - 5;
        this.paper.text(xx, yy, day).attr((sunday || holiday) ? this.dayNumAttrHigh : this.dayNumAttr);
        // print name
        var yy = y + (row+1-0.1)*this.boxHeight - 5;
        this.paper.text(xx, yy, HolidayCalendar.data[month-1].days[day-1].names[0]).attr(holiday ? this.dayNameAttrHigh : this.dayNameAttr);
    },

    drawMonth: function(year, month) {
        var x = 0;
        var column = this.getDayOfWeek(year, month, 1);
        // nedele = 0! pondeli 1...
        column = (column==0) ? 6 : column-1;
        // how many total rows?
        lastColumn = column+HolidayCalendar.data[month-1].days.length;
        var totalRows = Math.floor((lastColumn+6)/7);
        var y = 7*this.boxHeight - totalRows*this.boxHeight;
        // draw month name
        var mn = this.locale[this.currentLocale].months[month-1] + " "+year;
        this.drawMonthGrid(totalRows, x, y);
        this.paper.text(x+7*this.boxWidth, y-0.7*this.boxHeight, mn).attr(this.monthNameAttr);
        var row = 0;
        for(var i=0; i<HolidayCalendar.data[month-1].days.length; i++) {
            this.drawDayBox(row, column, year, month, i+1, x, y);
            column++;
            if(column == 7) {
                column = 0;
                row++;
            }
        }

    },
    locale: {
        "en": {
            "months": [
                "January","February","March","April","May","June","July","August","September","October","November","December"
            ],
            "daysOfWeek": [
                "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"
            ]
        },
        "cz": {
            "months": [
                "Leden","Únor","Březen","Duben","Květen","Červen","Červenec","Srpen","Září","Říjen","Listopad","Prosinec"
            ],
            "daysOfWeek": [
                "Pondělí", "Úterý", "Středa", "Čtvrtek", "Pátek", "Sobota", "Neděle"
            ]
        }
    },
    currentLocale: 'cz',
    getDayOfWeek: function(year, month, day) {
        var d = new Date(year, month-1, day, 0, 0, 0, 0);
        return d.getDay();
    },
    isLeapYear: function(yr) {
        return new Date(yr,2-1,29).getDate()==29;
    },

    _klass: "calendar raphael-thing thing",
    _type: "calendar",
    _defaults: {
        width: 1000,
        height: 1000,
        year: 2012,
        month: 12,
        fontFamily: "Arial", 
        fontStyle: "italic", 
        lineColor: "black",
        fontColor: "black",
        fontColorHigh: "red",
        titleFontSize: "40",
        dayCapFontSize: "20",
        numbersFontSize: "60",
        namesFontSize: "16"
    },
    _schema: {
       "type":"object",
       "description":"Calendar properties",
       "properties":{
          "year":{
             "type":"string",
             "enum":["2012", "2013","2014","2015"],
             "required":true
          },
          "month":{
             "type":"string",
             "enum":["1", "2","3","4","5","6","7","8","9","10","11","12"],
             "required":true
          },
            // .....
          "titleFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "dayCapFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "numbersFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "namesFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "fontFamily":{
             "type":"string",
             "enum":["Georgia, serif","Arial, Helvetica, sans-serif","Impact, Charcoal, sans-serif", "Tahoma, Geneva, sans-serif", "Verdana, Geneva, sans-serif", "Monaco, monospace"],
             "required":true
          },
          "fontStyle":{
             "type":"string",
             "enum":["regular","italic","monospace"],
             "required":true
          }
       },
       "additionalProperties":true
    }
});



// TODO kdyz zmenim parametry hodin a ulozim, nepromitne se to do inputu

var Clock = RaphaelThing.extend({
    refresh: function() {
        this.base();
        var 
            o = this.options,
            size = o.size,
            canvas = this.canvas,
            clock = canvas.circle(size*.5,size*.5, size * .475);
        clock.attr({"fill":o.fillColor,"stroke":o.strokeColor,"stroke-width":(size*.025)})
        var hour_sign;
        for(i=0;i<12;i++){
            var start_x = size*.5+Math.round((size*.4)*Math.cos(30*i*Math.PI/180));
            var start_y = size*.5+Math.round((size*.4)*Math.sin(30*i*Math.PI/180));
            var end_x = size*.5+Math.round((size*.45)*Math.cos(30*i*Math.PI/180));
            var end_y = size*.5+Math.round((size*.45)*Math.sin(30*i*Math.PI/180));
            hour_sign = canvas.path("M"+start_x+" "+start_y+"L"+end_x+" "+end_y);
        }
        this.hour_hand = canvas.path("M" + size*.5 + " " + size*.5 + "L" + size*.5 + " " + (size*.25) + "");
        this.hour_hand.attr({stroke: o.hourHandColor, "stroke-width": size*.03});
        this.minute_hand = canvas.path("M" + size*.5 + " " + size*.5 + "L" + size*.5 + " " + (size*.2) + "");
        this.minute_hand.attr({stroke: o.minuteHandColor, "stroke-width": size*.02});
        this.second_hand = canvas.path("M" + size*.5 + " " + (size*.55) + "L" + size*.5 + " " + (size*.125) + "");
        this.second_hand.attr({stroke: o.secondHandColor, "stroke-width": size*.01});
        var pin = canvas.circle(size*.5, size*.5, size*.025);
        pin.attr("fill", o.pinColor);

        var self = this;
        var updater = function() {
            self.update();
        };
        updater();
        setInterval(updater,1000); 
    },
    update: function() {
        var self = this,
            size = this.options.size,
            now = new Date(),
            hours = now.getHours(),
            minutes = now.getMinutes(),
            seconds = now.getSeconds(),
            cc = ","+(size*.5)+","+(size*.5);
        self.hour_hand.transform('r'+(30*hours+(minutes/2.5))+cc);
        self.minute_hand.transform('r'+(6*minutes)+cc);
        self.second_hand.transform('r'+(6*seconds)+cc);
    },
    _klass: "clock raphael-thing thing",
    _type: "clock",
    _defaults: {
        width: 100,
        height: 100,
        size: 100,
        fillColor: "white", 
        strokeColor: "black", 
        pinColor: "gray",
        hourHandColor:"black", 
        minuteHandColor:"black",
        secondHandColor:"black"
    },
    _schema: {
       "type":"object",
       "description":"Clock properties",
       "properties":{
          "size":{
             "type":"integer",
             "required":true
          },
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          },
          "fillColor":{
             "type":"string",
             "format": "color",
             "required":true
          },
          "strokeColor": { "type": "string", "required": true, "format": "color" },
          "pinColor": { "type": "string", "required": true, "format": "color" },
          "hourHandColor": { "type": "string", "required": true, "format": "color" },
          "minuteHandColor": { "type": "string", "required": true, "format": "color" },
          "secondHandColor": { "type": "string", "required": true, "format": "color" }
       },
       "additionalProperties":true
    }
});


var Modal = Thing.extend({
    init: function() {
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.html($("<p>").html(value.get()));
        this.refresh();
        return this;
    },
    _fullOpts: function() {
      return $.extend({modal: true}, this.options)
    },
    show: function() {
        var self = this;
	    $(self.element).dialog(this._fullOpts());
	    $(self.element).dialog('open');
    },
    close: function() {
	    $(this.element).dialog('close');
    },
    refresh: function() {
    	$(this.element).dialog(this._fullOpts());
    },
    _klass: "modal thing",
    _type: "modal",
    _defaults: {
        autoOpen: false,
        minHeight: 608, // 560,  
        minWidth: 760, //740
        title: 'Dialog',
        closeOnEscape: true
    },
    _schema: {
       "type":"object",
       "properties":{
          "title": {
             "type": "string",
             "required": false
          },
          "autoOpen":{
             "type":"boolean",
             "required":true
          },
          "minHeight":{
             "type":"string",
             "required":true
          },
          "minWidth":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }

}, {
    show: function(thing, opts) {
        var modal = new Modal(opts);
        modal.content('content',thing);
        modal.show();
        return modal;
    }
});


var Dummy = Html.extend({
    refresh: function() {
        this.base();
        this.element.css('width', this.options['width']);
        this.element.css('height',this.options['height']);
        this.element.css('color',this.options['color']);
        this.element.css('background-color',this.options['background-color']);
    },
    _klass: "dummy html thing",
    _type: "dummy",
    _defaults: {
        html: "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla sed dolor nisl, in suscipit justo. Donec a enim et est porttitor semper at vitae augue. Proin at nulla at dui mattis mattis. Nam a volutpat ante. Aliquam consequat dui eu sem convallis ullamcorper. Nulla suscipit, massa vitae suscipit ornare, tellus est consequat nunc, quis blandit elit odio eu arcu. Nam a urna nec nisl varius sodales. Mauris iaculis tincidunt orci id commodo. Aliquam non magna quis tortor malesuada aliquam eget ut lacus. Nam ut vestibulum est. Praesent volutpat tellus in eros dapibus elementum. Nam laoreet risus non nulla mollis ac luctus felis dapibus. Pellentesque mattis elementum augue non sollicitudin. Nullam lobortis fermentum elit ac mollis. Nam ac varius risus. Cras faucibus euismod nulla, ac auctor diam rutrum sit amet. Nulla vel odio erat, ac mattis enim.",
        'width': "",
        'height': '',
        'color': '',
        'background-color': ''
    },
    _schema: {
       "type":"object",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "height":{
             "type":"string",
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          },
          "background-color":{
             "type":"string",
             "format": "color",
             "required":true
          }
       },
       "additionalProperties":true
    }
});

// decorator = thing with a single slot named 'content'

// TODO podedit toto vsechno od 'Decorator'
// kvuli reverzibilite dekoratoru by bylo dobre kdyby kazdy menil css properties 'wrapper' divu
var Decorator = Thing.extend({
    init: function() {
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.html(value.get());
        return this;
    },
    unwrap: function() {
        this.replaceWith(this.getSlot('content'));
    },
    _klass: "decorator thing",
    _type: "decorator"
});


















var Clickable = Thing.extend({
    init: function() {
        this.pane = $("<div>").addClass("clickable-pane");
        this.setSlot('content', Thing.empty());
        this.click($.noop);
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.empty()
            .append(value.get())
            .append(this.pane);
        return this;
    },
    refresh: function() {
      this.base();
      this.pane.attr('title', this.options.tooltip);
    },
    click: function(arg) {
        if(arg) {
            this.onclick = arg;
            this.pane.click(this.onclick);
        } else {
            return this.onclick();
        }
    },
    _klass: "clickable thing",
    _type: "clickable",
    _defaults: {
      "tooltip": ""
    }
});


var Editable = Thing.extend({
    init: function() {
        this.onchanged = $.noop;
        this.editor = $("<div>").addClass("editable-editor");
        this.pane = $("<div>").addClass("editable-pane");
        this.element.append(this.pane).append(this.editor);
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        var self = this;
        var schema = value._schema;
        this.editor.empty();
        if(!schema) {
            // pouzit radsi json editor
        } else {
            this.editor.jsonform({schema: value._schema, value: value.options, name: __("Properties")+" - "+value._type});
            this.editor.jsonform('change', function() {
                self._save(true);
            });
            this.editor.jsonform('save', function() {
                self._save();
            });
        }
        this.pane.html(value.get());
        return this;
    },
    _save: function(stay) {
        var self = this;
        // value changed in editor...
        var newVal = self.editor.jsonform('value');
        self.getSlot('content').setOptions(newVal);
        if(!stay) self.onchanged(newVal);
    },
    _klass: "editable thing",
    _type: "editable",
    _defaults: {}
}, {
    edit: function(thing, changed) {
        var edt = new Editable();
        edt.setSlot('content', thing.copy());
        var modal = Modal.show(edt, {height: 630, minHeight: 630, width: 840, minWidth: 840, resizable: false, draggable: true, title:__('Properties')});
        edt.onchanged = function(newVal) {
            modal.close();
            if(changed) changed(newVal);
        };
    }
});



var ToolbarDecorator = Thing.extend({
    init: function() {
        this._content = $("<div>")
            .addClass("mykkro-toolbar-decorator-content")
            .appendTo(this.element);
        this.setSlot('content', Thing.empty());
    },
    refresh: function() {
	    this.base();
        if(this.options.hidden) {
            this.element.toolbar({tools:{}});
        } else {
            this.element.toolbar({tools:this.options.tools});
        }
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this._content.html(value.get());
        return this;
    },
    showToolbar: function() {
        this.options.hidden = false;
        this.refresh();
    },
    hideToolbar: function() {
        this.options.hidden = true;
        this.refresh();
    },
    serialize: function() {
        // toolbar decorator se nebude serializovat (aspon automaticky ne)
        return this.getSlot('content').serialize();
    },
    getTree: function() {
        // skip the outer layer...
        return this.getSlot('content').getTree();
    },
    getTreeView: function(decorator) {
        // skip the outer layer...
        return this.getSlot('content').getTreeView(decorator);
    },
    _klass: "toolbar-decorator thing",
    _type: "toolbar-decorator",
    _defaults: {
        tools: {}
    } 
});


var ContextmenuDecorator = Thing.extend({
    init: function() {
        this._content = $("<div>")
            .addClass("mykkro-contextmenu-decorator-content")
            .appendTo(this.element);
        this.setSlot('content', Thing.empty());
    },
    refresh: function() {
	    this.base();
        if(this.options.hidden) {
            this.element.toolbar({tools:{}});
        } else {
            this.element.toolbar({tools:this.options.tools});
        }
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this._content.html(value.get());
        return this;
    },
    showToolbar: function() {
        this.options.hidden = false;
        this.refresh();
    },
    hideToolbar: function() {
        this.options.hidden = true;
        this.refresh();
    },
    serialize: function() {
        // toolbar decorator se nebude serializovat (aspon automaticky ne)
        return this.getSlot('content').serialize();
    },
    getTree: function() {
        // skip the outer layer...
        return this.getSlot('content').getTree();
    },
    getTreeView: function(decorator) {
        // skip the outer layer...
        return this.getSlot('content').getTreeView(decorator);
    },
    _klass: "contextmenu-decorator thing",
    _type: "contextmenu-decorator",
    _defaults: {
        tools: {}
    } 
});


var Page = Decorator.extend({
    // options changed...
    refresh: function() {
        this.element.css({
          'width': this.options['width'],
          'height': this.options['height'],
          'background-size': 'cover',
          'background-image': 'url('+this.options['background_url']+')'
        })
    },
    _klass: "page decorator thing",
    _type: "page",
    _defaults: {
        'width': '500px',
        'height': '700px',
        'background_url': ''
    },
    _schema: {
       "type":"object",
       "description":"Page properties",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "height":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var Preview = Decorator.extend({
    // options changed...
    refresh: function() {
        this.element.css('width',this.options['width']);
        this.element.css('height',this.options['height']);
    },
    _klass: "preview decorator thing",
    _type: "preview",
    _defaults: {
        'width': '80px',
        'height': '110px',
        'label': 'preview',
        'description': ''
    },
    _schema: {
       "type":"object",
       "description":"Clock properties",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "height":{
             "type":"string",
             "required":true
          },
          "label":{
             "type":"string",
             "required":false
          },
          "description":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }
});


var OpacityDecorator = Decorator.extend({
    refresh: function() {
      this.base();
      this.element.css('opacity',this.options.opacity);
    },
    _klass: "opacity-decorator decorator thing",
    _type: "opacity-decorator",
    _defaults: {
        opacity: 0.8
    },
    _schema: {
       "type":"object",
       "description":"Clock properties",
       "properties":{
          "opacity":{
             "type":"number",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var InsetDecorator = Decorator.extend({
    refresh: function() {
	this.base();
        this.element.css('padding',this.options.top+'% '+this.options.right+"% "+this.options.bottom+"% "+this.options.left+"%");
    },
    _klass: "inset-decorator decorator thing",
    _type: "inset-decorator",
    _defaults: {
        top: 2,
        left: 2,
        right: 2,
        bottom: 2
    },
    _schema: {
	"type":"object",
	"$schema": "http://json-schema.org/draft-03/schema",
	"properties":{
		"bottom": {
			"type":"number",
			"id": "bottom",
			"required":true
		},
		"left": {
			"type":"number",
			"id": "left",
			"required":true
		},
		"right": {
			"type":"number",
			"id": "right",
			"required":true
		},
		"top": {
			"type":"number",
			"id": "top",
			"required":true
		}
	},
       "additionalProperties":true
    }

});



var ShadowDecorator = Decorator.extend({
    // options changed...
    refresh: function() {
	this.base();
        var br = this.options['h-shadow']+" "+this.options['v-shadow']+" "+this.options.blur+" "+this.options.spread+" "+this.options.color;
        this.element.css('box-shadow',br);
        this.element.css('-webkit-box-shadow',br);
    },
    _klass: "shadow-decorator decorator thing",
    _type: "shadow-decorator",
    _defaults: {
        'h-shadow': "5px",
        'v-shadow': "5px",
        blur: "5px",
        spread: "5px",
        color: "#666"
    },
    _schema: {
       "type":"object",
       "properties":{
          "h-shadow":{
             "type":"string",
             "required":true
          },
          "v-shadow":{
             "type":"string",
             "required":true
          },
          "blur":{
             "type":"string",
             "required":true
          },
          "spread":{
             "type":"string",
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          }
       },
       "additionalProperties":true
    }
});





var BackgroundDecorator = Decorator.extend({
    // options changed...
    refresh: function() {
        this.base();
        if(this.options['image']) 
            this.element.css('background-image','url("'+this.options['image']+'")');
        else 
            this.element.css('background-image','');
        this.element.css('background-position',this.options['position']);
        this.element.css('background-repeat',this.options['repeat']);
        this.element.css('background-color',this.options['color']);
        this.element.css('background-size',this.options['size']);
    },
    _klass: "background-decorator decorator thing",
    _type: "background-decorator",
    _defaults: {
        'image': "",
        'repeat': 'no-repeat',
        'position': 'center center',
        'color': 'white',
        'size': 'cover'
    },
    _schema: {
       "type":"object",
       "properties":{
          "image":{
             "type":"string",
             "format": "my-image-uri",
            // TODO vadi mu kdyz je to false - option se neda rozkliknout
             "required":true
          },
          "repeat":{
             "enum": ["repeat","no-repeat","repeat-x","repeat-y"],
             "type":"string",
             "required":true // TODO
          },
          "position":{
             "type":"string",
             "required":true // TODO
          },
          "size":{
             "type":"string",
             "enum": ["cover","contain"],
             "required":true // TODO
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true // TODO
          }
       },
       "additionalProperties":true
    }
});



// TODO sloucit nejak s rounded decoratorem
var BorderDecorator = Decorator.extend({
    // options changed...
    refresh: function() {
        this.base();
        this.element.css('border-width', this.options['width']);
        this.element.css('border-style',this.options['style']);
        this.element.css('border-color',this.options['color']);
    },
    _klass: "border-decorator decorator thing",
    _type: "border-decorator",
    _defaults: {
        'width': "1px",
        'style': 'solid',
        'color': 'black'
    },
    _schema: {
       "type":"object",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "style":{
             "type":"string",
             "enum": ["none","solid","dotted","dashed","double","groove","ridge","inset","outset"],
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var RoundedDecorator = BorderDecorator.extend({
    refresh: function() {
        this.base();
        var br = this.options.radius;
        // TODO individualne vsechny 4 rohy
        this.element.css('border-radius',br);
        this.element.css('-webkit-border-radius',br);
        this.element.css('-moz-border-radius',br);
    },
    _klass: "rounded-decorator decorator thing",
    _type: "rounded-decorator",
    _defaults: {
        'width': "1px",
        'style': 'solid',
        'color': 'black',
        radius: "5%"
    },
    _schema: {
       "type":"object",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "style":{
             "type":"string",
             "enum": ["none","solid","dotted","dashed","double","groove","ridge","inset","outset"],
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          },
          "radius":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }
});



var PageDecorator = Thing.extend({
    init: function() {
        this.base();
        this.pageContent = $("<div>").addClass("page-content").appendTo(this.element);
        this.pageInfo = $("<div>").addClass('page-info').appendTo(this.element);
        this.setSlot('content', Thing.empty());
    },
    // options changed...
    refresh: function() {
        // TODO text mask?
        this.base();
        if(this.options.showInfo) this.pageInfo.show(); else this.pageInfo.hide();
        this.pageInfo.text("Page "+this.options.pageNumber);
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.pageContent.html(value.get());
        return this;
    },
    _klass: "page-decorator thing",
    _type: "page-decorator",
    _defaults: {
        'showInfo' : false,
        'pageNumber': 2,
        'pagesTotal' : 3,
        'recordsTotal' : 10
    },
    _schema: {
       "type":"object",
       "properties":{
          "showInfo":{
             "type":"boolean",
             "required":true
          },
          "pageNumber":{
             "type":"integer",
             "required":true
          },
          "pagesTotal":{
             "type":"integer",
             "required":true
          },
          "recordsTotal":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var CenteringDecorator = Thing.extend({
    init: function() {
        this.inner = $("<div>").addClass('content-inner').appendTo(
            $("<div>").addClass('center3').appendTo(
                $("<div>").addClass('center2').appendTo(
                    this.element
                )
            )
        );
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.inner.html(value.get());
        return this;
    },
    // options changed...
    refresh: function() {
        this.base();
        this.element.css('text-align',this.options['x-align']);
        this.element.children(".center2").css('vertical-align',this.options['y-align']);
        this.inner.css('width',this.options['content-width']);
        this.inner.css('height',this.options['content-height']);
    },
    _klass: "centering-decorator decorator thing",
    _type: "centering-decorator",
    _defaults: {
        'x-align': "center",
        'y-align': 'center',
        'content-width': '',
        'content-height': ''
    },
    _schema: {
       "type":"object",
       "properties":{
          "x-align":{
             "enum": ["left","center","right"],
             "type":"string",
             "required":true // TODO
          },
          "y-align":{
             "enum": ["top","middle","bottom"],
             "type":"string",
             "required":true // TODO
          },
          "content-width":{
             "type":"string",
             "required":true // TODO
          },
          "content-height":{
             "type":"string",
             "required":true // TODO
          }
       },
       "additionalProperties":true
    }
});



var RefDecorator = Thing.extend({
    init: function() {
        this._content = $("<div>").addClass("mykkro-ref-decorator-content")
        this._control = $("<a>").addClass('ref-link mykkro-ref-decorator-control')
        this._tooltip = $("<div>").addClass("hidden ref-tooltip")
        this.element.append(
            this._content,
            this._tooltip,
            this._control
        )
        this._control.qtip({content: { text: this._tooltip } })
        this.setSlot('content', Thing.empty())
    },
    refresh: function() {
        this.base()
        var label = this.options.label || "?"
        var src = this.options.source
        this._tooltip.empty().append($("<p>").text(__("Originally from:")))
        // TODO tohle nejak blbne...
        //if(Common.isValidUrl(src)) {
        if(src.startsWith("http")) {
            this._tooltip.append(
                $("<p>").append($("<a>").attr("href", src).text(src))
            )
            this._control.text(label).attr("href", src)
        } else {
            this._tooltip.append(
                $("<p>").text(src)
            )
            this._control.text(label).attr("href", "#").click(function() { return false;})
        }
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this._content.html(value.get());
        return this;
    },
    showToolbar: function() {
        this.options.hidden = false;
        this.refresh();
    },
    hideToolbar: function() {
        this.options.hidden = true;
        this.refresh();
    },
    /*
    serialize: function() {
        return this.getSlot('content').serialize();
    },
    */
    // pouziva se toto nekde?
    getTree: function() {
        // skip the outer layer...
        return this.getSlot('content').getTree();
    },
    /* ref decorator won't be editable */
    getTreeView: function(decorator) {
        // skip the outer layer...
        return this.getSlot('content').getTreeView(decorator);
    },
    _klass: "ref-decorator thing",
    _type: "ref-decorator",
    _defaults: {
        label: null,
        source: "http://www.google.com"
    },
    _schema: {
       "type":"object",
       "properties":{
          "label":{
             "type":"string",
             "required":false
          },
          "source":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }

});


var RefList = Thing.extend({
    init: function() {
      this.element.empty()
      this.element.append($("<p>").text(__("References")))
    },
    refresh: function() {
        this.base();
    },
    // refs = array of ref decorator objects
    setReferences: function(refs) {
      this.element.empty()
      this.element.append($("<p>").text(__("References")))
      var list = $("<ul>").appendTo(this.element)
      if(refs) {
        for(var i=0; i<refs.length; i++) {
          list.append(this.makeReference(refs[i], i))
        }
      } else {
        this.element.append($("<p>").text(__("No references found.")))
      }
    },
    makeReference: function(ref, index) {
      return $("<li>").append(
        $("<span>").addClass("ref-link").text(index+1),
        $("<span>").addClass("ref-label").text(ref.options.source)
      )
    },
    _klass: "ref-list thing",
    _type: "ref-list",
    _defaults: {
    },
    _schema: {
       "type":"object",
       "description":"References List properties",
       "properties":{
       },
       "additionalProperties":true
    }

});


var Ajax = Decorator.extend({
    init: function() {
        this.loaded($.noop);
        this.received(function(data) { return data; });
        this.transform(function(data) { return Thing.create(data); })
        this.base();
        this.reload();
    },
    reload: function() {
        var url = this.options.url;
        var self = this;
        if(url) {
            $.ajax({
              url: url,
              dataType: 'json',
              //data: data,
              success: function(data) {
                var thing = self.transform(self.received(data));
                self.setSlot('content', thing);
                self.loaded(thing);
              },
              error: function(jqXHR, textStatus, errorThrown) {
                // TODO dat tam misto toho chyb. panel
                alert("AJAX failed! "+textStatus);
              }
            });
        }
        if(this.options.reloadInterval) {
            var fun = function() { self.reload(); };
            setTimeout(fun, 1000*this.options.reloadInterval);
        }
    },
    loaded: function(arg) {
        if(typeof arg == 'function') {
            this.onloaded = arg;
        } else {
            return this.onloaded(arg);
        }
    },
    received: function(arg) {
        if(typeof arg == 'function') {
            this.onreceive = arg;
        } else {
            return this.onreceive(arg);
        }
    },
    transform: function(arg) {
        if(typeof arg == 'function') {
            this.ontransform = arg;
        } else {
            return this.ontransform(arg);
        }
    },
    _klass: "ajax thing",
    _type: "ajax",
    _defaults: {
        url: '', //"testing/thing.json",
        reloadInterval: 0 //60 // in seconds
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "reloadInterval": {
			    "type":"integer",
			    "required":true
		    },
		    "url": {
			    "type":"string",
			    "id": "url",
                "format": "uri",
			    "required":true
		    }
	    }
    }
});




var AjaxPager = Thing.extend({
    init: function() {
        var self = this;
        this.base();
        this.page = new Ajax();
        this.page.received(function(data) { return self._dataReceived(data);});
        this.page.transform(function(data) { return self._dataTransform(data);});
        this.page.loaded(function(ajax) {self._pageLoaded(ajax);});
        this.page.get().appendTo(this.element);
        this.createControls();
        this.setPage(this.options.page);
    },
    createControls: function() {
        this.pagerControls = $("<div>").addClass('pager-controls');
        if(!this.options.disablePagerControl) this.pagerControls.appendTo(this.element);
    },
    refreshView: function() {
        this.setPage(this.options.page);
    },
    setPage: function(num) {
        this.options.page = num;
        var url = null;
        if(this.options.page && this.options.baseUrl) {
            url = this.getPageUrl(this.options.page);
            this.page.options.url = url;
            this.page.reload();
        } else {
            // signal error
        }
    },
    getPageUrl: function(page) {
        return this.options.baseUrl + page + ".json";
    },
    // muzeme podedit pokud potrebujeme jine chovani, transformaci dat aj.
    _dataReceived: function(data) {
        return data;
    },
    _dataTransform: function(data) {
        return Thing.create(data);
    },
    _pageLoaded: function(ajax) {
        this.pagerControls.empty();
        if(ajax instanceof PageDecorator) {
            // rebuild page controls
            this._buildPageControls(ajax);
        }
    },
    _buildPageControls: function(paged) {
        // TODO udelat PagerControls jako Thing
        // stranky jsou cislovany od jedne, nejmensi cislo je 1
        var o = paged.options;
        if(o.pageNumber>1) {
            // add first link
            this.pagerControls.append(this._makePageLink(1, "first"));
        }
        if(o.pageNumber>1) {
            // add previous link
            this.pagerControls.append(this._makePageLink(o.pageNumber-1, "previous"));
        }
        this.pagerControls
            .append($("<span>").text(__("Page")+" "+o.pageNumber+" "+__("from")+" "+o.pagesTotal));        
        if(o.pageNumber<o.pagesTotal) {
            // add previous link
            this.pagerControls.append(this._makePageLink(o.pageNumber+1, "next"));
        }
        if(o.pageNumber<o.pagesTotal) {
            // add first link
            this.pagerControls.append(this._makePageLink(o.pagesTotal, "last"));
        }
    },
    _makePageLink: function(pageno, type) {
        var self = this;
        return $('<a href="#">').text(type).click(function() {
            self.setPage(pageno);
            return false;
        });
    },
    _klass: "ajax-pager thing",
    _type: "ajax-pager",
    _defaults: {
        baseUrl: '',// 'testing/multi/',
        page: 1,
        disablePagerControl: false
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "page": {
			    "type":"integer",
			    "required":true
		    },
		    "url": {
			    "type":"string",
			    "id": "url",
                "format": "uri",
			    "required":true
		    }
	    }
    }
});


var Layout = Thing.extend({
    _klass: "layout thing",
    _type: "layout"
});









var Slot = Base.extend({
    constructor: function(parent, name) {
        this.name = name;
        this.parent = parent;
        this.element = $("<div>").addClass("mykkro-slot").attr('data-name', name);
        this.thing = null;
    },
    empty: function() {
        this.element.empty();
        this.thing = null;
    },
    set: function(thing) {
        this.element.empty().append(thing.get());
        this.thing = thing;
    },
    get: function() {
        return this.thing;
    }
});


// TODO metody na prohazovani elementu - move to front/back, move up, move down
// TODO metody insert/delete?
// TODO -> DynamicLayout
var GrowableLayout = Layout.extend({
    init: function() {
        this.cells = []; // v tomto poradi budou v this.element!
        this.cellMap = {}; 
    },
    // remove all slots
    // TODO obsolete, use removeSlots instead
    clear: function() {
        this.element.empty();
        this.cells = [];
        this.cellMap = {};
    },
    length: function() {
        return this.cells.length;
    },
    first: function() {
        return this.cells.length ? this.cells[0] : undefined;
    },
    last: function() {
        return this.cells.length ? this.cells[this.cells.length-1] : undefined;
    },
    nth: function(ndx) {
        return (ndx>=0 && ndx<this.cells.length) ? this.cells[ndx] : undefined;
    },
    isEmpty: function() {
        return this.cells.length;
    },
    // dynamically add slot
    add: function(thing) {        
        var ndx = this.cells.length;
        var slot = new Slot(this, ndx);
        slot.element.appendTo(this.element);
        this.cells.push(slot);
        this.cellMap[ndx] = slot;
        this.setSlot(ndx, thing);
        return slot;
    },
    setSlot: function(key, value) {
        // TODO implement hasSlot
        this.base(key, value);
        this.cellMap[key].set(value);
        return this;
    },
    removeSlots: function() {
        // remove slot content...
        this.clearSlots(); 
        // remove slots proper...
        this.element.empty();
        this.slots = {};
        this.cells = [];
        this.cellMap = {};
    },
    setSlots: function(slots) {
        // remove existing slots...
        this.removeSlots();
        if(slots) {
            // pokud je parametr pole, udelat z nej objekt
            if($.isArray(slots)) slots = slots.toObject();
            for(var key in slots) {
                this.add(slots[key]);
            }
        }
    },
    _klass: "growable-layout layout thing",
    _type: "growable-layout",
    _defaults: {
        "css": "" //"mykkro-flow-layout"
    },
    _schema: {
       "type":"object",
       "properties":{
          "css":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }
});



// TODO metody na prohazovani elementu - move to front/back, move up, move down
// TODO metody insert/delete?
// TODO -> DynamicLayout
// TODO ze by se to poradi slotu dalo ulozit?
var OrderableLayout = GrowableLayout.extend({
    init: function() {
        this.cells = []; // v tomto poradi budou v this.element!
        this.cellMap = {}; 
    },
    // what muze byt Slot nebo Thing
    getSlotIndex: function(what) {
        if(what && typeof what === 'object') {
            for(var i=0; i<this.cells.length; i++) {
                if(this.cells[i] == what || this.cells[i].get() == what) return i;
            }
            return -1;
        } else {
            if(what>=0 && what < this.cells.length) return what;
            return -1;
        }
    },
    moveSlotUp: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>0) {
            // swap slots 'i-1' and 'i'
            this.swapSlots(slot-1, slot);
        }
    },
    moveSlotDown: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>=0 && slot<this.cells.length-1) {
            // swap slots 'i' and 'i+1'
            this.swapSlots(slot, slot+1);
        }
    },
    moveSlotToTop: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>0) {
            this.swapSlots(0, slot);
        }
    },
    moveSlotToBottom: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>=0 && slot<this.cells.length-1) {
            this.swapSlots(slot, this.cells.length-1);
        }
    },
    swapSlots: function(slot1, slot2) {
        slot1 = this.getSlotIndex(slot1);
        slot2 = this.getSlotIndex(slot2);
        if(slot1 != slot2) {
            // prohodit to v DOM...
            this.cells[slot1].element.swap(this.cells[slot2].element);
            var tmp = this.cells[slot1];
            this.cells[slot1] = this.cells[slot2];
            this.cells[slot2] = tmp;
        }
    },
    shuffle: function() {
        var len = this.cells.length;
        for (var i = len-1; i >=0; i--) {
            var randomIndex = Math.floor(Math.random()*(i+1)); 
            this.swapSlots(randomIndex, i);
        }
    },
    remove: function(what) {        
        var ndx = this.getSlotIndex(what);
        if(ndx>=0) {
            var slot = this.cells[ndx];
            this.cellMap[slot.name] = null;
            // remove from array
            this.cells.remove(ndx);
            // remove from DOM
            slot.element.remove();
            this.refresh();
        }
    },
    _klass: "orderable-layout growable-layout layout thing",
    _type: "orderable-layout",
    _defaults: {
        "css": "" //"mykkro-flow-layout"
    },
    _schema: {
       "type":"object",
       "properties":{
          "css":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }
});



var PreviewPager = AjaxPager.extend({
    constructor: function(options, callback) {
        this.base(options); // baseUrl, query, includePublic, allTags, disableSearchBox
        this.onselected = callback || $.noop;
    },
    createControls: function() {
        this.base();
        var self = this
        var changer = function() {
            self.refreshView()
        }
        this.searchBox = $('<input type="text" name="sf-text" class="search rounded" placeholder="Search...">').attr("value", this.options.query).on("change keyup paste", changer)
        this.publicCBox = $('<input type="checkbox" name="sf-public">').prop('checked', this.options.includePublic).change(changer)
        this.allCBox = $('<input type="checkbox" name="sf-all">').prop("checked", this.options.allTags).change(changer)
        if(!this.options.disableSearchBox) {
            var sc = $("<div>")
                .addClass('search-controls')
                .appendTo(this.element)
                .append(
                    $('<label>').append(this.searchBox), 
                    $('<label>').append(this.publicCBox, $('<span>Include public content</span>')),
                    $('<label>').append(this.allCBox, $('<span>Use all tags</span>'))
                );
        }
    },
    getPageUrl: function(page) {
        var text = encodeURIComponent(this.searchBox.val())
        var publ = this.publicCBox.is(':checked') ? 'true' : 'false'
        var all = this.allCBox.is(':checked') ? 'true' : 'false'
        return this.base(page) + "?public="+publ+"&text="+text+"&all="+all
    },
    _dataReceived: function(data) {
        return data;
    },
    _dataTransform: function(data) {
        var self = this;
        var ol = new OrderableLayout({"css":"mykkro-flow-layout"});
        for(var i=0; i<data.items.length; i++) {
            var thing = Thing.create(data.items[i].preview);
            var clickable = new Clickable({tooltip: data.items[i].title});
            clickable.setSlot('content', thing);
            (function() {
                var url = data.items[i].url;
                clickable.click(function() {
                    self._selected(url);
                });
/*
                // TODO settings - otevre formular
                // Thing ma definovane schema pro validaci options
                var st = makeSettingsToolbar(function(){
                    // change thing's settings
                    self._selected(url, true);
                });
                st.setSlot('content', clickable);
                ol.add(st);
*/
                ol.add(clickable);
            })();
        }
        var pd = new PageDecorator({
            'pageNumber': data.page,
            'pagesTotal' : data.pagesTotal,
            'recordsTotal' : data.itemsTotal            
        });
        pd.setSlot('content', ol);
        return pd;
    },
    _selected: function(url, editSettings) {
        var self = this;
         $.ajax({
              url: url,
              dataType: 'json',
              //data: data,
              success: function(data) {
                   console.log("Selected:")
                   console.log(data)
                  if(editSettings) {
                     // ziskat schema, zobrazit formular, nastavit data.options                    
                  }
                  var thing = Thing.create(data);
                  self.onselected(thing);
              }
          });
    },
    _type: "preview-pager"
}, {
    choose: function(type, callback, options) {
        options = options || {}
	    var mm = {};
        var url = baseUrl+'api/pagedpreviews/'+type+'/';
        var ap = new PreviewPager($.extend({baseUrl:url}, options), function(thing) { 
            mm.modal.close();
            if(callback) callback(thing);
        });
        /**/options.resizable = false/**/
        mm.modal = Modal.show(ap, options);
    }
});


// TODO vertical split
var SplitLayout = Layout.extend({
    init: function() {
        this.first = $("<div>");
        this.second = $("<div>");
        this.element.append(this.first).append(this.second);
        this.setSlot('first', Thing.empty());
        this.setSlot('second', Thing.empty());
    },
    // options changed...
    refresh: function() {
        this.base();
        var first = this.options.ratio + "%";
        var gap = this.options.gap + "%";
        var xx = (this.options.ratio + this.options.gap) + "%";
        var second = (100 - this.options.ratio - this.options.gap) + "%";
        if(this.options.horizontal) {
            this.first.css("left","0px").css("top","0px").css("width",first).css('height','100%');
            this.second.css("left",xx).css("top","0px").css("width",second).css('height','100%');
        } else {
            this.first.css("left","0px").css("top","0px").css("height",first).css('width','100%');
            this.second.css("left","0px").css("top",xx).css("height",second).css('width','100%');
        }
    },
    setSlot: function(key, value) {
        // TODO implement hasSlot
        this.base(key, value);
        if(key=='first') {
            this.first.empty().append(value.get());
        }
        if(key=='second') {
            this.second.empty().append(value.get());
        }
        return this;
    },
    _klass: "split-layout layout thing",
    _type: "split-layout",
    _defaults: {
        ratio: 70, // v %
        gap: 2, // v %
        horizontal: false
    },
    _schema: {
       "type":"object",
       "properties":{
          "horizontal":{
             "type":"boolean",
             "required":true
          },
          "ratio":{
             "type":"integer",
             "required":true
          },
          "gap":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});



var GridLayout = Layout.extend({
    init: function() {
        // TODO create grid and slots
        this.cellCount = 0;
        this.cells = {};
        for(var i=0; i<this.options.rows; i++) {
            for(var j=0; j<this.options.columns; j++) {
                // create slot
                this.cells[this.cellCount] = $("<div>").appendTo(this.element);                
                // set slot value
                this.setSlot(this.cellCount, Thing.empty());
                this.cellCount++;
            }
        }
    },
    // options changed...
    refresh: function() {
        this.base();
        var gap = this.options.gap;
        var cols = this.options.columns;
        var rows = this.options.rows;
        if(cols*rows != this.cellCount) {
          // resize grid...
          if(cols*rows < this.cellCount) {
            // truncate array...
            while(this.cellCount > rows*cols) {
                this.cellCount--;
                this.removeSlot(this.cellCount)
            }
          } else {
            // expand array by adding new elements
            while(this.cellCount<rows*cols) {
                // create slot
                this.cells[this.cellCount] = $("<div>").appendTo(this.element);                
                // set slot value
                this.setSlot(this.cellCount, Thing.empty());
                this.cellCount++;
            }
          }          
        }
        var ww = Math.round(10*(100 - (cols-1)*gap)/cols)/10;
        var hh = Math.round(10*(100 - (rows-1)*gap)/rows)/10;
        var xx = 0;
        var yy = 0;
        var ndx = 0;
        for(var i=0; i<rows; i++) {
            for(var j=0; j<cols; j++) {
                this.cells[ndx].css({
                    "width": ww+"%",
                    "height": hh+"%",
                    "left": xx+"%",
                    "top": yy+"%"
                });
                ndx++;
                xx += ww + gap;
            }
            xx = 0;
            yy += hh + gap;
        }
    },
    setSlot: function(key, value) {
        if(!!this.cells[key]) {
          this.base(key, value);
          this.cells[key].empty().append(value.get());
        }
        return this;
    },
    removeSlot: function(key) {
        if(this.hasSlot(key)) {
          this.cells[key].remove()
          delete this.cells[key]                
          this.base(key);
        }
    },
    _klass: "grid-layout layout thing",
    _type: "grid-layout",
    _defaults: {
        rows: 3, // nemelo by se menit za behu
        columns: 3, // nemelo by se menit za behu
        gap: 2 // v procentech
    },
    _schema: {
       "type":"object",
       "properties":{
          "rows":{
             "type":"integer",
             "required":true
          },
          "columns":{
             "type":"integer",
             "required":true
          },
          "gap":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});



var SwitchLayout = GrowableLayout.extend({
    refresh: function() {
        this.base();
        var index = parseInt(this.options.index)+1;
        this.element.children().hide();
        this.element.find("div:nth-child("+index+")").show();
    },
    setIndex: function(ndx) {
        this.options.index = ndx;
        this.refresh();
    },
    add: function(thing) {
        var slot = this.base(thing);
        this.refresh();
        return slot;
    },
    _klass: "switch-layout growable-layout layout thing",
    _type: "switch-layout",
    _defaults: {
        "css": "", //"mykkro-flow-layout"
        index: 0
    },
    _schema: {
       "type":"object",
       "properties":{
          "css":{
             "type":"string",
             "required":false
          },
          "index":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var Book = GrowableLayout.extend({
    currentPage: 0,
    init: function() {
        this.base();
        console.log("Book created")
        console.log(this)
    },
    refresh: function() {
        this.base();
    },
    // TODO tohle se muze zavolat jen pokud jsou stranky uz vlozena do DOMu
    makeDisplay: function() {
        var self = this;
	    // kniha = <div class="mykkro-book> <div class="mykkro-slot"> .. </div>
	    this.element.addClass(this.options.display);
	    switch(this.options.display) {
	      case 'basic':
	        // add page numbers...
	        break;
	      case "turnable":
	        this.element.turn({gradients: true, acceleration: true});
            this.element.bind("start", function(ev, pageObject, corner) { 
                self.onTurnStart(ev, pageObject, corner); })
            this.element.bind("turning", function(ev, page, pageObject) { 
                self.onTurning(ev, page, pageObject); })
            this.element.bind("turned", function(ev, page, view) { 
                self.onTurned(ev, page, view); })
            this.element.bind("end", function(ev, pageObject, turned) { 
                self.onTurnEnd(ev, pageObject, turned); })
	        break;
	    }
    },
    _setPage: function(page) {
        if(!this.currentPage) {
            // page 1 became visible
            this.onPageVisibilityChange(page, true);
        }
        else if(this.currentPage>>1 == page>>1) {
            // je videt porad stejna dvoustrana
        } else {            
            // visibility changed
            var oldPages = 2*(Math.floor(this.currentPage / 2));
            var newPages = 2*(Math.floor(page / 2));
            this.onPageVisibilityChange(oldPages, false);
            this.onPageVisibilityChange(oldPages+1, false);
            this.onPageVisibilityChange(newPages, true);
            this.onPageVisibilityChange(newPages+1, true);
        }
        this.currentPage = page;
        // notifikovat stranky pokud se jejich viditelnost zmenila
        this.onPageChange(page);
    },
    // TODO udelat si na to taky bind funkci
    onPageVisibilityChange: function(page, visible) {
        if(typeof(page)=='function') this._onPageVisibilityChange = page;  
        else {
            // mame takovou stranku?
            var name = page-1;
            if(this.slots[name]) {
                this._updatePageVisibility(page, visible);
                if(this._onPageVisibilityChange) this._onPageVisibilityChange(page, visible);
            }
        }
    },
    _updatePageVisibility: function(page, visible) {
        // pri zviditelneni musim refereshnout vsechny audio-decoratory a video-thingy
        // pri zneviditelneni vypnout jejich playback
        //log("Page: "+page+" visibility: "+visible);
        var name = page-1;
        var thing = this.slots[name];
        var media = [];
        thing.findSlotsByType('audio-decorator', media);
        thing.findSlotsByType('video-thing', media)
        //log(audio.length+","+video.length);
        if(visible) {
            // page became visible...
            for(var i=0; i<media.length; i++) {
                media[i].refresh();
                if(media[i].options['autoplay']) {
                    media[i].play();
                }
            }
        } else {
            // TODO stop only if playing...
            for(var i=0; i<media.length; i++) media[i]._kill();
        }
    },
    onPageChange: function(ev) {
        if(typeof(ev)=='function') this._onPageChange = ev;  
        else {
            if(this._onPageChange) this._onPageChange(ev);
        }
    },
    onInit: function(ev) {
        if(typeof(ev)=='function') this._onInit = ev;  
        else {
            this._setPage(1);
            if(this._onInit) this._onInit();
        }
    },
    onExit: function(ev) {
        if(typeof(ev)=='function') this._onExit = ev;  
        else {
            if(this._onExit) this._onExit();
        }
    },
    onTurnStart: function(ev, pageObject, corner) {
        if(typeof(ev)=='function') this._onTurnStart = ev;  
        else {
            if(this._onTurnStart) this._onTurnStart(ev, pageObject, corner);
        }
    }, 
    onTurning: function(ev, page, pageObject) {
        if(typeof(ev)=='function') this._onTurning = ev;  
        else {
            if(this._onTurning) this._onTurning(ev, page, pageObject);
        }
    }, 
    onTurned: function(ev, page, view) { 
        if(typeof(ev)=='function') this._onTurned = ev;  
        else {
            this._setPage(page);
            if(this._onTurned) this._onTurned(ev, page, view);
        }
    }, 
    onTurnEnd: function(ev, pageObject, turned) { // nefunguje
        if(typeof(ev)=='function') this._onTurnEnd = ev;  
        else {
            if(this._onTurnEnd) this._onTurnEnd(ev, pageObject, corner);
        }
    }, 
    _klass: "book growable-layout layout thing",
    _type: "book",
    _defaults: {
        "title": "My Book",
	    "display": "basic"
    },
    _schema: {
       "type":"object",
       "properties":{
          "title":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var Quest = Thing.extend({
    init: function() {
        this.status = 'active';
        this.finished($.noop);
    },
    refresh: function() {
        this.base();
        //this.inner.html(this.options.html).attr('class',this.options.innerCss);
    },
    finished: function(arg) {
        if(typeof arg == 'function') {
            this.onfinished = arg;
        } else {
            return this.onfinished(arg);
        }
    },
    pass: function() {
        this.status = 'passed';
        this.finished({'quest':this, 'status':this.status});
    },
    fail: function() {
        this.status = 'failed';
        this.finished({'quest':this, 'status':this.status});
    },
    _klass: "quest thing",
    _type: "quest",
    _defaults: {
        //html: ""
    },
    _schema: {
       "type":"object",
       "description":"Quest properties",
       "properties":{
/*
          "html":{
             "type":"string",
             "required":true
          },
          "css":{
             "type":"string",
             "required":false
          },
          "innerCss":{
             "type":"string",
             "required":false
          }
*/
       },
       "additionalProperties":true
    }

});

var DemoQuest = Quest.extend({
    init: function() {
        this.base();
        var self = this;
        this.passButton = $("<button>").text("Pass").click(function() { self.pass(); }).appendTo(this.element);
        this.failButton = $("<button>").text("Fail").click(function() { self.fail(); }).appendTo(this.element);
        this.statusBar = $("<span>").appendTo(this.element);
        this.statusBar.text('active');
    },
    pass: function() {
        this.statusBar.text('passed');
        this.passButton.prop('disabled', true);
        this.failButton.prop('disabled', true);
        this.base();
    },
    fail: function() {
        this.statusBar.text('failed');
        this.passButton.prop('disabled', true);
        this.failButton.prop('disabled', true);
        this.base();
    },
    _klass: "demo-quest quest thing",
    _type: "demo-quest",
    _defaults: {
        //html: ""
    },
    _schema: {
       "type":"object",
       "description":"Demo Quest properties",
       "properties":{
/*
          "html":{
             "type":"string",
             "required":true
          },
          "css":{
             "type":"string",
             "required":false
          },
          "innerCss":{
             "type":"string",
             "required":false
          }
*/
       },
       "additionalProperties":true
    }

});

var PlayerControls = Thing.extend({
    _onplay: $.noop,
    _onpause: $.noop,
    _onstop: $.noop,
    init: function() {
        var self = this;
        var cont = $("<div>").addClass('controls').appendTo(this.element);
        this._playBtn = $("<button>")
            .addClass("play").append($("<span>").text("Play"))
            .appendTo(cont).click(function() { self.onPlay(); });
        this._pauseBtn = $("<button>")
            .addClass("pause").append($("<span>").text("Pause"))
            .appendTo(cont).click(function() { self.onPause(); });
        this._stopBtn = $("<button>")
            .addClass("stop").append($("<span>").text("Stop"))
            .appendTo(cont).click(function() { self.onStop(); });
        this.controls = cont;
        this.playing = false;
        this.paused = false;
    },
    refresh: function() {
        this.base();
        this.controls.toggleClass('playing', this.playing);
        this._playBtn.prop('disabled', this.playing);
        this._pauseBtn.prop('disabled', !this.playing);
        this._stopBtn.prop('disabled', !(this.playing/* || this.paused*/));    
        if(this.playing) {
            this._playBtn.hide();
            this._pauseBtn.show();
        } else {
            this._playBtn.show();
            this._pauseBtn.hide();
        }        
        if(this.playing/* || this.paused*/) {
            this._stopBtn.show();
        } else {
            this._stopBtn.hide();
        }
    },
    updateGui: function(playing, paused) {
        this.playing = playing;
        this.paused = paused;
        this.refresh();
    },
    onPlay: function(kb) {
        if(typeof kb == 'function') {
            this._onplay = kb;
        } else {
            this.updateGui(true, false);
            this._onplay(kb);
        }
    },
    onPause: function(kb) {
        if(typeof kb == 'function') {
            this._onpause = kb;
        } else {
            this.updateGui(false, true);
            this._onpause(kb);
        }
    },
    onStop: function(kb) {
        if(typeof kb == 'function') {
            this._onstop = kb;
        } else {
            this.updateGui(false, false);
            this._onstop(kb);
        }
    },
    _klass: "player-controls thing",
    _type: "player-controls",
    _defaults: {
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
	    }
    }
});


var AudioDecorator = Thing.extend({
    _onplay: $.noop,
    _onpause: $.noop,
    _onstop: $.noop,
    _onkill: $.noop,
    onPlay: function(kb) {
        if(typeof kb == 'function') {
            this._onplay = kb;
        } else {
            this._onplay(kb);
        }
    },
    onPause: function(kb) {
        if(typeof kb == 'function') {
            this._onpause = kb;
        } else {
            this._onpause(kb);
        }
    },
    onStop: function(kb) {
        if(typeof kb == 'function') {
            this._onstop = kb;
        } else {
            this._onstop(kb);
        }
    },
    onKill: function(kb) {
        if(typeof kb == 'function') {
            this._onkill = kb;
        } else {
            this._onkill(kb);
        }
    },
    init: function() {
        this.slot = $("<div>").addClass("slot");
        this.setSlot('content', Thing.empty());
    },
    play: function() {
        this._play();
        this.player.updateGui(true, false);
    },
    _play: function() {
        this.audio.get(0).play();
        this.onPlay();
    },
    _pause: function() {
        this.audio.get(0).pause();
        this.onPause();
    },
    _stop: function() {
        // regenerate player...
        this.refresh();
        this.onStop();
    },
    _kill: function() {
        this.audio.get(0).pause();
        this.audio.get(0).src = "";
        this.onKill();
    },
    _setVolume: function(vol) {
        // HTML5 volume is between 0 and 1
        this.audio.get(0).volume = vol / 100.0;
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.slot.html(value.get());
        return this;
    },
    _addSource: function(uri, type) {
        if(uri) $("<source>").attr({src:uri, type: type, preload: false/**/}).appendTo(this.audio);
    },
    refresh: function() {
        this.base();
        var self = this;
        this.audio = $("<audio>");
        this.player = new PlayerControls();  
        this.player.onPlay(function() { self._play(); });
        this.player.onPause(function() { self._pause(); });
        this.player.onStop(function() { self._stop(); });
        var cc = new CenteringDecorator({},{content: this.player});
        this.pane = cc.get();
        this.pane.addClass("player");
        this.element.empty()
            .append(this.slot)
            .append(this.pane)
            .append(this.audio);

        // incorrect... and unnecessary: this.audio.remove("source");
        this.audio.prop('loop', this.options.loop);
        if(this.options.uri) {            
            var ext = this.options.uri.split('.').pop();
            this.options.ogg = (ext == 'ogg') ? this.options.uri : '';
            this.options.mp3 = (ext == 'mp3') ? this.options.uri : '';
        }
        this._addSource(this.options.ogg, 'audio/ogg; codecs="vorbis"');
        this._addSource(this.options.mp3, 'audio/mpeg; codecs="mp3"');
        // HTML5 volume is between 0 and 1
        this._setVolume(this.options.volume);
    },
    _klass: "audio-decorator decorator thing",
    _type: "audio-decorator",
    _defaults: {
        'ogg': "",
        'mp3': "",
        'uri': "",
        'autoplay': false,
        'loop': false,
        'volume': 50
    },
    _schema: {
       "type":"object",
       "properties":{
          "uri":{
             "type":"string",
             "format": "my-voice-uri",
            // TODO vadi mu kdyz je to false - option se neda rozkliknout
             "required":true
          },
          "volume":{
             "type":"integer",
             "required":true // TODO
          },
          "autoplay":{
             "type":"boolean",
             "required":true // TODO
          },
          "loop":{
             "type":"boolean",
             "required":true // TODO
          }
       },
       "additionalProperties":true
    }
});



var VideoThing = Thing.extend({
    _onplay: $.noop,
    _onpause: $.noop,
    _onstop: $.noop,
    _onkill: $.noop,
    onPlay: function(kb) {
        if(typeof kb == 'function') {
            this._onplay = kb;
        } else {
            this._onplay(kb);
        }
    },
    onPause: function(kb) {
        if(typeof kb == 'function') {
            this._onpause = kb;
        } else {
            this._onpause(kb);
        }
    },
    onStop: function(kb) {
        if(typeof kb == 'function') {
            this._onstop = kb;
        } else {
            this._onstop(kb);
        }
    },
    onKill: function(kb) {
        if(typeof kb == 'function') {
            this._onkill = kb;
        } else {
            this._onkill(kb);
        }
    },
    init: function() {
    },
    play: function() {
        this._play();
        this.player.updateGui(true, false);
    },
    _play: function() {
        this.video.get(0).play();
        this.onPlay();
    },
    _pause: function() {
        this.video.get(0).pause();
        this.onPause();
    },
    _stop: function() {
        //this.video.get(0).pause();
        //this.video.get(0).currentTime = 0;
        // regenerate player...
        this.refresh();  // TODO udelat to lepe
        this.onStop();
    },
    _kill: function() {
        this.video.get(0).pause();
        this.video.get(0).src = "";
        this.onKill();
    },
    _setVolume: function(vol) {
        // HTML5 volume is between 0 and 1
        this.video.get(0).volume = vol / 100.0;
    },
    _addSource: function(uri, type) {
        if(uri) {
            $("<source>").attr({src:uri, type: type, preload: false/**/}).appendTo(this.video);
        }
    },
    refresh: function() {
        this.base();
        var self = this;
        this.video = $("<video>");
        this.player = new PlayerControls();  
        this.player.onPlay(function() { self._play(); });
        this.player.onPause(function() { self._pause(); });
        this.player.onStop(function() { self._stop(); });
        var cc = new CenteringDecorator({},{content: this.player});
        this.pane = cc.get();
        this.pane.addClass("player");
        this.element.empty()
            .append(this.video)
            .append(this.pane);

        this.video.prop('loop', this.options.loop);
        if(this.options.uri) {            
            var ext = this.options.uri.split('.').pop();
            this.options.ogg = (ext == 'ogg' || ext == 'ogv') ? this.options.uri : '';
            this.options.mp4 = (ext == 'mp4') ? this.options.uri : '';
            this.options.webm = (ext == 'webm') ? this.options.uri : '';
        }
        this._addSource(this.options.ogg, 'video/ogg; codecs="theora, vorbis"');
        this._addSource(this.options.mp4, 'video/mp4; codecs="avc1.42E01E, mp4a.40.2"');
        this._addSource(this.options.webm, 'video/webm; codecs="vp8, vorbis"');
        ////this.video.get(0).src = this.options.uri;
        // TODO tohle nejak zlobi v Chrome, pri znovuvytvareni videi... ale ve FF to zda se funguje

        // HTML5 volume is between 0 and 1
        this._setVolume(this.options.volume);
        this.video.on('canplay canplaythrough', function(){
            console.log('canplay event fired');
        });
    },
    _klass: "video-thing thing",
    _type: "video-thing",
    _defaults: {
        "uri": "",
        'ogg': "",
        'mp4': "",
        'webm': "",
        'autoplay': false,
        'loop': false,
        'volume': 50
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "uri": {
			    "type":"string",
                "format": "my-video-uri",
			    "required":true
    	    },
            "volume":{
                "type":"integer",
                "required":true // TODO
            },
            "autoplay":{
                "type":"boolean",
                "required":true // TODO
            },
            "loop":{
                "type":"boolean",
                "required":true // TODO
            }
	    }
    }

});


/*

document.addEventListener('DOMContentLoaded', function(){
    var v = document.getElementById('vid');
    var canvas = document.getElementById('canvas');
    var context = canvas.getContext('2d');

    var cw = canvas.clientWidth;
    var ch = canvas.clientHeight;
    canvas.width = cw;
    canvas.height = ch;

    v.addEventListener('play', function(){
        draw(this,context);
    },false);

},false);

var mode = 'stretch';
function draw(v,c) {
    var canvas = document.getElementById('canvas');
    var w = canvas.clientWidth;
    var h = canvas.clientHeight;
    if(v.paused || v.ended) return false;
    if(mode == 'stretch') {
        c.drawImage(v,0,0,w,h); //-> stretch
    } else if(mode == 'cover') {
        // TODO tady je neco spatne
        var sx=0, sy=0, sw=v.width, sh=v.height;
        if(sw/sh < w/h) {
            sy = (sh - h*sw/w)/2;
            sh = h*sw/w;
        } else {
            sx = (sw - w*sh/h)/2;
            sw = w*sh/h;
        }
        c.drawImage(v,sx,sy,sw,sh,0,0,w,h); 
    } else { // contain
        var ww = v.width;
        var hh = v.height;
        var x = y = 0;
        if(ww/hh < w/h) {
            x = (w-ww*h/hh)/2;
            c.drawImage(v,x,0,ww*h/hh,h); 
        } else {
            y = (h-hh*w/ww)/2;
            c.drawImage(v,0,y,w,hh*w/ww); 
        }
    }
    setTimeout(draw,20,v,c);
}

<canvas id="canvas"></canvas>

*/

// TODO udelat z toho Thing
// TODO k ikonam pridat tooltipy

var BookViewer = Base.extend({
    constructor: function(options) {
        this.bookData = options.data;
        this.bookUrl = options.url;
        this.eventUrl = options.eventUrl;
        this.fullscreen = options.fullscreen;
        this.logger = options.logger;
        this.defaultWidth = 920;
        this.defaultHeight = 600;
        this.tools = {};
        this.bookContent = null;
        this.eventHistory = [];
        this.targetDiv = "#content"
    },
    makeIcon: function(icon, title) {
        return $("<div>").addClass('icon icon-48 icon-'+icon).css('display','inline-block').attr("title", title);
    },
    makeTool: function(icon, label, left/*bool*/, top, click) {
        this.tools[icon] = this.makeIcon(icon, label).css({position:'absolute', top: top}).css(left ? {'left':'6px'}:{'right':'6px'}).click(click).appendTo($("#book-wrapper"));
        return this.tools[icon];
    },
    showIcon: function(icon, enable) {
        if(enable) this.tools[icon].show() ; else this.tools[icon].hide();
    },
    turnNext: function() {
        this.bookContent.get().turn("next");
    },
    turnPrevious: function() {
        this.bookContent.get().turn("previous");
    },
    turnFirst: function() {
        this.bookContent.get().turn("page", 1);
    },
    goHome: function() {
        this.logEvent('book_close', this.bookUrl);
        window.location.href = this.bookUrl;
    },
    // v Chrome to nejak nefunguje...
    close: function() {
        this.logEvent('book_close', this.bookUrl);
        window.open('','_self','');
        window.close();
    },
    closeBook: function() {
        // normal viewer only turns to page 1
        this.turnFirst()
    },
    _setPageBackgrounds: function(bookContent, o) {
        var totalPages = bookContent.length()
        for(var i=0; i<totalPages; i++) {
            var slot = bookContent.nth(i)
            var elem = slot.element
            var css = { "background-size": "cover", "background-color": "white"}
            if(i==0) {
                // first page
                css["background-image"] = 'url('+o.frontpage_image_url+')'
            } else if(i == totalPages-1 && i%2!=0) {
                // last page, must be odd
                css["background-image"] = 'url('+o.backpage_image_url+')'
            } else if(i%2==0) {
                // even page
                css["background-image"] = 'url('+o.evenpage_image_url+')'
            } else {
                // odd page
                css["background-image"] = 'url('+o.oddpage_image_url+')'
            }
            elem.css(css)
        }
    },
    _makeWrapper: function(o) {
        return $("<div>")
            .attr("id", "book-wrapper")
            .css('position','relative')
            .css("background-image", 'url('+o.background_image_url+')')
    },
    _makeReferences: function(bookContent) {
        // gather references...
        var refs = [];
        bookContent.findSlotsByType('ref-decorator', refs);
        for(var i=0; i<refs.length; i++) {
            refs[i].options.label = (i+1)+""
            refs[i].refresh()
        }
        // TODO find reference-page layout and fill it by reference info...
        var reflists = [];
        bookContent.findSlotsByType('ref-list', reflists);
        // only the first will be used; later: we can split reference items into multiple ref lists
        if(reflists.length>0) {
            reflists[0].setReferences(refs);
        }
    },
    _monitorMediaEvents: function(bookContent) {
        // find audio and video Things and monitor their play, stop, pause, kill events
        var media = [];
        var self = this;
        bookContent.findSlotsByType('audio-decorator', media);
        bookContent.findSlotsByType('video-thing', media);
        for(var i=0; i<media.length; i++) {
            var m = media[i]; 
            var src = m.options.uri;           
            (function(){
                m.onPlay(function() { self.logEvent('book_media_play', src); });
                m.onPause(function() { self.logEvent('book_media_pause', src); });
                m.onStop(function() { self.logEvent('book_media_stop', src); });
                m.onKill(function() { self.logEvent('book_media_kill', src); });
            })();
        }
    },
    init: function() {
        /* display book... */
        var self = this;
        var width = this.defaultWidth;
        var height = this.defaultHeight;
        var o = this.bookData.options      
        // create wrapper...
        var wrapper = this._makeWrapper(o);
        wrapper.appendTo(this.targetDiv);
        this.bookContent = Thing.create(this.bookData, {"display":"turnable"});

        this._setPageBackgrounds(this.bookContent, o)
        this._makeReferences(this.bookContent)
        this._monitorMediaEvents(this.bookContent)
        
        // init book...
        this.bookContent.onInit();
        $("#book-wrapper").css({width:width+"px", height:height+"px"}).html(this.bookContent.get());
        this.bookContent.makeDisplay();

        // events...
        $(window).unload(function() {
            self.bookContent.onExit(); // TODO tohle mi nejak nefunguje...
        });
        $(window).resize(function() {
            if(self.fullscreen) {
                self.updateToolbar(self.recreate());
            }
        });
        $(window).bind("fullscreen-toggle", function(e, state) {
            self.setFullscreen(state);
        });
        this.bookContent.get().bind("turned", function(event, page, view) {
            self.updateToolbar();
            self.logEvent('book_page_turn', self.bookUrl, self.bookContent.get().turn("page"));
        });
        this.makeTool('turn-right', __('Previous page'), true, '50%', function() { self.turnPrevious();});
        this.makeTool('turn-left', __('Next page'), false, '50%', function() { self.turnNext();});
        this.makeTool('closebook', __('Close book'), false, '16px', function() { self.closeBook();});
        // reduce close icon in size...
        this.tools['closebook'].css({top: '16px', width: "24px", height: "24px"});

        // update icons...
        $("#book-wrapper >.icon-turn-left").css("background-image", 'url('+o.turnleft_image_url+')')
        $("#book-wrapper >.icon-turn-right").css("background-image", 'url('+o.turnright_image_url+')')

        this.updateToolbar();
        this.logEvent('book_open', this.bookUrl);
    },
    logEvent: function(type, src, data) {
        var timestamp = Math.floor(new Date().getTime() / 1000);
        this.logSingleEvent({"type":type,"src":src,"data":data,"timestamp":timestamp});
        if(type == 'book_close') {  
            // flush events...
            this.flushEventLog();
        }
    },
    logSingleEvent: function(evt) {
        if(this.logger) {
            this.logger(evt)
        }
        this.eventHistory.push(evt);
        if(this.eventUrl) {
            Common.postJsonData(this.eventUrl+".json", evt);
        }
    },
    flushEventLog: function() {
        // TODO odesilat eventy pres AJAX
        console.log(JSON.stringify(this.eventHistory, null, 4));
    },
    setFullscreen: function(full) {
        this.fullscreen = full;
        this.bookContent.get().turn('disable', true);
        if(this.fullscreen) {
            $("#book-wrapper").appendTo($("#fullscreen"));
            $("#container").hide();
            $("#fullscreen").show();            
        } else {
            $("#book-wrapper").appendTo($("#content"));
            $("#container").show();
            $("#fullscreen").hide();

        }
        this.bookContent.get().turn('disable', false);
        this.updateToolbar(this.recreate());
        this.logEvent('book_fullscreen', this.bookUrl, full);
        return full;    
    },
    recreate: function() {
        var width = this.defaultWidth;
        var height = this.defaultHeight;
        // kniha je velka 800x560 - pomer stran cca 1:sqrt(2) ~ 1:1.428
        if(this.fullscreen) {
            var ww = $(window).width();
            var hh = $(window).height();
            var scaleFactor = ww/width;
            var scaleFactor2 = hh/height;
            var scale = Math.min(scaleFactor, scaleFactor2);
            width = /*Math.floor(width*scale);*/ww;
            height = /*Math.floor(height*scale);*/hh;
        } 
        // resize wrapper and pages...
        $("#book-wrapper").css({width:width+"px", height:height+"px"});
        if(this.fullscreen) {
            // na okrajich musi zbyt 8% mista; to odpovida 60px 
            var sidex = Math.max(Math.floor(width*0.08), 60);
            var newWidth = width - 2*sidex;
            var newHeight = Math.floor(newWidth/1.428);
            var maxHeight = height-40;
            if(newHeight > maxHeight) {
                newWidth = Math.floor(newWidth*maxHeight/newHeight);
                newHeight = maxHeight;
            }
        } else {
            var newWidth = width - 120;
            var newHeight = height - 40;
        }
        this.bookContent.get().turn('size', newWidth, newHeight);
        return newWidth;
    },
    updateToolbar: function(gapWidth) {
        var page = this.bookContent.get().turn("page");
        var pages = this.bookContent.get().turn("pages");
        this.showIcon('turn-right', page>1);
        this.showIcon('turn-left', page<(pages-pages%2)); // kdyz ma kniha 3 strany, uz nejde druha otocit
        //this.showIcon('fullscreen-on', !this.fullscreen);
        //this.showIcon('fullscreen-off', this.fullscreen);
        
        if(gapWidth) {
            var gapSize = 60;
            if(this.fullscreen) {
                gapSize += Math.floor(($("#book-wrapper").width() - gapWidth)/2);
            }
            var hh = this.bookContent.get().height();
            var iconSize = Math.min(gapSize - 12, 240);
            var iconSizeHalf = Math.floor(iconSize/2);
            var hh2 = Math.max(Math.floor(hh/2-iconSize/2), 28+3*iconSize);
            this.tools['turn-right'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['turn-left'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            //this.tools['fullscreen-on'].css({top: (20+iconSize)+'px', width: iconSize+"px", height: iconSize+"px"});
            //this.tools['fullscreen-off'].css({top: (20+iconSize)+'px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['closebook'].css({top: '16px', width: iconSizeHalf+"px", height: iconSizeHalf+"px"});
            //if(this.bookUrl) this.tools['home'].css({top: '16px', width: iconSize+"px", height: iconSize+"px"});
        }
    }
});

var ExportBookViewer = BookViewer.extend({
    constructor: function(options) {
        this.base(options);
        this.targetDiv = "#fullscreen"
    },
    init: function() {
        this.base()
        this.setFullscreen(true);
    },
    closeBook: function() {
        // export viewer closes the book
        this.close()
    },
    updateToolbar: function(gapWidth) {
        var page = this.bookContent.get().turn("page");
        var pages = this.bookContent.get().turn("pages");
        this.showIcon('turn-right', page>1);
        this.showIcon('turn-left', page<(pages-pages%2)); // kdyz ma kniha 3 strany, uz nejde druha otocit

        if(gapWidth) {
            var gapSize = 60;
            if(this.fullscreen) {
                gapSize += Math.floor(($("#book-wrapper").width() - gapWidth)/2);
            }
            var hh = this.bookContent.get().height();
            var iconSize = Math.min(gapSize - 12, 240);
            var iconSizeHalf = Math.floor(iconSize/2);
            var hh2 = Math.max(Math.floor(hh/2-iconSize/2), 28+2*iconSize);
            this.tools['turn-right'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['turn-left'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['closebook'].css({top: '16px', width: iconSizeHalf+"px", height: iconSizeHalf+"px"});
        }
    },
    setFullscreen: function(full) {
        this.fullscreen = full;
        this.updateToolbar(this.recreate());
        this.logEvent('book_fullscreen', this.bookUrl, full);
        return full;    
    }
});



$.tubeplayer.defaults.afterReady = function($player) {
    console.log($player)
    // TODO resize only single player
	$(".tubeplayer-wrapper").resize()
}

var TubeplayerThing = Thing.extend({
    _onplay: $.noop,
    _onpause: $.noop,
    _onstop: $.noop,
    _onkill: $.noop,
    onPlay: function(kb) {
        if(typeof kb == 'function') {
            this._onplay = kb;
        } else {
            this._onplay(kb);
        }
    },
    onPause: function(kb) {
        if(typeof kb == 'function') {
            this._onpause = kb;
        } else {
            this._onpause(kb);
        }
    },
    onStop: function(kb) {
        if(typeof kb == 'function') {
            this._onstop = kb;
        } else {
            this._onstop(kb);
        }
    },
    onKill: function(kb) {
        if(typeof kb == 'function') {
            this._onkill = kb;
        } else {
            this._onkill(kb);
        }
    },
    thumbnailUrl: function() {
        return $.jYoutube(this.options.name, 'small');
    },
    init: function() {
    	this.wrapper = $("<div>").addClass("tubeplayer-wrapper")
        this.glasspane = $("<div>").addClass("tubeplayer-glasspane")        
        var self = this
		self.wrapper.resize(function(e) {
			console.log("Resizing! width="+self.wrapper.width()+", height="+self.wrapper.height())
			self.adjustPlayerSize()
		})        
		console.log("Initialized!")
    },
    play: function() {
        this._play();
    },
    _play: function() {
        this.player.tubeplayer("play")
        this.onPlay();
    },
    _pause: function() {
        this.player.tubeplayer("pause")
        this.onPause();
    },
    _stop: function() {
        this.player.tubeplayer("stop")
        this.onStop();
    },
    _kill: function() {
        this.player.tubeplayer("destroy")
        this.player.remove()
        this.player = null
        this.onKill();
    },
    _setVolume: function(vol) {
        this.player.tubeplayer("volume", vol)
    },
    adjustPlayerSize: function() {
    	var self = this    	
    	console.log("Adjusting player size! width="+self.wrapper.width()+", height="+self.wrapper.height())
        self.player.tubeplayer("size", {
			width: self.wrapper.width(), 
			height: self.wrapper.height()
		})
    },
    refresh: function() {
        this.base();
        if(this.player) {
            //this.player.tubeplayer("destroy")
            this.player.remove()
            this.player = null
        }
        this.player = $("<div>").addClass("tubeplayer-container")
        this.element.html(this.wrapper.empty().append(
            this.player
            // this.glasspane
        ))
        var self = this;
        var o = self.options
		self.player.tubeplayer({
			allowFullScreen: false,
			autoPlay: false,
			showControls: 0,
            initialVideo: o.name,
            preferredQuality: o.quality,
            autoPlay: o.autoplay,
            onPlayerUnstarted: function(){},
			onPlay: function(id){}, // after the play method is called
			onPause: function(){}, // after the pause method is called
			onStop: function(){}, // after the player is stopped
			onSeek: function(time){}, // after the video has been seeked to a defined point
			onMute: function(){}, // after the player is muted
			onUnMute: function(){} // after the player is unmuted
		})		
        // console.log(self.player.tubeplayer("player"))
        self._setVolume(o.volume)
    },
    _klass: "tubeplayer-thing thing",
    _type: "tubeplayer-thing",
    _defaults: {
        "name": "ydRAb9cwHnA",
        'quality': "default",
        'autoplay': false,
        'loop': false,
        'volume': 50
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "name": {
			    "type":"string",
                "format": "string",
			    "required":true
    	    },
		    "quality": {
			    "type":"string",
                "format": "string",
			    "required":true
    	    },
            "volume":{
                "type":"integer",
                "required":true // TODO
            },
            "autoplay":{
                "type":"boolean",
                "required":true // TODO
            },
            "loop":{
                "type":"boolean",
                "required":true // TODO
            }
	    }
    }

});

// uses: jquery, common, base

// tohle projde markup a vytvori widgety tam kde jsou na to pripravena data
// widget ma serverovou cast/sablonu a JS na klientovi ktery z toho muze vyrobit
// treba graficky editor nebo embedded SVG

function valueDecode(value) {
    if((/^!/).test(value)) {
        // je to bud base64 nebo to zacina vykricnikem
        value = value.substring(1);
        if(!(/^!/).test(value)) {
            // je to base64
            value = JSON.parse(utf8_decode(base64_decode(value)));
        } else {
            value = html_decode(value);
        }
    } else {
        value = html_decode(value);
    }
    return value;
}

function valueEncode(value) {
    if(jQuery.isPlainObject(value)) {
        return '!' + base64_encode(utf8_encode(JSON.stringify(value)));
    } else {
        var out = html_encode(value);
        if(out.startsWith('!')) out = "!" + out;
    }
    return out;
}

function widgetize(what) {
    what.reverse().each(function() {
        var self = $(this);        
        // find the widget class...
        var csss = self.attr("class").split(" ");
        for(var i=0; i<csss.length; i++) {
            // je to widget?
            if(csss[i].endsWith("-widget")) {
                var widgetClass = csss[i].replace(/-widget$/, "");
                // gather all data-attributes
                var data = self.data();        
                for(var key in data) {
                    var value = data[key];
                    data[key] = valueDecode(data[key]);
                    self.data(key, data[key]);
                }
                // vytvorime widget - zavolame JS/jQuery plugin a predame mu parametry v data
                console.log(data)
                self[widgetClass](data);
                break;
            }
        }
    });
}


var Widget = Base.extend({
    constructor: function(element, options) {
        this.element = element;
        this.options = $.extend({}, options);
        // promenne widgetu...
        this.wid = Widget.getUniqueId();
        this.element.data('wid', this.wid);
        Widget.cache[this.wid] = this;
    },
    init: function() {
        // inicializace ramce pro widget (toho co se nemeni)
    },
    refresh: function() {
        // volat pokazde pokud se zmeni data
    },
    destroy: function() {
        // uvedeni widgetu do puvodniho stavu
    }
},{
    wid: 1,
    getUniqueId: function() {
        return 'widget'+Widget.wid++;
    },
    cache: {}
});







var ThingWidget = Widget.extend({
    init: function() {
        var self = this;
        var def = this.options.def;
        if(def) {
            var thing = Thing.create(def);
            this.element.empty().append(thing.get());
        }
        self.refresh();
    },
    refresh: function() {
    }
});

// widgety...
(function($){

    var defaultOptions = { def: { type: "empty" } };

    var methods = {
        init : function(options) {
            var settings = $.extend({}, defaultOptions, options);
            return this.each(function() {
                var $this = $(this);
                var widget = new ThingWidget($this, settings);
                widget.init();
            });
        }
    };

    $.fn.thing = function(methodOrOptions) {
        if ( methods[methodOrOptions] ) {
            return methods[ methodOrOptions ].apply( this, Array.prototype.slice.call( arguments, 1 ));
        } else if ( typeof methodOrOptions === 'object' || ! methodOrOptions ) {
            // Default to "init"
            return methods.init.apply( this, arguments );
        } else {
            $.error( 'Method ' +  method + ' does not exist on jQuery.thing' );
        }    
    };

})(jQuery);


// TODO rozeznavani 'media' podle pripony

var _audioPlayerIndex = 1;
var makeAudioPlayer = function(parent, media) {
    var id = _audioPlayerIndex++;
    var playerId = 'jquery_cplayer_'+id;
    var containerId = 'cp_container_'+id;
    var html = $.render.circlePlayer({playerId: playerId, containerId: containerId});
    var div = $("<div>").html(html);
    parent.append(div);
    // ensure that player div is at the root of body
    $("#"+playerId).appendTo($("body"));

	var myCirclePlayer = new CirclePlayer("#"+playerId, media, {
		cssSelectorAncestor: "#"+containerId
	});
    return div;
};

var _videoPlayerIndex = 1;
var makeVideoPlayer = function(parent, media) {
    var id = _videoPlayerIndex++;
    var playerId = 'jquery_jplayer_'+id;
    var containerId = 'jp_container_'+id;
    var html = $.render.videoPlayer({playerId: playerId, containerId: containerId});
    var div = $("<div>").html(html).appendTo(parent);
    $("#"+playerId).jPlayer({
        ready: function () {
          $(this).jPlayer("setMedia", media);
        },
        swfPath: "/js",
        supplied: "m4v, ogv",
        cssSelectorAncestor: "#"+containerId
    });    
    return div;
};

// initialization...
$(document).ready(function() {

    // widgetizer...
    widgetize($(".widget"));

});
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: TZ-DON-Buch_Iran\book.json
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\TZ-DON-Buch_Iran\book.json
VELIKOST: 11126 B (10.87 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
{"type":"book","options":[],"slots":[{"type":"background-decorator","options":{"image":"images\/55\/bookJacket_Persien_F_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":19,"left":28,"right":22,"bottom":94},"slots":{"content":{"type":"split-layout","options":{"ratio":65,"gap":2,"horizontal":false},"slots":{"first":{"type":"imager","options":{"url":"images\/57\/Titel_IranischeKultur_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"contain"}},"second":{"type":"text-thing","options":{"html":"Iranische Kultur","css":"","h-align":"center","v-align":"center","font-size":"75%","font-family":"Times New Roman,Times,serif"}}}}}}}},{"type":"background-decorator","options":{"image":"images\/20\/Page_sL_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"imager","options":{"url":"images\/38\/PERSIEN_RUNDREISE_ORT4_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"background-decorator","options":{"image":"images\/21\/Page_sR_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"split-layout","options":{"ratio":65,"gap":2,"horizontal":false},"slots":{"first":{"type":"video-thing","options":{"uri":"videos\/24\/Asil_Music_03_original.webm","ogg":"","mp4":"","webm":"videos\/24\/Asil_Music_03_original.webm","autoplay":true,"loop":false,"volume":50}},"second":{"type":"imager","options":{"url":"images\/32\/asil_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}}}},{"type":"background-decorator","options":{"image":"images\/20\/Page_sL_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"grid-layout","options":{"rows":2,"columns":2,"gap":2},"slots":[{"type":"video-thing","options":{"uri":"videos\/21\/delkesh_delkash_omide_janem_youtube_original_original.webm","ogg":"","mp4":"","webm":"videos\/21\/delkesh_delkash_omide_janem_youtube_original_original.webm","autoplay":true,"loop":false,"volume":50}},{"type":"video-thing","options":{"uri":"videos\/20\/Delkash_Ashegham_man_original.webm","ogg":"","mp4":"","webm":"videos\/20\/Delkash_Ashegham_man_original.webm","autoplay":false,"loop":false,"volume":50}},{"type":"video-thing","options":{"uri":"videos\/19\/Delkash_Larzoon_Larzoon_original.webm","ogg":"","mp4":"","webm":"videos\/19\/Delkash_Larzoon_Larzoon_original.webm","autoplay":false,"loop":false,"volume":50}},{"type":"video-thing","options":{"uri":"videos\/18\/delkash_be_sarayam_amad_kolbeh_man_original.webm","ogg":"","mp4":"","webm":"videos\/18\/delkash_be_sarayam_amad_kolbeh_man_original.webm","autoplay":false,"loop":false,"volume":50}}]}}}}},{"type":"background-decorator","options":{"image":"images\/21\/Page_sR_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"grid-layout","options":{"rows":2,"columns":2,"gap":2},"slots":[{"type":"imager","options":{"url":"images\/42\/persien_teppich_01_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}},{"type":"imager","options":{"url":"images\/23\/persien_teppich_04_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"contain"}},{"type":"imager","options":{"url":"images\/22\/persien_teppich_02_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}},{"type":"imager","options":{"url":"images\/24\/persien_teppich_03_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}]}}}}},{"type":"background-decorator","options":{"image":"images\/20\/Page_sL_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"imager","options":{"url":"images\/44\/52148413_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"background-decorator","options":{"image":"images\/21\/Page_sR_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"imager","options":{"url":"images\/45\/Bild19609_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"background-decorator","options":{"image":"images\/20\/Page_sL_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"video-thing","options":{"uri":"videos\/2\/Baghe_Fin_Kashan_2005_original.webm","ogg":"","mp4":"","webm":"videos\/2\/Baghe_Fin_Kashan_2005_original.webm","autoplay":true,"loop":false,"volume":50}},{"type":"video-thing","options":{"uri":"videos\/5\/Old_caravanserai_in_Iranian_desert_original.webm","ogg":"","mp4":"","webm":"videos\/5\/Old_caravanserai_in_Iranian_desert_original.webm","autoplay":false,"loop":false,"volume":50}}]}}}}},{"type":"background-decorator","options":{"image":"images\/21\/Page_sR_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"grid-layout","options":{"rows":3,"columns":1,"gap":2},"slots":[{"type":"imager","options":{"url":"images\/28\/antik_orientalische_teekanne_kupfer_persien_rari_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"contain"}},{"type":"imager","options":{"url":"images\/26\/familie_03_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"contain"}},{"type":"imager","options":{"url":"images\/27\/gross_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"contain"}}]}}}}},{"type":"background-decorator","options":{"image":"images\/20\/Page_sL_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"imager","options":{"url":"images\/41\/Seidenstrasse_Von_Zentralasien_nach_Persien_1037_5_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"background-decorator","options":{"image":"images\/21\/Page_sR_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"imager","options":{"url":"images\/46\/Bild19610_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"background-decorator","options":{"image":"images\/20\/Page_sL_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"imager","options":{"url":"images\/53\/7482926_schiraz_persien_winter_2009_innenraum_des_historischen_gebaudes_nasir_al_molk_nasir_al_mulk_moschee_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"background-decorator","options":{"image":"images\/21\/Page_sR_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"imager","options":{"url":"images\/52\/7482927_shiraz_persien_winter_2009_innenraum_des_historischen_gebaudes_nasir_al_molk_nasir_al_mulk_moschee_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"background-decorator","options":{"image":"images\/20\/Page_sL_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"imager","options":{"url":"images\/51\/7492535_kermanshah_west_iran_januar_2009_sunnitische_moschus_in_kermashah_west_iran_persia_interieur_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"background-decorator","options":{"image":"images\/21\/Page_sR_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"imager","options":{"url":"images\/50\/7492538_kermanshah_west_iran_januar_2009_sunnitische_moschus_in_kermashah_west_iran_persien_interieur_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"background-decorator","options":{"image":"images\/20\/Page_sL_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"imager","options":{"url":"images\/43\/persien_300x300_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"background-decorator","options":{"image":"images\/21\/Page_sR_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"video-thing","options":{"uri":"videos\/11\/Baghe_e_Shazdeh_original.webm","ogg":"","mp4":"","webm":"videos\/11\/Baghe_e_Shazdeh_original.webm","autoplay":true,"loop":false,"volume":50}}}}}},{"type":"background-decorator","options":{"image":"images\/56\/bookJacket_Persien_B_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":105,"left":52,"right":9,"bottom":25},"slots":{"content":{"type":"text-thing","options":{"html":"eScrapBook","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}}}}]}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: TZ-DON-Buch_Iran\files
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\TZ-DON-Buch_Iran\files
VELIKOST: 3639 B (3.55 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
{"images\/55\/bookJacket_Persien_F_original.jpg":"images\/55\/bookJacket_Persien_F_original.jpg","images\/57\/Titel_IranischeKultur_original.jpg":"images\/57\/Titel_IranischeKultur_original.jpg","images\/20\/Page_sL_original.jpg":"images\/20\/Page_sL_original.jpg","images\/38\/PERSIEN_RUNDREISE_ORT4_original.jpg":"images\/38\/PERSIEN_RUNDREISE_ORT4_original.jpg","images\/21\/Page_sR_original.jpg":"images\/21\/Page_sR_original.jpg","videos\/24\/Asil_Music_03_original.webm":"videos\/24\/Asil_Music_03_original.webm","images\/32\/asil_original.jpg":"images\/32\/asil_original.jpg","videos\/21\/delkesh_delkash_omide_janem_youtube_original_original.webm":"videos\/21\/delkesh_delkash_omide_janem_youtube_original_original.webm","videos\/20\/Delkash_Ashegham_man_original.webm":"videos\/20\/Delkash_Ashegham_man_original.webm","videos\/19\/Delkash_Larzoon_Larzoon_original.webm":"videos\/19\/Delkash_Larzoon_Larzoon_original.webm","videos\/18\/delkash_be_sarayam_amad_kolbeh_man_original.webm":"videos\/18\/delkash_be_sarayam_amad_kolbeh_man_original.webm","images\/42\/persien_teppich_01_original.jpg":"images\/42\/persien_teppich_01_original.jpg","images\/23\/persien_teppich_04_original.jpg":"images\/23\/persien_teppich_04_original.jpg","images\/22\/persien_teppich_02_original.jpg":"images\/22\/persien_teppich_02_original.jpg","images\/24\/persien_teppich_03_original.jpg":"images\/24\/persien_teppich_03_original.jpg","images\/44\/52148413_original.jpg":"images\/44\/52148413_original.jpg","images\/45\/Bild19609_original.jpg":"images\/45\/Bild19609_original.jpg","videos\/2\/Baghe_Fin_Kashan_2005_original.webm":"videos\/2\/Baghe_Fin_Kashan_2005_original.webm","videos\/5\/Old_caravanserai_in_Iranian_desert_original.webm":"videos\/5\/Old_caravanserai_in_Iranian_desert_original.webm","images\/28\/antik_orientalische_teekanne_kupfer_persien_rari_original.jpg":"images\/28\/antik_orientalische_teekanne_kupfer_persien_rari_original.jpg","images\/26\/familie_03_original.jpg":"images\/26\/familie_03_original.jpg","images\/27\/gross_original.JPG":"images\/27\/gross_original.JPG","images\/41\/Seidenstrasse_Von_Zentralasien_nach_Persien_1037_5_original.jpg":"images\/41\/Seidenstrasse_Von_Zentralasien_nach_Persien_1037_5_original.jpg","images\/46\/Bild19610_original.jpg":"images\/46\/Bild19610_original.jpg","images\/53\/7482926_schiraz_persien_winter_2009_innenraum_des_historischen_gebaudes_nasir_al_molk_nasir_al_mulk_moschee_original.jpg":"images\/53\/7482926_schiraz_persien_winter_2009_innenraum_des_historischen_gebaudes_nasir_al_molk_nasir_al_mulk_moschee_original.jpg","images\/52\/7482927_shiraz_persien_winter_2009_innenraum_des_historischen_gebaudes_nasir_al_molk_nasir_al_mulk_moschee_original.jpg":"images\/52\/7482927_shiraz_persien_winter_2009_innenraum_des_historischen_gebaudes_nasir_al_molk_nasir_al_mulk_moschee_original.jpg","images\/51\/7492535_kermanshah_west_iran_januar_2009_sunnitische_moschus_in_kermashah_west_iran_persia_interieur_original.jpg":"images\/51\/7492535_kermanshah_west_iran_januar_2009_sunnitische_moschus_in_kermashah_west_iran_persia_interieur_original.jpg","images\/50\/7492538_kermanshah_west_iran_januar_2009_sunnitische_moschus_in_kermashah_west_iran_persien_interieur_original.jpg":"images\/50\/7492538_kermanshah_west_iran_januar_2009_sunnitische_moschus_in_kermashah_west_iran_persien_interieur_original.jpg","images\/43\/persien_300x300_original.jpg":"images\/43\/persien_300x300_original.jpg","videos\/11\/Baghe_e_Shazdeh_original.webm":"videos\/11\/Baghe_e_Shazdeh_original.webm","images\/56\/bookJacket_Persien_B_original.jpg":"images\/56\/bookJacket_Persien_B_original.jpg"}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: TZ-DON-Buch_Iran\index.html
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\TZ-DON-Buch_Iran\index.html
VELIKOST: 12026 B (11.74 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>eScrapBook</title>
<link href="images/favicon.ico" type="image/x-icon" rel="icon">
<link href="images/favicon.ico" type="image/x-icon" rel="shortcut icon">
<link rel="stylesheet" type="text/css" href="css/viewer.css">
<link rel="stylesheet" type="text/css" href="css/styles.css">
<script>
    var LocaleStrings = {};
</script>
<script type="text/javascript" src="js/libs-viewer.js"></script>
<script type="text/javascript" src="js/mykkro-viewer.js"></script></head>
<body>
<script>
// TODO dat do pluginu/widgetu/etc. a pridat ovladaci prvky
// udelat z toho neco jako BookViewerThing 
$(document).ready(function() {
    var book = {"type":"book","options":[],"slots":[{"type":"background-decorator","options":{"image":"images\/55\/bookJacket_Persien_F_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":19,"left":28,"right":22,"bottom":94},"slots":{"content":{"type":"split-layout","options":{"ratio":65,"gap":2,"horizontal":false},"slots":{"first":{"type":"imager","options":{"url":"images\/57\/Titel_IranischeKultur_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"contain"}},"second":{"type":"text-thing","options":{"html":"Iranische Kultur","css":"","h-align":"center","v-align":"center","font-size":"75%","font-family":"Times New Roman,Times,serif"}}}}}}}},{"type":"background-decorator","options":{"image":"images\/20\/Page_sL_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"imager","options":{"url":"images\/38\/PERSIEN_RUNDREISE_ORT4_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"background-decorator","options":{"image":"images\/21\/Page_sR_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"split-layout","options":{"ratio":65,"gap":2,"horizontal":false},"slots":{"first":{"type":"video-thing","options":{"uri":"videos\/24\/Asil_Music_03_original.webm","ogg":"","mp4":"","webm":"videos\/24\/Asil_Music_03_original.webm","autoplay":true,"loop":false,"volume":50}},"second":{"type":"imager","options":{"url":"images\/32\/asil_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}}}},{"type":"background-decorator","options":{"image":"images\/20\/Page_sL_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"grid-layout","options":{"rows":2,"columns":2,"gap":2},"slots":[{"type":"video-thing","options":{"uri":"videos\/21\/delkesh_delkash_omide_janem_youtube_original_original.webm","ogg":"","mp4":"","webm":"videos\/21\/delkesh_delkash_omide_janem_youtube_original_original.webm","autoplay":true,"loop":false,"volume":50}},{"type":"video-thing","options":{"uri":"videos\/20\/Delkash_Ashegham_man_original.webm","ogg":"","mp4":"","webm":"videos\/20\/Delkash_Ashegham_man_original.webm","autoplay":false,"loop":false,"volume":50}},{"type":"video-thing","options":{"uri":"videos\/19\/Delkash_Larzoon_Larzoon_original.webm","ogg":"","mp4":"","webm":"videos\/19\/Delkash_Larzoon_Larzoon_original.webm","autoplay":false,"loop":false,"volume":50}},{"type":"video-thing","options":{"uri":"videos\/18\/delkash_be_sarayam_amad_kolbeh_man_original.webm","ogg":"","mp4":"","webm":"videos\/18\/delkash_be_sarayam_amad_kolbeh_man_original.webm","autoplay":false,"loop":false,"volume":50}}]}}}}},{"type":"background-decorator","options":{"image":"images\/21\/Page_sR_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"grid-layout","options":{"rows":2,"columns":2,"gap":2},"slots":[{"type":"imager","options":{"url":"images\/42\/persien_teppich_01_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}},{"type":"imager","options":{"url":"images\/23\/persien_teppich_04_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"contain"}},{"type":"imager","options":{"url":"images\/22\/persien_teppich_02_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}},{"type":"imager","options":{"url":"images\/24\/persien_teppich_03_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}]}}}}},{"type":"background-decorator","options":{"image":"images\/20\/Page_sL_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"imager","options":{"url":"images\/44\/52148413_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"background-decorator","options":{"image":"images\/21\/Page_sR_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"imager","options":{"url":"images\/45\/Bild19609_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"background-decorator","options":{"image":"images\/20\/Page_sL_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"video-thing","options":{"uri":"videos\/2\/Baghe_Fin_Kashan_2005_original.webm","ogg":"","mp4":"","webm":"videos\/2\/Baghe_Fin_Kashan_2005_original.webm","autoplay":true,"loop":false,"volume":50}},{"type":"video-thing","options":{"uri":"videos\/5\/Old_caravanserai_in_Iranian_desert_original.webm","ogg":"","mp4":"","webm":"videos\/5\/Old_caravanserai_in_Iranian_desert_original.webm","autoplay":false,"loop":false,"volume":50}}]}}}}},{"type":"background-decorator","options":{"image":"images\/21\/Page_sR_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"grid-layout","options":{"rows":3,"columns":1,"gap":2},"slots":[{"type":"imager","options":{"url":"images\/28\/antik_orientalische_teekanne_kupfer_persien_rari_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"contain"}},{"type":"imager","options":{"url":"images\/26\/familie_03_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"contain"}},{"type":"imager","options":{"url":"images\/27\/gross_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"contain"}}]}}}}},{"type":"background-decorator","options":{"image":"images\/20\/Page_sL_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"imager","options":{"url":"images\/41\/Seidenstrasse_Von_Zentralasien_nach_Persien_1037_5_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"background-decorator","options":{"image":"images\/21\/Page_sR_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"imager","options":{"url":"images\/46\/Bild19610_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"background-decorator","options":{"image":"images\/20\/Page_sL_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"imager","options":{"url":"images\/53\/7482926_schiraz_persien_winter_2009_innenraum_des_historischen_gebaudes_nasir_al_molk_nasir_al_mulk_moschee_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"background-decorator","options":{"image":"images\/21\/Page_sR_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"imager","options":{"url":"images\/52\/7482927_shiraz_persien_winter_2009_innenraum_des_historischen_gebaudes_nasir_al_molk_nasir_al_mulk_moschee_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"background-decorator","options":{"image":"images\/20\/Page_sL_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"imager","options":{"url":"images\/51\/7492535_kermanshah_west_iran_januar_2009_sunnitische_moschus_in_kermashah_west_iran_persia_interieur_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"background-decorator","options":{"image":"images\/21\/Page_sR_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"imager","options":{"url":"images\/50\/7492538_kermanshah_west_iran_januar_2009_sunnitische_moschus_in_kermashah_west_iran_persien_interieur_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"background-decorator","options":{"image":"images\/20\/Page_sL_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"imager","options":{"url":"images\/43\/persien_300x300_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"background-decorator","options":{"image":"images\/21\/Page_sR_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":5,"left":5,"right":5,"bottom":5},"slots":{"content":{"type":"video-thing","options":{"uri":"videos\/11\/Baghe_e_Shazdeh_original.webm","ogg":"","mp4":"","webm":"videos\/11\/Baghe_e_Shazdeh_original.webm","autoplay":true,"loop":false,"volume":50}}}}}},{"type":"background-decorator","options":{"image":"images\/56\/bookJacket_Persien_B_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"},"slots":{"content":{"type":"inset-decorator","options":{"top":105,"left":52,"right":9,"bottom":25},"slots":{"content":{"type":"text-thing","options":{"html":"eScrapBook","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}}}}]};
    var bookView = new ExportBookViewer(book);
    bookView.init();
});
</script>
<div id="fullscreen" style="width: 100%; height: 100%;">
</div>
</body>
</html>
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: TZ-DON-Buch_Iran\README
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\TZ-DON-Buch_Iran\README
VELIKOST: 44 B (44.00 B)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
This is automatically generated README file.
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: TZ-DON-Buch_Iran\RUNeScrapBook
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\TZ-DON-Buch_Iran\RUNeScrapBook
VELIKOST: 49 B (49.00 B)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
#!/bin/bash
chromium-browser --kiosk "index.html"
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: TZ-DON-Buch_Iran\RUNeScrapBook.bat
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\TZ-DON-Buch_Iran\RUNeScrapBook.bat
VELIKOST: 53 B (53.00 B)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
@echo off
start chrome.exe --kiosk "%~dp0index.html"
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: TZ-DON-Buch_Iran\wow.json
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\TZ-DON-Buch_Iran\wow.json
VELIKOST: 206 B (206.00 B)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
{
	"name": "wow-contrib-samplebook",
	"apptype": "wow/scrapbook",
	"title": "Iranische Kultur",
	"description": "Iranische Kultur for demonstration purposes.",
	"version": "0.1",
	"author": "Marek"
}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: TZ-DON-Buch_Iran\css\combined.css
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\TZ-DON-Buch_Iran\css\combined.css
VELIKOST: 24469 B (23.90 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
/* http://meyerweb.com/eric/tools/css/reset/ 
   v2.0b1 | 201101 
   NOTE: WORK IN PROGRESS
   USE WITH CAUTION AND TEST WITH ABANDON */

html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section, summary,
time, mark, audio, video {
	margin: 0;
	padding: 0;
	border: 0;
	outline: 0;
	font-size: 100%;
	font: inherit;
	vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section {
	display: block;
}
body {
	line-height: 1;
}
ol, ul {
	list-style: none;
}
blockquote, q {
	quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
	content: '';
	content: none;
}

/* remember to define visible focus styles! 
:focus {
	outline: ?????;
} */

/* remember to highlight inserts somehow! */
ins {
	text-decoration: none;
}
del {
	text-decoration: line-through;
}

table {
	border-collapse: collapse;
	border-spacing: 0;
}

.jsoneditor-field, .jsoneditor-value, .jsoneditor-field-readonly, .jsoneditor-readonly {
    border: 1px solid transparent;
    min-height: 16px;
    min-width: 24px;
    padding: 2px;
    margin: 1px;
    outline: none;
    word-wrap: break-word;
    float: left;
}

/* adjust margin of p elements inside editable divs, needed for Opera, IE */
.jsoneditor-field p, .jsoneditor-value p {
    margin: 0;
}

.jsoneditor-value {
    word-break: break-word;
}

.jsoneditor-empty {
    background-color: #E5E5E5;
    border-radius: 2px;
}

.jsoneditor-separator {
    padding: 3px 0;
    vertical-align: top;
}

.jsoneditor-value:focus, .jsoneditor-field:focus,
        .jsoneditor-value:hover, .jsoneditor-field:hover,
        .jsoneditor-search-highlight {
    background-color: #FFFFAB;
    border: 1px solid yellow;
    border-radius: 2px;
}

.jsoneditor-search-highlight-active,
        .jsoneditor-search-highlight-active:focus,
        .jsoneditor-search-highlight-active:hover {
    background-color: #ffee00;
    border: 1px solid #ffc700;
    border-radius: 2px;
}

.jsoneditor-field-readonly:hover {
    border: 1px solid white;
}

.jsoneditor-readonly {
    color: gray;
}

button.jsoneditor-remove, button.jsoneditor-append, button.jsoneditor-duplicate,
button.jsoneditor-collapsed, button.jsoneditor-expanded,
button.jsoneditor-invisible, button.jsoneditor-dragarea,
button.jsoneditor-type-auto, button.jsoneditor-type-string,
button.jsoneditor-type-array, button.jsoneditor-type-object {
    width: 24px;
    height: 24px;
    padding: 0;
    margin: 0;
    border: none;
    cursor: pointer;
    background: url('../img/jsoneditor-icons.png');
}

button:disabled {
    color: #808080;
}

button.jsoneditor-collapsed {
    background-position: -168px 0;
}

button.jsoneditor-expanded {
    background-position: -168px -24px;
}

button.jsoneditor-invisible {
    visibility: hidden;
    background: none;
}

button.jsoneditor-collapsed, button.jsoneditor-expanded,
button.jsoneditor-invisible {
    float: left;
}

button.jsoneditor-remove {
    background-position: -24px -24px;
}
button.jsoneditor-remove:hover {
    background-position: -24px 0;
}

button.jsoneditor-append {
    background-position: 0 -24px;
}
button.jsoneditor-append:hover {
    background-position: 0 0;
}

button.jsoneditor-duplicate {
    background-position: -48px -24px;
}
button.jsoneditor-duplicate:hover {
    background-position: -48px 0;
}

button.jsoneditor-type-string {
    background-position: -144px -24px;
}
button.jsoneditor-type-string:hover {
    background-position: -144px 0;
}

button.jsoneditor-type-auto {
    background-position: -120px -24px;
}
button.jsoneditor-type-auto:hover {
    background-position: -120px 0;
}

button.jsoneditor-type-object {
    background-position: -72px -24px;
}
button.jsoneditor-type-object:hover {
    background-position: -72px 0;
}

button.jsoneditor-type-array {
    background-position: -96px -24px;
}
button.jsoneditor-type-array:hover {
    background-position: -96px 0;
}

div.jsoneditor-select {
    border: 1px solid gray;
    background-color: white;
    box-shadow: 4px 4px 10px rgba(128, 128, 128, 0.5);
}

div.jsoneditor-option {
    color: #4D4D4D;
    background-color: white;

    border: none;
    margin: 0;
    display: block;
    text-align: left;
    cursor: pointer;
}
div.jsoneditor-option:hover {
    background-color: #FFFFAB;
    color: #1A1A1A;
}
div.jsoneditor-option-selected {
    background-color: #D5DDF6;
}
div.jsoneditor-option-text {
    height: 24px;
    line-height: 24px;
    padding: 0 12px 0 0;
    display: inline-block;
}

div.jsoneditor-option-string, div.jsoneditor-option-auto,
div.jsoneditor-option-object, div.jsoneditor-option-array {
    float: left;
    width: 24px;
    height: 24px;
    display: inline-block;
    background: url('../img/jsoneditor-icons.png');
}
div.jsoneditor-option-string {
    background-position: -144px 0;
}
div.jsoneditor-option-auto {
    background-position: -120px 0;
}
div.jsoneditor-option-object {
    background-position: -72px 0;
}
div.jsoneditor-option-array {
    background-position: -96px 0;
}


div.jsoneditor-frame {
    color: #1A1A1A;
    border: 1px solid #97B0F8;
    box-sizing: border-box;
    width: 100%;
    height: 100%;
    overflow: auto;
    position: relative;
    padding: 0;
}

table.jsoneditor-table {
    border-collapse: collapse;
    border-spacing: 0;
    width: 100%;
    margin: 0;
}

div.jsoneditor-content-outer, div.jsonformatter-content {
    width: 100%;
    height: 100%;
    margin: -35px 0 0 0;
    padding: 35px 0 0 0;

    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;

    overflow: hidden;
}

div.jsoneditor-content {
    width: 100%;
    height: 100%;
    position: relative;
    overflow: auto;
}

textarea.jsonformatter-textarea {
    width: 100%;
    height: 100%;
    margin: 0;

    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;

    border: none;
    background-color: white;
    resize: none;
}

tr.jsoneditor-tr-highlight {
    background-color: #FFFFAB;
}

button.jsoneditor-dragarea {
    width: 16px;
    height: 24px;
    /*
    margin: 3px 0;
    background: url('img/dots_gray.gif') top center;
    background-repeat: repeat-y;
    */
    background: url('../img/jsoneditor-icons.png') -220px 0;

    display: block;
    cursor: move;
}

div.jsoneditor-menu {
    width: 100%;
    height: 35px;
    padding: 2px;
    margin: 0;
    overflow: hidden;
    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;

    color: #1A1A1A;
    background-color: #D5DDF6;
    border-bottom: 1px solid #97B0F8;
}

table.jsoneditor-search {
    position: absolute;
    right: 2px;
    top: 2px;
}

table.jsoneditor-search-input {
    border-collapse: collapse;
}

div.jsoneditor-search {
    border: 1px solid #97B0F8;
    background-color: white;
    padding: 0 2px;
    margin: 0;
}

input.jsoneditor-search {
    width: 120px;
    border: none;
    outline: none;
    margin: 1px;
}

div.jsoneditor-search-results {
    color: #4d4d4d;
    padding-right: 5px;
}

button.jsoneditor-search-refresh, button.jsoneditor-search-next,
        button.jsoneditor-search-previous {
    width: 16px;
    height: 24px;
    padding: 0;
    margin: 0;
    border: none;
    background: url('../img/jsoneditor-icons.png');
    vertical-align: top;
}

button.jsoneditor-search-refresh {
    width: 18px;
    background-position: -243px -25px;
}

button.jsoneditor-search-next {
    cursor: pointer;
    background-position: -268px -25px;
}
button.jsoneditor-search-next:hover {
    background-position: -268px -1px;
}

button.jsoneditor-search-previous {
    cursor: pointer;
    background-position: -292px -25px;
    margin-right: 2px;
}
button.jsoneditor-search-previous:hover {
    background-position: -292px -1px;
}


button.jsoneditor-menu {
    width: 26px;
    height: 26px;
    margin: 2px;
    padding: 2px;
    border-radius: 2px;
    border: 1px solid #aec0f8;
    background: #e3eaf6 url('../img/jsoneditor-icons.png');
}

button.jsoneditor-menu:hover {
    background-color: #f0f2f5;
}
button.jsoneditor-menu:active {
    background-color: #ffffff;
}
button.jsoneditor-menu:disabled {
    background-color: #e3eaf6;
}

button.jsoneditor-collapse-all {
    background-position: -312px 0;
}
button.jsoneditor-expand-all {
    background-position: -312px -24px;
}
button.jsoneditor-undo {
    background-position: -336px 0;
}
button.jsoneditor-redo {
    background-position: -360px 0;
}
button.jsoneditor-undo:disabled {
    background-position: -336px -24px;
}
button.jsoneditor-redo:disabled {
    background-position: -360px -24px;
}
/* TODO: css for button:disabled is not supported by IE8 */
button.jsoneditor-compact {
    background-position: -384px 0;
}
button.jsoneditor-format {
    background-position: -384px -24px;
}


tr, th, td {
    padding: 0;
    margin: 0;
}

td.jsoneditor-td {
    vertical-align: top;
}

td.jsoneditor-td {
    padding: 0 3px;
}

td.jsoneditor-td-edit {
    background-color: #F5F5F5;
    padding: 0;
}

td.jsoneditor-td-tree {
    vertical-align: top;
}

td.jsoneditor-droparea {
    height: 24px;

    border-top: 1px dashed gray;
    border-bottom: 1px dashed gray;
    background-color: #FFFF80;
}

.jsoneditor-field, .jsoneditor-value, .jsoneditor-td, .jsoneditor-th,
.jsoneditor-type,
.jsonformatter-textarea {
    font-family: droid sans mono, monospace, courier new, courier, sans-serif;
    font-size: 10pt;
    color: #1A1A1A;
}

.jsoneditor-hidden-focus {
    position: absolute;
    left: -1000px;
    top: -1000px;
    border: none;
    outline: none;
}
.ui-spinner {position: relative; border: 0px solid white; }
.ui-spinner-buttons {position: absolute}
.ui-spinner-button {overflow: hidden}
.toolbar-wrapper {
    display: block;
    position: relative;
}

.toolbar {
    position: absolute;
    bottom: 0;
    right: 0;
    border-radius: 5px; 
    -moz-border-radius: 5px; 
    -webkit-border-radius: 5px; 
    border: 1px solid gray;
    background-color: lightgray;
}


.my-tooltip {
	display: inline;
	position: relative;
}

.my-tooltip:hover:after{
	background: #333;
	background: rgba(0,0,0,.8);
	border-radius: 5px;
	bottom: 26px;
	color: #fff;
	content: attr(data-title);
	left: 20%;
	padding: 5px 15px;
	position: absolute;
	z-index: 98;
    width: 180px;
}

.my-tooltip:hover:before{
	border: solid;
	border-color: #333 transparent;
	border-width: 6px 6px 0 6px;
	bottom: 20px;
	content: "";
	left: 50%;
	position: absolute;
	z-index: 99;
}


/*
.icon-default.icon-hover {
    background-image: url(../images/icons/32/Redo.png);
}
*/


/* "fm" classes are mostly for imitating MathML in browsers without it; we try to roughly mimic
	Firefox's MathML layout, which seems better than http://www.w3.org/TR/mathml-for-css/ */

/* Cambria [Math]'s line height currently (2/11) is large in most non-Microsoft browsers: */
fmath, .fm-math		{ font-family: STIXGeneral, 'DejaVu Serif', 'DejaVu Sans',
						/* Cambria, 'Cambria Math', */ Times, 'Lucida Sans Unicode',
						OpenSymbol, 'Standard Symbols L', serif; line-height: 1.2 }
fmath mo, .fm-mo, .ma-sans-serif
/* some (crossbrowsertesting/browsershots) IE7s require no line break before
	'Lucida Sans Unicode': */
{ font-family: STIXGeneral, 'DejaVu Sans', 'DejaVu Serif', /* Cambria, 'Cambria Math', */ 'Lucida Sans Unicode',
						'Arial Unicode MS', 'Lucida Grande', Times,
						OpenSymbol, 'Standard Symbols L', sans-serif }
.fm-mo-Luc	/* avoid extra space at character tops, especially when stretched */
{ font-family: STIXGeneral, 'DejaVu Sans', 'DejaVu Serif', /* Cambria, 'Cambria Math', */ 'Lucida Sans Unicode',
						'Lucida Grande', 'Arial Unicode MS', Times,
						OpenSymbol, 'Standard Symbols L', sans-serif }
* html fmath, * html .fm-math, * html fmath mo, * html .fm-mo, * html .IE6-LSU
					{ font-family: 'Lucida Sans Unicode' !important }	/* IE <=6 only */
mo.fm-radic			{ font-family: 'Lucida Sans Unicode', 'Lucida Grande',
						Verdana, sans-serif !important }
.ma-script			{ font-family:
						'England Hand DB', 'Embassy BT', 'Amazone BT', 'Bank Script D',
						'URW Chancery L', 'Lucida Calligraphy', 'Apple Chancery',
						'Monotype Corsiva', Corsiva,
						'Vivaldi D', Gabriola, 'Segoe Script', cursive }
.ma-fraktur			{ font-family: UnifrakturMaguntia, Impact, fantasy }
/* .ma-double-struck currently ignored */

.fm-mi-length-1		{ font-style: italic }

.ma-bold			{ font-weight: bold }
.ma-nonbold			{ font-weight: normal }
.ma-upright			{ font-style: normal !important }
.ma-italic			{ font-style: italic }

fmath.ma-block		{ display: block; text-align: center; text-indent: 0;
						page-break-inside: avoid }

/* note an operator might be 'mo' or "embellished": */
.fm-separator		{ padding: 0 0.56ex 0 0 }
.fm-infix-loose		{ padding: 0 0.56ex }	/* typically a relation */
.fm-infix			{ padding: 0 0.44ex }
.fm-prefix			{ padding: 0 0.33ex 0 0 }
.fm-postfix			{ padding: 0 0 0 0.33ex }
.fm-prefix-tight	{ padding: 0 0.11ex 0 0 }
.fm-postfix-tight	{ padding: 0 0 0 0.11ex }
.fm-quantifier		{ padding: 0 0.11ex 0 0.22ex }	/* to match MathML */
/* fences should have no padding */

.fm-large-op		{ font-size: 1.3em }
.fm-inline .fm-large-op	{ font-size: 1em }

fmath mrow			{ white-space: nowrap }

.fm-vert			{ display: inline-block; vertical-align: middle }

fmath table, fmath tbody, fmath tr, fmath td	/* reset to default(?) styles */
					{ border: 0 !important; padding: 0 !important; margin: 0 !important;
						outline: 0 !important }

fmath table			{ border-collapse: collapse !important; text-align: center !important;
						table-layout: auto !important; float: none !important }

.fm-frac			{ padding: 0 1px !important }
td.fm-den-frac		{ border-top: solid thin !important }

.fm-root			{ font-size: 0.6em }
.fm-radicand		{ padding: 0 1px 0 0; border-top: solid; margin-top: 0.1em }

.fm-script			{ font-size: 0.71em }
.fm-script .fm-script .fm-script	{ font-size: 1em }

td.fm-underover-base	{ line-height: 1 !important }

td.fm-mtd			{ padding: 0.5ex 0.4em !important; vertical-align: baseline !important }

fmath none			{ display: none }	/* probably unnecessary */

mtd.middle, fmath td.middle	{ vertical-align: middle !important }

mtable.ma-join-align > mtr > mtd:first-child,
fmath span.ma-join-align > table > tbody > tr > td:first-child
					{ text-align: right; padding-right: 0 !important }
mtable.ma-join-align > mtr > mtd:first-child + mtd,
fmath span.ma-join-align > table > tbody > tr > td:first-child + td
					{ text-align: left; padding-left: 0 !important }
mtable.ma-join1-align > mtr > mtd:first-child,	/* e.g. for cases after a stretched { */
fmath span.ma-join1-align > table > tbody > tr > td:first-child
					{ text-align: left; padding-left: 0 !important }

mtable.ma-binom > mtr > mtd, fmath span.ma-binom > table > tbody > tr > td
					{ padding: 0 !important }
mtable.ma-binom > mtr:first-child > mtd,
fmath span.ma-binom > table > tbody > tr:first-child > td
					{ padding: 0 0 0.18em 0 !important }


/* curve.js classes: */

.ma-param-eq		{ white-space: nowrap }

.ma-slider-param .ui-slider
					{ margin: 0.33em 1em }
.ma-slider-param .ma-param-eq
					{ text-align: center; font-size: 1.1em }

.ma-grid-label		{ font: 80% serif }	/* (numeric) grid labels */
.ma-graphs			{ position: relative }	/* must be a positioned element */
.ma-graphs canvas	{ cursor: crosshair }
.ma-graph-handle	{ position: absolute; width: 1px; height: 100%; top: 0;
						background-color: #BBB; cursor: crosshair }
.ma-graph-handle:focus	{ background-color: #999 }
.ma-trace			{ font-size: 0.9em; margin-top: 1em; text-align: left }
.ma-indeps-vals		{ margin-top: 0.5em }
.ma-deps-vals		{ margin-top: 1em; min-width: 10em }
.syntaxhighlighter a,
.syntaxhighlighter div,
.syntaxhighlighter code,
.syntaxhighlighter table,
.syntaxhighlighter table td,
.syntaxhighlighter table tr,
.syntaxhighlighter table tbody,
.syntaxhighlighter table thead,
.syntaxhighlighter table caption,
.syntaxhighlighter textarea {
  -moz-border-radius: 0 0 0 0 !important;
  -webkit-border-radius: 0 0 0 0 !important;
  background: none !important;
  border: 0 !important;
  bottom: auto !important;
  float: none !important;
  height: auto !important;
  left: auto !important;
  line-height: 1.1em !important;
  margin: 0 !important;
  outline: 0 !important;
  overflow: visible !important;
  padding: 0 !important;
  position: static !important;
  right: auto !important;
  text-align: left !important;
  top: auto !important;
  vertical-align: baseline !important;
  width: auto !important;
  box-sizing: content-box !important;
  font-family: "Consolas", "Bitstream Vera Sans Mono", "Courier New", Courier, monospace !important;
  font-weight: normal !important;
  font-style: normal !important;
  font-size: 1em !important;
  min-height: inherit !important;
  min-height: auto !important;
}

.syntaxhighlighter {
  width: 100% !important;
  margin: 1em 0 1em 0 !important;
  position: relative !important;
  overflow-x: auto !important;
  overflow-y: hidden !important;
  font-size: 1em !important;
}
.syntaxhighlighter.source {
  overflow: hidden !important;
}
.syntaxhighlighter .bold {
  font-weight: bold !important;
}
.syntaxhighlighter .italic {
  font-style: italic !important;
}
.syntaxhighlighter .line {
  white-space: pre !important;
}
.syntaxhighlighter table {
  width: 100% !important;
}
.syntaxhighlighter table caption {
  text-align: left !important;
  padding: .5em 0 0.5em 1em !important;
}
.syntaxhighlighter table td.code {
  width: 100% !important;
}
.syntaxhighlighter table td.code .container {
  position: relative !important;
}
.syntaxhighlighter table td.code .container textarea {
  box-sizing: border-box !important;
  position: absolute !important;
  left: 0 !important;
  top: 0 !important;
  width: 100% !important;
  height: 100% !important;
  border: none !important;
  background: white !important;
  padding-left: 1em !important;
  overflow: hidden !important;
  white-space: pre !important;
}
.syntaxhighlighter table td.gutter .line {
  text-align: right !important;
  padding: 0 0.5em 0 1em !important;
}
.syntaxhighlighter table td.code .line {
  padding: 0 1em !important;
}
.syntaxhighlighter.nogutter td.code .container textarea, .syntaxhighlighter.nogutter td.code .line {
  padding-left: 0em !important;
}
.syntaxhighlighter.show {
  display: block !important;
}
.syntaxhighlighter.collapsed table {
  display: none !important;
}
.syntaxhighlighter.collapsed .toolbar {
  padding: 0.1em 0.8em 0em 0.8em !important;
  font-size: 1em !important;
  position: static !important;
  width: auto !important;
  height: auto !important;
}
.syntaxhighlighter.collapsed .toolbar span {
  display: inline !important;
  margin-right: 1em !important;
}
.syntaxhighlighter.collapsed .toolbar span a {
  padding: 0 !important;
  display: none !important;
}
.syntaxhighlighter.collapsed .toolbar span a.expandSource {
  display: inline !important;
}
.syntaxhighlighter .toolbar {
  position: absolute !important;
  right: 1px !important;
  top: 1px !important;
  width: 11px !important;
  height: 11px !important;
  font-size: 10px !important;
  z-index: 10 !important;
}
.syntaxhighlighter .toolbar span.title {
  display: inline !important;
}
.syntaxhighlighter .toolbar a {
  display: block !important;
  text-align: center !important;
  text-decoration: none !important;
  padding-top: 1px !important;
}
.syntaxhighlighter .toolbar a.expandSource {
  display: none !important;
}
.syntaxhighlighter.ie {
  font-size: .9em !important;
  padding: 1px 0 1px 0 !important;
}
.syntaxhighlighter.ie .toolbar {
  line-height: 8px !important;
}
.syntaxhighlighter.ie .toolbar a {
  padding-top: 0px !important;
}
.syntaxhighlighter.printing .line.alt1 .content,
.syntaxhighlighter.printing .line.alt2 .content,
.syntaxhighlighter.printing .line.highlighted .number,
.syntaxhighlighter.printing .line.highlighted.alt1 .content,
.syntaxhighlighter.printing .line.highlighted.alt2 .content {
  background: none !important;
}
.syntaxhighlighter.printing .line .number {
  color: #bbbbbb !important;
}
.syntaxhighlighter.printing .line .content {
  color: black !important;
}
.syntaxhighlighter.printing .toolbar {
  display: none !important;
}
.syntaxhighlighter.printing a {
  text-decoration: none !important;
}
.syntaxhighlighter.printing .plain, .syntaxhighlighter.printing .plain a {
  color: black !important;
}
.syntaxhighlighter.printing .comments, .syntaxhighlighter.printing .comments a {
  color: #008200 !important;
}
.syntaxhighlighter.printing .string, .syntaxhighlighter.printing .string a {
  color: blue !important;
}
.syntaxhighlighter.printing .keyword {
  color: #006699 !important;
  font-weight: bold !important;
}
.syntaxhighlighter.printing .preprocessor {
  color: gray !important;
}
.syntaxhighlighter.printing .variable {
  color: #aa7700 !important;
}
.syntaxhighlighter.printing .value {
  color: #009900 !important;
}
.syntaxhighlighter.printing .functions {
  color: #ff1493 !important;
}
.syntaxhighlighter.printing .constants {
  color: #0066cc !important;
}
.syntaxhighlighter.printing .script {
  font-weight: bold !important;
}
.syntaxhighlighter.printing .color1, .syntaxhighlighter.printing .color1 a {
  color: gray !important;
}
.syntaxhighlighter.printing .color2, .syntaxhighlighter.printing .color2 a {
  color: #ff1493 !important;
}
.syntaxhighlighter.printing .color3, .syntaxhighlighter.printing .color3 a {
  color: red !important;
}
.syntaxhighlighter.printing .break, .syntaxhighlighter.printing .break a {
  color: black !important;
}
.syntaxhighlighter {
  background-color: white !important;
}
.syntaxhighlighter .line.alt1 {
  background-color: white !important;
}
.syntaxhighlighter .line.alt2 {
  background-color: white !important;
}
.syntaxhighlighter .line.highlighted.alt1, .syntaxhighlighter .line.highlighted.alt2 {
  background-color: #e0e0e0 !important;
}
.syntaxhighlighter .line.highlighted.number {
  color: black !important;
}
.syntaxhighlighter table caption {
  color: black !important;
}
.syntaxhighlighter .gutter {
  color: #afafaf !important;
}
.syntaxhighlighter .gutter .line {
  border-right: 3px solid #6ce26c !important;
}
.syntaxhighlighter .gutter .line.highlighted {
  background-color: #6ce26c !important;
  color: white !important;
}
.syntaxhighlighter.printing .line .content {
  border: none !important;
}
.syntaxhighlighter.collapsed {
  overflow: visible !important;
}
.syntaxhighlighter.collapsed .toolbar {
  color: blue !important;
  background: white !important;
  border: 1px solid #6ce26c !important;
}
.syntaxhighlighter.collapsed .toolbar a {
  color: blue !important;
}
.syntaxhighlighter.collapsed .toolbar a:hover {
  color: red !important;
}
.syntaxhighlighter .toolbar {
  color: white !important;
  background: #6ce26c !important;
  border: none !important;
}
.syntaxhighlighter .toolbar a {
  color: white !important;
}
.syntaxhighlighter .toolbar a:hover {
  color: black !important;
}
.syntaxhighlighter .plain, .syntaxhighlighter .plain a {
  color: black !important;
}
.syntaxhighlighter .comments, .syntaxhighlighter .comments a {
  color: #008200 !important;
}
.syntaxhighlighter .string, .syntaxhighlighter .string a {
  color: blue !important;
}
.syntaxhighlighter .keyword {
  color: #006699 !important;
}
.syntaxhighlighter .preprocessor {
  color: gray !important;
}
.syntaxhighlighter .variable {
  color: #aa7700 !important;
}
.syntaxhighlighter .value {
  color: #009900 !important;
}
.syntaxhighlighter .functions {
  color: #ff1493 !important;
}
.syntaxhighlighter .constants {
  color: #0066cc !important;
}
.syntaxhighlighter .script {
  font-weight: bold !important;
  color: #006699 !important;
  background-color: none !important;
}
.syntaxhighlighter .color1, .syntaxhighlighter .color1 a {
  color: gray !important;
}
.syntaxhighlighter .color2, .syntaxhighlighter .color2 a {
  color: #ff1493 !important;
}
.syntaxhighlighter .color3, .syntaxhighlighter .color3 a {
  color: red !important;
}

.syntaxhighlighter .keyword {
  font-weight: bold !important;
}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: TZ-DON-Buch_Iran\css\styles.css
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\TZ-DON-Buch_Iran\css\styles.css
VELIKOST: 42319 B (41.33 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
.hello-widget .area{width:200px;height:200px;background-color:#abc;display:block;position:relative;cursor:crosshair;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.hello-widget .pointer{position:absolute;left:0px;top:0px;width:10px;height:10px;background-color:blue;cursor:crosshair;-webkit-border-radius:5px;-moz-border-radius:5px;border-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:5px;padding:10px}.hello-widget .coords{height:10%;padding-top:45%;text-align:center;width:100%;cursor:crosshair;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.my-paddy{width:100px;height:100px;background-color:orange;position:relative}.my-paddy > .my-paddy-picker{width:10px;height:10px;background-color:blue;position:absolute}.jsoneditor-widget{background-color:white}.fiddles.form .textarea textarea{width:400px;height:200px;font-family:monospace;font-size:12px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.fiddles.form .jsoneditor-widget{width:400px}.editable-editor .fieldset{font-size:80%}.editable-editor .fieldset fieldset{border:none;padding:0px}.ui-mykkro-fieldset,.ui-mykkro-titled,.ui-mykkro-optional{margin-bottom:5px}.ui-mykkro-fieldset > .ui-widget-header,.ui-mykkro-titled > .ui-widget-header,.ui-mykkro-optional > .ui-widget-header{padding:3px;position:relative;background:#ccc;color:black;border-color:#aaa}.ui-mykkro-fieldset > .ui-widget-content,.ui-mykkro-titled > .ui-widget-content,.ui-mykkro-optional > .ui-widget-content{padding:3px 20px;position:relative;background:#ddd;border-color:#aaa}.ui-mykkro-fieldset legend{display:block;width:100%;margin:0;padding:0;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.slider input{text-align:center;width:50px}.mykkro-thing{display:block;width:100%;height:100%}.mykkro-html{overflow:hidden;position:relative}.mykkro-html > div{overflow:hidden;position:absolute;width:100%}.mykkro-ajax{width:auto;height:auto}.mykkro-empty{background-color:#aaa;border:1px solid #666;display:-moz-box;-moz-box-orient:horizontal;-moz-box-pack:center;-moz-box-align:center;display:-webkit-box;-webkit-box-orient:horizontal;-webkit-box-pack:center;-webkit-box-align:center;display:box;box-orient:horizontal;box-pack:center;box-align:center;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;font-size:12px;opacity:0.7}.mykkro-editable > .editable-pane{width:385px;height:530px;display:inline-block;padding:10px;border:1px gray solid}.mykkro-editable > .editable-editor{width:360px;height:530px;display:inline-block;vertical-align:top;margin-left:14px;overflow:auto}.mykkro-clickable > div{width:100%;height:100%}.mykkro-clickable > .clickable-pane{position:absolute;background-color:#666;left:0px;top:0px;opacity:0}.mykkro-clickable > .clickable-pane:hover{opacity:0.3}.mykkro-clickable{position:relative}.mykkro-soft-text-editor{width:500px;height:200px}.mykkro-soft-text-editor > .textfield{padding:5px;vertical-align:top;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;display:inline-block;width:80%;height:30%}.mykkro-soft-text-editor > .textfield > textarea{width:100%;height:100%;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:10px;padding:10px;padding:4px;border:1px solid black;font-size:20px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.mykkro-soft-text-editor > .btn{display:inline-block;width:20%;height:30%;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;padding:5px}.mykkro-soft-text-editor > .btn > button{-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:10px;padding:10px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;height:100%;text-align:center}.mykkro-soft-text-editor > .mykkro-soft-keyboard{height:70%}.mykkro-soft-keyboard > div{position:relative;height:100%}.mykkro-soft-keyboard > div .key{position:absolute;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;padding:5px}.mykkro-soft-keyboard > div .key > div{-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;text-align:center;width:100%;height:100%;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:10px;padding:10px}.mykkro-soft-keyboard > div .key.active > div{background-color:#cfc}.mykkro-soft-keyboard > div .key:hover > div{background-color:#aaa}.mykkro-soft-keyboard > div .key.active:hover > div{background-color:#afa}.mykkro-modal .mykkro-soft-text-editor{width:100%;height:550px}.mykkro-modal .mykkro-soft-text-editor .key{font-size:36px}.mykkro-modal .mykkro-soft-text-editor .key > div{padding-top:20px}.mykkro-modal .mykkro-soft-text-editor .key.key-caps,.mykkro-modal .mykkro-soft-text-editor .key.key-del,.mykkro-modal .mykkro-soft-text-editor .key.key-space,.mykkro-modal .mykkro-soft-text-editor .key.key-enter,.mykkro-modal .mykkro-soft-text-editor .key.key-nums{background:#ddd;background:-webkit-gradient(linear,left bottom,left top,color-stop(0,#bbb),color-stop(1,#ddd));background:-ms-linear-gradient(bottom,#bbb,#ddd);background:-moz-linear-gradient(center bottom,#bbb 0%,#ddd 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#dddddd', endColorstr='#bbbbbb', GradientType=0)}.mykkro-modal .mykkro-soft-text-editor .done{font-size:30px;background:#afa;background:-webkit-gradient(linear,left bottom,left top,color-stop(0,#4f4),color-stop(1,#afa));background:-ms-linear-gradient(bottom,#4f4,#afa);background:-moz-linear-gradient(center bottom,#4f4 0%,#afa 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#aaffaa', endColorstr='#44ff44', GradientType=0)}.mykkro-calendar > div{width:100%;height:100%}.mykkro-text-thing{display:table;overflow:hidden}.mykkro-html.mykkro-text-thing > div{position:relative;display:table-cell;vertical-align:middle;text-align:center;width:100%;margin:0 auto}.mykkro-html.mykkro-text-thing > div.top{vertical-align:top}.mykkro-html.mykkro-text-thing > div.bottom{vertical-align:bottom}.mykkro-html.mykkro-text-thing > div.left{text-align:left}.mykkro-html.mykkro-text-thing > div.right{text-align:right}.mykkro-html.mykkro-text-thing{font-size:20px;line-height:130%;font-family:Georgia, serif}.mykkro-preview{-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.mykkro-preview > *{border:1px solid #333;background-color:white}.mykkro-preview .mykkro-empty > div{display:none}.mykkro-dummy{position:relative}.mykkro-dummy > div{overflow:hidden;position:absolute;width:100%}.mykkro-imager > div{width:100%;height:100%}.mykkro-centering-decorator{width:100%;height:100%;text-align:center;display:table}.mykkro-centering-decorator .center2{display:table-cell;vertical-align:middle}.mykkro-centering-decorator .center2 .center3{margin:0 auto;display:block}.mykkro-centering-decorator .center2 .center3 .content-inner{margin:0 auto;display:inline-block;text-align:left}.mykkro-page{border:1px solid black}#fullscreen{display:block;height:100%;overflow:hidden}#fullscreen #book-wrapper >.icon-turn-left{background-image:url("../images/icon-turn-left-256.png")}#fullscreen #book-wrapper >.icon-turn-right{background-image:url("../images/icon-turn-right-256.png")}#book-wrapper{margin:0 auto;background-image:url("../images/bg_wood-texture.jpg");background-repeat:repeat;padding:19px 59px;width:920px;height:600px;-webkit-border-top-right-radius:10px;-webkit-border-bottom-right-radius:10px;-webkit-border-bottom-left-radius:10px;-webkit-border-top-left-radius:10px;-moz-border-radius-topright:10px;-moz-border-radius-bottomright:10px;-moz-border-radius-bottomleft:10px;-moz-border-radius-topleft:10px;border-top-right-radius:10px;border-bottom-right-radius:10px;border-bottom-left-radius:10px;border-top-left-radius:10px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}#book-wrapper > .mykkro-book{margin:0 auto}.mykkro-book.turnable > div > div > .mykkro-slot{background-color:white;width:400px;height:560px}.mykkro-book.basic{width:auto;height:auto}.mykkro-book.basic > .mykkro-slot{background-color:white;width:500px;height:700px}.mykkro-flow-layout > div{display:inline-block;vertical-align:bottom;padding:5px}.mykkro-stack-layout{position:relative;width:100%;height:100%}.mykkro-stack-layout > div{position:absolute;overflow:hidden}.mykkro-split-layout{position:relative}.mykkro-split-layout > div{position:absolute;overflow:hidden}.mykkro-grid-layout{position:relative}.mykkro-grid-layout > div{position:absolute;overflow:hidden}.sudoku-board{display:table;table-layout:fixed;width:100%;height:100%;border:#aaa solid 2px;color:#777;border-spacing:0px;border-collapse:separate}.sudoku-row{display:table-row}.sudoku-square{display:table-cell}.sudoku-square-in{display:table;table-layout:fixed;width:100%;height:100%;border:#aaa solid 1px;color:#777;border-spacing:0px;border-collapse:separate}.sudoku-smallrow{display:table-row}.sudoku-cell{display:table-cell}.sudoku-cell-in{display:table;table-layout:fixed;width:100%;height:100%;border:#aaa dashed 1px;color:#777;border-spacing:0px;border-collapse:separate;text-align:center}.sudoku-cell-cell{display:table-cell;vertical-align:middle}.mykkro-player-controls > .controls{opacity:1}.mykkro-player-controls > .controls.playing{opacity:0.5}.mykkro-player-controls > .controls > button{width:128px;height:128px;background-size:100%;background-color:transparent;background-repeat:no-repeat;border:none;margin-right:10px}.mykkro-player-controls > .controls > button.play{background-image:url('../images/icons/128/media_playback_start.png')}.mykkro-player-controls > .controls > button.pause{background-image:url('../images/icons/128/media_playback_pause.png');width:80px;height:80px}.mykkro-player-controls > .controls > button.stop{background-image:url('../images/icons/128/media_playback_stop.png');width:80px;height:80px}.mykkro-player-controls > .controls > button > span{display:none}.mykkro-preview .mykkro-player-controls > .controls > button{width:32px;height:32px;margin-right:4px}.mykkro-preview .mykkro-player-controls > .controls > button.pause,.mykkro-preview .mykkro-player-controls > .controls > button.stop{width:24px;height:24px}.mykkro-audio-decorator{position:relative}.mykkro-audio-decorator > .player{position:absolute;left:0px;top:0px}.mykkro-audio-decorator > .player .controls{opacity:0.5}.mykkro-audio-decorator > .player .controls.playing{opacity:0.3}.mykkro-audio-decorator > .player:hover .controls{opacity:1}.mykkro-audio-decorator > .player:hover .controls.playing{opacity:0.5}.mykkro-audio-decorator > .slot{width:100%;height:100%}.mykkro-video-thing{position:relative}.mykkro-video-thing > .player{position:absolute;left:0px;top:0px}.mykkro-video-thing > .player .controls{opacity:0.5}.mykkro-video-thing > .player .controls.playing{opacity:0}.mykkro-video-thing > .player:hover .controls{opacity:1}.mykkro-video-thing > .player:hover .controls.playing{opacity:0.5}.mykkro-video-thing > video{width:100%;height:100%}.mykkro-toolbar-decorator-content{width:100%;height:100%}.mykkro-modal .mykkro-page-decorator{height:auto}.mykkro-modal .mykkro-ajax-pager .mykkro-ajax{height:530px}.panel-body .pager{padding:10px 0px}.panel-body .pager span,.panel-body .pager a{display:inline-block;margin:3px;width:30px;height:20px;line-height:20px;background-color:#def;border:1px solid #aaa;text-align:center}.panel-body .pager span{background-color:#abc;font-weight:bold}.mykkro-preview .mykkro-html.mykkro-text-thing{font-size:8px}.mykkro-ajax-pager > .pager-controls{text-align:center;padding:4px}.mykkro-ajax-pager > .pager-controls > *{padding:0px 4px}.mykkro-inset-decorator,.mykkro-border-decorator{-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.mykkro-rounded-decorator{-webkit-mask-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAA5JREFUeNpiYGBgAAgwAAAEAAGbA+oJAAAAAElFTkSuQmCC);overflow:hidden;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}.pageditor-widget{position:relative}.pageditor-widget .mykkro-page{background-color:white}form #tree-view-container{background-color:azure}#tree-view-container{position:absolute;left:516px;top:0px;background-color:azure;width:360px;height:700px;overflow:auto;-webkit-border-radius:2px;-moz-border-radius:2px;border-radius:2px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:white;padding:10px}#tree-view{display:block;color:black}#tree-view h2{font-size:12px;padding:3px;height:12px;margin-bottom:2px}#tree-view h3{display:inline-block;float:left;font-size:12px;padding:3px;height:12px;display:inline-block;width:50px;margin-right:10px;margin-bottom:2px;text-align:center;-webkit-border-top-right-radius:10px;-webkit-border-bottom-right-radius:10px;-webkit-border-bottom-left-radius:10px;-webkit-border-top-left-radius:10px;-moz-border-radius-topright:10px;-moz-border-radius-bottomright:10px;-moz-border-radius-bottomleft:10px;-moz-border-radius-topleft:10px;border-top-right-radius:10px;border-bottom-right-radius:10px;border-bottom-left-radius:10px;border-top-left-radius:10px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;background-color:lightblue}#tree-view h3.collapsed{background-color:#ccc}#tree-view .node{display:block;margin-left:20px}#tree-view > .node{margin-left:0px}#tree-view .slots.collapsed{display:none}#tree-view .tools{display:inline-block}#tree-view .tools > .toolbar{position:relative;border:none;background:none}#tree-view h2{display:inline-block}body{width:100%;*zoom:1}body:before,body:after{content:"";display:table}body:after{clear:both}.icon-link{display:inline-block;height:16px;line-height:16px;padding-left:20px;margin-right:16px;margin-bottom:4px}.icon-button{display:inline-block;background-size:cover;background-repeat:no-repeat no-repeat}.icon{display:block;background-size:cover;background-repeat:no-repeat no-repeat}.icon-12,.icon-tiny{width:12px;height:12px}.icon-16,.icon-small{width:16px;height:16px}.icon-24,.icon-medium{width:24px;height:24px}.icon-32,.icon-big{width:32px;height:32px}.icon-48,.icon-huge{width:48px;height:48px}.icon-snippet{background-color:transparent;background-image:url('../images/icons/48/snippet.png');background-repeat:no-repeat;background-position:left top}.icon-book{background-color:transparent;background-image:url('../images/icons/48/book.png');background-repeat:no-repeat;background-position:left top}.icon-image{background-color:transparent;background-image:url('../images/icons/48/image.png');background-repeat:no-repeat;background-position:left top}.icon-image.icon-32{background-color:transparent;background-image:url('../images/icons/32/Picture.png');background-repeat:no-repeat;background-position:left top}.icon-drawing{background-color:transparent;background-image:url('../images/icons/48/drawing.png');background-repeat:no-repeat;background-position:left top}.icon-drawing.icon-32{background-color:transparent;background-image:url('../images/icons/32/Picture.png');background-repeat:no-repeat;background-position:left top}.icon-note{background-color:transparent;background-image:url('../images/icons/48/note.png');background-repeat:no-repeat;background-position:left top}.icon-fiddle{background-color:transparent;background-image:url('../images/icons/48/fiddle.png');background-repeat:no-repeat;background-position:left top}.icon-todo{background-color:transparent;background-image:url('../images/icons/48/todo.png');background-repeat:no-repeat;background-position:left top}.icon-profile{background-color:transparent;background-image:url('../images/icons/48/profile.png');background-repeat:no-repeat;background-position:left top}.icon-logger{background-color:transparent;background-image:url('../images/icons/48/logger.png');background-repeat:no-repeat;background-position:left top}.icon-nodetype{background-color:transparent;background-image:url('../images/icons/48/nodetype.png');background-repeat:no-repeat;background-position:left top}.icon-plot{background-color:transparent;background-image:url('../images/icons/48/plot.png');background-repeat:no-repeat;background-position:left top}.icon-video{background-color:transparent;background-image:url('../images/icons/48/video.png');background-repeat:no-repeat;background-position:left top}.icon-video.icon-32{background-color:transparent;background-image:url('../images/icons/32/Movie.png');background-repeat:no-repeat;background-position:left top}.icon-voice.icon-32{background-color:transparent;background-image:url('../images/icons/32/speaker-icon.png');background-repeat:no-repeat;background-position:left top}.icon-voice{background-color:transparent;background-image:url('../images/icons/48/voice.png');background-repeat:no-repeat;background-position:left top}.icon-article{background-color:transparent;background-image:url('../images/icons/48/article.png');background-repeat:no-repeat;background-position:left top}.icon-article.icon-32{background-color:transparent;background-image:url('../images/icons/32/article.png');background-repeat:no-repeat;background-position:left top}.icon-text{background-color:transparent;background-image:url('../images/icons/32/Edit text.png');background-repeat:no-repeat;background-position:left top}.icon-design{background-color:transparent;background-image:url('../images/icons/48/design.png');background-repeat:no-repeat;background-position:left top}.icon-design.icon-32{background-color:transparent;background-image:url('../images/icons/32/layout.png');background-repeat:no-repeat;background-position:left top}.icon-settings{background-color:transparent;background-image:url('../images/icons/48/settings.png');background-repeat:no-repeat;background-position:left top}.icon-settings.icon-32{background-color:transparent;background-image:url('../images/icons/32/Settings.png');background-repeat:no-repeat;background-position:left top}.icon-show-all{background-color:transparent;background-image:url('../images/icons/16/show-all.png');background-repeat:no-repeat;background-position:left top}.icon-view{background-color:transparent;background-image:url('../images/icons/16/view.png');background-repeat:no-repeat;background-position:left top}.icon-edit{background-color:transparent;background-image:url('../images/icons/16/edit.png');background-repeat:no-repeat;background-position:left top}.icon-add-page{background-color:transparent;background-image:url('../images/icons/16/db_add.png');background-repeat:no-repeat;background-position:left top}.icon-remove-page{background-color:transparent;background-image:url('../images/icons/16/db_remove.png');background-repeat:no-repeat;background-position:left top}.icon-add{background-color:transparent;background-image:url('../images/icons/16/add.png');background-repeat:no-repeat;background-position:left top}.icon-remove-16{background-color:transparent;background-image:url('../images/icons/16/delete.png');background-repeat:no-repeat;background-position:left top}.icon-remove{background-color:transparent;background-image:url('../images/icons/32/Erase.png');background-repeat:no-repeat;background-position:left top}.icon-remove.icon-16{background-color:transparent;background-image:url('../images/icons/16/delete.png');background-repeat:no-repeat;background-position:left top}.icon-bomb{background-color:transparent;background-image:url('../images/icons/32/bomb.png');background-repeat:no-repeat;background-position:left top}.icon-favorites{background-color:transparent;background-image:url('../images/icons/32/Favourites.png');background-repeat:no-repeat;background-position:left top}.icon-export-16{background-color:transparent;background-image:url('../images/icons/16/Export.png');background-repeat:no-repeat;background-position:left top}.icon-export{background-color:transparent;background-image:url('../images/icons/32/Export.png');background-repeat:no-repeat;background-position:left top}.icon-export.icon-16{background-color:transparent;background-image:url('../images/icons/16/Export.png');background-repeat:no-repeat;background-position:left top}.icon-info{background-color:transparent;background-image:url('../images/icons/32/Info.png');background-repeat:no-repeat;background-position:left top}.icon-no{background-color:transparent;background-image:url('../images/icons/32/No.png');background-repeat:no-repeat;background-position:left top}.icon-ok{background-color:transparent;background-image:url('../images/icons/32/Ok.png');background-repeat:no-repeat;background-position:left top}.icon-tools{background-color:transparent;background-image:url('../images/icons/32/Tools.png');background-repeat:no-repeat;background-position:left top}.icon-play{background-color:transparent;background-image:url('../images/icons/32/Play.png');background-repeat:no-repeat;background-position:left top}.icon-preview{background-color:transparent;background-image:url('../images/icons/32/Preview.png');background-repeat:no-repeat;background-position:left top}.icon-refresh{background-color:transparent;background-image:url('../images/icons/32/Refresh.png');background-repeat:no-repeat;background-position:left top}.icon-undo{background-color:transparent;background-image:url('../images/icons/32/Undo.png');background-repeat:no-repeat;background-position:left top}.icon-yes{background-color:transparent;background-image:url('../images/icons/32/Yes.png');background-repeat:no-repeat;background-position:left top}.icon-warning{background-color:transparent;background-image:url('../images/icons/32/Warning.png');background-repeat:no-repeat;background-position:left top}.icon-default{background-color:transparent;background-image:url('../images/icons/32/Refresh.png');background-repeat:no-repeat;background-position:left top}.icon-home{background-color:transparent;background-image:url('../images/icons/48/kfm_home.png');background-repeat:no-repeat;background-position:left top}.icon-turn-left{background-color:transparent;background-image:url('../images/icons/48/left_turn.png');background-repeat:no-repeat;background-position:left top}.icon-turn-right{background-color:transparent;background-image:url('../images/icons/48/right_turn.png');background-repeat:no-repeat;background-position:left top}.icon-fullscreen-on{background-color:transparent;background-image:url('../images/icons/48/window_fullscreen.png');background-repeat:no-repeat;background-position:left top}.icon-fullscreen-off{background-color:transparent;background-image:url('../images/icons/48/window_nofullscreen.png');background-repeat:no-repeat;background-position:left top}.icon-closebook{background-color:transparent;background-image:url('../images/icons/48/fileclose-red.png');background-repeat:no-repeat;background-position:left top}.icon-hover{opacity:0.5}.previews > ul > li{margin-bottom:5px;margin-right:5px;position:relative}.preview{-webkit-border-radius:#eed;-moz-border-radius:#eed;border-radius:#eed;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:#eed;padding:10px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;display:block;position:relative;float:left;padding-left:70px;width:100%;min-height:68px}.preview.icon-only{width:68px;height:68px;padding:10px}.preview.image-preview.icon-only{width:100px;height:100px;padding:10px}.preview.video-preview.icon-only{width:200px;height:140px;padding:10px}.preview.drawing-preview.icon-only{width:120px;height:120px;padding:10px}.preview.design-preview.icon-only{width:104px;height:134px;padding:0px}.design-preview{min-height:134px;padding:10px 10px 10px 110px}.image-preview{padding:10px 10px 10px 100px;min-height:100px}.video-preview{padding-left:200px;min-height:140px}.video-preview img{width:180px;height:120px}.drawing-preview{padding-left:120px;min-height:120px}.drawing-preview .drawing-wrapper{width:100px;height:100px}.preview .media-icon{width:48px;height:48px}.preview .media-icon,.image-preview img,.video-preview img,.design-preview .mykkro-preview,.drawing-preview .drawing-wrapper{position:absolute;top:10px;left:10px}.preview .media-icon > svg,.image-preview img > svg,.video-preview img > svg,.design-preview .mykkro-preview > svg,.drawing-preview .drawing-wrapper > svg{position:absolute}.preview h3{font-family:'Quattrocento Sans', sans-serif;font-weight:bold;font-size:20px}.preview .description{font-style:italic;color:#333;margin-bottom:6px}.preview .times{font-size:80%;color:#666}.previews{margin-top:16px;margin-bottom:16px}.previews.single{margin:0}.media-icon{width:48px;height:48px}.touchpad-widget{width:200px;height:200px;background-color:#abc;display:block;position:relative}.touchpad-widget > .pointer{position:absolute;left:0px;top:0px;width:10px;height:10px;background-color:blue}ul.dashboard-menu{display:block}ul.dashboard-menu li{margin:2px;display:inline-block;vertical-align:top;width:100px;height:100px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:15px;-webkit-border-bottom-right-radius:15px;-webkit-border-bottom-left-radius:15px;-webkit-border-top-left-radius:15px;-moz-border-radius-topright:15px;-moz-border-radius-bottomright:15px;-moz-border-radius-bottomleft:15px;-moz-border-radius-topleft:15px;border-top-right-radius:15px;border-bottom-right-radius:15px;border-bottom-left-radius:15px;border-top-left-radius:15px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid gray;background-color:#ccc;padding:5px;text-align:center;font-size:11px;overflow:hidden}ul.dashboard-menu li .dashboard-icon{margin:6px auto}ul.dashboard-menu li a{width:100%;height:100%;display:block;color:black;font-weight:normal}ul.dashboard-menu li:hover{background-color:#cdd}ul.dashboard-menu li.active{background-color:azure}ul.dashboard-menu li.active:hover{background-color:azure}.dashboard-items{margin:16px 0px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:10px;-webkit-border-bottom-right-radius:10px;-webkit-border-bottom-left-radius:10px;-webkit-border-top-left-radius:10px;-moz-border-radius-topright:10px;-moz-border-radius-bottomright:10px;-moz-border-radius-bottomleft:10px;-moz-border-radius-topleft:10px;border-top-right-radius:10px;border-bottom-right-radius:10px;border-bottom-left-radius:10px;border-top-left-radius:10px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid gray;background-color:#eee;padding:10px}.dashboard-icon{width:48px;height:48px}.datagrid-info{margin-bottom:10px;font-weight:bolder}.datagrid table{border-collapse:collapse;text-align:left;width:100%}.datagrid{font:normal 12px/150% Arial, Helvetica, sans-serif;background:#fff;overflow:hidden;border:1px solid #8C8C8C;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px}.datagrid table td,.datagrid table th{padding:3px 10px}.datagrid table thead th{background:-webkit-gradient(linear,left top,left bottom,color-stop(0.05,#8C8C8C),color-stop(1,#7D7D7D));background:-moz-linear-gradient(center top,#8C8C8C 5%,#7D7D7D 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#8C8C8C',endColorstr='#7D7D7D');background-color:#8C8C8C;color:#FFFFFF;font-size:15px;font-weight:bold;border-left:1px solid #A3A3A3}.datagrid table thead th:first-child{border:none}.datagrid table tbody td{color:#7D7D7D;border-left:1px solid #DBDBDB;font-size:12px;font-weight:normal}.datagrid table tbody .alt td{background:#EBEBEB;color:#7D7D7D}.datagrid table tbody td:first-child{border-left:none}.datagrid table tbody tr:last-child td{border-bottom:none}.datagrid table tfoot td div{border-top:1px solid #8C8C8C;background:#EBEBEB}.datagrid table tfoot td{padding:0;font-size:12px}.datagrid table tfoot td div{padding:2px}.datagrid table tfoot td ul{margin:0;padding:0;list-style:none;text-align:right}.datagrid table tfoot li{display:inline}.datagrid table tfoot li a{text-decoration:none;display:inline-block;padding:2px 8px;margin:1px;color:#F5F5F5;border:1px solid #8C8C8C;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;background:-webkit-gradient(linear,left top,left bottom,color-stop(0.05,#8C8C8C),color-stop(1,#7D7D7D));background:-moz-linear-gradient(center top,#8C8C8C 5%,#7D7D7D 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#8C8C8C',endColorstr='#7D7D7D');background-color:#8C8C8C}.datagrid table tfoot ul a.active,.datagrid table tfoot ul a:hover{text-decoration:none;border-color:#7D7D7D;color:#F5F5F5;background:none;background-color:#8C8C8C}html{font-size:14px;font-family:'Ubuntu', sans-serif;font-weight:300;background-color:#eef}body{height:100%}#container{width:960px;margin:0 auto;overflow:hidden}#container{background-color:none}#header{width:100%;padding:10px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;margin-bottom:10px}.logo{background:#eef url(../images/logo-scrapbook.png) no-repeat left top;width:268px;height:74px;display:inline-block;float:left}.user-controls{float:right;margin-top:46px}#content{-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:16px;-webkit-border-bottom-right-radius:0px;-webkit-border-bottom-left-radius:0px;-webkit-border-top-left-radius:16px;-moz-border-radius-topright:16px;-moz-border-radius-bottomright:0px;-moz-border-radius-bottomleft:0px;-moz-border-radius-topleft:16px;border-top-right-radius:16px;border-bottom-right-radius:0px;border-bottom-left-radius:0px;border-top-left-radius:16px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:#ddd;padding:16px;margin:0px;width:100%}#content #accordion{background-color:#bbb}#content #accordion .ui-accordion-content{border-left:1px solid #aaa;border-right:1px solid #aaa;border-bottom:1px solid #aaa}#footer{width:100%;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:0px;-webkit-border-bottom-right-radius:16px;-webkit-border-bottom-left-radius:16px;-webkit-border-top-left-radius:0px;-moz-border-radius-topright:0px;-moz-border-radius-bottomright:16px;-moz-border-radius-bottomleft:16px;-moz-border-radius-topleft:0px;border-top-right-radius:0px;border-bottom-right-radius:16px;border-bottom-left-radius:16px;border-top-left-radius:0px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:#aaa;padding:16px;text-align:center}h1,h2,h3,h4,h5,h6{font-weight:bolder}h1{font-size:40px;margin-bottom:10px}h2{font-size:34px;margin-bottom:10px}h3{font-size:28px;margin-bottom:8px}h4{font-size:24px;margin-bottom:6px}h5{font-size:20px;margin-bottom:5px}h6{font-size:16px;margin-bottom:4px}strong,b{font-weight:bolder}a:link{text-decoration:none;font-weight:normal;color:#008}a:visited{text-decoration:none;font-weight:normal;color:#008}a:hover{text-decoration:none;font-weight:normal;color:brown}a:active{text-decoration:none;font-weight:normal;color:#008}.clear{clear:both}.ui-accordion-header > a{margin-left:20px}.ui-dialog-titlebar{background-color:#36436B !important;color:#def !important;padding:10px 30px !important}.ui-dialog-titlebar a.ui-dialog-titlebar-close{margin-top:-10px !important;padding-top:0px !important}.logged-user .info{margin-right:10px}.fakephp form{margin-bottom:1em;-webkit-border-radius:#F0E2a0;-moz-border-radius:#F0E2a0;border-radius:#F0E2a0;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:#F0E2a0;padding:10px}.fakephp form legend{font-weight:bolder;font-size:20px}.fakephp form fieldset{background-color:#fff2b0}.fakephp form label{padding-bottom:4px}.message{margin:1em;-webkit-border-radius:salmon;-moz-border-radius:salmon;border-radius:salmon;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:salmon;padding:10px;color:black;font-weight:bolder;font-size:16px}#authMessage{background-color:orange}.fakephp form fieldset{margin-bottom:16px}.fakephp form label{display:block;font-size:90%;margin-top:6px}.fakephp input:not([type=submit]):not([type=file]):not([class^="jsoneditor"]),textarea:not([class^="jsoneditor"]){width:400px}.richtextfield textarea{width:250px;height:160px}#UserLoginForm fieldset input{width:150px}.input .error-message{color:red;font-size:90%;padding:6px}.panel{margin-bottom:1em;-webkit-border-radius:#F0E2a0;-moz-border-radius:#F0E2a0;border-radius:#F0E2a0;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:#F0E2a0;padding:10px}.panel.main{background-color:#F0E289}.panel.headless .panel-body{margin:0}.avatar{width:90px;height:90px;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:#ffe;padding:4px}.user-info .avatar{display:inline-block;vertical-align:top;margin-right:20px}.user-info .other{display:inline-block;vertical-align:top}.panel-body{margin-top:20px}.image-detail > .panel-body > img{max-width:100%}.splash{margin:1em;-webkit-border-radius:maroon;-moz-border-radius:maroon;border-radius:maroon;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:maroon;padding:10px}.splash > ul{margin:20px}.splash > ul > li{font-weight:bolder}.splash > p{margin-bottom:10px}.actions{margin-top:8px}.node >.node-field{padding:5px;-webkit-border-radius:azure;-moz-border-radius:azure;border-radius:azure;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;-ms-box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-border-top-right-radius:5px;-webkit-border-bottom-right-radius:5px;-webkit-border-bottom-left-radius:5px;-webkit-border-top-left-radius:5px;-moz-border-radius-topright:5px;-moz-border-radius-bottomright:5px;-moz-border-radius-bottomleft:5px;-moz-border-radius-topleft:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;border-top-left-radius:5px;-moz-background-clip:padding;-webkit-background-clip:padding-box;background-clip:padding-box;border:1px solid #aaa;background-color:azure;padding:10px;margin-bottom:5px}.node >.node-field > h3{font-size:14px}.node >.node-field > h4{font-size:12px;font-weight:lighter;color:gray}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: TZ-DON-Buch_Iran\css\viewer.css
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\TZ-DON-Buch_Iran\css\viewer.css
VELIKOST: 1315 B (1.28 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
/* http://meyerweb.com/eric/tools/css/reset/ 
   v2.0b1 | 201101 
   NOTE: WORK IN PROGRESS
   USE WITH CAUTION AND TEST WITH ABANDON */

html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section, summary,
time, mark, audio, video {
	margin: 0;
	padding: 0;
	border: 0;
	outline: 0;
	font-size: 100%;
	font: inherit;
	vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section {
	display: block;
}
body {
	line-height: 1;
}
ol, ul {
	list-style: none;
}
blockquote, q {
	quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
	content: '';
	content: none;
}

/* remember to define visible focus styles! 
:focus {
	outline: ?????;
} */

/* remember to highlight inserts somehow! */
ins {
	text-decoration: none;
}
del {
	text-decoration: line-through;
}

table {
	border-collapse: collapse;
	border-spacing: 0;
}
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: TZ-DON-Buch_Iran\js\libs-viewer.js
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\TZ-DON-Buch_Iran\js\libs-viewer.js
VELIKOST: 379490 B (370.60 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
/*! jQuery v1.8.3 jquery.com | jquery.org/license */
(function(e,t){function _(e){var t=M[e]={};return v.each(e.split(y),function(e,n){t[n]=!0}),t}function H(e,n,r){if(r===t&&e.nodeType===1){var i="data-"+n.replace(P,"-$1").toLowerCase();r=e.getAttribute(i);if(typeof r=="string"){try{r=r==="true"?!0:r==="false"?!1:r==="null"?null:+r+""===r?+r:D.test(r)?v.parseJSON(r):r}catch(s){}v.data(e,n,r)}else r=t}return r}function B(e){var t;for(t in e){if(t==="data"&&v.isEmptyObject(e[t]))continue;if(t!=="toJSON")return!1}return!0}function et(){return!1}function tt(){return!0}function ut(e){return!e||!e.parentNode||e.parentNode.nodeType===11}function at(e,t){do e=e[t];while(e&&e.nodeType!==1);return e}function ft(e,t,n){t=t||0;if(v.isFunction(t))return v.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return v.grep(e,function(e,r){return e===t===n});if(typeof t=="string"){var r=v.grep(e,function(e){return e.nodeType===1});if(it.test(t))return v.filter(t,r,!n);t=v.filter(t,r)}return v.grep(e,function(e,r){return v.inArray(e,t)>=0===n})}function lt(e){var t=ct.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}function Lt(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function At(e,t){if(t.nodeType!==1||!v.hasData(e))return;var n,r,i,s=v._data(e),o=v._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u)for(r=0,i=u[n].length;r<i;r++)v.event.add(t,n,u[n][r])}o.data&&(o.data=v.extend({},o.data))}function Ot(e,t){var n;if(t.nodeType!==1)return;t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),n=t.nodeName.toLowerCase(),n==="object"?(t.parentNode&&(t.outerHTML=e.outerHTML),v.support.html5Clone&&e.innerHTML&&!v.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):n==="input"&&Et.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):n==="option"?t.selected=e.defaultSelected:n==="input"||n==="textarea"?t.defaultValue=e.defaultValue:n==="script"&&t.text!==e.text&&(t.text=e.text),t.removeAttribute(v.expando)}function Mt(e){return typeof e.getElementsByTagName!="undefined"?e.getElementsByTagName("*"):typeof e.querySelectorAll!="undefined"?e.querySelectorAll("*"):[]}function _t(e){Et.test(e.type)&&(e.defaultChecked=e.checked)}function Qt(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Jt.length;while(i--){t=Jt[i]+n;if(t in e)return t}return r}function Gt(e,t){return e=t||e,v.css(e,"display")==="none"||!v.contains(e.ownerDocument,e)}function Yt(e,t){var n,r,i=[],s=0,o=e.length;for(;s<o;s++){n=e[s];if(!n.style)continue;i[s]=v._data(n,"olddisplay"),t?(!i[s]&&n.style.display==="none"&&(n.style.display=""),n.style.display===""&&Gt(n)&&(i[s]=v._data(n,"olddisplay",nn(n.nodeName)))):(r=Dt(n,"display"),!i[s]&&r!=="none"&&v._data(n,"olddisplay",r))}for(s=0;s<o;s++){n=e[s];if(!n.style)continue;if(!t||n.style.display==="none"||n.style.display==="")n.style.display=t?i[s]||"":"none"}return e}function Zt(e,t,n){var r=Rt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function en(e,t,n,r){var i=n===(r?"border":"content")?4:t==="width"?1:0,s=0;for(;i<4;i+=2)n==="margin"&&(s+=v.css(e,n+$t[i],!0)),r?(n==="content"&&(s-=parseFloat(Dt(e,"padding"+$t[i]))||0),n!=="margin"&&(s-=parseFloat(Dt(e,"border"+$t[i]+"Width"))||0)):(s+=parseFloat(Dt(e,"padding"+$t[i]))||0,n!=="padding"&&(s+=parseFloat(Dt(e,"border"+$t[i]+"Width"))||0));return s}function tn(e,t,n){var r=t==="width"?e.offsetWidth:e.offsetHeight,i=!0,s=v.support.boxSizing&&v.css(e,"boxSizing")==="border-box";if(r<=0||r==null){r=Dt(e,t);if(r<0||r==null)r=e.style[t];if(Ut.test(r))return r;i=s&&(v.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+en(e,t,n||(s?"border":"content"),i)+"px"}function nn(e){if(Wt[e])return Wt[e];var t=v("<"+e+">").appendTo(i.body),n=t.css("display");t.remove();if(n==="none"||n===""){Pt=i.body.appendChild(Pt||v.extend(i.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!Ht||!Pt.createElement)Ht=(Pt.contentWindow||Pt.contentDocument).document,Ht.write("<!doctype html><html><body>"),Ht.close();t=Ht.body.appendChild(Ht.createElement(e)),n=Dt(t,"display"),i.body.removeChild(Pt)}return Wt[e]=n,n}function fn(e,t,n,r){var i;if(v.isArray(t))v.each(t,function(t,i){n||sn.test(e)?r(e,i):fn(e+"["+(typeof i=="object"?t:"")+"]",i,n,r)});else if(!n&&v.type(t)==="object")for(i in t)fn(e+"["+i+"]",t[i],n,r);else r(e,t)}function Cn(e){return function(t,n){typeof t!="string"&&(n=t,t="*");var r,i,s,o=t.toLowerCase().split(y),u=0,a=o.length;if(v.isFunction(n))for(;u<a;u++)r=o[u],s=/^\+/.test(r),s&&(r=r.substr(1)||"*"),i=e[r]=e[r]||[],i[s?"unshift":"push"](n)}}function kn(e,n,r,i,s,o){s=s||n.dataTypes[0],o=o||{},o[s]=!0;var u,a=e[s],f=0,l=a?a.length:0,c=e===Sn;for(;f<l&&(c||!u);f++)u=a[f](n,r,i),typeof u=="string"&&(!c||o[u]?u=t:(n.dataTypes.unshift(u),u=kn(e,n,r,i,u,o)));return(c||!u)&&!o["*"]&&(u=kn(e,n,r,i,"*",o)),u}function Ln(e,n){var r,i,s=v.ajaxSettings.flatOptions||{};for(r in n)n[r]!==t&&((s[r]?e:i||(i={}))[r]=n[r]);i&&v.extend(!0,e,i)}function An(e,n,r){var i,s,o,u,a=e.contents,f=e.dataTypes,l=e.responseFields;for(s in l)s in r&&(n[l[s]]=r[s]);while(f[0]==="*")f.shift(),i===t&&(i=e.mimeType||n.getResponseHeader("content-type"));if(i)for(s in a)if(a[s]&&a[s].test(i)){f.unshift(s);break}if(f[0]in r)o=f[0];else{for(s in r){if(!f[0]||e.converters[s+" "+f[0]]){o=s;break}u||(u=s)}o=o||u}if(o)return o!==f[0]&&f.unshift(o),r[o]}function On(e,t){var n,r,i,s,o=e.dataTypes.slice(),u=o[0],a={},f=0;e.dataFilter&&(t=e.dataFilter(t,e.dataType));if(o[1])for(n in e.converters)a[n.toLowerCase()]=e.converters[n];for(;i=o[++f];)if(i!=="*"){if(u!=="*"&&u!==i){n=a[u+" "+i]||a["* "+i];if(!n)for(r in a){s=r.split(" ");if(s[1]===i){n=a[u+" "+s[0]]||a["* "+s[0]];if(n){n===!0?n=a[r]:a[r]!==!0&&(i=s[0],o.splice(f--,0,i));break}}}if(n!==!0)if(n&&e["throws"])t=n(t);else try{t=n(t)}catch(l){return{state:"parsererror",error:n?l:"No conversion from "+u+" to "+i}}}u=i}return{state:"success",data:t}}function Fn(){try{return new e.XMLHttpRequest}catch(t){}}function In(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function $n(){return setTimeout(function(){qn=t},0),qn=v.now()}function Jn(e,t){v.each(t,function(t,n){var r=(Vn[t]||[]).concat(Vn["*"]),i=0,s=r.length;for(;i<s;i++)if(r[i].call(e,t,n))return})}function Kn(e,t,n){var r,i=0,s=0,o=Xn.length,u=v.Deferred().always(function(){delete a.elem}),a=function(){var t=qn||$n(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,i=1-r,s=0,o=f.tweens.length;for(;s<o;s++)f.tweens[s].run(i);return u.notifyWith(e,[f,i,n]),i<1&&o?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:v.extend({},t),opts:v.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:qn||$n(),duration:n.duration,tweens:[],createTween:function(t,n,r){var i=v.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(i),i},stop:function(t){var n=0,r=t?f.tweens.length:0;for(;n<r;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;Qn(l,f.opts.specialEasing);for(;i<o;i++){r=Xn[i].call(f,e,l,f.opts);if(r)return r}return Jn(f,l),v.isFunction(f.opts.start)&&f.opts.start.call(e,f),v.fx.timer(v.extend(a,{anim:f,queue:f.opts.queue,elem:e})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function Qn(e,t){var n,r,i,s,o;for(n in e){r=v.camelCase(n),i=t[r],s=e[n],v.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=v.cssHooks[r];if(o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}}function Gn(e,t,n){var r,i,s,o,u,a,f,l,c,h=this,p=e.style,d={},m=[],g=e.nodeType&&Gt(e);n.queue||(l=v._queueHooks(e,"fx"),l.unqueued==null&&(l.unqueued=0,c=l.empty.fire,l.empty.fire=function(){l.unqueued||c()}),l.unqueued++,h.always(function(){h.always(function(){l.unqueued--,v.queue(e,"fx").length||l.empty.fire()})})),e.nodeType===1&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],v.css(e,"display")==="inline"&&v.css(e,"float")==="none"&&(!v.support.inlineBlockNeedsLayout||nn(e.nodeName)==="inline"?p.display="inline-block":p.zoom=1)),n.overflow&&(p.overflow="hidden",v.support.shrinkWrapBlocks||h.done(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in t){s=t[r];if(Un.exec(s)){delete t[r],a=a||s==="toggle";if(s===(g?"hide":"show"))continue;m.push(r)}}o=m.length;if(o){u=v._data(e,"fxshow")||v._data(e,"fxshow",{}),"hidden"in u&&(g=u.hidden),a&&(u.hidden=!g),g?v(e).show():h.done(function(){v(e).hide()}),h.done(function(){var t;v.removeData(e,"fxshow",!0);for(t in d)v.style(e,t,d[t])});for(r=0;r<o;r++)i=m[r],f=h.createTween(i,g?u[i]:0),d[i]=u[i]||v.style(e,i),i in u||(u[i]=f.start,g&&(f.end=f.start,f.start=i==="width"||i==="height"?1:0))}}function Yn(e,t,n,r,i){return new Yn.prototype.init(e,t,n,r,i)}function Zn(e,t){var n,r={height:e},i=0;t=t?1:0;for(;i<4;i+=2-t)n=$t[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function tr(e){return v.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:!1}var n,r,i=e.document,s=e.location,o=e.navigator,u=e.jQuery,a=e.$,f=Array.prototype.push,l=Array.prototype.slice,c=Array.prototype.indexOf,h=Object.prototype.toString,p=Object.prototype.hasOwnProperty,d=String.prototype.trim,v=function(e,t){return new v.fn.init(e,t,n)},m=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,g=/\S/,y=/\s+/,b=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,w=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,E=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,S=/^[\],:{}\s]*$/,x=/(?:^|:|,)(?:\s*\[)+/g,T=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,N=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,C=/^-ms-/,k=/-([\da-z])/gi,L=function(e,t){return(t+"").toUpperCase()},A=function(){i.addEventListener?(i.removeEventListener("DOMContentLoaded",A,!1),v.ready()):i.readyState==="complete"&&(i.detachEvent("onreadystatechange",A),v.ready())},O={};v.fn=v.prototype={constructor:v,init:function(e,n,r){var s,o,u,a;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if(typeof e=="string"){e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3?s=[null,e,null]:s=w.exec(e);if(s&&(s[1]||!n)){if(s[1])return n=n instanceof v?n[0]:n,a=n&&n.nodeType?n.ownerDocument||n:i,e=v.parseHTML(s[1],a,!0),E.test(s[1])&&v.isPlainObject(n)&&this.attr.call(e,n,!0),v.merge(this,e);o=i.getElementById(s[2]);if(o&&o.parentNode){if(o.id!==s[2])return r.find(e);this.length=1,this[0]=o}return this.context=i,this.selector=e,this}return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e)}return v.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),v.makeArray(e,this))},selector:"",jquery:"1.8.3",length:0,size:function(){return this.length},toArray:function(){return l.call(this)},get:function(e){return e==null?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e,t,n){var r=v.merge(this.constructor(),e);return r.prevObject=this,r.context=this.context,t==="find"?r.selector=this.selector+(this.selector?" ":"")+n:t&&(r.selector=this.selector+"."+t+"("+n+")"),r},each:function(e,t){return v.each(this,e,t)},ready:function(e){return v.ready.promise().done(e),this},eq:function(e){return e=+e,e===-1?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(l.apply(this,arguments),"slice",l.call(arguments).join(","))},map:function(e){return this.pushStack(v.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:[].sort,splice:[].splice},v.fn.init.prototype=v.fn,v.extend=v.fn.extend=function(){var e,n,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;typeof u=="boolean"&&(l=u,u=arguments[1]||{},a=2),typeof u!="object"&&!v.isFunction(u)&&(u={}),f===a&&(u=this,--a);for(;a<f;a++)if((e=arguments[a])!=null)for(n in e){r=u[n],i=e[n];if(u===i)continue;l&&i&&(v.isPlainObject(i)||(s=v.isArray(i)))?(s?(s=!1,o=r&&v.isArray(r)?r:[]):o=r&&v.isPlainObject(r)?r:{},u[n]=v.extend(l,o,i)):i!==t&&(u[n]=i)}return u},v.extend({noConflict:function(t){return e.$===v&&(e.$=a),t&&e.jQuery===v&&(e.jQuery=u),v},isReady:!1,readyWait:1,holdReady:function(e){e?v.readyWait++:v.ready(!0)},ready:function(e){if(e===!0?--v.readyWait:v.isReady)return;if(!i.body)return setTimeout(v.ready,1);v.isReady=!0;if(e!==!0&&--v.readyWait>0)return;r.resolveWith(i,[v]),v.fn.trigger&&v(i).trigger("ready").off("ready")},isFunction:function(e){return v.type(e)==="function"},isArray:Array.isArray||function(e){return v.type(e)==="array"},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return e==null?String(e):O[h.call(e)]||"object"},isPlainObject:function(e){if(!e||v.type(e)!=="object"||e.nodeType||v.isWindow(e))return!1;try{if(e.constructor&&!p.call(e,"constructor")&&!p.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var r;for(r in e);return r===t||p.call(e,r)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){var r;return!e||typeof e!="string"?null:(typeof t=="boolean"&&(n=t,t=0),t=t||i,(r=E.exec(e))?[t.createElement(r[1])]:(r=v.buildFragment([e],t,n?null:[]),v.merge([],(r.cacheable?v.clone(r.fragment):r.fragment).childNodes)))},parseJSON:function(t){if(!t||typeof t!="string")return null;t=v.trim(t);if(e.JSON&&e.JSON.parse)return e.JSON.parse(t);if(S.test(t.replace(T,"@").replace(N,"]").replace(x,"")))return(new Function("return "+t))();v.error("Invalid JSON: "+t)},parseXML:function(n){var r,i;if(!n||typeof n!="string")return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(s){r=t}return(!r||!r.documentElement||r.getElementsByTagName("parsererror").length)&&v.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&g.test(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(C,"ms-").replace(k,L)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,n,r){var i,s=0,o=e.length,u=o===t||v.isFunction(e);if(r){if(u){for(i in e)if(n.apply(e[i],r)===!1)break}else for(;s<o;)if(n.apply(e[s++],r)===!1)break}else if(u){for(i in e)if(n.call(e[i],i,e[i])===!1)break}else for(;s<o;)if(n.call(e[s],s,e[s++])===!1)break;return e},trim:d&&!d.call("\ufeff\u00a0")?function(e){return e==null?"":d.call(e)}:function(e){return e==null?"":(e+"").replace(b,"")},makeArray:function(e,t){var n,r=t||[];return e!=null&&(n=v.type(e),e.length==null||n==="string"||n==="function"||n==="regexp"||v.isWindow(e)?f.call(r,e):v.merge(r,e)),r},inArray:function(e,t,n){var r;if(t){if(c)return c.call(t,e,n);r=t.length,n=n?n<0?Math.max(0,r+n):n:0;for(;n<r;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,s=0;if(typeof r=="number")for(;s<r;s++)e[i++]=n[s];else while(n[s]!==t)e[i++]=n[s++];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;n=!!n;for(;s<o;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,n,r){var i,s,o=[],u=0,a=e.length,f=e instanceof v||a!==t&&typeof a=="number"&&(a>0&&e[0]&&e[a-1]||a===0||v.isArray(e));if(f)for(;u<a;u++)i=n(e[u],u,r),i!=null&&(o[o.length]=i);else for(s in e)i=n(e[s],s,r),i!=null&&(o[o.length]=i);return o.concat.apply([],o)},guid:1,proxy:function(e,n){var r,i,s;return typeof n=="string"&&(r=e[n],n=e,e=r),v.isFunction(e)?(i=l.call(arguments,2),s=function(){return e.apply(n,i.concat(l.call(arguments)))},s.guid=e.guid=e.guid||v.guid++,s):t},access:function(e,n,r,i,s,o,u){var a,f=r==null,l=0,c=e.length;if(r&&typeof r=="object"){for(l in r)v.access(e,n,l,r[l],1,o,i);s=1}else if(i!==t){a=u===t&&v.isFunction(i),f&&(a?(a=n,n=function(e,t,n){return a.call(v(e),n)}):(n.call(e,i),n=null));if(n)for(;l<c;l++)n(e[l],r,a?i.call(e[l],l,n(e[l],r)):i,u);s=1}return s?e:f?n.call(e):c?n(e[0],r):o},now:function(){return(new Date).getTime()}}),v.ready.promise=function(t){if(!r){r=v.Deferred();if(i.readyState==="complete")setTimeout(v.ready,1);else if(i.addEventListener)i.addEventListener("DOMContentLoaded",A,!1),e.addEventListener("load",v.ready,!1);else{i.attachEvent("onreadystatechange",A),e.attachEvent("onload",v.ready);var n=!1;try{n=e.frameElement==null&&i.documentElement}catch(s){}n&&n.doScroll&&function o(){if(!v.isReady){try{n.doScroll("left")}catch(e){return setTimeout(o,50)}v.ready()}}()}}return r.promise(t)},v.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){O["[object "+t+"]"]=t.toLowerCase()}),n=v(i);var M={};v.Callbacks=function(e){e=typeof e=="string"?M[e]||_(e):v.extend({},e);var n,r,i,s,o,u,a=[],f=!e.once&&[],l=function(t){n=e.memory&&t,r=!0,u=s||0,s=0,o=a.length,i=!0;for(;a&&u<o;u++)if(a[u].apply(t[0],t[1])===!1&&e.stopOnFalse){n=!1;break}i=!1,a&&(f?f.length&&l(f.shift()):n?a=[]:c.disable())},c={add:function(){if(a){var t=a.length;(function r(t){v.each(t,function(t,n){var i=v.type(n);i==="function"?(!e.unique||!c.has(n))&&a.push(n):n&&n.length&&i!=="string"&&r(n)})})(arguments),i?o=a.length:n&&(s=t,l(n))}return this},remove:function(){return a&&v.each(arguments,function(e,t){var n;while((n=v.inArray(t,a,n))>-1)a.splice(n,1),i&&(n<=o&&o--,n<=u&&u--)}),this},has:function(e){return v.inArray(e,a)>-1},empty:function(){return a=[],this},disable:function(){return a=f=n=t,this},disabled:function(){return!a},lock:function(){return f=t,n||c.disable(),this},locked:function(){return!f},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],a&&(!r||f)&&(i?f.push(t):l(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!r}};return c},v.extend({Deferred:function(e){var t=[["resolve","done",v.Callbacks("once memory"),"resolved"],["reject","fail",v.Callbacks("once memory"),"rejected"],["notify","progress",v.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return v.Deferred(function(n){v.each(t,function(t,r){var s=r[0],o=e[t];i[r[1]](v.isFunction(o)?function(){var e=o.apply(this,arguments);e&&v.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s+"With"](this===i?n:this,[e])}:n[s])}),e=null}).promise()},promise:function(e){return e!=null?v.extend(e,r):r}},i={};return r.pipe=r.then,v.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[e^1][2].disable,t[2][2].lock),i[s[0]]=o.fire,i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=l.call(arguments),r=n.length,i=r!==1||e&&v.isFunction(e.promise)?r:0,s=i===1?e:v.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?l.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1){u=new Array(r),a=new Array(r),f=new Array(r);for(;t<r;t++)n[t]&&v.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i}return i||s.resolveWith(f,n),s.promise()}}),v.support=function(){var t,n,r,s,o,u,a,f,l,c,h,p=i.createElement("div");p.setAttribute("className","t"),p.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=p.getElementsByTagName("*"),r=p.getElementsByTagName("a")[0];if(!n||!r||!n.length)return{};s=i.createElement("select"),o=s.appendChild(i.createElement("option")),u=p.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t={leadingWhitespace:p.firstChild.nodeType===3,tbody:!p.getElementsByTagName("tbody").length,htmlSerialize:!!p.getElementsByTagName("link").length,style:/top/.test(r.getAttribute("style")),hrefNormalized:r.getAttribute("href")==="/a",opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:u.value==="on",optSelected:o.selected,getSetAttribute:p.className!=="t",enctype:!!i.createElement("form").enctype,html5Clone:i.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",boxModel:i.compatMode==="CSS1Compat",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},u.checked=!0,t.noCloneChecked=u.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!o.disabled;try{delete p.test}catch(d){t.deleteExpando=!1}!p.addEventListener&&p.attachEvent&&p.fireEvent&&(p.attachEvent("onclick",h=function(){t.noCloneEvent=!1}),p.cloneNode(!0).fireEvent("onclick"),p.detachEvent("onclick",h)),u=i.createElement("input"),u.value="t",u.setAttribute("type","radio"),t.radioValue=u.value==="t",u.setAttribute("checked","checked"),u.setAttribute("name","t"),p.appendChild(u),a=i.createDocumentFragment(),a.appendChild(p.lastChild),t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,t.appendChecked=u.checked,a.removeChild(u),a.appendChild(p);if(p.attachEvent)for(l in{submit:!0,change:!0,focusin:!0})f="on"+l,c=f in p,c||(p.setAttribute(f,"return;"),c=typeof p[f]=="function"),t[l+"Bubbles"]=c;return v(function(){var n,r,s,o,u="padding:0;margin:0;border:0;display:block;overflow:hidden;",a=i.getElementsByTagName("body")[0];if(!a)return;n=i.createElement("div"),n.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",a.insertBefore(n,a.firstChild),r=i.createElement("div"),n.appendChild(r),r.innerHTML="<table><tr><td></td><td>t</td></tr></table>",s=r.getElementsByTagName("td"),s[0].style.cssText="padding:0;margin:0;border:0;display:none",c=s[0].offsetHeight===0,s[0].style.display="",s[1].style.display="none",t.reliableHiddenOffsets=c&&s[0].offsetHeight===0,r.innerHTML="",r.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=r.offsetWidth===4,t.doesNotIncludeMarginInBodyOffset=a.offsetTop!==1,e.getComputedStyle&&(t.pixelPosition=(e.getComputedStyle(r,null)||{}).top!=="1%",t.boxSizingReliable=(e.getComputedStyle(r,null)||{width:"4px"}).width==="4px",o=i.createElement("div"),o.style.cssText=r.style.cssText=u,o.style.marginRight=o.style.width="0",r.style.width="1px",r.appendChild(o),t.reliableMarginRight=!parseFloat((e.getComputedStyle(o,null)||{}).marginRight)),typeof r.style.zoom!="undefined"&&(r.innerHTML="",r.style.cssText=u+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=r.offsetWidth===3,r.style.display="block",r.style.overflow="visible",r.innerHTML="<div></div>",r.firstChild.style.width="5px",t.shrinkWrapBlocks=r.offsetWidth!==3,n.style.zoom=1),a.removeChild(n),n=r=s=o=null}),a.removeChild(p),n=r=s=o=u=a=p=null,t}();var D=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,P=/([A-Z])/g;v.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(v.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?v.cache[e[v.expando]]:e[v.expando],!!e&&!B(e)},data:function(e,n,r,i){if(!v.acceptData(e))return;var s,o,u=v.expando,a=typeof n=="string",f=e.nodeType,l=f?v.cache:e,c=f?e[u]:e[u]&&u;if((!c||!l[c]||!i&&!l[c].data)&&a&&r===t)return;c||(f?e[u]=c=v.deletedIds.pop()||v.guid++:c=u),l[c]||(l[c]={},f||(l[c].toJSON=v.noop));if(typeof n=="object"||typeof n=="function")i?l[c]=v.extend(l[c],n):l[c].data=v.extend(l[c].data,n);return s=l[c],i||(s.data||(s.data={}),s=s.data),r!==t&&(s[v.camelCase(n)]=r),a?(o=s[n],o==null&&(o=s[v.camelCase(n)])):o=s,o},removeData:function(e,t,n){if(!v.acceptData(e))return;var r,i,s,o=e.nodeType,u=o?v.cache:e,a=o?e[v.expando]:v.expando;if(!u[a])return;if(t){r=n?u[a]:u[a].data;if(r){v.isArray(t)||(t in r?t=[t]:(t=v.camelCase(t),t in r?t=[t]:t=t.split(" ")));for(i=0,s=t.length;i<s;i++)delete r[t[i]];if(!(n?B:v.isEmptyObject)(r))return}}if(!n){delete u[a].data;if(!B(u[a]))return}o?v.cleanData([e],!0):v.support.deleteExpando||u!=u.window?delete u[a]:u[a]=null},_data:function(e,t,n){return v.data(e,t,n,!0)},acceptData:function(e){var t=e.nodeName&&v.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),v.fn.extend({data:function(e,n){var r,i,s,o,u,a=this[0],f=0,l=null;if(e===t){if(this.length){l=v.data(a);if(a.nodeType===1&&!v._data(a,"parsedAttrs")){s=a.attributes;for(u=s.length;f<u;f++)o=s[f].name,o.indexOf("data-")||(o=v.camelCase(o.substring(5)),H(a,o,l[o]));v._data(a,"parsedAttrs",!0)}}return l}return typeof e=="object"?this.each(function(){v.data(this,e)}):(r=e.split(".",2),r[1]=r[1]?"."+r[1]:"",i=r[1]+"!",v.access(this,function(n){if(n===t)return l=this.triggerHandler("getData"+i,[r[0]]),l===t&&a&&(l=v.data(a,e),l=H(a,e,l)),l===t&&r[1]?this.data(r[0]):l;r[1]=n,this.each(function(){var t=v(this);t.triggerHandler("setData"+i,r),v.data(this,e,n),t.triggerHandler("changeData"+i,r)})},null,n,arguments.length>1,null,!1))},removeData:function(e){return this.each(function(){v.removeData(this,e)})}}),v.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=v._data(e,t),n&&(!r||v.isArray(n)?r=v._data(e,t,v.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=v.queue(e,t),r=n.length,i=n.shift(),s=v._queueHooks(e,t),o=function(){v.dequeue(e,t)};i==="inprogress"&&(i=n.shift(),r--),i&&(t==="fx"&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return v._data(e,n)||v._data(e,n,{empty:v.Callbacks("once memory").add(function(){v.removeData(e,t+"queue",!0),v.removeData(e,n,!0)})})}}),v.fn.extend({queue:function(e,n){var r=2;return typeof e!="string"&&(n=e,e="fx",r--),arguments.length<r?v.queue(this[0],e):n===t?this:this.each(function(){var t=v.queue(this,e,n);v._queueHooks(this,e),e==="fx"&&t[0]!=="inprogress"&&v.dequeue(this,e)})},dequeue:function(e){return this.each(function(){v.dequeue(this,e)})},delay:function(e,t){return e=v.fx?v.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,s=v.Deferred(),o=this,u=this.length,a=function(){--i||s.resolveWith(o,[o])};typeof e!="string"&&(n=e,e=t),e=e||"fx";while(u--)r=v._data(o[u],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(a));return a(),s.promise(n)}});var j,F,I,q=/[\t\r\n]/g,R=/\r/g,U=/^(?:button|input)$/i,z=/^(?:button|input|object|select|textarea)$/i,W=/^a(?:rea|)$/i,X=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,V=v.support.getSetAttribute;v.fn.extend({attr:function(e,t){return v.access(this,v.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){v.removeAttr(this,e)})},prop:function(e,t){return v.access(this,v.prop,e,t,arguments.length>1)},removeProp:function(e){return e=v.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,s,o,u;if(v.isFunction(e))return this.each(function(t){v(this).addClass(e.call(this,t,this.className))});if(e&&typeof e=="string"){t=e.split(y);for(n=0,r=this.length;n<r;n++){i=this[n];if(i.nodeType===1)if(!i.className&&t.length===1)i.className=e;else{s=" "+i.className+" ";for(o=0,u=t.length;o<u;o++)s.indexOf(" "+t[o]+" ")<0&&(s+=t[o]+" ");i.className=v.trim(s)}}}return this},removeClass:function(e){var n,r,i,s,o,u,a;if(v.isFunction(e))return this.each(function(t){v(this).removeClass(e.call(this,t,this.className))});if(e&&typeof e=="string"||e===t){n=(e||"").split(y);for(u=0,a=this.length;u<a;u++){i=this[u];if(i.nodeType===1&&i.className){r=(" "+i.className+" ").replace(q," ");for(s=0,o=n.length;s<o;s++)while(r.indexOf(" "+n[s]+" ")>=0)r=r.replace(" "+n[s]+" "," ");i.className=e?v.trim(r):""}}}return this},toggleClass:function(e,t){var n=typeof e,r=typeof t=="boolean";return v.isFunction(e)?this.each(function(n){v(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var i,s=0,o=v(this),u=t,a=e.split(y);while(i=a[s++])u=r?u:!o.hasClass(i),o[u?"addClass":"removeClass"](i)}else if(n==="undefined"||n==="boolean")this.className&&v._data(this,"__className__",this.className),this.className=this.className||e===!1?"":v._data(this,"__className__")||""})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++)if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(q," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,s=this[0];if(!arguments.length){if(s)return n=v.valHooks[s.type]||v.valHooks[s.nodeName.toLowerCase()],n&&"get"in n&&(r=n.get(s,"value"))!==t?r:(r=s.value,typeof r=="string"?r.replace(R,""):r==null?"":r);return}return i=v.isFunction(e),this.each(function(r){var s,o=v(this);if(this.nodeType!==1)return;i?s=e.call(this,r,o.val()):s=e,s==null?s="":typeof s=="number"?s+="":v.isArray(s)&&(s=v.map(s,function(e){return e==null?"":e+""})),n=v.valHooks[this.type]||v.valHooks[this.nodeName.toLowerCase()];if(!n||!("set"in n)||n.set(this,s,"value")===t)this.value=s})}}),v.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s=e.type==="select-one"||i<0,o=s?null:[],u=s?i+1:r.length,a=i<0?u:s?i:0;for(;a<u;a++){n=r[a];if((n.selected||a===i)&&(v.support.optDisabled?!n.disabled:n.getAttribute("disabled")===null)&&(!n.parentNode.disabled||!v.nodeName(n.parentNode,"optgroup"))){t=v(n).val();if(s)return t;o.push(t)}}return o},set:function(e,t){var n=v.makeArray(t);return v(e).find("option").each(function(){this.selected=v.inArray(v(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attrFn:{},attr:function(e,n,r,i){var s,o,u,a=e.nodeType;if(!e||a===3||a===8||a===2)return;if(i&&v.isFunction(v.fn[n]))return v(e)[n](r);if(typeof e.getAttribute=="undefined")return v.prop(e,n,r);u=a!==1||!v.isXMLDoc(e),u&&(n=n.toLowerCase(),o=v.attrHooks[n]||(X.test(n)?F:j));if(r!==t){if(r===null){v.removeAttr(e,n);return}return o&&"set"in o&&u&&(s=o.set(e,r,n))!==t?s:(e.setAttribute(n,r+""),r)}return o&&"get"in o&&u&&(s=o.get(e,n))!==null?s:(s=e.getAttribute(n),s===null?t:s)},removeAttr:function(e,t){var n,r,i,s,o=0;if(t&&e.nodeType===1){r=t.split(y);for(;o<r.length;o++)i=r[o],i&&(n=v.propFix[i]||i,s=X.test(i),s||v.attr(e,i,""),e.removeAttribute(V?i:n),s&&n in e&&(e[n]=!1))}},attrHooks:{type:{set:function(e,t){if(U.test(e.nodeName)&&e.parentNode)v.error("type property can't be changed");else if(!v.support.radioValue&&t==="radio"&&v.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}},value:{get:function(e,t){return j&&v.nodeName(e,"button")?j.get(e,t):t in e?e.value:null},set:function(e,t,n){if(j&&v.nodeName(e,"button"))return j.set(e,t,n);e.value=t}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,s,o,u=e.nodeType;if(!e||u===3||u===8||u===2)return;return o=u!==1||!v.isXMLDoc(e),o&&(n=v.propFix[n]||n,s=v.propHooks[n]),r!==t?s&&"set"in s&&(i=s.set(e,r,n))!==t?i:e[n]=r:s&&"get"in s&&(i=s.get(e,n))!==null?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):z.test(e.nodeName)||W.test(e.nodeName)&&e.href?0:t}}}}),F={get:function(e,n){var r,i=v.prop(e,n);return i===!0||typeof i!="boolean"&&(r=e.getAttributeNode(n))&&r.nodeValue!==!1?n.toLowerCase():t},set:function(e,t,n){var r;return t===!1?v.removeAttr(e,n):(r=v.propFix[n]||n,r in e&&(e[r]=!0),e.setAttribute(n,n.toLowerCase())),n}},V||(I={name:!0,id:!0,coords:!0},j=v.valHooks.button={get:function(e,n){var r;return r=e.getAttributeNode(n),r&&(I[n]?r.value!=="":r.specified)?r.value:t},set:function(e,t,n){var r=e.getAttributeNode(n);return r||(r=i.createAttribute(n),e.setAttributeNode(r)),r.value=t+""}},v.each(["width","height"],function(e,t){v.attrHooks[t]=v.extend(v.attrHooks[t],{set:function(e,n){if(n==="")return e.setAttribute(t,"auto"),n}})}),v.attrHooks.contenteditable={get:j.get,set:function(e,t,n){t===""&&(t="false"),j.set(e,t,n)}}),v.support.hrefNormalized||v.each(["href","src","width","height"],function(e,n){v.attrHooks[n]=v.extend(v.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return r===null?t:r}})}),v.support.style||(v.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||t},set:function(e,t){return e.style.cssText=t+""}}),v.support.optSelected||(v.propHooks.selected=v.extend(v.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),v.support.enctype||(v.propFix.enctype="encoding"),v.support.checkOn||v.each(["radio","checkbox"],function(){v.valHooks[this]={get:function(e){return e.getAttribute("value")===null?"on":e.value}}}),v.each(["radio","checkbox"],function(){v.valHooks[this]=v.extend(v.valHooks[this],{set:function(e,t){if(v.isArray(t))return e.checked=v.inArray(v(e).val(),t)>=0}})});var $=/^(?:textarea|input|select)$/i,J=/^([^\.]*|)(?:\.(.+)|)$/,K=/(?:^|\s)hover(\.\S+|)\b/,Q=/^key/,G=/^(?:mouse|contextmenu)|click/,Y=/^(?:focusinfocus|focusoutblur)$/,Z=function(e){return v.event.special.hover?e:e.replace(K,"mouseenter$1 mouseleave$1")};v.event={add:function(e,n,r,i,s){var o,u,a,f,l,c,h,p,d,m,g;if(e.nodeType===3||e.nodeType===8||!n||!r||!(o=v._data(e)))return;r.handler&&(d=r,r=d.handler,s=d.selector),r.guid||(r.guid=v.guid++),a=o.events,a||(o.events=a={}),u=o.handle,u||(o.handle=u=function(e){return typeof v=="undefined"||!!e&&v.event.triggered===e.type?t:v.event.dispatch.apply(u.elem,arguments)},u.elem=e),n=v.trim(Z(n)).split(" ");for(f=0;f<n.length;f++){l=J.exec(n[f])||[],c=l[1],h=(l[2]||"").split(".").sort(),g=v.event.special[c]||{},c=(s?g.delegateType:g.bindType)||c,g=v.event.special[c]||{},p=v.extend({type:c,origType:l[1],data:i,handler:r,guid:r.guid,selector:s,needsContext:s&&v.expr.match.needsContext.test(s),namespace:h.join(".")},d),m=a[c];if(!m){m=a[c]=[],m.delegateCount=0;if(!g.setup||g.setup.call(e,i,h,u)===!1)e.addEventListener?e.addEventListener(c,u,!1):e.attachEvent&&e.attachEvent("on"+c,u)}g.add&&(g.add.call(e,p),p.handler.guid||(p.handler.guid=r.guid)),s?m.splice(m.delegateCount++,0,p):m.push(p),v.event.global[c]=!0}e=null},global:{},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,m,g=v.hasData(e)&&v._data(e);if(!g||!(h=g.events))return;t=v.trim(Z(t||"")).split(" ");for(s=0;s<t.length;s++){o=J.exec(t[s])||[],u=a=o[1],f=o[2];if(!u){for(u in h)v.event.remove(e,u+t[s],n,r,!0);continue}p=v.event.special[u]||{},u=(r?p.delegateType:p.bindType)||u,d=h[u]||[],l=d.length,f=f?new RegExp("(^|\\.)"+f.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(c=0;c<d.length;c++)m=d[c],(i||a===m.origType)&&(!n||n.guid===m.guid)&&(!f||f.test(m.namespace))&&(!r||r===m.selector||r==="**"&&m.selector)&&(d.splice(c--,1),m.selector&&d.delegateCount--,p.remove&&p.remove.call(e,m));d.length===0&&l!==d.length&&((!p.teardown||p.teardown.call(e,f,g.handle)===!1)&&v.removeEvent(e,u,g.handle),delete h[u])}v.isEmptyObject(h)&&(delete g.handle,v.removeData(e,"events",!0))},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(n,r,s,o){if(!s||s.nodeType!==3&&s.nodeType!==8){var u,a,f,l,c,h,p,d,m,g,y=n.type||n,b=[];if(Y.test(y+v.event.triggered))return;y.indexOf("!")>=0&&(y=y.slice(0,-1),a=!0),y.indexOf(".")>=0&&(b=y.split("."),y=b.shift(),b.sort());if((!s||v.event.customEvent[y])&&!v.event.global[y])return;n=typeof n=="object"?n[v.expando]?n:new v.Event(y,n):new v.Event(y),n.type=y,n.isTrigger=!0,n.exclusive=a,n.namespace=b.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,h=y.indexOf(":")<0?"on"+y:"";if(!s){u=v.cache;for(f in u)u[f].events&&u[f].events[y]&&v.event.trigger(n,r,u[f].handle.elem,!0);return}n.result=t,n.target||(n.target=s),r=r!=null?v.makeArray(r):[],r.unshift(n),p=v.event.special[y]||{};if(p.trigger&&p.trigger.apply(s,r)===!1)return;m=[[s,p.bindType||y]];if(!o&&!p.noBubble&&!v.isWindow(s)){g=p.delegateType||y,l=Y.test(g+y)?s:s.parentNode;for(c=s;l;l=l.parentNode)m.push([l,g]),c=l;c===(s.ownerDocument||i)&&m.push([c.defaultView||c.parentWindow||e,g])}for(f=0;f<m.length&&!n.isPropagationStopped();f++)l=m[f][0],n.type=m[f][1],d=(v._data(l,"events")||{})[n.type]&&v._data(l,"handle"),d&&d.apply(l,r),d=h&&l[h],d&&v.acceptData(l)&&d.apply&&d.apply(l,r)===!1&&n.preventDefault();return n.type=y,!o&&!n.isDefaultPrevented()&&(!p._default||p._default.apply(s.ownerDocument,r)===!1)&&(y!=="click"||!v.nodeName(s,"a"))&&v.acceptData(s)&&h&&s[y]&&(y!=="focus"&&y!=="blur"||n.target.offsetWidth!==0)&&!v.isWindow(s)&&(c=s[h],c&&(s[h]=null),v.event.triggered=y,s[y](),v.event.triggered=t,c&&(s[h]=c)),n.result}return},dispatch:function(n){n=v.event.fix(n||e.event);var r,i,s,o,u,a,f,c,h,p,d=(v._data(this,"events")||{})[n.type]||[],m=d.delegateCount,g=l.call(arguments),y=!n.exclusive&&!n.namespace,b=v.event.special[n.type]||{},w=[];g[0]=n,n.delegateTarget=this;if(b.preDispatch&&b.preDispatch.call(this,n)===!1)return;if(m&&(!n.button||n.type!=="click"))for(s=n.target;s!=this;s=s.parentNode||this)if(s.disabled!==!0||n.type!=="click"){u={},f=[];for(r=0;r<m;r++)c=d[r],h=c.selector,u[h]===t&&(u[h]=c.needsContext?v(h,this).index(s)>=0:v.find(h,this,null,[s]).length),u[h]&&f.push(c);f.length&&w.push({elem:s,matches:f})}d.length>m&&w.push({elem:this,matches:d.slice(m)});for(r=0;r<w.length&&!n.isPropagationStopped();r++){a=w[r],n.currentTarget=a.elem;for(i=0;i<a.matches.length&&!n.isImmediatePropagationStopped();i++){c=a.matches[i];if(y||!n.namespace&&!c.namespace||n.namespace_re&&n.namespace_re.test(c.namespace))n.data=c.data,n.handleObj=c,o=((v.event.special[c.origType]||{}).handle||c.handler).apply(a.elem,g),o!==t&&(n.result=o,o===!1&&(n.preventDefault(),n.stopPropagation()))}}return b.postDispatch&&b.postDispatch.call(this,n),n.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,s,o,u=n.button,a=n.fromElement;return e.pageX==null&&n.clientX!=null&&(r=e.target.ownerDocument||i,s=r.documentElement,o=r.body,e.pageX=n.clientX+(s&&s.scrollLeft||o&&o.scrollLeft||0)-(s&&s.clientLeft||o&&o.clientLeft||0),e.pageY=n.clientY+(s&&s.scrollTop||o&&o.scrollTop||0)-(s&&s.clientTop||o&&o.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?n.toElement:a),!e.which&&u!==t&&(e.which=u&1?1:u&2?3:u&4?2:0),e}},fix:function(e){if(e[v.expando])return e;var t,n,r=e,s=v.event.fixHooks[e.type]||{},o=s.props?this.props.concat(s.props):this.props;e=v.Event(r);for(t=o.length;t;)n=o[--t],e[n]=r[n];return e.target||(e.target=r.srcElement||i),e.target.nodeType===3&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,r):e},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,n){v.isWindow(this)&&(this.onbeforeunload=n)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,n,r){var i=v.extend(new v.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?v.event.trigger(i,null,t):v.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},v.event.handle=v.event.dispatch,v.removeEvent=i.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]=="undefined"&&(e[r]=null),e.detachEvent(r,n))},v.Event=function(e,t){if(!(this instanceof v.Event))return new v.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?tt:et):this.type=e,t&&v.extend(this,t),this.timeStamp=e&&e.timeStamp||v.now(),this[v.expando]=!0},v.Event.prototype={preventDefault:function(){this.isDefaultPrevented=tt;var e=this.originalEvent;if(!e)return;e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=tt;var e=this.originalEvent;if(!e)return;e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=tt,this.stopPropagation()},isDefaultPrevented:et,isPropagationStopped:et,isImmediatePropagationStopped:et},v.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){v.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj,o=s.selector;if(!i||i!==r&&!v.contains(r,i))e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t;return n}}}),v.support.submitBubbles||(v.event.special.submit={setup:function(){if(v.nodeName(this,"form"))return!1;v.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=v.nodeName(n,"input")||v.nodeName(n,"button")?n.form:t;r&&!v._data(r,"_submit_attached")&&(v.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),v._data(r,"_submit_attached",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&v.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(v.nodeName(this,"form"))return!1;v.event.remove(this,"._submit")}}),v.support.changeBubbles||(v.event.special.change={setup:function(){if($.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")v.event.add(this,"propertychange._change",function(e){e.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),v.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),v.event.simulate("change",this,e,!0)});return!1}v.event.add(this,"beforeactivate._change",function(e){var t=e.target;$.test(t.nodeName)&&!v._data(t,"_change_attached")&&(v.event.add(t,"change._change",function(e){this.parentNode&&!e.isSimulated&&!e.isTrigger&&v.event.simulate("change",this.parentNode,e,!0)}),v._data(t,"_change_attached",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||t.type!=="radio"&&t.type!=="checkbox")return e.handleObj.handler.apply(this,arguments)},teardown:function(){return v.event.remove(this,"._change"),!$.test(this.nodeName)}}),v.support.focusinBubbles||v.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){v.event.simulate(t,e.target,v.event.fix(e),!0)};v.event.special[t]={setup:function(){n++===0&&i.addEventListener(e,r,!0)},teardown:function(){--n===0&&i.removeEventListener(e,r,!0)}}}),v.fn.extend({on:function(e,n,r,i,s){var o,u;if(typeof e=="object"){typeof n!="string"&&(r=r||n,n=t);for(u in e)this.on(u,n,r,e[u],s);return this}r==null&&i==null?(i=n,r=n=t):i==null&&(typeof n=="string"?(i=r,r=t):(i=r,r=n,n=t));if(i===!1)i=et;else if(!i)return this;return s===1&&(o=i,i=function(e){return v().off(e),o.apply(this,arguments)},i.guid=o.guid||(o.guid=v.guid++)),this.each(function(){v.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,s;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,v(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if(typeof e=="object"){for(s in e)this.off(s,n,e[s]);return this}if(n===!1||typeof n=="function")r=n,n=t;return r===!1&&(r=et),this.each(function(){v.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,n){return v(this.context).on(e,this.selector,t,n),this},die:function(e,t){return v(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){v.event.trigger(e,t,this)})},triggerHandler:function(e,t){if(this[0])return v.event.trigger(e,t,this[0],!0)},toggle:function(e){var t=arguments,n=e.guid||v.guid++,r=0,i=function(n){var i=(v._data(this,"lastToggle"+e.guid)||0)%r;return v._data(this,"lastToggle"+e.guid,i+1),n.preventDefault(),t[i].apply(this,arguments)||!1};i.guid=n;while(r<t.length)t[r++].guid=n;return this.click(i)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),v.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){v.fn[t]=function(e,n){return n==null&&(n=e,e=null),arguments.length>0?this.on(t,null,e,n):this.trigger(t)},Q.test(t)&&(v.event.fixHooks[t]=v.event.keyHooks),G.test(t)&&(v.event.fixHooks[t]=v.event.mouseHooks)}),function(e,t){function nt(e,t,n,r){n=n||[],t=t||g;var i,s,a,f,l=t.nodeType;if(!e||typeof e!="string")return n;if(l!==1&&l!==9)return[];a=o(t);if(!a&&!r)if(i=R.exec(e))if(f=i[1]){if(l===9){s=t.getElementById(f);if(!s||!s.parentNode)return n;if(s.id===f)return n.push(s),n}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(f))&&u(t,s)&&s.id===f)return n.push(s),n}else{if(i[2])return S.apply(n,x.call(t.getElementsByTagName(e),0)),n;if((f=i[3])&&Z&&t.getElementsByClassName)return S.apply(n,x.call(t.getElementsByClassName(f),0)),n}return vt(e.replace(j,"$1"),t,n,r,a)}function rt(e){return function(t){var n=t.nodeName.toLowerCase();return n==="input"&&t.type===e}}function it(e){return function(t){var n=t.nodeName.toLowerCase();return(n==="input"||n==="button")&&t.type===e}}function st(e){return N(function(t){return t=+t,N(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function ot(e,t,n){if(e===t)return n;var r=e.nextSibling;while(r){if(r===t)return-1;r=r.nextSibling}return 1}function ut(e,t){var n,r,s,o,u,a,f,l=L[d][e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=i.preFilter;while(u){if(!n||(r=F.exec(u)))r&&(u=u.slice(r[0].length)||u),a.push(s=[]);n=!1;if(r=I.exec(u))s.push(n=new m(r.shift())),u=u.slice(n.length),n.type=r[0].replace(j," ");for(o in i.filter)(r=J[o].exec(u))&&(!f[o]||(r=f[o](r)))&&(s.push(n=new m(r.shift())),u=u.slice(n.length),n.type=o,n.matches=r);if(!n)break}return t?u.length:u?nt.error(e):L(e,a).slice(0)}function at(e,t,r){var i=t.dir,s=r&&t.dir==="parentNode",o=w++;return t.first?function(t,n,r){while(t=t[i])if(s||t.nodeType===1)return e(t,n,r)}:function(t,r,u){if(!u){var a,f=b+" "+o+" ",l=f+n;while(t=t[i])if(s||t.nodeType===1){if((a=t[d])===l)return t.sizset;if(typeof a=="string"&&a.indexOf(f)===0){if(t.sizset)return t}else{t[d]=l;if(e(t,r,u))return t.sizset=!0,t;t.sizset=!1}}}else while(t=t[i])if(s||t.nodeType===1)if(e(t,r,u))return t}}function ft(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function lt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=t!=null;for(;u<a;u++)if(s=e[u])if(!n||n(s,r,i))o.push(s),f&&t.push(u);return o}function ct(e,t,n,r,i,s){return r&&!r[d]&&(r=ct(r)),i&&!i[d]&&(i=ct(i,s)),N(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||dt(t||"*",u.nodeType?[u]:u,[]),m=e&&(s||!t)?lt(v,h,e,u,a):v,g=n?i||(s?e:d||r)?[]:o:m;n&&n(m,g,u,a);if(r){f=lt(g,p),r(f,[],u,a),l=f.length;while(l--)if(c=f[l])g[p[l]]=!(m[p[l]]=c)}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?T.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=lt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):S.apply(o,g)})}function ht(e){var t,n,r,s=e.length,o=i.relative[e[0].type],u=o||i.relative[" "],a=o?1:0,f=at(function(e){return e===t},u,!0),l=at(function(e){return T.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==c)||((t=n).nodeType?f(e,n,r):l(e,n,r))}];for(;a<s;a++)if(n=i.relative[e[a].type])h=[at(ft(h),n)];else{n=i.filter[e[a].type].apply(null,e[a].matches);if(n[d]){r=++a;for(;r<s;r++)if(i.relative[e[r].type])break;return ct(a>1&&ft(h),a>1&&e.slice(0,a-1).join("").replace(j,"$1"),n,a<r&&ht(e.slice(a,r)),r<s&&ht(e=e.slice(r)),r<s&&e.join(""))}h.push(n)}return ft(h)}function pt(e,t){var r=t.length>0,s=e.length>0,o=function(u,a,f,l,h){var p,d,v,m=[],y=0,w="0",x=u&&[],T=h!=null,N=c,C=u||s&&i.find.TAG("*",h&&a.parentNode||a),k=b+=N==null?1:Math.E;T&&(c=a!==g&&a,n=o.el);for(;(p=C[w])!=null;w++){if(s&&p){for(d=0;v=e[d];d++)if(v(p,a,f)){l.push(p);break}T&&(b=k,n=++o.el)}r&&((p=!v&&p)&&y--,u&&x.push(p))}y+=w;if(r&&w!==y){for(d=0;v=t[d];d++)v(x,m,a,f);if(u){if(y>0)while(w--)!x[w]&&!m[w]&&(m[w]=E.call(l));m=lt(m)}S.apply(l,m),T&&!u&&m.length>0&&y+t.length>1&&nt.uniqueSort(l)}return T&&(b=k,c=N),x};return o.el=0,r?N(o):o}function dt(e,t,n){var r=0,i=t.length;for(;r<i;r++)nt(e,t[r],n);return n}function vt(e,t,n,r,s){var o,u,f,l,c,h=ut(e),p=h.length;if(!r&&h.length===1){u=h[0]=h[0].slice(0);if(u.length>2&&(f=u[0]).type==="ID"&&t.nodeType===9&&!s&&i.relative[u[1].type]){t=i.find.ID(f.matches[0].replace($,""),t,s)[0];if(!t)return n;e=e.slice(u.shift().length)}for(o=J.POS.test(e)?-1:u.length-1;o>=0;o--){f=u[o];if(i.relative[l=f.type])break;if(c=i.find[l])if(r=c(f.matches[0].replace($,""),z.test(u[0].type)&&t.parentNode||t,s)){u.splice(o,1),e=r.length&&u.join("");if(!e)return S.apply(n,x.call(r,0)),n;break}}}return a(e,h)(r,t,s,n,z.test(e)),n}function mt(){}var n,r,i,s,o,u,a,f,l,c,h=!0,p="undefined",d=("sizcache"+Math.random()).replace(".",""),m=String,g=e.document,y=g.documentElement,b=0,w=0,E=[].pop,S=[].push,x=[].slice,T=[].indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(this[t]===e)return t;return-1},N=function(e,t){return e[d]=t==null||t,e},C=function(){var e={},t=[];return N(function(n,r){return t.push(n)>i.cacheLength&&delete e[t.shift()],e[n+" "]=r},e)},k=C(),L=C(),A=C(),O="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",_=M.replace("w","w#"),D="([*^$|!~]?=)",P="\\["+O+"*("+M+")"+O+"*(?:"+D+O+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+_+")|)|)"+O+"*\\]",H=":("+M+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+P+")|[^:]|\\\\.)*|.*))\\)|)",B=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+O+"*((?:-\\d)?\\d*)"+O+"*\\)|)(?=[^-]|$)",j=new RegExp("^"+O+"+|((?:^|[^\\\\])(?:\\\\.)*)"+O+"+$","g"),F=new RegExp("^"+O+"*,"+O+"*"),I=new RegExp("^"+O+"*([\\x20\\t\\r\\n\\f>+~])"+O+"*"),q=new RegExp(H),R=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,U=/^:not/,z=/[\x20\t\r\n\f]*[+~]/,W=/:not\($/,X=/h\d/i,V=/input|select|textarea|button/i,$=/\\(?!\\)/g,J={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),NAME:new RegExp("^\\[name=['\"]?("+M+")['\"]?\\]"),TAG:new RegExp("^("+M.replace("w","w*")+")"),ATTR:new RegExp("^"+P),PSEUDO:new RegExp("^"+H),POS:new RegExp(B,"i"),CHILD:new RegExp("^:(only|nth|first|last)-child(?:\\("+O+"*(even|odd|(([+-]|)(\\d*)n|)"+O+"*(?:([+-]|)"+O+"*(\\d+)|))"+O+"*\\)|)","i"),needsContext:new RegExp("^"+O+"*[>+~]|"+B,"i")},K=function(e){var t=g.createElement("div");try{return e(t)}catch(n){return!1}finally{t=null}},Q=K(function(e){return e.appendChild(g.createComment("")),!e.getElementsByTagName("*").length}),G=K(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==p&&e.firstChild.getAttribute("href")==="#"}),Y=K(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return t!=="boolean"&&t!=="string"}),Z=K(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!e.getElementsByClassName||!e.getElementsByClassName("e").length?!1:(e.lastChild.className="e",e.getElementsByClassName("e").length===2)}),et=K(function(e){e.id=d+0,e.innerHTML="<a name='"+d+"'></a><div name='"+d+"'></div>",y.insertBefore(e,y.firstChild);var t=g.getElementsByName&&g.getElementsByName(d).length===2+g.getElementsByName(d+0).length;return r=!g.getElementById(d),y.removeChild(e),t});try{x.call(y.childNodes,0)[0].nodeType}catch(tt){x=function(e){var t,n=[];for(;t=this[e];e++)n.push(t);return n}}nt.matches=function(e,t){return nt(e,null,null,t)},nt.matchesSelector=function(e,t){return nt(t,null,null,[e]).length>0},s=nt.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(i===1||i===9||i===11){if(typeof e.textContent=="string")return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=s(e)}else if(i===3||i===4)return e.nodeValue}else for(;t=e[r];r++)n+=s(t);return n},o=nt.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},u=nt.contains=y.contains?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!(r&&r.nodeType===1&&n.contains&&n.contains(r))}:y.compareDocumentPosition?function(e,t){return t&&!!(e.compareDocumentPosition(t)&16)}:function(e,t){while(t=t.parentNode)if(t===e)return!0;return!1},nt.attr=function(e,t){var n,r=o(e);return r||(t=t.toLowerCase()),(n=i.attrHandle[t])?n(e):r||Y?e.getAttribute(t):(n=e.getAttributeNode(t),n?typeof e[t]=="boolean"?e[t]?t:null:n.specified?n.value:null:null)},i=nt.selectors={cacheLength:50,createPseudo:N,match:J,attrHandle:G?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},find:{ID:r?function(e,t,n){if(typeof t.getElementById!==p&&!n){var r=t.getElementById(e);return r&&r.parentNode?[r]:[]}}:function(e,n,r){if(typeof n.getElementById!==p&&!r){var i=n.getElementById(e);return i?i.id===e||typeof i.getAttributeNode!==p&&i.getAttributeNode("id").value===e?[i]:t:[]}},TAG:Q?function(e,t){if(typeof t.getElementsByTagName!==p)return t.getElementsByTagName(e)}:function(e,t){var n=t.getElementsByTagName(e);if(e==="*"){var r,i=[],s=0;for(;r=n[s];s++)r.nodeType===1&&i.push(r);return i}return n},NAME:et&&function(e,t){if(typeof t.getElementsByName!==p)return t.getElementsByName(name)},CLASS:Z&&function(e,t,n){if(typeof t.getElementsByClassName!==p&&!n)return t.getElementsByClassName(e)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace($,""),e[3]=(e[4]||e[5]||"").replace($,""),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1]==="nth"?(e[2]||nt.error(e[0]),e[3]=+(e[3]?e[4]+(e[5]||1):2*(e[2]==="even"||e[2]==="odd")),e[4]=+(e[6]+e[7]||e[2]==="odd")):e[2]&&nt.error(e[0]),e},PSEUDO:function(e){var t,n;if(J.CHILD.test(e[0]))return null;if(e[3])e[2]=e[3];else if(t=e[4])q.test(t)&&(n=ut(t,!0))&&(n=t.indexOf(")",t.length-n)-t.length)&&(t=t.slice(0,n),e[0]=e[0].slice(0,n)),e[2]=t;return e.slice(0,3)}},filter:{ID:r?function(e){return e=e.replace($,""),function(t){return t.getAttribute("id")===e}}:function(e){return e=e.replace($,""),function(t){var n=typeof t.getAttributeNode!==p&&t.getAttributeNode("id");return n&&n.value===e}},TAG:function(e){return e==="*"?function(){return!0}:(e=e.replace($,"").toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=k[d][e+" "];return t||(t=new RegExp("(^|"+O+")"+e+"("+O+"|$)"))&&k(e,function(e){return t.test(e.className||typeof e.getAttribute!==p&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r,i){var s=nt.attr(r,e);return s==null?t==="!=":t?(s+="",t==="="?s===n:t==="!="?s!==n:t==="^="?n&&s.indexOf(n)===0:t==="*="?n&&s.indexOf(n)>-1:t==="$="?n&&s.substr(s.length-n.length)===n:t==="~="?(" "+s+" ").indexOf(n)>-1:t==="|="?s===n||s.substr(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r){return e==="nth"?function(e){var t,i,s=e.parentNode;if(n===1&&r===0)return!0;if(s){i=0;for(t=s.firstChild;t;t=t.nextSibling)if(t.nodeType===1){i++;if(e===t)break}}return i-=r,i===n||i%n===0&&i/n>=0}:function(t){var n=t;switch(e){case"only":case"first":while(n=n.previousSibling)if(n.nodeType===1)return!1;if(e==="first")return!0;n=t;case"last":while(n=n.nextSibling)if(n.nodeType===1)return!1;return!0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||nt.error("unsupported pseudo: "+e);return r[d]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?N(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=T.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:N(function(e){var t=[],n=[],r=a(e.replace(j,"$1"));return r[d]?N(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)if(s=o[u])e[u]=!(t[u]=s)}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:N(function(e){return function(t){return nt(e,t).length>0}}),contains:N(function(e){return function(t){return(t.textContent||t.innerText||s(t)).indexOf(e)>-1}}),enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},parent:function(e){return!i.pseudos.empty(e)},empty:function(e){var t;e=e.firstChild;while(e){if(e.nodeName>"@"||(t=e.nodeType)===3||t===4)return!1;e=e.nextSibling}return!0},header:function(e){return X.test(e.nodeName)},text:function(e){var t,n;return e.nodeName.toLowerCase()==="input"&&(t=e.type)==="text"&&((n=e.getAttribute("type"))==null||n.toLowerCase()===t)},radio:rt("radio"),checkbox:rt("checkbox"),file:rt("file"),password:rt("password"),image:rt("image"),submit:it("submit"),reset:it("reset"),button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},input:function(e){return V.test(e.nodeName)},focus:function(e){var t=e.ownerDocument;return e===t.activeElement&&(!t.hasFocus||t.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},active:function(e){return e===e.ownerDocument.activeElement},first:st(function(){return[0]}),last:st(function(e,t){return[t-1]}),eq:st(function(e,t,n){return[n<0?n+t:n]}),even:st(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:st(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:st(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e}),gt:st(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}},f=y.compareDocumentPosition?function(e,t){return e===t?(l=!0,0):(!e.compareDocumentPosition||!t.compareDocumentPosition?e.compareDocumentPosition:e.compareDocumentPosition(t)&4)?-1:1}:function(e,t){if(e===t)return l=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var n,r,i=[],s=[],o=e.parentNode,u=t.parentNode,a=o;if(o===u)return ot(e,t);if(!o)return-1;if(!u)return 1;while(a)i.unshift(a),a=a.parentNode;a=u;while(a)s.unshift(a),a=a.parentNode;n=i.length,r=s.length;for(var f=0;f<n&&f<r;f++)if(i[f]!==s[f])return ot(i[f],s[f]);return f===n?ot(e,s[f],-1):ot(i[f],t,1)},[0,0].sort(f),h=!l,nt.uniqueSort=function(e){var t,n=[],r=1,i=0;l=h,e.sort(f);if(l){for(;t=e[r];r++)t===e[r-1]&&(i=n.push(r));while(i--)e.splice(n[i],1)}return e},nt.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},a=nt.compile=function(e,t){var n,r=[],i=[],s=A[d][e+" "];if(!s){t||(t=ut(e)),n=t.length;while(n--)s=ht(t[n]),s[d]?r.push(s):i.push(s);s=A(e,pt(i,r))}return s},g.querySelectorAll&&function(){var e,t=vt,n=/'|\\/g,r=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,i=[":focus"],s=[":active"],u=y.matchesSelector||y.mozMatchesSelector||y.webkitMatchesSelector||y.oMatchesSelector||y.msMatchesSelector;K(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||i.push("\\["+O+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||i.push(":checked")}),K(function(e){e.innerHTML="<p test=''></p>",e.querySelectorAll("[test^='']").length&&i.push("[*^$]="+O+"*(?:\"\"|'')"),e.innerHTML="<input type='hidden'/>",e.querySelectorAll(":enabled").length||i.push(":enabled",":disabled")}),i=new RegExp(i.join("|")),vt=function(e,r,s,o,u){if(!o&&!u&&!i.test(e)){var a,f,l=!0,c=d,h=r,p=r.nodeType===9&&e;if(r.nodeType===1&&r.nodeName.toLowerCase()!=="object"){a=ut(e),(l=r.getAttribute("id"))?c=l.replace(n,"\\$&"):r.setAttribute("id",c),c="[id='"+c+"'] ",f=a.length;while(f--)a[f]=c+a[f].join("");h=z.test(e)&&r.parentNode||r,p=a.join(",")}if(p)try{return S.apply(s,x.call(h.querySelectorAll(p),0)),s}catch(v){}finally{l||r.removeAttribute("id")}}return t(e,r,s,o,u)},u&&(K(function(t){e=u.call(t,"div");try{u.call(t,"[test!='']:sizzle"),s.push("!=",H)}catch(n){}}),s=new RegExp(s.join("|")),nt.matchesSelector=function(t,n){n=n.replace(r,"='$1']");if(!o(t)&&!s.test(n)&&!i.test(n))try{var a=u.call(t,n);if(a||e||t.document&&t.document.nodeType!==11)return a}catch(f){}return nt(n,null,null,[t]).length>0})}(),i.pseudos.nth=i.pseudos.eq,i.filters=mt.prototype=i.pseudos,i.setFilters=new mt,nt.attr=v.attr,v.find=nt,v.expr=nt.selectors,v.expr[":"]=v.expr.pseudos,v.unique=nt.uniqueSort,v.text=nt.getText,v.isXMLDoc=nt.isXML,v.contains=nt.contains}(e);var nt=/Until$/,rt=/^(?:parents|prev(?:Until|All))/,it=/^.[^:#\[\.,]*$/,st=v.expr.match.needsContext,ot={children:!0,contents:!0,next:!0,prev:!0};v.fn.extend({find:function(e){var t,n,r,i,s,o,u=this;if(typeof e!="string")return v(e).filter(function(){for(t=0,n=u.length;t<n;t++)if(v.contains(u[t],this))return!0});o=this.pushStack("","find",e);for(t=0,n=this.length;t<n;t++){r=o.length,v.find(e,this[t],o);if(t>0)for(i=r;i<o.length;i++)for(s=0;s<r;s++)if(o[s]===o[i]){o.splice(i--,1);break}}return o},has:function(e){var t,n=v(e,this),r=n.length;return this.filter(function(){for(t=0;t<r;t++)if(v.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ft(this,e,!1),"not",e)},filter:function(e){return this.pushStack(ft(this,e,!0),"filter",e)},is:function(e){return!!e&&(typeof e=="string"?st.test(e)?v(e,this.context).index(this[0])>=0:v.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,s=[],o=st.test(e)||typeof e!="string"?v(e,t||this.context):0;for(;r<i;r++){n=this[r];while(n&&n.ownerDocument&&n!==t&&n.nodeType!==11){if(o?o.index(n)>-1:v.find.matchesSelector(n,e)){s.push(n);break}n=n.parentNode}}return s=s.length>1?v.unique(s):s,this.pushStack(s,"closest",e)},index:function(e){return e?typeof e=="string"?v.inArray(this[0],v(e)):v.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var n=typeof e=="string"?v(e,t):v.makeArray(e&&e.nodeType?[e]:e),r=v.merge(this.get(),n);return this.pushStack(ut(n[0])||ut(r[0])?r:v.unique(r))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),v.fn.andSelf=v.fn.addBack,v.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return v.dir(e,"parentNode")},parentsUntil:function(e,t,n){return v.dir(e,"parentNode",n)},next:function(e){return at(e,"nextSibling")},prev:function(e){return at(e,"previousSibling")},nextAll:function(e){return v.dir(e,"nextSibling")},prevAll:function(e){return v.dir(e,"previousSibling")},nextUntil:function(e,t,n){return v.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return v.dir(e,"previousSibling",n)},siblings:function(e){return v.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return v.sibling(e.firstChild)},contents:function(e){return v.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:v.merge([],e.childNodes)}},function(e,t){v.fn[e]=function(n,r){var i=v.map(this,t,n);return nt.test(e)||(r=n),r&&typeof r=="string"&&(i=v.filter(r,i)),i=this.length>1&&!ot[e]?v.unique(i):i,this.length>1&&rt.test(e)&&(i=i.reverse()),this.pushStack(i,e,l.call(arguments).join(","))}}),v.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),t.length===1?v.find.matchesSelector(t[0],e)?[t[0]]:[]:v.find.matches(e,t)},dir:function(e,n,r){var i=[],s=e[n];while(s&&s.nodeType!==9&&(r===t||s.nodeType!==1||!v(s).is(r)))s.nodeType===1&&i.push(s),s=s[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n}});var ct="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",ht=/ jQuery\d+="(?:null|\d+)"/g,pt=/^\s+/,dt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,vt=/<([\w:]+)/,mt=/<tbody/i,gt=/<|&#?\w+;/,yt=/<(?:script|style|link)/i,bt=/<(?:script|object|embed|option|style)/i,wt=new RegExp("<(?:"+ct+")[\\s/>]","i"),Et=/^(?:checkbox|radio)$/,St=/checked\s*(?:[^=]|=\s*.checked.)/i,xt=/\/(java|ecma)script/i,Tt=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,Nt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},Ct=lt(i),kt=Ct.appendChild(i.createElement("div"));Nt.optgroup=Nt.option,Nt.tbody=Nt.tfoot=Nt.colgroup=Nt.caption=Nt.thead,Nt.th=Nt.td,v.support.htmlSerialize||(Nt._default=[1,"X<div>","</div>"]),v.fn.extend({text:function(e){return v.access(this,function(e){return e===t?v.text(this):this.empty().append((this[0]&&this[0].ownerDocument||i).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(v.isFunction(e))return this.each(function(t){v(this).wrapAll(e.call(this,t))});if(this[0]){var t=v(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&e.firstChild.nodeType===1)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return v.isFunction(e)?this.each(function(t){v(this).wrapInner(e.call(this,t))}):this.each(function(){var t=v(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=v.isFunction(e);return this.each(function(n){v(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){v.nodeName(this,"body")||v(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.insertBefore(e,this.firstChild)})},before:function(){if(!ut(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)});if(arguments.length){var e=v.clean(arguments);return this.pushStack(v.merge(e,this),"before",this.selector)}},after:function(){if(!ut(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)});if(arguments.length){var e=v.clean(arguments);return this.pushStack(v.merge(this,e),"after",this.selector)}},remove:function(e,t){var n,r=0;for(;(n=this[r])!=null;r++)if(!e||v.filter(e,[n]).length)!t&&n.nodeType===1&&(v.cleanData(n.getElementsByTagName("*")),v.cleanData([n])),n.parentNode&&n.parentNode.removeChild(n);return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++){e.nodeType===1&&v.cleanData(e.getElementsByTagName("*"));while(e.firstChild)e.removeChild(e.firstChild)}return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return v.clone(this,e,t)})},html:function(e){return v.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return n.nodeType===1?n.innerHTML.replace(ht,""):t;if(typeof e=="string"&&!yt.test(e)&&(v.support.htmlSerialize||!wt.test(e))&&(v.support.leadingWhitespace||!pt.test(e))&&!Nt[(vt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(dt,"<$1></$2>");try{for(;r<i;r++)n=this[r]||{},n.nodeType===1&&(v.cleanData(n.getElementsByTagName("*")),n.innerHTML=e);n=0}catch(s){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){return ut(this[0])?this.length?this.pushStack(v(v.isFunction(e)?e():e),"replaceWith",e):this:v.isFunction(e)?this.each(function(t){var n=v(this),r=n.html();n.replaceWith(e.call(this,t,r))}):(typeof e!="string"&&(e=v(e).detach()),this.each(function(){var t=this.nextSibling,n=this.parentNode;v(this).remove(),t?v(t).before(e):v(n).append(e)}))},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=[].concat.apply([],e);var i,s,o,u,a=0,f=e[0],l=[],c=this.length;if(!v.support.checkClone&&c>1&&typeof f=="string"&&St.test(f))return this.each(function(){v(this).domManip(e,n,r)});if(v.isFunction(f))return this.each(function(i){var s=v(this);e[0]=f.call(this,i,n?s.html():t),s.domManip(e,n,r)});if(this[0]){i=v.buildFragment(e,this,l),o=i.fragment,s=o.firstChild,o.childNodes.length===1&&(o=s);if(s){n=n&&v.nodeName(s,"tr");for(u=i.cacheable||c-1;a<c;a++)r.call(n&&v.nodeName(this[a],"table")?Lt(this[a],"tbody"):this[a],a===u?o:v.clone(o,!0,!0))}o=s=null,l.length&&v.each(l,function(e,t){t.src?v.ajax?v.ajax({url:t.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):v.error("no ajax"):v.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Tt,"")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),v.buildFragment=function(e,n,r){var s,o,u,a=e[0];return n=n||i,n=!n.nodeType&&n[0]||n,n=n.ownerDocument||n,e.length===1&&typeof a=="string"&&a.length<512&&n===i&&a.charAt(0)==="<"&&!bt.test(a)&&(v.support.checkClone||!St.test(a))&&(v.support.html5Clone||!wt.test(a))&&(o=!0,s=v.fragments[a],u=s!==t),s||(s=n.createDocumentFragment(),v.clean(e,n,s,r),o&&(v.fragments[a]=u&&s)),{fragment:s,cacheable:o}},v.fragments={},v.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){v.fn[e]=function(n){var r,i=0,s=[],o=v(n),u=o.length,a=this.length===1&&this[0].parentNode;if((a==null||a&&a.nodeType===11&&a.childNodes.length===1)&&u===1)return o[t](this[0]),this;for(;i<u;i++)r=(i>0?this.clone(!0):this).get(),v(o[i])[t](r),s=s.concat(r);return this.pushStack(s,e,o.selector)}}),v.extend({clone:function(e,t,n){var r,i,s,o;v.support.html5Clone||v.isXMLDoc(e)||!wt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(kt.innerHTML=e.outerHTML,kt.removeChild(o=kt.firstChild));if((!v.support.noCloneEvent||!v.support.noCloneChecked)&&(e.nodeType===1||e.nodeType===11)&&!v.isXMLDoc(e)){Ot(e,o),r=Mt(e),i=Mt(o);for(s=0;r[s];++s)i[s]&&Ot(r[s],i[s])}if(t){At(e,o);if(n){r=Mt(e),i=Mt(o);for(s=0;r[s];++s)At(r[s],i[s])}}return r=i=null,o},clean:function(e,t,n,r){var s,o,u,a,f,l,c,h,p,d,m,g,y=t===i&&Ct,b=[];if(!t||typeof t.createDocumentFragment=="undefined")t=i;for(s=0;(u=e[s])!=null;s++){typeof u=="number"&&(u+="");if(!u)continue;if(typeof u=="string")if(!gt.test(u))u=t.createTextNode(u);else{y=y||lt(t),c=t.createElement("div"),y.appendChild(c),u=u.replace(dt,"<$1></$2>"),a=(vt.exec(u)||["",""])[1].toLowerCase(),f=Nt[a]||Nt._default,l=f[0],c.innerHTML=f[1]+u+f[2];while(l--)c=c.lastChild;if(!v.support.tbody){h=mt.test(u),p=a==="table"&&!h?c.firstChild&&c.firstChild.childNodes:f[1]==="<table>"&&!h?c.childNodes:[];for(o=p.length-1;o>=0;--o)v.nodeName(p[o],"tbody")&&!p[o].childNodes.length&&p[o].parentNode.removeChild(p[o])}!v.support.leadingWhitespace&&pt.test(u)&&c.insertBefore(t.createTextNode(pt.exec(u)[0]),c.firstChild),u=c.childNodes,c.parentNode.removeChild(c)}u.nodeType?b.push(u):v.merge(b,u)}c&&(u=c=y=null);if(!v.support.appendChecked)for(s=0;(u=b[s])!=null;s++)v.nodeName(u,"input")?_t(u):typeof u.getElementsByTagName!="undefined"&&v.grep(u.getElementsByTagName("input"),_t);if(n){m=function(e){if(!e.type||xt.test(e.type))return r?r.push(e.parentNode?e.parentNode.removeChild(e):e):n.appendChild(e)};for(s=0;(u=b[s])!=null;s++)if(!v.nodeName(u,"script")||!m(u))n.appendChild(u),typeof u.getElementsByTagName!="undefined"&&(g=v.grep(v.merge([],u.getElementsByTagName("script")),m),b.splice.apply(b,[s+1,0].concat(g)),s+=g.length)}return b},cleanData:function(e,t){var n,r,i,s,o=0,u=v.expando,a=v.cache,f=v.support.deleteExpando,l=v.event.special;for(;(i=e[o])!=null;o++)if(t||v.acceptData(i)){r=i[u],n=r&&a[r];if(n){if(n.events)for(s in n.events)l[s]?v.event.remove(i,s):v.removeEvent(i,s,n.handle);a[r]&&(delete a[r],f?delete i[u]:i.removeAttribute?i.removeAttribute(u):i[u]=null,v.deletedIds.push(r))}}}}),function(){var e,t;v.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e=v.uaMatch(o.userAgent),t={},e.browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),v.browser=t,v.sub=function(){function e(t,n){return new e.fn.init(t,n)}v.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function(r,i){return i&&i instanceof v&&!(i instanceof e)&&(i=e(i)),v.fn.init.call(this,r,i,t)},e.fn.init.prototype=e.fn;var t=e(i);return e}}();var Dt,Pt,Ht,Bt=/alpha\([^)]*\)/i,jt=/opacity=([^)]*)/,Ft=/^(top|right|bottom|left)$/,It=/^(none|table(?!-c[ea]).+)/,qt=/^margin/,Rt=new RegExp("^("+m+")(.*)$","i"),Ut=new RegExp("^("+m+")(?!px)[a-z%]+$","i"),zt=new RegExp("^([-+])=("+m+")","i"),Wt={BODY:"block"},Xt={position:"absolute",visibility:"hidden",display:"block"},Vt={letterSpacing:0,fontWeight:400},$t=["Top","Right","Bottom","Left"],Jt=["Webkit","O","Moz","ms"],Kt=v.fn.toggle;v.fn.extend({css:function(e,n){return v.access(this,function(e,n,r){return r!==t?v.style(e,n,r):v.css(e,n)},e,n,arguments.length>1)},show:function(){return Yt(this,!0)},hide:function(){return Yt(this)},toggle:function(e,t){var n=typeof e=="boolean";return v.isFunction(e)&&v.isFunction(t)?Kt.apply(this,arguments):this.each(function(){(n?e:Gt(this))?v(this).show():v(this).hide()})}}),v.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Dt(e,"opacity");return n===""?"1":n}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":v.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var s,o,u,a=v.camelCase(n),f=e.style;n=v.cssProps[a]||(v.cssProps[a]=Qt(f,a)),u=v.cssHooks[n]||v.cssHooks[a];if(r===t)return u&&"get"in u&&(s=u.get(e,!1,i))!==t?s:f[n];o=typeof r,o==="string"&&(s=zt.exec(r))&&(r=(s[1]+1)*s[2]+parseFloat(v.css(e,n)),o="number");if(r==null||o==="number"&&isNaN(r))return;o==="number"&&!v.cssNumber[a]&&(r+="px");if(!u||!("set"in u)||(r=u.set(e,r,i))!==t)try{f[n]=r}catch(l){}},css:function(e,n,r,i){var s,o,u,a=v.camelCase(n);return n=v.cssProps[a]||(v.cssProps[a]=Qt(e.style,a)),u=v.cssHooks[n]||v.cssHooks[a],u&&"get"in u&&(s=u.get(e,!0,i)),s===t&&(s=Dt(e,n)),s==="normal"&&n in Vt&&(s=Vt[n]),r||i!==t?(o=parseFloat(s),r||v.isNumeric(o)?o||0:s):s},swap:function(e,t,n){var r,i,s={};for(i in t)s[i]=e.style[i],e.style[i]=t[i];r=n.call(e);for(i in t)e.style[i]=s[i];return r}}),e.getComputedStyle?Dt=function(t,n){var r,i,s,o,u=e.getComputedStyle(t,null),a=t.style;return u&&(r=u.getPropertyValue(n)||u[n],r===""&&!v.contains(t.ownerDocument,t)&&(r=v.style(t,n)),Ut.test(r)&&qt.test(n)&&(i=a.width,s=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=r,r=u.width,a.width=i,a.minWidth=s,a.maxWidth=o)),r}:i.documentElement.currentStyle&&(Dt=function(e,t){var n,r,i=e.currentStyle&&e.currentStyle[t],s=e.style;return i==null&&s&&s[t]&&(i=s[t]),Ut.test(i)&&!Ft.test(t)&&(n=s.left,r=e.runtimeStyle&&e.runtimeStyle.left,r&&(e.runtimeStyle.left=e.currentStyle.left),s.left=t==="fontSize"?"1em":i,i=s.pixelLeft+"px",s.left=n,r&&(e.runtimeStyle.left=r)),i===""?"auto":i}),v.each(["height","width"],function(e,t){v.cssHooks[t]={get:function(e,n,r){if(n)return e.offsetWidth===0&&It.test(Dt(e,"display"))?v.swap(e,Xt,function(){return tn(e,t,r)}):tn(e,t,r)},set:function(e,n,r){return Zt(e,n,r?en(e,t,r,v.support.boxSizing&&v.css(e,"boxSizing")==="border-box"):0)}}}),v.support.opacity||(v.cssHooks.opacity={get:function(e,t){return jt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=v.isNumeric(t)?"alpha(opacity="+t*100+")":"",s=r&&r.filter||n.filter||"";n.zoom=1;if(t>=1&&v.trim(s.replace(Bt,""))===""&&n.removeAttribute){n.removeAttribute("filter");if(r&&!r.filter)return}n.filter=Bt.test(s)?s.replace(Bt,i):s+" "+i}}),v(function(){v.support.reliableMarginRight||(v.cssHooks.marginRight={get:function(e,t){return v.swap(e,{display:"inline-block"},function(){if(t)return Dt(e,"marginRight")})}}),!v.support.pixelPosition&&v.fn.position&&v.each(["top","left"],function(e,t){v.cssHooks[t]={get:function(e,n){if(n){var r=Dt(e,t);return Ut.test(r)?v(e).position()[t]+"px":r}}}})}),v.expr&&v.expr.filters&&(v.expr.filters.hidden=function(e){return e.offsetWidth===0&&e.offsetHeight===0||!v.support.reliableHiddenOffsets&&(e.style&&e.style.display||Dt(e,"display"))==="none"},v.expr.filters.visible=function(e){return!v.expr.filters.hidden(e)}),v.each({margin:"",padding:"",border:"Width"},function(e,t){v.cssHooks[e+t]={expand:function(n){var r,i=typeof n=="string"?n.split(" "):[n],s={};for(r=0;r<4;r++)s[e+$t[r]+t]=i[r]||i[r-2]||i[0];return s}},qt.test(e)||(v.cssHooks[e+t].set=Zt)});var rn=/%20/g,sn=/\[\]$/,on=/\r?\n/g,un=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,an=/^(?:select|textarea)/i;v.fn.extend({serialize:function(){return v.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?v.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||an.test(this.nodeName)||un.test(this.type))}).map(function(e,t){var n=v(this).val();return n==null?null:v.isArray(n)?v.map(n,function(e,n){return{name:t.name,value:e.replace(on,"\r\n")}}):{name:t.name,value:n.replace(on,"\r\n")}}).get()}}),v.param=function(e,n){var r,i=[],s=function(e,t){t=v.isFunction(t)?t():t==null?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};n===t&&(n=v.ajaxSettings&&v.ajaxSettings.traditional);if(v.isArray(e)||e.jquery&&!v.isPlainObject(e))v.each(e,function(){s(this.name,this.value)});else for(r in e)fn(r,e[r],n,s);return i.join("&").replace(rn,"+")};var ln,cn,hn=/#.*$/,pn=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,dn=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,vn=/^(?:GET|HEAD)$/,mn=/^\/\//,gn=/\?/,yn=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bn=/([?&])_=[^&]*/,wn=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,En=v.fn.load,Sn={},xn={},Tn=["*/"]+["*"];try{cn=s.href}catch(Nn){cn=i.createElement("a"),cn.href="",cn=cn.href}ln=wn.exec(cn.toLowerCase())||[],v.fn.load=function(e,n,r){if(typeof e!="string"&&En)return En.apply(this,arguments);if(!this.length)return this;var i,s,o,u=this,a=e.indexOf(" ");return a>=0&&(i=e.slice(a,e.length),e=e.slice(0,a)),v.isFunction(n)?(r=n,n=t):n&&typeof n=="object"&&(s="POST"),v.ajax({url:e,type:s,dataType:"html",data:n,complete:function(e,t){r&&u.each(r,o||[e.responseText,t,e])}}).done(function(e){o=arguments,u.html(i?v("<div>").append(e.replace(yn,"")).find(i):e)}),this},v.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){v.fn[t]=function(e){return this.on(t,e)}}),v.each(["get","post"],function(e,n){v[n]=function(e,r,i,s){return v.isFunction(r)&&(s=s||i,i=r,r=t),v.ajax({type:n,url:e,data:r,success:i,dataType:s})}}),v.extend({getScript:function(e,n){return v.get(e,t,n,"script")},getJSON:function(e,t,n){return v.get(e,t,n,"json")},ajaxSetup:function(e,t){return t?Ln(e,v.ajaxSettings):(t=e,e=v.ajaxSettings),Ln(e,t),e},ajaxSettings:{url:cn,isLocal:dn.test(ln[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":Tn},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":v.parseJSON,"text xml":v.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:Cn(Sn),ajaxTransport:Cn(xn),ajax:function(e,n){function T(e,n,s,a){var l,y,b,w,S,T=n;if(E===2)return;E=2,u&&clearTimeout(u),o=t,i=a||"",x.readyState=e>0?4:0,s&&(w=An(c,x,s));if(e>=200&&e<300||e===304)c.ifModified&&(S=x.getResponseHeader("Last-Modified"),S&&(v.lastModified[r]=S),S=x.getResponseHeader("Etag"),S&&(v.etag[r]=S)),e===304?(T="notmodified",l=!0):(l=On(c,w),T=l.state,y=l.data,b=l.error,l=!b);else{b=T;if(!T||e)T="error",e<0&&(e=0)}x.status=e,x.statusText=(n||T)+"",l?d.resolveWith(h,[y,T,x]):d.rejectWith(h,[x,T,b]),x.statusCode(g),g=t,f&&p.trigger("ajax"+(l?"Success":"Error"),[x,c,l?y:b]),m.fireWith(h,[x,T]),f&&(p.trigger("ajaxComplete",[x,c]),--v.active||v.event.trigger("ajaxStop"))}typeof e=="object"&&(n=e,e=t),n=n||{};var r,i,s,o,u,a,f,l,c=v.ajaxSetup({},n),h=c.context||c,p=h!==c&&(h.nodeType||h instanceof v)?v(h):v.event,d=v.Deferred(),m=v.Callbacks("once memory"),g=c.statusCode||{},b={},w={},E=0,S="canceled",x={readyState:0,setRequestHeader:function(e,t){if(!E){var n=e.toLowerCase();e=w[n]=w[n]||e,b[e]=t}return this},getAllResponseHeaders:function(){return E===2?i:null},getResponseHeader:function(e){var n;if(E===2){if(!s){s={};while(n=pn.exec(i))s[n[1].toLowerCase()]=n[2]}n=s[e.toLowerCase()]}return n===t?null:n},overrideMimeType:function(e){return E||(c.mimeType=e),this},abort:function(e){return e=e||S,o&&o.abort(e),T(0,e),this}};d.promise(x),x.success=x.done,x.error=x.fail,x.complete=m.add,x.statusCode=function(e){if(e){var t;if(E<2)for(t in e)g[t]=[g[t],e[t]];else t=e[x.status],x.always(t)}return this},c.url=((e||c.url)+"").replace(hn,"").replace(mn,ln[1]+"//"),c.dataTypes=v.trim(c.dataType||"*").toLowerCase().split(y),c.crossDomain==null&&(a=wn.exec(c.url.toLowerCase()),c.crossDomain=!(!a||a[1]===ln[1]&&a[2]===ln[2]&&(a[3]||(a[1]==="http:"?80:443))==(ln[3]||(ln[1]==="http:"?80:443)))),c.data&&c.processData&&typeof c.data!="string"&&(c.data=v.param(c.data,c.traditional)),kn(Sn,c,n,x);if(E===2)return x;f=c.global,c.type=c.type.toUpperCase(),c.hasContent=!vn.test(c.type),f&&v.active++===0&&v.event.trigger("ajaxStart");if(!c.hasContent){c.data&&(c.url+=(gn.test(c.url)?"&":"?")+c.data,delete c.data),r=c.url;if(c.cache===!1){var N=v.now(),C=c.url.replace(bn,"$1_="+N);c.url=C+(C===c.url?(gn.test(c.url)?"&":"?")+"_="+N:"")}}(c.data&&c.hasContent&&c.contentType!==!1||n.contentType)&&x.setRequestHeader("Content-Type",c.contentType),c.ifModified&&(r=r||c.url,v.lastModified[r]&&x.setRequestHeader("If-Modified-Since",v.lastModified[r]),v.etag[r]&&x.setRequestHeader("If-None-Match",v.etag[r])),x.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+(c.dataTypes[0]!=="*"?", "+Tn+"; q=0.01":""):c.accepts["*"]);for(l in c.headers)x.setRequestHeader(l,c.headers[l]);if(!c.beforeSend||c.beforeSend.call(h,x,c)!==!1&&E!==2){S="abort";for(l in{success:1,error:1,complete:1})x[l](c[l]);o=kn(xn,c,n,x);if(!o)T(-1,"No Transport");else{x.readyState=1,f&&p.trigger("ajaxSend",[x,c]),c.async&&c.timeout>0&&(u=setTimeout(function(){x.abort("timeout")},c.timeout));try{E=1,o.send(b,T)}catch(k){if(!(E<2))throw k;T(-1,k)}}return x}return x.abort()},active:0,lastModified:{},etag:{}});var Mn=[],_n=/\?/,Dn=/(=)\?(?=&|$)|\?\?/,Pn=v.now();v.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Mn.pop()||v.expando+"_"+Pn++;return this[e]=!0,e}}),v.ajaxPrefilter("json jsonp",function(n,r,i){var s,o,u,a=n.data,f=n.url,l=n.jsonp!==!1,c=l&&Dn.test(f),h=l&&!c&&typeof a=="string"&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Dn.test(a);if(n.dataTypes[0]==="jsonp"||c||h)return s=n.jsonpCallback=v.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,o=e[s],c?n.url=f.replace(Dn,"$1"+s):h?n.data=a.replace(Dn,"$1"+s):l&&(n.url+=(_n.test(f)?"&":"?")+n.jsonp+"="+s),n.converters["script json"]=function(){return u||v.error(s+" was not called"),u[0]},n.dataTypes[0]="json",e[s]=function(){u=arguments},i.always(function(){e[s]=o,n[s]&&(n.jsonpCallback=r.jsonpCallback,Mn.push(s)),u&&v.isFunction(o)&&o(u[0]),u=o=t}),"script"}),v.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return v.globalEval(e),e}}}),v.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),v.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=i.head||i.getElementsByTagName("head")[0]||i.documentElement;return{send:function(s,o){n=i.createElement("script"),n.async="async",e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,i){if(i||!n.readyState||/loaded|complete/.test(n.readyState))n.onload=n.onreadystatechange=null,r&&n.parentNode&&r.removeChild(n),n=t,i||o(200,"success")},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(0,1)}}}});var Hn,Bn=e.ActiveXObject?function(){for(var e in Hn)Hn[e](0,1)}:!1,jn=0;v.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&Fn()||In()}:Fn,function(e){v.extend(v.support,{ajax:!!e,cors:!!e&&"withCredentials"in e})}(v.ajaxSettings.xhr()),v.support.ajax&&v.ajaxTransport(function(n){if(!n.crossDomain||v.support.cors){var r;return{send:function(i,s){var o,u,a=n.xhr();n.username?a.open(n.type,n.url,n.async,n.username,n.password):a.open(n.type,n.url,n.async);if(n.xhrFields)for(u in n.xhrFields)a[u]=n.xhrFields[u];n.mimeType&&a.overrideMimeType&&a.overrideMimeType(n.mimeType),!n.crossDomain&&!i["X-Requested-With"]&&(i["X-Requested-With"]="XMLHttpRequest");try{for(u in i)a.setRequestHeader(u,i[u])}catch(f){}a.send(n.hasContent&&n.data||null),r=function(e,i){var u,f,l,c,h;try{if(r&&(i||a.readyState===4)){r=t,o&&(a.onreadystatechange=v.noop,Bn&&delete Hn[o]);if(i)a.readyState!==4&&a.abort();else{u=a.status,l=a.getAllResponseHeaders(),c={},h=a.responseXML,h&&h.documentElement&&(c.xml=h);try{c.text=a.responseText}catch(p){}try{f=a.statusText}catch(p){f=""}!u&&n.isLocal&&!n.crossDomain?u=c.text?200:404:u===1223&&(u=204)}}}catch(d){i||s(-1,d)}c&&s(u,f,c,l)},n.async?a.readyState===4?setTimeout(r,0):(o=++jn,Bn&&(Hn||(Hn={},v(e).unload(Bn)),Hn[o]=r),a.onreadystatechange=r):r()},abort:function(){r&&r(0,1)}}}});var qn,Rn,Un=/^(?:toggle|show|hide)$/,zn=new RegExp("^(?:([-+])=|)("+m+")([a-z%]*)$","i"),Wn=/queueHooks$/,Xn=[Gn],Vn={"*":[function(e,t){var n,r,i=this.createTween(e,t),s=zn.exec(t),o=i.cur(),u=+o||0,a=1,f=20;if(s){n=+s[2],r=s[3]||(v.cssNumber[e]?"":"px");if(r!=="px"&&u){u=v.css(i.elem,e,!0)||n||1;do a=a||".5",u/=a,v.style(i.elem,e,u+r);while(a!==(a=i.cur()/o)&&a!==1&&--f)}i.unit=r,i.start=u,i.end=s[1]?u+(s[1]+1)*n:n}return i}]};v.Animation=v.extend(Kn,{tweener:function(e,t){v.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;r<i;r++)n=e[r],Vn[n]=Vn[n]||[],Vn[n].unshift(t)},prefilter:function(e,t){t?Xn.unshift(e):Xn.push(e)}}),v.Tween=Yn,Yn.prototype={constructor:Yn,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(v.cssNumber[n]?"":"px")},cur:function(){var e=Yn.propHooks[this.prop];return e&&e.get?e.get(this):Yn.propHooks._default.get(this)},run:function(e){var t,n=Yn.propHooks[this.prop];return this.options.duration?this.pos=t=v.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Yn.propHooks._default.set(this),this}},Yn.prototype.init.prototype=Yn.prototype,Yn.propHooks={_default:{get:function(e){var t;return e.elem[e.prop]==null||!!e.elem.style&&e.elem.style[e.prop]!=null?(t=v.css(e.elem,e.prop,!1,""),!t||t==="auto"?0:t):e.elem[e.prop]},set:function(e){v.fx.step[e.prop]?v.fx.step[e.prop](e):e.elem.style&&(e.elem.style[v.cssProps[e.prop]]!=null||v.cssHooks[e.prop])?v.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Yn.propHooks.scrollTop=Yn.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},v.each(["toggle","show","hide"],function(e,t){var n=v.fn[t];v.fn[t]=function(r,i,s){return r==null||typeof r=="boolean"||!e&&v.isFunction(r)&&v.isFunction(i)?n.apply(this,arguments):this.animate(Zn(t,!0),r,i,s)}}),v.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Gt).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=v.isEmptyObject(e),s=v.speed(t,n,r),o=function(){var t=Kn(this,v.extend({},e),s);i&&t.stop(!0)};return i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return typeof e!="string"&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=e!=null&&e+"queueHooks",s=v.timers,o=v._data(this);if(n)o[n]&&o[n].stop&&i(o[n]);else for(n in o)o[n]&&o[n].stop&&Wn.test(n)&&i(o[n]);for(n=s.length;n--;)s[n].elem===this&&(e==null||s[n].queue===e)&&(s[n].anim.stop(r),t=!1,s.splice(n,1));(t||!r)&&v.dequeue(this,e)})}}),v.each({slideDown:Zn("show"),slideUp:Zn("hide"),slideToggle:Zn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){v.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),v.speed=function(e,t,n){var r=e&&typeof e=="object"?v.extend({},e):{complete:n||!n&&t||v.isFunction(e)&&e,duration:e,easing:n&&t||t&&!v.isFunction(t)&&t};r.duration=v.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in v.fx.speeds?v.fx.speeds[r.duration]:v.fx.speeds._default;if(r.queue==null||r.queue===!0)r.queue="fx";return r.old=r.complete,r.complete=function(){v.isFunction(r.old)&&r.old.call(this),r.queue&&v.dequeue(this,r.queue)},r},v.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},v.timers=[],v.fx=Yn.prototype.init,v.fx.tick=function(){var e,n=v.timers,r=0;qn=v.now();for(;r<n.length;r++)e=n[r],!e()&&n[r]===e&&n.splice(r--,1);n.length||v.fx.stop(),qn=t},v.fx.timer=function(e){e()&&v.timers.push(e)&&!Rn&&(Rn=setInterval(v.fx.tick,v.fx.interval))},v.fx.interval=13,v.fx.stop=function(){clearInterval(Rn),Rn=null},v.fx.speeds={slow:600,fast:200,_default:400},v.fx.step={},v.expr&&v.expr.filters&&(v.expr.filters.animated=function(e){return v.grep(v.timers,function(t){return e===t.elem}).length});var er=/^(?:body|html)$/i;v.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){v.offset.setOffset(this,e,t)});var n,r,i,s,o,u,a,f={top:0,left:0},l=this[0],c=l&&l.ownerDocument;if(!c)return;return(r=c.body)===l?v.offset.bodyOffset(l):(n=c.documentElement,v.contains(n,l)?(typeof l.getBoundingClientRect!="undefined"&&(f=l.getBoundingClientRect()),i=tr(c),s=n.clientTop||r.clientTop||0,o=n.clientLeft||r.clientLeft||0,u=i.pageYOffset||n.scrollTop,a=i.pageXOffset||n.scrollLeft,{top:f.top+u-s,left:f.left+a-o}):f)},v.offset={bodyOffset:function(e){var t=e.offsetTop,n=e.offsetLeft;return v.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(v.css(e,"marginTop"))||0,n+=parseFloat(v.css(e,"marginLeft"))||0),{top:t,left:n}},setOffset:function(e,t,n){var r=v.css(e,"position");r==="static"&&(e.style.position="relative");var i=v(e),s=i.offset(),o=v.css(e,"top"),u=v.css(e,"left"),a=(r==="absolute"||r==="fixed")&&v.inArray("auto",[o,u])>-1,f={},l={},c,h;a?(l=i.position(),c=l.top,h=l.left):(c=parseFloat(o)||0,h=parseFloat(u)||0),v.isFunction(t)&&(t=t.call(e,n,s)),t.top!=null&&(f.top=t.top-s.top+c),t.left!=null&&(f.left=t.left-s.left+h),"using"in t?t.using.call(e,f):i.css(f)}},v.fn.extend({position:function(){if(!this[0])return;var e=this[0],t=this.offsetParent(),n=this.offset(),r=er.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(v.css(e,"marginTop"))||0,n.left-=parseFloat(v.css(e,"marginLeft"))||0,r.top+=parseFloat(v.css(t[0],"borderTopWidth"))||0,r.left+=parseFloat(v.css(t[0],"borderLeftWidth"))||0,{top:n.top-r.top,left:n.left-r.left}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||i.body;while(e&&!er.test(e.nodeName)&&v.css(e,"position")==="static")e=e.offsetParent;return e||i.body})}}),v.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);v.fn[e]=function(i){return v.access(this,function(e,i,s){var o=tr(e);if(s===t)return o?n in o?o[n]:o.document.documentElement[i]:e[i];o?o.scrollTo(r?v(o).scrollLeft():s,r?s:v(o).scrollTop()):e[i]=s},e,i,arguments.length,null)}}),v.each({Height:"height",Width:"width"},function(e,n){v.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){v.fn[i]=function(i,s){var o=arguments.length&&(r||typeof i!="boolean"),u=r||(i===!0||s===!0?"margin":"border");return v.access(this,function(n,r,i){var s;return v.isWindow(n)?n.document.documentElement["client"+e]:n.nodeType===9?(s=n.documentElement,Math.max(n.body["scroll"+e],s["scroll"+e],n.body["offset"+e],s["offset"+e],s["client"+e])):i===t?v.css(n,r,i,u):v.style(n,r,i,u)},n,o?i:t,o,null)}})}),e.jQuery=e.$=v,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return v})})(window);(function(g){var h={xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",html:"http://www.w3.org/1999/xhtml/"};var n={};for(var c in h){n[h[c]]=c}g.extend({xmlns:g.extend({},h,{"":"*"})});var i=[];g.fn.extend({xmlns:function(q,r){if(typeof q=="string"){q={"":q}}if(q){i.push(g.xmlns);g.xmlns=g.extend({},g.xmlns,q);if(r!==undefined){if(typeof r=="string"){return this.find(r).xmlns(undefined)}else{var p=this;try{p=r.call(this);if(!p){p=this}}finally{p.xmlns(undefined)}return p}}else{return this}}else{g.xmlns=(i?i.pop():{});return this}}});var l=function(q){if(!q){return g.xmlns[""]}q=q.substr(0,q.length-1);if(q==""||q=="*"){return q}var p=g.xmlns[q];if(typeof(p)=="undefined"){throw"Syntax error, undefined namespace prefix '"+q+"'"}return p};var e=function(p,q){g.expr.match[p]=new RegExp(q.source+/(?![^\[]*\])(?![^\(]*\))/.source);if(g.expr.leftMatch){g.expr.leftMatch[p]=new RegExp(/(^(?:.|\r|\n)*?)/.source+g.expr.match[p].source.replace(/\\(\d+)/g,function(s,r){return"\\"+(r-0+1)}))}};e("TAG",/^((?:((?:[\w\u00c0-\uFFFF\*_-]*\|)?)((?:[\w\u00c0-\uFFFF\*_-]|\\.)+)))/);var a=document.createElement("div");var b=false;a.appendChild(document.createComment(""));if(a.getElementsByTagName("*").length>0){b=true}var o=true;if(a.localName&&a.localName=="div"){o=false}a=null;g.expr.find.TAG=function(s,p,x){var v=l(s[2]);var t=s[3];var u;if(typeof p.getElementsByTagNameNS!="undefined"){u=p.getElementsByTagNameNS(v,t)}else{if(typeof p.selectNodes!="undefined"){if(p.ownerDocument){p.ownerDocument.setProperty("SelectionLanguage","XPath")}else{p.setProperty("SelectionLanguage","XPath")}var w="";if(v!="*"){if(t!="*"){w="namespace-uri()='"+v+"' and local-name()='"+t+"'"}else{w="namespace-uri()='"+v+"'"}}else{if(t!="*"){w="local-name()='"+t+"'"}}if(w){u=p.selectNodes("descendant-or-self::*["+w+"]")}else{u=p.selectNodes("descendant-or-self::*")}}else{u=p.getElementsByTagName(t);if(b&&t=="*"){var r=[];for(var q=0;u[q];q++){if(u[q].nodeType==1){r.push(u[q])}}u=r}if(u&&v!="*"){var r=[];for(var q=0;u[q];q++){if(u[q].namespaceURI==v||u[q].tagUrn==v){r.push(u[q])}}u=r}}}return u};var m=function(p){return p.nodeType===9&&p.documentElement.nodeName!=="HTML"||!!p.ownerDocument&&p.ownerDocument.documentElement.nodeName!=="HTML"};g.expr.preFilter.TAG=function(s,q,r,p,u,v){var t=s[3];if(!v){if(o){t=t.toUpperCase()}else{t=t.toLowerCase()}}return[s[0],l(s[2]),t]};g.expr.filter.TAG=function(u,p){var s=p[1];var t=p[2];var q=u.namespaceURI?u.namespaceURI:u.tagUrn;var r=u.localName?u.localName:u.tagName;if(s=="*"||q==s||(s==""&&!q)){return((t=="*"&&u.nodeType==1)||r==t)}return false};e("ATTR",/\[\s*((?:((?:[\w\u00c0-\uFFFF\*_-]*\|)?)((?:[\w\u00c0-\uFFFF_-]|\\.)+)))\s*(?:(\S?=)\s*(['"]*)(.*?)\5|)\s*\]/);g.expr.preFilter.ATTR=function(t,q,r,p,u,v){var s=t[3].replace(/\\/g,"");if(!v&&g.expr.attrMap[s]){t[3]=g.expr.attrMap[s]}if(t[4]=="~="){t[6]=" "+t[6]+" "}if(!t[2]||t[2]=="|"){t[2]=""}else{t[2]=l(t[2])}return t};var f=function(p,r,q){var s=p+"";return p==null?r==="!=":r==="="?s===q:r==="*="?s.indexOf(q)>=0:r==="~="?(" "+s+" ").indexOf(q)>=0:!q?s&&p!==false:r==="!="?s!=q:r==="^="?s.indexOf(q)===0:r==="$="?s.substr(s.length-q.length)===q:r==="|="?s===q||s.substr(0,q.length+1)===q+"-":false};g.expr.filter.ATTR=function(r,t){var w=t[2];var p=t[3];var v=t[4];var q=t[6];var z;if(w==""){z=g.expr.attrHandle[p]?g.expr.attrHandle[p](r):r[p]!=null?r[p]:r.getAttribute(p);return f(z,v,q)}if(w!="*"&&typeof r.getAttributeNS!="undefined"){return f(r.getAttributeNS(w,p),v,q)}var y=r.attributes;for(var s=0;y[s];s++){var u=y[s].localName;if(!u){u=y[s].nodeName;var x=u.indexOf(":");if(x>=0){u=u.substr(x+1)}}if(u==p){z=y[s].nodeValue;if(w=="*"||y[s].namespaceURI==w){if(f(z,v,q)){return true}}if(y[s].namespaceURI===""&&y[s].prefix){if(y[s].prefix==n[w]){if(f(z,v,q)){return true}}}}}return false}})(jQuery);(function($){var escape=/["\\\x00-\x1f\x7f-\x9f]/g,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},hasOwn=Object.prototype.hasOwnProperty;$.toJSON=typeof JSON==="object"&&JSON.stringify?JSON.stringify:function(o){if(o===null){return"null"}var pairs,k,name,val,type=$.type(o);if(type==="undefined"){return undefined}if(type==="number"||type==="boolean"){return String(o)}if(type==="string"){return $.quoteString(o)}if(typeof o.toJSON==="function"){return $.toJSON(o.toJSON())}if(type==="date"){var month=o.getUTCMonth()+1,day=o.getUTCDate(),year=o.getUTCFullYear(),hours=o.getUTCHours(),minutes=o.getUTCMinutes(),seconds=o.getUTCSeconds(),milli=o.getUTCMilliseconds();if(month<10){month="0"+month}if(day<10){day="0"+day}if(hours<10){hours="0"+hours}if(minutes<10){minutes="0"+minutes}if(seconds<10){seconds="0"+seconds}if(milli<100){milli="0"+milli}if(milli<10){milli="0"+milli}return'"'+year+"-"+month+"-"+day+"T"+hours+":"+minutes+":"+seconds+"."+milli+'Z"'}pairs=[];if($.isArray(o)){for(k=0;k<o.length;k++){pairs.push($.toJSON(o[k])||"null")}return"["+pairs.join(",")+"]"}if(typeof o==="object"){for(k in o){if(hasOwn.call(o,k)){type=typeof k;if(type==="number"){name='"'+k+'"'}else{if(type==="string"){name=$.quoteString(k)}else{continue}}type=typeof o[k];if(type!=="function"&&type!=="undefined"){val=$.toJSON(o[k]);pairs.push(name+":"+val)}}}return"{"+pairs.join(",")+"}"}};$.evalJSON=typeof JSON==="object"&&JSON.parse?JSON.parse:function(str){return eval("("+str+")")};$.secureEvalJSON=typeof JSON==="object"&&JSON.parse?JSON.parse:function(str){var filtered=str.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"");if(/^[\],:{}\s]*$/.test(filtered)){return eval("("+str+")")}throw new SyntaxError("Error parsing JSON, source is not valid.")};$.quoteString=function(str){if(str.match(escape)){return'"'+str.replace(escape,function(a){var c=meta[a];if(typeof c==="string"){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"'}return'"'+str+'"'}}(jQuery));(function(m,p,v,r,n){var t=v.createElement("div"),h=t.style,c="Transform",C=["O"+c,"ms"+c,"Webkit"+c,"Moz"+c],z=C.length,a,l,G="Float32Array" in p,J,w,F=/Matrix([^)]*)/,q=/^\s*matrix\(\s*1\s*,\s*0\s*,\s*0\s*,\s*1\s*(?:,\s*0(?:px)?\s*){2}\)\s*$/,I="transform",K="transformOrigin",H="translate",f="rotate",s="scale",B="skew",b="matrix";while(z--){if(C[z] in h){m.support[I]=a=C[z];m.support[K]=a+"Origin";continue}}if(!a){m.support.matrixFilter=l=h.filter===""}m.cssNumber[I]=m.cssNumber[K]=true;if(a&&a!=I){m.cssProps[I]=a;m.cssProps[K]=a+"Origin";if(a=="Moz"+c){J={get:function(L,i){return(i?m.css(L,a).split("px").join(""):L.style[a])},set:function(i,L){i.style[a]=/matrix\([^)p]*\)/.test(L)?L.replace(/matrix((?:[^,]*,){4})([^,]*),([^)]*)/,b+"$1$2px,$3px"):L}}}else{if(/^1\.[0-5](?:\.|$)/.test(m.fn.jquery)){J={get:function(L,i){return(i?m.css(L,a.replace(/^ms/,"Ms")):L.style[a])}}}}}else{if(l){J={get:function(O,N,i){var M=(N&&O.currentStyle?O.currentStyle:O.style),L,P;if(M&&F.test(M.filter)){L=RegExp.$1.split(",");L=[L[0].split("=")[1],L[2].split("=")[1],L[1].split("=")[1],L[3].split("=")[1]]}else{L=[1,0,0,1]}if(!m.cssHooks[K]){L[4]=M?parseInt(M.left,10)||0:0;L[5]=M?parseInt(M.top,10)||0:0}else{P=m._data(O,"transformTranslate",n);L[4]=P?P[0]:0;L[5]=P?P[1]:0}return i?L:b+"("+L+")"},set:function(Q,R,M){var L=Q.style,N,i,P,O;if(!M){L.zoom=1}R=y(R);i=["Matrix(M11="+R[0],"M12="+R[2],"M21="+R[1],"M22="+R[3],"SizingMethod='auto expand'"].join();P=(N=Q.currentStyle)&&N.filter||L.filter||"";L.filter=F.test(P)?P.replace(F,i):P+" progid:DXImageTransform.Microsoft."+i+")";if(!m.cssHooks[K]){if((O=m.transform.centerOrigin)){L[O=="margin"?"marginLeft":"left"]=-(Q.offsetWidth/2)+(Q.clientWidth/2)+"px";L[O=="margin"?"marginTop":"top"]=-(Q.offsetHeight/2)+(Q.clientHeight/2)+"px"}L.left=R[4]+"px";L.top=R[5]+"px"}else{m.cssHooks[K].set(Q,R)}}}}}if(J){m.cssHooks[I]=J}w=J&&J.get||m.css;m.fx.step.transform=function(P){var O=P.elem,M=P.start,Q=P.end,U=P.pos,N="",S=100000,R,L,T,V;if(!M||typeof M==="string"){if(!M){M=w(O,a)}if(l){O.style.zoom=1}Q=Q.split("+=").join(M);m.extend(P,e(M,Q));M=P.start;Q=P.end}R=M.length;while(R--){L=M[R];T=Q[R];V=+false;switch(L[0]){case H:V="px";case s:V||(V="");N=L[0]+"("+r.round((L[1][0]+(T[1][0]-L[1][0])*U)*S)/S+V+","+r.round((L[1][1]+(T[1][1]-L[1][1])*U)*S)/S+V+")"+N;break;case B+"X":case B+"Y":case f:N=L[0]+"("+r.round((L[1]+(T[1]-L[1])*U)*S)/S+"rad)"+N;break}}P.origin&&(N=P.origin+N);J&&J.set?J.set(O,N,+true):O.style[a]=N};function y(N){N=N.split(")");var O=m.trim,R=-1,Q=N.length-1,T,L,M,P=G?new Float32Array(6):[],U=G?new Float32Array(6):[],S=G?new Float32Array(6):[1,0,0,1,0,0];P[0]=P[3]=S[0]=S[3]=1;P[1]=P[2]=P[4]=P[5]=0;while(++R<Q){T=N[R].split("(");L=O(T[0]);M=T[1];U[0]=U[3]=1;U[1]=U[2]=U[4]=U[5]=0;switch(L){case H+"X":U[4]=parseInt(M,10);break;case H+"Y":U[5]=parseInt(M,10);break;case H:M=M.split(",");U[4]=parseInt(M[0],10);U[5]=parseInt(M[1]||0,10);break;case f:M=g(M);U[0]=r.cos(M);U[1]=r.sin(M);U[2]=-r.sin(M);U[3]=r.cos(M);break;case s+"X":U[0]=+M;break;case s+"Y":U[3]=M;break;case s:M=M.split(",");U[0]=M[0];U[3]=M.length>1?M[1]:M[0];break;case B+"X":U[2]=r.tan(g(M));break;case B+"Y":U[1]=r.tan(g(M));break;case b:M=M.split(",");U[0]=M[0];U[1]=M[1];U[2]=M[2];U[3]=M[3];U[4]=parseInt(M[4],10);U[5]=parseInt(M[5],10);break}S[0]=P[0]*U[0]+P[2]*U[1];S[1]=P[1]*U[0]+P[3]*U[1];S[2]=P[0]*U[2]+P[2]*U[3];S[3]=P[1]*U[2]+P[3]*U[3];S[4]=P[0]*U[4]+P[2]*U[5]+P[4];S[5]=P[1]*U[4]+P[3]*U[5]+P[5];P=[S[0],S[1],S[2],S[3],S[4],S[5]]}return S}function u(N){var O,M,L,i=N[0],R=N[1],Q=N[2],P=N[3];if(i*P-R*Q){O=r.sqrt(i*i+R*R);i/=O;R/=O;L=i*Q+R*P;Q-=i*L;P-=R*L;M=r.sqrt(Q*Q+P*P);Q/=M;P/=M;L/=M;if(i*P<R*Q){i=-i;R=-R;L=-L;O=-O}}else{O=M=L=0}return[[H,[+N[4],+N[5]]],[f,r.atan2(R,i)],[B+"X",r.atan(L)],[s,[O,M]]]}function e(S,M){var P={start:[],end:[]},N=-1,L,O,Q,R;(S=="none"||E(S))&&(S="");(M=="none"||E(M))&&(M="");if(S&&M&&!M.indexOf("matrix")&&x(S).join()==x(M.split(")")[0]).join()){P.origin=S;S="";M=M.slice(M.indexOf(")")+1)}if(!S&&!M){return}if(!S||!M||A(S)==A(M)){S&&(S=S.split(")"))&&(L=S.length);M&&(M=M.split(")"))&&(L=M.length);while(++N<L-1){S[N]&&(O=S[N].split("("));M[N]&&(Q=M[N].split("("));R=m.trim((O||Q)[0]);D(P.start,o(R,O?O[1]:0));D(P.end,o(R,Q?Q[1]:0))}}else{P.start=u(y(S));P.end=u(y(M))}return P}function o(N,O){var L=+(!N.indexOf(s)),M,i=N.replace(/e[XY]/,"e");switch(N){case H+"Y":case s+"Y":O=[L,O?parseFloat(O):L];break;case H+"X":case H:case s+"X":M=1;case s:O=O?(O=O.split(","))&&[parseFloat(O[0]),parseFloat(O.length>1?O[1]:N==s?M||O[0]:L+"")]:[L,L];break;case B+"X":case B+"Y":case f:O=O?g(O):0;break;case b:return u(O?x(O):[1,0,0,1,0,0]);break}return[[i,O]]}function E(i){return q.test(i)}function A(i){return i.replace(/(?:\([^)]*\))|\s/g,"")}function D(L,i,M){while(M=i.shift()){L.push(M)}}function g(i){return ~i.indexOf("deg")?parseInt(i,10)*(r.PI*2/360):~i.indexOf("grad")?parseInt(i,10)*(r.PI/200):parseFloat(i)}function x(i){i=/([^,]*),([^,]*),([^,]*),([^,]*),([^,p]*)(?:px)?,([^)p]*)(?:px)?/.exec(i);return[i[1],i[2],i[3],i[4],i[5],i[6]]}m.transform={centerOrigin:"margin"}})(jQuery,window,document,Math);(function(e){var r=e.extend,m="mousedown",s="mousemove",n="mouseup",q="touchstart",i="touchmove",t="touchend",g="touchcancel";function f(z,x,y){if(x.substr(0,5)!=="touch"){return e(z).unbind(x,y)}var A,w;for(w=0;w<v._binds.length;w++){if(v._binds[w].elem===z&&v._binds[w].type===x&&v._binds[w].func===y){if(document.addEventListener){z.removeEventListener(x,v._binds[w].fnc,false)}else{z.detachEvent("on"+x,v._binds[w].fnc)}v._binds.splice(w--,1)}}}function v(A,x,z,y){if(x.substr(0,5)!=="touch"){return e(A).bind(x,y,z)}var B,w;if(v[x]){return v[x].bind(A,x,z,y)}B=function(C){if(!C){C=window.event}if(!C.stopPropagation){C.stopPropagation=function(){this.cancelBubble=true}}C.data=y;z.call(A,C)};if(document.addEventListener){A.addEventListener(x,B,false)}else{A.attachEvent("on"+x,B)}v._binds.push({elem:A,type:x,func:z,fnc:B})}function h(x,w){var y={move:{x:0,y:0},offset:{x:0,y:0},position:{x:0,y:0},start:{x:0,y:0},affects:document.documentElement,stopPropagation:false,preventDefault:true,touch:true};r(y,w);y.element=x;v(x,m,u,y);if(y.touch){v(x,q,a,y)}}function l(w){f(w,m,m)}function u(w){w.data.position.x=w.pageX;w.data.position.y=w.pageY;w.data.start.x=w.pageX;w.data.start.y=w.pageY;w.data.event=w;if(w.data.onstart&&w.data.onstart.call(w.data.element,w.data)){return}if(w.preventDefault&&w.data.preventDefault){w.preventDefault()}if(w.stopPropagation&&w.data.stopPropagation){w.stopPropagation()}v(w.data.affects,s,b,w.data);v(w.data.affects,n,p,w.data)}function b(w){if(w.preventDefault&&w.data.preventDefault){w.preventDefault()}if(w.stopPropagation&&w.data.preventDefault){w.stopPropagation()}w.data.move.x=w.pageX-w.data.position.x;w.data.move.y=w.pageY-w.data.position.y;w.data.position.x=w.pageX;w.data.position.y=w.pageY;w.data.offset.x=w.pageX-w.data.start.x;w.data.offset.y=w.pageY-w.data.start.y;w.data.event=w;if(w.data.onmove){w.data.onmove.call(w.data.element,w.data)}}function p(w){if(w.preventDefault&&w.data.preventDefault){w.preventDefault()}if(w.stopPropagation&&w.data.stopPropagation){w.stopPropagation()}f(w.data.affects,s,b);f(w.data.affects,n,p);w.data.event=w;if(w.data.onfinish){w.data.onfinish.call(w.data.element,w.data)}}function a(w){w.data.position.x=w.touches[0].pageX;w.data.position.y=w.touches[0].pageY;w.data.start.x=w.touches[0].pageX;w.data.start.y=w.touches[0].pageY;w.data.event=w;if(w.data.onstart&&w.data.onstart.call(w.data.element,w.data)){return}if(w.preventDefault&&w.data.preventDefault){w.preventDefault()}if(w.stopPropagation&&w.data.stopPropagation){w.stopPropagation()}v(w.data.affects,i,o,w.data);v(w.data.affects,t,c,w.data)}function o(w){if(w.preventDefault&&w.data.preventDefault){w.preventDefault()}if(w.stopPropagation&&w.data.stopPropagation){w.stopPropagation()}w.data.move.x=w.touches[0].pageX-w.data.position.x;w.data.move.y=w.touches[0].pageY-w.data.position.y;w.data.position.x=w.touches[0].pageX;w.data.position.y=w.touches[0].pageY;w.data.offset.x=w.touches[0].pageX-w.data.start.x;w.data.offset.y=w.touches[0].pageY-w.data.start.y;w.data.event=w;if(w.data.onmove){w.data.onmove.call(w.data.elem,w.data)}}function c(w){if(w.preventDefault&&w.data.preventDefault){w.preventDefault()}if(w.stopPropagation&&w.data.stopPropagation){w.stopPropagation()}f(w.data.affects,i,o);f(w.data.affects,t,c);w.data.event=w;if(w.data.onfinish){w.data.onfinish.call(w.data.element,w.data)}}v._binds=[];e.fn.grab=function(x,w){return this.each(function(){return h(this,x,w)})};e.fn.ungrab=function(w){return this.each(function(){return l(this,w)})}})(jQuery);PureCSSMatrix=(function(){var b=/deg$/;var f=/([0-9.\-e]+)/g;var g=/([a-zA-Z]+)\(([^\)]+)\)/g;function c(i){if(i&&i!==null&&i!="none"){if(i instanceof Matrix){this.setMatrix(i)}else{this.setMatrixValue(i)}}else{this.m=Matrix.I(3)}}c.prototype.setMatrix=function(i){this.m=i};function e(l){var i=parseFloat(h(l));if(l.match(b)){i=(2*Math.PI)*i/360}return i}c.prototype.setMatrixValue=function(n){var i=Matrix.I(3);var l;while((l=g.exec(n))!==null){var o=l[1].toLowerCase();var q=l[2].split(",");var m;if(o=="matrix"){m=Matrix.create([[parseFloat(q[0]),parseFloat(q[2]),parseFloat(h(q[4]))],[parseFloat(q[1]),parseFloat(q[3]),parseFloat(h(q[5]))],[0,0,1]])}else{if(o=="translate"){m=Matrix.I(3);m.elements[0][2]=parseFloat(h(q[0]));m.elements[1][2]=parseFloat(h(q[1]))}else{if(o=="scale"){var r=parseFloat(q[0]);var p;if(q.length>1){p=parseFloat(q[1])}else{p=r}m=Matrix.create([[r,0,0],[0,p,0],[0,0,1]])}else{if(o=="rotate"){m=Matrix.RotationZ(e(q[0]))}else{if(o=="skew"||o=="skewx"){m=Matrix.I(3);m.elements[0][1]=Math.tan(e(q[0]))}else{if(o=="skewy"){m=Matrix.I(3);m.elements[1][0]=Math.tan(e(q[0]))}else{console.log("Problem with setMatrixValue",o,q)}}}}}}i=i.multiply(m)}this.m=i};c.prototype.multiply=function(i){return new c(this.m.multiply(i.m))};c.prototype.inverse=function(){if(Math.abs(this.m.elements[0][0])<0.000001){this.m.elements[0][0]=0}return new c(this.m.inverse())};c.prototype.translate=function(i,m){var l=Matrix.I(3);l.elements[0][2]=i;l.elements[1][2]=m;return new c(this.m.multiply(l))};c.prototype.scale=function(m,l){var i=Matrix.create([[m,0,0],[0,l,0],[0,0,1]]);return new c(this.m.multiply(i))};c.prototype.rotate=function(i){var l=Matrix.RotationZ(i);return new c(this.m.multiply(l))};c.prototype.toString=function(){var l=this.m.elements;var i="";if($.browser.mozilla||$.browser.opera){i="px"}return"matrix("+a(l[0][0])+", "+a(l[1][0])+", "+a(l[0][1])+", "+a(l[1][1])+", "+a(l[0][2])+i+", "+a(l[1][2])+i+")"};c.prototype.elements=function(){var i=this.m.elements;return{a:i[0][0],b:i[1][0],c:i[0][1],d:i[1][1],e:i[0][2],f:i[1][2]}};function h(i){return i.match(f)}function a(i){return Number(i).toFixed(6)}return c})();if(!$.zoomooz){$.zoomooz={}}$.zoomooz.helpers=(function(c,b){var a=["-moz-","-webkit-","-o-","-ms-"];b.forEachPrefix=function(f,g){for(var e=0;e<a.length;e++){f(a[e])}if(g){f("")}};b.getElementTransform=function(e){var f;b.forEachPrefix(function(g){f=f||c(e).css(g+"transform")},true);return f};return b})(jQuery,{});(function(e){var p;var y;var h=/([0-9.\-e]+)/g;var b=/([a-z]+)\(([^\)]+)\)/g;var t=/deg$/;var r=e.zoomooz.helpers;var q={duration:450,easing:"ease",nativeanimation:false};var n;jQuery.cssHooks.MsTransform={set:function(B,C){B.style.msTransform=C}};jQuery.cssHooks.MsTransformOrigin={set:function(B,C){B.style.msTransformOrigin=C}};e.fn.animateTransformation=function(C,B,F,D){B=jQuery.extend({},q,B);var E=(e.browser.webkit&&B.nativeanimation);if(n){clearTimeout(n);n=null}if(E&&F){n=setTimeout(F,B.duration)}this.each(function(){var G=e(this);if(!C){C=new PureCSSMatrix()}var H=x(G);var I=i(H,z(C));if(E){G.css(l(A(I),B.duration,B.easing));if(D){D()}}else{a(G,H,I,B,F,D)}})};e.fn.setTransformation=function(B){this.each(function(){var C=e(this);var D=x(C);var E=i(D,z(B));C.css(l(A(E)))})};function l(B,D,G){var F={};r.forEachPrefix(function(H){F[H+"transform"]=B},true);if(D){var C=m(D/1000,6)+"s";F["-webkit-transition-duration"]=C;F["-o-transition-duration"]=C;F["-moz-transition-duration"]=C}if(G){var E=w(G);F["-webkit-transition-timing-function"]=E;F["-o-transition-timing-function"]=E;F["-moz-transition-timing-function"]=C}return F}function a(B,C,F,D,G,E){if(!C){C=z(new PureCSSMatrix())}p=(new Date()).getTime();if(y){clearInterval(y);y=null}if(D.easing){D.easingfunction=u(D.easing,D.duration)}s(B,C,F,D,G);if(E){E()}y=setInterval(function(){s(B,C,F,D,G)},1)}function s(B,H,E,D,G){var F=(new Date()).getTime()-p;var C;if(D.easingfunction){C=D.easingfunction(F/D.duration)}else{C=F/D.duration}B.css(l(A(f(H,E,C))));if(F>D.duration){clearInterval(y);y=null;C=1;if(G){G()}}}function z(N){var C=N.elements();var O=C.a,L=C.b,J=C.c,I=C.d,H=C.e,G=C.f;if(Math.abs(O*I-L*J)<0.01){console.log("fail!");return}var F=H,E=G;var M=Math.sqrt(O*O+L*L);O=O/M;L=L/M;var D=O*J+L*I;J-=O*D;I-=L*D;var K=Math.sqrt(J*J+I*I);J=J/K;I=I/K;D=D/K;if((O*I-L*J)<0){O=-O;L=-L;J=-J;I=-I;M=-M;K=-K}var B=Math.atan2(L,O);return{tx:F,ty:E,r:B,k:Math.atan(D),sx:M,sy:K}}function A(B){var C="";C+="translate("+m(B.tx,6)+"px,"+m(B.ty,6)+"px) ";C+="rotate("+m(B.r,6)+"rad) skewX("+m(B.k,6)+"rad) ";C+="scale("+m(B.sx,6)+","+m(B.sy,6)+")";return C}function w(B){if((B instanceof Array)){return"cubic-bezier("+m(B[0],6)+","+m(B[1],6)+","+m(B[2],6)+","+m(B[3],6)+")"}else{return B}}function u(C,D){var E=[];if((C instanceof Array)){E=C}else{switch(C){case"linear":E=[0,0,1,1];break;case"ease":E=[0.25,0.1,0.25,1];break;case"ease-in":E=[0.42,0,1,1];break;case"ease-out":E=[0,0,0.58,1];break;case"ease-in-out":E=[0.42,0,0.58,1];break}}var B=function(F){return c(F,E[0],E[1],E[2],E[3],D)};return B}function g(E,G,F,C,I){var B,H,D=((1-E)*(1-E)*(1-E));B=G*(3*E*E*(1-E))+C*(3*E*(1-E)*(1-E))+D;H=F*(3*E*E*(1-E))+I*(3*E*(1-E)*(1-E))+D;return{x:Math.abs(B),y:Math.abs(H)}}function c(P,D,C,L,K,B){var O=0,S=0,F=0,M=0,Q=0,E=0;function J(T){return((O*T+S)*T+F)*T}function I(T){return((M*T+Q)*T+E)*T}function R(T){return(3*O*T+2*S)*T+F}function N(T){return 1/(200*T)}function H(T,U){return I(G(T,U))}function G(aa,ab){var Z,Y,X,U,T,W;function V(ac){if(ac>=0){return ac}else{return 0-ac}}for(X=aa,W=0;W<8;W++){U=J(X)-aa;if(V(U)<ab){return X}T=R(X);if(V(T)<0.000001){break}X=X-U/T}Z=0;Y=1;X=aa;if(X<Z){return Z}if(X>Y){return Y}while(Z<Y){U=J(X);if(V(U-aa)<ab){return X}if(aa>U){Z=X}else{Y=X}X=(Y-Z)*0.5+Z}return X}F=3*D;S=3*(L-D)-F;O=1-F-S;E=3*C;Q=3*(K-C)-E;M=1-E-Q;return H(P,N(B))}function x(D){var C=r.getElementTransform(D);var E;if(!C){E=new PureCSSMatrix()}else{E=new PureCSSMatrix(C)}var B=z(E);B.r=o(C);return B}function o(F){var E=0;var C;while((C=b.exec(F))!==null){var G=C[1].toLowerCase();var H=C[2].split(",");if(G=="matrix"){var I=G+"("+C[2]+")";E+=z(new PureCSSMatrix(I)).r}else{if(G=="rotate"){var D=H[0];var B=parseFloat(v(D));if(D.match(t)){B=(2*Math.PI)*B/360}E+=B}}}return E}function i(B,C){if(Math.abs(B.r-C.r)>Math.PI){if(C.r<B.r){while(Math.abs(B.r-C.r)>Math.PI){C.r+=(2*Math.PI)}}else{while(Math.abs(B.r-C.r)>Math.PI){C.r-=(2*Math.PI)}}}return C}function f(B,E,F){var D={};for(var C in B){if(B.hasOwnProperty(C)){D[C]=B[C]+(E[C]-B[C])*F}}return D}function m(D,B){B=Math.abs(parseInt(B,10))||0;var C=Math.pow(10,B);return Math.round(D*C)/C}function v(B){return B.match(h)}})(jQuery);(function(i){var g=i.zoomooz.helpers;var n=["duration","easing","nativeanimation"];l();if(!i.zoomooz){i.zoomooz={}}i.zoomooz.setup=function(t){i.zoomooz.defaultSettings=jQuery.extend(o(),t)};i.fn.zoomSettings=function(t){var u;this.each(function(){var v=i(this);u=r(v,t)});return u};i.fn.zoomTo=function(u,t){this.each(function(){var v=i(this);if(!t){u=v.zoomSettings(u)}h(v,u);if(u.debug){if(i("#debug").length===0){i(u.root).append('<div id="debug"><div>')}else{i("#debug").html("")}q(v,u)}else{if(i("#debug").length!==0){i("#debug").html("")}}});return this};function r(u,z){var y=jQuery.extend({},z);if(!i.zoomooz.defaultSettings){i.zoomooz.setup()}var x=i.zoomooz.defaultSettings;var t=jQuery.extend({},y);for(var w in x){if(x.hasOwnProperty(w)&&!t[w]){t[w]=u.data(w)}}for(var v=0;v<n.length;v++){var w=n[v];if(!t[w]){t[w]=u.data(w)}}return jQuery.extend({},x,t)}function l(){var u=document.createElement("style");u.type="text/css";var t="";g.forEachPrefix(function(v){t+=v+"transform-origin: 0 0;"},true);u.innerHTML="html {height:100%;}.noScroll{overflow:hidden !important;}body.noScroll,html.noScroll body{margin-right:15px;}* {"+t+"}";document.getElementsByTagName("head")[0].appendChild(u)}function o(){return{targetsize:0.9,scalemode:"both",root:i(document.body),debug:false,animationendcallback:null,closeclick:false}}function h(x,v){var z=b(x,v);var w;var y=null;f(v.root);if(x[0]!==v.root[0]){var t=e(x,v.root).inverse();w=c(x,t,v);if(v.animationendcallback){y=function(){v.animationendcallback.call(x[0])}}}else{w=(new PureCSSMatrix()).translate(-z.x,-z.y);y=function(){var B=i(v.root);var A=z.elem;A.removeClass("noScroll");B.setTransformation(new PureCSSMatrix());B.data("original-scroll",null);i(document).off("touchmove");if(A[0]==document.body||A[0]==window){window.scrollTo(z.x,z.y)}else{A.scrollLeft(z.x);A.scrollTop(z.y)}if(v.animationendcallback){v.animationendcallback.call(x[0])}}}var u=null;if(z&&z.animationstartedcallback){u=z.animationstartedcallback}i(v.root).animateTransformation(w,v,y,u)}function b(v,u){var z=u.root;var t=z.parent();if(v[0]===z[0]){var y=z.data("original-scroll");if(y){return y}else{return{elem:t,x:0,"y:":0}}}else{if(!z.data("original-scroll")){var x=z.scrollTop();var A=z.scrollLeft();var v=z;if(!x){x=t.scrollTop();A=t.scrollLeft();v=t}var y={elem:v,x:A,y:x};z.data("original-scroll",y);i(document).on("touchmove",function(B){B.preventDefault()});var w="translate(-"+A+"px,-"+x+"px)";g.forEachPrefix(function(B){z.css(B+"transform",w)});v.addClass("noScroll");y.animationstartedcallback=function(){if(v[0]==document.body||v[0]==document){window.scrollTo(0,0)}else{v.scrollLeft(0);v.scrollTop(0)}};return y}}}function f(y){var z=i(y).parent();var v=z.width();var x=z.height();var t=v/2;var u=x/2;var w=p(t)+"px "+p(u)+"px";g.forEachPrefix(function(A){y.css(A+"transform-origin",w)})}function c(G,C,F){var K=F.targetsize;var J=F.scalemode;var t=F.root;var H=i(t).parent();var B=H.width();var D=H.height();var u=B/G.outerWidth();var w=D/G.outerHeight();var L;if(J=="width"){L=K*u}else{if(J=="height"){L=K*w}else{if(J=="both"){L=K*Math.min(u,w)}else{if(J=="scale"){L=K}else{console.log("wrong zoommode");return}}}}var A=(B-G.outerWidth()*L)/2;var x=(D-G.outerHeight()*L)/2;var E=B/2;var v=D/2;var y=-parseFloat(t.css("margin-left"))||0;var I=-parseFloat(t.css("margin-top"))||0;var z=(new PureCSSMatrix()).translate(y,I).translate(-E,-v).translate(A,x).scale(L,L).multiply(C).translate(E,v);return z}function s(u,t,v){return[u.a*t+u.c*v+u.e,u.b*t+u.d*v+u.f]}function q(u,t){var v=e(u,t.root).elements();m(s(v,0,0));m(s(v,0,u.outerHeight()));m(s(v,u.outerWidth(),u.outerHeight()));m(s(v,u.outerWidth(),0))}function m(v){var t="width:4px;height:4px;background-color:red;position:absolute;margin-left:-2px;margin-top:-2px;";t+="left:"+v[0]+"px;top:"+v[1]+"px;";var u='<div class="debuglabel" style="'+t+'"></div>';i("#debug").append(u)}function e(B,F){var I=B[0];if(!I||!I.ownerDocument){return null}var H=new PureCSSMatrix();var u;if(I===I.ownerDocument.body){var K=jQuery.offset.bodyOffset(I);u=new PureCSSMatrix();u=u.translate(K.left,K.top);H=H.multiply(u);return H}var z;if(jQuery.offset.initialize){jQuery.offset.initialize();z={fixedPosition:jQuery.offset.supportsFixedPosition,doesNotAddBorder:jQuery.offset.doesNotAddBorder,doesAddBorderForTableAndCells:jQuery.support.doesAddBorderForTableAndCells,subtractsBorderForOverflowNotVisible:jQuery.offset.subtractsBorderForOverflowNotVisible}}else{z=jQuery.support}var t=I.offsetParent;var L=I.ownerDocument;var x;var J=L.documentElement;var A=L.body;var G=F[0];var E=L.defaultView;var w;if(E){w=E.getComputedStyle(I,null)}else{w=I.currentStyle}var C=I.offsetTop;var v=I.offsetLeft;var y=a().translate(v,C);y=y.multiply(a(I));H=y.multiply((H));while((I=I.parentNode)&&I!==G){C=0;v=0;if(z.fixedPosition&&w.position==="fixed"){break}x=E?E.getComputedStyle(I,null):I.currentStyle;C-=I.scrollTop;v-=I.scrollLeft;if(I===t){C+=I.offsetTop;v+=I.offsetLeft;if(z.doesNotAddBorder&&!(z.doesAddBorderForTableAndCells&&/^t(able|d|h)$/i.test(I.nodeName))){C+=parseFloat(x.borderTopWidth)||0;v+=parseFloat(x.borderLeftWidth)||0}t=I.offsetParent}if(z.subtractsBorderForOverflowNotVisible&&x.overflow!=="visible"){C+=parseFloat(x.borderTopWidth)||0;v+=parseFloat(x.borderLeftWidth)||0}w=x;if(I.offsetParent==G){C-=parseFloat(i(I.offsetParent).css("margin-top"))||0;v-=parseFloat(i(I.offsetParent).css("margin-left"))||0}y=a().translate(v,C);y=y.multiply(a(I));H=y.multiply(H)}C=0;v=0;if(w.position==="relative"||w.position==="static"){C+=A.offsetTop;v+=A.offsetLeft}if(z.fixedPosition&&w.position==="fixed"){C+=Math.max(J.scrollTop,A.scrollTop);v+=Math.max(J.scrollLeft,A.scrollLeft)}var D=(new PureCSSMatrix()).translate(v,C);H=H.multiply(D);return H}function p(t){return Number(t).toFixed(6)}function a(u){var t=g.getElementTransform(u);if(!t){return new PureCSSMatrix()}else{return new PureCSSMatrix(t)}}})(jQuery);(function(b){if(!b.zoomooz){b.zoomooz={}}var a=b.zoomooz.helpers;b.fn.zoomTarget=function(f){this.each(function(){var g=b(this).zoomSettings(f);c(b(this),b(this),g)})};function c(f,m,g){f.addClass("zoomTarget");if(!g.animationendcallback){if(!g.closeclick){g.animationendcallback=function(){b(".selectedZoomTarget").removeClass("selectedZoomTarget zoomNotClickable");f.addClass("selectedZoomTarget zoomNotClickable")}}else{g.animationendcallback=function(){b(".selectedZoomTarget").removeClass("selectedZoomTarget zoomNotClickable");f.addClass("selectedZoomTarget")}}}var l=m.closest(".zoomContainer");if(l.length!=0){g.root=l}var h=g.root;if(!h.hasClass("zoomTarget")){var i=h.zoomSettings({});i.animationendcallback=function(){var n=b(this);b(".selectedZoomTarget").removeClass("selectedZoomTarget zoomNotClickable");n.addClass("selectedZoomTarget zoomNotClickable");n.parent().addClass("selectedZoomTarget zoomNotClickable")};c(h,h,i);c(h.parent(),h,i);h.click()}f.on("click",function(n){if(g.closeclick&&m.hasClass("selectedZoomTarget")){g.root.click()}else{m.zoomTo(g)}n.stopPropagation()})}function e(){var f=document.createElement("style");f.type="text/css";function g(h){var i="-webkit-touch-callout: "+(h?"default":"none")+";";a.forEachPrefix(function(l){i+=l+"user-select:"+(h?"text":"none")+";"},true);return i}f.innerHTML=".zoomTarget{"+g(false)+"}.zoomTarget:hover{cursor:pointer!important;}.zoomNotClickable{"+g(true)+"}.zoomNotClickable:hover{cursor:auto!important;}.zoomContainer{position:relative;padding:1px;margin:-1px;}";document.getElementsByTagName("head")[0].appendChild(f)}e();b(document).ready(function(){b(".zoomTarget").zoomTarget()})})(jQuery);(function(a){if(!a.zoomooz){a.zoomooz={}}a.fn.zoomContainer=function(b){};a(document).ready(function(){a(".zoomContainer").zoomContainer()})})(jQuery);var Sylvester={version:"0.1.3",precision:0.000001};function Matrix(){}Matrix.prototype={dup:function(){return Matrix.create(this.elements)},canMultiplyFromLeft:function(a){var b=a.elements||a;if(typeof(b[0][0])=="undefined"){b=Matrix.create(b).elements}return(this.elements[0].length==b.length)},multiply:function(s){var l=s.modulus?true:false;var p=s.elements||s;if(typeof(p[0][0])=="undefined"){p=Matrix.create(p).elements}if(!this.canMultiplyFromLeft(p)){return null}var f=this.elements.length,g=f,n,b,e=p[0].length,h;var r=this.elements[0].length,a=[],o,m,q;do{n=g-f;a[n]=[];b=e;do{h=e-b;o=0;m=r;do{q=r-m;o+=this.elements[n][q]*p[q][h]}while(--m);a[n][h]=o}while(--b)}while(--f);var p=Matrix.create(a);return l?p.col(1):p},isSquare:function(){return(this.elements.length==this.elements[0].length)},toRightTriangular:function(){var g=this.dup(),e;var b=this.elements.length,c=b,f,h,l=this.elements[0].length,a;do{f=c-b;if(g.elements[f][f]==0){for(j=f+1;j<c;j++){if(g.elements[j][f]!=0){e=[];h=l;do{a=l-h;e.push(g.elements[f][a]+g.elements[j][a])}while(--h);g.elements[f]=e;break}}}if(g.elements[f][f]!=0){for(j=f+1;j<c;j++){var m=g.elements[j][f]/g.elements[f][f];e=[];h=l;do{a=l-h;e.push(a<=f?0:g.elements[j][a]-g.elements[f][a]*m)}while(--h);g.elements[j]=e}}}while(--b);return g},determinant:function(){if(!this.isSquare()){return null}var f=this.toRightTriangular();var c=f.elements[0][0],e=f.elements.length-1,a=e,b;do{b=a-e+1;c=c*f.elements[b][b]}while(--e);return c},isSingular:function(){return(this.isSquare()&&this.determinant()===0)},augment:function(n){var l=n.elements||n;if(typeof(l[0][0])=="undefined"){l=Matrix.create(l).elements}var f=this.dup(),m=f.elements[0].length;var c=f.elements.length,e=c,h,a,b=l[0].length,g;if(c!=l.length){return null}do{h=e-c;a=b;do{g=b-a;f.elements[h][m+g]=l[h][g]}while(--a)}while(--c);return f},inverse:function(){if(!this.isSquare()||this.isSingular()){return null}var c=this.elements.length,e=c,l,h;var m=this.augment(Matrix.I(c)).toRightTriangular();var n,o=m.elements[0].length,a,g,b;var q=[],f;do{l=c-1;g=[];n=o;q[l]=[];b=m.elements[l][l];do{a=o-n;f=m.elements[l][a]/b;g.push(f);if(a>=e){q[l].push(f)}}while(--n);m.elements[l]=g;for(h=0;h<l;h++){g=[];n=o;do{a=o-n;g.push(m.elements[h][a]-m.elements[l][a]*m.elements[h][l])}while(--n);m.elements[h]=g}}while(--c);return Matrix.create(q)},setElements:function(l){var o,a=l.elements||l;if(typeof(a[0][0])!="undefined"){var e=a.length,g=e,b,c,m;this.elements=[];do{o=g-e;b=a[o].length;c=b;this.elements[o]=[];do{m=c-b;this.elements[o][m]=a[o][m]}while(--b)}while(--e);return this}var f=a.length,h=f;this.elements=[];do{o=h-f;this.elements.push([a[o]])}while(--f);return this}};Matrix.create=function(a){var b=new Matrix();return b.setElements(a)};Matrix.I=function(g){var f=[],a=g,e,c,b;do{e=a-g;f[e]=[];c=a;do{b=a-c;f[e][b]=(e==b)?1:0}while(--c)}while(--g);return Matrix.create(f)};(function(f,h,l,m,b){var i={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(r){for(var o=0;o<r.length;o++){var p=r[o].string;var q=r[o].prop;this.versionSearchString=r[o].versionSearch||r[o].identity;if(p){if(p.indexOf(r[o].subString)!=-1){return r[o].identity}}else{if(q){return r[o].identity}}}},searchVersion:function(p){var o=p.indexOf(this.versionSearchString);if(o==-1){return}return parseFloat(p.substring(o+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:h.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};i.init();var n={MSIE:{Windows:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"}},Firefox:{Windows:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Linux:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Mac:{ctrlKey:false,altKey:false,metaKey:true,shiftKey:true,which:70,string:"&#x21E7;&#x2318;F",alt:"Shift+Command+F"}},Chrome:{Windows:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Linux:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Mac:{ctrlKey:false,altKey:false,metaKey:true,shiftKey:true,which:70,string:"&#x21E7;&#x2318;F",alt:"Shift+Command+F"}},Safari:{Mac:{ctrlKey:true,altKey:false,metaKey:false,shiftKey:true,which:70,string:"^&#x2318;F",alt:"Control+Command+F"}},Opera:{Windows:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Linux:{ctrlKey:false,altKey:false,metaKey:false,shiftKey:false,which:122,string:"F11",alt:"F11"},Mac:{ctrlKey:false,altKey:false,metaKey:true,shiftKey:true,which:70,string:"&#x21E7;&#x2318;F",alt:"Shift+Command+F"}},};var g=function(){return(l.clientHeight==m&&l.clientWidth==b)||h.fullScreen||(h.outerHeight==m&&h.outerWidth==b)||(i.browser=="Safari"&&h.outerHeight==(m-40)&&h.outerWidth==b)},c=f(h);var a=n[i.browser][i.OS];var e={shortcut:a.string,longform:a.alt};c.data("fullscreen-state",g()).data("fullscreen-key",e).resize(function(){var o=g();if(c.data("fullscreen-state")&&!o){c.data("fullscreen-state",o).trigger("fullscreen-toggle",[false]).trigger("fullscreen-off")}else{if(!c.data("fullscreen-state")&&o){c.data("fullscreen-state",o).trigger("fullscreen-toggle",[true]).trigger("fullscreen-on")}}}).keydown(function(o){if(a&&o.ctrlKey==a.ctrlKey&&o.altKey==a.altKey&&o.metaKey==a.metaKey&&o.shiftKey==a.shiftKey&&o.which==a.which){c.trigger("fullscreen-key",[a.string,a.alt])}})})(jQuery,this,document.documentElement,screen.height,screen.width);(function(l){var f="0.4.2",m="hasOwnProperty",b=/[\.\/]/,a="*",h=function(){},g=function(p,o){return p-o},e,i,n={n:{}},c=function(o,E){o=String(o);var x=n,u=i,y=Array.prototype.slice.call(arguments,2),B=c.listeners(o),A=0,w=false,r,q=[],v={},s=[],p=e,C=[];e=o;i=0;for(var t=0,D=B.length;t<D;t++){if("zIndex" in B[t]){q.push(B[t].zIndex);if(B[t].zIndex<0){v[B[t].zIndex]=B[t]}}}q.sort(g);while(q[A]<0){r=v[q[A++]];s.push(r.apply(E,y));if(i){i=u;return s}}for(t=0;t<D;t++){r=B[t];if("zIndex" in r){if(r.zIndex==q[A]){s.push(r.apply(E,y));if(i){break}do{A++;r=v[q[A]];r&&s.push(r.apply(E,y));if(i){break}}while(r)}else{v[r.zIndex]=r}}else{s.push(r.apply(E,y));if(i){break}}}i=u;e=p;return s.length?s:null};c._events=n;c.listeners=function(o){var w=o.split(b),u=n,A,v,p,s,z,r,t,x,y=[u],q=[];for(s=0,z=w.length;s<z;s++){x=[];for(r=0,t=y.length;r<t;r++){u=y[r].n;v=[u[w[s]],u[a]];p=2;while(p--){A=v[p];if(A){x.push(A);q=q.concat(A.f||[])}}}y=x}return q};c.on=function(o,r){o=String(o);if(typeof r!="function"){return function(){}}var t=o.split(b),s=n;for(var p=0,q=t.length;p<q;p++){s=s.n;s=s.hasOwnProperty(t[p])&&s[t[p]]||(s[t[p]]={n:{}})}s.f=s.f||[];for(p=0,q=s.f.length;p<q;p++){if(s.f[p]==r){return h}}s.f.push(r);return function(u){if(+u==+u){r.zIndex=+u}}};c.f=function(p){var o=[].slice.call(arguments,1);return function(){c.apply(null,[p,null].concat(o).concat([].slice.call(arguments,0)))}};c.stop=function(){i=1};c.nt=function(o){if(o){return new RegExp("(?:\\.|\\/|^)"+o+"(?:\\.|\\/|$)").test(e)}return e};c.nts=function(){return e.split(b)};c.off=c.unbind=function(p,u){if(!p){c._events=n={n:{}};return}var w=p.split(b),v,y,q,s,z,r,t,x=[n];for(s=0,z=w.length;s<z;s++){for(r=0;r<x.length;r+=q.length-2){q=[r,1];v=x[r].n;if(w[s]!=a){if(v[w[s]]){q.push(v[w[s]])}}else{for(y in v){if(v[m](y)){q.push(v[y])}}}x.splice.apply(x,q)}}for(s=0,z=x.length;s<z;s++){v=x[s];while(v.n){if(u){if(v.f){for(r=0,t=v.f.length;r<t;r++){if(v.f[r]==u){v.f.splice(r,1);break}}!v.f.length&&delete v.f}for(y in v.n){if(v.n[m](y)&&v.n[y].f){var o=v.n[y].f;for(r=0,t=o.length;r<t;r++){if(o[r]==u){o.splice(r,1);break}}!o.length&&delete v.n[y].f}}}else{delete v.f;for(y in v.n){if(v.n[m](y)&&v.n[y].f){delete v.n[y].f}}}v=v.n}}};c.once=function(o,p){var q=function(){c.unbind(o,q);return p.apply(this,arguments)};return c.on(o,q)};c.version=f;c.toString=function(){return"You are running Eve "+f};(typeof module!="undefined"&&module.exports)?(module.exports=c):(typeof define!="undefined"?(define("eve",[],function(){return c})):(l.eve=c))})(this);(function(){function aT(i){if(aT.is(i,"function")){return aq?i():eve.on("raphael.DOMload",i)}else{if(aT.is(i,bf)){return aT._engine.create[bI](aT,i.splice(0,3+aT.is(i[0],aN))).add(i)}else{var b=Array.prototype.slice.call(arguments,0);if(aT.is(b[b.length-1],"function")){var g=b.pop();return aq?g.call(aT._engine.create[bI](aT,b)):eve.on("raphael.DOMload",function(){g.call(aT._engine.create[bI](aT,b))})}else{return aT._engine.create[bI](aT,arguments)}}}}aT.version="2.1.0";aT.eve=eve;var aq,a=/[, ]+/,by={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},bt=/\{(\d+)\}/g,bL="prototype",am="hasOwnProperty",aC={doc:document,win:window},u={was:Object.prototype[am].call(aC.win,"Raphael"),is:aC.win.Raphael},bH=function(){this.ca=this.customAttributes={}},a6,bq="appendChild",bI="apply",bG="concat",ab="createTouch" in aC.doc,aZ="",aS=" ",bJ=String,H="split",U="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[H](aS),bz={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},bM=bJ.prototype.toLowerCase,aw=Math,o=aw.max,bo=aw.min,ay=aw.abs,br=aw.pow,aX=aw.PI,aN="number",al="string",bf="array",a7="toString",bb="fill",a3=Object.prototype.toString,bB={},l="push",f=aT._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,C=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,ax={"NaN":1,"Infinity":1,"-Infinity":1},c=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,aj=aw.round,B="setAttribute",ap=parseFloat,W=parseInt,bv=bJ.prototype.toUpperCase,t=aT._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},au=aT._availableAnimAttrs={blur:aN,"clip-rect":"csv",cx:aN,cy:aN,fill:"colour","fill-opacity":aN,"font-size":aN,height:aN,opacity:aN,path:"path",r:aN,rx:aN,ry:aN,stroke:"colour","stroke-opacity":aN,"stroke-width":aN,transform:"transform",width:aN,x:aN,y:aN},ae=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]/g,bk=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,p={hs:1,rg:1},bi=/,?([achlmqrstvxz]),?/gi,a2=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,ak=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,aR=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/ig,aY=aT._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,aW={},bs=function(i,g){return i.key-g.key},w=function(i,g){return ap(i)-ap(g)},K=function(){},bD=function(b){return b},aB=aT._rectPath=function(b,R,g,i,E){if(E){return[["M",b+E,R],["l",g-E*2,0],["a",E,E,0,0,1,E,E],["l",0,i-E*2],["a",E,E,0,0,1,-E,E],["l",E*2-g,0],["a",E,E,0,0,1,-E,-E],["l",0,E*2-i],["a",E,E,0,0,1,E,-E],["z"]]}return[["M",b,R],["l",g,0],["l",0,i],["l",-g,0],["z"]]},M=function(b,E,i,g){if(g==null){g=i}return[["M",b,E],["m",0,-g],["a",i,g,0,1,1,0,2*g],["a",i,g,0,1,1,0,-2*g],["z"]]},P=aT._getPath={path:function(b){return b.attr("path")},circle:function(g){var b=g.attrs;return M(b.cx,b.cy,b.r)},ellipse:function(g){var b=g.attrs;return M(b.cx,b.cy,b.rx,b.ry)},rect:function(g){var b=g.attrs;return aB(b.x,b.y,b.width,b.height,b.r)},image:function(g){var b=g.attrs;return aB(b.x,b.y,b.width,b.height)},text:function(b){var g=b._getBBox();return aB(g.x,g.y,g.width,g.height)},set:function(b){var g=b._getBBox();return aB(g.x,g.y,g.width,g.height)}},N=aT.mapPath=function(bQ,bN){if(!bN){return bQ}var bO,S,E,b,bP,R,g;bQ=Y(bQ);for(E=0,bP=bQ.length;E<bP;E++){g=bQ[E];for(b=1,R=g.length;b<R;b+=2){bO=bN.x(g[b],g[b+1]);S=bN.y(g[b],g[b+1]);g[b]=bO;g[b+1]=S}}return bQ};aT._g=aC;aT.type=(aC.win.SVGAngle||aC.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML");if(aT.type=="VML"){var aG=aC.doc.createElement("div"),aJ;aG.innerHTML='<v:shape adj="1"/>';aJ=aG.firstChild;aJ.style.behavior="url(#default#VML)";if(!(aJ&&typeof aJ.adj=="object")){return(aT.type=aZ)}aG=null}aT.svg=!(aT.vml=aT.type=="VML");aT._Paper=bH;aT.fn=a6=bH.prototype=aT.prototype;aT._id=0;aT._oid=0;aT.is=function(g,b){b=bM.call(b);if(b=="finite"){return !ax[am](+g)}if(b=="array"){return g instanceof Array}return(b=="null"&&g===null)||(b==typeof g&&g!==null)||(b=="object"&&g===Object(g))||(b=="array"&&Array.isArray&&Array.isArray(g))||a3.call(g).slice(8,-1).toLowerCase()==b};function Z(i){if(Object(i)!==i){return i}var g=new i.constructor;for(var b in i){if(i[am](b)){g[b]=Z(i[b])}}return g}aT.angle=function(R,bN,i,S,g,E){if(g==null){var b=R-i,bO=bN-S;if(!b&&!bO){return 0}return(180+aw.atan2(-bO,-b)*180/aX+360)%360}else{return aT.angle(R,bN,g,E)-aT.angle(i,S,g,E)}};aT.rad=function(b){return b%360*aX/180};aT.deg=function(b){return b*180/aX%360};aT.snapTo=function(g,R,b){b=aT.is(b,"finite")?b:10;if(aT.is(g,bf)){var E=g.length;while(E--){if(ay(g[E]-R)<=b){return g[E]}}}else{g=+g;var S=R%g;if(S<b){return R-S}if(S>g-b){return R-S+g}}return R};var h=aT.createUUID=(function(b,g){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(b,g).toUpperCase()}})(/[xy]/g,function(i){var g=aw.random()*16|0,b=i=="x"?g:(g&3|8);return b.toString(16)});aT.setWindow=function(b){eve("raphael.setWindow",aT,aC.win,b);aC.win=b;aC.doc=aC.win.document;if(aT._engine.initWin){aT._engine.initWin(aC.win)}};var bh=function(E){if(aT.vml){var b=/^\s+|\s+$/g;var S;try{var bN=new ActiveXObject("htmlfile");bN.write("<body>");bN.close();S=bN.body}catch(bO){S=createPopup().document.body}var g=S.createTextRange();bh=aI(function(i){try{S.style.color=bJ(i).replace(b,aZ);var bP=g.queryCommandValue("ForeColor");bP=((bP&255)<<16)|(bP&65280)|((bP&16711680)>>>16);return"#"+("000000"+bP.toString(16)).slice(-6)}catch(bQ){return"none"}})}else{var R=aC.doc.createElement("i");R.title="Rapha\xebl Colour Picker";R.style.display="none";aC.doc.body.appendChild(R);bh=aI(function(i){R.style.color=i;return aC.doc.defaultView.getComputedStyle(R,aZ).getPropertyValue("color")})}return bh(E)},aK=function(){return"hsb("+[this.h,this.s,this.b]+")"},O=function(){return"hsl("+[this.h,this.s,this.l]+")"},z=function(){return this.hex},a0=function(S,R,i){if(R==null&&aT.is(S,"object")&&"r" in S&&"g" in S&&"b" in S){i=S.b;R=S.g;S=S.r}if(R==null&&aT.is(S,al)){var E=aT.getRGB(S);S=E.r;R=E.g;i=E.b}if(S>1||R>1||i>1){S/=255;R/=255;i/=255}return[S,R,i]},a4=function(S,R,i,bN){S*=255;R*=255;i*=255;var E={r:S,g:R,b:i,hex:aT.rgb(S,R,i),toString:z};aT.is(bN,"finite")&&(E.opacity=bN);return E};aT.color=function(b){var g;if(aT.is(b,"object")&&"h" in b&&"s" in b&&"b" in b){g=aT.hsb2rgb(b);b.r=g.r;b.g=g.g;b.b=g.b;b.hex=g.hex}else{if(aT.is(b,"object")&&"h" in b&&"s" in b&&"l" in b){g=aT.hsl2rgb(b);b.r=g.r;b.g=g.g;b.b=g.b;b.hex=g.hex}else{if(aT.is(b,"string")){b=aT.getRGB(b)}if(aT.is(b,"object")&&"r" in b&&"g" in b&&"b" in b){g=aT.rgb2hsl(b);b.h=g.h;b.s=g.s;b.l=g.l;g=aT.rgb2hsb(b);b.v=g.b}else{b={hex:"none"};b.r=b.g=b.b=b.h=b.s=b.v=b.l=-1}}}b.toString=z;return b};aT.hsb2rgb=function(bN,bQ,bO,E){if(this.is(bN,"object")&&"h" in bN&&"s" in bN&&"b" in bN){bO=bN.b;bQ=bN.s;bN=bN.h;E=bN.o}bN*=360;var S,bP,g,i,b;bN=(bN%360)/60;b=bO*bQ;i=b*(1-ay(bN%2-1));S=bP=g=bO-b;bN=~~bN;S+=[b,i,0,0,i,b][bN];bP+=[i,b,b,i,0,0][bN];g+=[0,0,i,b,b,i][bN];return a4(S,bP,g,E)};aT.hsl2rgb=function(bO,bQ,S,E){if(this.is(bO,"object")&&"h" in bO&&"s" in bO&&"l" in bO){S=bO.l;bQ=bO.s;bO=bO.h}if(bO>1||bQ>1||S>1){bO/=360;bQ/=100;S/=100}bO*=360;var bN,bP,g,i,b;bO=(bO%360)/60;b=2*bQ*(S<0.5?S:1-S);i=b*(1-ay(bO%2-1));bN=bP=g=S-b/2;bO=~~bO;bN+=[b,i,0,0,i,b][bO];bP+=[i,b,b,i,0,0][bO];g+=[0,0,i,b,b,i][bO];return a4(bN,bP,g,E)};aT.rgb2hsb=function(bP,bO,i){i=a0(bP,bO,i);bP=i[0];bO=i[1];i=i[2];var bN,R,E,bQ;E=o(bP,bO,i);bQ=E-bo(bP,bO,i);bN=(bQ==0?null:E==bP?(bO-i)/bQ:E==bO?(i-bP)/bQ+2:(bP-bO)/bQ+4);bN=((bN+360)%6)*60/360;R=bQ==0?0:bQ/E;return{h:bN,s:R,b:E,toString:aK}};aT.rgb2hsl=function(i,bO,bR){bR=a0(i,bO,bR);i=bR[0];bO=bR[1];bR=bR[2];var bS,bN,bQ,bP,R,E;bP=o(i,bO,bR);R=bo(i,bO,bR);E=bP-R;bS=(E==0?null:bP==i?(bO-bR)/E:bP==bO?(bR-i)/E+2:(i-bO)/E+4);bS=((bS+360)%6)*60/360;bQ=(bP+R)/2;bN=(E==0?0:bQ<0.5?E/(2*bQ):E/(2-2*bQ));return{h:bS,s:bN,l:bQ,toString:O}};aT._path2string=function(){return this.join(",").replace(bi,"$1")};function bm(R,E){for(var b=0,g=R.length;b<g;b++){if(R[b]===E){return R.push(R.splice(b,1)[0])}}}function aI(E,g,b){function i(){var R=Array.prototype.slice.call(arguments,0),bN=R.join("\u2400"),S=i.cache=i.cache||{},bO=i.count=i.count||[];if(S[am](bN)){bm(bO,bN);return b?b(S[bN]):S[bN]}bO.length>=1000&&delete S[bO.shift()];bO.push(bN);S[bN]=E[bI](g,R);return b?b(S[bN]):S[bN]}return i}var bx=aT._preload=function(i,g){var b=aC.doc.createElement("img");b.style.cssText="position:absolute;left:-9999em;top:-9999em";b.onload=function(){g.call(this);this.onload=null;aC.doc.body.removeChild(this)};b.onerror=function(){aC.doc.body.removeChild(this)};aC.doc.body.appendChild(b);b.src=i};function at(){return this.hex}aT.getRGB=aI(function(b){if(!b||!!((b=bJ(b)).indexOf("-")+1)){return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:at}}if(b=="none"){return{r:-1,g:-1,b:-1,hex:"none",toString:at}}!(p[am](b.toLowerCase().substring(0,2))||b.charAt()=="#")&&(b=bh(b));var R,g,i,bN,E,bP,bO,S=b.match(C);if(S){if(S[2]){bN=W(S[2].substring(5),16);i=W(S[2].substring(3,5),16);g=W(S[2].substring(1,3),16)}if(S[3]){bN=W((bP=S[3].charAt(3))+bP,16);i=W((bP=S[3].charAt(2))+bP,16);g=W((bP=S[3].charAt(1))+bP,16)}if(S[4]){bO=S[4][H](bk);g=ap(bO[0]);bO[0].slice(-1)=="%"&&(g*=2.55);i=ap(bO[1]);bO[1].slice(-1)=="%"&&(i*=2.55);bN=ap(bO[2]);bO[2].slice(-1)=="%"&&(bN*=2.55);S[1].toLowerCase().slice(0,4)=="rgba"&&(E=ap(bO[3]));bO[3]&&bO[3].slice(-1)=="%"&&(E/=100)}if(S[5]){bO=S[5][H](bk);g=ap(bO[0]);bO[0].slice(-1)=="%"&&(g*=2.55);i=ap(bO[1]);bO[1].slice(-1)=="%"&&(i*=2.55);bN=ap(bO[2]);bO[2].slice(-1)=="%"&&(bN*=2.55);(bO[0].slice(-3)=="deg"||bO[0].slice(-1)=="\xb0")&&(g/=360);S[1].toLowerCase().slice(0,4)=="hsba"&&(E=ap(bO[3]));bO[3]&&bO[3].slice(-1)=="%"&&(E/=100);return aT.hsb2rgb(g,i,bN,E)}if(S[6]){bO=S[6][H](bk);g=ap(bO[0]);bO[0].slice(-1)=="%"&&(g*=2.55);i=ap(bO[1]);bO[1].slice(-1)=="%"&&(i*=2.55);bN=ap(bO[2]);bO[2].slice(-1)=="%"&&(bN*=2.55);(bO[0].slice(-3)=="deg"||bO[0].slice(-1)=="\xb0")&&(g/=360);S[1].toLowerCase().slice(0,4)=="hsla"&&(E=ap(bO[3]));bO[3]&&bO[3].slice(-1)=="%"&&(E/=100);return aT.hsl2rgb(g,i,bN,E)}S={r:g,g:i,b:bN,toString:at};S.hex="#"+(16777216|bN|(i<<8)|(g<<16)).toString(16).slice(1);aT.is(E,"finite")&&(S.opacity=E);return S}return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:at}},aT);aT.hsb=aI(function(E,i,g){return aT.hsb2rgb(E,i,g).hex});aT.hsl=aI(function(i,g,b){return aT.hsl2rgb(i,g,b).hex});aT.rgb=aI(function(R,E,i){return"#"+(16777216|i|(E<<8)|(R<<16)).toString(16).slice(1)});aT.getColor=function(g){var i=this.getColor.start=this.getColor.start||{h:0,s:1,b:g||0.75},b=this.hsb2rgb(i.h,i.s,i.b);i.h+=0.075;if(i.h>1){i.h=0;i.s-=0.2;i.s<=0&&(this.getColor.start={h:0,s:1,b:i.b})}return b.hex};aT.getColor.reset=function(){delete this.start};function bd(E,bN){var S=[];for(var g=0,b=E.length;b-2*!bN>g;g+=2){var R=[{x:+E[g-2],y:+E[g-1]},{x:+E[g],y:+E[g+1]},{x:+E[g+2],y:+E[g+3]},{x:+E[g+4],y:+E[g+5]}];if(bN){if(!g){R[0]={x:+E[b-2],y:+E[b-1]}}else{if(b-4==g){R[3]={x:+E[0],y:+E[1]}}else{if(b-2==g){R[2]={x:+E[0],y:+E[1]};R[3]={x:+E[2],y:+E[3]}}}}}else{if(b-4==g){R[3]=R[2]}else{if(!g){R[0]={x:+E[g],y:+E[g+1]}}}}S.push(["C",(-R[0].x+6*R[1].x+R[2].x)/6,(-R[0].y+6*R[1].y+R[2].y)/6,(R[1].x+6*R[2].x-R[3].x)/6,(R[1].y+6*R[2].y-R[3].y)/6,R[2].x,R[2].y])}return S}aT.parsePathString=function(b){if(!b){return null}var i=aa(b);if(i.arr){return a1(i.arr)}var E={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},g=[];if(aT.is(b,bf)&&aT.is(b[0],bf)){g=a1(b)}if(!g.length){bJ(b).replace(a2,function(S,R,bP){var bO=[],bN=R.toLowerCase();bP.replace(aR,function(bR,bQ){bQ&&bO.push(+bQ)});if(bN=="m"&&bO.length>2){g.push([R][bG](bO.splice(0,2)));bN="l";R=R=="m"?"l":"L"}if(bN=="r"){g.push([R][bG](bO))}else{while(bO.length>=E[bN]){g.push([R][bG](bO.splice(0,E[bN])));if(!E[bN]){break}}}})}g.toString=aT._path2string;i.arr=a1(g);return g};aT.parseTransformString=aI(function(g){if(!g){return null}var i={r:3,s:4,t:2,m:6},b=[];if(aT.is(g,bf)&&aT.is(g[0],bf)){b=a1(g)}if(!b.length){bJ(g).replace(ak,function(R,E,bO){var bN=[],S=bM.call(E);bO.replace(aR,function(bQ,bP){bP&&bN.push(+bP)});b.push([E][bG](bN))})}b.toString=aT._path2string;return b});var aa=function(g){var b=aa.ps=aa.ps||{};if(b[g]){b[g].sleep=100}else{b[g]={sleep:100}}setTimeout(function(){for(var i in b){if(b[am](i)&&i!=g){b[i].sleep--;!b[i].sleep&&delete b[i]}}});return b[g]};aT.findDotsAtSegment=function(g,b,b5,b3,bN,R,bQ,bO,bY){var bV=1-bY,b0=br(bV,3),b1=br(bV,2),bS=bY*bY,bP=bS*bY,bU=b0*g+b1*3*bY*b5+bV*3*bY*bY*bN+bP*bQ,bR=b0*b+b1*3*bY*b3+bV*3*bY*bY*R+bP*bO,bZ=g+2*bY*(b5-g)+bS*(bN-2*b5+g),bX=b+2*bY*(b3-b)+bS*(R-2*b3+b),b4=b5+2*bY*(bN-b5)+bS*(bQ-2*bN+b5),b2=b3+2*bY*(R-b3)+bS*(bO-2*R+b3),bW=bV*g+bY*b5,bT=bV*b+bY*b3,E=bV*bN+bY*bQ,i=bV*R+bY*bO,S=(90-aw.atan2(bZ-b4,bX-b2)*180/aX);(bZ>b4||bX<b2)&&(S+=180);return{x:bU,y:bR,m:{x:bZ,y:bX},n:{x:b4,y:b2},start:{x:bW,y:bT},end:{x:E,y:i},alpha:S}};aT.bezierBBox=function(g,b,E,i,bP,bN,S,R){if(!aT.is(g,"array")){g=[g,b,E,i,bP,bN,S,R]}var bO=bc.apply(null,g);return{x:bO.min.x,y:bO.min.y,x2:bO.max.x,y2:bO.max.y,width:bO.max.x-bO.min.x,height:bO.max.y-bO.min.y}};aT.isPointInsideBBox=function(g,b,i){return b>=g.x&&b<=g.x2&&i>=g.y&&i<=g.y2};aT.isBBoxIntersect=function(E,g){var b=aT.isPointInsideBBox;return b(g,E.x,E.y)||b(g,E.x2,E.y)||b(g,E.x,E.y2)||b(g,E.x2,E.y2)||b(E,g.x,g.y)||b(E,g.x2,g.y)||b(E,g.x,g.y2)||b(E,g.x2,g.y2)||(E.x<g.x2&&E.x>g.x||g.x<E.x2&&g.x>E.x)&&(E.y<g.y2&&E.y>g.y||g.y<E.y2&&g.y>E.y)};function bl(b,bN,S,R,E){var i=-3*bN+9*S-9*R+3*E,g=b*i+6*bN-12*S+6*R;return b*g-3*bN+3*S}function s(bZ,S,bY,E,bX,g,bU,b,bR){if(bR==null){bR=1}bR=bR>1?1:bR<0?0:bR;var bS=bR/2,bT=12,bO=[-0.1252,0.1252,-0.3678,0.3678,-0.5873,0.5873,-0.7699,0.7699,-0.9041,0.9041,-0.9816,0.9816],bW=[0.2491,0.2491,0.2335,0.2335,0.2032,0.2032,0.1601,0.1601,0.1069,0.1069,0.0472,0.0472],R=0;for(var bV=0;bV<bT;bV++){var bP=bS*bO[bV]+bS,bQ=bl(bP,bZ,bY,bX,bU),b0=bl(bP,S,E,g,b),bN=bQ*bQ+b0*b0;R+=bW[bV]*aw.sqrt(bN)}return bS*R}function F(i,bS,g,bR,b,bP,bU,bO,bQ){if(bQ<0||s(i,bS,g,bR,b,bP,bU,bO)<bQ){return}var bT=1,E=bT/2,S=bT-E,R,bN=0.01;R=s(i,bS,g,bR,b,bP,bU,bO,S);while(ay(R-bQ)>bN){E/=2;S+=(R<bQ?1:-1)*E;R=s(i,bS,g,bR,b,bP,bU,bO,S)}return S}function Q(E,bT,i,bR,b,bQ,bV,bP){if(o(E,i)<bo(b,bV)||bo(E,i)>o(b,bV)||o(bT,bR)<bo(bQ,bP)||bo(bT,bR)>o(bQ,bP)){return}var bO=(E*bR-bT*i)*(b-bV)-(E-i)*(b*bP-bQ*bV),bN=(E*bR-bT*i)*(bQ-bP)-(bT-bR)*(b*bP-bQ*bV),R=(E-i)*(bQ-bP)-(bT-bR)*(b-bV);if(!R){return}var bU=bO/R,bS=bN/R,S=+bU.toFixed(2),g=+bS.toFixed(2);if(S<+bo(E,i).toFixed(2)||S>+o(E,i).toFixed(2)||S<+bo(b,bV).toFixed(2)||S>+o(b,bV).toFixed(2)||g<+bo(bT,bR).toFixed(2)||g>+o(bT,bR).toFixed(2)||g<+bo(bQ,bP).toFixed(2)||g>+o(bQ,bP).toFixed(2)){return}return{x:bU,y:bS}}function aA(g,b){return ah(g,b)}function v(g,b){return ah(g,b,1)}function ah(b5,b4,b3){var R=aT.bezierBBox(b5),g=aT.bezierBBox(b4);if(!aT.isBBoxIntersect(R,g)){return b3?0:[]}var bY=s.apply(0,b5),bX=s.apply(0,b4),bP=~~(bY/5),bO=~~(bX/5),bV=[],bU=[],E={},b6=b3?0:[];for(var b0=0;b0<bP+1;b0++){var bW=aT.findDotsAtSegment.apply(aT,b5.concat(b0/bP));bV.push({x:bW.x,y:bW.y,t:b0/bP})}for(b0=0;b0<bO+1;b0++){bW=aT.findDotsAtSegment.apply(aT,b4.concat(b0/bO));bU.push({x:bW.x,y:bW.y,t:b0/bO})}for(b0=0;b0<bP;b0++){for(var bZ=0;bZ<bO;bZ++){var b2=bV[b0],b=bV[b0+1],b1=bU[bZ],bN=bU[bZ+1],bT=ay(b.x-b2.x)<0.001?"y":"x",bS=ay(bN.x-b1.x)<0.001?"y":"x",S=Q(b2.x,b2.y,b.x,b.y,b1.x,b1.y,bN.x,bN.y);if(S){if(E[S.x.toFixed(4)]==S.y.toFixed(4)){continue}E[S.x.toFixed(4)]=S.y.toFixed(4);var bR=b2.t+ay((S[bT]-b2[bT])/(b[bT]-b2[bT]))*(b.t-b2.t),bQ=b1.t+ay((S[bS]-b1[bS])/(bN[bS]-b1[bS]))*(bN.t-b1.t);if(bR>=0&&bR<=1&&bQ>=0&&bQ<=1){if(b3){b6++}else{b6.push({x:S.x,y:S.y,t1:bR,t2:bQ})}}}}}return b6}aT.pathIntersection=function(g,b){return G(g,b)};aT.pathIntersectionNumber=function(g,b){return G(g,b,1)};function G(E,b,bZ){E=aT._path2curve(E);b=aT._path2curve(b);var bX,bN,bW,R,bU,bO,g,bR,b3,b2,b4=bZ?0:[];for(var bV=0,bP=E.length;bV<bP;bV++){var b1=E[bV];if(b1[0]=="M"){bX=bU=b1[1];bN=bO=b1[2]}else{if(b1[0]=="C"){b3=[bX,bN].concat(b1.slice(1));bX=b3[6];bN=b3[7]}else{b3=[bX,bN,bX,bN,bU,bO,bU,bO];bX=bU;bN=bO}for(var bT=0,bY=b.length;bT<bY;bT++){var b0=b[bT];if(b0[0]=="M"){bW=g=b0[1];R=bR=b0[2]}else{if(b0[0]=="C"){b2=[bW,R].concat(b0.slice(1));bW=b2[6];R=b2[7]}else{b2=[bW,R,bW,R,g,bR,g,bR];bW=g;R=bR}var bQ=ah(b3,b2,bZ);if(bZ){b4+=bQ}else{for(var bS=0,S=bQ.length;bS<S;bS++){bQ[bS].segment1=bV;bQ[bS].segment2=bT;bQ[bS].bez1=b3;bQ[bS].bez2=b2}b4=b4.concat(bQ)}}}}}return b4}aT.isPointInsidePath=function(g,b,E){var i=aT.pathBBox(g);return aT.isPointInsideBBox(i,b,E)&&G(g,[["M",b,E],["H",i.x2+10]],1)%2==1};aT._removedFactory=function(b){return function(){eve("raphael.log",null,"Rapha\xebl: you are calling to method \u201c"+b+"\u201d of removed object",b)}};var ao=aT.pathBBox=function(bW){var bQ=aa(bW);if(bQ.bbox){return Z(bQ.bbox)}if(!bW){return{x:0,y:0,width:0,height:0,x2:0,y2:0}}bW=Y(bW);var bT=0,bS=0,S=[],g=[],E;for(var bO=0,bV=bW.length;bO<bV;bO++){E=bW[bO];if(E[0]=="M"){bT=E[1];bS=E[2];S.push(bT);g.push(bS)}else{var bP=bc(bT,bS,E[1],E[2],E[3],E[4],E[5],E[6]);S=S[bG](bP.min.x,bP.max.x);g=g[bG](bP.min.y,bP.max.y);bT=E[5];bS=E[6]}}var b=bo[bI](0,S),bU=bo[bI](0,g),bN=o[bI](0,S),R=o[bI](0,g),bR={x:b,y:bU,x2:bN,y2:R,width:bN-b,height:R-bU};bQ.bbox=Z(bR);return bR},a1=function(g){var b=Z(g);b.toString=aT._path2string;return b},aE=aT._pathToRelative=function(R){var bP=aa(R);if(bP.rel){return a1(bP.rel)}if(!aT.is(R,bf)||!aT.is(R&&R[0],bf)){R=aT.parsePathString(R)}var bS=[],bU=0,bT=0,bX=0,bW=0,E=0;if(R[0][0]=="M"){bU=R[0][1];bT=R[0][2];bX=bU;bW=bT;E++;bS.push(["M",bU,bT])}for(var bO=E,bY=R.length;bO<bY;bO++){var b=bS[bO]=[],bV=R[bO];if(bV[0]!=bM.call(bV[0])){b[0]=bM.call(bV[0]);switch(b[0]){case"a":b[1]=bV[1];b[2]=bV[2];b[3]=bV[3];b[4]=bV[4];b[5]=bV[5];b[6]=+(bV[6]-bU).toFixed(3);b[7]=+(bV[7]-bT).toFixed(3);break;case"v":b[1]=+(bV[1]-bT).toFixed(3);break;case"m":bX=bV[1];bW=bV[2];default:for(var bN=1,bQ=bV.length;bN<bQ;bN++){b[bN]=+(bV[bN]-((bN%2)?bU:bT)).toFixed(3)}}}else{b=bS[bO]=[];if(bV[0]=="m"){bX=bV[1]+bU;bW=bV[2]+bT}for(var S=0,g=bV.length;S<g;S++){bS[bO][S]=bV[S]}}var bR=bS[bO].length;switch(bS[bO][0]){case"z":bU=bX;bT=bW;break;case"h":bU+=+bS[bO][bR-1];break;case"v":bT+=+bS[bO][bR-1];break;default:bU+=+bS[bO][bR-2];bT+=+bS[bO][bR-1]}}bS.toString=aT._path2string;bP.rel=a1(bS);return bS},y=aT._pathToAbsolute=function(bT){var E=aa(bT);if(E.abs){return a1(E.abs)}if(!aT.is(bT,bf)||!aT.is(bT&&bT[0],bf)){bT=aT.parsePathString(bT)}if(!bT||!bT.length){return[["M",0,0]]}var bZ=[],bO=0,bN=0,bR=0,bQ=0,R=0;if(bT[0][0]=="M"){bO=+bT[0][1];bN=+bT[0][2];bR=bO;bQ=bN;R++;bZ[0]=["M",bO,bN]}var bY=bT.length==3&&bT[0][0]=="M"&&bT[1][0].toUpperCase()=="R"&&bT[2][0].toUpperCase()=="Z";for(var bS,b,bW=R,bP=bT.length;bW<bP;bW++){bZ.push(bS=[]);b=bT[bW];if(b[0]!=bv.call(b[0])){bS[0]=bv.call(b[0]);switch(bS[0]){case"A":bS[1]=b[1];bS[2]=b[2];bS[3]=b[3];bS[4]=b[4];bS[5]=b[5];bS[6]=+(b[6]+bO);bS[7]=+(b[7]+bN);break;case"V":bS[1]=+b[1]+bN;break;case"H":bS[1]=+b[1]+bO;break;case"R":var S=[bO,bN][bG](b.slice(1));for(var bV=2,bX=S.length;bV<bX;bV++){S[bV]=+S[bV]+bO;S[++bV]=+S[bV]+bN}bZ.pop();bZ=bZ[bG](bd(S,bY));break;case"M":bR=+b[1]+bO;bQ=+b[2]+bN;default:for(bV=1,bX=b.length;bV<bX;bV++){bS[bV]=+b[bV]+((bV%2)?bO:bN)}}}else{if(b[0]=="R"){S=[bO,bN][bG](b.slice(1));bZ.pop();bZ=bZ[bG](bd(S,bY));bS=["R"][bG](b.slice(-2))}else{for(var bU=0,g=b.length;bU<g;bU++){bS[bU]=b[bU]}}}switch(bS[0]){case"Z":bO=bR;bN=bQ;break;case"H":bO=bS[1];break;case"V":bN=bS[1];break;case"M":bR=bS[bS.length-2];bQ=bS[bS.length-1];default:bO=bS[bS.length-2];bN=bS[bS.length-1]}}bZ.toString=aT._path2string;E.abs=a1(bZ);return bZ},bK=function(g,E,b,i){return[g,E,b,i,b,i]},bp=function(g,E,bN,R,b,i){var S=1/3,bO=2/3;return[S*g+bO*bN,S*E+bO*R,S*b+bO*bN,S*i+bO*R,b,i]},ag=function(bV,cq,b4,b2,bW,bQ,R,bU,cp,bX){var b1=aX*120/180,b=aX/180*(+bW||0),b8=[],b5,cm=aI(function(cr,cu,i){var ct=cr*aw.cos(i)-cu*aw.sin(i),cs=cr*aw.sin(i)+cu*aw.cos(i);return{x:ct,y:cs}});if(!bX){b5=cm(bV,cq,-b);bV=b5.x;cq=b5.y;b5=cm(bU,cp,-b);bU=b5.x;cp=b5.y;var g=aw.cos(aX/180*bW),bS=aw.sin(aX/180*bW),ca=(bV-bU)/2,b9=(cq-cp)/2;var ck=(ca*ca)/(b4*b4)+(b9*b9)/(b2*b2);if(ck>1){ck=aw.sqrt(ck);b4=ck*b4;b2=ck*b2}var E=b4*b4,cd=b2*b2,cf=(bQ==R?-1:1)*aw.sqrt(ay((E*cd-E*b9*b9-cd*ca*ca)/(E*b9*b9+cd*ca*ca))),bZ=cf*b4*b9/b2+(bV+bU)/2,bY=cf*-b2*ca/b4+(cq+cp)/2,bP=aw.asin(((cq-bY)/b2).toFixed(9)),bO=aw.asin(((cp-bY)/b2).toFixed(9));bP=bV<bZ?aX-bP:bP;bO=bU<bZ?aX-bO:bO;bP<0&&(bP=aX*2+bP);bO<0&&(bO=aX*2+bO);if(R&&bP>bO){bP=bP-aX*2}if(!R&&bO>bP){bO=bO-aX*2}}else{bP=bX[0];bO=bX[1];bZ=bX[2];bY=bX[3]}var bT=bO-bP;if(ay(bT)>b1){var b0=bO,b3=bU,bR=cp;bO=bP+b1*(R&&bO>bP?1:-1);bU=bZ+b4*aw.cos(bO);cp=bY+b2*aw.sin(bO);b8=ag(bU,cp,b4,b2,bW,0,R,b3,bR,[bO,b0,bZ,bY])}bT=bO-bP;var bN=aw.cos(bP),co=aw.sin(bP),S=aw.cos(bO),cn=aw.sin(bO),cb=aw.tan(bT/4),ce=4/3*b4*cb,cc=4/3*b2*cb,cl=[bV,cq],cj=[bV+ce*co,cq-cc*bN],ci=[bU+ce*cn,cp-cc*S],cg=[bU,cp];cj[0]=2*cl[0]-cj[0];cj[1]=2*cl[1]-cj[1];if(bX){return[cj,ci,cg][bG](b8)}else{b8=[cj,ci,cg][bG](b8).join()[H](",");var b6=[];for(var ch=0,b7=b8.length;ch<b7;ch++){b6[ch]=ch%2?cm(b8[ch-1],b8[ch],b).y:cm(b8[ch],b8[ch+1],b).x}return b6}},ai=function(g,b,E,i,bP,bO,bN,S,bQ){var R=1-bQ;return{x:br(R,3)*g+br(R,2)*3*bQ*E+R*3*bQ*bQ*bP+br(bQ,3)*bN,y:br(R,3)*b+br(R,2)*3*bQ*i+R*3*bQ*bQ*bO+br(bQ,3)*S}},bc=aI(function(E,g,S,R,bX,bW,bT,bQ){var bV=(bX-2*S+E)-(bT-2*bX+S),bS=2*(S-E)-2*(bX-S),bP=E-S,bO=(-bS+aw.sqrt(bS*bS-4*bV*bP))/2/bV,bN=(-bS-aw.sqrt(bS*bS-4*bV*bP))/2/bV,bR=[g,bQ],bU=[E,bT],i;ay(bO)>"1e12"&&(bO=0.5);ay(bN)>"1e12"&&(bN=0.5);if(bO>0&&bO<1){i=ai(E,g,S,R,bX,bW,bT,bQ,bO);bU.push(i.x);bR.push(i.y)}if(bN>0&&bN<1){i=ai(E,g,S,R,bX,bW,bT,bQ,bN);bU.push(i.x);bR.push(i.y)}bV=(bW-2*R+g)-(bQ-2*bW+R);bS=2*(R-g)-2*(bW-R);bP=g-R;bO=(-bS+aw.sqrt(bS*bS-4*bV*bP))/2/bV;bN=(-bS-aw.sqrt(bS*bS-4*bV*bP))/2/bV;ay(bO)>"1e12"&&(bO=0.5);ay(bN)>"1e12"&&(bN=0.5);if(bO>0&&bO<1){i=ai(E,g,S,R,bX,bW,bT,bQ,bO);bU.push(i.x);bR.push(i.y)}if(bN>0&&bN<1){i=ai(E,g,S,R,bX,bW,bT,bQ,bN);bU.push(i.x);bR.push(i.y)}return{min:{x:bo[bI](0,bU),y:bo[bI](0,bR)},max:{x:o[bI](0,bU),y:o[bI](0,bR)}}}),Y=aT._path2curve=aI(function(bX,bS){var bQ=!bS&&aa(bX);if(!bS&&bQ.curve){return a1(bQ.curve)}var R=y(bX),bT=bS&&y(bS),bU={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},g={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},bN=function(bY,bZ){var i,b0;if(!bY){return["C",bZ.x,bZ.y,bZ.x,bZ.y,bZ.x,bZ.y]}!(bY[0] in {T:1,Q:1})&&(bZ.qx=bZ.qy=null);switch(bY[0]){case"M":bZ.X=bY[1];bZ.Y=bY[2];break;case"A":bY=["C"][bG](ag[bI](0,[bZ.x,bZ.y][bG](bY.slice(1))));break;case"S":i=bZ.x+(bZ.x-(bZ.bx||bZ.x));b0=bZ.y+(bZ.y-(bZ.by||bZ.y));bY=["C",i,b0][bG](bY.slice(1));break;case"T":bZ.qx=bZ.x+(bZ.x-(bZ.qx||bZ.x));bZ.qy=bZ.y+(bZ.y-(bZ.qy||bZ.y));bY=["C"][bG](bp(bZ.x,bZ.y,bZ.qx,bZ.qy,bY[1],bY[2]));break;case"Q":bZ.qx=bY[1];bZ.qy=bY[2];bY=["C"][bG](bp(bZ.x,bZ.y,bY[1],bY[2],bY[3],bY[4]));break;case"L":bY=["C"][bG](bK(bZ.x,bZ.y,bY[1],bY[2]));break;case"H":bY=["C"][bG](bK(bZ.x,bZ.y,bY[1],bZ.y));break;case"V":bY=["C"][bG](bK(bZ.x,bZ.y,bZ.x,bY[1]));break;case"Z":bY=["C"][bG](bK(bZ.x,bZ.y,bZ.X,bZ.Y));break}return bY},b=function(bY,bZ){if(bY[bZ].length>7){bY[bZ].shift();var b0=bY[bZ];while(b0.length){bY.splice(bZ++,0,["C"][bG](b0.splice(0,6)))}bY.splice(bZ,1);bV=o(R.length,bT&&bT.length||0)}},E=function(b2,b1,bZ,bY,b0){if(b2&&b1&&b2[b0][0]=="M"&&b1[b0][0]!="M"){b1.splice(b0,0,["M",bY.x,bY.y]);bZ.bx=0;bZ.by=0;bZ.x=b2[b0][1];bZ.y=b2[b0][2];bV=o(R.length,bT&&bT.length||0)}};for(var bP=0,bV=o(R.length,bT&&bT.length||0);bP<bV;bP++){R[bP]=bN(R[bP],bU);b(R,bP);bT&&(bT[bP]=bN(bT[bP],g));bT&&b(bT,bP);E(R,bT,bU,g,bP);E(bT,R,g,bU,bP);var bO=R[bP],bW=bT&&bT[bP],S=bO.length,bR=bT&&bW.length;bU.x=bO[S-2];bU.y=bO[S-1];bU.bx=ap(bO[S-4])||bU.x;bU.by=ap(bO[S-3])||bU.y;g.bx=bT&&(ap(bW[bR-4])||g.x);g.by=bT&&(ap(bW[bR-3])||g.y);g.x=bT&&bW[bR-2];g.y=bT&&bW[bR-1]}if(!bT){bQ.curve=a1(R)}return bT?[R,bT]:R},null,a1),x=aT._parseDots=aI(function(bQ){var bP=[];for(var S=0,bR=bQ.length;S<bR;S++){var b={},bO=bQ[S].match(/^([^:]*):?([\d\.]*)/);b.color=aT.getRGB(bO[1]);if(b.color.error){return null}b.color=b.color.hex;bO[2]&&(b.offset=bO[2]+"%");bP.push(b)}for(S=1,bR=bP.length-1;S<bR;S++){if(!bP[S].offset){var g=ap(bP[S-1].offset||0),E=0;for(var R=S+1;R<bR;R++){if(bP[R].offset){E=bP[R].offset;break}}if(!E){E=100;R=bR}E=ap(E);var bN=(E-g)/(R-S+1);for(;S<R;S++){g+=bN;bP[S].offset=g+"%"}}}return bP}),aM=aT._tear=function(b,g){b==g.top&&(g.top=b.prev);b==g.bottom&&(g.bottom=b.next);b.next&&(b.next.prev=b.prev);b.prev&&(b.prev.next=b.next)},ar=aT._tofront=function(b,g){if(g.top===b){return}aM(b,g);b.next=null;b.prev=g.top;g.top.next=b;g.top=b},r=aT._toback=function(b,g){if(g.bottom===b){return}aM(b,g);b.next=g.bottom;b.prev=null;g.bottom.prev=b;g.bottom=b},I=aT._insertafter=function(g,b,i){aM(g,i);b==i.top&&(i.top=g);b.next&&(b.next.prev=g);g.next=b.next;g.prev=b;b.next=g},aV=aT._insertbefore=function(g,b,i){aM(g,i);b==i.bottom&&(i.bottom=g);b.prev&&(b.prev.next=g);g.prev=b.prev;b.prev=g;g.next=b},bn=aT.toMatrix=function(i,b){var E=ao(i),g={_:{transform:aZ},getBBox:function(){return E}};aQ(g,b);return g.matrix},V=aT.transformPath=function(g,b){return N(g,bn(g,b))},aQ=aT._extractTransform=function(g,b2){if(b2==null){return g._.transform}b2=bJ(b2).replace(/\.{3}|\u2026/g,g._.transform||aZ);var bU=aT.parseTransformString(b2),bS=0,bQ=0,bP=0,bW=1,bV=1,b3=g._,bX=new aH;b3.transform=bU||[];if(bU){for(var bY=0,bR=bU.length;bY<bR;bY++){var bT=bU[bY],b=bT.length,S=bJ(bT[0]).toLowerCase(),b1=bT[0]!=S,bO=b1?bX.invert():0,b0,R,bZ,E,bN;if(S=="t"&&b==3){if(b1){b0=bO.x(0,0);R=bO.y(0,0);bZ=bO.x(bT[1],bT[2]);E=bO.y(bT[1],bT[2]);bX.translate(bZ-b0,E-R)}else{bX.translate(bT[1],bT[2])}}else{if(S=="r"){if(b==2){bN=bN||g.getBBox(1);bX.rotate(bT[1],bN.x+bN.width/2,bN.y+bN.height/2);bS+=bT[1]}else{if(b==4){if(b1){bZ=bO.x(bT[2],bT[3]);E=bO.y(bT[2],bT[3]);bX.rotate(bT[1],bZ,E)}else{bX.rotate(bT[1],bT[2],bT[3])}bS+=bT[1]}}}else{if(S=="s"){if(b==2||b==3){bN=bN||g.getBBox(1);bX.scale(bT[1],bT[b-1],bN.x+bN.width/2,bN.y+bN.height/2);bW*=bT[1];bV*=bT[b-1]}else{if(b==5){if(b1){bZ=bO.x(bT[3],bT[4]);E=bO.y(bT[3],bT[4]);bX.scale(bT[1],bT[2],bZ,E)}else{bX.scale(bT[1],bT[2],bT[3],bT[4])}bW*=bT[1];bV*=bT[2]}}}else{if(S=="m"&&b==7){bX.add(bT[1],bT[2],bT[3],bT[4],bT[5],bT[6])}}}}b3.dirtyT=1;g.matrix=bX}}g.matrix=bX;b3.sx=bW;b3.sy=bV;b3.deg=bS;b3.dx=bQ=bX.e;b3.dy=bP=bX.f;if(bW==1&&bV==1&&!bS&&b3.bbox){b3.bbox.x+=+bQ;b3.bbox.y+=+bP}else{b3.dirtyT=1}},n=function(g){var b=g[0];switch(b.toLowerCase()){case"t":return[b,0,0];case"m":return[b,1,0,0,1,0,0];case"r":if(g.length==4){return[b,0,g[2],g[3]]}else{return[b,0]}case"s":if(g.length==5){return[b,1,1,g[3],g[4]]}else{if(g.length==3){return[b,1,1]}else{return[b,1]}}}},aD=aT._equaliseTransform=function(S,R){R=bJ(R).replace(/\.{3}|\u2026/g,S);S=aT.parseTransformString(S)||[];R=aT.parseTransformString(R)||[];var b=o(S.length,R.length),bQ=[],bR=[],E=0,g,bN,bP,bO;for(;E<b;E++){bP=S[E]||n(R[E]);bO=R[E]||n(bP);if((bP[0]!=bO[0])||(bP[0].toLowerCase()=="r"&&(bP[2]!=bO[2]||bP[3]!=bO[3]))||(bP[0].toLowerCase()=="s"&&(bP[3]!=bO[3]||bP[4]!=bO[4]))){return}bQ[E]=[];bR[E]=[];for(g=0,bN=o(bP.length,bO.length);g<bN;g++){g in bP&&(bQ[E][g]=bP[g]);g in bO&&(bR[E][g]=bO[g])}}return{from:bQ,to:bR}};aT._getContainer=function(b,R,i,E){var g;g=E==null&&!aT.is(b,"object")?aC.doc.getElementById(b):b;if(g==null){return}if(g.tagName){if(R==null){return{container:g,width:g.style.pixelWidth||g.offsetWidth,height:g.style.pixelHeight||g.offsetHeight}}else{return{container:g,width:R,height:i}}}return{container:1,x:b,y:R,width:i,height:E}};aT.pathToRelative=aE;aT._engine={};aT.path2curve=Y;aT.matrix=function(i,g,bN,S,R,E){return new aH(i,g,bN,S,R,E)};function aH(i,g,bN,S,R,E){if(i!=null){this.a=+i;this.b=+g;this.c=+bN;this.d=+S;this.e=+R;this.f=+E}else{this.a=1;this.b=0;this.c=0;this.d=1;this.e=0;this.f=0}}(function(i){i.add=function(bW,bT,bR,bP,bN,S){var R=[[],[],[]],E=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],bV=[[bW,bR,bN],[bT,bP,S],[0,0,1]],bU,bS,bQ,bO;if(bW&&bW instanceof aH){bV=[[bW.a,bW.c,bW.e],[bW.b,bW.d,bW.f],[0,0,1]]}for(bU=0;bU<3;bU++){for(bS=0;bS<3;bS++){bO=0;for(bQ=0;bQ<3;bQ++){bO+=E[bU][bQ]*bV[bQ][bS]}R[bU][bS]=bO}}this.a=R[0][0];this.b=R[1][0];this.c=R[0][1];this.d=R[1][1];this.e=R[0][2];this.f=R[1][2]};i.invert=function(){var R=this,E=R.a*R.d-R.b*R.c;return new aH(R.d/E,-R.b/E,-R.c/E,R.a/E,(R.c*R.f-R.d*R.e)/E,(R.b*R.e-R.a*R.f)/E)};i.clone=function(){return new aH(this.a,this.b,this.c,this.d,this.e,this.f)};i.translate=function(E,R){this.add(1,0,0,1,E,R)};i.scale=function(R,bN,E,S){bN==null&&(bN=R);(E||S)&&this.add(1,0,0,1,E,S);this.add(R,0,0,bN,0,0);(E||S)&&this.add(1,0,0,1,-E,-S)};i.rotate=function(R,E,bO){R=aT.rad(R);E=E||0;bO=bO||0;var bN=+aw.cos(R).toFixed(9),S=+aw.sin(R).toFixed(9);this.add(bN,S,-S,bN,E,bO);this.add(1,0,0,1,-E,-bO)};i.x=function(E,R){return E*this.a+R*this.c+this.e};i.y=function(E,R){return E*this.b+R*this.d+this.f};i.get=function(E){return +this[bJ.fromCharCode(97+E)].toFixed(4)};i.toString=function(){return aT.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()};i.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"};i.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]};function g(E){return E[0]*E[0]+E[1]*E[1]}function b(E){var R=aw.sqrt(g(E));E[0]&&(E[0]/=R);E[1]&&(E[1]/=R)}i.split=function(){var R={};R.dx=this.e;R.dy=this.f;var bN=[[this.a,this.c],[this.b,this.d]];R.scalex=aw.sqrt(g(bN[0]));b(bN[0]);R.shear=bN[0][0]*bN[1][0]+bN[0][1]*bN[1][1];bN[1]=[bN[1][0]-bN[0][0]*R.shear,bN[1][1]-bN[0][1]*R.shear];R.scaley=aw.sqrt(g(bN[1]));b(bN[1]);R.shear/=R.scaley;var E=-bN[0][1],S=bN[1][1];if(S<0){R.rotate=aT.deg(aw.acos(S));if(E<0){R.rotate=360-R.rotate}}else{R.rotate=aT.deg(aw.asin(E))}R.isSimple=!+R.shear.toFixed(9)&&(R.scalex.toFixed(9)==R.scaley.toFixed(9)||!R.rotate);R.isSuperSimple=!+R.shear.toFixed(9)&&R.scalex.toFixed(9)==R.scaley.toFixed(9)&&!R.rotate;R.noRotation=!+R.shear.toFixed(9)&&!R.rotate;return R};i.toTransformString=function(E){var R=E||this[H]();if(R.isSimple){R.scalex=+R.scalex.toFixed(4);R.scaley=+R.scaley.toFixed(4);R.rotate=+R.rotate.toFixed(4);return(R.dx||R.dy?"t"+[R.dx,R.dy]:aZ)+(R.scalex!=1||R.scaley!=1?"s"+[R.scalex,R.scaley,0,0]:aZ)+(R.rotate?"r"+[R.rotate,0,0]:aZ)}else{return"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}})(aH.prototype);var X=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);if((navigator.vendor=="Apple Computer, Inc.")&&(X&&X[1]<4||navigator.platform.slice(0,2)=="iP")||(navigator.vendor=="Google Inc."&&X&&X[1]<8)){a6.safari=function(){var b=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){b.remove()})}}else{a6.safari=K}var T=function(){this.returnValue=false},bF=function(){return this.originalEvent.preventDefault()},ba=function(){this.cancelBubble=true},aL=function(){return this.originalEvent.stopPropagation()},aF=(function(){if(aC.doc.addEventListener){return function(S,E,i,g){var b=ab&&bz[E]?bz[E]:E,R=function(bS){var bR=aC.doc.documentElement.scrollTop||aC.doc.body.scrollTop,bT=aC.doc.documentElement.scrollLeft||aC.doc.body.scrollLeft,bN=bS.clientX+bT,bU=bS.clientY+bR;if(ab&&bz[am](E)){for(var bP=0,bQ=bS.targetTouches&&bS.targetTouches.length;bP<bQ;bP++){if(bS.targetTouches[bP].target==S){var bO=bS;bS=bS.targetTouches[bP];bS.originalEvent=bO;bS.preventDefault=bF;bS.stopPropagation=aL;break}}}return i.call(g,bS,bN,bU)};S.addEventListener(b,R,false);return function(){S.removeEventListener(b,R,false);return true}}}else{if(aC.doc.attachEvent){return function(S,E,i,g){var R=function(bP){bP=bP||aC.win.event;var bO=aC.doc.documentElement.scrollTop||aC.doc.body.scrollTop,bQ=aC.doc.documentElement.scrollLeft||aC.doc.body.scrollLeft,bN=bP.clientX+bQ,bR=bP.clientY+bO;bP.preventDefault=bP.preventDefault||T;bP.stopPropagation=bP.stopPropagation||ba;return i.call(g,bP,bN,bR)};S.attachEvent("on"+E,R);var b=function(){S.detachEvent("on"+E,R);return true};return b}}}})(),bg=[],bA=function(bP){var bS=bP.clientX,bR=bP.clientY,bU=aC.doc.documentElement.scrollTop||aC.doc.body.scrollTop,bV=aC.doc.documentElement.scrollLeft||aC.doc.body.scrollLeft,E,R=bg.length;while(R--){E=bg[R];if(ab){var bN=bP.touches.length,S;while(bN--){S=bP.touches[bN];if(S.identifier==E.el._drag.id){bS=S.clientX;bR=S.clientY;(bP.originalEvent?bP.originalEvent:bP).preventDefault();break}}}else{bP.preventDefault()}var g=E.el.node,b,bO=g.nextSibling,bT=g.parentNode,bQ=g.style.display;aC.win.opera&&bT.removeChild(g);g.style.display="none";b=E.el.paper.getElementByPoint(bS,bR);g.style.display=bQ;aC.win.opera&&(bO?bT.insertBefore(g,bO):bT.appendChild(g));b&&eve("raphael.drag.over."+E.el.id,E.el,b);bS+=bV;bR+=bU;eve("raphael.drag.move."+E.el.id,E.move_scope||E.el,bS-E.el._drag.x,bR-E.el._drag.y,bS,bR,bP)}},e=function(E){aT.unmousemove(bA).unmouseup(e);var g=bg.length,b;while(g--){b=bg[g];b.el._drag={};eve("raphael.drag.end."+b.el.id,b.end_scope||b.start_scope||b.move_scope||b.el,E)}bg=[]},bj=aT.el={};for(var az=U.length;az--;){(function(b){aT[b]=bj[b]=function(i,g){if(aT.is(i,"function")){this.events=this.events||[];this.events.push({name:b,f:i,unbind:aF(this.shape||this.node||aC.doc,b,i,g||this)})}return this};aT["un"+b]=bj["un"+b]=function(E){var i=this.events||[],g=i.length;while(g--){if(i[g].name==b&&i[g].f==E){i[g].unbind();i.splice(g,1);!i.length&&delete this.events;return this}}return this}})(U[az])}bj.data=function(g,R){var E=aW[this.id]=aW[this.id]||{};if(arguments.length==1){if(aT.is(g,"object")){for(var b in g){if(g[am](b)){this.data(b,g[b])}}return this}eve("raphael.data.get."+this.id,this,E[g],g);return E[g]}E[g]=R;eve("raphael.data.set."+this.id,this,R,g);return this};bj.removeData=function(b){if(b==null){aW[this.id]={}}else{aW[this.id]&&delete aW[this.id][b]}return this};bj.hover=function(E,b,i,g){return this.mouseover(E,i).mouseout(b,g||i)};bj.unhover=function(g,b){return this.unmouseover(g).unmouseout(b)};var bw=[];bj.drag=function(g,S,R,b,i,E){function bN(bP){(bP.originalEvent||bP).preventDefault();var bO=aC.doc.documentElement.scrollTop||aC.doc.body.scrollTop,bQ=aC.doc.documentElement.scrollLeft||aC.doc.body.scrollLeft;this._drag.x=bP.clientX+bQ;this._drag.y=bP.clientY+bO;this._drag.id=bP.identifier;!bg.length&&aT.mousemove(bA).mouseup(e);bg.push({el:this,move_scope:b,start_scope:i,end_scope:E});S&&eve.on("raphael.drag.start."+this.id,S);g&&eve.on("raphael.drag.move."+this.id,g);R&&eve.on("raphael.drag.end."+this.id,R);eve("raphael.drag.start."+this.id,i||b||this,bP.clientX+bQ,bP.clientY+bO,bP)}this._drag={};bw.push({el:this,start:bN});this.mousedown(bN);return this};bj.onDragOver=function(b){b?eve.on("raphael.drag.over."+this.id,b):eve.unbind("raphael.drag.over."+this.id)};bj.undrag=function(){var b=bw.length;while(b--){if(bw[b].el==this){this.unmousedown(bw[b].start);bw.splice(b,1);eve.unbind("raphael.drag.*."+this.id)}}!bw.length&&aT.unmousemove(bA).unmouseup(e)};a6.circle=function(b,E,i){var g=aT._engine.circle(this,b||0,E||0,i||0);this.__set__&&this.__set__.push(g);return g};a6.rect=function(b,S,g,E,R){var i=aT._engine.rect(this,b||0,S||0,g||0,E||0,R||0);this.__set__&&this.__set__.push(i);return i};a6.ellipse=function(b,R,E,i){var g=aT._engine.ellipse(this,b||0,R||0,E||0,i||0);this.__set__&&this.__set__.push(g);return g};a6.path=function(b){b&&!aT.is(b,al)&&!aT.is(b[0],bf)&&(b+=aZ);var g=aT._engine.path(aT.format[bI](aT,arguments),this);this.__set__&&this.__set__.push(g);return g};a6.image=function(R,b,S,g,E){var i=aT._engine.image(this,R||"about:blank",b||0,S||0,g||0,E||0);this.__set__&&this.__set__.push(i);return i};a6.text=function(b,E,i){var g=aT._engine.text(this,b||0,E||0,bJ(i));this.__set__&&this.__set__.push(g);return g};a6.set=function(g){!aT.is(g,"array")&&(g=Array.prototype.splice.call(arguments,0,arguments.length));var b=new an(g);this.__set__&&this.__set__.push(b);b.paper=this;b.type="set";return b};a6.setStart=function(b){this.__set__=b||this.set()};a6.setFinish=function(g){var b=this.__set__;delete this.__set__;return b};a6.setSize=function(g,b){return aT._engine.setSize.call(this,g,b)};a6.setViewBox=function(b,R,g,E,i){return aT._engine.setViewBox.call(this,b,R,g,E,i)};a6.top=a6.bottom=null;a6.raphael=aT;var bu=function(i){var R=i.getBoundingClientRect(),bP=i.ownerDocument,S=bP.body,b=bP.documentElement,E=b.clientTop||S.clientTop||0,bN=b.clientLeft||S.clientLeft||0,bO=R.top+(aC.win.pageYOffset||b.scrollTop||S.scrollTop)-E,g=R.left+(aC.win.pageXOffset||b.scrollLeft||S.scrollLeft)-bN;return{y:bO,x:g}};a6.getElementByPoint=function(g,bO){var bN=this,i=bN.canvas,S=aC.doc.elementFromPoint(g,bO);if(aC.win.opera&&S.tagName=="svg"){var R=bu(i),E=i.createSVGRect();E.x=g-R.x;E.y=bO-R.y;E.width=E.height=1;var b=i.getIntersectionList(E,null);if(b.length){S=b[b.length-1]}}if(!S){return null}while(S.parentNode&&S!=i.parentNode&&!S.raphael){S=S.parentNode}S==bN.canvas.parentNode&&(S=i);S=S&&S.raphael?bN.getById(S.raphaelid):null;return S};a6.getById=function(g){var b=this.bottom;while(b){if(b.id==g){return b}b=b.next}return null};a6.forEach=function(i,b){var g=this.bottom;while(g){if(i.call(b,g)===false){return this}g=g.next}return this};a6.getElementsByPoint=function(b,i){var g=this.set();this.forEach(function(E){if(E.isPointInside(b,i)){g.push(E)}});return g};function A(){return this.x+aS+this.y}function av(){return this.x+aS+this.y+aS+this.width+" \xd7 "+this.height}bj.isPointInside=function(b,i){var g=this.realPath=this.realPath||P[this.type](this);return aT.isPointInsidePath(g,b,i)};bj.getBBox=function(g){if(this.removed){return{}}var b=this._;if(g){if(b.dirty||!b.bboxwt){this.realPath=P[this.type](this);b.bboxwt=ao(this.realPath);b.bboxwt.toString=av;b.dirty=0}return b.bboxwt}if(b.dirty||b.dirtyT||!b.bbox){if(b.dirty||!this.realPath){b.bboxwt=0;this.realPath=P[this.type](this)}b.bbox=ao(N(this.realPath,this.matrix));b.bbox.toString=av;b.dirty=b.dirtyT=0}return b.bbox};bj.clone=function(){if(this.removed){return null}var b=this.paper[this.type]().attr(this.attr());this.__set__&&this.__set__.push(b);return b};bj.glow=function(bO){if(this.type=="text"){return null}bO=bO||{};var E={width:(bO.width||10)+(+this.attr("stroke-width")||1),fill:bO.fill||false,opacity:bO.opacity||0.5,offsetx:bO.offsetx||0,offsety:bO.offsety||0,color:bO.color||"#000"},bN=E.width/2,R=this.paper,b=R.set(),S=this.realPath||P[this.type](this);S=this.matrix?N(S,this.matrix):S;for(var g=1;g<bN+1;g++){b.push(R.path(S).attr({stroke:E.color,fill:E.fill?E.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(E.width/bN*g).toFixed(3),opacity:+(E.opacity/bN).toFixed(3)}))}return b.insertBefore(this).translate(E.offsetx,E.offsety)};var a9={},m=function(g,b,R,E,bP,bO,bN,S,i){if(i==null){return s(g,b,R,E,bP,bO,bN,S)}else{return aT.findDotsAtSegment(g,b,R,E,bP,bO,bN,S,F(g,b,R,E,bP,bO,bN,S,i))}},a8=function(b,g){return function(bW,S,bN){bW=Y(bW);var bS,bR,E,bO,R="",bV={},bT,bQ=0;for(var bP=0,bU=bW.length;bP<bU;bP++){E=bW[bP];if(E[0]=="M"){bS=+E[1];bR=+E[2]}else{bO=m(bS,bR,E[1],E[2],E[3],E[4],E[5],E[6]);if(bQ+bO>S){if(g&&!bV.start){bT=m(bS,bR,E[1],E[2],E[3],E[4],E[5],E[6],S-bQ);R+=["C"+bT.start.x,bT.start.y,bT.m.x,bT.m.y,bT.x,bT.y];if(bN){return R}bV.start=R;R=["M"+bT.x,bT.y+"C"+bT.n.x,bT.n.y,bT.end.x,bT.end.y,E[5],E[6]].join();bQ+=bO;bS=+E[5];bR=+E[6];continue}if(!b&&!g){bT=m(bS,bR,E[1],E[2],E[3],E[4],E[5],E[6],S-bQ);return{x:bT.x,y:bT.y,alpha:bT.alpha}}}bQ+=bO;bS=+E[5];bR=+E[6]}R+=E.shift()+E}bV.end=R;bT=b?bQ:g?bV:aT.findDotsAtSegment(bS,bR,E[0],E[1],E[2],E[3],E[4],E[5],1);bT.alpha&&(bT={x:bT.x,y:bT.y,alpha:bT.alpha});return bT}};var aU=a8(1),L=a8(),af=a8(0,1);aT.getTotalLength=aU;aT.getPointAtLength=L;aT.getSubpath=function(g,E,i){if(this.getTotalLength(g)-i<0.000001){return af(g,E).end}var b=af(g,i,1);return E?af(b,E).end:b};bj.getTotalLength=function(){if(this.type!="path"){return}if(this.node.getTotalLength){return this.node.getTotalLength()}return aU(this.attrs.path)};bj.getPointAtLength=function(b){if(this.type!="path"){return}return L(this.attrs.path,b)};bj.getSubpath=function(g,b){if(this.type!="path"){return}return aT.getSubpath(this.attrs.path,g,b)};var q=aT.easing_formulas={linear:function(b){return b},"<":function(b){return br(b,1.7)},">":function(b){return br(b,0.48)},"<>":function(bO){var E=0.48-bO/1.04,i=aw.sqrt(0.1734+E*E),b=i-E,bN=br(ay(b),1/3)*(b<0?-1:1),S=-i-E,R=br(ay(S),1/3)*(S<0?-1:1),g=bN+R+0.5;return(1-g)*3*g*g+g*g*g},backIn:function(g){var b=1.70158;return g*g*((b+1)*g-b)},backOut:function(g){g=g-1;var b=1.70158;return g*g*((b+1)*g+b)+1},elastic:function(b){if(b==!!b){return b}return br(2,-10*b)*aw.sin((b-0.075)*(2*aX)/0.3)+1},bounce:function(E){var g=7.5625,i=2.75,b;if(E<(1/i)){b=g*E*E}else{if(E<(2/i)){E-=(1.5/i);b=g*E*E+0.75}else{if(E<(2.5/i)){E-=(2.25/i);b=g*E*E+0.9375}else{E-=(2.625/i);b=g*E*E+0.984375}}}return b}};q.easeIn=q["ease-in"]=q["<"];q.easeOut=q["ease-out"]=q[">"];q.easeInOut=q["ease-in-out"]=q["<>"];q["back-in"]=q.backIn;q["back-out"]=q.backOut;var ad=[],aP=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(b,16)},bE=function(){var bO=+new Date,bW=0;for(;bW<ad.length;bW++){var b2=ad[bW];if(b2.el.removed||b2.paused){continue}var R=bO-b2.start,bU=b2.ms,bT=b2.easing,bX=b2.from,bR=b2.diff,g=b2.to,bQ=b2.t,bN=b2.el,bS={},b,b0={},b4;if(b2.initstatus){R=(b2.initstatus*b2.anim.top-b2.prev)/(b2.percent-b2.prev)*bU;b2.status=b2.initstatus;delete b2.initstatus;b2.stop&&ad.splice(bW--,1)}else{b2.status=(b2.prev+(b2.percent-b2.prev)*(R/bU))/b2.anim.top}if(R<0){continue}if(R<bU){var E=bT(R/bU);for(var bV in bX){if(bX[am](bV)){switch(au[bV]){case aN:b=+bX[bV]+E*bU*bR[bV];break;case"colour":b="rgb("+[J(aj(bX[bV].r+E*bU*bR[bV].r)),J(aj(bX[bV].g+E*bU*bR[bV].g)),J(aj(bX[bV].b+E*bU*bR[bV].b))].join(",")+")";break;case"path":b=[];for(var bZ=0,bP=bX[bV].length;bZ<bP;bZ++){b[bZ]=[bX[bV][bZ][0]];for(var bY=1,b1=bX[bV][bZ].length;bY<b1;bY++){b[bZ][bY]=+bX[bV][bZ][bY]+E*bU*bR[bV][bZ][bY]}b[bZ]=b[bZ].join(aS)}b=b.join(aS);break;case"transform":if(bR[bV].real){b=[];for(bZ=0,bP=bX[bV].length;bZ<bP;bZ++){b[bZ]=[bX[bV][bZ][0]];for(bY=1,b1=bX[bV][bZ].length;bY<b1;bY++){b[bZ][bY]=bX[bV][bZ][bY]+E*bU*bR[bV][bZ][bY]}}}else{var b3=function(b5){return +bX[bV][b5]+E*bU*bR[bV][b5]};b=[["m",b3(0),b3(1),b3(2),b3(3),b3(4),b3(5)]]}break;case"csv":if(bV=="clip-rect"){b=[];bZ=4;while(bZ--){b[bZ]=+bX[bV][bZ]+E*bU*bR[bV][bZ]}}break;default:var S=[][bG](bX[bV]);b=[];bZ=bN.paper.customAttributes[bV].length;while(bZ--){b[bZ]=+S[bZ]+E*bU*bR[bV][bZ]}break}bS[bV]=b}}bN.attr(bS);(function(b6,i,b5){setTimeout(function(){eve("raphael.anim.frame."+b6,i,b5)})})(bN.id,bN,b2.anim)}else{(function(b6,b5,i){setTimeout(function(){eve("raphael.anim.frame."+b5.id,b5,i);eve("raphael.anim.finish."+b5.id,b5,i);aT.is(b6,"function")&&b6.call(b5)})})(b2.callback,bN,b2.anim);bN.attr(g);ad.splice(bW--,1);if(b2.repeat>1&&!b2.next){for(b4 in g){if(g[am](b4)){b0[b4]=b2.totalOrigin[b4]}}b2.el.attr(b0);aO(b2.anim,b2.el,b2.anim.percents[0],null,b2.totalOrigin,b2.repeat-1)}if(b2.next&&!b2.stop){aO(b2.anim,b2.el,b2.next,null,b2.totalOrigin,b2.repeat)}}}aT.svg&&bN&&bN.paper&&bN.paper.safari();ad.length&&aP(bE)},J=function(b){return b>255?255:b<0?0:b};bj.animateWith=function(g,R,E,b,bO,bT){var bN=this;if(bN.removed){bT&&bT.call(bN);return bN}var bR=E instanceof bC?E:aT.animation(E,b,bO,bT),bQ,bP;aO(bR,bN,bR.percents[0],null,bN.attr());for(var S=0,bS=ad.length;S<bS;S++){if(ad[S].anim==R&&ad[S].el==g){ad[bS-1].start=ad[S].start;break}}return bN};function a5(bU,E,g,bT,bS,bO){var bP=3*E,bR=3*(bT-E)-bP,b=1-bP-bR,bN=3*g,bQ=3*(bS-g)-bN,bV=1-bN-bQ;function S(bW){return((b*bW+bR)*bW+bP)*bW}function i(bW,bY){var bX=R(bW,bY);return((bV*bX+bQ)*bX+bN)*bX}function R(bW,b3){var b2,b1,bZ,bX,b0,bY;for(bZ=bW,bY=0;bY<8;bY++){bX=S(bZ)-bW;if(ay(bX)<b3){return bZ}b0=(3*b*bZ+2*bR)*bZ+bP;if(ay(b0)<0.000001){break}bZ=bZ-bX/b0}b2=0;b1=1;bZ=bW;if(bZ<b2){return b2}if(bZ>b1){return b1}while(b2<b1){bX=S(bZ);if(ay(bX-bW)<b3){return bZ}if(bW>bX){b2=bZ}else{b1=bZ}bZ=(b1-b2)/2+b2}return bZ}return i(bU,1/(200*bO))}bj.onAnimation=function(b){b?eve.on("raphael.anim.frame."+this.id,b):eve.unbind("raphael.anim.frame."+this.id);return this};function bC(R,i){var g=[],E={};this.ms=i;this.times=1;if(R){for(var b in R){if(R[am](b)){E[ap(b)]=R[b];g.push(ap(b))}}g.sort(w)}this.anim=E;this.top=g[g.length-1];this.percents=g}bC.prototype.delay=function(g){var b=new bC(this.anim,this.ms);b.times=this.times;b.del=+g||0;return b};bC.prototype.repeat=function(g){var b=new bC(this.anim,this.ms);b.del=this.del;b.times=aw.floor(o(g,0))||1;return b};function aO(b6,E,b,b4,bO,bS){b=ap(b);var cd,bN,bR,ce=[],bY,bX,S,b0=b6.ms,b5={},R={},bU={};if(b4){for(b9=0,bT=ad.length;b9<bT;b9++){var cb=ad[b9];if(cb.el.id==E.id&&cb.anim==b6){if(cb.percent!=b){ad.splice(b9,1);bR=1}else{bN=cb}E.attr(cb.totalOrigin);break}}}else{b4=+R}for(var b9=0,bT=b6.percents.length;b9<bT;b9++){if(b6.percents[b9]==b||b6.percents[b9]>b4*b6.top){b=b6.percents[b9];bX=b6.percents[b9-1]||0;b0=b0/b6.top*(b-bX);bY=b6.percents[b9+1];cd=b6.anim[b];break}else{if(b4){E.attr(b6.anim[b6.percents[b9]])}}}if(!cd){return}if(!bN){for(var b2 in cd){if(cd[am](b2)){if(au[am](b2)||E.paper.customAttributes[am](b2)){b5[b2]=E.attr(b2);(b5[b2]==null)&&(b5[b2]=t[b2]);R[b2]=cd[b2];switch(au[b2]){case aN:bU[b2]=(R[b2]-b5[b2])/b0;break;case"colour":b5[b2]=aT.getRGB(b5[b2]);var b3=aT.getRGB(R[b2]);bU[b2]={r:(b3.r-b5[b2].r)/b0,g:(b3.g-b5[b2].g)/b0,b:(b3.b-b5[b2].b)/b0};break;case"path":var bP=Y(b5[b2],R[b2]),bW=bP[1];b5[b2]=bP[0];bU[b2]=[];for(b9=0,bT=b5[b2].length;b9<bT;b9++){bU[b2][b9]=[0];for(var b8=1,ca=b5[b2][b9].length;b8<ca;b8++){bU[b2][b9][b8]=(bW[b9][b8]-b5[b2][b9][b8])/b0}}break;case"transform":var cg=E._,cf=aD(cg[b2],R[b2]);if(cf){b5[b2]=cf.from;R[b2]=cf.to;bU[b2]=[];bU[b2].real=true;for(b9=0,bT=b5[b2].length;b9<bT;b9++){bU[b2][b9]=[b5[b2][b9][0]];for(b8=1,ca=b5[b2][b9].length;b8<ca;b8++){bU[b2][b9][b8]=(R[b2][b9][b8]-b5[b2][b9][b8])/b0}}}else{var b1=(E.matrix||new aH),cc={_:{transform:cg.transform},getBBox:function(){return E.getBBox(1)}};b5[b2]=[b1.a,b1.b,b1.c,b1.d,b1.e,b1.f];aQ(cc,R[b2]);R[b2]=cc._.transform;bU[b2]=[(cc.matrix.a-b1.a)/b0,(cc.matrix.b-b1.b)/b0,(cc.matrix.c-b1.c)/b0,(cc.matrix.d-b1.d)/b0,(cc.matrix.e-b1.e)/b0,(cc.matrix.f-b1.f)/b0]}break;case"csv":var g=bJ(cd[b2])[H](a),bQ=bJ(b5[b2])[H](a);if(b2=="clip-rect"){b5[b2]=bQ;bU[b2]=[];b9=bQ.length;while(b9--){bU[b2][b9]=(g[b9]-b5[b2][b9])/b0}}R[b2]=g;break;default:g=[][bG](cd[b2]);bQ=[][bG](b5[b2]);bU[b2]=[];b9=E.paper.customAttributes[b2].length;while(b9--){bU[b2][b9]=((g[b9]||0)-(bQ[b9]||0))/b0}break}}}}var bZ=cd.easing,b7=aT.easing_formulas[bZ];if(!b7){b7=bJ(bZ).match(c);if(b7&&b7.length==5){var bV=b7;b7=function(i){return a5(i,+bV[1],+bV[2],+bV[3],+bV[4],b0)}}else{b7=bD}}S=cd.start||b6.start||+new Date;cb={anim:b6,percent:b,timestamp:S,start:S+(b6.del||0),status:0,initstatus:b4||0,stop:false,ms:b0,easing:b7,from:b5,diff:bU,to:R,el:E,callback:cd.callback,prev:bX,next:bY,repeat:bS||b6.times,origin:E.attr(),totalOrigin:bO};ad.push(cb);if(b4&&!bN&&!bR){cb.stop=true;cb.start=new Date-b0*b4;if(ad.length==1){return bE()}}if(bR){cb.start=new Date-cb.ms*b4}ad.length==1&&aP(bE)}else{bN.initstatus=b4;bN.start=new Date-bN.ms*b4}eve("raphael.anim.start."+E.id,E,b6)}aT.animation=function(R,g,bN,S){if(R instanceof bC){return R}if(aT.is(bN,"function")||!bN){S=S||bN||null;bN=null}R=Object(R);g=+g||0;var E={},i,b;for(b in R){if(R[am](b)&&ap(b)!=b&&ap(b)+"%"!=b){i=true;E[b]=R[b]}}if(!i){return new bC(R,g)}else{bN&&(E.easing=bN);S&&(E.callback=S);return new bC({100:E},g)}};bj.animate=function(E,b,S,R){var g=this;if(g.removed){R&&R.call(g);return g}var i=E instanceof bC?E:aT.animation(E,b,S,R);aO(i,g,i.percents[0],null,g.attr());return g};bj.setTime=function(g,b){if(g&&b!=null){this.status(g,bo(b,g.ms)/g.ms)}return this};bj.status=function(S,R){var g=[],E=0,b,bN;if(R!=null){aO(S,this,-1,bo(R,1));return this}else{b=ad.length;for(;E<b;E++){bN=ad[E];if(bN.el.id==this.id&&(!S||bN.anim==S)){if(S){return bN.status}g.push({anim:bN.anim,status:bN.status})}}if(S){return 0}return g}};bj.pause=function(g){for(var b=0;b<ad.length;b++){if(ad[b].el.id==this.id&&(!g||ad[b].anim==g)){if(eve("raphael.anim.pause."+this.id,this,ad[b].anim)!==false){ad[b].paused=true}}}return this};bj.resume=function(g){for(var b=0;b<ad.length;b++){if(ad[b].el.id==this.id&&(!g||ad[b].anim==g)){var E=ad[b];if(eve("raphael.anim.resume."+this.id,this,E.anim)!==false){delete E.paused;this.status(E.anim,E.status)}}}return this};bj.stop=function(g){for(var b=0;b<ad.length;b++){if(ad[b].el.id==this.id&&(!g||ad[b].anim==g)){if(eve("raphael.anim.stop."+this.id,this,ad[b].anim)!==false){ad.splice(b--,1)}}}return this};function ac(g){for(var b=0;b<ad.length;b++){if(ad[b].el.paper==g){ad.splice(b--,1)}}}eve.on("raphael.remove",ac);eve.on("raphael.clear",ac);bj.toString=function(){return"Rapha\xebl\u2019s object"};var an=function(b){this.items=[];this.length=0;this.type="set";if(b){for(var g=0,E=b.length;g<E;g++){if(b[g]&&(b[g].constructor==bj.constructor||b[g].constructor==an)){this[this.items.length]=this.items[this.items.length]=b[g];this.length++}}}},be=an.prototype;be.push=function(){var R,b;for(var g=0,E=arguments.length;g<E;g++){R=arguments[g];if(R&&(R.constructor==bj.constructor||R.constructor==an)){b=this.items.length;this[b]=this.items[b]=R;this.length++}}return this};be.pop=function(){this.length&&delete this[this.length--];return this.items.pop()};be.forEach=function(R,b){for(var g=0,E=this.items.length;g<E;g++){if(R.call(b,this.items[g],g)===false){return this}}return this};for(var D in bj){if(bj[am](D)){be[D]=(function(b){return function(){var g=arguments;return this.forEach(function(i){i[b][bI](i,g)})}})(D)}}be.attr=function(g,bN){if(g&&aT.is(g,bf)&&aT.is(g[0],"object")){for(var b=0,S=g.length;b<S;b++){this.items[b].attr(g[b])}}else{for(var E=0,R=this.items.length;E<R;E++){this.items[E].attr(g,bN)}}return this};be.clear=function(){while(this.length){this.pop()}};be.splice=function(R,bO,bP){R=R<0?o(this.length+R,0):R;bO=o(0,bo(this.length-R,bO));var E=[],b=[],g=[],S;for(S=2;S<arguments.length;S++){g.push(arguments[S])}for(S=0;S<bO;S++){b.push(this[R+S])}for(;S<this.length-R;S++){E.push(this[R+S])}var bN=g.length;for(S=0;S<bN+E.length;S++){this.items[R+S]=this[R+S]=S<bN?g[S]:E[S-bN]}S=this.items.length=this.length-=bO-bN;while(this[S]){delete this[S++]}return new an(b)};be.exclude=function(E){for(var b=0,g=this.length;b<g;b++){if(this[b]==E){this.splice(b,1);return true}}};be.animate=function(E,b,bO,bQ){(aT.is(bO,"function")||!bO)&&(bQ=bO||null);var bN=this.items.length,R=bN,bR,bP=this,S;if(!bN){return this}bQ&&(S=function(){!--bN&&bQ.call(bP)});bO=aT.is(bO,al)?bO:S;var g=aT.animation(E,b,bO,S);bR=this.items[--R].animate(g);while(R--){this.items[R]&&!this.items[R].removed&&this.items[R].animateWith(bR,g,g)}return this};be.insertAfter=function(g){var b=this.items.length;while(b--){this.items[b].insertAfter(g)}return this};be.getBBox=function(){var b=[],bN=[],g=[],R=[];for(var E=this.items.length;E--;){if(!this.items[E].removed){var S=this.items[E].getBBox();b.push(S.x);bN.push(S.y);g.push(S.x+S.width);R.push(S.y+S.height)}}b=bo[bI](0,b);bN=bo[bI](0,bN);g=o[bI](0,g);R=o[bI](0,R);return{x:b,y:bN,x2:g,y2:R,width:g-b,height:R-bN}};be.clone=function(E){E=this.paper.set();for(var b=0,g=this.items.length;b<g;b++){E.push(this.items[b].clone())}return E};be.toString=function(){return"Rapha\xebl\u2018s set"};aT.registerFont=function(g){if(!g.face){return g}this.fonts=this.fonts||{};var E={w:g.w,face:{},glyphs:{}},i=g.face["font-family"];for(var bN in g.face){if(g.face[am](bN)){E.face[bN]=g.face[bN]}}if(this.fonts[i]){this.fonts[i].push(E)}else{this.fonts[i]=[E]}if(!g.svg){E.face["units-per-em"]=W(g.face["units-per-em"],10);for(var R in g.glyphs){if(g.glyphs[am](R)){var S=g.glyphs[R];E.glyphs[R]={w:S.w,k:{},d:S.d&&"M"+S.d.replace(/[mlcxtrv]/g,function(bO){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[bO]||"M"})+"z"};if(S.k){for(var b in S.k){if(S[am](b)){E.glyphs[R].k[b]=S.k[b]}}}}}}return g};a6.getFont=function(bP,bQ,g,R){R=R||"normal";g=g||"normal";bQ=+bQ||{normal:400,bold:700,lighter:300,bolder:800}[bQ]||400;if(!aT.fonts){return}var S=aT.fonts[bP];if(!S){var E=new RegExp("(^|\\s)"+bP.replace(/[^\w\d\s+!~.:_-]/g,aZ)+"(\\s|$)","i");for(var b in aT.fonts){if(aT.fonts[am](b)){if(E.test(b)){S=aT.fonts[b];break}}}}var bN;if(S){for(var bO=0,bR=S.length;bO<bR;bO++){bN=S[bO];if(bN.face["font-weight"]==bQ&&(bN.face["font-style"]==g||!bN.face["font-style"])&&bN.face["font-stretch"]==R){break}}}return bN};a6.print=function(bO,bN,b,bR,bS,b1,g){b1=b1||"middle";g=o(bo(g||0,1),-1);var b0=bJ(b)[H](aZ),bX=0,bZ=0,bV=aZ,b2;aT.is(bR,b)&&(bR=this.getFont(bR));if(bR){b2=(bS||16)/bR.face["units-per-em"];var R=bR.face.bbox[H](a),bQ=+R[0],E=R[3]-R[1],S=0,bT=+R[1]+(b1=="baseline"?E+(+bR.face.descent):E/2);for(var bW=0,bP=b0.length;bW<bP;bW++){if(b0[bW]=="\n"){bX=0;bY=0;bZ=0;S+=E}else{var bU=bZ&&bR.glyphs[b0[bW-1]]||{},bY=bR.glyphs[b0[bW]];bX+=bZ?(bU.w||bR.w)+(bU.k&&bU.k[b0[bW]]||0)+(bR.w*g):0;bZ=1}if(bY&&bY.d){bV+=aT.transformPath(bY.d,["t",bX*b2,S*b2,"s",b2,b2,bQ,bT,"t",(bO-bQ)/b2,(bN-bT)/b2])}}}return this.path(bV).attr({fill:"#000",stroke:"none"})};a6.add=function(R){if(aT.is(R,"array")){var E=this.set(),g=0,S=R.length,b;for(;g<S;g++){b=R[g]||{};by[am](b.type)&&E.push(this[b.type]().attr(b))}}return E};aT.format=function(g,i){var b=aT.is(i,bf)?[0][bG](i):arguments;g&&aT.is(g,al)&&b.length-1&&(g=g.replace(bt,function(R,E){return b[++E]==null?aZ:b[E]}));return g||aZ};aT.fullfill=(function(){var i=/\{([^\}]+)\}/g,b=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,g=function(S,R,bN){var E=bN;R.replace(b,function(bQ,bP,bO,bS,bR){bP=bP||bS;if(E){if(bP in E){E=E[bP]}typeof E=="function"&&bR&&(E=E())}});E=(E==null||E==bN?S:E)+"";return E};return function(R,E){return String(R).replace(i,function(bN,S){return g(bN,S,E)})}})();aT.ninja=function(){u.was?(aC.win.Raphael=u.is):delete Raphael;return aT};aT.st=be;(function(E,g,i){if(E.readyState==null&&E.addEventListener){E.addEventListener(g,i=function(){E.removeEventListener(g,i,false);E.readyState="complete"},false);E.readyState="loading"}function b(){(/in/).test(E.readyState)?setTimeout(b,9):aT.eve("raphael.DOMload")}b()})(document,"DOMContentLoaded");u.was?(aC.win.Raphael=aT):(Raphael=aT);eve.on("raphael.DOMload",function(){aq=true})})();window.Raphael.svg&&function(o){var e="hasOwnProperty",F=String,q=parseFloat,t=parseInt,g=Math,G=g.max,v=g.abs,i=g.pow,h=/[, ]+/,C=o.eve,u="",m=" ";var r="http://www.w3.org/1999/xlink",B={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},x={};o.toString=function(){return"Your browser supports SVG.\nYou are running Rapha\xebl "+this.version};var l=function(I,E){if(E){if(typeof I=="string"){I=l(I)}for(var H in E){if(E[e](H)){if(H.substring(0,6)=="xlink:"){I.setAttributeNS(r,H.substring(6),F(E[H]))}else{I.setAttribute(H,F(E[H]))}}}}else{I=o._g.doc.createElementNS("http://www.w3.org/2000/svg",I);I.style&&(I.style.webkitTapHighlightColor="rgba(0,0,0,0)")}return I},a=function(P,T){var R="linear",H=P.id+T,N=0.5,L=0.5,J=P.node,E=P.paper,V=J.style,I=o._g.doc.getElementById(H);if(!I){T=F(T).replace(o._radial_gradient,function(Y,W,Z){R="radial";if(W&&Z){N=q(W);L=q(Z);var X=((L>0.5)*2-1);i(N-0.5,2)+i(L-0.5,2)>0.25&&(L=g.sqrt(0.25-i(N-0.5,2))*X+0.5)&&L!=0.5&&(L=L.toFixed(5)-0.00001*X)}return u});T=T.split(/\s*\-\s*/);if(R=="linear"){var M=T.shift();M=-q(M);if(isNaN(M)){return null}var K=[0,0,g.cos(o.rad(M)),g.sin(o.rad(M))],S=1/(G(v(K[2]),v(K[3]))||1);K[2]*=S;K[3]*=S;if(K[2]<0){K[0]=-K[2];K[2]=0}if(K[3]<0){K[1]=-K[3];K[3]=0}}var Q=o._parseDots(T);if(!Q){return null}H=H.replace(/[\(\)\s,\xb0#]/g,"_");if(P.gradient&&H!=P.gradient.id){E.defs.removeChild(P.gradient);delete P.gradient}if(!P.gradient){I=l(R+"Gradient",{id:H});P.gradient=I;l(I,R=="radial"?{fx:N,fy:L}:{x1:K[0],y1:K[1],x2:K[2],y2:K[3],gradientTransform:P.matrix.invert()});E.defs.appendChild(I);for(var O=0,U=Q.length;O<U;O++){I.appendChild(l("stop",{offset:Q[O].offset?Q[O].offset:O?"100%":"0%","stop-color":Q[O].color||"#fff"}))}}}l(J,{fill:"url(#"+H+")",opacity:1,"fill-opacity":1});V.fill=u;V.opacity=1;V.fillOpacity=1;return 1},b=function(H){var E=H.getBBox(1);l(H.pattern,{patternTransform:H.matrix.invert()+" translate("+E.x+","+E.y+")"})},c=function(R,T,M){if(R.type=="path"){var E=F(T).toLowerCase().split("-"),Q=R.paper,ae=M?"end":"start",V=R.node,S=R.attrs,L=S["stroke-width"],Z=E.length,J="classic",Y,I,O,W,U,N=3,aa=3,P=5;while(Z--){switch(E[Z]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":J=E[Z];break;case"wide":aa=5;break;case"narrow":aa=2;break;case"long":N=5;break;case"short":N=2;break}}if(J=="open"){N+=2;aa+=2;P+=2;O=1;W=M?4:1;U={fill:"none",stroke:S.stroke}}else{W=O=N/2;U={fill:S.stroke,stroke:"none"}}if(R._.arrows){if(M){R._.arrows.endPath&&x[R._.arrows.endPath]--;R._.arrows.endMarker&&x[R._.arrows.endMarker]--}else{R._.arrows.startPath&&x[R._.arrows.startPath]--;R._.arrows.startMarker&&x[R._.arrows.startMarker]--}}else{R._.arrows={}}if(J!="none"){var H="raphael-marker-"+J,ad="raphael-marker-"+ae+J+N+aa;if(!o._g.doc.getElementById(H)){Q.defs.appendChild(l(l("path"),{"stroke-linecap":"round",d:B[J],id:H}));x[H]=1}else{x[H]++}var K=o._g.doc.getElementById(ad),X;if(!K){K=l(l("marker"),{id:ad,markerHeight:aa,markerWidth:N,orient:"auto",refX:W,refY:aa/2});X=l(l("use"),{"xlink:href":"#"+H,transform:(M?"rotate(180 "+N/2+" "+aa/2+") ":u)+"scale("+N/P+","+aa/P+")","stroke-width":(1/((N/P+aa/P)/2)).toFixed(4)});K.appendChild(X);Q.defs.appendChild(K);x[ad]=1}else{x[ad]++;X=K.getElementsByTagName("use")[0]}l(X,U);var ac=O*(J!="diamond"&&J!="oval");if(M){Y=R._.arrows.startdx*L||0;I=o.getTotalLength(S.path)-ac*L}else{Y=ac*L;I=o.getTotalLength(S.path)-(R._.arrows.enddx*L||0)}U={};U["marker-"+ae]="url(#"+ad+")";if(I||Y){U.d=Raphael.getSubpath(S.path,Y,I)}l(V,U);R._.arrows[ae+"Path"]=H;R._.arrows[ae+"Marker"]=ad;R._.arrows[ae+"dx"]=ac;R._.arrows[ae+"Type"]=J;R._.arrows[ae+"String"]=T}else{if(M){Y=R._.arrows.startdx*L||0;I=o.getTotalLength(S.path)-Y}else{Y=0;I=o.getTotalLength(S.path)-(R._.arrows.enddx*L||0)}R._.arrows[ae+"Path"]&&l(V,{d:Raphael.getSubpath(S.path,Y,I)});delete R._.arrows[ae+"Path"];delete R._.arrows[ae+"Marker"];delete R._.arrows[ae+"dx"];delete R._.arrows[ae+"Type"];delete R._.arrows[ae+"String"]}for(U in x){if(x[e](U)&&!x[U]){var ab=o._g.doc.getElementById(U);ab&&ab.parentNode.removeChild(ab)}}}},y={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},n=function(M,K,L){K=y[F(K).toLowerCase()];if(K){var I=M.attrs["stroke-width"]||"1",E={round:I,square:I,butt:0}[M.attrs["stroke-linecap"]||L["stroke-linecap"]]||0,J=[],H=K.length;while(H--){J[H]=K[H]*I+((H%2)?1:-1)*E}l(M.node,{"stroke-dasharray":J.join(",")})}},z=function(R,Z){var V=R.node,S=R.attrs,P=V.style.visibility;V.style.visibility="hidden";for(var U in Z){if(Z[e](U)){if(!o._availableAttrs[e](U)){continue}var T=Z[U];S[U]=T;switch(U){case"blur":R.blur(T);break;case"href":case"title":case"target":var X=V.parentNode;if(X.tagName.toLowerCase()!="a"){var K=l("a");X.insertBefore(K,V);K.appendChild(V);X=K}if(U=="target"){X.setAttributeNS(r,"show",T=="blank"?"new":T)}else{X.setAttributeNS(r,U,T)}break;case"cursor":V.style.cursor=T;break;case"transform":R.transform(T);break;case"arrow-start":c(R,T);break;case"arrow-end":c(R,T,1);break;case"clip-rect":var H=F(T).split(h);if(H.length==4){R.clip&&R.clip.parentNode.parentNode.removeChild(R.clip.parentNode);var I=l("clipPath"),W=l("rect");I.id=o.createUUID();l(W,{x:H[0],y:H[1],width:H[2],height:H[3]});I.appendChild(W);R.paper.defs.appendChild(I);l(V,{"clip-path":"url(#"+I.id+")"});R.clip=W}if(!T){var Q=V.getAttribute("clip-path");if(Q){var Y=o._g.doc.getElementById(Q.replace(/(^url\(#|\)$)/g,u));Y&&Y.parentNode.removeChild(Y);l(V,{"clip-path":u});delete R.clip}}break;case"path":if(R.type=="path"){l(V,{d:T?S.path=o._pathToAbsolute(T):"M0,0"});R._.dirty=1;if(R._.arrows){"startString" in R._.arrows&&c(R,R._.arrows.startString);"endString" in R._.arrows&&c(R,R._.arrows.endString,1)}}break;case"width":V.setAttribute(U,T);R._.dirty=1;if(S.fx){U="x";T=S.x}else{break}case"x":if(S.fx){T=-S.x-(S.width||0)}case"rx":if(U=="rx"&&R.type=="rect"){break}case"cx":V.setAttribute(U,T);R.pattern&&b(R);R._.dirty=1;break;case"height":V.setAttribute(U,T);R._.dirty=1;if(S.fy){U="y";T=S.y}else{break}case"y":if(S.fy){T=-S.y-(S.height||0)}case"ry":if(U=="ry"&&R.type=="rect"){break}case"cy":V.setAttribute(U,T);R.pattern&&b(R);R._.dirty=1;break;case"r":if(R.type=="rect"){l(V,{rx:T,ry:T})}else{V.setAttribute(U,T)}R._.dirty=1;break;case"src":if(R.type=="image"){V.setAttributeNS(r,"href",T)}break;case"stroke-width":if(R._.sx!=1||R._.sy!=1){T/=G(v(R._.sx),v(R._.sy))||1}if(R.paper._vbSize){T*=R.paper._vbSize}V.setAttribute(U,T);if(S["stroke-dasharray"]){n(R,S["stroke-dasharray"],Z)}if(R._.arrows){"startString" in R._.arrows&&c(R,R._.arrows.startString);"endString" in R._.arrows&&c(R,R._.arrows.endString,1)}break;case"stroke-dasharray":n(R,T,Z);break;case"fill":var L=F(T).match(o._ISURL);if(L){I=l("pattern");var O=l("image");I.id=o.createUUID();l(I,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});l(O,{x:0,y:0,"xlink:href":L[1]});I.appendChild(O);(function(aa){o._preload(L[1],function(){var ab=this.offsetWidth,ac=this.offsetHeight;l(aa,{width:ab,height:ac});l(O,{width:ab,height:ac});R.paper.safari()})})(I);R.paper.defs.appendChild(I);l(V,{fill:"url(#"+I.id+")"});R.pattern=I;R.pattern&&b(R);break}var J=o.getRGB(T);if(!J.error){delete Z.gradient;delete S.gradient;!o.is(S.opacity,"undefined")&&o.is(Z.opacity,"undefined")&&l(V,{opacity:S.opacity});!o.is(S["fill-opacity"],"undefined")&&o.is(Z["fill-opacity"],"undefined")&&l(V,{"fill-opacity":S["fill-opacity"]})}else{if((R.type=="circle"||R.type=="ellipse"||F(T).charAt()!="r")&&a(R,T)){if("opacity" in S||"fill-opacity" in S){var E=o._g.doc.getElementById(V.getAttribute("fill").replace(/^url\(#|\)$/g,u));if(E){var M=E.getElementsByTagName("stop");l(M[M.length-1],{"stop-opacity":("opacity" in S?S.opacity:1)*("fill-opacity" in S?S["fill-opacity"]:1)})}}S.gradient=T;S.fill="none";break}}J[e]("opacity")&&l(V,{"fill-opacity":J.opacity>1?J.opacity/100:J.opacity});case"stroke":J=o.getRGB(T);V.setAttribute(U,J.hex);U=="stroke"&&J[e]("opacity")&&l(V,{"stroke-opacity":J.opacity>1?J.opacity/100:J.opacity});if(U=="stroke"&&R._.arrows){"startString" in R._.arrows&&c(R,R._.arrows.startString);"endString" in R._.arrows&&c(R,R._.arrows.endString,1)}break;case"gradient":(R.type=="circle"||R.type=="ellipse"||F(T).charAt()!="r")&&a(R,T);break;case"opacity":if(S.gradient&&!S[e]("stroke-opacity")){l(V,{"stroke-opacity":T>1?T/100:T})}case"fill-opacity":if(S.gradient){E=o._g.doc.getElementById(V.getAttribute("fill").replace(/^url\(#|\)$/g,u));if(E){M=E.getElementsByTagName("stop");l(M[M.length-1],{"stop-opacity":T})}break}default:U=="font-size"&&(T=t(T,10)+"px");var N=U.replace(/(\-.)/g,function(aa){return aa.substring(1).toUpperCase()});V.style[N]=T;R._.dirty=1;V.setAttribute(U,T);break}}}s(R,Z);V.style.visibility=P},D=1.2,s=function(E,K){if(E.type!="text"||!(K[e]("text")||K[e]("font")||K[e]("font-size")||K[e]("x")||K[e]("y"))){return}var P=E.attrs,I=E.node,R=I.firstChild?t(o._g.doc.defaultView.getComputedStyle(I.firstChild,u).getPropertyValue("font-size"),10):10;if(K[e]("text")){P.text=K.text;while(I.firstChild){I.removeChild(I.firstChild)}var J=F(K.text).split("\n"),H=[],N;for(var L=0,Q=J.length;L<Q;L++){N=l("tspan");L&&l(N,{dy:R*D,x:P.x});N.appendChild(o._g.doc.createTextNode(J[L]));I.appendChild(N);H[L]=N}}else{H=I.getElementsByTagName("tspan");for(L=0,Q=H.length;L<Q;L++){if(L){l(H[L],{dy:R*D,x:P.x})}else{l(H[0],{dy:0})}}}l(I,{x:P.x,y:P.y});E._.dirty=1;var M=E._getBBox(),O=P.y-(M.y+M.height/2);O&&o.is(O,"finite")&&l(H[0],{dy:O})},w=function(H,E){var J=0,I=0;this[0]=this.node=H;H.raphael=true;this.id=o._oid++;H.raphaelid=this.id;this.matrix=o.matrix();this.realPath=null;this.paper=E;this.attrs=this.attrs||{};this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1};!E.bottom&&(E.bottom=this);this.prev=E.top;E.top&&(E.top.next=this);E.top=this;this.next=null},p=o.el;w.prototype=p;p.constructor=w;o._engine.path=function(E,J){var H=l("path");J.canvas&&J.canvas.appendChild(H);var I=new w(H,J);I.type="path";z(I,{fill:"none",stroke:"#000",path:E});return I};p.rotate=function(H,E,J){if(this.removed){return this}H=F(H).split(h);if(H.length-1){E=q(H[1]);J=q(H[2])}H=q(H[0]);(J==null)&&(E=J);if(E==null||J==null){var I=this.getBBox(1);E=I.x+I.width/2;J=I.y+I.height/2}this.transform(this._.transform.concat([["r",H,E,J]]));return this};p.scale=function(K,I,E,J){if(this.removed){return this}K=F(K).split(h);if(K.length-1){I=q(K[1]);E=q(K[2]);J=q(K[3])}K=q(K[0]);(I==null)&&(I=K);(J==null)&&(E=J);if(E==null||J==null){var H=this.getBBox(1)}E=E==null?H.x+H.width/2:E;J=J==null?H.y+H.height/2:J;this.transform(this._.transform.concat([["s",K,I,E,J]]));return this};p.translate=function(H,E){if(this.removed){return this}H=F(H).split(h);if(H.length-1){E=q(H[1])}H=q(H[0])||0;E=+E||0;this.transform(this._.transform.concat([["t",H,E]]));return this};p.transform=function(H){var I=this._;if(H==null){return I.transform}o._extractTransform(this,H);this.clip&&l(this.clip,{transform:this.matrix.invert()});this.pattern&&b(this);this.node&&l(this.node,{transform:this.matrix});if(I.sx!=1||I.sy!=1){var E=this.attrs[e]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":E})}return this};p.hide=function(){!this.removed&&this.paper.safari(this.node.style.display="none");return this};p.show=function(){!this.removed&&this.paper.safari(this.node.style.display="");return this};p.remove=function(){if(this.removed||!this.node.parentNode){return}var H=this.paper;H.__set__&&H.__set__.exclude(this);C.unbind("raphael.*.*."+this.id);if(this.gradient){H.defs.removeChild(this.gradient)}o._tear(this,H);if(this.node.parentNode.tagName.toLowerCase()=="a"){this.node.parentNode.parentNode.removeChild(this.node.parentNode)}else{this.node.parentNode.removeChild(this.node)}for(var E in this){this[E]=typeof this[E]=="function"?o._removedFactory(E):null}this.removed=true};p._getBBox=function(){if(this.node.style.display=="none"){this.show();var E=true}var I={};try{I=this.node.getBBox()}catch(H){}finally{I=I||{}}E&&this.hide();return I};p.attr=function(E,P){if(this.removed){return this}if(E==null){var M={};for(var O in this.attrs){if(this.attrs[e](O)){M[O]=this.attrs[O]}}M.gradient&&M.fill=="none"&&(M.fill=M.gradient)&&delete M.gradient;M.transform=this._.transform;return M}if(P==null&&o.is(E,"string")){if(E=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}if(E=="transform"){return this._.transform}var N=E.split(h),J={};for(var K=0,R=N.length;K<R;K++){E=N[K];if(E in this.attrs){J[E]=this.attrs[E]}else{if(o.is(this.paper.customAttributes[E],"function")){J[E]=this.paper.customAttributes[E].def}else{J[E]=o._availableAttrs[E]}}}return R-1?J:J[N[0]]}if(P==null&&o.is(E,"array")){J={};for(K=0,R=E.length;K<R;K++){J[E[K]]=this.attr(E[K])}return J}if(P!=null){var H={};H[E]=P}else{if(E!=null&&o.is(E,"object")){H=E}}for(var Q in H){C("raphael.attr."+Q+"."+this.id,this,H[Q])}for(Q in this.paper.customAttributes){if(this.paper.customAttributes[e](Q)&&H[e](Q)&&o.is(this.paper.customAttributes[Q],"function")){var L=this.paper.customAttributes[Q].apply(this,[].concat(H[Q]));this.attrs[Q]=H[Q];for(var I in L){if(L[e](I)){H[I]=L[I]}}}}z(this,H);return this};p.toFront=function(){if(this.removed){return this}if(this.node.parentNode.tagName.toLowerCase()=="a"){this.node.parentNode.parentNode.appendChild(this.node.parentNode)}else{this.node.parentNode.appendChild(this.node)}var E=this.paper;E.top!=this&&o._tofront(this,E);return this};p.toBack=function(){if(this.removed){return this}var H=this.node.parentNode;if(H.tagName.toLowerCase()=="a"){H.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild)}else{if(H.firstChild!=this.node){H.insertBefore(this.node,this.node.parentNode.firstChild)}}o._toback(this,this.paper);var E=this.paper;return this};p.insertAfter=function(E){if(this.removed){return this}var H=E.node||E[E.length-1].node;if(H.nextSibling){H.parentNode.insertBefore(this.node,H.nextSibling)}else{H.parentNode.appendChild(this.node)}o._insertafter(this,E,this.paper);return this};p.insertBefore=function(E){if(this.removed){return this}var H=E.node||E[0].node;H.parentNode.insertBefore(this.node,H);o._insertbefore(this,E,this.paper);return this};p.blur=function(H){var E=this;if(+H!==0){var I=l("filter"),J=l("feGaussianBlur");E.attrs.blur=H;I.id=o.createUUID();l(J,{stdDeviation:+H||1.5});I.appendChild(J);E.paper.defs.appendChild(I);E._blur=I;l(E.node,{filter:"url(#"+I.id+")"})}else{if(E._blur){E._blur.parentNode.removeChild(E._blur);delete E._blur;delete E.attrs.blur}E.node.removeAttribute("filter")}};o._engine.circle=function(H,E,L,K){var J=l("circle");H.canvas&&H.canvas.appendChild(J);var I=new w(J,H);I.attrs={cx:E,cy:L,r:K,fill:"none",stroke:"#000"};I.type="circle";l(J,I.attrs);return I};o._engine.rect=function(I,E,N,H,L,M){var K=l("rect");I.canvas&&I.canvas.appendChild(K);var J=new w(K,I);J.attrs={x:E,y:N,width:H,height:L,r:M||0,rx:M||0,ry:M||0,fill:"none",stroke:"#000"};J.type="rect";l(K,J.attrs);return J};o._engine.ellipse=function(H,E,M,L,K){var J=l("ellipse");H.canvas&&H.canvas.appendChild(J);var I=new w(J,H);I.attrs={cx:E,cy:M,rx:L,ry:K,fill:"none",stroke:"#000"};I.type="ellipse";l(J,I.attrs);return I};o._engine.image=function(I,M,E,N,H,L){var K=l("image");l(K,{x:E,y:N,width:H,height:L,preserveAspectRatio:"none"});K.setAttributeNS(r,"href",M);I.canvas&&I.canvas.appendChild(K);var J=new w(K,I);J.attrs={x:E,y:N,width:H,height:L,src:M};J.type="image";return J};o._engine.text=function(H,E,L,K){var J=l("text");H.canvas&&H.canvas.appendChild(J);var I=new w(J,H);I.attrs={x:E,y:L,"text-anchor":"middle",text:K,font:o._availableAttrs.font,stroke:"none",fill:"#000"};I.type="text";z(I,I.attrs);return I};o._engine.setSize=function(H,E){this.width=H||this.width;this.height=E||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);if(this._viewBox){this.setViewBox.apply(this,this._viewBox)}return this};o._engine.create=function(){var J=o._getContainer.apply(0,arguments),H=J&&J.container,N=J.x,M=J.y,I=J.width,O=J.height;if(!H){throw new Error("SVG container not found.")}var E=l("svg"),L="overflow:hidden;",K;N=N||0;M=M||0;I=I||512;O=O||342;l(E,{height:O,version:1.1,width:I,xmlns:"http://www.w3.org/2000/svg"});if(H==1){E.style.cssText=L+"position:absolute;left:"+N+"px;top:"+M+"px";o._g.doc.body.appendChild(E);K=1}else{E.style.cssText=L+"position:relative";if(H.firstChild){H.insertBefore(E,H.firstChild)}else{H.appendChild(E)}}H=new o._Paper;H.width=I;H.height=O;H.canvas=E;H.clear();H._left=H._top=0;K&&(H.renderfix=function(){});H.renderfix();return H};o._engine.setViewBox=function(L,J,N,E,H){C("raphael.setViewBox",this,this._viewBox,[L,J,N,E,H]);var P=G(N/this.width,E/this.height),K=this.top,O=H?"meet":"xMinYMin",I,M;if(L==null){if(this._vbSize){P=1}delete this._vbSize;I="0 0 "+this.width+m+this.height}else{this._vbSize=P;I=L+m+J+m+N+m+E}l(this.canvas,{viewBox:I,preserveAspectRatio:O});while(P&&K){M="stroke-width" in K.attrs?K.attrs["stroke-width"]:1;K.attr({"stroke-width":M});K._.dirty=1;K._.dirtyT=1;K=K.prev}this._viewBox=[L,J,N,E,!!H];return this};o.prototype.renderfix=function(){var L=this.canvas,E=L.style,K;try{K=L.getScreenCTM()||L.createSVGMatrix()}catch(J){K=L.createSVGMatrix()}var I=-K.e%1,H=-K.f%1;if(I||H){if(I){this._left=(this._left+I)%1;E.left=this._left+"px"}if(H){this._top=(this._top+H)%1;E.top=this._top+"px"}}};o.prototype.clear=function(){o.eve("raphael.clear",this);var E=this.canvas;while(E.firstChild){E.removeChild(E.firstChild)}this.bottom=this.top=null;(this.desc=l("desc")).appendChild(o._g.doc.createTextNode("Created with Rapha\xebl "+o.version));E.appendChild(this.desc);E.appendChild(this.defs=l("defs"))};o.prototype.remove=function(){C("raphael.remove",this);this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var E in this){this[E]=typeof this[E]=="function"?o._removedFactory(E):null}};var A=o.st;for(var f in p){if(p[e](f)&&!A[e](f)){A[f]=(function(E){return function(){var H=arguments;return this.forEach(function(I){I[E].apply(I,H)})}})(f)}}}(window.Raphael);window.Raphael.vml&&function(o){var f="hasOwnProperty",I=String,q=parseFloat,i=Math,F=i.round,L=i.max,G=i.min,v=i.abs,y="fill",l=/[, ]+/,D=o.eve,z=" progid:DXImageTransform.Microsoft",n=" ",t="",H={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},m=/([clmz]),?([^clmz]*)/gi,w=/ progid:\S+Blur\([^\)]+\)/g,K=/-?[^,\s-]+/g,e="position:absolute;left:0;top:0;width:1px;height:1px",b=21600,C={path:1,rect:1,image:1},u={circle:1,ellipse:1},g=function(V){var S=/[ahqstv]/ig,N=o._pathToAbsolute;I(V).match(S)&&(N=o._path2curve);S=/[clmz]/g;if(N==o._pathToAbsolute&&!I(V).match(S)){var R=I(V).replace(m,function(Z,ab,X){var aa=[],W=ab.toLowerCase()=="m",Y=H[ab];X.replace(K,function(ac){if(W&&aa.length==2){Y+=aa+H[ab=="m"?"l":"L"];aa=[]}aa.push(F(ac*b))});return Y+aa});return R}var T=N(V),M,E;R=[];for(var P=0,U=T.length;P<U;P++){M=T[P];E=T[P][0].toLowerCase();E=="z"&&(E="x");for(var O=1,Q=M.length;O<Q;O++){E+=F(M[O]*b)+(O!=Q-1?",":t)}R.push(E)}return R.join(n)},r=function(O,N,M){var E=o.matrix();E.rotate(-O,0.5,0.5);return{dx:E.x(N,M),dy:E.y(N,M)}},s=function(U,T,S,P,O,Q){var ac=U._,W=U.matrix,E=ac.fillpos,V=U.node,R=V.style,N=1,M="",Y,aa=b/T,Z=b/S;R.visibility="hidden";if(!T||!S){return}V.coordsize=v(aa)+n+v(Z);R.rotation=Q*(T*S<0?-1:1);if(Q){var ab=r(Q,P,O);P=ab.dx;O=ab.dy}T<0&&(M+="x");S<0&&(M+=" y")&&(N=-1);R.flip=M;V.coordorigin=(P*-aa)+n+(O*-Z);if(E||ac.fillsize){var X=V.getElementsByTagName(y);X=X&&X[0];V.removeChild(X);if(E){ab=r(Q,W.x(E[0],E[1]),W.y(E[0],E[1]));X.position=ab.dx*N+n+ab.dy*N}if(ac.fillsize){X.size=ac.fillsize[0]*v(T)+n+ac.fillsize[1]*v(S)}V.appendChild(X)}R.visibility="visible"};o.toString=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\xebl "+this.version};var c=function(E,R,M){var T=I(R).toLowerCase().split("-"),P=M?"end":"start",N=T.length,Q="classic",S="medium",O="medium";while(N--){switch(T[N]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":Q=T[N];break;case"wide":case"narrow":O=T[N];break;case"long":case"short":S=T[N];break}}var U=E.node.getElementsByTagName("stroke")[0];U[P+"arrow"]=Q;U[P+"arrowlength"]=S;U[P+"arrowwidth"]=O},A=function(ac,am){ac.attrs=ac.attrs||{};var ah=ac.node,aq=ac.attrs,Y=ah.style,U,ak=C[ac.type]&&(am.x!=aq.x||am.y!=aq.y||am.width!=aq.width||am.height!=aq.height||am.cx!=aq.cx||am.cy!=aq.cy||am.rx!=aq.rx||am.ry!=aq.ry||am.r!=aq.r),ab=u[ac.type]&&(aq.cx!=am.cx||aq.cy!=am.cy||aq.r!=am.r||aq.rx!=am.rx||aq.ry!=am.ry),au=ac;for(var Z in am){if(am[f](Z)){aq[Z]=am[Z]}}if(ak){aq.path=o._getPath[ac.type](ac);ac._.dirty=1}am.href&&(ah.href=am.href);am.title&&(ah.title=am.title);am.target&&(ah.target=am.target);am.cursor&&(Y.cursor=am.cursor);"blur" in am&&ac.blur(am.blur);if(am.path&&ac.type=="path"||ak){ah.path=g(~I(aq.path).toLowerCase().indexOf("r")?o._pathToAbsolute(aq.path):aq.path);if(ac.type=="image"){ac._.fillpos=[aq.x,aq.y];ac._.fillsize=[aq.width,aq.height];s(ac,1,1,0,0,0)}}"transform" in am&&ac.transform(am.transform);if(ab){var P=+aq.cx,N=+aq.cy,T=+aq.rx||+aq.r||0,S=+aq.ry||+aq.r||0;ah.path=o.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",F((P-T)*b),F((N-S)*b),F((P+T)*b),F((N+S)*b),F(P*b))}if("clip-rect" in am){var M=I(am["clip-rect"]).split(l);if(M.length==4){M[2]=+M[2]+(+M[0]);M[3]=+M[3]+(+M[1]);var aa=ah.clipRect||o._g.doc.createElement("div"),at=aa.style;at.clip=o.format("rect({1}px {2}px {3}px {0}px)",M);if(!ah.clipRect){at.position="absolute";at.top=0;at.left=0;at.width=ac.paper.width+"px";at.height=ac.paper.height+"px";ah.parentNode.insertBefore(aa,ah);aa.appendChild(ah);ah.clipRect=aa}}if(!am["clip-rect"]){ah.clipRect&&(ah.clipRect.style.clip="auto")}}if(ac.textpath){var ao=ac.textpath.style;am.font&&(ao.font=am.font);am["font-family"]&&(ao.fontFamily='"'+am["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,t)+'"');am["font-size"]&&(ao.fontSize=am["font-size"]);am["font-weight"]&&(ao.fontWeight=am["font-weight"]);am["font-style"]&&(ao.fontStyle=am["font-style"])}if("arrow-start" in am){c(au,am["arrow-start"])}if("arrow-end" in am){c(au,am["arrow-end"],1)}if(am.opacity!=null||am["stroke-width"]!=null||am.fill!=null||am.src!=null||am.stroke!=null||am["stroke-width"]!=null||am["stroke-opacity"]!=null||am["fill-opacity"]!=null||am["stroke-dasharray"]!=null||am["stroke-miterlimit"]!=null||am["stroke-linejoin"]!=null||am["stroke-linecap"]!=null){var ai=ah.getElementsByTagName(y),ap=false;ai=ai&&ai[0];!ai&&(ap=ai=J(y));if(ac.type=="image"&&am.src){ai.src=am.src}am.fill&&(ai.on=true);if(ai.on==null||am.fill=="none"||am.fill===null){ai.on=false}if(ai.on&&am.fill){var R=I(am.fill).match(o._ISURL);if(R){ai.parentNode==ah&&ah.removeChild(ai);ai.rotate=true;ai.src=R[1];ai.type="tile";var E=ac.getBBox(1);ai.position=E.x+n+E.y;ac._.fillpos=[E.x,E.y];o._preload(R[1],function(){ac._.fillsize=[this.offsetWidth,this.offsetHeight]})}else{ai.color=o.getRGB(am.fill).hex;ai.src=t;ai.type="solid";if(o.getRGB(am.fill).error&&(au.type in {circle:1,ellipse:1}||I(am.fill).charAt()!="r")&&a(au,am.fill,ai)){aq.fill="none";aq.gradient=am.fill;ai.rotate=false}}}if("fill-opacity" in am||"opacity" in am){var Q=((+aq["fill-opacity"]+1||2)-1)*((+aq.opacity+1||2)-1)*((+o.getRGB(am.fill).o+1||2)-1);Q=G(L(Q,0),1);ai.opacity=Q;if(ai.src){ai.color="none"}}ah.appendChild(ai);var V=(ah.getElementsByTagName("stroke")&&ah.getElementsByTagName("stroke")[0]),ar=false;!V&&(ar=V=J("stroke"));if((am.stroke&&am.stroke!="none")||am["stroke-width"]||am["stroke-opacity"]!=null||am["stroke-dasharray"]||am["stroke-miterlimit"]||am["stroke-linejoin"]||am["stroke-linecap"]){V.on=true}(am.stroke=="none"||am.stroke===null||V.on==null||am.stroke==0||am["stroke-width"]==0)&&(V.on=false);var ag=o.getRGB(am.stroke);V.on&&am.stroke&&(V.color=ag.hex);Q=((+aq["stroke-opacity"]+1||2)-1)*((+aq.opacity+1||2)-1)*((+ag.o+1||2)-1);var ad=(q(am["stroke-width"])||1)*0.75;Q=G(L(Q,0),1);am["stroke-width"]==null&&(ad=aq["stroke-width"]);am["stroke-width"]&&(V.weight=ad);ad&&ad<1&&(Q*=ad)&&(V.weight=1);V.opacity=Q;am["stroke-linejoin"]&&(V.joinstyle=am["stroke-linejoin"]||"miter");V.miterlimit=am["stroke-miterlimit"]||8;am["stroke-linecap"]&&(V.endcap=am["stroke-linecap"]=="butt"?"flat":am["stroke-linecap"]=="square"?"square":"round");if(am["stroke-dasharray"]){var af={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};V.dashstyle=af[f](am["stroke-dasharray"])?af[am["stroke-dasharray"]]:t}ar&&ah.appendChild(V)}if(au.type=="text"){au.paper.canvas.style.display=t;var aj=au.paper.span,ae=100,O=aq.font&&aq.font.match(/\d+(?:\.\d*)?(?=px)/);Y=aj.style;aq.font&&(Y.font=aq.font);aq["font-family"]&&(Y.fontFamily=aq["font-family"]);aq["font-weight"]&&(Y.fontWeight=aq["font-weight"]);aq["font-style"]&&(Y.fontStyle=aq["font-style"]);O=q(aq["font-size"]||O&&O[0])||10;Y.fontSize=O*ae+"px";au.textpath.string&&(aj.innerHTML=I(au.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var X=aj.getBoundingClientRect();au.W=aq.w=(X.right-X.left)/ae;au.H=aq.h=(X.bottom-X.top)/ae;au.X=aq.x;au.Y=aq.y+au.H/2;("x" in am||"y" in am)&&(au.path.v=o.format("m{0},{1}l{2},{1}",F(aq.x*b),F(aq.y*b),F(aq.x*b)+1));var W=["x","y","text","font","font-family","font-weight","font-style","font-size"];for(var al=0,an=W.length;al<an;al++){if(W[al] in am){au._.dirty=1;break}}switch(aq["text-anchor"]){case"start":au.textpath.style["v-text-align"]="left";au.bbx=au.W/2;break;case"end":au.textpath.style["v-text-align"]="right";au.bbx=-au.W/2;break;default:au.textpath.style["v-text-align"]="center";au.bbx=0;break}au.textpath.style["v-text-kern"]=true}},a=function(E,U,X){E.attrs=E.attrs||{};var V=E.attrs,O=Math.pow,P,Q,S="linear",T=".5 .5";E.attrs.gradient=U;U=I(U).replace(o._radial_gradient,function(aa,ab,Z){S="radial";if(ab&&Z){ab=q(ab);Z=q(Z);O(ab-0.5,2)+O(Z-0.5,2)>0.25&&(Z=i.sqrt(0.25-O(ab-0.5,2))*((Z>0.5)*2-1)+0.5);T=ab+n+Z}return t});U=U.split(/\s*\-\s*/);if(S=="linear"){var M=U.shift();M=-q(M);if(isNaN(M)){return null}}var R=o._parseDots(U);if(!R){return null}E=E.shape||E.node;if(R.length){E.removeChild(X);X.on=true;X.method="none";X.color=R[0].color;X.color2=R[R.length-1].color;var Y=[];for(var N=0,W=R.length;N<W;N++){R[N].offset&&Y.push(R[N].offset+n+R[N].color)}X.colors=Y.length?Y.join():"0% "+X.color;if(S=="radial"){X.type="gradientTitle";X.focus="100%";X.focussize="0 0";X.focusposition=T;X.angle=0}else{X.type="gradient";X.angle=(270-M)%360}E.appendChild(X)}return 1},x=function(M,E){this[0]=this.node=M;M.raphael=true;this.id=o._oid++;M.raphaelid=this.id;this.X=0;this.Y=0;this.attrs={};this.paper=E;this.matrix=o.matrix();this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1};!E.bottom&&(E.bottom=this);this.prev=E.top;E.top&&(E.top.next=this);E.top=this;this.next=null};var p=o.el;x.prototype=p;p.constructor=x;p.transform=function(P){if(P==null){return this._.transform}var R=this.paper._viewBoxShift,Q=R?"s"+[R.scale,R.scale]+"-1-1t"+[R.dx,R.dy]:t,U;if(R){U=P=I(P).replace(/\.{3}|\u2026/g,this._.transform||t)}o._extractTransform(this,Q+P);var V=this.matrix.clone(),X=this.skew,N=this.node,T,O=~I(this.attrs.fill).indexOf("-"),E=!I(this.attrs.fill).indexOf("url(");V.translate(-0.5,-0.5);if(E||O||this.type=="image"){X.matrix="1 0 0 1";X.offset="0 0";T=V.split();if((O&&T.noRotation)||!T.isSimple){N.style.filter=V.toFilter();var S=this.getBBox(),M=this.getBBox(1),Y=S.x-M.x,W=S.y-M.y;N.coordorigin=(Y*-b)+n+(W*-b);s(this,1,1,Y,W,0)}else{N.style.filter=t;s(this,T.scalex,T.scaley,T.dx,T.dy,T.rotate)}}else{N.style.filter=t;X.matrix=I(V);X.offset=V.offset()}U&&(this._.transform=U);return this};p.rotate=function(M,E,O){if(this.removed){return this}if(M==null){return}M=I(M).split(l);if(M.length-1){E=q(M[1]);O=q(M[2])}M=q(M[0]);(O==null)&&(E=O);if(E==null||O==null){var N=this.getBBox(1);E=N.x+N.width/2;O=N.y+N.height/2}this._.dirtyT=1;this.transform(this._.transform.concat([["r",M,E,O]]));return this};p.translate=function(M,E){if(this.removed){return this}M=I(M).split(l);if(M.length-1){E=q(M[1])}M=q(M[0])||0;E=+E||0;if(this._.bbox){this._.bbox.x+=M;this._.bbox.y+=E}this.transform(this._.transform.concat([["t",M,E]]));return this};p.scale=function(P,N,E,O){if(this.removed){return this}P=I(P).split(l);if(P.length-1){N=q(P[1]);E=q(P[2]);O=q(P[3]);isNaN(E)&&(E=null);isNaN(O)&&(O=null)}P=q(P[0]);(N==null)&&(N=P);(O==null)&&(E=O);if(E==null||O==null){var M=this.getBBox(1)}E=E==null?M.x+M.width/2:E;O=O==null?M.y+M.height/2:O;this.transform(this._.transform.concat([["s",P,N,E,O]]));this._.dirtyT=1;return this};p.hide=function(){!this.removed&&(this.node.style.display="none");return this};p.show=function(){!this.removed&&(this.node.style.display=t);return this};p._getBBox=function(){if(this.removed){return{}}return{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}};p.remove=function(){if(this.removed||!this.node.parentNode){return}this.paper.__set__&&this.paper.__set__.exclude(this);o.eve.unbind("raphael.*.*."+this.id);o._tear(this,this.paper);this.node.parentNode.removeChild(this.node);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var E in this){this[E]=typeof this[E]=="function"?o._removedFactory(E):null}this.removed=true};p.attr=function(E,U){if(this.removed){return this}if(E==null){var R={};for(var T in this.attrs){if(this.attrs[f](T)){R[T]=this.attrs[T]}}R.gradient&&R.fill=="none"&&(R.fill=R.gradient)&&delete R.gradient;R.transform=this._.transform;return R}if(U==null&&o.is(E,"string")){if(E==y&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}var S=E.split(l),O={};for(var P=0,W=S.length;P<W;P++){E=S[P];if(E in this.attrs){O[E]=this.attrs[E]}else{if(o.is(this.paper.customAttributes[E],"function")){O[E]=this.paper.customAttributes[E].def}else{O[E]=o._availableAttrs[E]}}}return W-1?O:O[S[0]]}if(this.attrs&&U==null&&o.is(E,"array")){O={};for(P=0,W=E.length;P<W;P++){O[E[P]]=this.attr(E[P])}return O}var M;if(U!=null){M={};M[E]=U}U==null&&o.is(E,"object")&&(M=E);for(var V in M){D("raphael.attr."+V+"."+this.id,this,M[V])}if(M){for(V in this.paper.customAttributes){if(this.paper.customAttributes[f](V)&&M[f](V)&&o.is(this.paper.customAttributes[V],"function")){var Q=this.paper.customAttributes[V].apply(this,[].concat(M[V]));this.attrs[V]=M[V];for(var N in Q){if(Q[f](N)){M[N]=Q[N]}}}}if(M.text&&this.type=="text"){this.textpath.string=M.text}A(this,M)}return this};p.toFront=function(){!this.removed&&this.node.parentNode.appendChild(this.node);this.paper&&this.paper.top!=this&&o._tofront(this,this.paper);return this};p.toBack=function(){if(this.removed){return this}if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild);o._toback(this,this.paper)}return this};p.insertAfter=function(E){if(this.removed){return this}if(E.constructor==o.st.constructor){E=E[E.length-1]}if(E.node.nextSibling){E.node.parentNode.insertBefore(this.node,E.node.nextSibling)}else{E.node.parentNode.appendChild(this.node)}o._insertafter(this,E,this.paper);return this};p.insertBefore=function(E){if(this.removed){return this}if(E.constructor==o.st.constructor){E=E[0]}E.node.parentNode.insertBefore(this.node,E.node);o._insertbefore(this,E,this.paper);return this};p.blur=function(E){var M=this.node.runtimeStyle,N=M.filter;N=N.replace(w,t);if(+E!==0){this.attrs.blur=E;M.filter=N+n+z+".Blur(pixelradius="+(+E||1.5)+")";M.margin=o.format("-{0}px 0 0 -{0}px",F(+E||1.5))}else{M.filter=N;M.margin=0;delete this.attrs.blur}};o._engine.path=function(O,M){var P=J("shape");P.style.cssText=e;P.coordsize=b+n+b;P.coordorigin=M.coordorigin;var Q=new x(P,M),E={fill:"none",stroke:"#000"};O&&(E.path=O);Q.type="path";Q.path=[];Q.Path=t;A(Q,E);M.canvas.appendChild(P);var N=J("skew");N.on=true;P.appendChild(N);Q.skew=N;Q.transform(t);return Q};o._engine.rect=function(M,R,P,S,N,E){var T=o._rectPath(R,P,S,N,E),O=M.path(T),Q=O.attrs;O.X=Q.x=R;O.Y=Q.y=P;O.W=Q.width=S;O.H=Q.height=N;Q.r=E;Q.path=T;O.type="rect";return O};o._engine.ellipse=function(M,E,R,Q,P){var O=M.path(),N=O.attrs;O.X=E-Q;O.Y=R-P;O.W=Q*2;O.H=P*2;O.type="ellipse";A(O,{cx:E,cy:R,rx:Q,ry:P});return O};o._engine.circle=function(M,E,Q,P){var O=M.path(),N=O.attrs;O.X=E-P;O.Y=Q-P;O.W=O.H=P*2;O.type="circle";A(O,{cx:E,cy:Q,r:P});return O};o._engine.image=function(M,E,S,Q,T,O){var V=o._rectPath(S,Q,T,O),P=M.path(V).attr({stroke:"none"}),R=P.attrs,N=P.node,U=N.getElementsByTagName(y)[0];R.src=E;P.X=R.x=S;P.Y=R.y=Q;P.W=R.width=T;P.H=R.height=O;R.path=V;P.type="image";U.parentNode==N&&N.removeChild(U);U.rotate=true;U.src=E;U.type="tile";P._.fillpos=[S,Q];P._.fillsize=[T,O];N.appendChild(U);s(P,1,1,0,0,0);return P};o._engine.text=function(E,R,Q,S){var O=J("shape"),U=J("path"),N=J("textpath");R=R||0;Q=Q||0;S=S||"";U.v=o.format("m{0},{1}l{2},{1}",F(R*b),F(Q*b),F(R*b)+1);U.textpathok=true;N.string=I(S);N.on=true;O.style.cssText=e;O.coordsize=b+n+b;O.coordorigin="0 0";var M=new x(O,E),P={fill:"#000",stroke:"none",font:o._availableAttrs.font,text:S};M.shape=O;M.path=U;M.textpath=N;M.type="text";M.attrs.text=I(S);M.attrs.x=R;M.attrs.y=Q;M.attrs.w=1;M.attrs.h=1;A(M,P);O.appendChild(N);O.appendChild(U);E.canvas.appendChild(O);var T=J("skew");T.on=true;O.appendChild(T);M.skew=T;M.transform(t);return M};o._engine.setSize=function(N,E){var M=this.canvas.style;this.width=N;this.height=E;N==+N&&(N+="px");E==+E&&(E+="px");M.width=N;M.height=E;M.clip="rect(0 "+N+" "+E+" 0)";if(this._viewBox){o._engine.setViewBox.apply(this,this._viewBox)}return this};o._engine.setViewBox=function(Q,P,R,N,O){o.eve("raphael.setViewBox",this,this._viewBox,[Q,P,R,N,O]);var E=this.width,T=this.height,U=1/L(R/E,N/T),S,M;if(O){S=T/N;M=E/R;if(R*S<E){Q-=(E-R*S)/2/S}if(N*M<T){P-=(T-N*M)/2/M}}this._viewBox=[Q,P,R,N,!!O];this._viewBoxShift={dx:-Q,dy:-P,scale:U};this.forEach(function(V){V.transform("...")});return this};var J;o._engine.initWin=function(N){var M=N.document;M.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!M.namespaces.rvml&&M.namespaces.add("rvml","urn:schemas-microsoft-com:vml");J=function(O){return M.createElement("<rvml:"+O+' class="rvml">')}}catch(E){J=function(O){return M.createElement("<"+O+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}};o._engine.initWin(o._g.win);o._engine.create=function(){var N=o._getContainer.apply(0,arguments),E=N.container,T=N.height,U,M=N.width,S=N.x,R=N.y;if(!E){throw new Error("VML container not found.")}var P=new o._Paper,Q=P.canvas=o._g.doc.createElement("div"),O=Q.style;S=S||0;R=R||0;M=M||512;T=T||342;P.width=M;P.height=T;M==+M&&(M+="px");T==+T&&(T+="px");P.coordsize=b*1000+n+b*1000;P.coordorigin="0 0";P.span=o._g.doc.createElement("span");P.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;";Q.appendChild(P.span);O.cssText=o.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",M,T);if(E==1){o._g.doc.body.appendChild(Q);O.left=S+"px";O.top=R+"px";O.position="absolute"}else{if(E.firstChild){E.insertBefore(Q,E.firstChild)}else{E.appendChild(Q)}}P.renderfix=function(){};return P};o.prototype.clear=function(){o.eve("raphael.clear",this);this.canvas.innerHTML=t;this.span=o._g.doc.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas.appendChild(this.span);this.bottom=this.top=null};o.prototype.remove=function(){o.eve("raphael.remove",this);this.canvas.parentNode.removeChild(this.canvas);for(var E in this){this[E]=typeof this[E]=="function"?o._removedFactory(E):null}return true};var B=o.st;for(var h in p){if(p[f](h)&&!B[f](h)){B[h]=(function(E){return function(){var M=arguments;return this.forEach(function(N){N[E].apply(N,M)})}})(h)}}}(window.Raphael);(function(){window.ScaleRaphael=function(c,f,b){var h=(typeof c=="string")?document.getElementById(c):c;if(!h.style.position){h.style.position="relative"}h.style.width=f+"px";h.style.height=b+"px";h.style.overflow="hidden";var e;if(Raphael.type=="VML"){h.innerHTML="<rvml:group style='position : absolute; width: 1000px; height: 1000px; top: 0px; left: 0px' coordsize='1000,1000' class='rvml' id='vmlgroup'></rvml:group>";e=document.getElementById("vmlgroup")}else{h.innerHTML="<div id='svggroup'></div>";e=document.getElementById("svggroup")}var g=new Raphael(e,f,b);var a;if(Raphael.type=="SVG"){g.canvas.setAttribute("viewBox","0 0 "+f+" "+b)}else{a=h.getElementsByTagName("div")[0]}g.changeSize=function(y,t,m,n){n=!n;var v=y/f;var p=t/b;var o=v<p?v:p;var l=parseInt(b*o);var s=parseInt(f*o);if(Raphael.type=="VML"){var r=document.getElementsByTagName("textpath");for(var q in r){var z=r[q];if(z.style){if(!z._fontSize){var x=z.style.font.split("px");z._fontSize=parseInt(x[0]);z._font=x[1]}z.style.font=z._fontSize*o+"px"+z._font}}var u;if(s<l){u=s*1000/f}else{u=l*1000/b}u=parseInt(u);e.style.width=u+"px";e.style.height=u+"px";if(n){e.style.left=parseInt((y-s)/2)+"px";e.style.top=parseInt((t-l)/2)+"px"}a.style.overflow="visible"}if(n){s=y;l=t}h.style.width=s+"px";h.style.height=l+"px";g.setSize(s,l);if(m){h.style.position="absolute";h.style.left=parseInt((y-s)/2)+"px";h.style.top=parseInt((t-l)/2)+"px"}};g.scaleAll=function(i){g.changeSize(f*i,b*i)};g.changeSize(f,b);g.w=f;g.h=b;return g}})();(function(c,b){var a={};if(typeof a==="undefined"){a={}}if(typeof b!=="function"){b=function(e){return a}}(function(){var H=function(aF){var aH=arguments[0],aE=1,aG=arguments[aE];while(aG){aH=aH.slice(0,-1)+aG.slice(1);aG=arguments[++aE]}return aH},x=function(aE){return"(?:"+aE+")"},g="[A-Za-z]",O="[\\x0D]",l="[0-9]",ah="[\\x22]",av=H(l,"[A-Fa-f]"),ak="[\\x0A]",ae="[\\x20]",am=x("%"+av+av),aw="[\\:\\/\\?\\#\\[\\]\\@]",an="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",L=H(aw,an),S=H(g,l,"[\\-\\.\\_\\~]"),h=x(g+H(g,l,"[\\+\\-\\.]")+"*"),r=x(x(am+"|"+H(S,an,"[\\:]"))+"*"),W=x(x("25[0-5]")+"|"+x("2[0-4]"+l)+"|"+x("1"+l+l)+"|"+x("[1-9]"+l)+"|"+l),au=x(W+"\\."+W+"\\."+W+"\\."+W),N=x(av+"{1,4}"),ay=x(x(N+"\\:"+N)+"|"+au),ar=x(H(S,an,"[\\:]")+"+"),T=x("v"+av+"+\\."+H(S,an,"[\\:]")+"+"),at=x("\\["+x(ar+"|"+T)+"\\]"),aD=x(x(am+"|"+H(S,an))+"*"),i=x(at+"|"+au+"|"+aD),aa=x(l+"*"),n=x(x(r+"@")+"?"+i+x("\\:"+aa)+"?"),t=x(am+"|"+H(S,an,"[\\:\\@]")),Y=x(t+"*"),al=x(t+"+"),aj=x(x(am+"|"+H(S,an,"[\\@]"))+"+"),e=x(x("\\/"+Y)+"*"),s=x("\\/"+x(al+e)+"?"),az=x(aj+e),aC=x(al+e),f=x(""),o=x(e+"|"+s+"|"+az+"|"+aC+"|"+f),u=x(x(t+"|[\\/\\?]")+"*"),Z=x(x(t+"|[\\/\\?]")+"*"),ax=x(x("\\/\\/"+n+e)+"|"+s+"|"+aC+"|"+f),ac=x(h+"\\:"+ax+x("\\?"+u)+"?"+x("\\#"+Z)+"?"),R=x(x("\\/\\/"+n+e)+"|"+s+"|"+az+"|"+f),w=x(R+x("\\?"+u)+"?"+x("\\#"+Z)+"?"),y=x(ac+"|"+w),aA=x(h+"\\:"+ax+x("\\?"+u)+"?"),v=new RegExp("^"+x("("+ac+")|("+w+")")+"$"),aq=new RegExp("^("+h+")\\:"+x(x("\\/\\/("+x("("+r+")@")+"?("+i+")"+x("\\:("+aa+")")+"?)")+"?("+e+"|"+s+"|"+aC+"|"+f+")")+x("\\?("+u+")")+"?"+x("\\#("+Z+")")+"?$"),P=new RegExp("^(){0}"+x(x("\\/\\/("+x("("+r+")@")+"?("+i+")"+x("\\:("+aa+")")+"?)")+"?("+e+"|"+s+"|"+az+"|"+f+")")+x("\\?("+u+")")+"?"+x("\\#("+Z+")")+"?$"),I=new RegExp("^("+h+")\\:"+x(x("\\/\\/("+x("("+r+")@")+"?("+i+")"+x("\\:("+aa+")")+"?)")+"?("+e+"|"+s+"|"+aC+"|"+f+")")+x("\\?("+u+")")+"?$"),Q=new RegExp("^"+x("\\#("+Z+")")+"?$"),J=new RegExp("^"+x("("+r+")@")+"?("+i+")"+x("\\:("+aa+")")+"?$"),ao=new RegExp(H("[^]",g,l,"[\\+\\-\\.]"),"g"),ad=new RegExp(H("[^\\%\\:]",S,an),"g"),aB=new RegExp(H("[^\\%]",S,an),"g"),U=new RegExp(H("[^\\%\\/\\:\\@]",S,an),"g"),ab=new RegExp(H("[^\\%\\/\\@]",S,an),"g"),E=new RegExp(H("[^\\%]",S,an,"[\\:\\@\\/\\?]"),"g"),M=E,X=new RegExp(H("[^]",S,an),"g"),K=new RegExp(S,"g"),z=new RegExp(H("[^\\%]",S,L),"g"),V=new RegExp(am+"+","g"),q=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?([^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/i,G=/^\.\.?\//,F=/^\/\.(\/|$)/,D=/^\/\.\.(\/|$)/,B=/^\.\.?$/,A=/^\/?.*?(?=\/|$)/,C=("").match(/(){0}/)[1]===undefined,p=function(aE){var aF=aE.charCodeAt(0);if(aF<128){return"%"+aF.toString(16).toUpperCase()}else{if((aF>127)&&(aF<2048)){return"%"+((aF>>6)|192).toString(16).toUpperCase()+"%"+((aF&63)|128).toString(16).toUpperCase()}else{return"%"+((aF>>12)|224).toString(16).toUpperCase()+"%"+(((aF>>6)&63)|128).toString(16).toUpperCase()+"%"+((aF&63)|128).toString(16).toUpperCase()}}},ap=function(aH){var aE="",aF=0,aI,aG;while(aF<aH.length){aI=parseInt(aH.substr(aF+1,2),16);if(aI<128){aG=String.fromCharCode(aI);if(aG.match(K)){aE+=aG}else{aE+=aH.substr(aF,3)}aF+=3}else{if((aI>191)&&(aI<224)){aE+=aH.substr(aF,6);aF+=6}else{aE+=aH.substr(aF,9);aF+=9}}}return aE},m=function(aI){var aF="",aH=0,aJ,aG,aE;while(aH<aI.length){aJ=parseInt(aI.substr(aH+1,2),16);if(aJ<128){aF+=String.fromCharCode(aJ);aH+=3}else{if((aJ>191)&&(aJ<224)){aG=parseInt(aI.substr(aH+4,2),16);aF+=String.fromCharCode(((aJ&31)<<6)|(aG&63));aH+=6}else{aG=parseInt(aI.substr(aH+4,2),16);aE=parseInt(aI.substr(aH+7,2),16);aF+=String.fromCharCode(((aJ&15)<<12)|((aG&63)<<6)|(aE&63));aH+=9}}}return aF},ag=function(aE){return aE===undefined?"undefined":(aE===null?"null":Object.prototype.toString.call(aE).split(" ").pop().split("]").shift().toLowerCase())},ai=function(){this.errors=[]},af={};ai.prototype={scheme:undefined,authority:undefined,userinfo:undefined,host:undefined,port:undefined,path:undefined,query:undefined,fragment:undefined,reference:undefined,errors:undefined};af.SCHEMES={};af.parse=function(aI,aE){var aH,aG=new ai(),aF;aI=aI?aI.toString():"";aE=aE||{};if(aE.reference==="suffix"){aI=(aE.scheme?aE.scheme+":":"")+"//"+aI}aH=aI.match(v);if(aH){if(aH[1]){aH=aI.match(aq)}else{aH=aI.match(P)}}if(!aH){if(!aE.tolerant){aG.errors.push("URI is not strictly valid.")}aH=aI.match(q)}if(aH){if(C){aG.scheme=aH[1];aG.authority=aH[2];aG.userinfo=aH[3];aG.host=aH[4];aG.port=parseInt(aH[5],10);aG.path=aH[6]||"";aG.query=aH[7];aG.fragment=aH[8];if(isNaN(aG.port)){aG.port=aH[5]}}else{aG.scheme=aH[1]||undefined;aG.authority=(aI.indexOf("//")!==-1?aH[2]:undefined);aG.userinfo=(aI.indexOf("@")!==-1?aH[3]:undefined);aG.host=(aI.indexOf("//")!==-1?aH[4]:undefined);aG.port=parseInt(aH[5],10);aG.path=aH[6]||"";aG.query=(aI.indexOf("?")!==-1?aH[7]:undefined);aG.fragment=(aI.indexOf("#")!==-1?aH[8]:undefined);if(isNaN(aG.port)){aG.port=(aI.match(/\/\/.*\:(?:\/|\?|\#|$)/)?aH[4]:undefined)}}if(!aG.scheme&&!aG.authority&&!aG.path&&!aG.query){aG.reference="same-document"}else{if(!aG.scheme){aG.reference="relative"}else{if(!aG.fragment){aG.reference="absolute"}else{aG.reference="uri"}}}if(aE.reference&&aE.reference!=="suffix"&&aE.reference!==aG.reference){aG.errors.push("URI is not a "+aE.reference+" reference.")}aF=af.SCHEMES[aG.scheme||aE.scheme];if(aF&&aF.parse){aF.parse(aG,aE)}}else{aG.errors.push("URI can not be parsed.")}return aG};af._recomposeAuthority=function(aF){var aE=[];if(aF.userinfo!==undefined||aF.host!==undefined||typeof aF.port==="number"){if(aF.userinfo!==undefined){aE.push(aF.userinfo.toString().replace(ad,p));aE.push("@")}if(aF.host!==undefined){aE.push(aF.host.toString().toLowerCase().replace(aB,p))}if(typeof aF.port==="number"){aE.push(":");aE.push(aF.port.toString(10))}}return aE.length?aE.join(""):undefined};af.removeDotSegments=function(aF){var aE=[],aG;while(aF.length){if(aF.match(G)){aF=aF.replace(G,"")}else{if(aF.match(F)){aF=aF.replace(F,"/")}else{if(aF.match(D)){aF=aF.replace(D,"/");aE.pop()}else{if(aF==="."||aF===".."){aF=""}else{aG=aF.match(A)[0];aF=aF.slice(aG.length);aE.push(aG)}}}}}return aE.join("")};af.serialize=function(aI,aE){var aG=[],aF,aH;aE=aE||{};aF=af.SCHEMES[aI.scheme||aE.scheme];if(aF&&aF.serialize){aF.serialize(aI,aE)}if(aE.reference!=="suffix"&&aI.scheme){aG.push(aI.scheme.toString().toLowerCase().replace(ao,""));aG.push(":")}aI.authority=af._recomposeAuthority(aI);if(aI.authority!==undefined){if(aE.reference!=="suffix"){aG.push("//")}aG.push(aI.authority);if(aI.path&&aI.path.charAt(0)!=="/"){aG.push("/")}}if(aI.path){aH=af.removeDotSegments(aI.path.toString().replace(/%2E/ig,"."));if(aI.scheme){aH=aH.replace(U,p)}else{aH=aH.replace(ab,p)}if(aI.authority===undefined){aH=aH.replace(/^\/\//,"/%2F")}aG.push(aH)}if(aI.query){aG.push("?");aG.push(aI.query.toString().replace(E,p))}if(aI.fragment){aG.push("#");aG.push(aI.fragment.toString().replace(M,p))}return aG.join("").replace(V,ap).replace(/%[0-9A-Fa-f]{2}/g,function(aJ){return aJ.toUpperCase()})};af.resolveComponents=function(aG,aF,aE,aI){var aH=new ai();if(!aI){aG=af.parse(af.serialize(aG,aE),aE);aF=af.parse(af.serialize(aF,aE),aE)}aE=aE||{};if(!aE.tolerant&&aF.scheme){aH.scheme=aF.scheme;aH.authority=aF.authority;aH.userinfo=aF.userinfo;aH.host=aF.host;aH.port=aF.port;aH.path=af.removeDotSegments(aF.path);aH.query=aF.query}else{if(aF.authority!==undefined){aH.authority=aF.authority;aH.userinfo=aF.userinfo;aH.host=aF.host;aH.port=aF.port;aH.path=af.removeDotSegments(aF.path);aH.query=aF.query}else{if(!aF.path){aH.path=aG.path;if(aF.query!==undefined){aH.query=aF.query}else{aH.query=aG.query}}else{if(aF.path.charAt(0)==="/"){aH.path=af.removeDotSegments(aF.path)}else{if(aG.authority!==undefined&&!aG.path){aH.path="/"+aF.path}else{if(!aG.path){aH.path=aF.path}else{aH.path=aG.path.slice(0,aG.path.lastIndexOf("/")+1)+aF.path}}aH.path=af.removeDotSegments(aH.path)}aH.query=aF.query}aH.authority=aG.authority;aH.userinfo=aG.userinfo;aH.host=aG.host;aH.port=aG.port}aH.scheme=aG.scheme}aH.fragment=aF.fragment;return aH};af.resolve=function(aG,aF,aE){return af.serialize(af.resolveComponents(af.parse(aG,aE),af.parse(aF,aE),aE,true),aE)};af.normalize=function(aF,aE){if(typeof aF==="string"){return af.serialize(af.parse(aF,aE),aE)}else{if(ag(aF)==="object"){return af.parse(af.serialize(aF,aE),aE)}}return aF};af.equal=function(aG,aF,aE){if(typeof aG==="string"){aG=af.serialize(af.parse(aG,aE),aE)}else{if(ag(aG)==="object"){aG=af.serialize(aG,aE)}}if(typeof aF==="string"){aF=af.serialize(af.parse(aF,aE),aE)}else{if(ag(aF)==="object"){aF=af.serialize(aF,aE)}}return aG===aF};af.escapeComponent=function(aE){return aE&&aE.toString().replace(X,p)};af.unescapeComponent=function(aE){return aE&&aE.toString().replace(V,m)};a.Components=ai;a.URI=af;a.URI={SCHEMES:af.SCHEMES,parse:af.parse,removeDotSegments:af.removeDotSegments,serialize:af.serialize,resolveComponents:af.resolveComponents,resolve:af.resolve,normalize:af.normalize,equal:af.equal,escapeComponent:af.escapeComponent,unescapeComponent:af.unescapeComponent}}());var a=a||this,b=b||function(){return a};(function(){var m=b("./uri/uri").URI,h={},D="0123456789abcdef".split(""),o,s,C,l;function g(E){return E===undefined?"undefined":(E===null?"null":Object.prototype.toString.call(E).split(" ").pop().split("]").shift().toLowerCase())}function p(){}function w(E){p.prototype=E||{};return new p()}function f(I,H,G){var E={},F;for(F in I){if(I[F]!==h[F]){E[F]=H.call(G,I[F],F,I)}}return E}o=function(F,I,H){var E=0,J=F.length,G=new Array(J);for(;E<J;++E){G[E]=I.call(H,F[E],E,F)}return G};if(Array.prototype.map){o=function(E,G,F){return Array.prototype.map.call(E,G,F)}}s=function(F,I,H){var E=0,J=F.length,G=[];for(;E<J;++E){if(I.call(H,F[E],E,F)){G[G.length]=F[E]}}return G};if(Array.prototype.filter){s=function(E,G,F){return Array.prototype.filter.call(E,G,F)}}C=function(F,G){var E=0,H=F.length;for(;E<H;++E){if(F[E]===G){return E}}return -1};if(Array.prototype.indexOf){C=function(E,F){return Array.prototype.indexOf.call(E,F)}}function y(E){return E!==undefined&&E!==null?(E instanceof Array&&!E.callee?E:(typeof E.length!=="number"||E.split||E.setInterval||E.call?[E]:Array.prototype.slice.call(E))):[]}function r(G){var E=[],F;switch(g(G)){case"object":for(F in G){if(G[F]!==h[F]){E[E.length]=F}}break;case"array":for(F=G.length-1;F>=0;--F){E[F]=F}break}return E}function i(E,F){if(C(E,F)===-1){E.push(F)}return E}function t(E,G){var F=C(E,G);if(F>-1){E.splice(F,1)}return E}function x(){return[D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],"-",D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],"-4",D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],"-",D[(Math.floor(Math.random()*16)&3)|8],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],"-",D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)],D[Math.floor(Math.random()*16)]].join("")}function A(E){return encodeURIComponent(E).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")}function e(E){if(typeof E==="string"&&E.indexOf("#")===-1){E+="#"}return E}function u(){this.errors=[];this.validated={}}u.prototype.addError=function(F,I,E,H,G){this.errors.push({uri:F instanceof z?F.getURI():F,schemaUri:I instanceof z?I.getURI():I,attribute:E,message:H,details:G})};u.prototype.registerValidation=function(F,E){if(!this.validated[F]){this.validated[F]=[E]}else{this.validated[F].push(E)}};u.prototype.isValidatedBy=function(F,E){return !!this.validated[F]&&C(this.validated[F],E)!==-1};function z(G,F,H,E){if(F instanceof z){if(typeof E!=="string"){E=F._fd}if(typeof H!=="string"){H=F._uri}F=F._value}if(typeof H!=="string"){H="urn:uuid:"+x()+"#"}else{if(H.indexOf(":")===-1){H=e(m.resolve("urn:uuid:"+x()+"#",H))}}this._env=G;this._value=F;this._uri=H;this._fd=E||this._env._options.defaultFragmentDelimiter}z.prototype.getEnvironment=function(){return this._env};z.prototype.getType=function(){return g(this._value)};z.prototype.getValue=function(){return this._value};z.prototype.getURI=function(){return this._uri};z.prototype.resolveURI=function(E){return e(m.resolve(this._uri,E))};z.prototype.getPropertyNames=function(){return r(this._value)};z.prototype.getProperty=function(E){var F=this._value?this._value[E]:undefined;if(F instanceof z){return F}return new z(this._env,F,this._uri+this._fd+A(E),this._fd)};z.prototype.getProperties=function(){var F=g(this._value),E=this;if(F==="object"){return f(this._value,function(H,G){if(H instanceof z){return H}return new z(E._env,H,E._uri+E._fd+A(G),E._fd)})}else{if(F==="array"){return o(this._value,function(H,G){if(H instanceof z){return H}return new z(E._env,H,E._uri+E._fd+A(G),E._fd)})}}};z.prototype.getValueOfProperty=function(E){if(this._value){if(this._value[E] instanceof z){return this._value[E]._value}return this._value[E]}};z.prototype.equals=function(E){if(E instanceof z){return this._value===E._value}return this._value===E};function B(H,F){var G,E;if(H instanceof z){H=H.getValue()}switch(g(H)){case"object":if(F){G={};for(E in H){if(H[E]!==h[E]){G[E]=B(H[E],F)}}return G}else{return w(H)}break;case"array":if(F){G=new Array(H.length);E=H.length;while(--E>=0){G[E]=B(H[E],F)}return G}else{return Array.prototype.slice.call(H)}break;default:return H}}function v(G,F,I,H){var E;z.call(this,G,F,I);if(H===true){this._schema=this}else{if(F instanceof v&&!(H instanceof v)){this._schema=F._schema}else{this._schema=H instanceof v?H:this._env.getDefaultSchema()||v.createEmptySchema(this._env)}}E=this._schema.getValueOfProperty("fragmentResolution");if(E==="dot-delimited"){this._fd="."}else{if(E==="slash-delimited"){this._fd="/"}}}v.prototype=w(z.prototype);v.createEmptySchema=function(E){var F=w(v.prototype);z.call(F,E,{},undefined,undefined);F._schema=F;return F};v.prototype.getSchema=function(){return this._schema};v.prototype.getAttribute=function(H,G){var F,J,I,E;if(!G&&this._attributes&&this._attributes.hasOwnProperty(H)){return this._attributes[H]}F=this._schema.getProperty("properties").getProperty(H);J=F.getValueOfProperty("parser");I=this.getProperty(H);if(typeof J==="function"){E=J(I,F,G);if(!G&&this._attributes){this._attributes[H]=E}return E}return I.getValue()};v.prototype.getAttributes=function(){var G,H,F,E,I;if(!this._attributes&&this.getType()==="object"){G=this.getProperties();H=this._schema.getProperty("properties");this._attributes={};for(F in G){if(G[F]!==h[F]){E=H&&H.getProperty(F);I=E&&E.getValueOfProperty("parser");if(typeof I==="function"){this._attributes[F]=I(G[F],E)}else{this._attributes[F]=G[F].getValue()}}}}return B(this._attributes,false)};v.prototype.getLink=function(F,E){var G=this.getAttribute("links",[F,E]);if(G&&G.length&&G[G.length-1]){return G[G.length-1]}};v.prototype.validate=function(E,F,I,J,G){var H=this._schema.getValueOfProperty("validator");if(!(E instanceof z)){E=this.getEnvironment().createInstance(E)}if(!(F instanceof u)){F=new u()}if(typeof H==="function"&&!F.isValidatedBy(E.getURI(),this.getURI())){F.registerValidation(E.getURI(),this.getURI());H(E,this,this._schema,F,I,J,G)}return F};function n(I,F,K){var H=g(I),G=g(F),J,E;if(G==="undefined"){return B(I,true)}else{if(H==="undefined"||G!==H){return B(F,true)}else{if(G==="object"){if(I instanceof v){I=I.getAttributes()}if(F instanceof v){F=F.getAttributes();if(F["extends"]&&K&&F["extends"] instanceof v){F["extends"]=[F["extends"]]}}J=B(I,true);for(E in F){if(F[E]!==h[E]){J[E]=n(I[E],F[E],K)}}return J}else{return B(F,true)}}}}function q(){this._id=x();this._schemas={};this._options={}}q.prototype.clone=function(){var E=new q();E._schemas=w(this._schemas);E._options=w(this._options);return E};q.prototype.createInstance=function(G,F){var E;F=e(F);if(G instanceof z&&(!F||G.getURI()===F)){return G}E=new z(this,G,F);return E};q.prototype.createSchema=function(I,H,G){var E,F;G=e(G);if(I instanceof v&&(!G||I._uri===G)&&(!H||I._schema.equals(H))){return I}E=new v(this,I,G,H);F=E.getSchema().getValueOfProperty("initializer");if(typeof F==="function"){E=F(E)}this._schemas[E._uri]=E;this._schemas[G]=E;E.getAttributes();return E};q.prototype.createEmptySchema=function(){var E=v.createEmptySchema(this);this._schemas[E._uri]=E;return E};q.prototype.findSchema=function(E){return this._schemas[e(E)]};q.prototype.setOption=function(E,F){this._options[E]=F};q.prototype.getOption=function(E){return this._options[E]};q.prototype.setDefaultFragmentDelimiter=function(E){if(typeof E==="string"&&E.length>0){this._options.defaultFragmentDelimiter=E}};q.prototype.getDefaultFragmentDelimiter=function(){return this._options.defaultFragmentDelimiter};q.prototype.setDefaultSchemaURI=function(E){if(typeof E==="string"){this._options.defaultSchemaURI=e(E)}};q.prototype.getDefaultSchema=function(){return this.findSchema(this._options.defaultSchemaURI)};q.prototype.validate=function(K,J){var E,H,G,F=new u();try{E=this.createInstance(K);F.instance=E}catch(I){F.addError(I.uri,I.schemaUri,I.attribute,I.message,I.details)}try{H=this.createSchema(J);F.schema=H;G=H.getSchema();F.schemaSchema=G}catch(I){F.addError(I.uri,I.schemaUri,I.attribute,I.message,I.details)}if(G){G.validate(H,F)}if(F.errors.length){return F}return H.validate(E,F)};q.prototype._checkForInvalidInstances=function(L,G){var O=[],J=[[G,this._schemas[G]]],E=0,N,F,M,H,I,K;while(E++<L&&J.length){N=J.shift();F=N[0];M=N[1];if(M instanceof v){if(this._schemas[M._uri]!==M){O.push("Instance "+F+" does not match "+M._uri)}else{I=M.getAttributes();for(K in I){if(I[K]!==h[K]){J.push([F+"/"+A(K),I[K]])}}}}else{if(g(M)==="object"){I=M;for(K in I){if(I.hasOwnProperty(K)){J.push([F+"/"+A(K),I[K]])}}}else{if(g(M)==="array"){I=M;for(K=0;K<I.length;++K){J.push([F+"/"+A(K),I[K]])}}}}}return O.length?O:E};l={_environments:{},_defaultEnvironmentID:"",isJSONInstance:function(E){return E instanceof z},isJSONSchema:function(E){return E instanceof v},createEnvironment:function(E){E=E||this._defaultEnvironmentID;if(!this._environments[E]){throw new Error("Unknown Environment ID")}return this._environments[E].clone()},Environment:q,registerEnvironment:function(F,E){F=F||(E||0)._id;if(F&&!this._environments[F]&&E instanceof q){E._id=F;this._environments[F]=E}},setDefaultEnvironmentID:function(E){if(typeof E==="string"){if(!this._environments[E]){throw new Error("Unknown Environment ID")}this._defaultEnvironmentID=E}},getDefaultEnvironmentID:function(){return this._defaultEnvironmentID},typeOf:g,createObject:w,mapObject:f,mapArray:o,filterArray:s,searchArray:C,toArray:y,keys:r,pushUnique:i,popFirst:t,clone:B,randomUUID:x,escapeURIComponent:A,formatURI:e,inherits:n};this.JSV=l;a.JSV=l;b("./environments")}());(function(){var q={},s=b("./jsv").JSV,n,J,z,o,D,p,i,g,C,r,E,t,h,f,B,u,G,v,e,I,y,w,l,A,H,F,x;n=function n(L,O,K,N,M){Error.call(this,N);this.uri=L.getURI();this.schemaUri=O.getURI();this.attribute=K;this.message=N;this.description=N;this.details=M};n.prototype=new Error();n.prototype.constructor=n;n.prototype.name="InitializationError";J={string:function(K,L){return K.getType()==="string"},number:function(K,L){return K.getType()==="number"},integer:function(K,L){return K.getType()==="number"&&K.getValue()%1===0},"boolean":function(K,L){return K.getType()==="boolean"},object:function(K,L){return K.getType()==="object"},array:function(K,L){return K.getType()==="array"},"null":function(K,L){return K.getType()==="null"},any:function(K,L){return true}};z=new s.Environment();z.setOption("strict",false);z.setOption("validateReferences",false);o={"$schema":"http://json-schema.org/draft-00/hyper-schema#",id:"http://json-schema.org/draft-00/schema#",type:"object",properties:{type:{type:["string","array"],items:{type:["string",{"$ref":"#"}]},optional:true,uniqueItems:true,"default":"any",parser:function(K,L){var M;if(K.getType()==="string"){return K.getValue()}else{if(K.getType()==="object"){return K.getEnvironment().createSchema(K,L.getEnvironment().findSchema(L.resolveURI("#")))}else{if(K.getType()==="array"){M=L.getValueOfProperty("parser");return s.mapArray(K.getProperties(),function(N){return M(N,L)})}}}return"any"},validator:function(U,N,V,P,T,W,K){var L=s.toArray(N.getAttribute("type")),S,Q,R,O,M;if(U.getType()!=="undefined"&&L&&L.length){M=V.getValueOfProperty("typeValidators")||{};for(S=0,Q=L.length;S<Q;++S){R=L[S];if(s.isJSONSchema(R)){O=s.createObject(P);O.errors=[];O.validated=s.clone(P.validated);if(R.validate(U,O,T,W,K).errors.length===0){return true}}else{if(M[R]!==q[R]&&typeof M[R]==="function"){if(M[R](U,P)){return true}}else{return true}}}P.addError(U,N,"type","Instance is not a required type",L);return false}return true},typeValidators:J},properties:{type:"object",additionalProperties:{"$ref":"#"},optional:true,"default":{},parser:function(L,M,K){var N=L.getEnvironment(),O=M.getEnvironment();if(L.getType()==="object"){if(K){return N.createSchema(L.getProperty(K),O.findSchema(M.resolveURI("#")))}else{return s.mapObject(L.getProperties(),function(P){return N.createSchema(P,O.findSchema(M.resolveURI("#")))})}}return{}},validator:function(Q,M,R,N,O,S,K){var L,P;if(Q.getType()==="object"){L=M.getAttribute("properties");for(P in L){if(L[P]!==q[P]&&L[P]){L[P].validate(Q.getProperty(P),N,Q,M,P)}}}}},items:{type:[{"$ref":"#"},"array"],items:{"$ref":"#"},optional:true,"default":{},parser:function(K,L){if(K.getType()==="object"){return K.getEnvironment().createSchema(K,L.getEnvironment().findSchema(L.resolveURI("#")))}else{if(K.getType()==="array"){return s.mapArray(K.getProperties(),function(M){return M.getEnvironment().createSchema(M,L.getEnvironment().findSchema(L.resolveURI("#")))})}}return K.getEnvironment().createEmptySchema()},validator:function(U,L,V,M,T,W,K){var Q,P,S,N,R,O;if(U.getType()==="array"){Q=U.getProperties();P=L.getAttribute("items");O=L.getAttribute("additionalProperties");if(s.typeOf(P)==="array"){for(S=0,N=Q.length;S<N;++S){R=P[S]||O;if(R!==false){R.validate(Q[S],M,U,L,S)}else{M.addError(U,L,"additionalProperties","Additional items are not allowed",R)}}}else{R=P||O;for(S=0,N=Q.length;S<N;++S){R.validate(Q[S],M,U,L,S)}}}}},optional:{type:"boolean",optional:true,"default":false,parser:function(K,L){return !!K.getValue()},validator:function(K,P,M,L,O,Q,N){if(K.getType()==="undefined"&&!P.getAttribute("optional")){L.addError(K,P,"optional","Property is required",false)}},validationRequired:true},additionalProperties:{type:[{"$ref":"#"},"boolean"],optional:true,"default":{},parser:function(K,L){if(K.getType()==="object"){return K.getEnvironment().createSchema(K,L.getEnvironment().findSchema(L.resolveURI("#")))}else{if(K.getType()==="boolean"&&K.getValue()===false){return false}}return K.getEnvironment().createEmptySchema()},validator:function(S,M,T,N,Q,U,K){var O,L,P,R;if(S.getType()==="object"){O=M.getAttribute("additionalProperties");L=M.getAttribute("properties")||{};P=S.getProperties();for(R in P){if(P[R]!==q[R]&&P[R]&&L[R]===q[R]){if(s.isJSONSchema(O)){O.validate(P[R],N,S,M,R)}else{if(O===false){N.addError(S,M,"additionalProperties","Additional properties are not allowed",O)}}}}}}},requires:{type:["string",{"$ref":"#"}],optional:true,parser:function(K,L){if(K.getType()==="string"){return K.getValue()}else{if(K.getType()==="object"){return K.getEnvironment().createSchema(K,L.getEnvironment().findSchema(L.resolveURI("#")))}}},validator:function(K,Q,M,L,P,R,N){var O;if(K.getType()!=="undefined"&&P&&P.getType()!=="undefined"){O=Q.getAttribute("requires");if(typeof O==="string"){if(P.getProperty(O).getType()==="undefined"){L.addError(K,Q,"requires",'Property requires sibling property "'+O+'"',O)}}else{if(s.isJSONSchema(O)){O.validate(P,L)}}}}},minimum:{type:"number",optional:true,parser:function(K,L){if(K.getType()==="number"){return K.getValue()}},validator:function(Q,L,R,M,O,S,K){var N,P;if(Q.getType()==="number"){N=L.getAttribute("minimum");P=L.getAttribute("minimumCanEqual");if(typeof N==="number"&&(Q.getValue()<N||(P===false&&Q.getValue()===N))){M.addError(Q,L,"minimum","Number is less then the required minimum value",N)}}}},maximum:{type:"number",optional:true,parser:function(K,L){if(K.getType()==="number"){return K.getValue()}},validator:function(Q,M,R,O,P,S,K){var L,N;if(Q.getType()==="number"){L=M.getAttribute("maximum");N=M.getAttribute("maximumCanEqual");if(typeof L==="number"&&(Q.getValue()>L||(N===false&&Q.getValue()===L))){O.addError(Q,M,"maximum","Number is greater then the required maximum value",L)}}}},minimumCanEqual:{type:"boolean",optional:true,requires:"minimum","default":true,parser:function(K,L){if(K.getType()==="boolean"){return K.getValue()}return true}},maximumCanEqual:{type:"boolean",optional:true,requires:"maximum","default":true,parser:function(K,L){if(K.getType()==="boolean"){return K.getValue()}return true}},minItems:{type:"integer",optional:true,minimum:0,"default":0,parser:function(K,L){if(K.getType()==="number"){return K.getValue()}return 0},validator:function(K,Q,N,L,P,R,O){var M;if(K.getType()==="array"){M=Q.getAttribute("minItems");if(typeof M==="number"&&K.getProperties().length<M){L.addError(K,Q,"minItems","The number of items is less then the required minimum",M)}}}},maxItems:{type:"integer",optional:true,minimum:0,parser:function(K,L){if(K.getType()==="number"){return K.getValue()}},validator:function(K,Q,M,L,P,R,O){var N;if(K.getType()==="array"){N=Q.getAttribute("maxItems");if(typeof N==="number"&&K.getProperties().length>N){L.addError(K,Q,"maxItems","The number of items is greater then the required maximum",N)}}}},pattern:{type:"string",optional:true,format:"regex",parser:function(K,L){if(K.getType()==="string"){try{return new RegExp(K.getValue())}catch(M){return M}}},validator:function(Q,L,R,M,P,S,K){var O;try{O=L.getAttribute("pattern");if(O instanceof Error){M.addError(L,R,"pattern","Invalid pattern",L.getValueOfProperty("pattern"))}else{if(Q.getType()==="string"&&O&&!O.test(Q.getValue())){M.addError(Q,L,"pattern","String does not match pattern",O.toString())}}}catch(N){M.addError(L,R,"pattern","Invalid pattern",L.getValueOfProperty("pattern"))}}},minLength:{type:"integer",optional:true,minimum:0,"default":0,parser:function(K,L){if(K.getType()==="number"){return K.getValue()}return 0},validator:function(K,Q,N,L,P,R,O){var M;if(K.getType()==="string"){M=Q.getAttribute("minLength");if(typeof M==="number"&&K.getValue().length<M){L.addError(K,Q,"minLength","String is less then the required minimum length",M)}}}},maxLength:{type:"integer",optional:true,parser:function(K,L){if(K.getType()==="number"){return K.getValue()}},validator:function(K,Q,N,M,P,R,O){var L;if(K.getType()==="string"){L=Q.getAttribute("maxLength");if(typeof L==="number"&&K.getValue().length>L){M.addError(K,Q,"maxLength","String is greater then the required maximum length",L)}}}},"enum":{type:"array",optional:true,minItems:1,uniqueItems:true,parser:function(K,L){if(K.getType()==="array"){return K.getValue()}},validator:function(R,M,S,N,Q,T,L){var K,P,O;if(R.getType()!=="undefined"){K=M.getAttribute("enum");if(K){for(P=0,O=K.length;P<O;++P){if(R.equals(K[P])){return true}}N.addError(R,M,"enum","Instance is not one of the possible values",K)}}}},title:{type:"string",optional:true},description:{type:"string",optional:true},format:{type:"string",optional:true,parser:function(K,L){if(K.getType()==="string"){return K.getValue()}},validator:function(Q,L,R,M,O,S,K){var N,P;if(Q.getType()==="string"){N=L.getAttribute("format");P=R.getValueOfProperty("formatValidators");if(typeof N==="string"&&P[N]!==q[N]&&typeof P[N]==="function"&&!P[N].call(this,Q,M)){M.addError(Q,L,"format","String is not in the required format",N)}}},formatValidators:{}},contentEncoding:{type:"string",optional:true},"default":{type:"any",optional:true},maxDecimal:{type:"integer",optional:true,minimum:0,parser:function(K,L){if(K.getType()==="number"){return K.getValue()}},validator:function(Q,M,R,O,P,S,K){var N,L;if(Q.getType()==="number"){N=M.getAttribute("maxDecimal");if(typeof N==="number"){L=Q.getValue().toString(10).split(".")[1];if(L&&L.length>N){O.addError(Q,M,"maxDecimal","The number of decimal places is greater then the allowed maximum",N)}}}}},disallow:{type:["string","array"],items:{type:"string"},optional:true,uniqueItems:true,parser:function(K,L){if(K.getType()==="string"||K.getType()==="array"){return K.getValue()}},validator:function(U,M,V,O,S,W,K){var Q=s.toArray(M.getAttribute("disallow")),R,P,T,L,N;if(U.getType()!=="undefined"&&Q&&Q.length){L=V.getValueOfProperty("typeValidators")||{};for(R=0,P=Q.length;R<P;++R){T=Q[R];if(s.isJSONSchema(T)){N=s.createObject(O);N.errors=[];N.validated=s.clone(O.validated);if(T.validate(U,N,S,W,K).errors.length===0){O.addError(U,M,"disallow","Instance is a disallowed type",Q);return false}}else{if(L[T]!==q[T]&&typeof L[T]==="function"){if(L[T](U,O)){O.addError(U,M,"disallow","Instance is a disallowed type",Q);return false}}}}return true}return true},typeValidators:J},"extends":{type:[{"$ref":"#"},"array"],items:{"$ref":"#"},optional:true,"default":{},parser:function(K,L){if(K.getType()==="object"){return K.getEnvironment().createSchema(K,L.getEnvironment().findSchema(L.resolveURI("#")))}else{if(K.getType()==="array"){return s.mapArray(K.getProperties(),function(M){return M.getEnvironment().createSchema(M,L.getEnvironment().findSchema(L.resolveURI("#")))})}}},validator:function(R,L,S,M,Q,T,K){var O=L.getAttribute("extends"),P,N;if(O){if(s.isJSONSchema(O)){O.validate(R,M,Q,T,K)}else{if(s.typeOf(O)==="array"){for(P=0,N=O.length;P<N;++P){O[P].validate(R,M,Q,T,K)}}}}}}},optional:true,"default":{},fragmentResolution:"dot-delimited",parser:function(K,L){if(K.getType()==="object"){return K.getEnvironment().createSchema(K,L)}},validator:function(T,M,U,N,S,V,L){var W=M.getPropertyNames(),R,O,P=U.getAttribute("properties"),Q=T.getEnvironment().getOption("strict"),K;for(R in P){if(P[R]!==q[R]){if(P[R].getValueOfProperty("validationRequired")){s.pushUnique(W,R)}if(Q&&P[R].getValueOfProperty("deprecated")){s.popFirst(W,R)}}}for(R=0,O=W.length;R<O;++R){if(P[W[R]]!==q[W[R]]){K=P[W[R]].getValueOfProperty("validator");if(typeof K==="function"){K(T,M,P[W[R]],N,S,V,L)}}}}};D={"$schema":"http://json-schema.org/draft-00/hyper-schema#",id:"http://json-schema.org/draft-00/hyper-schema#",properties:{links:{type:"array",items:{"$ref":"links#"},optional:true,parser:function(N,Q,M){var P,L=Q.getValueOfProperty("items")["$ref"],R=Q.getEnvironment().findSchema(L),K=R&&R.getValueOfProperty("parser"),O;M=s.toArray(M);if(typeof K==="function"){P=s.mapArray(N.getProperties(),function(S){return K(S,R)})}else{P=s.toArray(N.getValue())}if(M[0]){P=s.filterArray(P,function(S){return S.rel===M[0]})}if(M[1]){O=Q.getValueOfProperty("selfReferenceVariable");P=s.mapArray(P,function(U){var S=M[1],T=U.href;T=T.replace(/\{(.+)\}/g,function(Z,Y,X,V){var W;if(Y===O){W=S.getValue()}else{W=S.getValueOfProperty(Y)}return W!==undefined?String(W):""});return T?s.formatURI(S.resolveURI(T)):T})}return P},selfReferenceVariable:"-this"},fragmentResolution:{type:"string",optional:true,"default":"dot-delimited"},root:{type:"boolean",optional:true,"default":false},readonly:{type:"boolean",optional:true,"default":false},pathStart:{type:"string",optional:true,format:"uri",validator:function(K,P,M,L,O,R,N){var Q;if(K.getType()!=="undefined"){Q=P.getAttribute("pathStart");if(typeof Q==="string"){if(K.getURI().indexOf(Q)!==0){L.addError(K,P,"pathStart","Instance's URI does not start with "+Q,Q)}}}}},mediaType:{type:"string",optional:true,format:"media-type"},alternate:{type:"array",items:{"$ref":"#"},optional:true}},links:[{href:"{$ref}",rel:"full"},{href:"{$schema}",rel:"describedby"},{href:"{id}",rel:"self"}],initializer:function(L){var M,N,K;M=L._schema.getLink("describedby",L);if(M&&L._schema._uri!==M){if(L._env._schemas[M]){L._schema=L._env._schemas[M];initializer=L._schema.getValueOfProperty("initializer");if(typeof initializer==="function"){return initializer(L)}else{return L}}else{if(L._env._options.validateReferences){throw new n(L,L._schema,"{link:describedby}","Unknown schema reference",M)}}}M=L._schema.getLink("full",L);if(M&&L._uri!==M){if(L._env._schemas[M]){L=L._env._schemas[M];return L}else{if(L._env._options.validateReferences){throw new n(L,L._schema,"{link:full}","Unknown schema reference",M)}}}N=L.getAttribute("extends");if(s.isJSONSchema(N)){K=s.inherits(N,L,true);L=L._env.createSchema(K,L._schema,L._uri)}M=L._schema.getLink("self",L);if(s.typeOf(M)==="string"){L._uri=s.formatURI(M)}return L}};p={"$schema":"http://json-schema.org/draft-00/hyper-schema#",id:"http://json-schema.org/draft-00/links#",type:"object",properties:{href:{type:"string"},rel:{type:"string"},method:{type:"string","default":"GET",optional:true},enctype:{type:"string",requires:"method",optional:true},properties:{type:"object",additionalProperties:{"$ref":"hyper-schema#"},optional:true,parser:function(M,N,L){var O=M.getEnvironment(),P=N.getEnvironment(),K=N.getValueOfProperty("additionalProperties")["$ref"];if(M.getType()==="object"){if(L){return O.createSchema(M.getProperty(L),P.findSchema(N.resolveURI(K)))}else{return s.mapObject(M.getProperties(),function(Q){return O.createSchema(Q,P.findSchema(N.resolveURI(K)))})}}}}},parser:function(K,M){var L=M.getProperty("properties");if(K.getType()==="object"){return s.mapObject(K.getProperties(),function(P,O){var N=L.getProperty(O),Q=N&&N.getValueOfProperty("parser");if(typeof Q==="function"){return Q(P,N)}return P.getValue()})}return K.getValue()}};z.setOption("defaultFragmentDelimiter",".");z.setOption("defaultSchemaURI","http://json-schema.org/draft-00/schema#");i=z.createSchema(o,true,"http://json-schema.org/draft-00/schema#");g=z.createSchema(s.inherits(i,z.createSchema(D,true,"http://json-schema.org/draft-00/hyper-schema#"),true),true,"http://json-schema.org/draft-00/hyper-schema#");z.setOption("defaultSchemaURI","http://json-schema.org/draft-00/hyper-schema#");C=z.createSchema(p,g,"http://json-schema.org/draft-00/links#");i=z.createSchema(i.getValue(),g,"http://json-schema.org/draft-00/schema#");g=z.createSchema(g.getValue(),g,"http://json-schema.org/draft-00/hyper-schema#");C=z.createSchema(C.getValue(),g,"http://json-schema.org/draft-00/links#");r=s.inherits(o,{"$schema":"http://json-schema.org/draft-01/hyper-schema#",id:"http://json-schema.org/draft-01/schema#"});E=s.inherits(D,{"$schema":"http://json-schema.org/draft-01/hyper-schema#",id:"http://json-schema.org/draft-01/hyper-schema#"});t=s.inherits(p,{"$schema":"http://json-schema.org/draft-01/hyper-schema#",id:"http://json-schema.org/draft-01/links#"});z.setOption("defaultSchemaURI","http://json-schema.org/draft-01/schema#");h=z.createSchema(r,true,"http://json-schema.org/draft-01/schema#");f=z.createSchema(s.inherits(h,z.createSchema(E,true,"http://json-schema.org/draft-01/hyper-schema#"),true),true,"http://json-schema.org/draft-01/hyper-schema#");z.setOption("defaultSchemaURI","http://json-schema.org/draft-01/hyper-schema#");B=z.createSchema(t,f,"http://json-schema.org/draft-01/links#");h=z.createSchema(h.getValue(),f,"http://json-schema.org/draft-01/schema#");f=z.createSchema(f.getValue(),f,"http://json-schema.org/draft-01/hyper-schema#");B=z.createSchema(B.getValue(),f,"http://json-schema.org/draft-01/links#");u=s.inherits(r,{"$schema":"http://json-schema.org/draft-02/hyper-schema#",id:"http://json-schema.org/draft-02/schema#",properties:{uniqueItems:{type:"boolean",optional:true,"default":false,parser:function(K,L){return !!K.getValue()},validator:function(T,M,U,N,S,V,K){var R,Q,O,P,L;if(T.getType()==="array"&&M.getAttribute("uniqueItems")){R=T.getProperties();for(Q=0,O=R.length-1;Q<O;++Q){for(P=Q+1,L=R.length;P<L;++P){if(R[Q].equals(R[P])){N.addError(T,M,"uniqueItems","Array can only contain unique items",{x:Q,y:P})}}}}}},maxDecimal:{deprecated:true},divisibleBy:{type:"number",minimum:0,minimumCanEqual:false,optional:true,parser:function(K,L){if(K.getType()==="number"){return K.getValue()}},validator:function(K,P,M,L,O,R,N){var Q;if(K.getType()==="number"){Q=P.getAttribute("divisibleBy");if(Q===0){L.addError(K,P,"divisibleBy","Nothing is divisible by 0",Q)}else{if(Q!==1&&((K.getValue()/Q)%1)!==0){L.addError(K,P,"divisibleBy","Number is not divisible by "+Q,Q)}}}}}},fragmentResolution:"slash-delimited"});G=s.inherits(E,{id:"http://json-schema.org/draft-02/hyper-schema#",properties:{fragmentResolution:{"default":"slash-delimited"}}});v=s.inherits(t,{"$schema":"http://json-schema.org/draft-02/hyper-schema#",id:"http://json-schema.org/draft-02/links#",properties:{targetSchema:{"$ref":"hyper-schema#",parser:f.getAttribute("parser")}}});z.setOption("defaultFragmentDelimiter","/");z.setOption("defaultSchemaURI","http://json-schema.org/draft-02/schema#");e=z.createSchema(u,true,"http://json-schema.org/draft-02/schema#");I=z.createSchema(s.inherits(e,z.createSchema(G,true,"http://json-schema.org/draft-02/hyper-schema#"),true),true,"http://json-schema.org/draft-02/hyper-schema#");z.setOption("defaultSchemaURI","http://json-schema.org/draft-02/hyper-schema#");y=z.createSchema(v,I,"http://json-schema.org/draft-02/links#");e=z.createSchema(e.getValue(),I,"http://json-schema.org/draft-02/schema#");I=z.createSchema(I.getValue(),I,"http://json-schema.org/draft-02/hyper-schema#");y=z.createSchema(y.getValue(),I,"http://json-schema.org/draft-02/links#");function m(T,K,L,U){var M={},R,P,Q,O,S;if(T.getType()==="object"){R=K.getAttribute("patternProperties");O=T.getProperties();for(P in R){if(R[P]!==q[P]){Q=null;try{Q=new RegExp(P)}catch(N){if(L){L.addError(K,U,"patternProperties","Invalid pattern",P)}}if(Q){for(S in O){if(O[S]!==q[S]&&Q.test(S)){M[S]=M[S]?s.pushUnique(M[S],R[P]):[R[P]]}}}}}}return M}w=s.inherits(u,{"$schema":"http://json-schema.org/draft-03/schema#",id:"http://json-schema.org/draft-03/schema#",properties:{patternProperties:{type:"object",additionalProperties:{"$ref":"#"},"default":{},parser:e.getValueOfProperty("properties")["properties"]["parser"],validator:function(R,L,S,M,P,T,K){var N,Q,O;if(R.getType()==="object"){N=m(R,L,M,S);for(Q in N){if(N[Q]!==q[Q]){O=N[Q].length;while(O--){N[Q][O].validate(R.getProperty(Q),M,R,L,Q)}}}}}},additionalProperties:{validator:function(T,M,U,N,R,V,K){var P,L,Q,O,S;if(T.getType()==="object"){P=M.getAttribute("additionalProperties");L=M.getAttribute("properties")||{};Q=T.getProperties();O=m(T,M);for(S in Q){if(Q[S]!==q[S]&&Q[S]&&L[S]===q[S]&&O[S]===q[S]){if(s.isJSONSchema(P)){P.validate(Q[S],N,T,M,S)}else{if(P===false){N.addError(T,M,"additionalProperties","Additional properties are not allowed",P)}}}}}}},items:{validator:function(U,M,V,N,T,W,L){var Q,P,S,O,R,K;if(U.getType()==="array"){Q=U.getProperties();P=M.getAttribute("items");K=M.getAttribute("additionalItems");if(s.typeOf(P)==="array"){for(S=0,O=Q.length;S<O;++S){R=P[S]||K;if(R!==false){R.validate(Q[S],N,U,M,S)}else{N.addError(U,M,"additionalItems","Additional items are not allowed",R)}}}else{R=P||K;for(S=0,O=Q.length;S<O;++S){R.validate(Q[S],N,U,M,S)}}}}},additionalItems:{type:[{"$ref":"#"},"boolean"],"default":{},parser:e.getValueOfProperty("properties")["additionalProperties"]["parser"],validator:function(S,M,T,N,R,U,L){var K,P,Q,O;if(S.getType()==="array"&&M.getProperty("items").getType()==="undefined"){K=M.getAttribute("additionalItems");P=S.getProperties();if(K!==false){for(Q=0,O=P.length;Q<O;++Q){K.validate(P[Q],N,S,M,Q)}}else{if(P.length){N.addError(S,M,"additionalItems","Additional items are not allowed",K)}}}}},optional:{validationRequired:false,deprecated:true},required:{type:"boolean","default":false,parser:function(K,L){return !!K.getValue()},validator:function(K,P,M,L,O,Q,N){if(K.getType()==="undefined"&&P.getAttribute("required")){L.addError(K,P,"required","Property is required",true)}}},requires:{deprecated:true},dependencies:{type:"object",additionalProperties:{type:["string","array",{"$ref":"#"}],items:{type:"string"}},"default":{},parser:function(L,M,K){function N(P){var O=P.getType();if(O==="string"||O==="array"){return P.getValue()}else{if(O==="object"){return P.getEnvironment().createSchema(P,M.getEnvironment().findSchema(M.resolveURI("#")))}}}if(L.getType()==="object"){if(K){return N(L.getProperty(K))}else{return s.mapObject(L.getProperties(),N)}}return{}},validator:function(U,M,V,N,S,W,K){var P,T,L,Q,R,O;if(U.getType()==="object"){P=M.getAttribute("dependencies");for(T in P){if(P[T]!==q[T]&&U.getProperty(T).getType()!=="undefined"){L=P[T];Q=s.typeOf(L);if(Q==="string"){if(U.getProperty(L).getType()==="undefined"){N.addError(U,M,"dependencies",'Property "'+T+'" requires sibling property "'+L+'"',P)}}else{if(Q==="array"){for(R=0,O=L.length;R<O;++R){if(U.getProperty(L[R]).getType()==="undefined"){N.addError(U,M,"dependencies",'Property "'+T+'" requires sibling property "'+L[R]+'"',P)}}}else{if(s.isJSONSchema(L)){L.validate(U,N)}}}}}}}},minimumCanEqual:{deprecated:true},maximumCanEqual:{deprecated:true},exclusiveMinimum:{type:"boolean","default":false,parser:function(K,L){return !!K.getValue()}},exclusiveMaximum:{type:"boolean","default":false,parser:function(K,L){return !!K.getValue()}},minimum:{validator:function(Q,L,R,M,P,S,K){var N,O;if(Q.getType()==="number"){N=L.getAttribute("minimum");O=L.getAttribute("exclusiveMinimum")||(!Q.getEnvironment().getOption("strict")&&!L.getAttribute("minimumCanEqual"));if(typeof N==="number"&&(Q.getValue()<N||(O===true&&Q.getValue()===N))){M.addError(Q,L,"minimum","Number is less then the required minimum value",N)}}}},maximum:{validator:function(Q,M,R,N,P,S,K){var L,O;if(Q.getType()==="number"){L=M.getAttribute("maximum");O=M.getAttribute("exclusiveMaximum")||(!Q.getEnvironment().getOption("strict")&&!M.getAttribute("maximumCanEqual"));if(typeof L==="number"&&(Q.getValue()>L||(O===true&&Q.getValue()===L))){N.addError(Q,M,"maximum","Number is greater then the required maximum value",L)}}}},contentEncoding:{deprecated:true},divisibleBy:{exclusiveMinimum:true},disallow:{items:{type:["string",{"$ref":"#"}]},parser:u.properties["type"]["parser"]},id:{type:"string",format:"uri"},"$ref":{type:"string",format:"uri"},"$schema":{type:"string",format:"uri"}},dependencies:{exclusiveMinimum:"minimum",exclusiveMaximum:"maximum"},initializer:function(L){var P,Q,K,N=L.getValueOfProperty("$schema"),M=L.getValueOfProperty("$ref"),O=L.getValueOfProperty("id");if(N){P=L.resolveURI(N);if(P&&L._schema._uri!==P){if(L._env._schemas[P]){L._schema=L._env._schemas[P];initializer=L._schema.getValueOfProperty("initializer");if(typeof initializer==="function"){return initializer(L)}else{return L}}else{if(L._env._options.validateReferences){throw new n(L,L._schema,"$schema","Unknown schema reference",P)}}}}if(M){P=L.resolveURI(M);if(P&&L._uri!==P){if(L._env._schemas[P]){L=L._env._schemas[P];return L}else{if(L._env._options.validateReferences){throw new n(L,L._schema,"$ref","Unknown schema reference",P)}}}}Q=L.getAttribute("extends");if(s.isJSONSchema(Q)){K=s.inherits(Q,L,true);L=L._env.createSchema(K,L._schema,L._uri)}if(O){P=L.resolveURI(O);if(s.typeOf(P)==="string"){L._uri=s.formatURI(P)}}return L}});l=s.inherits(G,{"$schema":"http://json-schema.org/draft-03/hyper-schema#",id:"http://json-schema.org/draft-03/hyper-schema#",properties:{links:{selfReferenceVariable:"@"},root:{deprecated:true},contentEncoding:{deprecated:false},alternate:{deprecated:true}}});A=s.inherits(v,{"$schema":"http://json-schema.org/draft-03/hyper-schema#",id:"http://json-schema.org/draft-03/links#",properties:{href:{required:true,format:"link-description-object-template"},rel:{required:true},properties:{deprecated:true},schema:{"$ref":"http://json-schema.org/draft-03/hyper-schema#"}}});z.setOption("validateReferences",true);z.setOption("defaultSchemaURI","http://json-schema.org/draft-03/schema#");z.createSchema({},true,"http://json-schema.org/draft-03/schema#");z.createSchema({},true,"http://json-schema.org/draft-03/hyper-schema#");z.createSchema({},true,"http://json-schema.org/draft-03/links#");H=z.createSchema(w,true,"http://json-schema.org/draft-03/schema#");F=z.createSchema(s.inherits(H,z.createSchema(l,true,"http://json-schema.org/draft-03/hyper-schema#"),true),true,"http://json-schema.org/draft-03/hyper-schema#");x=z.createSchema(A,true,"http://json-schema.org/draft-03/links#");z.setOption("defaultSchemaURI","http://json-schema.org/draft-03/hyper-schema#");F=z.createSchema(F.getValue(),F,"http://json-schema.org/draft-03/hyper-schema#");z.setOption("latestJSONSchemaSchemaURI","http://json-schema.org/draft-03/schema#");z.setOption("latestJSONSchemaHyperSchemaURI","http://json-schema.org/draft-03/hyper-schema#");z.setOption("latestJSONSchemaLinksURI","http://json-schema.org/draft-03/links#");z._schemas["http://json-schema.org/schema#"]=H;z._schemas["http://json-schema.org/hyper-schema#"]=F;z._schemas["http://json-schema.org/links#"]=x;s.registerEnvironment("json-schema-draft-03",z);if(!s.getDefaultEnvironmentID()||s.getDefaultEnvironmentID()==="json-schema-draft-01"||s.getDefaultEnvironmentID()==="json-schema-draft-02"){s.setDefaultEnvironmentID("json-schema-draft-03")}}());c.JSONFormValidator=a.JSV})(this,false);(function(g){var o,B="",v=Math.PI,i=v/2,m="ontouchstart" in window,c=(m)?{start:"touchstart",move:"touchmove",end:"touchend"}:{start:"mousedown",move:"mousemove",end:"mouseup"},w={backward:["bl","tl"],forward:["br","tr"],all:["tl","bl","tr","br"]},l=["single","double"],f={page:1,gradients:true,duration:600,acceleration:true,display:"double",when:null},a={folding:null,corners:"forward",cornerSize:100,gradients:true,duration:600,acceleration:true},A=6,u={0:{top:0,left:0,right:"auto",bottom:"auto"},1:{top:0,right:0,left:"auto",bottom:"auto"}},s=function(F,E,G,D){return{css:{position:"absolute",top:F,left:E,overflow:D||"hidden","z-index":G||"auto"}}},q=function(J,I,H,G,F){var D=1-F,E=D*D*D,K=F*F*F;return h(Math.round(E*J.x+3*F*D*D*I.x+3*F*F*D*H.x+K*G.x),Math.round(E*J.y+3*F*D*D*I.y+3*F*F*D*H.y+K*G.y))},C=function(D){return D/180*v},r=function(D){return D/v*180},h=function(D,E){return{x:D,y:E}},p=function(D,F,E){return(o&&E)?" translate3d("+D+"px,"+F+"px, 0px) ":" translate("+D+"px, "+F+"px) "},y=function(D){return" rotate("+D+"deg) "},e=function(E,D){return Object.prototype.hasOwnProperty.call(D,E)},t=function(){var E=["Moz","Webkit","Khtml","O","ms"],D=E.length,F="";while(D--){if((E[D]+"Transform") in document.body.style){F="-"+E[D].toLowerCase()+"-"}}return F},b=function(P,F,E,K,Q){var T,N=[];if(B=="-webkit-"){for(T=0;T<Q;T++){N.push("color-stop("+K[T][0]+", "+K[T][1]+")")}P.css({"background-image":"-webkit-gradient(linear, "+F.x+"% "+F.y+"%,  "+E.x+"% "+E.y+"%, "+N.join(",")+" )"})}else{F={x:F.x/100*P.width(),y:F.y/100*P.height()};E={x:E.x/100*P.width(),y:E.y/100*P.height()};var O=E.x-F.x,M=E.y-F.y,U=Math.atan2(M,O),G=U-Math.PI/2,S=Math.abs(P.width()*Math.sin(G))+Math.abs(P.height()*Math.cos(G)),D=Math.sqrt(M*M+O*O),I=h((E.x<F.x)?P.width():0,(E.y<F.y)?P.height():0),J=Math.tan(U),H=-1/J,L=(H*I.x-I.y-J*F.x+F.y)/(H-J),V={x:L,y:H*L-H*I.x+I.y},R=(Math.sqrt(Math.pow(V.x-F.x,2)+Math.pow(V.y-F.y,2)));for(T=0;T<Q;T++){N.push(" "+K[T][1]+" "+((R+D*K[T][0])*100/S)+"%")}P.css({"background-image":B+"linear-gradient("+(-U)+"rad,"+N.join(",")+")"})}},z={init:function(F){if(o===undefined){o="WebKitCSSMatrix" in window||"MozPerspective" in document.body.style;B=t()}var D,G=this.data(),E=this.children();F=g.extend({width:this.width(),height:this.height()},f,F);G.opts=F;G.pageObjs={};G.pages={};G.pageWrap={};G.pagePlace={};G.pageMv=[];G.totalPages=F.pages||0;if(F.when){for(D in F.when){if(e(D,F.when)){this.bind(D,F.when[D])}}}this.css({position:"relative",width:F.width,height:F.height});this.turn("display",F.display);if(o&&!m&&F.acceleration){this.transform(p(0,0,true))}for(D=0;D<E.length;D++){this.turn("addPage",E[D],D+1)}this.turn("page",F.page);w=g.extend({},w,F.corners);g(this).bind(c.start,function(I){for(var H in G.pages){if(e(H,G.pages)&&x._eventStart.call(G.pages[H],I)===false){return false}}});g(document).bind(c.move,function(I){for(var H in G.pages){if(e(H,G.pages)){x._eventMove.call(G.pages[H],I)}}}).bind(c.end,function(I){for(var H in G.pages){if(e(H,G.pages)){x._eventEnd.call(G.pages[H],I)}}});G.done=true;return this},addPage:function(D,H){var E=false,G=this.data(),F=G.totalPages+1;if(H){if(H==F){H=F;E=true}else{if(H>F){throw new Error('It is impossible to add the page "'+H+'", the maximum value is: "'+F+'"')}}}else{H=F;E=true}if(H>=1&&H<=F){if(G.done){this.turn("stop")}if(H in G.pageObjs){z._movePages.call(this,H,1)}if(E){G.totalPages=F}G.pageObjs[H]=g(D).addClass("turn-page p"+H);z._addPage.call(this,H);if(G.done){this.turn("update")}z._removeFromDOM.call(this)}return this},_addPage:function(H){var G=this.data(),E=G.pageObjs[H];if(E){if(z._necessPage.call(this,H)){if(!G.pageWrap[H]){var D=(G.display=="double")?this.width()/2:this.width(),F=this.height();E.css({width:D,height:F});G.pagePlace[H]=H;G.pageWrap[H]=g("<div/>",{"class":"turn-page-wrapper",page:H,css:{position:"absolute",overflow:"hidden",width:D,height:F}}).css(u[(G.display=="double")?H%2:0]);this.append(G.pageWrap[H]);G.pageWrap[H].prepend(G.pageObjs[H])}if(!H||z._setPageLoc.call(this,H)==1){z._makeFlip.call(this,H)}}else{G.pagePlace[H]=0;if(G.pageObjs[H]){G.pageObjs[H].remove()}}}},hasPage:function(D){return D in this.data().pageObjs},_makeFlip:function(E){var D=this.data();if(!D.pages[E]&&D.pagePlace[E]==E){var G=D.display=="single",F=E%2;D.pages[E]=D.pageObjs[E].css({width:(G)?this.width():this.width()/2,height:this.height()}).flip({page:E,next:(G&&E===D.totalPages)?E-1:((F||G)?E+1:E-1),turn:this,duration:D.opts.duration,acceleration:D.opts.acceleration,corners:(G)?"all":((F)?"forward":"backward"),backGradient:D.opts.gradients,frontGradient:D.opts.gradients}).flip("disable",D.disabled).bind("pressed",z._pressed).bind("released",z._released).bind("start",z._start).bind("end",z._end).bind("flip",z._flip)}return D.pages[E]},_makeRange:function(){var F,E=this.data(),D=this.turn("range");for(F=D[0];F<=D[1];F++){z._addPage.call(this,F)}},range:function(H){var D,I,F,G=this.data();H=H||G.tpage||G.page;var E=z._view.call(this,H);if(H<1||H>G.totalPages){throw new Error('"'+H+'" is not a page for range')}E[1]=E[1]||E[0];if(E[0]>=1&&E[1]<=G.totalPages){D=Math.floor((A-2)/2);if(G.totalPages-E[1]>E[0]){I=Math.min(E[0]-1,D);F=2*D-I}else{F=Math.min(G.totalPages-E[1],D);I=2*D-F}}else{I=A-1;F=A-1}return[Math.max(1,E[0]-I),Math.min(G.totalPages,E[1]+F)]},_necessPage:function(E){if(E===0){return true}var D=this.turn("range");return E>=D[0]&&E<=D[1]},_removeFromDOM:function(){var E,D=this.data();for(E in D.pageWrap){if(e(E,D.pageWrap)&&!z._necessPage.call(this,E)){z._removePageFromDOM.call(this,E)}}},_removePageFromDOM:function(F){var E=this.data();if(E.pages[F]){var D=E.pages[F].data();if(D.f&&D.f.fwrapper){D.f.fwrapper.remove()}E.pages[F].remove();delete E.pages[F]}if(E.pageObjs[F]){E.pageObjs[F].remove()}if(E.pageWrap[F]){E.pageWrap[F].remove();delete E.pageWrap[F]}delete E.pagePlace[F]},removePage:function(E){var D=this.data();if(D.pageObjs[E]){this.turn("stop");z._removePageFromDOM.call(this,E);delete D.pageObjs[E];z._movePages.call(this,E,-1);D.totalPages=D.totalPages-1;z._makeRange.call(this);if(D.page>D.totalPages){this.turn("page",D.totalPages)}}return this},_movePages:function(I,H){var F,E=this.data(),G=E.display=="single",D=function(L){var J=L+H,K=J%2;if(E.pageObjs[L]){E.pageObjs[J]=E.pageObjs[L].removeClass("page"+L).addClass("page"+J)}if(E.pagePlace[L]&&E.pageWrap[L]){E.pagePlace[J]=J;E.pageWrap[J]=E.pageWrap[L].css(u[(G)?0:K]).attr("page",J);if(E.pages[L]){E.pages[J]=E.pages[L].flip("options",{page:J,next:(G||K)?J+1:J-1,corners:(G)?"all":((K)?"forward":"backward")})}if(H){delete E.pages[L];delete E.pagePlace[L];delete E.pageObjs[L];delete E.pageWrap[L];delete E.pageObjs[L]}}};if(H>0){for(F=E.totalPages;F>=I;F--){D(F)}}else{for(F=I;F<=E.totalPages;F++){D(F)}}},display:function(F){var E=this.data(),G=E.display;if(F){if(g.inArray(F,l)==-1){throw new Error('"'+F+'" is not a value for display')}if(F=="single"){if(!E.pageObjs[0]){this.turn("stop").css({overflow:"hidden"});E.pageObjs[0]=g("<div />",{"class":"turn-page p-temporal"}).css({width:this.width(),height:this.height()}).appendTo(this)}}else{if(E.pageObjs[0]){this.turn("stop").css({overflow:""});E.pageObjs[0].remove();delete E.pageObjs[0]}}E.display=F;if(G){var D=this.turn("size");z._movePages.call(this,1,0);this.turn("size",D.width,D.height).turn("update")}return this}else{return G}},animating:function(){return this.data().pageMv.length>0},disable:function(E){var G,F=this.data(),D=this.turn("view");F.disabled=E===undefined||E===true;for(G in F.pages){if(e(G,F.pages)){F.pages[G].flip("disable",E?g.inArray(G,D):false)}}return this},size:function(F,D){if(F&&D){var H=this.data(),E=(H.display=="double")?F/2:F,G;this.css({width:F,height:D});if(H.pageObjs[0]){H.pageObjs[0].css({width:E,height:D})}for(G in H.pageWrap){if(!e(G,H.pageWrap)){continue}H.pageObjs[G].css({width:E,height:D});H.pageWrap[G].css({width:E,height:D});if(H.pages[G]){H.pages[G].css({width:E,height:D})}}this.turn("resize");return this}else{return{width:this.width(),height:this.height()}}},resize:function(){var E,D=this.data();if(D.pages[0]){D.pageWrap[0].css({left:-this.width()});D.pages[0].flip("resize",true)}for(E=1;E<=D.totalPages;E++){if(D.pages[E]){D.pages[E].flip("resize",true)}}},_removeMv:function(F){var D,E=this.data();for(D=0;D<E.pageMv.length;D++){if(E.pageMv[D]==F){E.pageMv.splice(D,1);return true}}return false},_addMv:function(E){var D=this.data();z._removeMv.call(this,E);D.pageMv.push(E)},_view:function(E){var D=this.data();E=E||D.page;if(D.display=="double"){return(E%2)?[E-1,E]:[E,E+1]}else{return[E]}},view:function(F){var E=this.data(),D=z._view.call(this,F);return(E.display=="double")?[(D[0]>0)?D[0]:0,(D[1]<=E.totalPages)?D[1]:0]:[(D[0]>0&&D[0]<=E.totalPages)?D[0]:0]},stop:function(F){var E,G,H=this.data(),D=H.pageMv;H.pageMv=[];if(H.tpage){H.page=H.tpage;delete H.tpage}for(E in D){if(!e(E,D)){continue}G=H.pages[D[E]].data().f.opts;x._moveFoldingPage.call(H.pages[D[E]],null);H.pages[D[E]].flip("hideFoldedPage");H.pagePlace[G.next]=G.next;if(G.force){G.next=(G.page%2===0)?G.page-1:G.page+1;delete G.force}}this.turn("update");return this},pages:function(D){var F=this.data();if(D){if(D<F.totalPages){for(var E=D+1;E<=F.totalPages;E++){this.turn("removePage",E)}if(this.turn("page")>D){this.turn("page",D)}}F.totalPages=D;return this}else{return F.totalPages}},_fitPage:function(F,D){var E=this.data(),G=this.turn("view",F);if(E.page!=F){this.trigger("turning",[F,G]);if(g.inArray(1,G)!=-1){this.trigger("first")}if(g.inArray(E.totalPages,G)!=-1){this.trigger("last")}}if(!E.pageObjs[F]){return}E.tpage=F;this.turn("stop",D);z._removeFromDOM.call(this);z._makeRange.call(this);this.trigger("turned",[F,G])},_turnPage:function(H){var I,E,G=this.data(),D=this.turn("view"),J=this.turn("view",H);if(G.page!=H){this.trigger("turning",[H,J]);if(g.inArray(1,J)!=-1){this.trigger("first")}if(g.inArray(G.totalPages,J)!=-1){this.trigger("last")}}if(!G.pageObjs[H]){return}G.tpage=H;this.turn("stop");z._makeRange.call(this);if(G.display=="single"){I=D[0];E=J[0]}else{if(D[1]&&H>D[1]){I=D[1];E=J[0]}else{if(D[0]&&H<D[0]){I=D[0];E=J[1]}}}if(G.pages[I]){var F=G.pages[I].data().f.opts;G.tpage=E;if(F.next!=E){F.next=E;G.pagePlace[E]=F.page;F.force=true}if(G.display=="single"){G.pages[I].flip("turnPage",(J[0]>D[0])?"br":"bl")}else{G.pages[I].flip("turnPage")}}},page:function(E){E=parseInt(E,10);var D=this.data();if(E>0&&E<=D.totalPages){if(!D.done||g.inArray(E,this.turn("view"))!=-1){z._fitPage.call(this,E)}else{z._turnPage.call(this,E)}return this}else{return D.page}},next:function(){var D=this.data();return this.turn("page",z._view.call(this,D.page).pop()+1)},previous:function(){var D=this.data();return this.turn("page",z._view.call(this,D.page).shift()-1)},_addMotionPage:function(){var F=g(this).data().f.opts,E=F.turn,D=E.data();F.pageMv=F.page;z._addMv.call(E,F.pageMv);D.pagePlace[F.next]=F.page;E.turn("update")},_start:function(I,F,E){var G=F.turn.data(),D=g.Event("start");I.stopPropagation();F.turn.trigger(D,[F,E]);if(D.isDefaultPrevented()){I.preventDefault();return}if(G.display=="single"){var H=E.charAt(1)=="l";if((F.page==1&&H)||(F.page==G.totalPages&&!H)){I.preventDefault()}else{if(H){F.next=(F.next<F.page)?F.next:F.page-1;F.force=true}else{F.next=(F.next>F.page)?F.next:F.page+1}}}z._addMotionPage.call(this)},_end:function(J,H){var G=g(this),I=G.data().f,F=I.opts,E=F.turn,D=E.data();J.stopPropagation();if(H||D.tpage){if(D.tpage==F.next||D.tpage==F.page){delete D.tpage;z._fitPage.call(E,D.tpage||F.next,true)}}else{z._removeMv.call(E,F.pageMv);E.turn("update")}},_pressed:function(){var H,F=g(this),G=F.data().f,E=G.opts.turn,D=E.data().pages;for(H in D){if(H!=G.opts.page){D[H].flip("disable",true)}}return G.time=new Date().getTime()},_released:function(G,D){var E=g(this),F=E.data().f;G.stopPropagation();if((new Date().getTime())-F.time<200||D.x<0||D.x>g(this).width()){G.preventDefault();F.opts.turn.data().tpage=F.opts.next;F.opts.turn.turn("update");g(E).flip("turnPage")}},_flip:function(){var D=g(this).data().f.opts;D.turn.trigger("turn",[D.next])},calculateZ:function(O){var G,J,M,E,N,I=this,F=this.data(),L=this.turn("view"),H=L[0]||L[1],D={pageZ:{},partZ:{},pageV:{}},K=function(Q){var P=I.turn("view",Q);if(P[0]){D.pageV[P[0]]=true}if(P[1]){D.pageV[P[1]]=true}};for(G=0;G<O.length;G++){J=O[G];M=F.pages[J].data().f.opts.next;E=F.pagePlace[J];K(J);K(M);N=(F.pagePlace[M]==M)?M:J;D.pageZ[N]=F.totalPages-Math.abs(H-N);D.partZ[E]=F.totalPages*2+Math.abs(H-N)}return D},update:function(){var H,G=this.data();if(G.pageMv.length&&G.pageMv[0]!==0){var F,I=this.turn("calculateZ",G.pageMv),E=this.turn("view",G.tpage);if(G.pagePlace[E[0]]==E[0]){F=E[0]}else{if(G.pagePlace[E[1]]==E[1]){F=E[1]}}for(H in G.pageWrap){if(!e(H,G.pageWrap)){continue}G.pageWrap[H].css({display:(I.pageV[H])?"":"none","z-index":I.pageZ[H]||0});if(G.pages[H]){G.pages[H].flip("z",I.partZ[H]||null);if(I.pageV[H]){G.pages[H].flip("resize")}if(G.tpage){G.pages[H].flip("disable",true)}}}}else{for(H in G.pageWrap){if(!e(H,G.pageWrap)){continue}var D=z._setPageLoc.call(this,H);if(G.pages[H]){G.pages[H].flip("disable",G.disabled||D!=1).flip("z",null)}}}},_setPageLoc:function(F){var E=this.data(),D=this.turn("view");if(F==D[0]||F==D[1]){E.pageWrap[F].css({"z-index":E.totalPages,display:""});return 1}else{if((E.display=="single"&&F==D[0]+1)||(E.display=="double"&&F==D[0]-2||F==D[1]+2)){E.pageWrap[F].css({"z-index":E.totalPages-1,display:""});return 2}else{E.pageWrap[F].css({"z-index":0,display:"none"});return 0}}}},x={init:function(D){if(D.gradients){D.frontGradient=true;D.backGradient=true}this.data({f:{}});this.flip("options",D);x._addPageWrapper.call(this);return this},setData:function(E){var D=this.data();D.f=g.extend(D.f,E);return this},options:function(D){var E=this.data().f;if(D){x.setData.call(this,{opts:g.extend({},E.opts||a,D)});return this}else{return E.opts}},z:function(E){var D=this.data().f;D.opts["z-index"]=E;D.fwrapper.css({"z-index":E||parseInt(D.parent.css("z-index"),10)||0});return this},_cAllowed:function(){return w[this.data().f.opts.corners]||this.data().f.opts.corners},_cornerActivated:function(I){if(I.originalEvent===undefined){return false}I=(m)?I.originalEvent.touches:[I];var G=this.data().f,K=G.parent.offset(),F=this.width(),E=this.height(),J={x:Math.max(0,I[0].pageX-K.left),y:Math.max(0,I[0].pageY-K.top)},H=G.opts.cornerSize,D=x._cAllowed.call(this);if(J.x<=0||J.y<=0||J.x>=F||J.y>=E){return false}if(J.y<H){J.corner="t"}else{if(J.y>=E-H){J.corner="b"}else{return false}}if(J.x<=H){J.corner+="l"}else{if(J.x>=F-H){J.corner+="r"}else{return false}}return(g.inArray(J.corner,D)==-1)?false:J},_c:function(E,D){D=D||0;return({tl:h(D,D),tr:h(this.width()-D,D),bl:h(D,this.height()-D),br:h(this.width()-D,this.height()-D)})[E]},_c2:function(D){return{tl:h(this.width()*2,0),tr:h(-this.width(),0),bl:h(this.width()*2,this.height()),br:h(-this.width(),this.height())}[D]},_foldingPage:function(E){var D=this.data().f.opts;if(D.folding){return D.folding}else{if(D.turn){var F=D.turn.data();if(F.display=="single"){return(F.pageObjs[D.next])?F.pageObjs[0]:null}else{return F.pageObjs[D.next]}}}},_backGradient:function(){var E=this.data().f,D=E.opts.turn,F=E.opts.backGradient&&(!D||D.data().display=="single"||(E.opts.page!=2&&E.opts.page!=D.data().totalPages-1));if(F&&!E.bshadow){E.bshadow=g("<div/>",s(0,0,1)).css({position:"",width:this.width(),height:this.height()}).appendTo(E.parent)}return F},resize:function(F){var H=this.data().f,G=this.width(),D=this.height(),E=Math.round(Math.sqrt(Math.pow(G,2)+Math.pow(D,2)));if(F){H.wrapper.css({width:E,height:E});H.fwrapper.css({width:E,height:E}).children(":first-child").css({width:G,height:D});H.fpage.css({width:D,height:G});if(H.opts.frontGradient){H.ashadow.css({width:D,height:G})}if(x._backGradient.call(this)){H.bshadow.css({width:G,height:D})}}if(H.parent.is(":visible")){H.fwrapper.css({top:H.parent.offset().top,left:H.parent.offset().left});if(H.opts.turn){H.fparent.css({top:-H.opts.turn.offset().top,left:-H.opts.turn.offset().left})}}this.flip("z",H.opts["z-index"])},_addPageWrapper:function(){var H,G=this.data().f,J=this.parent();if(!G.wrapper){var F=this.css("left"),I=this.css("top"),E=this.width(),K=this.height(),L=Math.round(Math.sqrt(Math.pow(E,2)+Math.pow(K,2)));G.parent=J;G.fparent=(G.opts.turn)?G.opts.turn.data().fparent:g("#turn-fwrappers");if(!G.fparent){var D=g("<div/>",{css:{"pointer-events":"none"}}).hide();D.data().flips=0;if(G.opts.turn){D.css(s(-G.opts.turn.offset().top,-G.opts.turn.offset().left,"auto","visible").css).appendTo(G.opts.turn);G.opts.turn.data().fparent=D}else{D.css(s(0,0,"auto","visible").css).attr("id","turn-fwrappers").appendTo(g("body"))}G.fparent=D}this.css({position:"absolute",top:0,left:0,bottom:"auto",right:"auto"});G.wrapper=g("<div/>",s(0,0,this.css("z-index"))).appendTo(J).prepend(this);G.fwrapper=g("<div/>",s(J.offset().top,J.offset().left)).hide().appendTo(G.fparent);G.fpage=g("<div/>",{css:{cursor:"default"}}).appendTo(g("<div/>",s(0,0,0,"visible")).appendTo(G.fwrapper));if(G.opts.frontGradient){G.ashadow=g("<div/>",s(0,0,1)).appendTo(G.fpage)}x.setData.call(this,G);x.resize.call(this,true)}},_fold:function(T){var K=this,ab=0,I=0,Y,N,H,F,E,Q,J,O=h(0,0),X=h(0,0),D=h(0,0),S=this.width(),P=this.height(),aa=x._foldingPage.call(this),W=Math.tan(I),ac=this.data().f,Z=ac.opts.acceleration,V=ac.wrapper.height(),R=x._c.call(this,T.corner),M=T.corner.substr(0,1)=="t",G=T.corner.substr(1,1)=="l",U=function(){var an=h((R.x)?R.x-T.x:T.x,(R.y)?R.y-T.y:T.y),ak=(Math.atan2(an.y,an.x)),ao;I=i-ak;ab=r(I);ao=h((G)?S-an.x/2:T.x+an.x/2,an.y/2);var af=I-Math.atan2(ao.y,ao.x),ae=Math.max(0,Math.sin(af)*Math.sqrt(Math.pow(ao.x,2)+Math.pow(ao.y,2)));D=h(ae*Math.sin(I),ae*Math.cos(I));if(I>i){D.x=D.x+Math.abs(D.y*Math.tan(ak));D.y=0;if(Math.round(D.x*Math.tan(v-I))<P){T.y=Math.sqrt(Math.pow(P,2)+2*ao.x*an.x);if(M){T.y=P-T.y}return U()}}if(I>i){var al=v-I,am=V-P/Math.sin(al);O=h(Math.round(am*Math.cos(al)),Math.round(am*Math.sin(al)));if(G){O.x=-O.x}if(M){O.y=-O.y}}N=Math.round(D.y/Math.tan(I)+D.x);var aj=S-N,ah=aj*Math.cos(I*2),ag=aj*Math.sin(I*2);X=h(Math.round((G?aj-ah:N+ah)),Math.round((M)?ag:P-ag));Q=aj*Math.sin(I);var ad=x._c2.call(K,T.corner),ai=Math.sqrt(Math.pow(ad.x-T.x,2)+Math.pow(ad.y-T.y,2));J=(ai<S)?ai/S:1;if(ac.opts.frontGradient){E=Q>100?(Q-100)/Q:0;H=h(Q*Math.sin(i-I)/P*100,Q*Math.cos(i-I)/S*100);if(M){H.y=100-H.y}if(G){H.x=100-H.x}}if(x._backGradient.call(K)){F=h(Q*Math.sin(I)/S*100,Q*Math.cos(I)/P*100);if(!G){F.x=100-F.x}if(!M){F.y=100-F.y}}D.x=Math.round(D.x);D.y=Math.round(D.y);return true},L=function(ah,ag,aj,ai){var af=["0","auto"],ak=(S-V)*aj[0]/100,ae=(P-V)*aj[1]/100,al={left:af[ag[0]],top:af[ag[1]],right:af[ag[2]],bottom:af[ag[3]]},ad=(ai!=90&&ai!=-90)?(G?-1:1):0;aj=aj[0]+"% "+aj[1]+"%";K.css(al).transform(y(ai)+p(ah.x+ad,ah.y,Z),aj);ac.fpage.parent().css(al);ac.wrapper.transform(p(-ah.x+ak-ad,-ah.y+ae,Z)+y(-ai),aj);ac.fwrapper.transform(p(-ah.x+O.x+ak,-ah.y+O.y+ae,Z)+y(-ai),aj);ac.fpage.parent().transform(y(ai)+p(ah.x+X.x-O.x,ah.y+X.y-O.y,Z),aj);if(ac.opts.frontGradient){b(ac.ashadow,h(G?100:0,M?100:0),h(H.x,H.y),[[E,"rgba(0,0,0,0)"],[((1-E)*0.8)+E,"rgba(0,0,0,"+(0.2*J)+")"],[1,"rgba(255,255,255,"+(0.2*J)+")"]],3,I)}if(x._backGradient.call(K)){b(ac.bshadow,h(G?0:100,M?0:100),h(F.x,F.y),[[0.8,"rgba(0,0,0,0)"],[1,"rgba(0,0,0,"+(0.3*J)+")"],[1,"rgba(0,0,0,0)"]],3)}};switch(T.corner){case"tl":T.x=Math.max(T.x,1);U();L(D,[1,0,0,1],[100,0],ab);ac.fpage.transform(p(-P,-S,Z)+y(90-ab*2),"100% 100%");aa.transform(y(90)+p(0,-P,Z),"0% 0%");break;case"tr":T.x=Math.min(T.x,S-1);U();L(h(-D.x,D.y),[0,0,0,1],[0,0],-ab);ac.fpage.transform(p(0,-S,Z)+y(-90+ab*2),"0% 100%");aa.transform(y(270)+p(-S,0,Z),"0% 0%");break;case"bl":T.x=Math.max(T.x,1);U();L(h(D.x,-D.y),[1,1,0,0],[100,100],-ab);ac.fpage.transform(p(-P,0,Z)+y(-90+ab*2),"100% 0%");aa.transform(y(270)+p(-S,0,Z),"0% 0%");break;case"br":T.x=Math.min(T.x,S-1);U();L(h(-D.x,-D.y),[0,1,1,0],[0,100],ab);ac.fpage.transform(y(90-ab*2),"0% 0%");aa.transform(y(90)+p(0,-P,Z),"0% 0%");break}ac.point=T},_moveFoldingPage:function(D){var F=this.data().f,E=x._foldingPage.call(this);if(E){if(D){if(!F.fpage.children()[F.ashadow?"1":"0"]){x.setData.call(this,{backParent:E.parent()});F.fpage.prepend(E)}}else{if(F.backParent){F.backParent.prepend(E)}}}},_showFoldedPage:function(K,F){var G=x._foldingPage.call(this),E=this.data(),J=E.f;if(!J.point||J.point.corner!=K.corner){var I=g.Event("start");this.trigger(I,[J.opts,K.corner]);if(I.isDefaultPrevented()){return false}}if(G){if(F){var H=this,D=(J.point&&J.point.corner==K.corner)?J.point:x._c.call(this,K.corner,1);this.animatef({from:[D.x,D.y],to:[K.x,K.y],duration:500,frame:function(L){K.x=Math.round(L[0]);K.y=Math.round(L[1]);x._fold.call(H,K)}})}else{x._fold.call(this,K);if(E.effect&&!E.effect.turning){this.animatef(false)}}if(!J.fwrapper.is(":visible")){J.fparent.show().data().flips++;x._moveFoldingPage.call(this,true);J.fwrapper.show();if(J.bshadow){J.bshadow.show()}}return true}return false},hide:function(){var E=this.data().f,D=x._foldingPage.call(this);if((--E.fparent.data().flips)===0){E.fparent.hide()}this.css({left:0,top:0,right:"auto",bottom:"auto"}).transform("","0% 100%");E.wrapper.transform("","0% 100%");E.fwrapper.hide();if(E.bshadow){E.bshadow.hide()}D.transform("","0% 0%");return this},hideFoldedPage:function(D){var E=this.data().f;if(!E.point){return}var G=this,M=E.point,F=function(){E.point=null;G.flip("hide");G.trigger("end",[false])};if(D){var I=x._c.call(this,M.corner),H=(M.corner.substr(0,1)=="t"),L=(H)?Math.min(0,M.y-I.y)/2:Math.max(0,M.y-I.y)/2,K=h(M.x,M.y+L),J=h(I.x,I.y-L);this.animatef({from:0,to:1,frame:function(N){var O=q(M,K,J,I,N);M.x=O.x;M.y=O.y;x._fold.call(G,M)},complete:F,duration:800,hiding:true})}else{this.animatef(false);F()}},turnPage:function(F){var E=this,G=this.data().f;F={corner:(G.corner)?G.corner.corner:F||x._cAllowed.call(this)[0]};var H=G.point||x._c.call(this,F.corner,(G.opts.turn)?G.opts.turn.data().opts.elevation:0),D=x._c2.call(this,F.corner);this.trigger("flip").animatef({from:0,to:1,frame:function(I){var J=q(H,H,D,D,I);F.x=J.x;F.y=J.y;x._showFoldedPage.call(E,F)},complete:function(){E.trigger("end",[true])},duration:G.opts.duration,turning:true});G.corner=null},moving:function(){return"effect" in this.data()},isTurning:function(){return this.flip("moving")&&this.data().effect.turning},_eventStart:function(E){var D=this.data().f;if(!D.disabled&&!this.flip("isTurning")){D.corner=x._cornerActivated.call(this,E);if(D.corner&&x._foldingPage.call(this,D.corner)){x._moveFoldingPage.call(this,true);this.trigger("pressed",[D.point]);return false}else{D.corner=null}}},_eventMove:function(G){var F=this.data().f;if(!F.disabled){G=(m)?G.originalEvent.touches:[G];if(F.corner){var H=F.parent.offset();F.corner.x=G[0].pageX-H.left;F.corner.y=G[0].pageY-H.top;x._showFoldedPage.call(this,F.corner)}else{if(!this.data().effect&&this.is(":visible")){var E=x._cornerActivated.call(this,G[0]);if(E){var D=x._c.call(this,E.corner,F.opts.cornerSize/2);E.x=D.x;E.y=D.y;x._showFoldedPage.call(this,E,true)}else{x.hideFoldedPage.call(this,true)}}}}},_eventEnd:function(){var E=this.data().f;if(!E.disabled&&E.point){var D=g.Event("released");this.trigger(D,[E.point]);if(!D.isDefaultPrevented()){x.hideFoldedPage.call(this,true)}}E.corner=null},disable:function(D){x.setData.call(this,{disabled:D});return this}},n=function(F,D,E){if(!E[0]||typeof(E[0])=="object"){return D.init.apply(F,E)}else{if(D[E[0]]&&E[0].toString().substr(0,1)!="_"){return D[E[0]].apply(F,Array.prototype.slice.call(E,1))}else{throw E[0]+" is an invalid value"}}};g.extend(g.fn,{flip:function(E,D){return n(this,x,arguments)},turn:function(D){return n(this,z,arguments)},transform:function(E,D){var F={};if(D){F[B+"transform-origin"]=D}F[B+"transform"]=E;return this.css(F)},animatef:function(L){var G=this.data();if(G.effect){clearInterval(G.effect.handle)}if(L){if(!L.to.length){L.to=[L.to]}if(!L.from.length){L.from=[L.from]}if(!L.easing){L.easing=function(N,O,M,Q,P){return Q*Math.sqrt(1-(O=O/P-1)*O)+M}}var F,K=[],J=L.to.length,I=this,D=L.fps||30,E=-D,H=function(){var N,M=[];E=Math.min(L.duration,E+D);for(N=0;N<J;N++){M.push(L.easing(1,E,L.from[N],K[N],L.duration))}L.frame((J==1)?M[0]:M);if(E==L.duration){clearInterval(G.effect.handle);delete G.effect;I.data(G);if(L.complete){L.complete()}}};for(F=0;F<J;F++){K.push(L.to[F]-L.from[F])}G.effect=L;G.effect.handle=setInterval(H,D);this.data(G);H()}else{delete G.effect}}});g.isTouch=m})(jQuery);Array.prototype.contains=function(b){var a=this.length;while(a--){if(this[a]===b){return true}}return false};Array.prototype.clear=function(){var a=this.length;while(a--){this[a]=0}};var timeDiff={start:function(){d=new Date();time=d.getTime()},end:function(){d=new Date();return(d.getTime()-time)}};function Sudoku(){this.matrix=new Array(81);this.matrix.clear();this.level=0;this.shuffle=function(q){for(var m=0;m<9;m++){for(var g=0;g<9;g++){q[m*9+g]=(m*3+Math.floor(m/3)+g)%9+1}}for(var m=0;m<42;m++){var o=Math.ceil(Math.random()*9);var n;do{n=Math.ceil(Math.random()*9)}while(o==n);for(var v=0;v<9;v++){for(var e=0;e<e;k++){if(q[v*9+e]==o){q[v*9+e]=n}else{if(q[v*9+e]==n){q[v*9+e]=o}}}}}for(var p=0;p<42;p++){var t=Math.floor(Math.random()*3);var r=Math.floor(Math.random()*3);for(var v=0;v<9;v++){var l=this.matrix[v*9+(t*3+p%3)];this.matrix[v*9+(t*3+p%3)]=this.matrix[v*9+(r*3+p%3)];this.matrix[v*9+(r*3+p%3)]=l}}for(var u=0;u<42;u++){var h=Math.floor(Math.random()*3);var f=Math.floor(Math.random()*3);for(var v=0;v<9;v++){var l=this.matrix[v*9+(u%3*3+h)];this.matrix[v*9+(u%3*3+h)]=this.matrix[v*9+(u%3*3+f)];this.matrix[v*9+(u%3*3+f)]=l}}for(var u=0;u<42;u++){var b=Math.floor(Math.random()*3);var a=Math.floor(Math.random()*3);for(var e=0;e<9;e++){var l=this.matrix[(u%3*3+b)*9+e];this.matrix[(u%3*3+b)*9+e]=this.matrix[(u%3*3+a)*9+e];this.matrix[(u%3*3+a)*9+e]=l}}};this.maskBoardEasy=function(e,a){var g,f,b;for(g=0;g<81;g++){a[g]=e[g]}for(var g=0;g<3;g++){for(var f=0;f<3;f++){for(var b=0;b<5;b++){var h;do{h=Math.floor(Math.random()*9)}while(a[(g*3+Math.floor(h/3))*9+f*3+h%3]==0);a[(g*3+Math.floor(h/3))*9+f*3+h%3]=0}}}};this.getAvailable=function(m,n,h){var f,e,o,b,a,l;var g=new Array(9);g.clear();o=Math.floor(n/9);b=n%9;for(f=0;f<9;f++){e=o*9+f;if(m[e]>0){g[m[e]-1]=1}}for(f=0;f<9;f++){e=f*9+b;if(m[e]>0){g[m[e]-1]=1}}a=o-o%3;l=b-b%3;for(f=a;f<a+3;f++){for(e=l;e<l+3;e++){if(m[f*9+e]>0){g[m[f*9+e]-1]=1}}}e=0;if(h!=null){for(f=0;f<9;f++){if(g[f]==0){h[e++]=f+1}}}else{for(f=0;f<9;f++){if(g[f]==0){e++}}return e}if(e==0){return 0}for(f=0;f<18;f++){a=Math.floor(Math.random()*e);l=Math.floor(Math.random()*e);o=h[a];h[a]=h[l];h[l]=o}return e};this.getCell=function(b){var a=-1,g=10,e,c;var f=new Array(9);f.clear();for(e=0;e<81;e++){if(b[e]==0){c=this.getAvailable(b,e,null);if(c<g){g=c;a=e}if(g==1){break}}}return a};this.solve=function(b){var f,e,c=0;var a=this.getCell(b);if(a==-1){return 1}var g=new Array(9);g.clear();e=this.getAvailable(b,a,g);for(f=0;f<e;f++){b[a]=g[f];if(this.solve(b)==1){return 1}}b[a]=0;return 0};this.enumSolutions=function(b){var f,e,c=0;var a=this.getCell(b);if(a==-1){return 1}var g=new Array(9);g.clear();e=this.getAvailable(b,a,g);for(f=0;f<e;f++){b[a]=g[f];c+=this.enumSolutions(b);if(c>1){break}}b[a]=0;return c};this.maskBoard=function(q,w){var x,s,p,l,y,m=0,A,o=0,b,B;var h=new Array(9);h.clear();var z=new Array(81);z.clear();w.clear();do{do{b=Math.floor(Math.random()*81)}while((w[b]!=0)||(z[b]!=0));B=q[b];x=this.getAvailable(w,b,null);if(x>1){var u,f=Math.floor(b/9),e=b%9;u=0;for(x=0;x<9;x++){if(x==e){continue}s=f*9+x;if(w[s]>0){continue}A=this.getAvailable(w,s,h);for(s=0;s<A;s++){if(h[s]==B){u++;break}h[s]=0}}if(u>0){u=0;for(x=0;x<9;x++){if(x==f){continue}s=x*9+e;if(w[s]>0){continue}A=this.getAvailable(w,s,h);for(s=0;s<A;s++){if(h[s]==B){u++;break}h[s]=0}}if(u>0){u=0;l=f-f%3;y=e-e%3;for(x=l;x<l+3;x++){for(s=y;s<y+3;s++){if((x==f)&&(s==e)){continue}p=x*9+s;if(w[p]>0){continue}A=this.getAvailable(w,p,h);for(p=0;p<A;p++){if(h[p]==B){u++;break}h[p]=0}}}if(u>0){w[b]=B;o++}}}}z[b]=1;m++}while(m<81);do{do{b=Math.floor(Math.random()*81)}while((w[b]==0)||(z[b]==0));B=w[b];var g=this;var v=0;w[b]=0;v=this.enumSolutions(w);if(v>1){w[b]=B}z[b]=0;o--}while(o>0)};this._checkVal=function(a,l,e,h){var f,b,g,m;for(f=0;f<9;f++){if((f!=e)&&(a[l*9+f]==h)){return false}}for(f=0;f<9;f++){if((f!=l)&&(a[f*9+e]==h)){return false}}g=l-l%3;m=e-e%3;for(f=g;f<g+3;f++){for(b=m;b<m+3;b++){if(((f!=l)||(b!=e))&&(a[f*9+b]==h)){return false}}}return true};this.checkVal=function(c,a,b){return this._checkVal(this.matrix,c,a,b)};this.setVal=function(c,a,b){this.matrix[c*9+a]=b};this.getVal=function(b,a){return this.matrix[b*9+a]};this._newGame=function(){var c,e=0;var b=new Array(81);this.matrix.clear();this.solve(this.matrix);if(this.level==0){this.maskBoardEasy(this.matrix,b)}else{this.maskBoard(this.matrix,b);if(this.level==1){for(c=0;c<4;c++){do{var a=Math.floor(Math.random()*81)}while(b[a]!=0);b[a]=this.matrix[a]}}}this.save=this.matrix;this.matrix=b;timeDiff.start()};this.done;this._doHints=function(e,b,c,g){if(g>0){do{cell=Math.floor(Math.random()*81)}while((b[cell]==0)||(c[cell]==0));val=b[cell];var f=this;var a=0;b[cell]=0;a=this.enumSolutions(b);if(a>1){b[cell]=val}c[cell]=0;g--;var f=this;setTimeout(function(){f._doHints(e,b,c,g)},50)}else{this.save=this.matrix;this.matrix=b;this.done()}};this._doMask=function(q,v){var w,s,p,l,x,m=0,z,o=0,b,A;var h=new Array(9);h.clear();var y=new Array(81);y.clear();v.clear();do{do{b=Math.floor(Math.random()*81)}while((v[b]!=0)||(y[b]!=0));A=q[b];w=this.getAvailable(v,b,null);if(w>1){var u,f=Math.floor(b/9),e=b%9;u=0;for(w=0;w<9;w++){if(w==e){continue}s=f*9+w;if(v[s]>0){continue}z=this.getAvailable(v,s,h);for(s=0;s<z;s++){if(h[s]==A){u++;break}h[s]=0}}if(u>0){u=0;for(w=0;w<9;w++){if(w==f){continue}s=w*9+e;if(v[s]>0){continue}z=this.getAvailable(v,s,h);for(s=0;s<z;s++){if(h[s]==A){u++;break}h[s]=0}}if(u>0){u=0;l=f-f%3;x=e-e%3;for(w=l;w<l+3;w++){for(s=x;s<x+3;s++){if((w==f)&&(s==e)){continue}p=w*9+s;if(v[p]>0){continue}z=this.getAvailable(v,p,h);for(p=0;p<z;p++){if(h[p]==A){u++;break}h[p]=0}}}if(u>0){v[b]=A;o++}}}}y[b]=1;m++}while(m<81);var g=this;setTimeout(function(){g._doHints(q,v,y,o)},50)};this.newGame=function(){var c,e=0;var b=new Array(81);this.matrix.clear();this.solve(this.matrix);if(this.level==0){this.maskBoardEasy(this.matrix,b);this.save=this.matrix;this.matrix=b;timeDiff.start();this.done()}else{this._doMask(this.matrix,b);if(this.level==1){for(c=0;c<4;c++){do{var a=Math.floor(Math.random()*81)}while(b[a]!=0);b[a]=this.matrix[a]}}}};this.solveGame=function(){this.matrix=this.save};this.gameFinished=function(){for(var b=0;b<9;b++){for(var a=0;a<9;a++){var c=this.matrix[b*9+a];if((c==0)||(this._checkVal(this.matrix,b,a,c)==false)){return 0}}}return timeDiff.end()}};/*!
 * jQuery Cookie Plugin v1.3.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */
(function (factory) {
	if (typeof define === 'function' && define.amd && define.amd.jQuery) {
		// AMD. Register as anonymous module.
		define(['jquery'], factory);
	} else {
		// Browser globals.
		factory(jQuery);
	}
}(function ($) {

	var pluses = /\+/g;

	function raw(s) {
		return s;
	}

	function decoded(s) {
		return decodeURIComponent(s.replace(pluses, ' '));
	}

	function converted(s) {
		if (s.indexOf('"') === 0) {
			// This is a quoted cookie as according to RFC2068, unescape
			s = s.slice(1, -1).replace(/\\"/g, '"').replace(/\\\\/g, '\\');
		}
		try {
			return config.json ? JSON.parse(s) : s;
		} catch(er) {}
	}

	var config = $.cookie = function (key, value, options) {

		// write
		if (value !== undefined) {
			options = $.extend({}, config.defaults, options);

			if (typeof options.expires === 'number') {
				var days = options.expires, t = options.expires = new Date();
				t.setDate(t.getDate() + days);
			}

			value = config.json ? JSON.stringify(value) : String(value);

			return (document.cookie = [
				encodeURIComponent(key), '=', config.raw ? value : encodeURIComponent(value),
				options.expires ? '; expires=' + options.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE
				options.path    ? '; path=' + options.path : '',
				options.domain  ? '; domain=' + options.domain : '',
				options.secure  ? '; secure' : ''
			].join(''));
		}

		// read
		var decode = config.raw ? raw : decoded;
		var cookies = document.cookie.split('; ');
		var result = key ? undefined : {};
		for (var i = 0, l = cookies.length; i < l; i++) {
			var parts = cookies[i].split('=');
			var name = decode(parts.shift());
			var cookie = decode(parts.join('='));

			if (key && key === name) {
				result = converted(cookie);
				break;
			}

			if (!key) {
				result[name] = converted(cookie);
			}
		}

		return result;
	};

	config.defaults = {};

	$.removeCookie = function (key, options) {
		if ($.cookie(key) !== undefined) {
			$.cookie(key, '', $.extend(options, { expires: -1 }));
			return true;
		}
		return false;
	};

}));
/*!
 * jQuery resize event - v1.1 - 3/14/2010
 * http://benalman.com/projects/jquery-resize-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */

// Script: jQuery resize event
//
// *Version: 1.1, Last updated: 3/14/2010*
// 
// Project Home - http://benalman.com/projects/jquery-resize-plugin/
// GitHub       - http://github.com/cowboy/jquery-resize/
// Source       - http://github.com/cowboy/jquery-resize/raw/master/jquery.ba-resize.js
// (Minified)   - http://github.com/cowboy/jquery-resize/raw/master/jquery.ba-resize.min.js (1.0kb)
// 
// About: License
// 
// Copyright (c) 2010 "Cowboy" Ben Alman,
// Dual licensed under the MIT and GPL licenses.
// http://benalman.com/about/license/
// 
// About: Examples
// 
// This working example, complete with fully commented code, illustrates a few
// ways in which this plugin can be used.
// 
// resize event - http://benalman.com/code/projects/jquery-resize/examples/resize/
// 
// About: Support and Testing
// 
// Information about what version or versions of jQuery this plugin has been
// tested with, what browsers it has been tested in, and where the unit tests
// reside (so you can test it yourself).
// 
// jQuery Versions - 1.3.2, 1.4.1, 1.4.2
// Browsers Tested - Internet Explorer 6-8, Firefox 2-3.6, Safari 3-4, Chrome, Opera 9.6-10.1.
// Unit Tests      - http://benalman.com/code/projects/jquery-resize/unit/
// 
// About: Release History
// 
// 1.1 - (3/14/2010) Fixed a minor bug that was causing the event to trigger
//       immediately after bind in some circumstances. Also changed $.fn.data
//       to $.data to improve performance.
// 1.0 - (2/10/2010) Initial release

(function($,window,undefined){
  '$:nomunge'; // Used by YUI compressor.
  
  // A jQuery object containing all non-window elements to which the resize
  // event is bound.
  var elems = $([]),
    
    // Extend $.resize if it already exists, otherwise create it.
    jq_resize = $.resize = $.extend( $.resize, {} ),
    
    timeout_id,
    
    // Reused strings.
    str_setTimeout = 'setTimeout',
    str_resize = 'resize',
    str_data = str_resize + '-special-event',
    str_delay = 'delay',
    str_throttle = 'throttleWindow';
  
  // Property: jQuery.resize.delay
  // 
  // The numeric interval (in milliseconds) at which the resize event polling
  // loop executes. Defaults to 250.
  
  jq_resize[ str_delay ] = 250;
  
  // Property: jQuery.resize.throttleWindow
  // 
  // Throttle the native window object resize event to fire no more than once
  // every <jQuery.resize.delay> milliseconds. Defaults to true.
  // 
  // Because the window object has its own resize event, it doesn't need to be
  // provided by this plugin, and its execution can be left entirely up to the
  // browser. However, since certain browsers fire the resize event continuously
  // while others do not, enabling this will throttle the window resize event,
  // making event behavior consistent across all elements in all browsers.
  // 
  // While setting this property to false will disable window object resize
  // event throttling, please note that this property must be changed before any
  // window object resize event callbacks are bound.
  
  jq_resize[ str_throttle ] = true;
  
  // Event: resize event
  // 
  // Fired when an element's width or height changes. Because browsers only
  // provide this event for the window element, for other elements a polling
  // loop is initialized, running every <jQuery.resize.delay> milliseconds
  // to see if elements' dimensions have changed. You may bind with either
  // .resize( fn ) or .bind( "resize", fn ), and unbind with .unbind( "resize" ).
  // 
  // Usage:
  // 
  // > jQuery('selector').bind( 'resize', function(e) {
  // >   // element's width or height has changed!
  // >   ...
  // > });
  // 
  // Additional Notes:
  // 
  // * The polling loop is not created until at least one callback is actually
  //   bound to the 'resize' event, and this single polling loop is shared
  //   across all elements.
  // 
  // Double firing issue in jQuery 1.3.2:
  // 
  // While this plugin works in jQuery 1.3.2, if an element's event callbacks
  // are manually triggered via .trigger( 'resize' ) or .resize() those
  // callbacks may double-fire, due to limitations in the jQuery 1.3.2 special
  // events system. This is not an issue when using jQuery 1.4+.
  // 
  // > // While this works in jQuery 1.4+
  // > $(elem).css({ width: new_w, height: new_h }).resize();
  // > 
  // > // In jQuery 1.3.2, you need to do this:
  // > var elem = $(elem);
  // > elem.css({ width: new_w, height: new_h });
  // > elem.data( 'resize-special-event', { width: elem.width(), height: elem.height() } );
  // > elem.resize();
      
  $.event.special[ str_resize ] = {
    
    // Called only when the first 'resize' event callback is bound per element.
    setup: function() {
      // Since window has its own native 'resize' event, return false so that
      // jQuery will bind the event using DOM methods. Since only 'window'
      // objects have a .setTimeout method, this should be a sufficient test.
      // Unless, of course, we're throttling the 'resize' event for window.
      if ( !jq_resize[ str_throttle ] && this[ str_setTimeout ] ) { return false; }
      
      var elem = $(this);
      
      // Add this element to the list of internal elements to monitor.
      elems = elems.add( elem );
      
      // Initialize data store on the element.
      $.data( this, str_data, { w: elem.width(), h: elem.height() } );
      
      // If this is the first element added, start the polling loop.
      if ( elems.length === 1 ) {
        loopy();
      }
    },
    
    // Called only when the last 'resize' event callback is unbound per element.
    teardown: function() {
      // Since window has its own native 'resize' event, return false so that
      // jQuery will unbind the event using DOM methods. Since only 'window'
      // objects have a .setTimeout method, this should be a sufficient test.
      // Unless, of course, we're throttling the 'resize' event for window.
      if ( !jq_resize[ str_throttle ] && this[ str_setTimeout ] ) { return false; }
      
      var elem = $(this);
      
      // Remove this element from the list of internal elements to monitor.
      elems = elems.not( elem );
      
      // Remove any data stored on the element.
      elem.removeData( str_data );
      
      // If this is the last element removed, stop the polling loop.
      if ( !elems.length ) {
        clearTimeout( timeout_id );
      }
    },
    
    // Called every time a 'resize' event callback is bound per element (new in
    // jQuery 1.4).
    add: function( handleObj ) {
      // Since window has its own native 'resize' event, return false so that
      // jQuery doesn't modify the event object. Unless, of course, we're
      // throttling the 'resize' event for window.
      if ( !jq_resize[ str_throttle ] && this[ str_setTimeout ] ) { return false; }
      
      var old_handler;
      
      // The new_handler function is executed every time the event is triggered.
      // This is used to update the internal element data store with the width
      // and height when the event is triggered manually, to avoid double-firing
      // of the event callback. See the "Double firing issue in jQuery 1.3.2"
      // comments above for more information.
      
      function new_handler( e, w, h ) {
        var elem = $(this),
          data = $.data( this, str_data );
        
        // If called from the polling loop, w and h will be passed in as
        // arguments. If called manually, via .trigger( 'resize' ) or .resize(),
        // those values will need to be computed.
        data.w = w !== undefined ? w : elem.width();
        data.h = h !== undefined ? h : elem.height();
        
        old_handler.apply( this, arguments );
      };
      
      // This may seem a little complicated, but it normalizes the special event
      // .add method between jQuery 1.4/1.4.1 and 1.4.2+
      if ( $.isFunction( handleObj ) ) {
        // 1.4, 1.4.1
        old_handler = handleObj;
        return new_handler;
      } else {
        // 1.4.2+
        old_handler = handleObj.handler;
        handleObj.handler = new_handler;
      }
    }
    
  };
  
  function loopy() {
    
    // Start the polling loop, asynchronously.
    timeout_id = window[ str_setTimeout ](function(){
      
      // Iterate over all elements to which the 'resize' event is bound.
      elems.each(function(){
        var elem = $(this),
          width = elem.width(),
          height = elem.height(),
          data = $.data( this, str_data );
        
        // If element size has changed since the last time, update the element
        // data store and trigger the 'resize' event.
        if ( width !== data.w || height !== data.h ) {
          elem.trigger( str_resize, [ data.w = width, data.h = height ] );
        }
        
      });
      
      // Loop.
      loopy();
      
    }, jq_resize[ str_delay ] );
    
  };
  
})(jQuery,this);
/*!
 * jQuery Transit - CSS3 transitions and transformations
 * (c) 2011-2012 Rico Sta. Cruz <rico@ricostacruz.com>
 * MIT Licensed.
 *
 * http://ricostacruz.com/jquery.transit
 * http://github.com/rstacruz/jquery.transit
 */

(function($) {
  $.transit = {
    version: "0.9.9",

    // Map of $.css() keys to values for 'transitionProperty'.
    // See https://developer.mozilla.org/en/CSS/CSS_transitions#Properties_that_can_be_animated
    propertyMap: {
      marginLeft    : 'margin',
      marginRight   : 'margin',
      marginBottom  : 'margin',
      marginTop     : 'margin',
      paddingLeft   : 'padding',
      paddingRight  : 'padding',
      paddingBottom : 'padding',
      paddingTop    : 'padding'
    },

    // Will simply transition "instantly" if false
    enabled: true,

    // Set this to false if you don't want to use the transition end property.
    useTransitionEnd: false
  };

  var div = document.createElement('div');
  var support = {};

  // Helper function to get the proper vendor property name.
  // (`transition` => `WebkitTransition`)
  function getVendorPropertyName(prop) {
    // Handle unprefixed versions (FF16+, for example)
    if (prop in div.style) return prop;

    var prefixes = ['Moz', 'Webkit', 'O', 'ms'];
    var prop_ = prop.charAt(0).toUpperCase() + prop.substr(1);

    if (prop in div.style) { return prop; }

    for (var i=0; i<prefixes.length; ++i) {
      var vendorProp = prefixes[i] + prop_;
      if (vendorProp in div.style) { return vendorProp; }
    }
  }

  // Helper function to check if transform3D is supported.
  // Should return true for Webkits and Firefox 10+.
  function checkTransform3dSupport() {
    div.style[support.transform] = '';
    div.style[support.transform] = 'rotateY(90deg)';
    return div.style[support.transform] !== '';
  }

  var isChrome = navigator.userAgent.toLowerCase().indexOf('chrome') > -1;

  // Check for the browser's transitions support.
  support.transition      = getVendorPropertyName('transition');
  support.transitionDelay = getVendorPropertyName('transitionDelay');
  support.transform       = getVendorPropertyName('transform');
  support.transformOrigin = getVendorPropertyName('transformOrigin');
  support.transform3d     = checkTransform3dSupport();

  var eventNames = {
    'transition':       'transitionEnd',
    'MozTransition':    'transitionend',
    'OTransition':      'oTransitionEnd',
    'WebkitTransition': 'webkitTransitionEnd',
    'msTransition':     'MSTransitionEnd'
  };

  // Detect the 'transitionend' event needed.
  var transitionEnd = support.transitionEnd = eventNames[support.transition] || null;

  // Populate jQuery's `$.support` with the vendor prefixes we know.
  // As per [jQuery's cssHooks documentation](http://api.jquery.com/jQuery.cssHooks/),
  // we set $.support.transition to a string of the actual property name used.
  for (var key in support) {
    if (support.hasOwnProperty(key) && typeof $.support[key] === 'undefined') {
      $.support[key] = support[key];
    }
  }

  // Avoid memory leak in IE.
  div = null;

  // ## $.cssEase
  // List of easing aliases that you can use with `$.fn.transition`.
  $.cssEase = {
    '_default':       'ease',
    'in':             'ease-in',
    'out':            'ease-out',
    'in-out':         'ease-in-out',
    'snap':           'cubic-bezier(0,1,.5,1)',
    // Penner equations
    'easeOutCubic':   'cubic-bezier(.215,.61,.355,1)',
    'easeInOutCubic': 'cubic-bezier(.645,.045,.355,1)',
    'easeInCirc':     'cubic-bezier(.6,.04,.98,.335)',
    'easeOutCirc':    'cubic-bezier(.075,.82,.165,1)',
    'easeInOutCirc':  'cubic-bezier(.785,.135,.15,.86)',
    'easeInExpo':     'cubic-bezier(.95,.05,.795,.035)',
    'easeOutExpo':    'cubic-bezier(.19,1,.22,1)',
    'easeInOutExpo':  'cubic-bezier(1,0,0,1)',
    'easeInQuad':     'cubic-bezier(.55,.085,.68,.53)',
    'easeOutQuad':    'cubic-bezier(.25,.46,.45,.94)',
    'easeInOutQuad':  'cubic-bezier(.455,.03,.515,.955)',
    'easeInQuart':    'cubic-bezier(.895,.03,.685,.22)',
    'easeOutQuart':   'cubic-bezier(.165,.84,.44,1)',
    'easeInOutQuart': 'cubic-bezier(.77,0,.175,1)',
    'easeInQuint':    'cubic-bezier(.755,.05,.855,.06)',
    'easeOutQuint':   'cubic-bezier(.23,1,.32,1)',
    'easeInOutQuint': 'cubic-bezier(.86,0,.07,1)',
    'easeInSine':     'cubic-bezier(.47,0,.745,.715)',
    'easeOutSine':    'cubic-bezier(.39,.575,.565,1)',
    'easeInOutSine':  'cubic-bezier(.445,.05,.55,.95)',
    'easeInBack':     'cubic-bezier(.6,-.28,.735,.045)',
    'easeOutBack':    'cubic-bezier(.175, .885,.32,1.275)',
    'easeInOutBack':  'cubic-bezier(.68,-.55,.265,1.55)'
  };

  // ## 'transform' CSS hook
  // Allows you to use the `transform` property in CSS.
  //
  //     $("#hello").css({ transform: "rotate(90deg)" });
  //
  //     $("#hello").css('transform');
  //     //=> { rotate: '90deg' }
  //
  $.cssHooks['transit:transform'] = {
    // The getter returns a `Transform` object.
    get: function(elem) {
      return $(elem).data('transform') || new Transform();
    },

    // The setter accepts a `Transform` object or a string.
    set: function(elem, v) {
      var value = v;

      if (!(value instanceof Transform)) {
        value = new Transform(value);
      }

      // We've seen the 3D version of Scale() not work in Chrome when the
      // element being scaled extends outside of the viewport.  Thus, we're
      // forcing Chrome to not use the 3d transforms as well.  Not sure if
      // translate is affectede, but not risking it.  Detection code from
      // http://davidwalsh.name/detecting-google-chrome-javascript
      if (support.transform === 'WebkitTransform' && !isChrome) {
        elem.style[support.transform] = value.toString(true);
      } else {
        elem.style[support.transform] = value.toString();
      }

      $(elem).data('transform', value);
    }
  };

  // Add a CSS hook for `.css({ transform: '...' })`.
  // In jQuery 1.8+, this will intentionally override the default `transform`
  // CSS hook so it'll play well with Transit. (see issue #62)
  $.cssHooks.transform = {
    set: $.cssHooks['transit:transform'].set
  };

  // jQuery 1.8+ supports prefix-free transitions, so these polyfills will not
  // be necessary.
  if ($.fn.jquery < "1.8") {
    // ## 'transformOrigin' CSS hook
    // Allows the use for `transformOrigin` to define where scaling and rotation
    // is pivoted.
    //
    //     $("#hello").css({ transformOrigin: '0 0' });
    //
    $.cssHooks.transformOrigin = {
      get: function(elem) {
        return elem.style[support.transformOrigin];
      },
      set: function(elem, value) {
        elem.style[support.transformOrigin] = value;
      }
    };

    // ## 'transition' CSS hook
    // Allows you to use the `transition` property in CSS.
    //
    //     $("#hello").css({ transition: 'all 0 ease 0' });
    //
    $.cssHooks.transition = {
      get: function(elem) {
        return elem.style[support.transition];
      },
      set: function(elem, value) {
        elem.style[support.transition] = value;
      }
    };
  }

  // ## Other CSS hooks
  // Allows you to rotate, scale and translate.
  registerCssHook('scale');
  registerCssHook('translate');
  registerCssHook('rotate');
  registerCssHook('rotateX');
  registerCssHook('rotateY');
  registerCssHook('rotate3d');
  registerCssHook('perspective');
  registerCssHook('skewX');
  registerCssHook('skewY');
  registerCssHook('x', true);
  registerCssHook('y', true);

  // ## Transform class
  // This is the main class of a transformation property that powers
  // `$.fn.css({ transform: '...' })`.
  //
  // This is, in essence, a dictionary object with key/values as `-transform`
  // properties.
  //
  //     var t = new Transform("rotate(90) scale(4)");
  //
  //     t.rotate             //=> "90deg"
  //     t.scale              //=> "4,4"
  //
  // Setters are accounted for.
  //
  //     t.set('rotate', 4)
  //     t.rotate             //=> "4deg"
  //
  // Convert it to a CSS string using the `toString()` and `toString(true)` (for WebKit)
  // functions.
  //
  //     t.toString()         //=> "rotate(90deg) scale(4,4)"
  //     t.toString(true)     //=> "rotate(90deg) scale3d(4,4,0)" (WebKit version)
  //
  function Transform(str) {
    if (typeof str === 'string') { this.parse(str); }
    return this;
  }

  Transform.prototype = {
    // ### setFromString()
    // Sets a property from a string.
    //
    //     t.setFromString('scale', '2,4');
    //     // Same as set('scale', '2', '4');
    //
    setFromString: function(prop, val) {
      var args =
        (typeof val === 'string')  ? val.split(',') :
        (val.constructor === Array) ? val :
        [ val ];

      args.unshift(prop);

      Transform.prototype.set.apply(this, args);
    },

    // ### set()
    // Sets a property.
    //
    //     t.set('scale', 2, 4);
    //
    set: function(prop) {
      var args = Array.prototype.slice.apply(arguments, [1]);
      if (this.setter[prop]) {
        this.setter[prop].apply(this, args);
      } else {
        this[prop] = args.join(',');
      }
    },

    get: function(prop) {
      if (this.getter[prop]) {
        return this.getter[prop].apply(this);
      } else {
        return this[prop] || 0;
      }
    },

    setter: {
      // ### rotate
      //
      //     .css({ rotate: 30 })
      //     .css({ rotate: "30" })
      //     .css({ rotate: "30deg" })
      //     .css({ rotate: "30deg" })
      //
      rotate: function(theta) {
        this.rotate = unit(theta, 'deg');
      },

      rotateX: function(theta) {
        this.rotateX = unit(theta, 'deg');
      },

      rotateY: function(theta) {
        this.rotateY = unit(theta, 'deg');
      },

      // ### scale
      //
      //     .css({ scale: 9 })      //=> "scale(9,9)"
      //     .css({ scale: '3,2' })  //=> "scale(3,2)"
      //
      scale: function(x, y) {
        if (y === undefined) { y = x; }
        this.scale = x + "," + y;
      },

      // ### skewX + skewY
      skewX: function(x) {
        this.skewX = unit(x, 'deg');
      },

      skewY: function(y) {
        this.skewY = unit(y, 'deg');
      },

      // ### perspectvie
      perspective: function(dist) {
        this.perspective = unit(dist, 'px');
      },

      // ### x / y
      // Translations. Notice how this keeps the other value.
      //
      //     .css({ x: 4 })       //=> "translate(4px, 0)"
      //     .css({ y: 10 })      //=> "translate(4px, 10px)"
      //
      x: function(x) {
        this.set('translate', x, null);
      },

      y: function(y) {
        this.set('translate', null, y);
      },

      // ### translate
      // Notice how this keeps the other value.
      //
      //     .css({ translate: '2, 5' })    //=> "translate(2px, 5px)"
      //
      translate: function(x, y) {
        if (this._translateX === undefined) { this._translateX = 0; }
        if (this._translateY === undefined) { this._translateY = 0; }

        if (x !== null && x !== undefined) { this._translateX = unit(x, 'px'); }
        if (y !== null && y !== undefined) { this._translateY = unit(y, 'px'); }

        this.translate = this._translateX + "," + this._translateY;
      }
    },

    getter: {
      x: function() {
        return this._translateX || 0;
      },

      y: function() {
        return this._translateY || 0;
      },

      scale: function() {
        var s = (this.scale || "1,1").split(',');
        if (s[0]) { s[0] = parseFloat(s[0]); }
        if (s[1]) { s[1] = parseFloat(s[1]); }

        // "2.5,2.5" => 2.5
        // "2.5,1" => [2.5,1]
        return (s[0] === s[1]) ? s[0] : s;
      },

      rotate3d: function() {
        var s = (this.rotate3d || "0,0,0,0deg").split(',');
        for (var i=0; i<=3; ++i) {
          if (s[i]) { s[i] = parseFloat(s[i]); }
        }
        if (s[3]) { s[3] = unit(s[3], 'deg'); }

        return s;
      }
    },

    // ### parse()
    // Parses from a string. Called on constructor.
    parse: function(str) {
      var self = this;
      str.replace(/([a-zA-Z0-9]+)\((.*?)\)/g, function(x, prop, val) {
        self.setFromString(prop, val);
      });
    },

    // ### toString()
    // Converts to a `transition` CSS property string. If `use3d` is given,
    // it converts to a `-webkit-transition` CSS property string instead.
    toString: function(use3d) {
      var re = [];

      for (var i in this) {
        if (this.hasOwnProperty(i)) {
          // Don't use 3D transformations if the browser can't support it.
          if ((!support.transform3d) && (
            (i === 'rotateX') ||
            (i === 'rotateY') ||
            (i === 'perspective') ||
            (i === 'transformOrigin'))) { continue; }

          if (i[0] !== '_') {
            if (use3d && (i === 'scale')) {
              re.push(i + "3d(" + this[i] + ",1)");
            } else if (use3d && (i === 'translate')) {
              re.push(i + "3d(" + this[i] + ",0)");
            } else {
              re.push(i + "(" + this[i] + ")");
            }
          }
        }
      }

      return re.join(" ");
    }
  };

  function callOrQueue(self, queue, fn) {
    if (queue === true) {
      self.queue(fn);
    } else if (queue) {
      self.queue(queue, fn);
    } else {
      fn();
    }
  }

  // ### getProperties(dict)
  // Returns properties (for `transition-property`) for dictionary `props`. The
  // value of `props` is what you would expect in `$.css(...)`.
  function getProperties(props) {
    var re = [];

    $.each(props, function(key) {
      key = $.camelCase(key); // Convert "text-align" => "textAlign"
      key = $.transit.propertyMap[key] || $.cssProps[key] || key;
      key = uncamel(key); // Convert back to dasherized

      if ($.inArray(key, re) === -1) { re.push(key); }
    });

    return re;
  }

  // ### getTransition()
  // Returns the transition string to be used for the `transition` CSS property.
  //
  // Example:
  //
  //     getTransition({ opacity: 1, rotate: 30 }, 500, 'ease');
  //     //=> 'opacity 500ms ease, -webkit-transform 500ms ease'
  //
  function getTransition(properties, duration, easing, delay) {
    // Get the CSS properties needed.
    var props = getProperties(properties);

    // Account for aliases (`in` => `ease-in`).
    if ($.cssEase[easing]) { easing = $.cssEase[easing]; }

    // Build the duration/easing/delay attributes for it.
    var attribs = '' + toMS(duration) + ' ' + easing;
    if (parseInt(delay, 10) > 0) { attribs += ' ' + toMS(delay); }

    // For more properties, add them this way:
    // "margin 200ms ease, padding 200ms ease, ..."
    var transitions = [];
    $.each(props, function(i, name) {
      transitions.push(name + ' ' + attribs);
    });

    return transitions.join(', ');
  }

  // ## $.fn.transition
  // Works like $.fn.animate(), but uses CSS transitions.
  //
  //     $("...").transition({ opacity: 0.1, scale: 0.3 });
  //
  //     // Specific duration
  //     $("...").transition({ opacity: 0.1, scale: 0.3 }, 500);
  //
  //     // With duration and easing
  //     $("...").transition({ opacity: 0.1, scale: 0.3 }, 500, 'in');
  //
  //     // With callback
  //     $("...").transition({ opacity: 0.1, scale: 0.3 }, function() { ... });
  //
  //     // With everything
  //     $("...").transition({ opacity: 0.1, scale: 0.3 }, 500, 'in', function() { ... });
  //
  //     // Alternate syntax
  //     $("...").transition({
  //       opacity: 0.1,
  //       duration: 200,
  //       delay: 40,
  //       easing: 'in',
  //       complete: function() { /* ... */ }
  //      });
  //
  $.fn.transition = $.fn.transit = function(properties, duration, easing, callback) {
    var self  = this;
    var delay = 0;
    var queue = true;

    // Account for `.transition(properties, callback)`.
    if (typeof duration === 'function') {
      callback = duration;
      duration = undefined;
    }

    // Account for `.transition(properties, duration, callback)`.
    if (typeof easing === 'function') {
      callback = easing;
      easing = undefined;
    }

    // Alternate syntax.
    if (typeof properties.easing !== 'undefined') {
      easing = properties.easing;
      delete properties.easing;
    }

    if (typeof properties.duration !== 'undefined') {
      duration = properties.duration;
      delete properties.duration;
    }

    if (typeof properties.complete !== 'undefined') {
      callback = properties.complete;
      delete properties.complete;
    }

    if (typeof properties.queue !== 'undefined') {
      queue = properties.queue;
      delete properties.queue;
    }

    if (typeof properties.delay !== 'undefined') {
      delay = properties.delay;
      delete properties.delay;
    }

    // Set defaults. (`400` duration, `ease` easing)
    if (typeof duration === 'undefined') { duration = $.fx.speeds._default; }
    if (typeof easing === 'undefined')   { easing = $.cssEase._default; }

    duration = toMS(duration);

    // Build the `transition` property.
    var transitionValue = getTransition(properties, duration, easing, delay);

    // Compute delay until callback.
    // If this becomes 0, don't bother setting the transition property.
    var work = $.transit.enabled && support.transition;
    var i = work ? (parseInt(duration, 10) + parseInt(delay, 10)) : 0;

    // If there's nothing to do...
    if (i === 0) {
      var fn = function(next) {
        self.css(properties);
        if (callback) { callback.apply(self); }
        if (next) { next(); }
      };

      callOrQueue(self, queue, fn);
      return self;
    }

    // Save the old transitions of each element so we can restore it later.
    var oldTransitions = {};

    var run = function(nextCall) {
      var bound = false;

      // Prepare the callback.
      var cb = function() {
        if (bound) { self.unbind(transitionEnd, cb); }

        if (i > 0) {
          self.each(function() {
            this.style[support.transition] = (oldTransitions[this] || null);
          });
        }

        if (typeof callback === 'function') { callback.apply(self); }
        if (typeof nextCall === 'function') { nextCall(); }
      };

      if ((i > 0) && (transitionEnd) && ($.transit.useTransitionEnd)) {
        // Use the 'transitionend' event if it's available.
        bound = true;
        self.bind(transitionEnd, cb);
      } else {
        // Fallback to timers if the 'transitionend' event isn't supported.
        window.setTimeout(cb, i);
      }

      // Apply transitions.
      self.each(function() {
        if (i > 0) {
          this.style[support.transition] = transitionValue;
        }
        $(this).css(properties);
      });
    };

    // Defer running. This allows the browser to paint any pending CSS it hasn't
    // painted yet before doing the transitions.
    var deferredRun = function(next) {
        this.offsetWidth; // force a repaint
        run(next);
    };

    // Use jQuery's fx queue.
    callOrQueue(self, queue, deferredRun);

    // Chainability.
    return this;
  };

  function registerCssHook(prop, isPixels) {
    // For certain properties, the 'px' should not be implied.
    if (!isPixels) { $.cssNumber[prop] = true; }

    $.transit.propertyMap[prop] = support.transform;

    $.cssHooks[prop] = {
      get: function(elem) {
        var t = $(elem).css('transit:transform');
        return t.get(prop);
      },

      set: function(elem, value) {
        var t = $(elem).css('transit:transform');
        t.setFromString(prop, value);

        $(elem).css({ 'transit:transform': t });
      }
    };

  }

  // ### uncamel(str)
  // Converts a camelcase string to a dasherized string.
  // (`marginLeft` => `margin-left`)
  function uncamel(str) {
    return str.replace(/([A-Z])/g, function(letter) { return '-' + letter.toLowerCase(); });
  }

  // ### unit(number, unit)
  // Ensures that number `number` has a unit. If no unit is found, assume the
  // default is `unit`.
  //
  //     unit(2, 'px')          //=> "2px"
  //     unit("30deg", 'rad')   //=> "30deg"
  //
  function unit(i, units) {
    if ((typeof i === "string") && (!i.match(/^[\-0-9\.]+$/))) {
      return i;
    } else {
      return "" + i + units;
    }
  }

  // ### toMS(duration)
  // Converts given `duration` to a millisecond string.
  //
  //     toMS('fast')   //=> '400ms'
  //     toMS(10)       //=> '10ms'
  //
  function toMS(duration) {
    var i = duration;

    // Allow for string durations like 'fast'.
    if ($.fx.speeds[i]) { i = $.fx.speeds[i]; }

    return unit(i, 'ms');
  }

  // Export some functions for testable-ness.
  $.transit.getTransitionValue = getTransition;
})(jQuery);
/*! JsRender v1.0pre: http://github.com/BorisMoore/jsrender */
/*
* Optimized version of jQuery Templates, for rendering to string.
* Does not require jQuery, or HTML DOM
* Integrates with JsViews (http://github.com/BorisMoore/jsviews)
* Copyright 2012, Boris Moore
* Released under the MIT License.
*/
// informal pre beta commit counter: 22

(function(global, jQuery, undefined) {
	// global is the this object, which is window when running in the usual browser environment.
	"use strict";

	if (jQuery && jQuery.views || global.jsviews) { return; } // JsRender is already loaded

	//========================== Top-level vars ==========================

	var versionNumber = "v1.0pre",

		$, jsvStoreName, rTag, rTmplString,
//TODO	tmplFnsCache = {},
		delimOpenChar0 = "{", delimOpenChar1 = "{", delimCloseChar0 = "}", delimCloseChar1 = "}", linkChar = "^",
		FALSE = false, TRUE = true,

		rPath = /^(?:null|true|false|\d[\d.]*|([\w$]+|\.|~([\w$]+)|#(view|([\w$]+))?)([\w$.^]*?)(?:[.[^]([\w$]+)\]?)?)$/g,
		//                                     object     helper    view  viewProperty pathTokens      leafToken

		rParams = /(\()(?=|\s*\()|(?:([([])\s*)?(?:([#~]?[\w$.^]+)?\s*((\+\+|--)|\+|-|&&|\|\||===|!==|==|!=|<=|>=|[<>%*!:?\/]|(=))\s*|([#~]?[\w$.^]+)([([])?)|(,\s*)|(\(?)\\?(?:(')|("))|(?:\s*([)\]])([([]?))|(\s+)/g,
		//          lftPrn        lftPrn2                 path    operator err                                                eq          path2       prn    comma   lftPrn2   apos quot        rtPrn   prn2   space
		// (left paren? followed by (path? followed by operator) or (path followed by paren?)) or comma or apos or quot or right paren or space

		rNewLine = /\r?\n/g,
		rUnescapeQuotes = /\\(['"])/g,
		// escape quotes and \ character
		rEscapeQuotes = /([\\'"])/g,
		rBuildHash = /\x08(~)?([^\x08]+)\x08/g,
		rTestElseIf = /^if\s/,
		rFirstElem = /<(\w+)[>\s]/,
		rPrevElem = /<(\w+)[^>\/]*>[^>]*$/,
		autoTmplName = 0,
		viewId = 0,
		escapeMapForHtml = {
			"&": "&amp;",
			"<": "&lt;",
			">": "&gt;"
		},
        attrEncodeChars = /[<"'&]/g,
		htmlEncodeChars = /[\x00<>"'&]/g,
		tmplAttr = "data-jsv-tmpl",
		fnDeclStr = "var j=j||" + (jQuery ? "jQuery." : "js") + "views,",
		slice = [].slice,

		$render = {},
		jsvStores = {
			template: {
				compile: compileTmpl
			},
			tag: {
				compile: compileTag
			},
			helper: {},
			converter: {}
		},

		// jsviews object ($.views if jQuery is loaded)
		$views = {
			jsviews: versionNumber,
			render: $render,
			View: View,
			settings: {
				delimiters: $viewsDelimiters,
				debugMode: TRUE
			},
			sub: {
				// subscription, e.g. JsViews integration
				Error: JsViewsError,
				tmplFn: tmplFn,
				parse: parseParams,
				extend: $extend,
				error: error
//TODO			invoke: $invoke
			},
			_cnvt: convertVal,
			_tag: renderTag,

			// TODO provide better debug experience - e.g. support $.views.onError callback
			_err: function(e) {
				// Place a breakpoint here to intercept template rendering errors
				return $viewsSettings.debugMode ? ("Error: " + (e.message || e)) + ". " : '';
			}
		};

		function JsViewsError(message, object) {
			// Error exception type for JsViews/JsRender
			// Override of $.views.sub.Error is possible
			if (object && object.onError) {
				if (object.onError(message) === FALSE) {
					return;
				}
			}
			this.name = "JsRender Error";
			this.message = message || "JsRender error";
		}

		function $extend(target, source) {
			var name;
			target = target || {};
			for (name in source) {
				target[name] = source[name];
			}
			return target;
		}

//TODO		function $invoke() {
//			try {
//				return arguments[1].apply(arguments[0], arguments[2]);
//			}
//			catch(e) {
//				throw new $views.sub.Error(e, arguments[0]);
//			}
//		}

		(JsViewsError.prototype = new Error()).constructor = JsViewsError;

	//========================== Top-level functions ==========================

	//===================
	// jsviews.delimiters
	//===================

	function $viewsDelimiters(openChars, closeChars, link) {
		// Set the tag opening and closing delimiters and 'link' character. Default is "{{", "}}" and "^"
		// openChars, closeChars: opening and closing strings, each with two characters

		if (!$views.rTag || arguments.length) {
			delimOpenChar0 = openChars ? openChars.charAt(0) : delimOpenChar0; // Escape the characters - since they could be regex special characters
			delimOpenChar1 = openChars ? openChars.charAt(1) : delimOpenChar1;
			delimCloseChar0 = closeChars ? closeChars.charAt(0) : delimCloseChar0;
			delimCloseChar1 = closeChars ? closeChars.charAt(1) : delimCloseChar1;
			linkChar = link || linkChar;
			openChars = "\\" + delimOpenChar0 + "(\\" + linkChar + ")?\\" + delimOpenChar1;  // Default is "{^{"
			closeChars = "\\" + delimCloseChar0 + "\\" + delimCloseChar1;                   // Default is "}}"
			// Build regex with new delimiters
			//          tag    (followed by / space or })   or cvtr+colon or html or code
			rTag = "(?:(?:(\\w+(?=[\\/\\s\\" + delimCloseChar0 + "]))|(?:(\\w+)?(:)|(>)|!--((?:[^-]|-(?!-))*)--|(\\*)))"
				+ "\\s*((?:[^\\" + delimCloseChar0 + "]|\\" + delimCloseChar0 + "(?!\\" + delimCloseChar1 + "))*?)";

			// make rTag available to JsViews (or other components) for parsing binding expressions
			$views.rTag = rTag + ")";

			rTag = new RegExp(openChars + rTag + "(\\/)?|(?:\\/(\\w+)))" + closeChars, "g");

			// Default:    bind           tag       converter colon html     comment            code      params            slash   closeBlock
			//           /{(\^)?{(?:(?:(\w+(?=[\/\s}]))|(?:(\w+)?(:)|(>)|!--((?:[^-]|-(?!-))*)--|(\*)))\s*((?:[^}]|}(?!}))*?)(\/)?|(?:\/(\w+)))}}/g

			rTmplString = new RegExp("<.*>|([^\\\\]|^)[{}]|" + openChars + ".*" + closeChars);
			// rTmplString looks for html tags or { or } char not preceded by \\, or JsRender tags {{xxx}}. Each of these strings are considered NOT to be jQuery selectors
		}
		return [delimOpenChar0, delimOpenChar1, delimCloseChar0, delimCloseChar1, linkChar];
	}

	//=========
	// View.get
	//=========

	function getView(type) {
		// TODO complete/test/provide samples for this
		// If type is undefined, returns root view (view under top view).
		var view = this,
			root = !type || type === "root";
		while (root && view.parent.parent || view && view.type !== type) {
			view = view.parent;
		}
		return view;
	}

	//==========
	// View._hlp
	//==========

	function getHelper(helper) {
		// Helper method called as view._hlp(key) from compiled template, for helper functions or template parameters ~foo
		var wrapped,
			view = this,
			viewCtx = view.ctx ||{},
			tmplHelpers = view.tmpl.helpers || {};

		helper = (
			viewCtx[helper] !== undefined
				? viewCtx
				: tmplHelpers[helper] !== undefined
					? tmplHelpers
					: $helpers[helper] !== undefined
						? $helpers
						: {}
		)[helper];

		if (helper) {
			if (typeof helper === "function") {
				wrapped = function() {
						// If it is of type function, we will wrap it so it gets called with view as 'this' context.
						// If the helper ~foo() was in a data-link expression, the view will have a 'temporary' linkCtx property too.
						// However note that helper functions on deeper paths will not have access to view and tagCtx.
						// For example, ~util.foo() will have the ~util object as 'this' pointer
						var i,
							args = arguments;

						for (i in args) {
							if (typeof args[i] === "function") {
								args[i] = args[i].call(view.data);
							}
						}
						return helper.apply(view, args);
					};
				wrapped.depends = helper.depends;
			}
		}
		return wrapped || helper;
	}

	//==============
	// jsviews._cnvt
	//==============

	function convertVal(converter, view, self, tagCtx, bindingPaths, text) {
		// self is template object or linkCtx object
		if (converter || bindingPaths) {
			var tmplConverter,
				linkCtx = !self.markup && self,
				tag = {
					tagName:  converter + ":",
					tagCtx: tagCtx
				},
				args = tagCtx.args = slice.call(arguments, 5);

			tagCtx.view = view;
			tagCtx.bind = !!(linkCtx || bindingPaths);

			if (linkCtx) {
				linkCtx.tag = tag;
				tag.linkCtx = linkCtx;
				tagCtx.ctx = extendCtx(tagCtx.ctx, linkCtx.view.ctx);
			}
			tag.ctx = tagCtx.ctx || {};
			delete tagCtx.ctx;

			if (converter) {
				// A call to {{cnvt: ... }} or {^{cnvt: ... }} or data-link="{cnvt: ... }"
				tmplConverter = view.tmpl.converters;
				tmplConverter = tmplConverter && tmplConverter[converter] || $converters[converter];
				if (tmplConverter || error("Unknown converter: {{"+ converter + ":")) {
					text = tmplConverter.apply(tag, args);
				}
			}
			if (bindingPaths) {
				// A call to {^{: ... }} or {^{cnvt: ... }}
				bindingPaths = view.tmpl.bnds[bindingPaths-1];
				linkCtx.paths = bindingPaths;
				// Consider being able to switch off binding if parent view is not currently bound.
				view._.tag = tag; // Provide this tag on view, for markerNode on bound tags, and for getting the tagCtx and linkCtx during rendering.
				// Provide this tag on view, for addMarkerNode on bound tags to add the tag to view._.bnds, associated with the tag id,
				// and so when rendering subsequent {{else}}, will be associated with this tag
				//TODO does this work with nested elses and with {^{foo:...}} which also adds tag to view, for markerNodes.
				text = view._.onRender(text, view, TRUE);
	//Example:  text = '<script type="jsv123"></script>' + text + '<script type="jsv123/"></script>';
			}
		}
		return text;
	}

	//=============
	// jsviews._tag
	//=============

	function renderTag(tagName, parentView, self, content, tagCtx, bind) {
		// Called from within compiled template function, to render a template tag
		// Returns the rendered tag

		var ret, render, ctx, elses, tag, tags,
			tmpl = self.markup && self,
			// self is either a template object (if rendering a tag) or a linkCtx object (if linking using a link tag)
			linkCtx = !tmpl && self,
			parentView_ = parentView._,
			parentTmpl = tmpl || parentView.tmpl,
			tmplTags = parentTmpl.tags,
			childTemplates = parentTmpl.templates,
			tagDef = tmplTags && tmplTags[tagName] || $tags[tagName],
			args = tagCtx.args = arguments.length > 6 ? slice.call(arguments, 6) : [],
			props = tagCtx.props || {};

		tagCtx.view = parentView;
		tagCtx.ctx = extendCtx(tagCtx.ctx, parentView.ctx); // Extend parentView.ctx
		ctx = tagCtx.ctx || {};
		delete tagCtx.ctx;

		if (!tagDef) {
			error("Unknown tag: {{"+ tagName + "}}");
			return "";
		}
		tmpl = props.tmpl;

		// Set the tmpl property to the content of the block tag, unless set as an override property on the tag
		content = content && parentTmpl.tmpls[content - 1];
		tmpl = tmpl || content || tagDef.template || undefined;
		tmpl = "" + tmpl === tmpl // if a string
			? childTemplates && childTemplates[tmpl] || $templates[tmpl] || $templates(tmpl)
			: tmpl;

		if (tagName === "else") {
			tag = parentView._.tag;
			// Switch current tagCtx of tag instance to this {{else ...}}
			elses = tag._elses = tag._elses || [];
			elses.push(tmpl);
			tagCtx.isElse = elses.length;
			render = tag.render;
		}
		if (tagDef.init) {
			// init is the constructor for the tag/control instance

			// tags hash: tag.ctx.tags, merged with parentView.ctx.tags,
			tags = ctx.tags = parentView.ctx && extendCtx(ctx.tags, parentView.ctx.tags) || {};

			tag = tag || linkCtx.tag;
			if (tag) {
				// tag has already been instantiated, so keep it, but attach the current context, which may have changed
				// Add tag to tags hash
				tags[tagName] = tag;
			} else {
				// If the tag has not already been instantiated, we will create a new instance and add to the tags hash,
				// so ~tags.tagName will access the tag, even within the rendering of the template content of this tag
//	TODO provide error handling owned by the tag - using tag.onError
//			try {
					tag = tags[tagName] = new tagDef.init(tagCtx, linkCtx, ctx);
//				}
//				catch(e) {
//					tagDef.onError(e);
//				}
				tag.tmpl = tmpl;

				if (linkCtx) {
					tag.attr =
						// Setting attr on tag so renderContent knows whether to include script node markers.
						linkCtx.attr =
							// Setting attr on self to ensure outputting to the correct target attribute.
							linkCtx.attr || tagDef.attr || "";
				}
			}
			ctx.tag = tag;
		} else {
			// This is a simple tag declared as a function. We won't instantiate a specific tag constructor - just a standard instance object.
			tag = tag || {
				// tag instance object if no init constructor
				render: tagDef.render,
				renderContent: renderContent,
				tmpl: tmpl,
				tagName: tagName
			};
		}

		// Provide tagCtx, linkCtx and ctx access from tag
		tag.tagCtx = tagCtx;
		tag.ctx = ctx;
		if (linkCtx) {
			linkCtx.tag = tag;
			tag.linkCtx = linkCtx;
		}

		tag._is = "tag";
		tag._done = tagCtx.isElse ? tag._done : FALSE; // If not an {{else}} this is a new
		tmpl = tmpl || tag.tmpl;
		elses = tag._elses;

//TODO The above works for initial rendering, but when refreshing {^{foo}} need also to associate with {{else}} tags. Use compilation to bind else content templates and expressions with the primary tag template and expression.

		parentView_.tag = tag;
		// Provide this tag on view, for addMarkerNode on bound tags to add the tag to view._.bnds, associated with the tag id,
		// for getting the tagCtx and linkCtx during rendering, and so when rendering subsequent {{else}}, will be associated with this tag
		//TODO does this work with nested elses and with {^{foo:...}} which also adds tag to view, for markerNodes.

//		while (tmpl) {
			// If tagDef has a 'render' function, call it.
			// If the return result is undefined, return "", or, if a template (or content) is provided,
			// return the rendered template(using the current data or the first parameter as data);
			if (render = render || tag.render) {
				ret = render.apply(tag, args);

//	TODO		ret = $invoke(tag, render, args);
			}
			ret = ret !== undefined
				? ret    // Return result of render function unless it is undefined, in which case return rendered template
				: tmpl
					// render template on args[0] if defined, or otherwise on the current data item
					? tag.renderContent(tagCtx.data !== undefined ? tagCtx.data : parentView.data, undefined, parentView)
					: ""; // No return value from render, and no template defined, so return ::

//			tmpl = (tag !== "else" && elses) ? (tagCtx.isElse = tagCtx.isElse || 0, elses[tagCtx.isElse++]) : undefined;
//}

		// If bind, for {^{tag ... }}, insert script marker nodes
		return bind ? parentView_.onRender(ret, parentView, bind) : ret;
	}

	//=================
	// View constructor
	//=================

	function View(context, type, parentView, data, template, key, onRender) {
		// Constructor for view object in view hierarchy. (Augmented by JsViews if JsViews is loaded)
		var views, parentView_,
			isArray = type === "array",
			self_ = {
				key: 0,
				useKey: isArray ? 0 : 1,
				id: "" + viewId++,
				onRender: onRender,
				bnd: {}
			},
			self = {
				data: data,
				tmpl: template,
				views: isArray ? [] : {},
				parent: parentView,
				ctx: context,
				type: type,
				// If the data is an array, this is an 'array view' with a views array for each child 'item view'
				// If the data is not an array, this is an 'item view' with a views 'map' object for any child nested views
				// _useKey is non zero if is not an 'array view' (owning a data array). Uuse this as next key for adding to child views map
				get: getView,
				_hlp: getHelper,
				_: self_
		};

		if (parentView) {
			views = parentView.views;
			parentView_ = parentView._;
			if (parentView_.useKey) {
				// Parent is an 'item view'. Add this view to its views object
				// self._key = is the key in the parent view map
				views[self_.key = "_" + parentView_.useKey++] = self;
			} else {
				// Parent is an 'array view'. Add this view to its views array
				views.splice(
					// self._.key = self.index - the index in the parent view array
					self_.key = self.index =
						key !== undefined
							? key
							: views.length,
				0, self);
			}
			// If no context was passed in, use parent context
			// If context was passed in, it should have been merged already with parent context
			self.ctx = context || parentView.ctx;
		}
		return self;
	}

	//=============
	// Registration
	//=============

	function compileChildResources(parentTmpl) {
		var storeName, resources, resourceName, settings, compile;
		for (storeName in jsvStores) {
			settings = jsvStores[storeName];
			if ((compile = settings.compile) && (resources = parentTmpl[storeName + "s"])) {
				for (resourceName in resources) {
					// compile child resource declarations (templates, tags, converters or helpers)
					resources[resourceName] = compile(resourceName, resources[resourceName], parentTmpl, storeName, settings);
				}
			}
		}
	}

	function compileTag(name, item, parentTmpl) {
		var init, tmpl;
		if (typeof item === "function") {
			// Simple tag declared as function. No presenter instantation.
			item = {
				tagName: name,
				render: item,
				depends: item.depends
			};
		} else {
			// Tag declared as object, used as the prototype for tag instantiation (control/presenter)
			item.tagName = name;
			if (tmpl = item.template) {
				item.template = "" + tmpl === tmpl ? ($templates[tmpl] || $templates(tmpl)) : tmpl;
			}
			if (item.init !== FALSE) {
				init = item.init = item.init || function(tagCtx) {};
				init.prototype = item;
				(init.prototype = item).constructor = init;
			}
		}
		item.renderContent = renderContent;
		item.attr = "html";
		if (parentTmpl) {
			item._parentTmpl = parentTmpl;
		}
//TODO	item.onError = function(e) {
//			var error;
//			if (error = this.prototype.onError) {
//				error.call(this, e);
//			} else {
//				throw e;
//			}
//		}
		return item;
	}

	function compileTmpl(name, tmpl, parentTmpl, storeName, storeSettings, options) {
		// tmpl is either a template object, a selector for a template script block, the name of a compiled template, or a template object

		//==== nested functions ====
		function tmplOrMarkupFromStr(value) {
			// If value is of type string - treat as selector, or name of compiled template
			// Return the template object, if already compiled, or the markup string

			if (("" + value === value) || value.nodeType > 0) {
				try {
					elem = value.nodeType > 0
					? value
					: !rTmplString.test(value)
					// If value is a string and does not contain HTML or tag content, then test as selector
						&& jQuery && jQuery(value)[0];
					// If selector is valid and returns at least one element, get first element
					// If invalid, jQuery will throw. We will stay with the original string.
				} catch (e) { }

				if (elem) {
					// Generally this is a script element.
					// However we allow it to be any element, so you can for example take the content of a div,
					// use it as a template, and replace it by the same content rendered against data.
					// e.g. for linking the content of a div to a container, and using the initial content as template:
					// $.link("#content", model, {tmpl: "#content"});

					// Create a name for compiled template if none provided
					value = $templates[elem.getAttribute(tmplAttr)];
					if (!value) {
						// Not already compiled and cached, so compile and cache the name
						name = name || "_" + autoTmplName++;
						elem.setAttribute(tmplAttr, name);
						$templates[name] = value = compileTmpl(name, elem.innerHTML, parentTmpl, storeName, storeSettings, options); // Use tmpl as options
					}
				}
				return value;
			}
			// If value is not a string, return undefined
		}

		var tmplOrMarkup, elem;

		//==== Compile the template ====
		tmpl = tmpl || "";
		tmplOrMarkup = tmplOrMarkupFromStr(tmpl);

		// If options, then this was already compiled from a (script) element template declaration.
		// If not, then if tmpl is a template object, use it for options
		options = options || (tmpl.markup ? tmpl : {});
		options.tmplName = name;
		if (parentTmpl) {
			options._parentTmpl = parentTmpl;
		}
		// If tmpl is not a markup string or a selector string, then it must be a template object
		// In that case, get it from the markup property of the object
		if (!tmplOrMarkup && tmpl.markup && (tmplOrMarkup = tmplOrMarkupFromStr(tmpl.markup))) {
			if (tmplOrMarkup.fn && (tmplOrMarkup.debug !== tmpl.debug || tmplOrMarkup.allowCode !== tmpl.allowCode)) {
				// if the string references a compiled template object, but the debug or allowCode props are different, need to recompile
				tmplOrMarkup = tmplOrMarkup.markup;
			}
		}
		if (tmplOrMarkup !== undefined) {
			if (name && !parentTmpl) {
				$render[name] = function() {
					return tmpl.render.apply(tmpl, arguments);
				};
			}
			if (tmplOrMarkup.fn || tmpl.fn) {
				// tmpl is already compiled, so use it, or if different name is provided, clone it
				if (tmplOrMarkup.fn) {
					if (name && name !== tmplOrMarkup.name) {
						tmpl = extendCtx(options, tmplOrMarkup);
					} else {
						tmpl = tmplOrMarkup;
					}
				}
			} else {
				// tmplOrMarkup is a markup string, not a compiled template
				// Create template object
				tmpl = TmplObject(tmplOrMarkup, options);
				// Compile to AST and then to compiled function
				tmplFn(tmplOrMarkup, tmpl);
			}
			compileChildResources(options);
			return tmpl;
		}
	}
	//==== /end of function compile ====

	function TmplObject(markup, options) {
		// Template object constructor
		var htmlTag,
			wrapMap = $viewsSettings.wrapMap || {},
			tmpl = $extend(
				{
					markup: markup,
					tmpls: [],
					links: {},
					bnds: [],
					render: renderContent
				},
				options
			);

		if (!options.htmlTag) {
			// Set tmpl.tag to the top-level HTML tag used in the template, if any...
			htmlTag = rFirstElem.exec(markup);
			tmpl.htmlTag = htmlTag ? htmlTag[1].toLowerCase() : "";
		}
		htmlTag = wrapMap[tmpl.htmlTag];
		if (htmlTag && htmlTag !== wrapMap.div) {
			// When using JsViews, we trim templates which are inserted into HTML contexts where text nodes are not rendered (i.e. not 'Phrasing Content').
			tmpl.markup = $.trim(tmpl.markup);
			tmpl._elCnt = TRUE; // element content model (no rendered text nodes), not phrasing content model
		}

		return tmpl;
	}

	function registerStore(storeName, storeSettings) {

		function theStore(name, item, parentTmpl) {
			// The store is also the function used to add items to the store. e.g. $.templates, or $.views.tags

			// For store of name 'thing', Call as:
			//    $.views.things(items[, parentTmpl]),
			// or $.views.things(name, item[, parentTmpl])

			var onStore, compile, items, itemName, childTemplates, childTemplate, thisStore, childStoreName;

			if (name && "" + name !== name && !name.nodeType && !name.markup) {
				// Call to $.views.things(items[, parentTmpl]),

				// Adding items to the store
				// If name is a map, then item is parentTmpl. Iterate over map and call store for key.
				for (itemName in name) {
					theStore(itemName, name[itemName], item);
				}
				return $views;
			}
			thisStore = parentTmpl ? parentTmpl[storeNames] = parentTmpl[storeNames] || {} : theStore;

			// Adding a single unnamed item to the store
			if (item === undefined) {
				item = name;
				name = undefined;
			}
			compile = storeSettings.compile;
			if (onStore = $viewsSub.onBeforeStoreItem) {
				// e.g. provide an external compiler or preprocess the item.
				compile = onStore(thisStore, name, item, compile) || compile;
			}
			if (!name) {
				item = compile(undefined, item);
			} else if ("" + name === name) { // name must be a string
				if (item === null) {
					// If item is null, delete this entry
					delete thisStore[name];
				} else {
					thisStore[name] = compile ? (item = compile(name, item, parentTmpl, storeName, storeSettings)) : item;
					if (storeName === "template" && (childTemplates = thisStore[name].templates)) {
						// This is a template which has child templates defined. We will copy child items of parent template to each
						// child template, since items registered with the parent templates must also be accessible from the child template
						for (childStoreName in jsvStores) {
							// Find child items registered for this parent template
							childStoreName += "s";
							if (items = item[childStoreName]) {
								// Copy these items to each child template
								for (childTemplate in childTemplates ) {
									childTemplate = childTemplates[childTemplate];
									// Copy parent items except if overridden by item of same name in child template
									childTemplate[childStoreName] = extendCtx(childTemplate[childStoreName], items);
								}
							}
						}
					}
				}
			}
			if (item) {
				item._is = storeName;
			}
			if (onStore = $viewsSub.onStoreItem) {
				// e.g. JsViews integration
				onStore(thisStore, name, item, compile);
			}
			return item;
		}

		var storeNames = storeName + "s";

		$views[storeNames] = theStore;
		jsvStores[storeName] = storeSettings;
	}

	//==============
	// renderContent
	//==============

	function renderContent(data, context, parentView, key, isLayout, onRender) {
		// Render template against data as a tree of subviews (nested rendered template instances), or as a string (top-level template).
		// If the data is the parent view, treat as layout template, re-render with the same data context.
		var i, l, dataItem, newView, childView, itemResult, parentContext, props, swapContent, tagCtx, isTag, outerOnRender,
			self = this,
			tmpl = self,
			allowDataLink = self.attr === undefined || self.attr === "html",
			result = "";

		if (key === TRUE) {
			swapContent = TRUE;
			key = 0;
		}
		if (isTag = self._is === "tag") {
			tagCtx = self.tagCtx;
			// This is a call from renderTag
			tmpl = tagCtx.isElse ? self._elses[tagCtx.isElse-1] : self.tmpl;
			context = extendCtx(context, self.ctx);
			props = tagCtx.props || {};
			if ( props.link === FALSE ) {
				// link=false setting on block tag
				// We will override inherited value of link by the explicit setting link=false taken from props
				// The child views of an unlinked view are also unlinked. So setting child back to true will not have any effect.
				context =  context || {};
				context.link = FALSE;
			}
			parentView = parentView || tagCtx.view;
		} else {
			tmpl = self.jquery && (self[0] || error('Unknown template: "' + self.selector + '"')) // This is a call from $(selector).render
				|| self;
		}
		if (tmpl) {
			if (parentView) {
				onRender = onRender || parentView._.onRender;
				parentContext = parentView.ctx;
				if (data === parentView) {
					// Inherit the data from the parent view.
					// This may be the contents of an {{if}} block
					// Set isLayout = true so we don't iterate the if block if the data is an array.
					data = parentView.data;
					isLayout = TRUE;
				}
			}

			// Set additional context on views created here, (as modified context inherited from the parent, and to be inherited by child views)
			// Note: If no jQuery, $extend does not support chained copies - so limit extend() to two parameters
			context = extendCtx(context, parentContext);

			if (!tmpl.fn) {
				tmpl = $templates[tmpl] || $templates(tmpl);
			}

			if (tmpl) {
				onRender = (context && context.link) !== FALSE && allowDataLink && onRender;
				// If link===false, do not call onRender, so no data-linking marker nodes
				outerOnRender = onRender;
				if (onRender === TRUE) {
					// Used by view.refresh(). Don't create a new wrapper view.
					outerOnRender = undefined;
					onRender = parentView._.onRender;
				}
				if ($.isArray(data) && !isLayout) {
					// Create a view for the array, whose child views correspond to each data item.
					// (Note: if key and parentView are passed in along with parent view, treat as
					// insert -e.g. from view.addViews - so parentView is already the view item for array)
					newView = swapContent ? parentView : (key !== undefined && parentView) || View(context, "array", parentView, data, tmpl, key, onRender);
					for (i = 0, l = data.length; i < l; i++) {
						// Create a view for each data item.
						dataItem = data[i];
						childView = View(context, "item", newView, dataItem, tmpl, (key || 0) + i, onRender);
						itemResult = tmpl.fn(dataItem, childView, $views);
						result += newView._.onRender ? newView._.onRender(itemResult, childView) : itemResult;
					}
				} else {
					// Create a view for singleton data object.
					newView = swapContent ? parentView : View(context, "data", parentView, data, tmpl, key, onRender);
					result += tmpl.fn(data, newView, $views);
				}
				return outerOnRender ? outerOnRender(result, newView) : result;
			}
		}
		return "";
	}

	//===========================
	// Build and compile template
	//===========================

	// Generate a reusable function that will serve to render a template against data
	// (Compile AST then build template function)

	function error(message) {
		if ($viewsSettings.debugMode) {
			throw new $views.sub.Error(message);
		}
	}

	function syntaxError(message) {
		error("Syntax error\n" + message);
	}

	function tmplFn(markup, tmpl, isLinkExpression) {
		// Compile markup to AST (abtract syntax tree) then build the template function code from the AST nodes
		// Used for compiling templates, and also by JsViews to build functions for data link expressions


		//==== nested functions ====
		function pushprecedingContent(shift) {
			shift -= loc;
			if (shift) {
				content.push(markup.substr(loc, shift).replace(rNewLine, "\\n"));
			}
		}

		function blockTagCheck(tagName) {
			tagName && syntaxError('Unmatched or missing tag: "{{/' + tagName + '}}" in template:\n' + markup);
		}

		function parseTag(all, bind, tagName, converter, colon, html, comment, codeTag, params, slash, closeBlock, index) {

			//    bind         tag        converter colon html     comment            code      params            slash   closeBlock
			// /{(\^)?{(?:(?:(\w+(?=[\/\s}]))|(?:(\w+)?(:)|(>)|!--((?:[^-]|-(?!-))*)--|(\*)))\s*((?:[^}]|}(?!}))*?)(\/)?|(?:\/(\w+)))}}/g

			// Build abstract syntax tree (AST): [ tagName, converter, params, content, hash, bindings, contentMarkup ]
			if (html) {
				colon = ":";
				converter = "html";
			}
			var current0,
				pathBindings = [],
				code = "",
				hash = "",
				passedCtx = "",
				// Block tag if not self-closing and not {{:}} or {{>}} (special case) and not a data-link expression
				block = !slash && !colon && !comment && !isLinkExpression;

			//==== nested helper function ====
			tagName = tagName || colon;
			pushprecedingContent(index);
			loc = index + all.length; // location marker - parsed up to here
			if (codeTag) {
				if (allowCode) {
					content.push(["*", "\n" + params.replace(rUnescapeQuotes, "$1") + "\n"]);
				}
			} else if (tagName) {
				if (tagName === "else") {
					if (rTestElseIf.test(params)) {
						syntaxError('for "{{else if expr}}" use "{{else expr}}"');
					}
					current[6] = markup.substring(current[6], index); // contentMarkup for block tag
					current = stack.pop();
					content = current[3];
					block = TRUE;
				}
				if (params) {
					code = parseParams(params, pathBindings)
						.replace(rBuildHash, function(all, isCtx, keyValue) {
							if (isCtx) {
								passedCtx += keyValue + ",";
							} else {
								hash += keyValue + ",";
							}
							return "";
						});
				}
				hash = hash.slice(0, -1);
				code = code.slice(0, -1);
				newNode = [
						tagName,
						converter || "",
						code,
						block && [],
						"{" + (hash ? ("props:{" + hash + "},") : "") + 'params:"' + params + '"' + (passedCtx ? ",ctx:{" + passedCtx.slice(0, -1) + "}" : "") + "},",
						bind && pathBindings || 0
					];
				content.push(newNode);
				if (block) {
					stack.push(current);
					current = newNode;
					current[6] = loc; // Store current location of open tag, to be able to add contentMarkup when we reach closing tag
				}
			} else if (closeBlock) {
				current0 = current[0];
				blockTagCheck(closeBlock !== current0 && current0 && current0 !== "else");
				current[6] = markup.substring(current[6], index); // contentMarkup for block tag
				current = stack.pop();
			}
			blockTagCheck(!current && closeBlock);
			content = current[3];
		}
		//==== /end of nested functions ====

		var newNode,
			allowCode = tmpl && tmpl.allowCode,
			astTop = [],
			loc = 0,
			stack = [],
			content = astTop,
			current = [, , , astTop];

		markup = markup.replace(rEscapeQuotes, "\\$1");

//TODO	result = tmplFnsCache[markup];  // Only cache if template is not named and markup length < ..., and there are no bindings or subtemplates?? Consider standard optimization for data-link="a.b.c"
//		if (result) {
//			tmpl.fn = result;
//		} else {

//		result = markup;

		blockTagCheck(stack[0] && stack[0][3].pop()[0]);

		// Build the AST (abstract syntax tree) under astTop
		markup.replace(rTag, parseTag);

		pushprecedingContent(markup.length);

		if (loc = astTop[astTop.length-1]) {
			blockTagCheck("" + loc !== loc && (+loc[6] === loc[6]) && loc[0]);
		}
//			result = tmplFnsCache[markup] = buildCode(astTop, tmpl);
//		}
		return buildCode(astTop, tmpl);
	}

	function buildCode(ast, tmpl) {
		// Build the template function code from the AST nodes, and set as property on the passed-in template object
		// Used for compiling templates, and also by JsViews to build functions for data link expressions
		var i, node, hasTag, hasEncoder, getsValue, hasConverter, hasViewPath, tagName, converter, params, hash, bindings, bindingPaths, nestedTmpls, nestedTmpl, allowCode, content, markup,
			code = "",
			tmplOptions = {},
			l = ast.length;

		if (tmpl) {
			if (allowCode = tmpl.allowCode) {
				tmplOptions.allowCode = TRUE;
			}
			if (tmpl.debug) {
				tmplOptions.debug = TRUE;
			}
			bindings = tmpl.bnds;
			nestedTmpls = tmpl.tmpls;
		}

		for (i = 0; i < l; i++) {
			// AST nodes: [ tagName, converter, params, content, hash, bindings, contentMarkup, link ]
			node = ast[i];

			// Add newline for each callout to t() c() etc. and each markup string
			//TODO consider changing to ret += t()...; so debug break points can be inserted on each callout.
			code += "\nret+=";
			if ("" + node === node) {
				// a markup string to be inserted
				code += '"' + node + '";';
			} else {
				// a compiled tag expression to be inserted
				tagName = node[0];
				if (tagName === "*") {
					// If this {{* }} tag is at the beginning of the template, start with var ret="";
					// Otherwise remove the last "+\n" characters and replace with ";" to complete the ret += ...; statement, prior to inserted user code,
					code = (i ? code.slice(0, -5) : "") + node[1];
				} else {
					converter = node[1];
					params = node[2];
					content = node[3];
					hash = node[4];
					bindingPaths = node[5];
					markup = node[6];

					if (content) {
						// Create template object for nested template
						nestedTmpl = TmplObject(markup, tmplOptions);
						// Compile to AST and then to compiled function
						buildCode(content, nestedTmpl);
						nestedTmpls.push(nestedTmpl);
					}
					if (bindingPaths) {
						// Add leaf binding paths to template
						bindings.push(bindingPaths);
						bindingPaths = bindings.length;
					}
					hasViewPath = hasViewPath || hash.indexOf("view") > -1;
					// Add newline for each callout to t() c() etc.

					//TODO consider changing to ret += t()...; so debug break points can be inserted on each callout. At the same time, pass in ret to c() and t()
					// so they can look at the previous ret, and detect whether this is a jsrender tag within an HTML element tag. If so, don't insert marker nodes,
					// and make the databinding trigger view refresh on parent view... No need for people to set link=false.
					code += tagName === ":"
					? (converter === "html" && !bindingPaths
						? (hasEncoder = TRUE, "h(" + params+ ");")
						: converter || bindingPaths // Call _cnvt if there is a converter, or binding: {{cnvt: ... }}, {^{: ... }} or {^{cnvt: ... }}
							? (hasConverter = TRUE, 'c("' + converter + '",view,this,' + hash + bindingPaths + "," + params + ");")
							: (getsValue = TRUE, "(v=" + params + ')!=u?v:"";')
					)
					: (hasTag = TRUE, 't("' + tagName + '",view,this,'
						+ (content ? nestedTmpls.length : '""') // For block tags, pass in the key (nestedTmpls.length) to the nested content template
						+ "," + hash + bindingPaths + (params ? "," : "") + params) + ");";
				}
			}
		}

		// Include only the var references that are needed in the code
		code = fnDeclStr
		+ (getsValue ? "v," : "")
		+ (hasTag ? "t=j._tag," : "")
		+ (hasConverter ? "c=j._cnvt," : "")
		+ (hasEncoder ? "h=j.converters.html," : "")
		+ 'ret=""; try{\n'
		+ (tmplOptions.debug ? "debugger;" : "")
		+ code + "\nreturn ret;\n\n}catch(e){return j._err(e);}";

		try {
			code = new Function("data, view, j, u", code);
		} catch (e) {
			syntaxError("Compiled template code:\n\n" + code, e);
		}

		if (tmpl) {
			tmpl.fn = code;
		}
		return code;
	}

	function parseParams(params, bindings) {

		function parseTokens(all, lftPrn0, lftPrn, path, operator, err, eq, path2, prn, comma, lftPrn2, apos, quot, rtPrn, prn2, space) {
			// rParams = /(\()(?=|\s*\()|(?:([([])\s*)?(?:([#~]?[\w$^.]+)?\s*((\+\+|--)|\+|-|&&|\|\||===|!==|==|!=|<=|>=|[<>%*!:?\/]|(=))\s*|([#~]?[\w$^.]+)([([])?)|(,\s*)|(\(?)\\?(?:(')|("))|(?:\s*([)\]])([([]?))|(\s+)
			//          lftPrn0-flwed by (- lftPrn               path    operator err                                                eq         path2       prn    comma   lftPrn3   apos quot        rtPrn   prn2   space
			// (left paren? followed by (path? followed by operator) or (path followed by paren?)) or comma or apos or quot or right paren or space
			operator = operator || "";
			lftPrn = lftPrn || lftPrn0 || lftPrn2;
			path = path || path2;
			prn = prn || prn2 || "";

			function parsePath(all, object, helper, view, viewProperty, pathTokens, leafToken) {
				// rPath = /^(?:null|true|false|\d[\d.]*|([\w$]+|~([\w$]+)|#(view|([\w$]+))?)([\w$.^]*?)(?:[.[^]([\w$]+)\]?)?)$/g,
				//                                        object   helper    view  viewProperty pathTokens       leafToken

				if (object) {
					bindings.push(path);
					if (object !== ".") {
						var leaf,
							ret = (helper
								? 'view._hlp("' + helper + '")'
								: view
									? "view"
									: "data")
							+ (leafToken
								? (viewProperty
									? "." + viewProperty
									: helper
										? ""
										: (view ? "" : "." + object)
									) + (pathTokens || "")
								: (leafToken = helper ? "" : view ? viewProperty || "" : object, ""));

						leaf = (leafToken ? "." + leafToken : "");
						ret = ret + leaf;
						ret = ret.slice(0, 9) === "view.data"
						? ret.slice(5) // convert #view.data... to data...
						: ret;
						return ret;
					}
				}
				return all;
			}

			if (err) {
				syntaxError(params);
			} else {
				return (aposed
					// within single-quoted string
					? (aposed = !apos, (aposed ? all : '"'))
					: quoted
					// within double-quoted string
						? (quoted = !quot, (quoted ? all : '"'))
						:
					(
						(lftPrn
								? (parenDepth++, lftPrn)
								: "")
						+ (space
							? (parenDepth
								? ""
								: named
									? (named = FALSE, "\b")
									: ","
							)
							: eq
					// named param
								? (parenDepth && syntaxError(params), named = TRUE, '\b' + path + ':')
								: path
					// path
									? (path.split("^").join(".").replace(rPath, parsePath)
										+ (prn
											? (fnCall[++parenDepth] = TRUE, prn)
											: operator)
									)
									: operator
										? operator
										: rtPrn
					// function
											? ((fnCall[parenDepth--] = FALSE, rtPrn)
												+ (prn
													? (fnCall[++parenDepth] = TRUE, prn)
													: "")
											)
											: comma
												? (fnCall[parenDepth] || syntaxError(params), ",") // We don't allow top-level literal arrays or objects
												: lftPrn0
													? ""
													: (aposed = apos, quoted = quot, '"')
					))
				);
			}
		}
		var named,
			fnCall = {},
			parenDepth = 0,
			quoted = FALSE, // boolean for string content in double quotes
			aposed = FALSE; // or in single quotes

		bindings.expr = params.replace(rUnescapeQuotes, "$1");
		return (params + " ").replace(rParams, parseTokens);
	}

	//==========
	// Utilities
	//==========

	// HTML encoding helper
	function replacerForHtml(ch) {
		// Original code from Mike Samuel <msamuel@google.com>
		return escapeMapForHtml[ch]
			// Intentional assignment that caches the result of encoding ch.
			|| (escapeMapForHtml[ch] = "&#" + ch.charCodeAt(0) + ";");
	}

	// Merge objects, in particular contexts which inherit from parent contexts
	function extendCtx(context, parentContext) {
		// Return copy of parentContext, unless context is defined and is different, in which case return a new merged context
		// If neither context nor parentContext are undefined, return undefined
		return context && context !== parentContext
			? (parentContext
				? $extend($extend({}, parentContext), context)
				: context)
			: parentContext && $extend({}, parentContext);
	}

	//========================== Initialize ==========================

	for (jsvStoreName in jsvStores) {
		registerStore(jsvStoreName, jsvStores[jsvStoreName]);
	}

	var $templates = $views.templates,
		$converters = $views.converters,
		$helpers = $views.helpers,
		$tags = $views.tags,
		$viewsSub = $views.sub,
		$viewsSettings = $views.settings;

	if (jQuery) {
		////////////////////////////////////////////////////////////////////////////////////////////////
		// jQuery is loaded, so make $ the jQuery object
		$ = jQuery;
		$.render = $render;
		$.views = $views;
		$.templates = $templates = $views.templates;
		$.fn.render = renderContent;

	} else {
		////////////////////////////////////////////////////////////////////////////////////////////////
		// jQuery is not loaded.

		$ = global.jsviews = $views;

		$.isArray = Array && Array.isArray || function(obj) {
			return Object.prototype.toString.call(obj) === "[object Array]";
		};
	}

	//========================== Register tags ==========================

	$tags({
		"if": function(val) {
			var self = this;
				// If not done and val is truey, set done=true on tag instance and render content. Otherwise return ""
				// On else will call this function again on the same tag instance.
			return (self._done || arguments.length && !val)
				? ""
				: (self._done = true,
					// Test is satisfied, so render content on current context. Rather than return undefined
					// (which will render the tmpl/content on the current context but will iterate if it is an array),
					// we pass in the view. This ensures treating as a layout template - with no iteration
					self.renderContent(self.tagCtx.view));
		},
// Temporary fix for binding to {{if}}
//	"if": {
//		render: function(val) {
//			var self = this;
//			return (self._done || arguments.length && !val) ? "" : (self._done = true, self.renderContent(self.tagCtx.view));
//		}
//	},
		"else": function() {}, // Does nothing but ensures {{else}} tags are recognized as valid
		"for": function() {
			var i, arg, undef,
				self = this,
				tagCtx = self.tagCtx,
				result = "",
				args = arguments,
				done = 0,
				l = args.length;

			if (!l) {
				return tagCtx.done
					? ""
					: (tagCtx.done = TRUE,
						// Test is satisfied, so render content on current context. Rather than return undefined
						// (which will render the tmpl/content on the current context but will iterate if it is an array),
						// we pass in the view. This ensures treating as a layout template - with no iteration
						self.renderContent(tagCtx.view));
			}
			for (i = 0; i < l; i++) {
				arg = args[i];
				undef = arg === undefined;
				if (!undef) {
					done += $.isArray(arg) ? arg.length : 1;
					result += self.renderContent(arg);
				} else {
					return "";
				}
			}
			tagCtx.done = done;
			return result;
		},
		"*": function(value) {
			return value;
		}
	});

	//========================== Register global helpers ==========================

	//	$helpers({ // Global helper functions
	//		// TODO add any useful built-in helper functions
	//	});

	//========================== Register converters ==========================

	$converters({
		html: function(text) {
			// HTML encoding helper: Replace < > & and ' and " by corresponding entities.
			return text != undefined ? String(text).replace(htmlEncodeChars, replacerForHtml) : "";
		},
		attr: function(text) {
			// Attribute encoding helper: Replace < & ' and " by corresponding entities.
			return text != undefined ? String(text).replace(attrEncodeChars, replacerForHtml) : "";
		},
		url: function(text) {
			// TODO - support chaining {{attr|url:....}} to protect against injection attacks from url parameters containing " or '.
			// URL encoding helper.
			return text != undefined ? encodeURI(String(text)) : "";
		}
	});

	//========================== Define default delimiters ==========================
	$viewsDelimiters();

})(this, this.jQuery);
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: TZ-DON-Buch_Iran\js\mykkro-viewer.js
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\TZ-DON-Buch_Iran\js\mykkro-viewer.js
VELIKOST: 197015 B (192.40 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
// configuration file
var DEBUG = false;

var Config = {
};
var __ = function(arg) {
    return LocaleStrings[arg] || arg;
}

/*
	Base.js, version 1.1
	Copyright 2006-2007, Dean Edwards
	License: http://www.opensource.org/licenses/mit-license.php
*/

var Base = function() {
	// dummy
};

Base.extend = function(_instance, _static) { // subclass
	var extend = Base.prototype.extend;
	
	// build the prototype
	Base._prototyping = true;
	var proto = new this;
	extend.call(proto, _instance);
	delete Base._prototyping;
	
	// create the wrapper for the constructor function
	//var constructor = proto.constructor.valueOf(); //-dean
	var constructor = proto.constructor;
	var klass = proto.constructor = function() {
		if (!Base._prototyping) {
			if (this._constructing || this.constructor == klass) { // instantiation
				this._constructing = true;
				constructor.apply(this, arguments);
				delete this._constructing;
			} else if (arguments[0] != null) { // casting
				return (arguments[0].extend || extend).call(arguments[0], proto);
			}
		}
	};
	
	// build the class interface
	klass.ancestor = this;
	klass.extend = this.extend;
	klass.forEach = this.forEach;
	klass.implement = this.implement;
	klass.prototype = proto;
	klass.toString = this.toString;
	klass.valueOf = function(type) {
		//return (type == "object") ? klass : constructor; //-dean
		return (type == "object") ? klass : constructor.valueOf();
	};
	extend.call(klass, _static);
	// class initialisation
	if (typeof klass.init == "function") klass.init();
	return klass;
};

Base.prototype = {	
	extend: function(source, value) {
		if (arguments.length > 1) { // extending with a name/value pair
			var ancestor = this[source];
			if (ancestor && (typeof value == "function") && // overriding a method?
				// the valueOf() comparison is to avoid circular references
				(!ancestor.valueOf || ancestor.valueOf() != value.valueOf()) &&
				/\bbase\b/.test(value)) {
				// get the underlying method
				var method = value.valueOf();
				// override
				value = function() {
					var previous = this.base || Base.prototype.base;
					this.base = ancestor;
					var returnValue = method.apply(this, arguments);
					this.base = previous;
					return returnValue;
				};
				// point to the underlying method
				value.valueOf = function(type) {
					return (type == "object") ? value : method;
				};
				value.toString = Base.toString;
			}
			this[source] = value;
		} else if (source) { // extending with an object literal
			var extend = Base.prototype.extend;
			// if this object has a customised extend method then use it
			if (!Base._prototyping && typeof this != "function") {
				extend = this.extend || extend;
			}
			var proto = {toSource: null};
			// do the "toString" and other methods manually
			var hidden = ["constructor", "toString", "valueOf"];
			// if we are prototyping then include the constructor
			var i = Base._prototyping ? 0 : 1;
			while (key = hidden[i++]) {
				if (source[key] != proto[key]) {
					extend.call(this, key, source[key]);

				}
			}
			// copy each of the source object's properties to this object
			for (var key in source) {
				if (!proto[key]) extend.call(this, key, source[key]);
			}
		}
		return this;
	},

	base: function() {
		// call this method from any other method to invoke that method's ancestor
	}
};

// initialise
Base = Base.extend({
	constructor: function() {
		this.extend(arguments[0]);
	}
}, {
	ancestor: Object,
	version: "1.1",
	
	forEach: function(object, block, context) {
		for (var key in object) {
			if (this.prototype[key] === undefined) {
				block.call(context, object[key], key, object);
			}
		}
	},
		
	implement: function() {
		for (var i = 0; i < arguments.length; i++) {
			if (typeof arguments[i] == "function") {
				// if it's a function, call it
				arguments[i](this.prototype);
			} else {
				// add the interface using the extend method
				this.prototype.extend(arguments[i]);
			}
		}
		return this;
	},
	
	toString: function() {
		return String(this.valueOf());
	}
});

// requires: jquery

var log = function(what) {
    $("body").prepend($("<pre>").text(what));
}


// From http://www.terrainformatica.com/?p=13
var delegate = function( that, thatMethod )
{
    if(arguments.length > 2)
    {
        var _params = [];
        for(var n = 2; n < arguments.length; ++n) _params.push(arguments[n]);
        return function() { return thatMethod.apply(that,_params); };
    }
    else
      return function() { return thatMethod.call(that); };
}

var delegate_cp = function( that, thatMethod ) {
    return function() { return thatMethod.apply(that,arguments); }
};

function utf8_encode( s ) {
  return unescape( encodeURIComponent( s ) );
}

function utf8_decode( s ) {
  return decodeURIComponent( escape( s ) );
}

/**
 * Returns the first data element of an object, regardless on its key name.
 */
var extractRoot = function(data) {
  for(var key in data) {
    return data[key];
  }
}


Array.prototype.toObject = function() {
    var out = {};
    for(var i=0; i<this.length; i++) {
        out[i] = this[i];
    }
    return out;
}


// from 4umi.com/web/javascript

// -- Standard functions

// Array.concat() - Join two arrays
if( typeof Array.prototype.concat==='undefined' ) {
 Array.prototype.concat = function( a ) {
  for( var i = 0, b = this.copy(); i<a.length; i++ ) {
   b[b.length] = a[i];
  }
  return b;
  };
}

// Array.copy() - Copy an array
if( typeof Array.prototype.copy==='undefined' ) {
 Array.prototype.copy = function() {
  var a = [], i = this.length;
  while( i-- ) {
   a[i] = typeof this[i].copy!=='undefined' ? this[i].copy() : this[i];
  }
  return a;
 };
}

// Array.pop() - Remove and return the last element of an array
if( typeof Array.prototype.pop==='undefined' ) {
 Array.prototype.pop = function() {
  var b = this[this.length-1];
  this.length--;
  return b;
 };
}

// Array.push() - Add an element to the end of an array, return the new length
if( typeof Array.prototype.push==='undefined' ) {
 Array.prototype.push = function() {
  for( var i = 0, b = this.length, a = arguments, l = a.length; i<l; i++ ) {
   this[b+i] = a[i];
  }
  return this.length;
 };
}

// Array.shift() - Remove and return the first element
if( typeof Array.prototype.shift==='undefined' ) {
 Array.prototype.shift = function() {
  for( var i = 0, b = this[0], l = this.length-1; i<l; i++ ) {
   this[i] = this[i+1];
  }
  this.length--;
  return b;
 };
}

// Array.slice() - Copy and return several elements
if( typeof Array.prototype.slice==='undefined' ) {
 Array.prototype.slice = function( a, c ) {
  var i, l = this.length, r = [];
  if( !c ) { c = l; }
  if( c<0 ) { c = l + c; }
  if( a<0 ) { a = l - a; }
  if( c<a ) { i = a; a = c; c = i; }
  for( i = 0; i < c - a; i++ ) { r[i] = this[a+i]; }
  return r;
 };
}

// Array.splice() - Remove or replace several elements and return any deleted elements
if( typeof Array.prototype.splice==='undefined' ) {
 Array.prototype.splice = function( a, c ) {
  var i = 0, e = arguments, d = this.copy(), f = a, l = this.length;
  if( !c ) { c = l - a; }
  for( i; i < e.length - 2; i++ ) { this[a + i] = e[i + 2]; }
  for( a; a < l - c; a++ ) { this[a + e.length - 2] = d[a - c]; }
  this.length -= c - e.length + 2;
  return d.slice( f, f + c );
 };
}

// Array.unshift() - Add an element to the beginning of an array
if( typeof Array.prototype.unshift==='undefined' ) {
 Array.prototype.unshift = function() {
  this.reverse();
  var a = arguments, i = a.length;
  while(i--) { this.push(a[i]); }
  this.reverse();
  return this.length;
 };
}

// -- 4umi additional functions

// Array.forEach( function ) - Apply a function to each element
Array.prototype.forEach = function( f ) {
 var i = this.length, j, l = this.length;
 for( i=0; i<l; i++ ) { if( ( j = this[i] ) ) { f( j ); } }
};

// Array.indexOf( value, begin, strict ) - Return index of the first element that matches value
Array.prototype.indexOf = function( v, b, s ) {
 for( var i = +b || 0, l = this.length; i < l; i++ ) {
  if( this[i]===v || s && this[i]==v ) { return i; }
 }
 return -1;
};

// Array.insert( index, value ) - Insert value at index, without overwriting existing keys
Array.prototype.insert = function( i, v ) {
 if( i>=0 ) {
  var a = this.slice(), b = a.splice( i );
  a[i] = v;
  return a.concat( b );
 }
};

// Array.lastIndexOf( value, begin, strict ) - Return index of the last element that matches value
Array.prototype.lastIndexOf = function( v, b, s ) {
 b = +b || 0;
 var i = this.length; while(i-->b) {
  if( this[i]===v || s && this[i]==v ) { return i; }
 }
 return -1;
};

// Array.random( range ) - Return a random element, optionally up to or from range
Array.prototype.random = function( r ) {
 var i = 0, l = this.length;
 if( !r ) { r = this.length; }
 else if( r > 0 ) { r = r % l; }
 else { i = r; r = l + r % l; }
 return this[ Math.floor( r * Math.random() - i ) ];
};

// Array.shuffle( deep ) - Randomly interchange elements
Array.prototype.shuffle = function( b ) {
 var i = this.length, j, t;
 while( i ) {
  j = Math.floor( ( i-- ) * Math.random() );
  t = b && typeof this[i].shuffle!=='undefined' ? this[i].shuffle() : this[i];
  this[i] = this[j];
  this[j] = t;
 }
 return this;
};

// Array.unique( strict ) - Remove duplicate values
Array.prototype.unique = function( b ) {
 var a = [], i, l = this.length;
 for( i=0; i<l; i++ ) {
  if( a.indexOf( this[i], 0, b ) < 0 ) { a.push( this[i] ); }
 }
 return a;
};

// Array.walk() - Change each value according to a callback function
Array.prototype.walk = function( f ) {
 var a = [], i = this.length;
 while(i--) { a.push( f( this[i] ) ); }
 return a.reverse();
};

String.prototype.capitalize = function() {
    return this.charAt(0).toUpperCase() + this.slice(1);
}

String.prototype.trim=function(){return this.replace(/^\s\s*/, '').replace(/\s\s*$/, '');};

String.prototype.ltrim=function(){return this.replace(/^\s+/,'');}

String.prototype.rtrim=function(){return this.replace(/\s+$/,'');}

String.prototype.fulltrim=function(){return this.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,'').replace(/\s+/g,' ');}

String.prototype.camelCase = function() { 
    var s = this.trim();
    return ( /\S[A-Z]/.test( s ) ) ?
        s.replace( /(.)([A-Z])/g, function(t,a,b) { return a + ' ' + b.toLowerCase(); } ) :
        s.replace( /( )([a-z])/g, function(t,a,b) { return b.toUpperCase(); } );
}

// TODO remove, substitute with capitalize
String.prototype.firstLetterToUpper = function()
{
    return this.charAt(0).toUpperCase() + this.slice(1);
}


// code generation utilities

var CodeGenUtils = {
    getSetterName: function(name) {
        return "set" + name.firstLetterToUpper();
    },
    getGetterName: function(name, isBoolean) {
        return (isBoolean ? "is" : "get") + name.firstLetterToUpper();
    }
}



String.prototype.endsWith = function(suffix) {
    return this.indexOf(suffix, this.length - suffix.length) !== -1;
};

if (typeof String.prototype.startsWith != 'function') {
  String.prototype.startsWith = function (str){
    return this.slice(0, str.length) == str;
  };
}

function htmlEncode( input ) {
    return String(input)
        .replace(/&/g, '&amp;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '\'')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;');
}

function htmlDecode( input ) {
    return String(input)
        .replace(/&amp;/g, '&')
        .replace(/&quot;/g, '\"')
        .replace(/'/g, '\'')
        .replace(/&lt;/g, '<')
        .replace(/&gt;/g, '>');
}

function base64_decode (data) {
  // http://kevin.vanzonneveld.net
  // +   original by: Tyler Akins (http://rumkin.com)
  // +   improved by: Thunder.m
  // +      input by: Aman Gupta
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +   bugfixed by: Onno Marsman
  // +   bugfixed by: Pellentesque Malesuada
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +      input by: Brett Zamir (http://brett-zamir.me)
  // +   bugfixed by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // *     example 1: base64_decode('S2V2aW4gdmFuIFpvbm5ldmVsZA==');
  // *     returns 1: 'Kevin van Zonneveld'
  // mozilla has this native
  // - but breaks in 2.0.0.12!
  //if (typeof this.window['atob'] == 'function') {
  //    return atob(data);
  //}
  var b64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
  var o1, o2, o3, h1, h2, h3, h4, bits, i = 0,
    ac = 0,
    dec = "",
    tmp_arr = [];

  if (!data) {
    return data;
  }

  data += '';

  do { // unpack four hexets into three octets using index points in b64
    h1 = b64.indexOf(data.charAt(i++));
    h2 = b64.indexOf(data.charAt(i++));
    h3 = b64.indexOf(data.charAt(i++));
    h4 = b64.indexOf(data.charAt(i++));

    bits = h1 << 18 | h2 << 12 | h3 << 6 | h4;

    o1 = bits >> 16 & 0xff;
    o2 = bits >> 8 & 0xff;
    o3 = bits & 0xff;

    if (h3 == 64) {
      tmp_arr[ac++] = String.fromCharCode(o1);
    } else if (h4 == 64) {
      tmp_arr[ac++] = String.fromCharCode(o1, o2);
    } else {
      tmp_arr[ac++] = String.fromCharCode(o1, o2, o3);
    }
  } while (i < data.length);

  dec = tmp_arr.join('');

  return dec;
}



function base64_encode (data) {
  // http://kevin.vanzonneveld.net
  // +   original by: Tyler Akins (http://rumkin.com)
  // +   improved by: Bayron Guevara
  // +   improved by: Thunder.m
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +   bugfixed by: Pellentesque Malesuada
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +   improved by: Rafał Kukawski (http://kukawski.pl)
  // *     example 1: base64_encode('Kevin van Zonneveld');
  // *     returns 1: 'S2V2aW4gdmFuIFpvbm5ldmVsZA=='
  // mozilla has this native
  // - but breaks in 2.0.0.12!
  //if (typeof this.window['btoa'] == 'function') {
  //    return btoa(data);
  //}
  var b64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
  var o1, o2, o3, h1, h2, h3, h4, bits, i = 0,
    ac = 0,
    enc = "",
    tmp_arr = [];

  if (!data) {
    return data;
  }

  do { // pack three octets into four hexets
    o1 = data.charCodeAt(i++);
    o2 = data.charCodeAt(i++);
    o3 = data.charCodeAt(i++);

    bits = o1 << 16 | o2 << 8 | o3;

    h1 = bits >> 18 & 0x3f;
    h2 = bits >> 12 & 0x3f;
    h3 = bits >> 6 & 0x3f;
    h4 = bits & 0x3f;

    // use hexets to index into b64, and append result to encoded string
    tmp_arr[ac++] = b64.charAt(h1) + b64.charAt(h2) + b64.charAt(h3) + b64.charAt(h4);
  } while (i < data.length);

  enc = tmp_arr.join('');

  var r = data.length % 3;

  return (r ? enc.slice(0, r - 3) : enc) + '==='.slice(r || 3);

}


// Array Remove - By John Resig (MIT Licensed)
Array.prototype.remove = function(from, to) {
  var rest = this.slice((to || from) + 1 || this.length);
  this.length = from < 0 ? this.length + from : from;
  return this.push.apply(this, rest);
};

jQuery.fn.swap = function(b) {
    b = jQuery(b)[0];
    var a = this[0];

    var t = a.parentNode.insertBefore(document.createTextNode(''), a);
    b.parentNode.insertBefore(a, b);
    t.parentNode.insertBefore(b, t);
    t.parentNode.removeChild(t);

    return this;
};


// smallest jQuery plugin :)
jQuery.fn.reverse = [].reverse;


var makeSvgScalable = function(svg) {
    var el = svg[0];
    var ww = el.getAttribute("width");
    var hh = el.getAttribute("height");
    el.setAttribute('width', '100%');
    el.setAttribute('height', '100%');
    el.setAttribute('viewBox', '0 0 '+ww+' '+hh);
    el.setAttribute('preserveAspectRatio', 'xMidyMid meet');
};

var Common = {
    postJsonData: function(url, data, success, error) {
        $.ajax({
            type: "post",       // Request method: post, get
            url: url,
            data: JSON.stringify(data), 
            dataType: "json",    // Expected response type
            contentType: "application/json",
            cache: false,
            success: success || $.noop,
            error: error || $.noop
        });
    }
};

var JQ = {
    button: function(caption, click, parent) {
        var btn = $("<button>").text(caption);
        if(click) btn.click(click);
        if(parent) btn.appendTo(parent);
        return btn;
    },
    linkButton: function(content, click, parent) {
        var btn = JQ.put($("<a>"), content);
        if(click) btn.click(click);
        if(parent) btn.appendTo(parent);
        return btn;
    },
    link: function(content, href, tooltip, parent) {
        var link = JQ.put($("<a>"), content).attr({"title":tooltip, "href":href});
        if(parent) link.appendTo(parent);
        return link;
    },
    ul: function(parent) {
        var ul = $("<ul>");
        if(parent) ul.appendTo(parent);
        return ul;
    },
    li: function(klass, parent) {
        var li = $("<li>").addClass(klass);
        if(parent) li.appendTo(parent);
        return li;
    },
    checkbox: function(name, checked, parent) {
        var input = $("<input>").attr({'type':'checkbox', 'name':name, "checked":checked});
        if(parent) input.appendTo(parent);
        return input;
    },
    textfield: function(name, value, parent) {
        var input = $("<input>").attr({'type':'text', 'name':name, "value":value});
        if(parent) input.appendTo(parent);
        return input;
    },
    span: function(content, klass, parent) {
        var span = JQ.put("span", content).addClass(klass);
        if(parent) span.appendTo(parent);
        return span;
    },
    div: function(content, klass, parent) {
        var div = JQ.put("div", content).addClass(klass);
        if(parent) div.appendTo(parent);
        return div;
    },
    p: function(content, klass, parent) {
        var p = JQ.put("p", content).addClass(klass);
        if(parent) p.appendTo(parent);
        return p;
    },
    h1: function(content, klass, parent) {
        return JQ.hN(1, content, klass, parent);
    },
    h2: function(content, klass, parent) {
        return JQ.hN(2, content, klass, parent);
    },
    h3: function(content, klass, parent) {
        return JQ.hN(3, content, klass, parent);
    },
    h4: function(content, klass, parent) {
        return JQ.hN(4, content, klass, parent);
    },
    h5: function(content, klass, parent) {
        return JQ.hN(5, content, klass, parent);
    },
    h6: function(content, klass, parent) {
        return JQ.hN(6, content, klass, parent);
    },
    hN: function(level, content, klass, parent) {
        var heading = JQ.put("h"+level, content).addClass(klass);
        if(parent) heading.appendTo(parent);
        return heading;
    },
    label: function(content, klass, parent) {
        var label = JQ.put("label", content).addClass(klass);
        if(parent) label.appendTo(parent);
        return label;
    },
    clear: function(parent) {
        var clr = $("<div>").addClass("clear");
        if(parent) clr.appendTo(parent);
        return clr;
    },
    show: function(elem, enabled) {
        if(enabled) elem.show(); else elem.hide();
    },
    form: function(klass, parent) {
        var div = $("<form>").addClass(klass);
        if(parent) div.appendTo(parent);
        return div;
    },
    fieldset: function(klass, parent) {
        var div = $("<fieldset>").addClass(klass);
        if(parent) div.appendTo(parent);
        return div;
    },
    toggleLink: function(captionOn, captionOff, target, parent) {
        var visible = target.is(":visible");
        var btn = JQ.put("a", visible ? captionOn : captionOff).click(function() {
            var visible = target.is(":visible");
            if(visible) {
                target.hide();
                btn.text(captionOff);
            } else {
                target.show();
                btn.text(captionOn);
            }
        });
        if(parent) btn.appendTo(parent);
        return btn;
    },
    linkExt: function(caption, href, tooltip, parent) {
        return JQ.link(caption, href, tooltip, parent).attr("target","_blank");
    },
    put: function(where, what) {
        if(typeof(where) == "string") {
            where = $("<"+where+">");
        }
        if(what) {
            if(typeof(what) == "string") {
                where.text(what);
            } else {
                where.append(what);
            }
        }
        return where;
    }
};

// kazda 'vec' ma options (s defaultni hodnotou) a slots
var Thing = Base.extend({
    constructor: function(options, slots) {
        this.options = $.extend({}, this.defaults(), options);        
        this.tid = Thing.tid++;
        Thing.things[this.tid] = this;
        this.element = $("<div>").addClass(this.getClass()).attr("data-tid", this.tid);
        if(DEBUG) {
            this.element.css("background-color", '#'+Math.floor(Math.random()*16777215).toString(16));
        }
        this.slots = {};
        this.parent = null;
        this.name = null;
        // initializing...
	    this.slotChanged($.noop);
        this.init();
        this.setSlots(slots);
        // display update
        this.refresh();
    },
    copy: function() {
        return Thing.create(this.serialize());
    },
    remove: function() {
        this.replaceWith(Thing.empty());        
    },
    replaceWith: function(thing) {
        if(this.parent) {
            this.parent.setSlot(this.name, thing);
            this.parent = null;
            this.name = null;           
            Thing.things[this.tid] = null;
        }
    },
    // obali this dekoratorem
    decorate: function(deco) {
        if(this.parent) {
            var par = this.parent;
            var slot = this.name;
            deco.setSlot('content', this);
            par.setSlot(slot, deco);
            return deco;
        }
    },
    serialize: function() {
        var slots = {};
        var numslots = 0;
        for(var key in this.slots) {
            slots[key] = this.slots[key].serialize();
            numslots++;
        }
        var obj = {
            type: this.getType(),
            options: this.options
        };
        if(numslots) obj.slots = slots
        return obj;
    },
    getType: function() {
        return this._type;
    },
    getClass: function() {
        return this._klass.split(" ").map(function(a){return "mykkro-"+a;}).join(" ");
    },
    init: function() {
        // create structure and variables
    },
    refresh: function() {
        // options changed...
        this.element.attr('class','');
        this.element.addClass(this.getClass());
        this.element.addClass(this.options.css);
    },
    get: function() {
        return this.element;
    },
    defaults: function() {
        return this._defaults;
    },
    // muzeme se dostat takhle i ke slotu ve slotu
    content: function(key, value) {
        var ndx = key.indexOf(".");
        if(ndx>=0) {
            // odkazujeme se na slot ve slotu
            var newKey = key.substring(0,ndx);
            var rest = key.substring(ndx+1);
            return this.getSlot(newKey).content(rest, value);
        }
        if(this.hasSlot(key)) {
            if(value) {
                // setter
                this.setSlot(key, value);
                return this;
            } else {
                // getter
                return this.getSlot(key);
            }
        } else {
            // unknown slot!
            return null;
        }
    },
    hasSlot: function(key) {
        return !!this.slots[key];
    },
    getSlot: function(key) {
        return this.slots[key];
    },
    setSlot: function(key, thing) {
        this.slots[key] = thing;
        thing._setParent(this, key);
        // DOM manipulation - to be overridden
	    this.slotChanged(key);
        return this;
    },
    clearSlots: function() {
        for(var key in this.slots) {
            this.setSlot(key, Thing.empty());
        }
    },
    setOptions: function(opts) {
        this.options = $.extend(this.options, opts);
        this.refresh();
	    this.slotChanged('options');
    },
    setSlots: function(slots) {
        if(slots) {
            // pokud je parametr pole, udelat z nej objekt
            if($.isArray(slots)) slots = slots.toObject();
            for(var key in slots) {
                this.setSlot(key, slots[key]);
            }
        }
    },
    _setParent: function(parent, key) {
        this.parent = parent;
        this.name = key;
    },
    isEmpty: function() {
        return this.getType() == "empty";
    },
    slotChanged: function(arg) {
        if(typeof arg == "function") {
            this.onslotchanged = arg;
        } else {
            return this.onslotchanged(this, arg);
        }
    },    
    // bez parametru vraci rekurzivne vsechny sloty
    findSlots: function(predicate, out) {
        if(!predicate) predicate = function() { return true; };
        if(!out) out = [];
        if(predicate(this)) out.push(this);
        for(var key in this.slots) {
            this.slots[key].findSlots(predicate, out);
        }
        return out;
    },
    findEmptySlots: function(out) {
        return this.findSlots(function(thing) { return thing.isEmpty(); }, out)
    },
    findSlotsByType: function(type, out) {
        return this.findSlots(function(thing) { return thing.getType() == type; }, out)
    },
    getTree: function() {
        var node = { type: this.getType(), children: {} };
        for(var key in this.slots) {
            node.children[key] = this.slots[key].getTree();
        }
        return node;
    },
    _toggleTreeView: function(node) {
        node.children(".slots").toggleClass('collapsed');
    },
    // TODO mohlo by si to pamatovat expands/collapse mezi updaty
    /* example decorator:
        decorator = function(thing, node) {
            $("<div>").addClass("toolz").insertAfter(node.find(">h2"));
        };
    */
    getTreeView: function(decorator) {
        var self = this;
        var node = $("<div>").addClass('node').attr('data-type', this.getType()).attr('data-tid', this.tid);
        var hdr = $("<h2>").text(this.getType()).appendTo(node);
        var slots = $("<div>").addClass('slots').appendTo(node);
        hdr.click(function() {
            self._toggleTreeView(node);
        });
        for(var key in this.slots) {
            (function(){
                var subtree = self.slots[key].getTreeView(decorator);
                var subheading = $("<h3>").text(key).click(function() {
                    $(this).toggleClass('collapsed');
                    self._toggleTreeView(subtree);
                });
                slots.append(subheading);
                slots.append(subtree);
            })();
        }
        node.append($("<div>").addClass('clear'));
        if(decorator) decorator(this, node);
        return node;
    },
    _type: "thing",
    _defaults: {
        "css": ""
    },
    _klass: "thing",
    _schema: {
       "type":"object",
       "properties":{
       },
       "additionalProperties":true
    }

},{    
    tid: 0,
    things: {},
    create: function(def, opts) {
        if(!def) {
            return Thing.empty();
        }
        // udelat deserializaci
        // { type, options, slots }
        var klassName = def.type.replace(/-([a-z])/g, function (g) { return g[1].toUpperCase() });
        klassName = klassName.capitalize();
        var klazz = window[klassName];
        var slots = def.slots;
        if($.isArray(slots)) slots = slots.toObject();
        for(var key in slots) {
            slots[key] = Thing.create(slots[key]);
        }
        return new klazz($.extend(def.options, opts), slots);
    },
    empty: function(options) {
        return new Empty(options);
    }
});



var Empty = Thing.extend({
    refresh: function() {
        this.element.empty();
        /*
        if(this.parent) this.element.html(
            $("<div>").text(this.parent.getType()+"#"+this.name)
        );
        */
    },
    _setParent: function(parent, key) {
        this.base(parent, key);
        this.refresh();
    },
    _klass: "empty thing",
    _type: "empty"
});


var Imager = Thing.extend({
    refresh: function() {
        var img = $("<div>")
            .css("background-image",'url("'+this.options.url+'")')
            .css('background-position',this.options['position'])
            .css('background-repeat',this.options['repeat'])
            .css('background-color',this.options['color'])
            .css('background-size',this.options['size'])
            .css('-moz-background-size',this.options['size'])
            .css('-webkit-background-size',this.options['size']);
        this.element.html(img);
    },
    _klass: "imager thing",
    _type: "imager",
    _defaults: {
        "url": "images/demo/australie1.jpg",
        "repeat": "no-repeat",
        "position": "center center",
        "color": "white",
        "size": "cover" 
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "color": {
			    "type":"string",
			    "id": "color",
			    "required":true,
                "format": "color"
		    },
		    "position": {
			    "type":"string",
			    "id": "position",
			    "required":true
		    },
		    "repeat": {
			    "type":"string",
			    "id": "repeat",
			    "required":true
		    },
		    "size": {
			    "type":"string",
			    "id": "size",
                "enum":["cover","contain"],
			    "required":true
		    },
		    "url": {
			    "type":"string",
			    "id": "url",
                "format": "my-image-uri",
			    "required":true
		    }
	    }
    }

});


var RaphaelThing = Thing.extend({
    refresh: function() {
        var o = this.options;
        var div = $("<div>");
        this.element.html(div);
        var paper = Raphael(div.get(0), "100%","100%");
        paper.setViewBox(0, 0, o.width, o.height, true);
        this.canvas = paper;
    },
    _klass: "raphael-thing thing",
    _type: "raphael-thing",
    _defaults: {
        width: 100,
        height: 100
    },
    _schema: {
       "type":"object",
       "description":"RaphaelThing properties",
       "properties":{
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }

});


var CanvasThing = Thing.extend({
    init: function() {
        var o = this.options;
        var self = this;
        this.canvas = $("<canvas>").appendTo(this.element).attr({width:o.width, height:o.height});
        // pouziva CSS transformaci, rastr je porad stejne velky
        if(o.autoscale) {
            this.element.resize(function() {
                var el = $(this);
                var o = self.options;
                var zoom = Math.min(el.width()/o.width, el.height()/o.height);
                el.css({
                    "-moz-transform": "scale("+zoom+")", 
                    "-webkit-transform": "scale("+zoom+")", 
                    "-moz-transform-origin":"0px 0px", 
                    "-webkit-transform-origin":"0px 0px"
                });
            });
        }
        // zvetsuje fyzicky pocet pixelu rastru
        if(o.autoresize) {
            this.element.resize(function() {
                var el = $(this);
                var ww = el.width();
                var hh = el.height();
                if(o.keepaspectratio) { var asp = o.width/o.height; if(ww/hh > asp) ww = hh*asp; else hh = ww/asp; }
                self.canvas.attr({
                    "width": ww, 
                    "height": hh
                });
                self.refresh();
            });
            var el = this.element;
            var ww = el.width();
            var hh = el.height();
            if(o.keepaspectratio) { var asp = o.width/o.height; if(ww/hh > asp) ww = hh*asp; else hh = ww/asp; }
            this.canvas.attr({
                "width": ww, 
                "height": hh
            });            
        }
    },
    refresh: function() {
        var context = this.canvas.get(0).getContext('2d');
        if (context) {
            this.draw(context, this.canvas.width() || this.options.width, this.canvas.height() || this.options.height);
        }
    },
    draw: function(g, w, h) {
        /* by default, draws only rectangle... */
        g.strokeRect(0,  0, w, h);
    },
    _klass: "canvas-thing thing",
    _type: "canvas-thing",
    _defaults: {
        width: 100,
        height: 100,
        autoscale: false,
        autoresize: true,
        keepaspectratio: true
    },
    _schema: {
       "type":"object",
       "description":"CanvasThing properties",
       "properties":{
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          },
          "autoscale":{
             "type":"boolean",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


// http://www.nihilogic.dk/labs/javascript_canvas_fractals/
var Fractal = CanvasThing.extend({
    draw: function(ctx, w, h) {
        var smoothColors = this.options.smoothcolors;
        var vx = this.options.vx;
        var vy = this.options.vy;
        var zoom = this.options.zoom;

        var imageData = !!ctx.getImageData;
        var startit = 30;
        var xmin, xmax, ymin, ymax, dx, dy;
        var er = 2;

        var colors = {
	        red : [[0,0,1],[0,1,0],[0,1,0]],
	        blue : [[0,0,0],[0,1,0],[0,1,1]],
	        green : [[0,1,0],[0,0,1],[0,1,0]],
	        orange : [[1,1,1],[0,1,0],[0,0,0]],
	        magenta : [[0,0,1],[0,0.1,0.5],[0,0,1]],
	        yellow : [[0.2,0.2,1],[0.2,0.2,1],[0,0,0.2]],

        };

        var log2 = 1 / Math.log(2.0);
        var sin = Math.sin;
        var cos = Math.cos;
        var exp = Math.exp;
        var phi = 1.6180339887;
        function cosh(a) {
            return (exp(a) + exp(-a))/2;
        }
        function sinh(a) {
            return (exp(a) - exp(-a))/2;
        }
        function csin(x,y) {
	        return [sin(x) * cosh(y), cos(x) * sinh(y)];
        }
        function ccos(x,y) {
	        return [cos(x)*cosh(y), -sin(x)*sinh(y)];
        }
        function cexp(x,y) {
	        return [exp(x)*cos(y), exp(x)*sin(y)];
        }
        function cmul(c1,c2) {
	        return [
		        c1[0]*c2[0]-c1[1]*c2[1],
		        c1[0]*c2[1]+c1[1]*c2[0]
	        ];
        }

        var fractals = {

	        mandelbrot : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        var lastxx, lastyy;
		        do {
			        y = (x+x)*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2) {

				        y = (x+x)*y + y0; // iterate once for more for smoother colors
				        x = xx - yy + x0;
				        yy = y*y;
				        xx = x*x;

				        break;
			        }
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliacubed : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {

			        tx = x;
			        ty = y;

			        tx2 = x*x-y*y;
			        ty2 = 2*x*y;

			        x = tx2*tx-ty2*ty + 1-phi;
			        y = tx2*ty+ty2*tx + 0.3;

			        xx = x*x;
			        yy = y*y;

			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        multibrot3 : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var tx, ty, tx2, ty2;
		        var xx = x*x, yy = y*y;
		        do {
			        tx = x;
			        ty = y;
			        tx2 = xx-yy;
			        ty2 = 2*x*y;
			        x = tx2*tx-ty2*ty + x0;
			        y = tx2*ty+ty2*tx + y0;
			        xx = x*x;
			        yy = y*y;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        multibrot4 : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = 2*x*y;
			        x = xx - yy;
			        yy = y*y;
			        xx = x*x;
			        y = 2*x*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        multibrot8 : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = 2*x*y;
			        x = xx - yy;
			        yy = y*y;
			        xx = x*x;
			        y = 2*x*y;
			        x = xx - yy;
			        yy = y*y;
			        xx = x*x;
			        y = 2*x*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        burningship : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = 2*Math.abs(x*y) - y0;
			        x = xx - yy - x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        tricorn : function(x, y, it, er2) {
		        var x0 = x, y0 = y;
		        var xx = x*x, yy = y*y;
		        do {
			        y = -y;

			        y = (x+x)*y + y0;
			        x = xx - yy + x0;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        julia_base : function(x, y, it, er2, cr, ci) {
		        var xx = x*x, yy = y*y;
		        do {
			        y = (x+x)*y + ci;
			        x = xx - yy + cr;
			        yy = y*y;
			        xx = x*x;

			        if (xx+yy > er2) {
				        y = (x+x)*y + ci;
				        x = xx - yy + cr;
				        yy = y*y;
				        xx = x*x;

				        break;
			        }
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        julia1 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, phi - 2, phi - 1);
	        },

	        julia2 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 1-phi, 0);
	        },

	        julia3 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 0.285, 0);
	        },

	        julia4 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 0.285, 0.01);
	        },

	        julia5 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.835, -0.2321);
	        },

	        julia6 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.7, -0.3);
	        },

	        julia7 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, 0, 1);
	        },

	        julia8 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.391, -0.587);
	        },

	        julia9 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.123, 0.745);
	        },

	        julia10 : function(x, y, it, er2) {
		        return fractals["julia_base"](x, y, it, er2, -0.75, 0);
	        },

	        julia11 : function(x, y, it, er2) {
		        var zr, zi;
		        var cr = 0.6;
		        var ci = 1.1;
		        var xx = x*x, yy = y*y;
		        do {
			        zr = x - (x?(x<0?-1:1):0);
			        zi = y;
			        x = cr*zr-ci*zi;
			        y = cr*zi+ci*zr;
			        yy = y*y;
			        xx = x*x;
			        if (xx+yy > er2)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliasine_base : function(x, y, it, er2, cr, ci) {
		        var xx = x*x, yy = y*y;
		        var z, expy, expmy;
		        var c = [cr, ci];
		        do {
			        //z = csin(x,y);
			        expy = exp(y);
			        expmy = exp(-y);
			        z = [sin(x) * (expy + expmy)/2, cos(x) * (expy - expmy)/2];

			        x = c[0]*z[0]-c[1]*z[1];
			        y = c[0]*z[1]+c[1]*z[0];

			        yy = y*y, xx = x*x;
			        if (xx+yy > 500)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliasine : function(x, y, it, er2) {
		        return fractals["juliasine_base"](x, y, it, er2, 1, 0.1);
	        },

	        juliasine2 : function(x, y, it, er2) {
		        return fractals["juliasine_base"](x, y, it, er2, 1, 0.3);
	        },

	        juliacosine_base : function(x, y, it, er2, cr, ci) {
		        var xx = x*x, yy = y*y;
		        var z, expy, expmy;
		        var c = [cr, ci];
		        do {
			        //z = ccos(x,y);
			        expy = exp(y);
			        expmy = exp(-y);
			        z = [cos(x) * (expy + expmy)/2, -sin(x) * (expy - expmy)/2];

			        x = c[0]*z[0]-c[1]*z[1];
			        y = c[0]*z[1]+c[1]*z[0];

			        yy = y*y, xx = x*x;
			        if (xx+yy > 500)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

	        juliacosine : function(x, y, it, er2) {
		        return fractals["juliacosine_base"](x, y, it, er2, 1, 0.6);
	        },

	        juliacosine2 : function(x, y, it, er2) {
		        return fractals["juliacosine_base"](x, y, it, er2, Math.PI/2 * 1.5, Math.PI/2 * 0.05);
	        },

	        juliacosine3 : function(x, y, it, er2) {
		        var xx = x*x, yy = y*y;
		        var z, expy, expmy;
		        var c = [1, 0.1];
		        do {
			        //z = ccos(x,y);
			        expy = exp(y);
			        expmy = exp(-y);
			        z = [cos(x) * (expy + expmy)/2, -sin(x) * (expy - expmy)/2];

			        x = c[0]*z[0]-c[1]*z[1];
			        y = c[0]*z[1]+c[1]*z[0];

			        tx = x;
			        x = -y;
			        y = tx;

			        yy = y*y, xx = x*x;
			        if (xx+yy > 500)
				        break;
		        } while(--it)
		        return {
			        it : it, x : x, y : y, xx : xx, yy : yy
		        };
	        },

        };

        // from http://www.nihilogic.dk/labs/javascript_canvas_fractals/
        function render(fncFrac, colWeights) {
	        var time = new Date().getTime();

	        ctx.fillStyle = "#000000";
	        ctx.fillRect(0,0,w,h);

	        if (imageData) {
		        var data = ctx.getImageData(0,0,w,h);
		        var pixels = data.data;
	        }

	        var mi = Math.max(startit, Math.round(Math.max(Math.log(zoom),1) * startit));
	        var itfac = 1/mi*startit

	        xmin = vx - 2/zoom;
	        xmax = vx + 2/zoom;
	        ymin = vy - 2/zoom;
	        ymax = vy + 2/zoom;

	        dx = xmax-xmin;
	        dy = ymax-ymin;

	        var px, py, it;

	        var er2 = er*er;

	        var c1, c2, c3, m;
	        var col1, col2, col3;
	        var cw0 = colWeights[0], cw1 = colWeights[1], cw2 = colWeights[2];

	        var i = (w*h)-1;
	        do {
		        var offset = i*4;

		        px = (i%w);
		        py = h-((i/w)|0);

		        var res = fncFrac(
			        xmin + px/w * dx, 
			        ymin + py/h * dy, 
			        mi, er2
		        )

		        it = mi - res.it;

		        var mag = smoothColors ? 
				        (it * itfac) - (Math.log(Math.log(res.xx+res.yy))) * log2
				        : it * itfac;

		        //if (color == "bw") {
			    //    c1 = c2 = c3 = 
				//        (res.it==mi) ? 255 : 255 - mag/startit * 255;
		        //} else {
			        if (res.it == 0)
				        continue;

			        if (mag < startit/3) {
				        m = (mag*3);
				        col1 = m * 4;
				        col2 = m * 4;
				        col3 = m * 10;
			        } else if (mag < startit/1.5) {
				        m = (mag-startit/3)*3;
				        col1 = 80 + m * 8;
				        col2 = 80 + m * 8;
				        col3 = 200 + m * 2.5;
			        } else {
				        m = (mag-2*startit/3)*3
				        col1 = 220 + m * 1.5;
				        col2 = 220 + m * 1.5;
				        col3 = 255;
			        }

			        c1 = col1*cw0[0] + col2*cw0[1] + col3*cw0[2];
			        c2 = col1*cw1[0] + col2*cw1[1] + col3*cw1[2];
			        c3 = col1*cw2[0] + col2*cw2[1] + col3*cw2[2];
		        //}

		        c1 = c1 < 0 ? 0 : c1;
		        c2 = c2 < 0 ? 0 : c2;
		        c3 = c3 < 0 ? 0 : c3;

		        c1 = c1 > 255 ? 255 : c1;
		        c2 = c2 > 255 ? 255 : c2;
		        c3 = c3 > 255 ? 255 : c3;

		        if (!imageData) {
			        ctx.fillStyle = "rgb(" + (c1|0) + "," + (c2|0) + "," + (c3|0) + ")";
			        ctx.fillRect((px|0), h-((py|0)), 1, 1);
		        } else {
			        pixels[offset] = c1;
			        pixels[offset+1] = c2;
			        pixels[offset+2] = c3;
		        }

	        } while(--i);

	        if (imageData) {
		        ctx.putImageData(data,0,0);
		        ctx.fillRect(0,0,0,0);
	        }
        };

        render(fractals[this.options.algorithm], colors[this.options.color]);
    },
    _klass: "fractal thing",
    _type: "fractal",
    _defaults: {
        width: 300,
        height: 300,
        autoscale: false,
        autoresize: true,
        keepaspectratio: true,
        algorithm: "mandelbrot",
        color: "yellow",
        smoothcolors: true,
        vx: 0.3,
        vy: 0,
        zoom: 10
    },
    _schema: {
       "type":"object",
       "description":"Fractal properties",
       "properties":{
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          },
          "autoscale":{
             "type":"boolean",
             "required":false
          }
       },
       "additionalProperties":true
    }
});


var Html = Thing.extend({
    init: function() {
        this.inner = $("<div>");
        this.element.html(this.inner);
    },
    refresh: function() {
        this.base();
        this.inner.html(this.options.html).attr('class',this.options.innerCss);
    },
    _klass: "html thing",
    _type: "html",
    _defaults: {
        html: ""
    },
    _schema: {
       "type":"object",
       "description":"Html properties",
       "properties":{
          "html":{
             "type":"string",
             "required":true
          },
          "css":{
             "type":"string",
             "required":false
          },
          "innerCss":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


var Svg = Thing.extend({
    init: function() {
    },
    refresh: function() {
        this.base();
        this.element.html(this.options.svg);
    },
    _klass: "svg thing",
    _type: "svg",
    _defaults: {
        svg: '<svg xmlns="http://www.w3.org/2000/svg" version="1.1">'
    },
    _schema: {
       "type":"object",
       "description":"Svg properties",
       "properties":{
          "svg":{
             "type":"string",
             "required":true
          },
          "width":{
             "type":"string",
             "required":false
          },
          "height":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


var SvgEditor = Thing.extend({
    change: function(arg) {
        if(typeof arg == 'function') {
            this.onchange = arg;
        } else {
            this.onchange(arg);
        }
    },
    init: function() {
        var self = this;
        self.onchange = $.noop;
        self.frame = $('<iframe src="'+baseUrl+'testing/svgedit">').attr('width',self.options.width).attr('height', self.options.height);
        self.frame.ready(function() {
            // http://code.google.com/p/svg-edit/wiki/TipsAndTricks
            // waiting for real load
            (function(){
                try {
                    var cw = self.frame[0].contentWindow;
                    var md = cw.methodDraw;
                    md.ready(function() {     
                        cw.svgCanvas.setSvgString(self.options.svg);
                    });        
                    md.addExtension("server_opensave", {
                        callback: function() {
                            md.setCustomHandlers({
	                            save: function(win, data) {
		                            self.options.svg = data;
                                    self.onchange(data);
	                            }
                            });
                        }
                    });
                }
                catch (Ex){
                    setTimeout(arguments.callee, 1000);
                }
            })();
        });
        self.frame.appendTo(self.element);
    },
    refresh: function() {
        this.base();
    },
    _klass: "svg-editor thing",
    _type: "svg-editor",
    _defaults: {
        svg: '<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100" height="100"></svg>',
        width: "800px",
        height: "600px"
    },
    _schema: {
       "type":"object",
       "description":"SvgEditor properties",
       "properties":{
          "svg":{
             "type":"string",
             "required":true
          },
          "width":{
             "type":"string",
             "required":false
          },
          "height":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }

});


var TextThing = Html.extend({
    refresh: function() {
        this.base();
        var o = this.options;
        if(o['h-align'] && o['h-align'] != 'center') this.inner.addClass(o['h-align']);
        if(o['v-align'] && o['v-align'] != 'center') this.inner.addClass(o['v-align']);
        this.inner.css('font-size', o['font-size']);
        this.inner.css('font-family', o['font-family']);
    },
    _klass: "text-thing html thing",
    _type: "text-thing",
    _defaults: {
        "html": "",
        "css": "",
        "h-align": "center",
        "v-align": "center",
        "font-size": "20px",
        "font-family": "Georgia, serif"
    },
    _schema: {
       "type":"object",
       "properties":{
          "html":{
             "type":"string",
	     "format":"richtext",
             "required":true
          },
          "h-align":{
             "type":"string",
             "enum":["left","center","right"],
             "required":false
          },
          "v-align":{
             "type":"string",
             "enum":["top","center","bottom"],
             "required":false
          },
          "font-size":{
             "type":"string",
             "enum":["50%","60%","75%", "85%", "100%", "120%", "150%", "175%", "200%", "250%"],
             "required":false
          },
          "font-family":{
             "type":"string",
             "enum":[
'Arial,Arial,Helvetica,sans-serif',
'Arial Black,Arial Black,Gadget,sans-serif',
'Comic Sans MS,Comic Sans MS,cursive',
'Courier New,Courier New,Courier,monospace',
'Georgia,Georgia,serif',
'Impact,Charcoal,sans-serif',
'Lucida Console,Monaco,monospace',
'Lucida Sans Unicode,Lucida Grande,sans-serif',
'Palatino Linotype,Book Antiqua,Palatino,serif',
'Tahoma,Geneva,sans-serif',
'Times New Roman,Times,serif',
'Trebuchet MS,Helvetica,sans-serif',
'Verdana,Geneva,sans-serif' 
],
             /*"format":"font",*/
             "required":false
          }
       },
       "additionalProperties":true
    }
});


var Templated = Thing.extend({
    refresh: function() {
        var tmpl = $.templates( "#"+this.options.template+"Template" );
        var html = tmpl.render(this.options);
        this.element.html(html);
        this.element.find("[data-slot]").each(function() { 
            $(this).html(Thing.empty().get()); 
        });
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.find("[data-slot='"+key+"']").html(value.get());
        return this;
    },
    _klass: "templated thing",
    _type: "templated",
    _defaults: {
        template: "demo",
        name: "Myrousz"
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "template": {
			    "type":"string",
			    "required":true
		    },
		    "name": {
			    "type":"string",
			    "required":true
		    }
	    }
    }
});


var Snippet = Thing.extend({
    refresh: function() {
        var o = this.options;
        var code = $("<pre>").text(o.code);
        this.element.html(code);
        SyntaxHighlighter.highlight({title: o.title, 'brush':o.lang}, code.get(0));        
    },
    _klass: "snippet thing",
    _type: "snippet",
    _defaults: {
        "title": "",
        "lang": "js",
        "code": ""
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "title": {
			    "type":"string",
			    "required":false
		    },
		    "lang": {
			    "type":"string",
                "enum":["js","php","plain"],
			    "required":true
		    },
		    "code": {
			    "type":"string",
			    "required":true
		    }
	    }
    }
});


var SoftKeyboard = Thing.extend({
    init: function() {
        this.keys = {};
        this.onkeypress = $.noop;
    },
    refresh: function() {
        var kbd = $("<div>");
        var rows = this.options.rows;
        var cols = this.options.rows;
        for(var key in this.options.keys) {
            var k = this.options.keys[key];
            var kk = this._makeKey(key, k).appendTo(kbd);
            this.keys[key] = kk;
        }
        this.element.html(kbd);
    },
    getKeyButton: function(key) {
        return {"name":key, "button":this.keys[key], "key":this.options.keys[key]};
    },
    _makeKey: function(name, k) {
        var self = this;
        var o = this.options;
        var top = Math.floor(100*k.top/o.rows) + "%";
        var left = Math.floor(100*k.left/o.columns) + "%";
        var ww = k.size || k.width;
        var hh = k.size || k.height;
        var mm = 2;
        var width = Math.floor(100*ww/o.columns) + "%";
        var height = Math.floor(100*hh/o.rows) + "%";
        var div = $("<button>").addClass("key key-"+name).css({'top':top, 'left':left, 'width':width, 'height':height}).append($("<div>").text(k.label));
        div.click(function() {
            if(k['switch']) {
                div.toggleClass("active");
            }
            self.keyPressed(self.getKeyButton(name));
        });
        return div;
    },
    keyPressed: function(kb) {
        if(typeof kb == 'function') {
            this.onkeypress = kb;
        } else {
            this.onkeypress(kb);
        }
    },
    getSwitchState: function(name) {
        if(this.options.keys[name] && this.options.keys[name]['switch']) {
            return this.keys[name].hasClass("active");
        } else {
            return false;
        }
    },    
    _klass: "soft-keyboard thing",
    _type: "soft-keyboard",
    _defaults: {
        "rows": 8,
        "columns": 20,
        "keys": {
            "q" : { "left":0, "top":0, "size":2, "label":"Q"},
            "w" : { "left":2, "top":0, "size":2, "label":"W"},
            "e" : { "left":4, "top":0, "size":2, "label":"E"},
            "r" : { "left":6, "top":0, "size":2, "label":"R"},
            "t" : { "left":8, "top":0, "size":2, "label":"T"},
            "y" : { "left":10, "top":0, "size":2, "label":"Y"},
            "u" : { "left":12, "top":0, "size":2, "label":"U"},
            "i" : { "left":14, "top":0, "size":2, "label":"I"},
            "o" : { "left":16, "top":0, "size":2, "label":"O"},
            "p" : { "left":18, "top":0, "size":2, "label":"P"},
            "a" : { "left":1, "top":2, "size":2, "label":"A"},
            "s" : { "left":3, "top":2, "size":2, "label":"S"},
            "d" : { "left":5, "top":2, "size":2, "label":"D"},
            "f" : { "left":7, "top":2, "size":2, "label":"F"},
            "g" : { "left":9, "top":2, "size":2, "label":"G"},
            "h" : { "left":11, "top":2, "size":2, "label":"H"},
            "j" : { "left":13, "top":2, "size":2, "label":"J"},
            "k" : { "left":15, "top":2, "size":2, "label":"K"},
            "l" : { "left":17, "top":2, "size":2, "label":"L"},
            "caps" : { "left":0, "top":4, "width":3, "height":2, "label":__("caps"), "switch":true},
            "z" : { "left":3, "top":4, "size":2, "label":"Z"},
            "x" : { "left":5, "top":4, "size":2, "label":"X"},
            "c" : { "left":7, "top":4, "size":2, "label":"C"},
            "v" : { "left":9, "top":4, "size":2, "label":"V"},
            "b" : { "left":11, "top":4, "size":2, "label":"B"},
            "n" : { "left":13, "top":4, "size":2, "label":"N"},
            "m" : { "left":15, "top":4, "size":2, "label":"M"},
            "del" : { "left":17, "top":4, "width":3, "height":2, "label":__("del")},
            "nums" : { "left":0, "top":6, "width":4, "height":2, "label":__("?123")},
            "comma" : { "left":4, "top":6, "width":3, "height":2, "label":","},
            "space" : { "left":7, "top":6, "width":6, "height":2, "label":__("space")},
            "dot" : { "left":13, "top":6, "width":3, "height":2, "label":"."},
            "enter" : { "left":16, "top":6, "width":4, "height":2, "label":__("enter")}
        }
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "rows": {
			    "type":"integer",
			    "required":true
		    },
		    "columns": {
			    "type":"integer",
			    "required":true
		    }
	    }
    }
});


var SoftTextEditor = Thing.extend({
    init: function() {
        var self = this;
        this.onchange = $.noop;
        this.keyboard = new SoftKeyboard();
        this.keyboard.keyPressed(function(kb) {
            self._keyPressed(kb);
        });
        this.textfield = $("<textarea>").val(this.options.value).change(function() {
            self.options.value = $(this).val();
        });
        this.buttonOk = $("<button>").addClass('done').text(__("Done")).click(function() {
            self.change(self.textfield.val());
        });
        this.element
            .append($("<div>").addClass("textfield").append(this.textfield))
            .append($("<div>").addClass("btn").append(this.buttonOk))            
            .append(this.keyboard.get());
    },
    refresh: function() {
        this.textfield.val(this.options.value);
    },
    // TODO napojit
    change: function(arg) {
        if(typeof arg == 'function') {
            this.onchange = arg;
        } else {
            this.onchange(arg);
        }
    },
    _keyPressed: function(kb) {
        var cc = kb.name;
        switch(cc) {
            case 'caps': 
                this.capsLock = this.keyboard.getSwitchState('caps');
                break;
            case 'del':
                // delete last character
                this.options.value = this.options.value.slice(0, -1);
                this.refresh();
                break;
            case 'nums': 
                break;
            case 'enter':
                this.options.value += "\n";
                this.refresh();
                break;
            case 'comma':
                this.options.value += ",";
                this.refresh();
                break;
            case 'space':
                this.options.value += " ";
                this.refresh();
                break;
            case 'dot':
                this.options.value += ".";
                this.refresh();
                break;
            default:
                if(this.capsLock) {
                    // invert case...
                    cc = ( cc >= 'A' && cc <= 'Z' ) ? cc.toLowerCase() : cc.toUpperCase();
                }
                this.options.value += cc;
                this.refresh();
        }
    },
    _klass: "soft-text-editor thing",
    _type: "soft-text-editor",
    _defaults: {
        "value": ""
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "value": {
			    "type":"string",
			    "required":true
		    }
	    }
    }
});



var HolidayCalendar = {
    // kdy je velikonocni nedele - bozi hod velikonocni?
    easter: {
        "2012": {month: 4, day: 8},
        "2013": {month: 3, day: 31},
        "2014": {month: 4, day: 20},
        "2015": {month: 4, day: 5}
    },
    data: 
// BEGIN JSON DATA
[
    {
        "month": "Leden",
        "days": [
            {
                "number": "1",
                "names": [
                    "Nový rok"/*,
                    "Den obnovy samostatného českého státu"*/
                ],
                "holiday": true
            },
            {
                "number": "2",
                "names": [
                    "Karina"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Radmila"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Diana"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Dalimil"
                ]
            },
            {
                "number": "6",
                "names": [
                    /*"Kašpar",
                    "Melichar",
                    "Baltazar"*/"Tři králové"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Vilma"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Čestmír"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Vladan"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Břetislav"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Bohdana"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Pravoslav"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Edita"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Radovan"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Alice"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Ctirad"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Drahoslav"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Vladislav"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Sára/Doubravka"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Ilona"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Běla"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Slavomír"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Zdeněk"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Milena"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Miloš"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Zora"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Ingrid"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Otýlie"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Zdislava"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Robin"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Marika"
                ]
            }
        ]
    },
    {
        "month": "Únor",
        "days": [
            {
                "number": "1",
                "names": [
                    "Hynek"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Nela"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Blažej"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Jarmila"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Dobromila"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Vanda"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Veronika"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Milada"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Apolena"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Mojmír"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Božena"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Slavěna"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Věnceslav"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Valentýn"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Jiřina"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Ljuba"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Miloslava"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Gizela"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Patrik"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Oldřich"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Lenka"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Petr"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Svatopluk"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Matěj"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Liliana"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Dorota"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Alexandr"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Lumír"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Horymír"
                ]
            }
        ]
    },
    {
        "month": "Březen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Bedřich"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Anežka"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Kamil"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Stela"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Kazimír"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Miroslav"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Tomáš"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Gabriela"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Františka"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Viktorie"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Anděla"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Řehoř"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Růžena"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Matylda/Rút"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Ida"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Herbert/Elena"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Vlastimil"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Eduard"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Josef"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Světlana"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Radek"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Leona"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Ivona"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Gabriel"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Marian"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Emanuel"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Dita"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Soňa"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Taťána"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Arnošt"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Kvido"
                ]
            }
        ]
    },
    {
        "month": "Duben",
        "days": [
            {
                "number": "1",
                "names": [
                    "Hugo"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Erika"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Richard"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Ivana"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Miroslava"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Vendula"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Hermína/Herman"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Ema"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Dušan"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Darja"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Izabela"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Július"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Aleš"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Vincenc"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Anastázie"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Irena"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Rudolf"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Valérie"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Rostislav"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Marcela"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Alexandra"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Evženie"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Vojtěch"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jiří"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Marek"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Oto"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Jaroslav"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Vlastislav"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Robert"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Blahoslav"
                ]
            }
        ]
    },
    {
        "month": "Květen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Svátek práce"
                ],
                "holiday": true
            },
            {
                "number": "2",
                "names": [
                    "Zikmund"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Alexej"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Květoslav"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Klaudie"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Radoslav"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Stanislav"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Den vítězství"
                ],
                "holiday": true
            },
            {
                "number": "9",
                "names": [
                    "Ctibor"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Blažena"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Svatava"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Pankrác"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Servác"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Bonifác"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Žofie"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Přemysl"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Aneta"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Nataša"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Ivo"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Zbyšek"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Monika"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Emil"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Vladimír"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jana"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Viola"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Filip"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Valdemar"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Vilém"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Maxmilián"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Ferdinand"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Kamila"
                ]
            }
        ]
    },
    {
        "month": "Červen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Laura"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Jarmil"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Tamara"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Dalibor"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Dobroslav"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Norbert"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Iveta"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Medard"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Stanislava"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Gita"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Bruno"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Antonie"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Antonín"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Roland"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Vít"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Zbyněk"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Adolf"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Milan"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Leoš"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Květa"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Alois"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Pavla"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Zdeňka"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jan"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Ivan"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Adriana"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Ladislav"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Lubomír"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Petr a Pavel"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Šárka"
                ]
            }
        ]
    },
    {
        "month": "Červenec",
        "days": [
            {
                "number": "1",
                "names": [
                    "Jaroslava"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Patricie"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Radomír"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Prokop"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Cyril a Metoděj"
                ],
                "holiday": true
            },
            {
                "number": "6",
                "names": [
                    /*"Den upálení Mistra Jana Husa"*/"Jan Hus"
                ],
                "holiday": true
            },
            {
                "number": "7",
                "names": [
                    "Bohuslava"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Nora"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Drahoslava"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Libuše/Amálie"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Olga"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Bořek"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Markéta"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Karolína"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Jindřich"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Luboš"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Martina"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Drahomíra"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Čeněk"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Ilja/Eliáš"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Vítězslav"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Magdalena"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Libor"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Kristýna"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Jakub"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Anna"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Věroslav"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Viktor"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Marta"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Bořivoj"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Ignác"
                ]
            }
        ]
    },
    {
        "month": "Srpen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Oskar"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Gustav"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Miluše"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Dominik"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Kristián"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Oldřiška"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Lada"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Soběslav"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Roman"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Vavřinec"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Zuzana"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Klára"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Alena"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Alan"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Hana"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Jáchym"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Petra"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Helena"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Ludvík"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Bernard"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Johana"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Bohuslav"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Sandra"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Bartoloměj"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Radim"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Luděk"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Otakar"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Augustýn"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Evelína"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Vladěna"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Pavlína"
                ]
            }
        ]
    },
    {
        "month": "Září",
        "days": [
            {
                "number": "1",
                "names": [
                    "Linda/Samuel"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Adéla"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Bronislav"
                    /* /Bronislava"*/
                ]
            },
            {
                "number": "4",
                "names": [
                    "Jindřiška"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Boris"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Boleslav"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Regina"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Mariana"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Daniela"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Irma"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Denisa"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Marie"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Lubor"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Radka"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Jolana"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Ludmila"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Naděžda"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Kryštof"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Zita"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Oleg"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Matouš"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Darina"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Berta"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Jaromír"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Zlata"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Andrea"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Jonáš"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Václav"/*,
                    "Den české státnosti"*/
                ],
                "holiday": true
            },
            {
                "number": "29",
                "names": [
                    "Michal"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Jeroným"
                ]
            }
        ]
    },
    {
        "month": "Říjen",
        "days": [
            {
                "number": "1",
                "names": [
                    "Igor"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Olivie/Oliver"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Bohumil"
                ]
            },
            {
                "number": "4",
                "names": [
                    "František"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Eliška"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Hanuš"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Justýna"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Věra"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Štefan/Sára"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Marina"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Andrej"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Marcel"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Renáta"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Agáta"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Tereza"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Havel"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Hedvika"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Lukáš"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Michaela"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Vendelín"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Brigita"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Sabina"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Teodor"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Nina"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Beáta"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Erik"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Šarlota/Zoe"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Státní svátek"/*,
                    "Den vzniku samostatného československého státu"*/
                ],
                "holiday": true
            },
            {
                "number": "29",
                "names": [
                    "Silvie"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Tadeáš"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Štěpánka"
                ]
            }
        ]
    },
    {
        "month": "Listopad",
        "days": [
            {
                "number": "1",
                "names": [
                    "Felix"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Památka zesnulých"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Hubert"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Karel"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Miriam"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Liběna"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Saskie"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Bohumír"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Bohdan"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Evžen"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Martin"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Benedikt"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Tibor"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Sáva"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Leopold"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Otmar"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Mahulena"/*,
                    "Den boje za svobodu a demokracii"*/
                ],
                "holiday": true
            },
            {
                "number": "18",
                "names": [
                    "Romana"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Alžběta"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Nikola"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Albert"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Cecílie"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Klement"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Emílie"
                ]
            },
            {
                "number": "25",
                "names": [
                    "Kateřina"
                ]
            },
            {
                "number": "26",
                "names": [
                    "Artur"
                ]
            },
            {
                "number": "27",
                "names": [
                    "Xenie"
                ]
            },
            {
                "number": "28",
                "names": [
                    "René"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Zina"
                ]
            },
            {
                "number": "30",
                "names": [
                    "Ondřej"
                ]
            }
        ]
    },
    {
        "month": "Prosinec",
        "days": [
            {
                "number": "1",
                "names": [
                    "Iva"
                ]
            },
            {
                "number": "2",
                "names": [
                    "Blanka"
                ]
            },
            {
                "number": "3",
                "names": [
                    "Svatoslav"
                ]
            },
            {
                "number": "4",
                "names": [
                    "Barbora"
                ]
            },
            {
                "number": "5",
                "names": [
                    "Jitka"
                ]
            },
            {
                "number": "6",
                "names": [
                    "Mikuláš"
                ]
            },
            {
                "number": "7",
                "names": [
                    "Ambrož/Benjamín"
                ]
            },
            {
                "number": "8",
                "names": [
                    "Květoslava"
                ]
            },
            {
                "number": "9",
                "names": [
                    "Vratislav"
                ]
            },
            {
                "number": "10",
                "names": [
                    "Julie"
                ]
            },
            {
                "number": "11",
                "names": [
                    "Dana"
                ]
            },
            {
                "number": "12",
                "names": [
                    "Simona"
                ]
            },
            {
                "number": "13",
                "names": [
                    "Lucie"
                ]
            },
            {
                "number": "14",
                "names": [
                    "Lydie"
                ]
            },
            {
                "number": "15",
                "names": [
                    "Radana"
                ]
            },
            {
                "number": "16",
                "names": [
                    "Albína"
                ]
            },
            {
                "number": "17",
                "names": [
                    "Daniel"
                ]
            },
            {
                "number": "18",
                "names": [
                    "Miloslav"
                ]
            },
            {
                "number": "19",
                "names": [
                    "Ester"
                ]
            },
            {
                "number": "20",
                "names": [
                    "Dagmar"
                ]
            },
            {
                "number": "21",
                "names": [
                    "Natálie"
                ]
            },
            {
                "number": "22",
                "names": [
                    "Šimon"
                ]
            },
            {
                "number": "23",
                "names": [
                    "Vlasta"
                ]
            },
            {
                "number": "24",
                "names": [
                    "Adam a Eva"/*,
                    "Štědrý den"*/
                ],
                "holiday": true
            },
            {
                "number": "25",
                "names": [
                    "Boží hod vánoční"
                ],
                "holiday": true
            },
            {
                "number": "26",
                "names": [
                    "Štěpán"/*,
                    "Druhý svátek vánoční"*/
                ],
                "holiday": true
            },
            {
                "number": "27",
                "names": [
                    "Žaneta"
                ]
            },
            {
                "number": "28",
                "names": [
                    "Bohumila"
                ]
            },
            {
                "number": "29",
                "names": [
                    "Judita"
                ]
            },
            {
                "number": "30",
                "names": [
                    "David"
                ]
            },
            {
                "number": "31",
                "names": [
                    "Silvestr"
                ]
            }
        ]
    }
]
// END JSON DATA
};

var Calendar = RaphaelThing.extend({
    /* canvas size: 1000x1000 */
    refresh: function() { 
        this.base();   
        var d = this.options;
        this.paper = this.canvas;
        this.paper.clear();
        this.lineAttr = { "fill": "none", "stroke": d.lineColor};
        this.monthNameAttr = { "stroke": "none", "fill": d.fontColor, "font-family":d.fontFamily, "font-size":d.titleFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.monthCapAttr = { "fill": d.fontColor, "stroke": "none", "font-family":d.fontFamily, "font-size":d.dayCapFontSize, "font-style":d.fontStyle};
        this.dayNumAttr = { "stroke": "none", "fill":d.fontColor, "font-family":d.fontFamily, "font-weight":"bold", "font-size":d.numbersFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.dayNameAttr = { "stroke": "none", "fill": d.fontColor, "font-family":d.fontFamily, "font-size":d.namesFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.dayNumAttrHigh = { "stroke": "none", "fill": d.fontColorHigh, "font-family":d.fontFamily, "font-weight":"bold", "font-size":d.numbersFontSize, "font-style":d.fontStyle, "text-anchor":"end"};
        this.dayNameAttrHigh = { "stroke": "none", "fill": d.fontColorHigh, "font-family":d.fontFamily, "font-size":d.namesFontSize, "font-style":d.fontStyle, "text-anchor":"end"};

        this.monthCapOffset = 12;
        this.boxWidth = 142;
        this.boxHeight = 142;
        this.drawMonth(d.year, d.month);
        // HACK: https://github.com/DmitryBaranovskiy/raphael/issues/491
        this.element.find("tspan").attr("dy", 0);
    },

    drawMonthGrid: function(rows, x, y) {
        // draws grid 7x5 with day captions
        for(var i=0; i<=7; i++) {
            // draw captions
            // draw vertical lines
            var xx = x + i*this.boxWidth;
            var str = "M"+xx+","+y+"l0,"+rows*this.boxHeight;
            this.paper.path(str).attr(this.lineAttr); 
            if(i<7) this.paper.text(xx+this.boxWidth/2, y-this.monthCapOffset, this.locale[this.currentLocale].daysOfWeek[i]).attr(this.monthCapAttr);
        }
        for(var j=0; j<=rows; j++) {
            // draw horizontal lines
            var yy = y + j*this.boxHeight;
            var str = "M"+x+","+yy+"l"+7*this.boxWidth+",0";
            this.paper.path(str).attr(this.lineAttr);            
        }                    
    },

    drawDayBox: function(row, column, year, month, day, x, y) {
        // is day sunday?
        var sunday = this.getDayOfWeek(year, month, day) == 0;
        // is day holiday?
        var holiday = HolidayCalendar.data[month-1].days[day-1].holiday;

        var xx = x + (column+1)*this.boxWidth - 5;
        // print number...
        var yy = y + (row+1-0.45)*this.boxHeight - 5;
        this.paper.text(xx, yy, day).attr((sunday || holiday) ? this.dayNumAttrHigh : this.dayNumAttr);
        // print name
        var yy = y + (row+1-0.1)*this.boxHeight - 5;
        this.paper.text(xx, yy, HolidayCalendar.data[month-1].days[day-1].names[0]).attr(holiday ? this.dayNameAttrHigh : this.dayNameAttr);
    },

    drawMonth: function(year, month) {
        var x = 0;
        var column = this.getDayOfWeek(year, month, 1);
        // nedele = 0! pondeli 1...
        column = (column==0) ? 6 : column-1;
        // how many total rows?
        lastColumn = column+HolidayCalendar.data[month-1].days.length;
        var totalRows = Math.floor((lastColumn+6)/7);
        var y = 7*this.boxHeight - totalRows*this.boxHeight;
        // draw month name
        var mn = this.locale[this.currentLocale].months[month-1] + " "+year;
        this.drawMonthGrid(totalRows, x, y);
        this.paper.text(x+7*this.boxWidth, y-0.7*this.boxHeight, mn).attr(this.monthNameAttr);
        var row = 0;
        for(var i=0; i<HolidayCalendar.data[month-1].days.length; i++) {
            this.drawDayBox(row, column, year, month, i+1, x, y);
            column++;
            if(column == 7) {
                column = 0;
                row++;
            }
        }

    },
    locale: {
        "en": {
            "months": [
                "January","February","March","April","May","June","July","August","September","October","November","December"
            ],
            "daysOfWeek": [
                "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"
            ]
        },
        "cz": {
            "months": [
                "Leden","Únor","Březen","Duben","Květen","Červen","Červenec","Srpen","Září","Říjen","Listopad","Prosinec"
            ],
            "daysOfWeek": [
                "Pondělí", "Úterý", "Středa", "Čtvrtek", "Pátek", "Sobota", "Neděle"
            ]
        }
    },
    currentLocale: 'cz',
    getDayOfWeek: function(year, month, day) {
        var d = new Date(year, month-1, day, 0, 0, 0, 0);
        return d.getDay();
    },
    isLeapYear: function(yr) {
        return new Date(yr,2-1,29).getDate()==29;
    },

    _klass: "calendar raphael-thing thing",
    _type: "calendar",
    _defaults: {
        width: 1000,
        height: 1000,
        year: 2012,
        month: 12,
        fontFamily: "Arial", 
        fontStyle: "italic", 
        lineColor: "black",
        fontColor: "black",
        fontColorHigh: "red",
        titleFontSize: "40",
        dayCapFontSize: "20",
        numbersFontSize: "60",
        namesFontSize: "16"
    },
    _schema: {
       "type":"object",
       "description":"Calendar properties",
       "properties":{
          "year":{
             "type":"string",
             "enum":["2012", "2013","2014","2015"],
             "required":true
          },
          "month":{
             "type":"string",
             "enum":["1", "2","3","4","5","6","7","8","9","10","11","12"],
             "required":true
          },
            // .....
          "titleFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "dayCapFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "numbersFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "namesFontSize":{
             "type":"string",
             "enum":["15", "20", "30","40","50", "60", "70", "80"],
             "required":false
          },
          "fontFamily":{
             "type":"string",
             "enum":["Georgia, serif","Arial, Helvetica, sans-serif","Impact, Charcoal, sans-serif", "Tahoma, Geneva, sans-serif", "Verdana, Geneva, sans-serif", "Monaco, monospace"],
             "required":true
          },
          "fontStyle":{
             "type":"string",
             "enum":["regular","italic","monospace"],
             "required":true
          }
       },
       "additionalProperties":true
    }
});



// TODO kdyz zmenim parametry hodin a ulozim, nepromitne se to do inputu

var Clock = RaphaelThing.extend({
    refresh: function() {
        this.base();
        var 
            o = this.options,
            size = o.size,
            canvas = this.canvas,
            clock = canvas.circle(size*.5,size*.5, size * .475);
        clock.attr({"fill":o.fillColor,"stroke":o.strokeColor,"stroke-width":(size*.025)})
        var hour_sign;
        for(i=0;i<12;i++){
            var start_x = size*.5+Math.round((size*.4)*Math.cos(30*i*Math.PI/180));
            var start_y = size*.5+Math.round((size*.4)*Math.sin(30*i*Math.PI/180));
            var end_x = size*.5+Math.round((size*.45)*Math.cos(30*i*Math.PI/180));
            var end_y = size*.5+Math.round((size*.45)*Math.sin(30*i*Math.PI/180));
            hour_sign = canvas.path("M"+start_x+" "+start_y+"L"+end_x+" "+end_y);
        }
        this.hour_hand = canvas.path("M" + size*.5 + " " + size*.5 + "L" + size*.5 + " " + (size*.25) + "");
        this.hour_hand.attr({stroke: o.hourHandColor, "stroke-width": size*.03});
        this.minute_hand = canvas.path("M" + size*.5 + " " + size*.5 + "L" + size*.5 + " " + (size*.2) + "");
        this.minute_hand.attr({stroke: o.minuteHandColor, "stroke-width": size*.02});
        this.second_hand = canvas.path("M" + size*.5 + " " + (size*.55) + "L" + size*.5 + " " + (size*.125) + "");
        this.second_hand.attr({stroke: o.secondHandColor, "stroke-width": size*.01});
        var pin = canvas.circle(size*.5, size*.5, size*.025);
        pin.attr("fill", o.pinColor);

        var self = this;
        var updater = function() {
            self.update();
        };
        updater();
        setInterval(updater,1000); 
    },
    update: function() {
        var self = this,
            size = this.options.size,
            now = new Date(),
            hours = now.getHours(),
            minutes = now.getMinutes(),
            seconds = now.getSeconds(),
            cc = ","+(size*.5)+","+(size*.5);
        self.hour_hand.transform('r'+(30*hours+(minutes/2.5))+cc);
        self.minute_hand.transform('r'+(6*minutes)+cc);
        self.second_hand.transform('r'+(6*seconds)+cc);
    },
    _klass: "clock raphael-thing thing",
    _type: "clock",
    _defaults: {
        width: 100,
        height: 100,
        size: 100,
        fillColor: "white", 
        strokeColor: "black", 
        pinColor: "gray",
        hourHandColor:"black", 
        minuteHandColor:"black",
        secondHandColor:"black"
    },
    _schema: {
       "type":"object",
       "description":"Clock properties",
       "properties":{
          "size":{
             "type":"integer",
             "required":true
          },
          "width":{
             "type":"integer",
             "required":true
          },
          "height":{
             "type":"integer",
             "required":true
          },
          "fillColor":{
             "type":"string",
             "format": "color",
             "required":true
          },
          "strokeColor": { "type": "string", "required": true, "format": "color" },
          "pinColor": { "type": "string", "required": true, "format": "color" },
          "hourHandColor": { "type": "string", "required": true, "format": "color" },
          "minuteHandColor": { "type": "string", "required": true, "format": "color" },
          "secondHandColor": { "type": "string", "required": true, "format": "color" }
       },
       "additionalProperties":true
    }
});


var Modal = Thing.extend({
    init: function() {
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.html(value.get());
        this.refresh();
        return this;
    },
    show: function() {
        var self = this;
	    $(self.element).dialog($.extend({modal: true}, this.options));
	    $(self.element).dialog('open');
    },
    close: function() {
	    $(this.element).dialog('close');
    },
    refresh: function() {
    	$(this.element).dialog($.extend({modal: true}, this.options));
    },
    _klass: "modal thing",
    _type: "modal",
    _defaults: {
        autoOpen: false,
        minHeight: 608, // 560,  
        minWidth: 760, //740
        title: 'Dialog'
    },
    _schema: {
       "type":"object",
       "properties":{
          "title": {
             "type": "string",
             "required": false
          },
          "autoOpen":{
             "type":"boolean",
             "required":true
          },
          "minHeight":{
             "type":"string",
             "required":true
          },
          "minWidth":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }

}, {
    show: function(thing, opts) {
        var modal = new Modal(opts);
        modal.content('content',thing);
        modal.show();
        return modal;
    }
});


var Dummy = Html.extend({
    refresh: function() {
        this.base();
        this.element.css('width', this.options['width']);
        this.element.css('height',this.options['height']);
        this.element.css('color',this.options['color']);
        this.element.css('background-color',this.options['background-color']);
    },
    _klass: "dummy html thing",
    _type: "dummy",
    _defaults: {
        html: "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla sed dolor nisl, in suscipit justo. Donec a enim et est porttitor semper at vitae augue. Proin at nulla at dui mattis mattis. Nam a volutpat ante. Aliquam consequat dui eu sem convallis ullamcorper. Nulla suscipit, massa vitae suscipit ornare, tellus est consequat nunc, quis blandit elit odio eu arcu. Nam a urna nec nisl varius sodales. Mauris iaculis tincidunt orci id commodo. Aliquam non magna quis tortor malesuada aliquam eget ut lacus. Nam ut vestibulum est. Praesent volutpat tellus in eros dapibus elementum. Nam laoreet risus non nulla mollis ac luctus felis dapibus. Pellentesque mattis elementum augue non sollicitudin. Nullam lobortis fermentum elit ac mollis. Nam ac varius risus. Cras faucibus euismod nulla, ac auctor diam rutrum sit amet. Nulla vel odio erat, ac mattis enim.",
        'width': "",
        'height': '',
        'color': '',
        'background-color': ''
    },
    _schema: {
       "type":"object",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "height":{
             "type":"string",
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          },
          "background-color":{
             "type":"string",
             "format": "color",
             "required":true
          }
       },
       "additionalProperties":true
    }
});

// decorator = thing with a single slot named 'content'

// TODO podedit toto vsechno od 'Decorator'
// kvuli reverzibilite dekoratoru by bylo dobre kdyby kazdy menil css properties 'wrapper' divu
var Decorator = Thing.extend({
    init: function() {
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.html(value.get());
        return this;
    },
    unwrap: function() {
        this.replaceWith(this.getSlot('content'));
    },
    _klass: "decorator thing",
    _type: "decorator"
});


















var Clickable = Thing.extend({
    init: function() {
        this.pane = $("<div>").addClass("clickable-pane");
        this.setSlot('content', Thing.empty());
        this.click($.noop);
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.element.empty()
            .append(value.get())
            .append(this.pane);
        return this;
    },
    refresh: function() {
      this.base();
      this.pane.attr('title', this.options.tooltip);
    },
    click: function(arg) {
        if(arg) {
            this.onclick = arg;
            this.pane.click(this.onclick);
        } else {
            return this.onclick();
        }
    },
    _klass: "clickable thing",
    _type: "clickable",
    _defaults: {
      "tooltip": ""
    }
});


var Editable = Thing.extend({
    init: function() {
        this.onchanged = $.noop;
        this.editor = $("<div>").addClass("editable-editor");
        this.pane = $("<div>").addClass("editable-pane");
        this.element.append(this.pane).append(this.editor);
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        var self = this;
        var schema = value._schema;
        this.editor.empty();
        if(!schema) {
            // pouzit radsi json editor
        } else {
            this.editor.jsonform({schema: value._schema, value: value.options, name: __("Properties")+" - "+value._type});
            this.editor.jsonform('change', function() {
                self._save(true);
            });
            this.editor.jsonform('save', function() {
                self._save();
            });
        }
        this.pane.html(value.get());
        return this;
    },
    _save: function(stay) {
        var self = this;
        // value changed in editor...
        var newVal = self.editor.jsonform('value');
        self.getSlot('content').setOptions(newVal);
        if(!stay) self.onchanged(newVal);
    },
    _klass: "editable thing",
    _type: "editable",
    _defaults: {}
}, {
    edit: function(thing, changed) {
        var edt = new Editable();
        edt.setSlot('content', thing.copy());
        var modal = Modal.show(edt, {height: 630, minHeight: 630, width: 840, minWidth: 840, title:__('Properties')});
        edt.onchanged = function(newVal) {
            modal.close();
            if(changed) changed(newVal);
        };
    }
});



var ToolbarDecorator = Thing.extend({
    init: function() {
        this._content = $("<div>")
            .addClass("mykkro-toolbar-decorator-content")
            .appendTo(this.element);
        this.setSlot('content', Thing.empty());
    },
    refresh: function() {
	    this.base();
        if(this.options.hidden) {
            this.element.toolbar({tools:{}});
        } else {
            this.element.toolbar({tools:this.options.tools});
        }
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this._content.html(value.get());
        return this;
    },
    showToolbar: function() {
        this.options.hidden = false;
        this.refresh();
    },
    hideToolbar: function() {
        this.options.hidden = true;
        this.refresh();
    },
    serialize: function() {
        // toolbar decorator se nebude serializovat (aspon automaticky ne)
        return this.getSlot('content').serialize();
    },
    getTree: function() {
        // skip the outer layer...
        return this.getSlot('content').getTree();
    },
    getTreeView: function(decorator) {
        // skip the outer layer...
        return this.getSlot('content').getTreeView(decorator);
    },
    _klass: "toolbar-decorator thing",
    _type: "toolbar-decorator",
    _defaults: {
        tools: {}
    } 
});


var Page = Decorator.extend({
    // options changed...
    refresh: function() {
        this.element.css('width',this.options['width']);
        this.element.css('height',this.options['height']);
    },
    _klass: "page decorator thing",
    _type: "page",
    _defaults: {
        'width': '500px',
        'height': '700px'
    },
    _schema: {
       "type":"object",
       "description":"Clock properties",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "height":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var Preview = Decorator.extend({
    // options changed...
    refresh: function() {
        this.element.css('width',this.options['width']);
        this.element.css('height',this.options['height']);
    },
    _klass: "preview decorator thing",
    _type: "preview",
    _defaults: {
        'width': '80px',
        'height': '110px',
        'label': 'preview',
        'description': ''
    },
    _schema: {
       "type":"object",
       "description":"Clock properties",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "height":{
             "type":"string",
             "required":true
          },
          "label":{
             "type":"string",
             "required":false
          },
          "description":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }
});


var OpacityDecorator = Decorator.extend({
    refresh: function() {
      this.base();
      this.element.css('opacity',this.options.opacity);
    },
    _klass: "opacity-decorator decorator thing",
    _type: "opacity-decorator",
    _defaults: {
        opacity: 0.8
    },
    _schema: {
       "type":"object",
       "description":"Clock properties",
       "properties":{
          "opacity":{
             "type":"number",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var InsetDecorator = Decorator.extend({
    refresh: function() {
	this.base();
        this.element.css('padding',this.options.top+'% '+this.options.right+"% "+this.options.bottom+"% "+this.options.left+"%");
    },
    _klass: "inset-decorator decorator thing",
    _type: "inset-decorator",
    _defaults: {
        top: 2,
        left: 2,
        right: 2,
        bottom: 2
    },
    _schema: {
	"type":"object",
	"$schema": "http://json-schema.org/draft-03/schema",
	"properties":{
		"bottom": {
			"type":"number",
			"id": "bottom",
			"required":true
		},
		"left": {
			"type":"number",
			"id": "left",
			"required":true
		},
		"right": {
			"type":"number",
			"id": "right",
			"required":true
		},
		"top": {
			"type":"number",
			"id": "top",
			"required":true
		}
	},
       "additionalProperties":true
    }

});



var ShadowDecorator = Decorator.extend({
    // options changed...
    refresh: function() {
	this.base();
        var br = this.options['h-shadow']+" "+this.options['v-shadow']+" "+this.options.blur+" "+this.options.spread+" "+this.options.color;
        this.element.css('box-shadow',br);
        this.element.css('-webkit-box-shadow',br);
    },
    _klass: "shadow-decorator decorator thing",
    _type: "shadow-decorator",
    _defaults: {
        'h-shadow': "5px",
        'v-shadow': "5px",
        blur: "5px",
        spread: "5px",
        color: "#666"
    },
    _schema: {
       "type":"object",
       "properties":{
          "h-shadow":{
             "type":"string",
             "required":true
          },
          "v-shadow":{
             "type":"string",
             "required":true
          },
          "blur":{
             "type":"string",
             "required":true
          },
          "spread":{
             "type":"string",
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          }
       },
       "additionalProperties":true
    }
});





var BackgroundDecorator = Decorator.extend({
    // options changed...
    refresh: function() {
        this.base();
        if(this.options['image']) 
            this.element.css('background-image','url("'+this.options['image']+'")');
        else 
            this.element.css('background-image','');
        this.element.css('background-position',this.options['position']);
        this.element.css('background-repeat',this.options['repeat']);
        this.element.css('background-color',this.options['color']);
        this.element.css('background-size',this.options['size']);
    },
    _klass: "background-decorator decorator thing",
    _type: "background-decorator",
    _defaults: {
        'image': "",
        'repeat': 'no-repeat',
        'position': 'center center',
        'color': 'white',
        'size': 'cover'
    },
    _schema: {
       "type":"object",
       "properties":{
          "image":{
             "type":"string",
             "format": "my-image-uri",
            // TODO vadi mu kdyz je to false - option se neda rozkliknout
             "required":true
          },
          "repeat":{
             "enum": ["repeat","no-repeat","repeat-x","repeat-y"],
             "type":"string",
             "required":true // TODO
          },
          "position":{
             "type":"string",
             "required":true // TODO
          },
          "size":{
             "type":"string",
             "enum": ["cover","contain"],
             "required":true // TODO
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true // TODO
          }
       },
       "additionalProperties":true
    }
});



// TODO sloucit nejak s rounded decoratorem
var BorderDecorator = Decorator.extend({
    // options changed...
    refresh: function() {
        this.base();
        this.element.css('border-width', this.options['width']);
        this.element.css('border-style',this.options['style']);
        this.element.css('border-color',this.options['color']);
    },
    _klass: "border-decorator decorator thing",
    _type: "border-decorator",
    _defaults: {
        'width': "1px",
        'style': 'solid',
        'color': 'black'
    },
    _schema: {
       "type":"object",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "style":{
             "type":"string",
             "enum": ["none","solid","dotted","dashed","double","groove","ridge","inset","outset"],
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var RoundedDecorator = BorderDecorator.extend({
    refresh: function() {
        this.base();
        var br = this.options.radius;
        // TODO individualne vsechny 4 rohy
        this.element.css('border-radius',br);
        this.element.css('-webkit-border-radius',br);
        this.element.css('-moz-border-radius',br);
    },
    _klass: "rounded-decorator decorator thing",
    _type: "rounded-decorator",
    _defaults: {
        'width': "1px",
        'style': 'solid',
        'color': 'black',
        radius: "5%"
    },
    _schema: {
       "type":"object",
       "properties":{
          "width":{
             "type":"string",
             "required":true
          },
          "style":{
             "type":"string",
             "enum": ["none","solid","dotted","dashed","double","groove","ridge","inset","outset"],
             "required":true
          },
          "color":{
             "type":"string",
             "format": "color",
             "required":true
          },
          "radius":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }
});



var PageDecorator = Thing.extend({
    init: function() {
        this.base();
        this.pageContent = $("<div>").addClass("page-content").appendTo(this.element);
        this.pageInfo = $("<div>").addClass('page-info').appendTo(this.element);
        this.setSlot('content', Thing.empty());
    },
    // options changed...
    refresh: function() {
        // TODO text mask?
        this.base();
        if(this.options.showInfo) this.pageInfo.show(); else this.pageInfo.hide();
        this.pageInfo.text("Page "+this.options.pageNumber);
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.pageContent.html(value.get());
        return this;
    },
    _klass: "page-decorator thing",
    _type: "page-decorator",
    _defaults: {
        'showInfo' : false,
        'pageNumber': 2,
        'pagesTotal' : 3,
        'recordsTotal' : 10
    },
    _schema: {
       "type":"object",
       "properties":{
          "showInfo":{
             "type":"boolean",
             "required":true
          },
          "pageNumber":{
             "type":"integer",
             "required":true
          },
          "pagesTotal":{
             "type":"integer",
             "required":true
          },
          "recordsTotal":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var CenteringDecorator = Thing.extend({
    init: function() {
        this.inner = $("<div>").addClass('content-inner').appendTo(
            $("<div>").addClass('center3').appendTo(
                $("<div>").addClass('center2').appendTo(
                    this.element
                )
            )
        );
        this.setSlot('content', Thing.empty());
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.inner.html(value.get());
        return this;
    },
    // options changed...
    refresh: function() {
        this.base();
        this.element.css('text-align',this.options['x-align']);
        this.element.children(".center2").css('vertical-align',this.options['y-align']);
        this.inner.css('width',this.options['content-width']);
        this.inner.css('height',this.options['content-height']);
    },
    _klass: "centering-decorator decorator thing",
    _type: "centering-decorator",
    _defaults: {
        'x-align': "center",
        'y-align': 'center',
        'content-width': '',
        'content-height': ''
    },
    _schema: {
       "type":"object",
       "properties":{
          "x-align":{
             "enum": ["left","center","right"],
             "type":"string",
             "required":true // TODO
          },
          "y-align":{
             "enum": ["top","middle","bottom"],
             "type":"string",
             "required":true // TODO
          },
          "content-width":{
             "type":"string",
             "required":true // TODO
          },
          "content-height":{
             "type":"string",
             "required":true // TODO
          }
       },
       "additionalProperties":true
    }
});



var Ajax = Decorator.extend({
    init: function() {
        this.loaded($.noop);
        this.received(function(data) { return data; });
        this.transform(function(data) { return Thing.create(data); })
        this.base();
        this.reload();
    },
    reload: function() {
        var url = this.options.url;
        var self = this;
        if(url) {
            $.ajax({
              url: url,
              dataType: 'json',
              //data: data,
              success: function(data) {
                var thing = self.transform(self.received(data));
                self.setSlot('content', thing);
                self.loaded(thing);
              },
              error: function(jqXHR, textStatus, errorThrown) {
                // TODO dat tam misto toho chyb. panel
                alert("AJAX failed! "+textStatus);
              }
            });
        }
        if(this.options.reloadInterval) {
            var fun = function() { self.reload(); };
            setTimeout(fun, 1000*this.options.reloadInterval);
        }
    },
    loaded: function(arg) {
        if(typeof arg == 'function') {
            this.onloaded = arg;
        } else {
            return this.onloaded(arg);
        }
    },
    received: function(arg) {
        if(typeof arg == 'function') {
            this.onreceive = arg;
        } else {
            return this.onreceive(arg);
        }
    },
    transform: function(arg) {
        if(typeof arg == 'function') {
            this.ontransform = arg;
        } else {
            return this.ontransform(arg);
        }
    },
    _klass: "ajax thing",
    _type: "ajax",
    _defaults: {
        url: '', //"testing/thing.json",
        reloadInterval: 0 //60 // in seconds
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "reloadInterval": {
			    "type":"integer",
			    "required":true
		    },
		    "url": {
			    "type":"string",
			    "id": "url",
                "format": "uri",
			    "required":true
		    }
	    }
    }
});




var AjaxPager = Thing.extend({
    init: function() {
        var self = this;
        this.base();
        this.page = new Ajax();
        this.page.received(function(data) { return self._dataReceived(data);});
        this.page.transform(function(data) { return self._dataTransform(data);});
        this.page.loaded(function(ajax) {self._pageLoaded(ajax);});
        this.page.get().appendTo(this.element);
        this.pagerControls = $("<div>").addClass('pager-controls').appendTo(this.element);
        this.setPage(this.options.page);
    },
    setPage: function(num) {
        this.options.page = num;
        var url = null;
        if(this.options.page && this.options.baseUrl) {
            url = this.getPageUrl(this.options.page);
            this.page.options.url = url;
            this.page.reload();
        } else {
            // signal error
        }
    },
    getPageUrl: function(page) {
        return this.options.baseUrl + page + ".json";
    },
    // muzeme podedit pokud potrebujeme jine chovani, transformaci dat aj.
    _dataReceived: function(data) {
        return data;
    },
    _dataTransform: function(data) {
        return Thing.create(data);
    },
    _pageLoaded: function(ajax) {
        this.pagerControls.empty();
        if(ajax instanceof PageDecorator) {
            // rebuild page controls
            this._buildPageControls(ajax);
        }
    },
    _buildPageControls: function(paged) {
        // TODO udelat PagerControls jako Thing
        // stranky jsou cislovany od jedne, nejmensi cislo je 1
        var o = paged.options;
        if(o.pageNumber>1) {
            // add first link
            this.pagerControls.append(this._makePageLink(1, "first"));
        }
        if(o.pageNumber>1) {
            // add previous link
            this.pagerControls.append(this._makePageLink(o.pageNumber-1, "previous"));
        }
        this.pagerControls
            .append($("<span>").text(__("Page")+" "+o.pageNumber+" "+__("from")+" "+o.pagesTotal));        
        if(o.pageNumber<o.pagesTotal) {
            // add previous link
            this.pagerControls.append(this._makePageLink(o.pageNumber+1, "next"));
        }
        if(o.pageNumber<o.pagesTotal) {
            // add first link
            this.pagerControls.append(this._makePageLink(o.pagesTotal, "last"));
        }
    },
    _makePageLink: function(pageno, type) {
        var self = this;
        return $('<a href="#">').text(type).click(function() {
            self.setPage(pageno);
            return false;
        });
    },
    _klass: "ajax-pager thing",
    _type: "ajax-pager",
    _defaults: {
        baseUrl: '',// 'testing/multi/',
        page: 1
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "page": {
			    "type":"integer",
			    "required":true
		    },
		    "url": {
			    "type":"string",
			    "id": "url",
                "format": "uri",
			    "required":true
		    }
	    }
    }
});


var Layout = Thing.extend({
    _klass: "layout thing",
    _type: "layout"
});









var Slot = Base.extend({
    constructor: function(parent, name) {
        this.name = name;
        this.parent = parent;
        this.element = $("<div>").addClass("mykkro-slot").attr('data-name', name);
        this.thing = null;
    },
    empty: function() {
        this.element.empty();
        this.thing = null;
    },
    set: function(thing) {
        this.element.empty().append(thing.get());
        this.thing = thing;
    },
    get: function() {
        return this.thing;
    }
});


// TODO metody na prohazovani elementu - move to front/back, move up, move down
// TODO metody insert/delete?
// TODO -> DynamicLayout
var GrowableLayout = Layout.extend({
    init: function() {
        this.cells = []; // v tomto poradi budou v this.element!
        this.cellMap = {}; 
    },
    // remove all slots
    // TODO obsolete, use removeSlots instead
    clear: function() {
        this.element.empty();
        this.cells = [];
        this.cellMap = {};
    },
    length: function() {
        return this.cells.length;
    },
    first: function() {
        return this.cells.length ? this.cells[0] : undefined;
    },
    last: function() {
        return this.cells.length ? this.cells[this.cells.length-1] : undefined;
    },
    nth: function(ndx) {
        return (ndx>=0 && ndx<this.cells.length) ? this.cells[ndx] : undefined;
    },
    isEmpty: function() {
        return this.cells.length;
    },
    // dynamically add slot
    add: function(thing) {        
        var ndx = this.cells.length;
        var slot = new Slot(this, ndx);
        slot.element.appendTo(this.element);
        this.cells.push(slot);
        this.cellMap[ndx] = slot;
        this.setSlot(ndx, thing);
        return slot;
    },
    setSlot: function(key, value) {
        // TODO implement hasSlot
        this.base(key, value);
        this.cellMap[key].set(value);
        return this;
    },
    removeSlots: function() {
        // remove slot content...
        this.clearSlots(); 
        // remove slots proper...
        this.element.empty();
        this.slots = {};
        this.cells = [];
        this.cellMap = {};
    },
    setSlots: function(slots) {
        // remove existing slots...
        this.removeSlots();
        if(slots) {
            // pokud je parametr pole, udelat z nej objekt
            if($.isArray(slots)) slots = slots.toObject();
            for(var key in slots) {
                this.add(slots[key]);
            }
        }
    },
    _klass: "growable-layout layout thing",
    _type: "growable-layout",
    _defaults: {
        "css": "" //"mykkro-flow-layout"
    },
    _schema: {
       "type":"object",
       "properties":{
          "css":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }
});



// TODO metody na prohazovani elementu - move to front/back, move up, move down
// TODO metody insert/delete?
// TODO -> DynamicLayout
// TODO ze by se to poradi slotu dalo ulozit?
var OrderableLayout = GrowableLayout.extend({
    init: function() {
        this.cells = []; // v tomto poradi budou v this.element!
        this.cellMap = {}; 
    },
    // what muze byt Slot nebo Thing
    getSlotIndex: function(what) {
        if(what && typeof what === 'object') {
            for(var i=0; i<this.cells.length; i++) {
                if(this.cells[i] == what || this.cells[i].get() == what) return i;
            }
            return -1;
        } else {
            if(what>=0 && what < this.cells.length) return what;
            return -1;
        }
    },
    moveSlotUp: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>0) {
            // swap slots 'i-1' and 'i'
            this.swapSlots(slot-1, slot);
        }
    },
    moveSlotDown: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>=0 && slot<this.cells.length-1) {
            // swap slots 'i' and 'i+1'
            this.swapSlots(slot, slot+1);
        }
    },
    moveSlotToTop: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>0) {
            this.swapSlots(0, slot);
        }
    },
    moveSlotToBottom: function(slot) {
        slot = this.getSlotIndex(slot);
        if(slot>=0 && slot<this.cells.length-1) {
            this.swapSlots(slot, this.cells.length-1);
        }
    },
    swapSlots: function(slot1, slot2) {
        slot1 = this.getSlotIndex(slot1);
        slot2 = this.getSlotIndex(slot2);
        if(slot1 != slot2) {
            // prohodit to v DOM...
            this.cells[slot1].element.swap(this.cells[slot2].element);
            var tmp = this.cells[slot1];
            this.cells[slot1] = this.cells[slot2];
            this.cells[slot2] = tmp;
        }
    },
    shuffle: function() {
        var len = this.cells.length;
        for (var i = len-1; i >=0; i--) {
            var randomIndex = Math.floor(Math.random()*(i+1)); 
            this.swapSlots(randomIndex, i);
        }
    },
    remove: function(what) {        
        var ndx = this.getSlotIndex(what);
        if(ndx>=0) {
            var slot = this.cells[ndx];
            this.cellMap[slot.name] = null;
            // remove from array
            this.cells.remove(ndx);
            // remove from DOM
            slot.element.remove();
            this.refresh();
        }
    },
    _klass: "orderable-layout growable-layout layout thing",
    _type: "orderable-layout",
    _defaults: {
        "css": "" //"mykkro-flow-layout"
    },
    _schema: {
       "type":"object",
       "properties":{
          "css":{
             "type":"string",
             "required":false
          }
       },
       "additionalProperties":true
    }
});



var PreviewPager = AjaxPager.extend({
    constructor: function(url, callback) {
        this.base({baseUrl:url});
        this.onselected = callback || $.noop;
    },
    _dataReceived: function(data) {
        return data;
    },
    _dataTransform: function(data) {
        var self = this;
        var ol = new OrderableLayout({"css":"mykkro-flow-layout"});
        for(var i=0; i<data.items.length; i++) {
            var thing = Thing.create(data.items[i].preview);
            var clickable = new Clickable({tooltip: data.items[i].title});
            clickable.setSlot('content', thing);
            (function() {
                var url = data.items[i].url;
                clickable.click(function() {
                    self._selected(url);
                });
/*
                // TODO settings - otevre formular
                // Thing ma definovane schema pro validaci options
                var st = makeSettingsToolbar(function(){
                    // change thing's settings
                    self._selected(url, true);
                });
                st.setSlot('content', clickable);
                ol.add(st);
*/
                ol.add(clickable);
            })();
        }
        var pd = new PageDecorator({
            'pageNumber': data.page,
            'pagesTotal' : data.pagesTotal,
            'recordsTotal' : data.itemsTotal            
        });
        pd.setSlot('content', ol);
        return pd;
    },
    _selected: function(url, editSettings) {
        var self = this;
         $.ajax({
              url: url,
              dataType: 'json',
              //data: data,
              success: function(data) {
                  if(editSettings) {
                     // ziskat schema, zobrazit formular, nastavit data.options                    
                  }
                  var thing = Thing.create(data);
                  self.onselected(thing);
              }
          });
    },
    _type: "preview-pager"
}, {
    choose: function(type, callback, options) {
	    var mm = {};
        var url = baseUrl+'api/pagedpreviews/'+type+'/';
        var ap = new PreviewPager(url, function(thing) { 
            mm.modal.close();
            if(callback) callback(thing);
        });
        mm.modal = Modal.show(ap, options);
    }
});


// TODO vertical split
var SplitLayout = Layout.extend({
    init: function() {
        this.first = $("<div>");
        this.second = $("<div>");
        this.element.append(this.first).append(this.second);
        this.setSlot('first', Thing.empty());
        this.setSlot('second', Thing.empty());
    },
    // options changed...
    refresh: function() {
        this.base();
        var first = this.options.ratio + "%";
        var gap = this.options.gap + "%";
        var xx = (this.options.ratio + this.options.gap) + "%";
        var second = (100 - this.options.ratio - this.options.gap) + "%";
        if(this.options.horizontal) {
            this.first.css("left","0px").css("top","0px").css("width",first).css('height','100%');
            this.second.css("left",xx).css("top","0px").css("width",second).css('height','100%');
        } else {
            this.first.css("left","0px").css("top","0px").css("height",first).css('width','100%');
            this.second.css("left","0px").css("top",xx).css("height",second).css('width','100%');
        }
    },
    setSlot: function(key, value) {
        // TODO implement hasSlot
        this.base(key, value);
        if(key=='first') {
            this.first.empty().append(value.get());
        }
        if(key=='second') {
            this.second.empty().append(value.get());
        }
        return this;
    },
    _klass: "split-layout layout thing",
    _type: "split-layout",
    _defaults: {
        ratio: 70, // v %
        gap: 2, // v %
        horizontal: false
    },
    _schema: {
       "type":"object",
       "properties":{
          "horizontal":{
             "type":"boolean",
             "required":true
          },
          "ratio":{
             "type":"integer",
             "required":true
          },
          "gap":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});



var GridLayout = Layout.extend({
    init: function() {
        // TODO create grid and slots
        var ndx = 0;
        this.cells = {};
        for(var i=0; i<this.options.rows; i++) {
            for(var j=0; j<this.options.columns; j++) {
                this.cells[ndx] = $("<div>").appendTo(this.element);                
                this.setSlot(ndx, Thing.empty());
                ndx++;
            }
        }
    },
    // options changed...
    refresh: function() {
        this.base();
        var gap = this.options.gap;
        var cols = this.options.columns;
        var rows = this.options.rows;
        var ww = Math.round(10*(100 - (cols-1)*gap)/cols)/10;
        var hh = Math.round(10*(100 - (rows-1)*gap)/rows)/10;
        var xx = 0;
        var yy = 0;
        var ndx = 0;
        for(var i=0; i<rows; i++) {
            for(var j=0; j<cols; j++) {
                this.cells[ndx].css({
                    "width": ww+"%",
                    "height": hh+"%",
                    "left": xx+"%",
                    "top": yy+"%"
                });
                ndx++;
                xx += ww + gap;
            }
            xx = 0;
            yy += hh + gap;
        }
    },
    setSlot: function(key, value) {
        // TODO implement hasSlot
        this.base(key, value);
        this.cells[key].empty().append(value.get());
        return this;
    },
    _klass: "grid-layout layout thing",
    _type: "grid-layout",
    _defaults: {
        rows: 3, // nemelo by se menit za behu
        columns: 3, // nemelo by se menit za behu
        gap: 2 // v procentech
    },
    _schema: {
       "type":"object",
       "properties":{
          "rows":{
             "type":"integer",
             "required":true
          },
          "columns":{
             "type":"integer",
             "required":true
          },
          "gap":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});



var SwitchLayout = GrowableLayout.extend({
    refresh: function() {
        this.base();
        var index = parseInt(this.options.index)+1;
        this.element.children().hide();
        this.element.find("div:nth-child("+index+")").show();
    },
    setIndex: function(ndx) {
        this.options.index = ndx;
        this.refresh();
    },
    add: function(thing) {
        var slot = this.base(thing);
        this.refresh();
        return slot;
    },
    _klass: "switch-layout growable-layout layout thing",
    _type: "switch-layout",
    _defaults: {
        "css": "", //"mykkro-flow-layout"
        index: 0
    },
    _schema: {
       "type":"object",
       "properties":{
          "css":{
             "type":"string",
             "required":false
          },
          "index":{
             "type":"integer",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var Book = GrowableLayout.extend({
    currentPage: 0,
    init: function() {
        this.base();
    },
    refresh: function() {
        this.base();
    },
    // TODO tohle se muze zavolat jen pokud jsou stranky uz vlozena do DOMu
    makeDisplay: function() {
        var self = this;
	    // kniha = <div class="mykkro-book> <div class="mykkro-slot"> .. </div>
	    this.element.addClass(this.options.display);
	    switch(this.options.display) {
	      case 'basic':
	        // add page numbers...
	        break;
	      case "turnable":
	        this.element.turn({gradients: true, acceleration: true});
            this.element.bind("start", function(ev, pageObject, corner) { 
                self.onTurnStart(ev, pageObject, corner); })
            this.element.bind("turning", function(ev, page, pageObject) { 
                self.onTurning(ev, page, pageObject); })
            this.element.bind("turned", function(ev, page, view) { 
                self.onTurned(ev, page, view); })
            this.element.bind("end", function(ev, pageObject, turned) { 
                self.onTurnEnd(ev, pageObject, turned); })
	        break;
	    }
    },
    _setPage: function(page) {
        if(!this.currentPage) {
            // page 1 became visible
            this.onPageVisibilityChange(page, true);
        }
        else if(this.currentPage>>1 == page>>1) {
            // je videt porad stejna dvoustrana
        } else {            
            // visibility changed
            var oldPages = 2*(Math.floor(this.currentPage / 2));
            var newPages = 2*(Math.floor(page / 2));
            this.onPageVisibilityChange(oldPages, false);
            this.onPageVisibilityChange(oldPages+1, false);
            this.onPageVisibilityChange(newPages, true);
            this.onPageVisibilityChange(newPages+1, true);
        }
        this.currentPage = page;
        // notifikovat stranky pokud se jejich viditelnost zmenila
        this.onPageChange(page);
    },
    // TODO udelat si na to taky bind funkci
    onPageVisibilityChange: function(page, visible) {
        if(typeof(page)=='function') this._onPageVisibilityChange = page;  
        else {
            // mame takovou stranku?
            var name = page-1;
            if(this.slots[name]) {
                this._updatePageVisibility(page, visible);
                if(this._onPageVisibilityChange) this._onPageVisibilityChange(page, visible);
            }
        }
    },
    _updatePageVisibility: function(page, visible) {
        // pri zviditelneni musim refereshnout vsechny audio-decoratory a video-thingy
        // pri zneviditelneni vypnout jejich playback
        //log("Page: "+page+" visibility: "+visible);
        var name = page-1;
        var thing = this.slots[name];
        var media = [];
        thing.findSlotsByType('audio-decorator', media);
        thing.findSlotsByType('video-thing', media)
        //log(audio.length+","+video.length);
        if(visible) {
            // page became visible...
            for(var i=0; i<media.length; i++) {
                media[i].refresh();
                if(media[i].options['autoplay']) {
                    media[i].play();
                }
            }
        } else {
            // TODO stop only if playing...
            for(var i=0; i<media.length; i++) media[i]._kill();
        }
    },
    onPageChange: function(ev) {
        if(typeof(ev)=='function') this._onPageChange = ev;  
        else {
            if(this._onPageChange) this._onPageChange(ev);
        }
    },
    onInit: function(ev) {
        if(typeof(ev)=='function') this._onInit = ev;  
        else {
            this._setPage(1);
            if(this._onInit) this._onInit();
        }
    },
    onExit: function(ev) {
        if(typeof(ev)=='function') this._onExit = ev;  
        else {
            if(this._onExit) this._onExit();
        }
    },
    onTurnStart: function(ev, pageObject, corner) {
        if(typeof(ev)=='function') this._onTurnStart = ev;  
        else {
            if(this._onTurnStart) this._onTurnStart(ev, pageObject, corner);
        }
    }, 
    onTurning: function(ev, page, pageObject) {
        if(typeof(ev)=='function') this._onTurning = ev;  
        else {
            if(this._onTurning) this._onTurning(ev, page, pageObject);
        }
    }, 
    onTurned: function(ev, page, view) { 
        if(typeof(ev)=='function') this._onTurned = ev;  
        else {
            this._setPage(page);
            if(this._onTurned) this._onTurned(ev, page, view);
        }
    }, 
    onTurnEnd: function(ev, pageObject, turned) { // nefunguje
        if(typeof(ev)=='function') this._onTurnEnd = ev;  
        else {
            if(this._onTurnEnd) this._onTurnEnd(ev, pageObject, corner);
        }
    }, 
    _klass: "book growable-layout layout thing",
    _type: "book",
    _defaults: {
        "title": "My Book",
	    "display": "basic"
    },
    _schema: {
       "type":"object",
       "properties":{
          "title":{
             "type":"string",
             "required":true
          }
       },
       "additionalProperties":true
    }
});


var Quest = Thing.extend({
    init: function() {
        this.status = 'active';
        this.finished($.noop);
    },
    refresh: function() {
        this.base();
        //this.inner.html(this.options.html).attr('class',this.options.innerCss);
    },
    finished: function(arg) {
        if(typeof arg == 'function') {
            this.onfinished = arg;
        } else {
            return this.onfinished(arg);
        }
    },
    pass: function() {
        this.status = 'passed';
        this.finished({'quest':this, 'status':this.status});
    },
    fail: function() {
        this.status = 'failed';
        this.finished({'quest':this, 'status':this.status});
    },
    _klass: "quest thing",
    _type: "quest",
    _defaults: {
        //html: ""
    },
    _schema: {
       "type":"object",
       "description":"Quest properties",
       "properties":{
/*
          "html":{
             "type":"string",
             "required":true
          },
          "css":{
             "type":"string",
             "required":false
          },
          "innerCss":{
             "type":"string",
             "required":false
          }
*/
       },
       "additionalProperties":true
    }

});

var DemoQuest = Quest.extend({
    init: function() {
        this.base();
        var self = this;
        this.passButton = $("<button>").text("Pass").click(function() { self.pass(); }).appendTo(this.element);
        this.failButton = $("<button>").text("Fail").click(function() { self.fail(); }).appendTo(this.element);
        this.statusBar = $("<span>").appendTo(this.element);
        this.statusBar.text('active');
    },
    pass: function() {
        this.statusBar.text('passed');
        this.passButton.prop('disabled', true);
        this.failButton.prop('disabled', true);
        this.base();
    },
    fail: function() {
        this.statusBar.text('failed');
        this.passButton.prop('disabled', true);
        this.failButton.prop('disabled', true);
        this.base();
    },
    _klass: "demo-quest quest thing",
    _type: "demo-quest",
    _defaults: {
        //html: ""
    },
    _schema: {
       "type":"object",
       "description":"Demo Quest properties",
       "properties":{
/*
          "html":{
             "type":"string",
             "required":true
          },
          "css":{
             "type":"string",
             "required":false
          },
          "innerCss":{
             "type":"string",
             "required":false
          }
*/
       },
       "additionalProperties":true
    }

});

var PlayerControls = Thing.extend({
    _onplay: $.noop,
    _onpause: $.noop,
    _onstop: $.noop,
    init: function() {
        var self = this;
        var cont = $("<div>").addClass('controls').appendTo(this.element);
        this._playBtn = $("<button>")
            .addClass("play").append($("<span>").text("Play"))
            .appendTo(cont).click(function() { self.onPlay(); });
        this._pauseBtn = $("<button>")
            .addClass("pause").append($("<span>").text("Pause"))
            .appendTo(cont).click(function() { self.onPause(); });
        this._stopBtn = $("<button>")
            .addClass("stop").append($("<span>").text("Stop"))
            .appendTo(cont).click(function() { self.onStop(); });
        this.controls = cont;
        this.playing = false;
        this.paused = false;
    },
    refresh: function() {
        this.base();
        this.controls.toggleClass('playing', this.playing);
        this._playBtn.prop('disabled', this.playing);
        this._pauseBtn.prop('disabled', !this.playing);
        this._stopBtn.prop('disabled', !(this.playing/* || this.paused*/));    
        if(this.playing) {
            this._playBtn.hide();
            this._pauseBtn.show();
        } else {
            this._playBtn.show();
            this._pauseBtn.hide();
        }        
        if(this.playing/* || this.paused*/) {
            this._stopBtn.show();
        } else {
            this._stopBtn.hide();
        }
    },
    updateGui: function(playing, paused) {
        this.playing = playing;
        this.paused = paused;
        this.refresh();
    },
    onPlay: function(kb) {
        if(typeof kb == 'function') {
            this._onplay = kb;
        } else {
            this.updateGui(true, false);
            this._onplay(kb);
        }
    },
    onPause: function(kb) {
        if(typeof kb == 'function') {
            this._onpause = kb;
        } else {
            this.updateGui(false, true);
            this._onpause(kb);
        }
    },
    onStop: function(kb) {
        if(typeof kb == 'function') {
            this._onstop = kb;
        } else {
            this.updateGui(false, false);
            this._onstop(kb);
        }
    },
    _klass: "player-controls thing",
    _type: "player-controls",
    _defaults: {
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
	    }
    }
});


var AudioDecorator = Thing.extend({
    _onplay: $.noop,
    _onpause: $.noop,
    _onstop: $.noop,
    _onkill: $.noop,
    onPlay: function(kb) {
        if(typeof kb == 'function') {
            this._onplay = kb;
        } else {
            this._onplay(kb);
        }
    },
    onPause: function(kb) {
        if(typeof kb == 'function') {
            this._onpause = kb;
        } else {
            this._onpause(kb);
        }
    },
    onStop: function(kb) {
        if(typeof kb == 'function') {
            this._onstop = kb;
        } else {
            this._onstop(kb);
        }
    },
    onKill: function(kb) {
        if(typeof kb == 'function') {
            this._onkill = kb;
        } else {
            this._onkill(kb);
        }
    },
    init: function() {
        this.slot = $("<div>").addClass("slot");
        this.setSlot('content', Thing.empty());
    },
    play: function() {
        this._play();
        this.player.updateGui(true, false);
    },
    _play: function() {
        this.audio.get(0).play();
        this.onPlay();
    },
    _pause: function() {
        this.audio.get(0).pause();
        this.onPause();
    },
    _stop: function() {
        // regenerate player...
        this.refresh();
        this.onStop();
    },
    _kill: function() {
        this.audio.get(0).pause();
        this.audio.get(0).src = "";
        this.onKill();
    },
    _setVolume: function(vol) {
        // HTML5 volume is between 0 and 1
        this.audio.get(0).volume = vol / 100.0;
    },
    setSlot: function(key, value) {
        this.base(key, value);
        this.slot.html(value.get());
        return this;
    },
    _addSource: function(uri, type) {
        if(uri) $("<source>").attr({src:uri, type: type, preload: false/**/}).appendTo(this.audio);
    },
    refresh: function() {
        this.base();
        var self = this;
        this.audio = $("<audio>");
        this.player = new PlayerControls();  
        this.player.onPlay(function() { self._play(); });
        this.player.onPause(function() { self._pause(); });
        this.player.onStop(function() { self._stop(); });
        var cc = new CenteringDecorator({},{content: this.player});
        this.pane = cc.get();
        this.pane.addClass("player");
        this.element.empty()
            .append(this.slot)
            .append(this.pane)
            .append(this.audio);

        this.audio.remove("source");
        this.audio.prop('loop', this.options.loop);
        if(this.options.uri) {            
            var ext = this.options.uri.split('.').pop();
            this.options.ogg = (ext == 'ogg') ? this.options.uri : '';
            this.options.mp3 = (ext == 'mp3') ? this.options.uri : '';
        }
        this._addSource(this.options.ogg, 'audio/ogg; codecs="vorbis"');
        this._addSource(this.options.mp3, 'audio/mpeg; codecs="mp3"');
        // HTML5 volume is between 0 and 1
        this._setVolume(this.options.volume);
    },
    _klass: "audio-decorator decorator thing",
    _type: "audio-decorator",
    _defaults: {
        'ogg': "",
        'mp3': "",
        'uri': "",
        'autoplay': false,
        'loop': false,
        'volume': 50
    },
    _schema: {
       "type":"object",
       "properties":{
          "uri":{
             "type":"string",
             "format": "my-voice-uri",
            // TODO vadi mu kdyz je to false - option se neda rozkliknout
             "required":true
          },
          "volume":{
             "type":"integer",
             "required":true // TODO
          },
          "autoplay":{
             "type":"boolean",
             "required":true // TODO
          },
          "loop":{
             "type":"boolean",
             "required":true // TODO
          }
       },
       "additionalProperties":true
    }
});



var VideoThing = Thing.extend({
    _onplay: $.noop,
    _onpause: $.noop,
    _onstop: $.noop,
    _onkill: $.noop,
    onPlay: function(kb) {
        if(typeof kb == 'function') {
            this._onplay = kb;
        } else {
            this._onplay(kb);
        }
    },
    onPause: function(kb) {
        if(typeof kb == 'function') {
            this._onpause = kb;
        } else {
            this._onpause(kb);
        }
    },
    onStop: function(kb) {
        if(typeof kb == 'function') {
            this._onstop = kb;
        } else {
            this._onstop(kb);
        }
    },
    onKill: function(kb) {
        if(typeof kb == 'function') {
            this._onkill = kb;
        } else {
            this._onkill(kb);
        }
    },
    init: function() {
    },
    play: function() {
        this._play();
        this.player.updateGui(true, false);
    },
    _play: function() {
        this.video.get(0).play();
        this.onPlay();
    },
    _pause: function() {
        this.video.get(0).pause();
        this.onPause();
    },
    _stop: function() {
        //this.video.get(0).pause();
        //this.video.get(0).currentTime = 0;
        // regenerate player...
        this.refresh();  // TODO udelat to lepe
        this.onStop();
    },
    _kill: function() {
        this.video.get(0).pause();
        this.video.get(0).src = "";
        this.onKill();
    },
    _setVolume: function(vol) {
        // HTML5 volume is between 0 and 1
        this.video.get(0).volume = vol / 100.0;
    },
    _addSource: function(uri, type) {
        if(uri) {
            $("<source>").attr({src:uri, type: type, preload: false/**/}).appendTo(this.video);
        }
    },
    refresh: function() {
        this.base();
        var self = this;
        this.video = $("<video>");
        this.player = new PlayerControls();  
        this.player.onPlay(function() { self._play(); });
        this.player.onPause(function() { self._pause(); });
        this.player.onStop(function() { self._stop(); });
        var cc = new CenteringDecorator({},{content: this.player});
        this.pane = cc.get();
        this.pane.addClass("player");
        this.element.empty()
            .append(this.video)
            .append(this.pane);

        this.video.prop('loop', this.options.loop);
        if(this.options.uri) {            
            var ext = this.options.uri.split('.').pop();
            this.options.ogg = (ext == 'ogg' || ext == 'ogv') ? this.options.uri : '';
            this.options.mp4 = (ext == 'mp4') ? this.options.uri : '';
            this.options.webm = (ext == 'webm') ? this.options.uri : '';
        }
        this._addSource(this.options.ogg, 'video/ogg; codecs="theora, vorbis"');
        this._addSource(this.options.mp4, 'video/mp4; codecs="avc1.42E01E, mp4a.40.2"');
        this._addSource(this.options.webm, 'video/webm; codecs="vp8, vorbis"');
        ////this.video.get(0).src = this.options.uri;
        // TODO tohle nejak zlobi v Chrome, pri znovuvytvareni videi... ale ve FF to zda se funguje

        // HTML5 volume is between 0 and 1
        this._setVolume(this.options.volume);
        this.video.on('canplay canplaythrough', function(){
            console.log('canplay event fired');
        });
    },
    _klass: "video-thing thing",
    _type: "video-thing",
    _defaults: {
        "uri": "",
        'ogg': "",
        'mp4': "",
        'webm': "",
        'autoplay': false,
        'loop': false,
        'volume': 50
    },
    _schema: {
	    "type":"object",
	    "$schema": "http://json-schema.org/draft-03/schema",
	    "properties":{
		    "uri": {
			    "type":"string",
                "format": "my-video-uri",
			    "required":true
    	    },
            "volume":{
                "type":"integer",
                "required":true // TODO
            },
            "autoplay":{
                "type":"boolean",
                "required":true // TODO
            },
            "loop":{
                "type":"boolean",
                "required":true // TODO
            }
	    }
    }

});


/*

document.addEventListener('DOMContentLoaded', function(){
    var v = document.getElementById('vid');
    var canvas = document.getElementById('canvas');
    var context = canvas.getContext('2d');

    var cw = canvas.clientWidth;
    var ch = canvas.clientHeight;
    canvas.width = cw;
    canvas.height = ch;

    v.addEventListener('play', function(){
        draw(this,context);
    },false);

},false);

var mode = 'stretch';
function draw(v,c) {
    var canvas = document.getElementById('canvas');
    var w = canvas.clientWidth;
    var h = canvas.clientHeight;
    if(v.paused || v.ended) return false;
    if(mode == 'stretch') {
        c.drawImage(v,0,0,w,h); //-> stretch
    } else if(mode == 'cover') {
        // TODO tady je neco spatne
        var sx=0, sy=0, sw=v.width, sh=v.height;
        if(sw/sh < w/h) {
            sy = (sh - h*sw/w)/2;
            sh = h*sw/w;
        } else {
            sx = (sw - w*sh/h)/2;
            sw = w*sh/h;
        }
        c.drawImage(v,sx,sy,sw,sh,0,0,w,h); 
    } else { // contain
        var ww = v.width;
        var hh = v.height;
        var x = y = 0;
        if(ww/hh < w/h) {
            x = (w-ww*h/hh)/2;
            c.drawImage(v,x,0,ww*h/hh,h); 
        } else {
            y = (h-hh*w/ww)/2;
            c.drawImage(v,0,y,w,hh*w/ww); 
        }
    }
    setTimeout(draw,20,v,c);
}

<canvas id="canvas"></canvas>

*/

// TODO udelat z toho Thing
// TODO k ikonam pridat tooltipy

var BookViewer = Base.extend({
    constructor: function(options) {
        this.bookData = options.data;
        this.bookUrl = options.url;
        this.eventUrl = options.eventUrl;
        this.fullscreen = options.fullscreen;
        this.defaultWidth = 920;
        this.defaultHeight = 600;
        this.tools = {};
        this.bookContent = null;
        this.eventHistory = [];
    },
    makeIcon: function(icon, title) {
        return $("<div>").addClass('icon icon-48 icon-'+icon).css('display','inline-block').attr("title", title);
    },
    makeTool: function(icon, label, left/*bool*/, top, click) {
        this.tools[icon] = this.makeIcon(icon, label).css({position:'absolute', top: top}).css(left ? {'left':'6px'}:{'right':'6px'}).click(click).appendTo($("#book-wrapper"));
        return this.tools[icon];
    },
    showIcon: function(icon, enable) {
        if(enable) this.tools[icon].show() ; else this.tools[icon].hide();
    },
    turnNext: function() {
        this.bookContent.get().turn("next");
        this.logEvent('book_page_turn', this.bookUrl, this.bookContent.get().turn("page"));
    },
    turnPrevious: function() {
        this.bookContent.get().turn("previous");
        this.logEvent('book_page_turn', this.bookUrl, this.bookContent.get().turn("page"));
    },
    turnFirst: function() {
        this.bookContent.get().turn("page", 1);
        this.logEvent('book_page_turn', this.bookUrl, 1);
    },
    goHome: function() {
        this.logEvent('book_close', this.bookUrl);
        window.location.href = this.bookUrl;
    },
    close: function() {
        this.logEvent('book_close', this.bookUrl);
        window.open('','_parent','');
        window.close();
    },
    init: function() {
        /* display book... */
        var self = this;
        var width = this.defaultWidth;
        var height = this.defaultHeight;
        // create wrapper...
        $("<div>").attr("id", "book-wrapper").css('position','relative').appendTo($("#content"));
        this.bookContent = Thing.create(this.bookData, {"display":"turnable"});
        // find audio and video Things and monitor their play, stop, pause, kill events
        var media = [];
        this.bookContent.findSlotsByType('audio-decorator', media);
        this.bookContent.findSlotsByType('video-thing', media);
        for(var i=0; i<media.length; i++) {
            var m = media[i]; 
            var src = m.options.uri;           
            (function(){
                m.onPlay(function() { self.logEvent('book_media_play', src); });
                m.onPause(function() { self.logEvent('book_media_pause', src); });
                m.onStop(function() { self.logEvent('book_media_stop', src); });
                m.onKill(function() { self.logEvent('book_media_kill', src); });
            })();
        }
        // init book...
        this.bookContent.onInit();
        $("#book-wrapper").css({width:width+"px", height:height+"px"}).html(this.bookContent.get());
        this.bookContent.makeDisplay();

        // events...
        $(window).unload(function() {
            self.bookContent.onExit(); // TODO tohle mi nejak nefunguje...
        });
        $(window).resize(function() {
            if(self.fullscreen) {
                self.updateToolbar(self.recreate());
            }
        });
        $(window).bind("fullscreen-toggle", function(e, state) {
            self.setFullscreen(state);
        });
        this.bookContent.get().bind("turned", function(event, page, view) {
          self.updateToolbar();
        });
        this.makeTool('turn-right', __('Previous page'), true, '50%', function() { self.turnPrevious();});
        this.makeTool('turn-left', __('Next page'), false, '50%', function() { self.turnNext();});
        //this.makeTool('fullscreen-on', __('Fullscreen on'), true, '68px', function() { self.setFullscreen(true);});
        //this.makeTool('fullscreen-off', __('Fullscreen off'), true, '68px', function() { self.setFullscreen(false)});
        this.makeTool('closebook', __('Close book'), false, '16px', function() { self.turnFirst();});
        //if(this.bookUrl) this.makeTool('home', __('Back to editor'), true, '16px', function() { self.goHome();});
        // reduce close icon in size...
        this.tools['closebook'].css({top: '16px', width: "24px", height: "24px"});

        this.updateToolbar();
        this.logEvent('book_open', this.bookUrl);
    },
    logEvent: function(type, src, data) {
        var timestamp = Math.floor(new Date().getTime() / 1000);
        this.logSingleEvent({"type":type,"src":src,"data":data,"timestamp":timestamp});
        if(type == 'book_close') {  
            // flush events...
            this.flushEventLog();
        }
    },
    logSingleEvent: function(evt) {
        this.eventHistory.push(evt);
        if(this.eventUrl) {
            Common.postJsonData(this.eventUrl+".json", evt);
        }
    },
    flushEventLog: function() {
        // TODO odesilat eventy pres AJAX
        console.log(JSON.stringify(this.eventHistory, null, 4));
    },
    setFullscreen: function(full) {
        this.fullscreen = full;
        this.bookContent.get().turn('disable', true);
        if(this.fullscreen) {
            $("#book-wrapper").appendTo($("#fullscreen"));
            $("#container").hide();
            $("#fullscreen").show();            
        } else {
            $("#book-wrapper").appendTo($("#content"));
            $("#container").show();
            $("#fullscreen").hide();

        }
        this.bookContent.get().turn('disable', false);
        this.updateToolbar(this.recreate());
        this.logEvent('book_fullscreen', this.bookUrl, full);
        return full;    
    },
    recreate: function() {
        var width = this.defaultWidth;
        var height = this.defaultHeight;
        // kniha je velka 800x560 - pomer stran cca 1:sqrt(2) ~ 1:1.428
        if(this.fullscreen) {
            var ww = $(window).width();
            var hh = $(window).height();
            var scaleFactor = ww/width;
            var scaleFactor2 = hh/height;
            var scale = Math.min(scaleFactor, scaleFactor2);
            width = /*Math.floor(width*scale);*/ww;
            height = /*Math.floor(height*scale);*/hh;
        } 
        // resize wrapper and pages...
        $("#book-wrapper").css({width:width+"px", height:height+"px"});
        if(this.fullscreen) {
            // na okrajich musi zbyt 8% mista; to odpovida 60px 
            var sidex = Math.max(Math.floor(width*0.08), 60);
            var newWidth = width - 2*sidex;
            var newHeight = Math.floor(newWidth/1.428);
            var maxHeight = height-40;
            if(newHeight > maxHeight) {
                newWidth = Math.floor(newWidth*maxHeight/newHeight);
                newHeight = maxHeight;
            }
        } else {
            var newWidth = width - 120;
            var newHeight = height - 40;
        }
        this.bookContent.get().turn('size', newWidth, newHeight);
        return newWidth;
    },
    updateToolbar: function(gapWidth) {
        var page = this.bookContent.get().turn("page");
        var pages = this.bookContent.get().turn("pages");
        this.showIcon('turn-right', page>1);
        this.showIcon('turn-left', page<(pages-pages%2)); // kdyz ma kniha 3 strany, uz nejde druha otocit
        //this.showIcon('fullscreen-on', !this.fullscreen);
        //this.showIcon('fullscreen-off', this.fullscreen);
        
        if(gapWidth) {
            var gapSize = 60;
            if(this.fullscreen) {
                gapSize += Math.floor(($("#book-wrapper").width() - gapWidth)/2);
            }
            var hh = this.bookContent.get().height();
            var iconSize = Math.min(gapSize - 12, 240);
            var iconSizeHalf = Math.floor(iconSize/2);
            var hh2 = Math.max(Math.floor(hh/2-iconSize/2), 28+3*iconSize);
            this.tools['turn-right'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['turn-left'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            //this.tools['fullscreen-on'].css({top: (20+iconSize)+'px', width: iconSize+"px", height: iconSize+"px"});
            //this.tools['fullscreen-off'].css({top: (20+iconSize)+'px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['closebook'].css({top: '16px', width: iconSizeHalf+"px", height: iconSizeHalf+"px"});
            //if(this.bookUrl) this.tools['home'].css({top: '16px', width: iconSize+"px", height: iconSize+"px"});
        }
    }
});

var ExportBookViewer = BookViewer.extend({
    /* simplified constructor... */
    // TODO remove
    constructor: function(book) {        
        this.base({data:book, fullscreen:true});
    },
    init: function() {
        /* display book... */
        var self = this;
        var width = this.defaultWidth;
        var height = this.defaultHeight;
        // create wrapper...
        $("<div>").attr("id", "book-wrapper").css('position','relative').appendTo($("#fullscreen"));
        this.bookContent = Thing.create(this.bookData, {"display":"turnable"});
        this.bookContent.onInit();
        $("#book-wrapper").css({width:width+"px", height:height+"px"}).html(this.bookContent.get());
        this.bookContent.makeDisplay();

        // events...
        $(window).unload(function() {
            self.bookContent.onExit(); // TODO tohle mi nejak nefunguje...
        });
        $(window).resize(function() {
            if(self.fullscreen) {
                self.updateToolbar(self.recreate());
            }
        });
        $(window).bind("fullscreen-toggle", function(e, state) {
            self.setFullscreen(state);
        });
        this.bookContent.get().bind("turned", function(event, page, view) {
          self.updateToolbar();
        });
        this.makeTool('turn-right', __('Previous page'), true, '50%', function() { self.turnPrevious();});
        this.makeTool('turn-left', __('Next page'), false, '50%', function() { self.turnNext();});
        //this.makeTool('fullscreen-on', __('Fullscreen on'), true, '16px', function() { self.setFullscreen(true);});
        //this.makeTool('fullscreen-off', __('Fullscreen off'), true, '16px', function() { self.setFullscreen(false)});
        this.makeTool('closebook', __('Close book'), false, '16px', function() { self.close();});
        // reduce close icon in size...
        this.tools['closebook'].css({top: '16px', width: "24px", height: "24px"});

        this.setFullscreen(true);
        this.logEvent('book_open', this.bookUrl);
    },
    updateToolbar: function(gapWidth) {
        var page = this.bookContent.get().turn("page");
        var pages = this.bookContent.get().turn("pages");
        this.showIcon('turn-right', page>1);
        this.showIcon('turn-left', page<(pages-pages%2)); // kdyz ma kniha 3 strany, uz nejde druha otocit
        //this.showIcon('fullscreen-on', !this.fullscreen);
        //this.showIcon('fullscreen-off', this.fullscreen);

        if(gapWidth) {
            var gapSize = 60;
            if(this.fullscreen) {
                gapSize += Math.floor(($("#book-wrapper").width() - gapWidth)/2);
            }
            var hh = this.bookContent.get().height();
            var iconSize = Math.min(gapSize - 12, 240);
            var iconSizeHalf = Math.floor(iconSize/2);
            var hh2 = Math.max(Math.floor(hh/2-iconSize/2), 28+2*iconSize);
            this.tools['turn-right'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['turn-left'].css({top: hh2+'px', width: iconSize+"px", height: iconSize+"px"});
            //this.tools['fullscreen-on'].css({top: '16px', width: iconSize+"px", height: iconSize+"px"});
            //this.tools['fullscreen-off'].css({top: '16px', width: iconSize+"px", height: iconSize+"px"});
            this.tools['closebook'].css({top: '16px', width: iconSizeHalf+"px", height: iconSizeHalf+"px"});
        }
    },
    setFullscreen: function(full) {
        this.fullscreen = full;
        this.updateToolbar(this.recreate());
        this.logEvent('book_fullscreen', this.bookUrl, full);
        return full;    
    },
    logEvent: function(type, origin, data) {
        // does nothing...
    }
});



// uses: jquery, common, base

// tohle projde markup a vytvori widgety tam kde jsou na to pripravena data
// widget ma serverovou cast/sablonu a JS na klientovi ktery z toho muze vyrobit
// treba graficky editor nebo embedded SVG

function valueDecode(value) {
    if((/^!/).test(value)) {
        // je to bud base64 nebo to zacina vykricnikem
        value = value.substring(1);
        if(!(/^!/).test(value)) {
            // je to base64
            value = JSON.parse(utf8_decode(base64_decode(value)));
        } else {
            value = htmlDecode(value);
        }
    } else {
        value = htmlDecode(value);
    }
    return value;
}

function valueEncode(value) {
    if(jQuery.isPlainObject(value)) {
        return '!' + base64_encode(utf8_encode(JSON.stringify(value)));
    } else {
        var out = htmlEncode(value);
        if(out.startsWith('!')) out = "!" + out;
    }
    return out;
}

function widgetize(what) {
    what.reverse().each(function() {
        var self = $(this);        
        // find the widget class...
        var csss = self.attr("class").split(" ");
        for(var i=0; i<csss.length; i++) {
            // je to widget?
            if(csss[i].endsWith("-widget")) {
                var widgetClass = csss[i].replace(/-widget$/, "");
                // gather all data-attributes
                var data = self.data();        
                for(var key in data) {
                    var value = data[key];
                    data[key] = valueDecode(data[key]);
                    self.data(key, data[key]);
                }
                // vytvorime widget - zavolame JS/jQuery plugin a predame mu parametry v data
                self[widgetClass](data);
                break;
            }
        }
    });
}


var Widget = Base.extend({
    constructor: function(element, options) {
        this.element = element;
        this.options = $.extend({}, options);
        // promenne widgetu...
        this.wid = Widget.getUniqueId();
        this.element.data('wid', this.wid);
        Widget.cache[this.wid] = this;
    },
    init: function() {
        // inicializace ramce pro widget (toho co se nemeni)
    },
    refresh: function() {
        // volat pokazde pokud se zmeni data
    },
    destroy: function() {
        // uvedeni widgetu do puvodniho stavu
    }
},{
    wid: 1,
    getUniqueId: function() {
        return 'widget'+Widget.wid++;
    },
    cache: {}
});







var ThingWidget = Widget.extend({
    init: function() {
        var self = this;
        var def = this.options.def;
        if(def) {
            var thing = Thing.create(def);
            this.element.empty().append(thing.get());
        }
        self.refresh();
    },
    refresh: function() {
    }
});

// widgety...
(function($){

    var defaultOptions = { def: { type: "empty" } };

    var methods = {
        init : function(options) {
            var settings = $.extend({}, defaultOptions, options);
            return this.each(function() {
                var $this = $(this);
                var widget = new ThingWidget($this, settings);
                widget.init();
            });
        }
    };

    $.fn.thing = function(methodOrOptions) {
        if ( methods[methodOrOptions] ) {
            return methods[ methodOrOptions ].apply( this, Array.prototype.slice.call( arguments, 1 ));
        } else if ( typeof methodOrOptions === 'object' || ! methodOrOptions ) {
            // Default to "init"
            return methods.init.apply( this, arguments );
        } else {
            $.error( 'Method ' +  method + ' does not exist on jQuery.thing' );
        }    
    };

})(jQuery);


// TODO rozeznavani 'media' podle pripony

var _audioPlayerIndex = 1;
var makeAudioPlayer = function(parent, media) {
    var id = _audioPlayerIndex++;
    var playerId = 'jquery_cplayer_'+id;
    var containerId = 'cp_container_'+id;
    var html = $.render.circlePlayer({playerId: playerId, containerId: containerId});
    var div = $("<div>").html(html);
    parent.append(div);
    // ensure that player div is at the root of body
    $("#"+playerId).appendTo($("body"));

	var myCirclePlayer = new CirclePlayer("#"+playerId, media, {
		cssSelectorAncestor: "#"+containerId
	});
    return div;
};

var _videoPlayerIndex = 1;
var makeVideoPlayer = function(parent, media) {
    var id = _videoPlayerIndex++;
    var playerId = 'jquery_jplayer_'+id;
    var containerId = 'jp_container_'+id;
    var html = $.render.videoPlayer({playerId: playerId, containerId: containerId});
    var div = $("<div>").html(html).appendTo(parent);
    $("#"+playerId).jPlayer({
        ready: function () {
          $(this).jPlayer("setMedia", media);
        },
        swfPath: "/js",
        supplied: "m4v, ogv",
        cssSelectorAncestor: "#"+containerId
    });    
    return div;
};

// initialization...
$(document).ready(function() {

    // widgetizer...
    widgetize($(".widget"));

});
<<<END TEXT>>>

--------------------------------------------------------------------------------
SOUČÁST: vzorky\book1.txt
CESTA:    C:\Users\volny\Documents\bakalarsky_projekt\escrapbook\escrapbook\vzorky\book1.txt
VELIKOST: 8210 B (8.02 KB)
TYP:      textový
--------------------------------------------------------------------------------
<<<BEGIN TEXT>>>
{"type":"book","options":[],"slots":[{"type":"text-thing","options":{"html":"Slovensko - Vysok\u00e9 Tatry 2020","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},{"type":"grid-layout","options":{"rows":2,"columns":2,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/331\/DSCN0665_2_original.jpg","repeat":"no-repeat","position":"center center","color":"","size":"cover"}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"text-thing","options":{"html":"<p>Star&yacute; Smokovec &rArr; Hrebienok &rArr; Malou Studenou dolinou &rArr; p\u0159es Z&aacute;mkovsk&eacute;ho chatu &rArr; na Teryho chatu <span style=\"font-size:14px\"><strong>:)<\/strong><\/span><\/p>\r\n","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}},{"type":"text-thing","options":{"html":"Mlha \"na Blatech\"","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/347\/DSCN0666_2_original.jpg","repeat":"no-repeat","position":"center center","color":"","size":"cover"}}}}]},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"audio-decorator","options":{"ogg":"","mp3":"voices\/30\/Mumford_Sons_Hopeless_Wanderer_Official_Music_Video_original.mp3","uri":"voices\/30\/Mumford_Sons_Hopeless_Wanderer_Official_Music_Video_original.mp3","autoplay":true,"loop":false,"volume":50},"slots":{"content":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/333\/DSCN0669_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}}}},{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"video-thing","options":{"uri":"videos\/10\/video_1596110981_original.mp4","ogg":"","mp4":"videos\/10\/video_1596110981_original.mp4","webm":"","autoplay":true,"loop":true,"volume":20}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/334\/DSCN0670_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}]},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/335\/DSCN0679_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}},{"type":"grid-layout","options":{"rows":1,"columns":2,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/337\/DSCN0689_2_original.jpg","repeat":"no-repeat","position":"center center","color":"","size":"cover"}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"audio-decorator","options":{"ogg":"","mp3":"voices\/31\/Jelen_Abych_tu_zil_original.mp3","uri":"voices\/31\/Jelen_Abych_tu_zil_original.mp3","autoplay":true,"loop":false,"volume":50},"slots":{"content":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/336\/DSCN0685_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}}}}]},{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"text-thing","options":{"html":"<p><em><strong><span style=\"background-color:#800080\">\u010clenov&eacute; v&yacute;pravy :))<\/span><\/strong><\/em><\/p>\r\n\r\n<p>&nbsp;<\/p>\r\n","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/338\/DSCN0696_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}]},{"type":"split-layout","options":{"ratio":65,"gap":2,"horizontal":false},"slots":{"first":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/339\/DSCN0697_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}},"second":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"text-thing","options":{"html":"<h1><u><strong>Popradsk&eacute; pleso<\/strong><\/u><\/h1>\r\n\r\n<h3>- ledovcov&eacute; jezero v <em>Mengusovsk&eacute; dolin\u011b<\/em> ve Vysok&yacute;ch Tatr&aacute;ch<\/h3>\r\n","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}}}},{"type":"split-layout","options":{"ratio":33,"gap":2,"horizontal":false},"slots":{"first":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"text-thing","options":{"html":"<h1><u><strong>&#39;Nad mraky&#39;<\/strong><\/u><\/h1>\r\n\r\n<h3><em>- v&yacute;hled z Ostrvy<\/em><\/h3>\r\n","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}},"second":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/340\/DSCN0706_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"grid-layout","options":{"rows":2,"columns":2,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/341\/DSCN0708_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}},{"type":"text-thing","options":{"html":"Popradsk\u00e9 pleso z Ostrvy","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},{"type":"text-thing","options":{"html":"V\u00fdhled z Ostrvy","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/342\/DSCN0712_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}]},{"type":"grid-layout","options":{"rows":2,"columns":1,"gap":2},"slots":[{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/343\/DSCN0716_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/344\/DSCN0717_2_original.jpg","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}]},{"type":"split-layout","options":{"ratio":33,"gap":2,"horizontal":false},"slots":{"first":{"type":"text-thing","options":{"html":"Batizovsk\u00e9 pleso pod Gerlachovsk\u00fdm \u0161t\u00edtem","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}},"second":{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"imager","options":{"url":"images\/345\/DSCN0720_original.JPG","repeat":"no-repeat","position":"center center","color":"white","size":"cover"}}}}}},{"type":"ref-decorator","options":{"label":null,"source":""},"slots":{"content":{"type":"audio-decorator","options":{"ogg":"","mp3":"voices\/32\/Tom_Petty_And_The_Heartbreakers_Learning_To_Fly_Version_1_original.mp3","uri":"voices\/32\/Tom_Petty_And_The_Heartbreakers_Learning_To_Fly_Version_1_original.mp3","autoplay":true,"loop":false,"volume":75},"slots":{"content":{"type":"text-thing","options":{"html":"A tady na\u0161e v\u00fdprava kon\u010d\u00ed :)","css":"","h-align":"center","v-align":"center","font-size":"20px","font-family":"Georgia, serif"}}}}}}]}
<<<END TEXT>>>

